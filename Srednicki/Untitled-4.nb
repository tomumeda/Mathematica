(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    185482,       4784]
NotebookOptionsPosition[    181899,       4667]
NotebookOutlinePosition[    182270,       4683]
CellTagsIndexPosition[    182227,       4680]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"DefPrint", "[", 
  RowBox[{"\"\<e1453\>\"", ",", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"q", ",", 
      OverscriptBox["q", "."]}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], "Z", " ", 
      SuperscriptBox[
       OverscriptBox["q", "."], "2"]}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      SubscriptBox["Z", "\[Omega]"], 
      SuperscriptBox["\[Omega]", "2"], 
      SuperscriptBox["q", "2"]}], "-", 
     RowBox[{
      SubscriptBox["Z", "\[Lambda]"], "\[Lambda]", " ", 
      SuperscriptBox["\[Omega]", "3"], 
      SuperscriptBox["q", "4"]}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4635011603442593`*^9, 3.46350131956046*^9}, {
  3.4635049075813723`*^9, 3.4635049088453617`*^9}, {3.463505204367361*^9, 
  3.463505228852412*^9}, {3.4635053205646877`*^9, 3.463505337026371*^9}, {
  3.4635054847847357`*^9, 3.4635054926477137`*^9}, {3.463505547277272*^9, 
  3.463505551936988*^9}, {3.4635056370293617`*^9, 3.463505677782131*^9}, {
  3.463505752979403*^9, 3.463505759762048*^9}, {3.4635058817387857`*^9, 
  3.463505887737403*^9}, {3.463506502765656*^9, 3.463506528348583*^9}, {
  3.463506803672237*^9, 3.463506824454297*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"e1453: \"\>",
    StripOnInput->False,
    FontSize->12], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"L", "[", 
      RowBox[{"q", ",", 
       OverscriptBox["q", "."]}], "]"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"Z", " ", 
        SuperscriptBox[
         OverscriptBox["q", "."], "2"]}], "2"], "-", 
      RowBox[{
       SuperscriptBox["q", "4"], " ", "\[Lambda]", " ", 
       SuperscriptBox["\[Omega]", "3"], " ", 
       SubscriptBox["Z", "\[Lambda]"]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["q", "2"], " ", 
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubscriptBox["Z", "\[Omega]"]}]}]}],
    StripOnInput->False,
    FontSize->12]}],
  SequenceForm[
   Style["e1453: ", 12], 
   Style[$CellContext`L[$CellContext`q, 
      OverDot[$CellContext`q, 1]] -> 
    Rational[1, 2] $CellContext`Z 
      OverDot[$CellContext`q, 
         1]^2 - $CellContext`q^4 $CellContext`\[Lambda] \
$CellContext`\[Omega]^3 Subscript[$CellContext`Z, $CellContext`\[Lambda]] + 
     Rational[-1, 2] $CellContext`q^2 $CellContext`\[Omega]^2 
      Subscript[$CellContext`Z, $CellContext`\[Omega]], 12]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464213146540408*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpH", "=", 
   RowBox[{"H", "->", 
    RowBox[{
     SubscriptBox["H", "0"], "+", 
     SubscriptBox["H", "1"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmpH0", "=", 
   RowBox[{
    SubscriptBox["H", "0"], "->", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox["P", "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox["\[Omega]", "2"], 
      SuperscriptBox["Q", "2"]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmpC", "=", 
   RowBox[{
    RowBox[{"MCommutator", "[", 
     RowBox[{"Q", ",", "P"}], "]"}], "\[Equal]", "\[ImaginaryI]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmpP", "=", 
   RowBox[{
    RowBox[{"P", "\[Rule]", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"q", ",", 
         OverscriptBox["q", "."]}], "]"}], ",", 
       OverscriptBox["q", "."]}], "]"}]}], "//", 
    RowBox[{"HoldOp", "[", "D", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tmpP", "=", 
  RowBox[{
   RowBox[{"tmpP", "/.", "e1453"}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmpH", "=", 
  RowBox[{"H", "\[Rule]", 
   RowBox[{
    RowBox[{"P", " ", 
     OverscriptBox["q", "."]}], "-", 
    RowBox[{"L", "[", 
     RowBox[{"q", ",", 
      OverscriptBox["q", "."]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"tmpH", "=", 
  RowBox[{
   RowBox[{"tmpH", "/.", "e1453"}], "/.", "tmpP"}]}]}], "Input",
 CellChangeTimes->{{3.4635013774663887`*^9, 3.4635015091415033`*^9}, {
  3.463501581234482*^9, 3.4635015991098423`*^9}, {3.46350180441041*^9, 
  3.463501838683641*^9}, {3.4635018941966057`*^9, 3.4635019596551533`*^9}, {
  3.463504810040347*^9, 3.4635048561409817`*^9}, {3.463505392876424*^9, 
  3.463505397859601*^9}, {3.46350543541708*^9, 3.463505460100374*^9}, {
  3.463505922163775*^9, 3.4635059303458443`*^9}, {3.4635059635625134`*^9, 
  3.463505983277013*^9}, {3.463506048687059*^9, 3.463506049464917*^9}, {
  3.463506153573193*^9, 3.4635062434421864`*^9}, {3.4635064422253428`*^9, 
  3.463506457761265*^9}, {3.463506539251585*^9, 3.463506610141204*^9}, {
  3.463506729426675*^9, 3.4635067466609163`*^9}, {3.463506842874837*^9, 
  3.463507013472924*^9}, {3.4635070438276453`*^9, 3.463507138041916*^9}}],

Cell[BoxData[
 RowBox[{"P", "\[Rule]", 
  RowBox[{"Z", " ", 
   OverscriptBox["q", "."]}]}]], "Output",
 CellChangeTimes->{{3.464213140416374*^9, 3.4642131485829268`*^9}}],

Cell[BoxData[
 RowBox[{"H", "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"L", "[", 
     RowBox[{"q", ",", 
      OverscriptBox["q", "."]}], "]"}]}], "+", 
   RowBox[{"P", " ", 
    OverscriptBox["q", "."]}]}]}]], "Output",
 CellChangeTimes->{{3.464213140416374*^9, 3.4642131485852547`*^9}}],

Cell[BoxData[
 RowBox[{"H", "\[Rule]", 
  RowBox[{
   FractionBox[
    RowBox[{"Z", " ", 
     SuperscriptBox[
      OverscriptBox["q", "."], "2"]}], "2"], "+", 
   RowBox[{
    SuperscriptBox["q", "4"], " ", "\[Lambda]", " ", 
    SuperscriptBox["\[Omega]", "3"], " ", 
    SubscriptBox["Z", "\[Lambda]"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["q", "2"], " ", 
    SuperscriptBox["\[Omega]", "2"], " ", 
    SubscriptBox["Z", "\[Omega]"]}]}]}]], "Output",
 CellChangeTimes->{{3.464213140416374*^9, 3.464213148598785*^9}}]
}, Open  ]],

Cell[TextData[{
 "Identify q,",
 Cell[BoxData[
  FormBox[
   OverscriptBox["q", "."], TraditionalForm]]],
 " with Q, P/Z"
}], "Text",
 CellChangeTimes->{{3.4635071844357653`*^9, 3.463507234889673*^9}, {
  3.463508360540924*^9, 3.463508361629878*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpP1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"tmpP", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/", "Z"}], "\[Rule]", 
    RowBox[{
     RowBox[{"tmpP", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/", "Z"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"tmpHa", "=", 
  RowBox[{
   RowBox[{"tmpH", "/.", "tmpP1"}], "/.", 
   RowBox[{"q", "\[Rule]", "Q"}]}]}]}], "Input",
 CellChangeTimes->{{3.4635072417506523`*^9, 3.463507347990141*^9}, {
  3.463507454401189*^9, 3.463507457080353*^9}, {3.4635086087388372`*^9, 
  3.4635086092334223`*^9}}],

Cell[BoxData[
 RowBox[{"H", "\[Rule]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["P", "2"], 
    RowBox[{"2", " ", "Z"}]], "+", 
   RowBox[{
    SuperscriptBox["Q", "4"], " ", "\[Lambda]", " ", 
    SuperscriptBox["\[Omega]", "3"], " ", 
    SubscriptBox["Z", "\[Lambda]"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["Q", "2"], " ", 
    SuperscriptBox["\[Omega]", "2"], " ", 
    SubscriptBox["Z", "\[Omega]"]}]}]}]], "Output",
 CellChangeTimes->{3.464213151502618*^9}]
}, Open  ]],

Cell["Subtract H0", "Text",
 CellChangeTimes->{{3.463507998548954*^9, 3.463508004787969*^9}, {
  3.463515261544881*^9, 3.463515267555725*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmpHa", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "-", 
      SubscriptBox["H", "0"]}], "&"}], ",", "%"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{
    SubscriptBox["H", "0"], "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["P", "2"], "/", "2"}], "+", 
     RowBox[{
      SuperscriptBox["\[Omega]", "2"], 
      RowBox[{
       SuperscriptBox["Q", "2"], "/", "2"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"P", ",", "Q"}], "}"}], ",", "Simplify"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmpH1", "=", 
  RowBox[{"H1", "->", 
   RowBox[{"%", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.463507462935863*^9, 3.463507573670559*^9}, {
  3.463507616397567*^9, 3.4635076189545813`*^9}, {3.4635077307280703`*^9, 
  3.463507790091544*^9}, {3.4635078238932734`*^9, 3.463507827009659*^9}, {
  3.4635080164856367`*^9, 3.463508035645317*^9}, {3.463508578341096*^9, 
  3.463508616137404*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "-", 
   FractionBox[
    SuperscriptBox["P", "2"], "2"], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["Q", "2"], " ", 
     SuperscriptBox["\[Omega]", "2"]}], "2"]}], "\[Rule]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["P", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox["1", "Z"]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["Q", "4"], " ", "\[Lambda]", " ", 
    SuperscriptBox["\[Omega]", "3"], " ", 
    SubscriptBox["Z", "\[Lambda]"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["Q", "2"], " ", 
    SuperscriptBox["\[Omega]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["Z", "\[Omega]"]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.4642131539898863`*^9}],

Cell[BoxData[
 RowBox[{"H1", "\[Rule]", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["P", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox["1", "Z"]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["Q", "4"], " ", "\[Lambda]", " ", 
    SuperscriptBox["\[Omega]", "3"], " ", 
    SubscriptBox["Z", "\[Lambda]"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["Q", "2"], " ", 
    SuperscriptBox["\[Omega]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["Z", "\[Omega]"]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.464213154073967*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tmpH1", "/.", 
     RowBox[{
      SubscriptBox["Z", "\[Lambda]"], "\[Rule]", "1"}]}], "/.", 
    RowBox[{
     SubscriptBox["Z", "\[Omega]"], "\[Rule]", 
     RowBox[{"1", "+", "B"}]}]}], "/.", 
   RowBox[{"Z", "\[Rule]", 
    RowBox[{"1", "+", "A"}]}]}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"P", ",", "Q"}], "}"}], ",", "Simplify"}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.463508698629386*^9, 3.463508830930415*^9}}],

Cell[BoxData[
 RowBox[{"H1", "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"A", " ", 
      SuperscriptBox["P", "2"]}], 
     RowBox[{"2", "+", 
      RowBox[{"2", " ", "A"}]}]]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", "B", " ", 
    SuperscriptBox["Q", "2"], " ", 
    SuperscriptBox["\[Omega]", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["Q", "4"], " ", "\[Lambda]", " ", 
    SuperscriptBox["\[Omega]", "3"]}]}]}]], "Output",
 CellChangeTimes->{3.464213156650487*^9}]
}, Open  ]],

Cell[TextData[{
 "==============\nRayleigh-Schodinger perturbation technique to define O(\
\[Lambda]) corrections to eigenvalues ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "=", 
    RowBox[{
     SubscriptBox["E", "0"], "+", "dE"}]}], TraditionalForm]]],
 ", and eigenstates, |\[CapitalOmega]>=|0>+d|0>.  Keep only first order in ",
 "\[Lambda]."
}], "Text",
 CellChangeTimes->{{3.463509892947383*^9, 3.463509914557778*^9}, {
  3.463510795294393*^9, 3.463510833940145*^9}, {3.463511189678856*^9, 
  3.4635113420452433`*^9}, {3.463511824947668*^9, 3.463511843623279*^9}, {
  3.463844584655591*^9, 3.463844591548066*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"function", " ", "to", " ", "keep", " ", "non"}], "-", 
    RowBox[{"commuting", " ", "terms", " ", "in", " ", "proper", " ", 
     RowBox[{"order", "."}]}]}], "*)"}], 
  RowBox[{
   RowBox[{"DotForm", "[", "a_", "]"}], ":=", 
   RowBox[{"dotRetain", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"H", ",", "H0", ",", "H1", ",", 
       TagBox[
        RowBox[{"\[LeftAngleBracket]", 
         TagBox["__",
          Quantum`Notation`zz080BraArgs,
          Editable->True,
          Selectable->True], "\[VerticalSeparator]"}],
        Quantum`Notation`zz080Bra,
        Editable->False,
        Selectable->False], ",", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox["__",
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{"_", ",", "_"}], "]"}], ",", "P", ",", "Q"}], "}"}], ",", 
     "a"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.463509917947248*^9, 3.463509963662437*^9}, {
   3.463510846329753*^9, 3.463510847231022*^9}, {3.463510880785708*^9, 
   3.463510981449725*^9}, {3.463511058692007*^9, 3.46351106886681*^9}, {
   3.4635111169335012`*^9, 3.4635111507620173`*^9}, {3.4635115082526827`*^9, 
   3.46351150979119*^9}, {3.4635115739625874`*^9, 3.46351164488494*^9}, {
   3.463511690875597*^9, 3.4635117948712*^9}, 3.46351183992448*^9, {
   3.4635119806268272`*^9, 3.4635120089448013`*^9}, {3.463512113341289*^9, 
   3.4635121951075*^9}, {3.463512227562894*^9, 3.463512342131195*^9}, 
   3.463512373852006*^9, {3.463512446979279*^9, 3.463512462246586*^9}, {
   3.463512507916018*^9, 3.463512509712434*^9}, {3.4635125398811502`*^9, 
   3.463512595540885*^9}, {3.4635126301544237`*^9, 3.463512674125032*^9}, {
   3.4635127119717197`*^9, 3.463512755534574*^9}, 3.4635127905717087`*^9, {
   3.463512970928957*^9, 3.463512973325096*^9}, {3.463513652911686*^9, 
   3.4635137042074347`*^9}, {3.463513745430767*^9, 3.463513766916045*^9}, {
   3.463514326026074*^9, 3.4635143825045567`*^9}, {3.463514521866*^9, 
   3.463514557038692*^9}, {3.463514609355585*^9, 3.4635146308844213`*^9}, {
   3.4635148190421457`*^9, 3.463514864508857*^9}, {3.463515141397719*^9, 
   3.463515167865404*^9}, {3.46351523157611*^9, 3.463515245523731*^9}, {
   3.463515320741534*^9, 3.463515331308899*^9}, {3.463515383537404*^9, 
   3.463515453960051*^9}, {3.463515484185318*^9, 3.463515491355739*^9}, {
   3.463515527438126*^9, 3.463515559910087*^9}, {3.463515593159902*^9, 
   3.4635156147822638`*^9}, {3.463515661505321*^9, 3.463515733838894*^9}, {
   3.463515766173167*^9, 3.463515790467483*^9}, {3.463516122773664*^9, 
   3.463516125264476*^9}, {3.4635164119350557`*^9, 3.463516537880413*^9}, {
   3.4635167766886168`*^9, 3.463516780671934*^9}, {3.463516811665012*^9, 
   3.463516822102747*^9}, 3.463516931258679*^9, 3.46351699598661*^9, {
   3.463517054586529*^9, 3.463517056463443*^9}, {3.463538429020854*^9, 
   3.4635384550955*^9}, {3.463538532191152*^9, 3.463538543819323*^9}, {
   3.463575876284267*^9, 3.463575881775547*^9}, {3.463575912178565*^9, 
   3.463575929468235*^9}, {3.463576004429594*^9, 3.46357600543292*^9}, {
   3.4635789181941833`*^9, 3.463578921217634*^9}, {3.463578957737887*^9, 
   3.463578973933264*^9}, {3.463624861553961*^9, 3.463624861705954*^9}, {
   3.4636249550598507`*^9, 3.463624974144951*^9}, 3.463627077357669*^9, {
   3.463627149969665*^9, 3.463627195953331*^9}, 3.463627236026442*^9, {
   3.463627287304245*^9, 3.463627320432087*^9}, {3.463627352399884*^9, 
   3.463627376644513*^9}, {3.463628366441031*^9, 3.46362839734091*^9}, {
   3.463659861782423*^9, 3.463659964651703*^9}, 3.463666808030154*^9, {
   3.4636668657041473`*^9, 3.463666912307453*^9}, {3.463666977775527*^9, 
   3.463666978202951*^9}, {3.463667093683955*^9, 3.463667098883938*^9}, {
   3.463667316841284*^9, 3.463667356177876*^9}, {3.463669984531095*^9, 
   3.4636700272221537`*^9}, {3.4636700668956757`*^9, 3.463670094873814*^9}, 
   3.463670128976289*^9, {3.463670176108582*^9, 3.4636702391173677`*^9}, {
   3.4636702768911858`*^9, 3.463670278294374*^9}, {3.4636703262085047`*^9, 
   3.4636703273069983`*^9}, 3.463670381261511*^9, {3.463670451371058*^9, 
   3.463670459720921*^9}, {3.463670523479438*^9, 3.463670555291429*^9}, {
   3.463670587761169*^9, 3.4636706015996933`*^9}, {3.463670721714327*^9, 
   3.463670757451043*^9}, 3.4636709443388023`*^9, {3.463671034281892*^9, 
   3.4636710878485413`*^9}, {3.463671194523538*^9, 3.46367119922705*^9}, {
   3.463671914031715*^9, 3.463672005695557*^9}, {3.4636720712848673`*^9, 
   3.463672085834062*^9}, {3.463672118036084*^9, 3.463672134142088*^9}, {
   3.4636721702553577`*^9, 3.4636722418418617`*^9}, {3.463672279039446*^9, 
   3.4636724931739483`*^9}, {3.463672532972722*^9, 3.463672534338727*^9}, {
   3.463672613577693*^9, 3.46367269263386*^9}, 3.463672766780035*^9, {
   3.463674561974061*^9, 3.4636745666686974`*^9}, {3.4637042860988083`*^9, 
   3.4637042887863607`*^9}, {3.4637685671714697`*^9, 
   3.4637685722887487`*^9}, {3.4637687263010406`*^9, 3.463768728873517*^9}, {
   3.463830961221424*^9, 3.463831041643794*^9}, {3.463831171866358*^9, 
   3.463831210401965*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Define the Hamiltonian as the sum of the pure harmonic oscillator \
Hamiltonian, H0, and the perturbative Hamiltonian, H1, where \[Lambda] is the \
smallness factor\>\"", ",", "Yield", ",", "\[IndentingNewLine]", 
     RowBox[{"subH", "=", 
      RowBox[{"H", "\[Rule]", 
       RowBox[{"H0", "+", 
        RowBox[{"\[Lambda]", " ", "H1"}]}]}]}], ",", 
     "\"\<\\nand energy eigenvalues for perturbed and unperturbed states is \
represented by\>\"", ",", "Yield", ",", "\[IndentingNewLine]", 
     RowBox[{"En", "[", 
      RowBox[{"s", ",", "j", ",", "d"}], "]"}], ",", 
     "\"\<, where s={0,p} for the {unperturbed,perturbed} states and \
j={0,1,...} indicates energy levels, and d, if present, indicates d-th order \
expansion in \[Lambda].\>\"", " ", ",", "\"\<\\nThe eigenstates are\>\"", ",",
      "Yield", ",", "\[IndentingNewLine]", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"s", ",", "j", ",", "d"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False], ",", 
     "\"\<\\n(The {} is needed because Quantum Notation commutes the BraKet \
parameters.)\>\""}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Eigenvalues correction O[\[Lambda]]-level\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<Full equation for level j: \>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{"H", ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"p", ",", "j"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}], "\[Rule]", 
      RowBox[{
       RowBox[{"En", "[", 
        RowBox[{"p", ",", "j"}], "]"}], 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"p", ",", "j"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}]}], ",", "Imply", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", "subH"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "expand", " ", "in", " ", "terms", " ", "of", " ", "unperturbed", " ", 
       RowBox[{"quantities", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"subp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"p", ",", "j_"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False], "->", 
         RowBox[{
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j"}], "}"}],
             Quantum`Notation`zz080KetArgs,
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           Editable->False,
           Selectable->False], "+", 
          RowBox[{"\[Lambda]", 
           TagBox[
            RowBox[{"\[VerticalSeparator]", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"0", ",", "j", ",", "1"}], "}"}],
              Quantum`Notation`zz080KetArgs,
              Editable->True,
              Selectable->True], "\[RightAngleBracket]"}],
            Quantum`Notation`zz080Ket,
            Editable->False,
            Selectable->False]}]}]}], ",", 
        RowBox[{
         RowBox[{"En", "[", 
          RowBox[{"p", ",", "j_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"En", "[", 
           RowBox[{"0", ",", "j"}], "]"}], "+", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"En", "[", 
            RowBox[{"0", ",", "j", ",", "1"}], "]"}]}]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "/.", "subp"}], "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{
         SuperscriptBox["\[Lambda]", "2"], "\[Rule]", "0"}]}], "/.", 
       RowBox[{
        RowBox[{"H0", ".", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "j_"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}], "\[Rule]", 
        RowBox[{
         RowBox[{"En", "[", 
          RowBox[{"0", ",", "j"}], "]"}], " ", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "j"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp1", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"#", ",", "\[Lambda]", ",", "0"}], "]"}], "&"}], ",", 
        "tmp"}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"zero", " ", "order", " ", "term"}], "*)"}], ";", 
     "\[IndentingNewLine]", "\"\<First order:  \>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"#", ",", "\[Lambda]", ",", "1"}], "]"}], "&"}], ",", 
       "tmp"}], "]"}]}], 
    RowBox[{"(*", 
     RowBox[{"first", " ", "order", " ", "term"}], "*)"}], ",", "Imply", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           TagBox[
            RowBox[{"\[LeftAngleBracket]", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"0", ",", "j"}], "}"}],
              Quantum`Notation`zz080BraArgs,
              Editable->True,
              Selectable->True], "\[VerticalSeparator]"}],
            Quantum`Notation`zz080Bra,
            Editable->False,
            Selectable->False], ".", "#"}], "&"}], ",", "tmp1"}], "]"}], "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", "H0"}], "\[Rule]", 
         RowBox[{
          RowBox[{"En", "[", 
           RowBox[{"0", ",", "j"}], "]"}], " ", 
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False]}]}]}], "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{
         TagBox[
          RowBox[{"\[LeftAngleBracket]", 
           TagBox["a_",
            Quantum`Notation`zz080BraArgs,
            Editable->True,
            Selectable->True], "\[VerticalSeparator]"}],
          Quantum`Notation`zz080Bra,
          Editable->False,
          Selectable->False], ".", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox["a_",
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}], "\[Rule]", "1"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmpE11", "=", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Equal", ",", "tmp"}], "]"}], "//", "Simplify"}]}], 
     RowBox[{"(*", 
      RowBox[{"first", " ", "order", " ", "energy", " ", 
       RowBox[{"correction", "."}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"subEj1", "=", 
      RowBox[{
       RowBox[{"tmpE11", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"tmpE11", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0VtImgEYBuCfVnagA4ugCKG8sWwFYQcjSraMEdQuqm3RKCptdLAwpkZY
riIJYx2IokUENthgOHROOm6VlTGjw08nK+qmSXMpUmRZAwfrf/+Ljwe+7734
4GUJJUWvfQiCYFMD9XtCgYZ0PDlmBr+AAbr0MljxrlIEjcUW/y+UyTOjQbCe
4ev9QZnAKaT999RIzFP2co984NDlJgNGp7yMgi05jTFweDAuE/4y3/HhoUJQ
Cztirhqg1XQkga0FPBn8I6qSw88ETwGXnBPt9F5p7YLefIUadtuq++F22u9P
MDGT/w2uumInoVYjnYPsdtV3KN1QmaBtJHQNyj+En0KVVWyn//rLckGSs+OG
N8bzW5hh/++/QHmm44VAMu8N7WjzUDh8T+gSoUErToOeCQ8f7jOzBHCdfFUK
xxzSKljXdC6k8/KVWtjYJ2qD0ycSPXz8oNwMZxkyC1T66bZg9272LgyKddAW
LB2oltFbzU81zCrtGoB5bxcGod0yPkXfZX0mmPrQRcIcTfkZHG/gBq6gz8gS
Fow4JdnQEO2hdXZ+fQTX+y+S4IjLwIUfe9S58NlimM2CfPqlE7ZpS9ww/nnu
NbwH2oxqTg==
  "]],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Define the Hamiltonian as the sum of the pure harmonic \
oscillator Hamiltonian, H0, and the perturbative Hamiltonian, H1, where \
\[Lambda] is the smallness factor\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"H", "\[Rule]", 
    RowBox[{"H0", "+", 
     RowBox[{"H1", " ", "\[Lambda]"}]}]}], 
   "\[InvisibleSpace]", "\<\"\\nand energy eigenvalues for perturbed and \
unperturbed states is represented by\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"En", "[", 
    RowBox[{"s", ",", "j", ",", "d"}], "]"}], 
   "\[InvisibleSpace]", "\<\", where s={0,p} for the {unperturbed,perturbed} \
states and j={0,1,...} indicates energy levels, and d, if present, indicates \
d-th order expansion in \[Lambda].\"\>", 
   "\[InvisibleSpace]", "\<\"\\nThe eigenstates are\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"\[VerticalSeparator]", 
     TagBox[
      RowBox[{"{", 
       RowBox[{"s", ",", "j", ",", "d"}], "}"}],
      Quantum`Notation`zz080KetArgs,
      Editable->True,
      Selectable->True], "\[RightAngleBracket]"}],
    Quantum`Notation`zz080Ket,
    Editable->False,
    Selectable->False], 
   "\[InvisibleSpace]", "\<\"\\n(The {} is needed because Quantum Notation \
commutes the BraKet parameters.)\"\>"}],
  SequenceForm[
  "Define the Hamiltonian as the sum of the pure harmonic oscillator \
Hamiltonian, H0, and the perturbative Hamiltonian, H1, where \[Lambda] is the \
smallness factor", 
   "\n\[RightArrow] ", $CellContext`H -> $CellContext`H0 + $CellContext`H1 \
$CellContext`\[Lambda], 
   "\nand energy eigenvalues for perturbed and unperturbed states is \
represented by", "\n\[RightArrow] ", 
   $CellContext`En[$CellContext`s, $CellContext`j, $CellContext`d], 
   ", where s={0,p} for the {unperturbed,perturbed} states and j={0,1,...} \
indicates energy levels, and d, if present, indicates d-th order expansion in \
\[Lambda].", "\nThe eigenstates are", "\n\[RightArrow] ", 
   Quantum`Notation`zz080Ket[{$CellContext`s, $CellContext`j, \
$CellContext`d}], 
   "\n(The {} is needed because Quantum Notation commutes the BraKet \
parameters.)"],
  Editable->False]], "Print",
 CellChangeTimes->{3.46421316436141*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Eigenvalues correction O[\[Lambda]]-level\\n\"\>", 
   "\[InvisibleSpace]", "\<\"Full equation for level j: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"H", ".", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"p", ",", "j"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}], "\[Rule]", 
    RowBox[{
     RowBox[{"En", "[", 
      RowBox[{"p", ",", "j"}], "]"}], " ", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"p", ",", "j"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}]}], 
   "\[InvisibleSpace]", "\<\"\\n\[DoubleRightArrow] \"\>", 
   "\[InvisibleSpace]", "\<\"First order:  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"H0", ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j", ",", "1"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}], "+", 
     RowBox[{"H1", ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"En", "[", 
       RowBox[{"0", ",", "j", ",", "1"}], "]"}], " ", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}], "+", 
     RowBox[{
      RowBox[{"En", "[", 
       RowBox[{"0", ",", "j"}], "]"}], " ", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j", ",", "1"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}]}]}], 
   "\[InvisibleSpace]", "\<\"\\n\[DoubleRightArrow] \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "j"}], "}"}],
        Quantum`Notation`zz080BraArgs,
        Editable->True,
        Selectable->True], "\[VerticalSeparator]"}],
      Quantum`Notation`zz080Bra,
      Editable->False,
      Selectable->False], ".", "H1", ".", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "j"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}], "\[Rule]", 
    RowBox[{"En", "[", 
     RowBox[{"0", ",", "j", ",", "1"}], "]"}]}]}],
  SequenceForm[
  "Eigenvalues correction O[\[Lambda]]-level\n", 
   "Full equation for level j: ", Dot[$CellContext`H, 
     Quantum`Notation`zz080Ket[{$CellContext`p, $CellContext`j}]] -> \
$CellContext`En[$CellContext`p, $CellContext`j] 
    Quantum`Notation`zz080Ket[{$CellContext`p, $CellContext`j}], 
   "\n\[DoubleRightArrow] ", "First order:  ", Dot[$CellContext`H0, 
      Quantum`Notation`zz080Ket[{0, $CellContext`j, 1}]] + 
    Dot[$CellContext`H1, 
      Quantum`Notation`zz080Ket[{0, $CellContext`j}]] -> $CellContext`En[
      0, $CellContext`j, 1] 
     Quantum`Notation`zz080Ket[{0, $CellContext`j}] + $CellContext`En[
      0, $CellContext`j] Quantum`Notation`zz080Ket[{0, $CellContext`j, 1}], 
   "\n\[DoubleRightArrow] ", Dot[
     Quantum`Notation`zz080Bra[{0, $CellContext`j}], $CellContext`H1, 
     Quantum`Notation`zz080Ket[{0, $CellContext`j}]] -> $CellContext`En[
    0, $CellContext`j, 1]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464213164578229*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Assume unit[n] is a decomposition of unity where \!\(\*TagBox[
RowBox[{\"\[VerticalSeparator]\", TagBox[
RowBox[{\"{\", 
RowBox[{\"0\", \",\", \"n\"}], \"}\"}],
Quantum`Notation`zz080KetArgs,
Editable->True,
Selectable->True], \"\[RightAngleBracket]\"}],
Quantum`Notation`zz080Ket,
Editable->False,
Selectable->False]\) is singled out and orthogonal to all other vectors.\>\"",
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"unit", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           TagBox[
            RowBox[{"\[VerticalSeparator]", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"0", ",", "k"}], "}"}],
              Quantum`Notation`zz080KetArgs,
              Editable->True,
              Selectable->True], "\[RightAngleBracket]"}],
            Quantum`Notation`zz080Ket,
            Editable->False,
            Selectable->False], ".", 
           TagBox[
            RowBox[{"\[LeftAngleBracket]", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"0", ",", "k"}], "}"}],
              Quantum`Notation`zz080BraArgs,
              Editable->True,
              Selectable->True], "\[VerticalSeparator]"}],
            Quantum`Notation`zz080Bra,
            Editable->False,
            Selectable->False]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"k", "\[NotEqual]", "n"}]}], "}"}]}], "]"}], "+", 
        RowBox[{
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "n"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False], ".", 
         TagBox[
          RowBox[{"\[LeftAngleBracket]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "n"}], "}"}],
            Quantum`Notation`zz080BraArgs,
            Editable->True,
            Selectable->True], "\[VerticalSeparator]"}],
          Quantum`Notation`zz080Bra,
          Editable->False,
          Selectable->False]}]}]}], ";", "\[IndentingNewLine]", 
      "\"\<For example, \>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"unit", "[", "1", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.463853689448639*^9, 3.463853836676571*^9}, {
  3.463853867791623*^9, 3.463854338147911*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Assume unit[n] is a decomposition of unity where \
\\!\\(\\*TagBox[\\n RowBox[{\\\"\[VerticalSeparator]\\\", TagBox[\\n   \
RowBox[{\\\"{\\\", \\n    RowBox[{\\\"0\\\", \\\",\\\", \\\"n\\\"}], \
\\\"}\\\"}],\\n   \
Quantum`Notation`zz080KetArgs,\\nEditable->True,\\nSelectable->True], \\\"\
\[RightAngleBracket]\\\"}],\\n \
Quantum`Notation`zz080Ket,\\nEditable->False,\\nSelectable->False]\\) is \
singled out and orthogonal to all other vectors.\"\>", 
   "\[InvisibleSpace]", "\<\"For example, \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False], ".", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}],
        Quantum`Notation`zz080BraArgs,
        Editable->True,
        Selectable->True], "\[VerticalSeparator]"}],
      Quantum`Notation`zz080Bra,
      Editable->False,
      Selectable->False]}], "+", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "k", 
      RowBox[{"k", "\[NotEqual]", "1"}]], 
     RowBox[{
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "k"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False], ".", 
      TagBox[
       RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "k"}], "}"}],
         Quantum`Notation`zz080BraArgs,
         Editable->True,
         Selectable->True], "\[VerticalSeparator]"}],
       Quantum`Notation`zz080Bra,
       Editable->False,
       Selectable->False]}]}]}]}],
  SequenceForm[
  "Assume unit[n] is a decomposition of unity where \!\(\*TagBox[\n \
RowBox[{\"\[VerticalSeparator]\", TagBox[\n   RowBox[{\"{\", \n    \
RowBox[{\"0\", \",\", \"n\"}], \"}\"}],\n   Quantum`Notation`zz080KetArgs,\n\
Editable->True,\nSelectable->True], \"\[RightAngleBracket]\"}],\n \
Quantum`Notation`zz080Ket,\nEditable->False,\nSelectable->False]\) is singled \
out and orthogonal to all other vectors.", "For example, ", Dot[
     Quantum`Notation`zz080Ket[{0, 1}], 
     Quantum`Notation`zz080Bra[{0, 1}]] + Sum[
     Dot[
      Quantum`Notation`zz080Ket[{0, $CellContext`k}], 
      Quantum`Notation`zz080Bra[{
       0, $CellContext`k}]], {$CellContext`k, $CellContext`k != 1}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464213168273937*^9}]
}, Open  ]],

Cell["\<\
Compute purturbed eigenstates--Decompose first order equation into eigenstates\
\>", "Text",
 CellChangeTimes->{3.463854507155856*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Compute perturbed Hamiltonian on \!\(\*TagBox[
RowBox[{\"\[VerticalSeparator]\", TagBox[
RowBox[{\"{\", 
RowBox[{\"0\", \",\", \"j\"}], \"}\"}],
Quantum`Notation`zz080KetArgs,
Editable->True,
Selectable->True], \"\[RightAngleBracket]\"}],
Quantum`Notation`zz080Ket,
Editable->False,
Selectable->False]\): \>\"", ",", "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"H1", ".", 
        TagBox[
         RowBox[{"\[VerticalSeparator]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "j"}], "}"}],
           Quantum`Notation`zz080KetArgs,
           Editable->True,
           Selectable->True], "\[RightAngleBracket]"}],
         Quantum`Notation`zz080Ket,
         Editable->False,
         Selectable->False]}], "\[Equal]", 
       RowBox[{
        RowBox[{"unit", "[", "j", "]"}], ".", "H1", ".", 
        TagBox[
         RowBox[{"\[VerticalSeparator]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "j"}], "}"}],
           Quantum`Notation`zz080KetArgs,
           Editable->True,
           Selectable->True], "\[RightAngleBracket]"}],
         Quantum`Notation`zz080Ket,
         Editable->False,
         Selectable->False]}]}]}], ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"apply", " ", "above", " ", "expression", " ", "for", " ", 
       RowBox[{"E1", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tmp1a", "=", 
      RowBox[{
       RowBox[{"tmp", "/.", "subEj1"}], "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"subtract", " ", "O", 
       RowBox[{"(", "\[Lambda]", ")"}], " ", "H", " ", "equation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp1a", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"tmp1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "==", 
       RowBox[{
        RowBox[{"tmp1a", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"tmp1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"assume", " ", "non"}], "-", 
        RowBox[{"degenerate", " ", "states"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"apply", " ", "unperturbed", " ", "eigenstates"}], " ", "<", 
         "k"}], "|"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            TagBox[
             RowBox[{"\[LeftAngleBracket]", 
              TagBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "k"}], "}"}],
               Quantum`Notation`zz080BraArgs,
               Editable->True,
               Selectable->True], "\[VerticalSeparator]"}],
             Quantum`Notation`zz080Bra,
             Editable->False,
             Selectable->False], ".", "#"}], "&"}], ",", "tmp"}], "]"}], "/.", 
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", 
          RowBox[{"Sum", "[", 
           RowBox[{"_", ",", "_"}], "]"}]}], "->", 
         TagBox[
          RowBox[{"\[LeftAngleBracket]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "k"}], "}"}],
            Quantum`Notation`zz080BraArgs,
            Editable->True,
            Selectable->True], "\[VerticalSeparator]"}],
          Quantum`Notation`zz080Bra,
          Editable->False,
          Selectable->False]}]}], "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", "H0"}], "\[Rule]", 
         RowBox[{
          RowBox[{"En", "[", 
           RowBox[{"0", ",", "k"}], "]"}], " ", 
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False]}]}]}], "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{
         TagBox[
          RowBox[{"\[LeftAngleBracket]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "k"}], "}"}],
            Quantum`Notation`zz080BraArgs,
            Editable->True,
            Selectable->True], "\[VerticalSeparator]"}],
          Quantum`Notation`zz080Bra,
          Editable->False,
          Selectable->False], ".", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "j"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}], "\[Rule]", "0"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"eigenstates", " ", "non"}], "-", "degenerate"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sub", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j", ",", "1"}], "}"}],
             Quantum`Notation`zz080KetArgs,
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           Editable->False,
           Selectable->False]}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "j", ",", "1"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False], "\[Equal]", 
       RowBox[{
        RowBox[{"unit", "[", "j", "]"}], ".", 
        TagBox[
         RowBox[{"\[VerticalSeparator]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "j", ",", "1"}], "}"}],
           Quantum`Notation`zz080KetArgs,
           Editable->True,
           Selectable->True], "\[RightAngleBracket]"}],
         Quantum`Notation`zz080Ket,
         Editable->False,
         Selectable->False]}]}]}], 
     RowBox[{"(*", 
      RowBox[{"spectral", " ", "decompose"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ".", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j", ",", "1"}], "}"}],
             Quantum`Notation`zz080KetArgs,
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           Editable->False,
           Selectable->False]}], "\[Rule]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"a", ".", 
            TagBox[
             RowBox[{"\[VerticalSeparator]", 
              TagBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "j", ",", "1"}], "}"}],
               Quantum`Notation`zz080KetArgs,
               Editable->True,
               Selectable->True], "\[RightAngleBracket]"}],
             Quantum`Notation`zz080Ket,
             Editable->False,
             Selectable->False]}], ",", "b"}], "]"}]}]}], "/.", "sub"}]}], 
     ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpeigen", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{
         TagBox[
          RowBox[{"\[LeftAngleBracket]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "j"}], "}"}],
            Quantum`Notation`zz080BraArgs,
            Editable->True,
            Selectable->True], "\[VerticalSeparator]"}],
          Quantum`Notation`zz080Bra,
          Editable->False,
          Selectable->False], ".", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "j", ",", "1"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}], "\[Rule]", "0"}]}]}]}]}], 
   RowBox[{"(*", 
    RowBox[{"assume", " ", 
     RowBox[{"orthogonal", "."}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4638545354388113`*^9, 3.463854615098618*^9}, {
  3.463855445478401*^9, 3.463855447502253*^9}, {3.463855479614511*^9, 
  3.4638554828616247`*^9}, {3.4638556412390823`*^9, 3.4638556606359243`*^9}, {
  3.463855695480586*^9, 3.4638557040934877`*^9}, {3.463856051838024*^9, 
  3.46385610283834*^9}, {3.46385613913729*^9, 3.4638561454204817`*^9}, {
  3.46385617664157*^9, 3.4638562121133423`*^9}, {3.4638562451500053`*^9, 
  3.463856354228709*^9}, {3.463856431273888*^9, 3.463856448503297*^9}, {
  3.463865114935089*^9, 3.463865163720119*^9}, {3.4638652023976297`*^9, 
  3.4638652364479933`*^9}, {3.4638652938046923`*^9, 3.463865341253269*^9}, {
  3.4638653787442007`*^9, 3.463865538656794*^9}, {3.4638656233532763`*^9, 
  3.463865628503222*^9}, {3.4638658175726843`*^9, 3.463865836253141*^9}, {
  3.463865869627548*^9, 3.463865968500469*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Compute perturbed Hamiltonian on \\!\\(\\*TagBox[\\n \
RowBox[{\\\"\[VerticalSeparator]\\\", TagBox[\\n   RowBox[{\\\"{\\\", \\n    \
RowBox[{\\\"0\\\", \\\",\\\", \\\"j\\\"}], \\\"}\\\"}],\\n   \
Quantum`Notation`zz080KetArgs,\\nEditable->True,\\nSelectable->True], \\\"\
\[RightAngleBracket]\\\"}],\\n \
Quantum`Notation`zz080Ket,\\nEditable->False,\\nSelectable->False]\\): \"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    TagBox[
     RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "j", ",", "1"}], "}"}],
       Quantum`Notation`zz080KetArgs,
       Editable->True,
       Selectable->True], "\[RightAngleBracket]"}],
     Quantum`Notation`zz080Ket,
     Editable->False,
     Selectable->False], "\[Equal]", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "k", 
      RowBox[{"k", "\[NotEqual]", "j"}]], 
     RowBox[{
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "k"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False], ".", 
      FractionBox[
       RowBox[{
        TagBox[
         RowBox[{"\[LeftAngleBracket]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "k"}], "}"}],
           Quantum`Notation`zz080BraArgs,
           Editable->True,
           Selectable->True], "\[VerticalSeparator]"}],
         Quantum`Notation`zz080Bra,
         Editable->False,
         Selectable->False], ".", "H1", ".", 
        TagBox[
         RowBox[{"\[VerticalSeparator]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "j"}], "}"}],
           Quantum`Notation`zz080KetArgs,
           Editable->True,
           Selectable->True], "\[RightAngleBracket]"}],
         Quantum`Notation`zz080Ket,
         Editable->False,
         Selectable->False]}], 
       RowBox[{
        RowBox[{"En", "[", 
         RowBox[{"0", ",", "j"}], "]"}], "-", 
        RowBox[{"En", "[", 
         RowBox[{"0", ",", "k"}], "]"}]}]]}]}]}]}],
  SequenceForm[
  "Compute perturbed Hamiltonian on \!\(\*TagBox[\n RowBox[{\"\
\[VerticalSeparator]\", TagBox[\n   RowBox[{\"{\", \n    RowBox[{\"0\", \
\",\", \"j\"}], \"}\"}],\n   Quantum`Notation`zz080KetArgs,\nEditable->True,\n\
Selectable->True], \"\[RightAngleBracket]\"}],\n Quantum`Notation`zz080Ket,\n\
Editable->False,\nSelectable->False]\): ", "\n\[RightArrow] ", 
   Quantum`Notation`zz080Ket[{0, $CellContext`j, 1}] == Sum[
     Dot[
      Quantum`Notation`zz080Ket[{0, $CellContext`k}], Dot[
        Quantum`Notation`zz080Bra[{0, $CellContext`k}], $CellContext`H1, 
        Quantum`Notation`zz080Ket[{0, $CellContext`j}]]/($CellContext`En[
       0, $CellContext`j] - $CellContext`En[
      0, $CellContext`k])], {$CellContext`k, $CellContext`k != \
$CellContext`j}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464213172468502*^9}]
}, Open  ]],

Cell["Define Q,P operations on eigenvectors.", "Text",
 CellChangeTimes->{{3.463766504989683*^9, 3.463766530431685*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"subQP", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Q", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", 
         SuperscriptBox["a", "\[Dagger]"]}], ")"}], "/", 
       SqrtBox[
        RowBox[{"2", " ", "\[Omega]"}]]}]}], ",", 
     RowBox[{"P", "\[Rule]", 
      RowBox[{"\[ImaginaryI]", 
       SqrtBox[
        RowBox[{" ", 
         RowBox[{"\[Omega]", "/", "2"}]}]], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "\[Dagger]"], "-", "a"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"a", ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"s_", ",", "n_"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}], ":>", 
      RowBox[{
       SqrtBox["n"], 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "\[Dagger]"], ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"s_", ",", "n_"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}], ":>", 
      RowBox[{
       SqrtBox[
        RowBox[{"n", "+", "1"}]], 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}], ",", 
     RowBox[{
      RowBox[{
       TagBox[
        RowBox[{"\[LeftAngleBracket]", 
         TagBox["a_",
          Quantum`Notation`zz080BraArgs,
          Editable->True,
          Selectable->True], "\[VerticalSeparator]"}],
        Quantum`Notation`zz080Bra,
        Editable->False,
        Selectable->False], ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox["a_",
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}], "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{
       TagBox[
        RowBox[{"\[LeftAngleBracket]", 
         TagBox["a_",
          Quantum`Notation`zz080BraArgs,
          Editable->True,
          Selectable->True], "\[VerticalSeparator]"}],
        Quantum`Notation`zz080Bra,
        Editable->False,
        Selectable->False], ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox["b_",
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}], "\[RuleDelayed]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpQP", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp", "=", "exp"}], ",", 
       RowBox[{"tmpl", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"tmpl", "=!=", "tmp"}], ",", 
        RowBox[{
         RowBox[{"tmpl", "=", "tmp"}], ";", " ", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", "//.", "subQP"}]}], ";", 
         RowBox[{"tmp", "=", 
          RowBox[{"dotRetain", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", 
              SuperscriptBox["a", "\[Dagger]"], ",", 
              TagBox[
               RowBox[{"\[VerticalSeparator]", 
                TagBox["_",
                 Quantum`Notation`zz080KetArgs,
                 Editable->True,
                 Selectable->True], "\[RightAngleBracket]"}],
               Quantum`Notation`zz080Ket,
               Editable->False,
               Selectable->False], ",", 
              TagBox[
               RowBox[{"\[LeftAngleBracket]", 
                TagBox["_",
                 Quantum`Notation`zz080BraArgs,
                 Editable->True,
                 Selectable->True], "\[VerticalSeparator]"}],
               Quantum`Notation`zz080Bra,
               Editable->False,
               Selectable->False]}], "}"}], ",", "tmp"}], "]"}]}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", "tmpl"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<With these definitions:\\n\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Q", ".", "P"}], "-", 
         RowBox[{"P", ".", "Q"}]}], ")"}], ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "j"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}], ";", 
     RowBox[{"tmp", "->", 
      RowBox[{"OpQP", "[", "tmp", "]"}]}]}], ",", "\"\<\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"Q", ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}], ";", 
     RowBox[{"tmp", "->", 
      RowBox[{"OpQP", "[", "tmp", "]"}]}]}], ",", "\"\<\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"P", ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}], ";", 
     RowBox[{"tmp", "->", 
      RowBox[{"OpQP", "[", "tmp", "]"}]}]}], ",", "\"\<\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{
       TagBox[
        RowBox[{"\[LeftAngleBracket]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}],
          Quantum`Notation`zz080BraArgs,
          Editable->True,
          Selectable->True], "\[VerticalSeparator]"}],
        Quantum`Notation`zz080Bra,
        Editable->False,
        Selectable->False], ".", "P", ".", "P", ".", 
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False]}]}], ";", 
     RowBox[{"tmp", "->", 
      RowBox[{"OpQP", "[", "tmp", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.463709625380094*^9, 3.463709668696252*^9}, {
   3.463709728962854*^9, 3.46370988141442*^9}, {3.4637102487031517`*^9, 
   3.463710341904772*^9}, {3.463710412914671*^9, 3.463710520337859*^9}, {
   3.4637105520043087`*^9, 3.46371063587606*^9}, {3.463710815902444*^9, 
   3.4637109042787724`*^9}, {3.463764245294818*^9, 3.463764248618122*^9}, {
   3.463764389173024*^9, 3.46376444524553*^9}, {3.4637644927563267`*^9, 
   3.463764496239911*^9}, {3.463764539140297*^9, 3.463764544771303*^9}, {
   3.463765852433803*^9, 3.4637661777025146`*^9}, 3.463766221373547*^9, {
   3.463766309606349*^9, 3.463766383723907*^9}, {3.4637664142915697`*^9, 
   3.4637664436730337`*^9}, {3.463766582680923*^9, 3.46376660097744*^9}, {
   3.4637666352386923`*^9, 3.463766685929249*^9}, {3.463766729627223*^9, 
   3.463766911738578*^9}, {3.4637671417705603`*^9, 3.463767183267219*^9}, {
   3.4637672168366413`*^9, 3.463767236897846*^9}, {3.4637673103172073`*^9, 
   3.46376732611092*^9}, {3.463767371940419*^9, 3.463767435254086*^9}, {
   3.463767847795207*^9, 3.463767858008278*^9}, {3.463768442444828*^9, 
   3.4637684527268667`*^9}, {3.463768488400415*^9, 3.4637685065900087`*^9}, {
   3.463769635883807*^9, 3.463769644312147*^9}, {3.463769992437737*^9, 
   3.463770003916833*^9}, {3.463874134331174*^9, 3.463874183262759*^9}, {
   3.463874218107539*^9, 3.463874300224196*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"With these definitions:\\n\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", 
        RowBox[{"P", ".", "Q"}]}], ")"}], ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}], "+", 
     RowBox[{"Q", ".", "P", ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}]}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "j"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}]}], "\[InvisibleSpace]", "\<\"\\n\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Q", ".", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}], "\[Rule]", 
    FractionBox[
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False], 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["\[Omega]"]}]]}], "\[InvisibleSpace]", "\<\"\\n\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"P", ".", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}], "\[Rule]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox["\[Omega]"], " ", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}], 
     SqrtBox["2"]]}], "\[InvisibleSpace]", "\<\"\\n\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}],
        Quantum`Notation`zz080BraArgs,
        Editable->True,
        Selectable->True], "\[VerticalSeparator]"}],
      Quantum`Notation`zz080Bra,
      Editable->False,
      Selectable->False], ".", "P", ".", "P", ".", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}], "\[Rule]", 
    FractionBox["\[Omega]", "2"]}]}],
  SequenceForm[
  "With these definitions:\n", Dot[-Dot[$CellContext`P, $CellContext`Q], 
      Quantum`Notation`zz080Ket[{0, $CellContext`j}]] + 
    Dot[$CellContext`Q, $CellContext`P, 
      Quantum`Notation`zz080Ket[{0, $CellContext`j}]] -> 
   Complex[0, 1] Quantum`Notation`zz080Ket[{0, $CellContext`j}], "\n", 
   Dot[$CellContext`Q, 
     Quantum`Notation`zz080Ket[{0, 0}]] -> 
   2^Rational[-1, 2] $CellContext`\[Omega]^Rational[-1, 2] 
    Quantum`Notation`zz080Ket[{0, 1}], "\n", Dot[$CellContext`P, 
     Quantum`Notation`zz080Ket[{0, 0}]] -> 
   Complex[0, 1] 2^Rational[-1, 2] $CellContext`\[Omega]^Rational[1, 2] 
    Quantum`Notation`zz080Ket[{0, 1}], "\n", Dot[
     Quantum`Notation`zz080Bra[{0, 0}], $CellContext`P, $CellContext`P, 
     Quantum`Notation`zz080Ket[{0, 0}]] -> 
   Rational[1, 2] $CellContext`\[Omega]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464213175156502*^9}]
}, Open  ]],

Cell["\<\
The eigenvalue correction for each unperturbed eigenvalue for the provided \
conditions\
\>", "Text",
 CellChangeTimes->{{3.463676970118113*^9, 3.463676978451078*^9}, {
  3.463682918343893*^9, 3.46368293519304*^9}, {3.46376754725806*^9, 
  3.4637675660701113`*^9}, {3.463879759482233*^9, 3.4638797969078407`*^9}, {
  3.4638798820224667`*^9, 3.463879888404036*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<The perturbation to the unperturbed energy states:\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"subEj1", "/.", "tmpH1"}], "/.", 
          RowBox[{
           SubscriptBox["Z", "\[Omega]"], "\[Rule]", 
           RowBox[{"1", "+", "B"}]}]}], "/.", 
         RowBox[{
          SubscriptBox["Z", "\[Lambda]"], "\[Rule]", "1"}]}], "/.", 
        RowBox[{"Z", "\[Rule]", 
         RowBox[{"1", "+", "A"}]}]}], "/.", 
       RowBox[{
        SuperscriptBox["P", "n_"], ":>", 
        RowBox[{"DotPower", "[", 
         RowBox[{"P", ",", "n"}], "]"}]}]}], "/.", 
      RowBox[{
       SuperscriptBox["Q", "n_"], ":>", 
       RowBox[{"DotPower", "[", 
        RowBox[{"Q", ",", "n"}], "]"}]}]}]}], ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"OpQP", "[", "tmp", "]"}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     "\"\<\\nThen to O(\[Lambda]) with the substitutions: \>\""}], ",", 
    RowBox[{"sub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", 
        RowBox[{
         SubscriptBox["\[Kappa]", "A"], "\[Lambda]"}]}], ",", 
       RowBox[{"B", "\[Rule]", 
        RowBox[{
         SubscriptBox["\[Kappa]", "B"], "\[Lambda]"}]}]}], "}"}]}], ",", 
    "\"\< the perturbation for the j-th level becomes\>\"", ",", "Imply", ",",
     "\[IndentingNewLine]", 
    RowBox[{"perturbEigenvalueJ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "sub"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
       "Normal"}], "//", "Simplify"}]}], ",", "\[IndentingNewLine]", 
    "\"\<\\nFor example j=0: \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"perturbEigenvalueJ", "/.", 
     RowBox[{"j", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.463767617563155*^9, 3.4637676364235573`*^9}, {
  3.463767703163599*^9, 3.4637677878598413`*^9}, {3.463767817890731*^9, 
  3.463767829214291*^9}, {3.463769320802227*^9, 3.4637693236128063`*^9}, {
  3.463770398840775*^9, 3.463770400791711*^9}, {3.463771375017207*^9, 
  3.463771383749629*^9}, {3.46387968699358*^9, 3.463879695845666*^9}, {
  3.463879808665102*^9, 3.4638798333183517`*^9}, {3.463879867140745*^9, 
  3.463879938184169*^9}, {3.463879970947752*^9, 3.463879976921145*^9}, {
  3.4638800080219793`*^9, 3.463880034700329*^9}, {3.463880110514007*^9, 
  3.463880119081182*^9}, {3.463880217251979*^9, 3.4638802185075274`*^9}, {
  3.4638803123973923`*^9, 3.463880314155943*^9}, {3.4638804617541637`*^9, 
  3.4638805608598948`*^9}, {3.4638806177403183`*^9, 3.463880658202711*^9}, {
  3.4638808115432167`*^9, 3.46388083620849*^9}, {3.463881008150119*^9, 
  3.463881058896653*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The perturbation to the unperturbed energy states:\\n\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{
      TagBox[
       RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080BraArgs,
         Editable->True,
         Selectable->True], "\[VerticalSeparator]"}],
       Quantum`Notation`zz080Bra,
       Editable->False,
       Selectable->False], ".", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox["1", 
           RowBox[{"1", "+", "A"}]]}], ")"}], " ", 
        RowBox[{"P", ".", "P"}]}], ")"}], ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}], "+", 
     RowBox[{
      TagBox[
       RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080BraArgs,
         Editable->True,
         Selectable->True], "\[VerticalSeparator]"}],
       Quantum`Notation`zz080Bra,
       Editable->False,
       Selectable->False], ".", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], " ", "B", " ", 
        SuperscriptBox["\[Omega]", "2"], " ", 
        RowBox[{"Q", ".", "Q"}]}], ")"}], ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}], "+", 
     RowBox[{
      TagBox[
       RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080BraArgs,
         Editable->True,
         Selectable->True], "\[VerticalSeparator]"}],
       Quantum`Notation`zz080Bra,
       Editable->False,
       Selectable->False], ".", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", " ", 
        SuperscriptBox["\[Omega]", "3"], " ", 
        RowBox[{"Q", ".", "Q", ".", "Q", ".", "Q"}]}], ")"}], ".", 
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "j"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False]}]}], "\[Rule]", 
    RowBox[{"En", "[", 
     RowBox[{"0", ",", "j", ",", "1"}], "]"}]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", 
   "\[InvisibleSpace]", "\<\"\\nThen to O(\[Lambda]) with the substitutions: \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", 
      RowBox[{"\[Lambda]", " ", 
       SubscriptBox["\[Kappa]", "A"]}]}], ",", 
     RowBox[{"B", "\[Rule]", 
      RowBox[{"\[Lambda]", " ", 
       SubscriptBox["\[Kappa]", "B"]}]}]}], "}"}], 
   "\[InvisibleSpace]", "\<\" the perturbation for the j-th level \
becomes\"\>", "\[InvisibleSpace]", "\<\"\\n\[DoubleRightArrow] \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[Lambda]", " ", "\[Omega]", " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"6", " ", "j"}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["j", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "j"}]}], ")"}], " ", 
       SubscriptBox["\[Kappa]", "A"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "j"}]}], ")"}], " ", 
       SubscriptBox["\[Kappa]", "B"]}]}], ")"}]}], 
   "\[InvisibleSpace]", "\<\"\\nFor example j=0: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[Lambda]", " ", "\[Omega]", " ", 
    RowBox[{"(", 
     RowBox[{"3", "-", 
      SubscriptBox["\[Kappa]", "A"], "+", 
      SubscriptBox["\[Kappa]", "B"]}], ")"}]}]}],
  SequenceForm["The perturbation to the unperturbed energy states:\n", Dot[
      Quantum`Notation`zz080Bra[{0, $CellContext`j}], 
      Rational[1, 2] (-1 + (1 + $CellContext`A)^(-1)) 
      Dot[$CellContext`P, $CellContext`P], 
      Quantum`Notation`zz080Ket[{0, $CellContext`j}]] + Dot[
      Quantum`Notation`zz080Bra[{0, $CellContext`j}], 
      Rational[1, 2] $CellContext`B $CellContext`\[Omega]^2 
      Dot[$CellContext`Q, $CellContext`Q], 
      Quantum`Notation`zz080Ket[{0, $CellContext`j}]] + Dot[
      Quantum`Notation`zz080Bra[{
       0, $CellContext`j}], $CellContext`\[Lambda] $CellContext`\[Omega]^3 
      Dot[$CellContext`Q, $CellContext`Q, $CellContext`Q, $CellContext`Q], 
      Quantum`Notation`zz080Ket[{0, $CellContext`j}]] -> $CellContext`En[
    0, $CellContext`j, 1], "\n\[RightArrow] ", 
   "\nThen to O(\[Lambda]) with the substitutions: ", {$CellContext`A -> \
$CellContext`\[Lambda] 
     Subscript[$CellContext`\[Kappa], $CellContext`A], $CellContext`B -> \
$CellContext`\[Lambda] Subscript[$CellContext`\[Kappa], $CellContext`B]}, 
   " the perturbation for the j-th level becomes", "\n\[DoubleRightArrow] ", 
   Rational[1, 4] $CellContext`\[Lambda] $CellContext`\[Omega] (3 + 
    6 $CellContext`j + 6 $CellContext`j^2 - (1 + 2 $CellContext`j) 
    Subscript[$CellContext`\[Kappa], $CellContext`A] + (1 + 2 $CellContext`j) 
     Subscript[$CellContext`\[Kappa], $CellContext`B]), "\nFor example j=0: ",
    Rational[1, 4] $CellContext`\[Lambda] $CellContext`\[Omega] (3 - 
    Subscript[$CellContext`\[Kappa], $CellContext`A] + 
    Subscript[$CellContext`\[Kappa], $CellContext`B])],
  Editable->False]], "Print",
 CellChangeTimes->{3.464213179147735*^9}]
}, Open  ]],

Cell["The eigenvector correction with the above perturbation.", "Text",
 CellChangeTimes->{{3.463708689297318*^9, 3.4637087002873983`*^9}, {
   3.463711092904394*^9, 3.4637111178500957`*^9}, 3.463767902156376*^9, {
   3.463768150566506*^9, 3.463768160933528*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"tmp", "=", "tmpeigen"}], ",", "Imply", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "/.", "tmpH1"}], "/.", 
          RowBox[{
           SubscriptBox["Z", "\[Omega]"], "\[Rule]", 
           RowBox[{"1", "+", "B"}]}]}], "/.", 
         RowBox[{
          SubscriptBox["Z", "\[Lambda]"], "\[Rule]", "1"}]}], "/.", 
        RowBox[{"Z", "\[Rule]", 
         RowBox[{"1", "+", "A"}]}]}], "/.", 
       RowBox[{
        SuperscriptBox["P", "n_"], ":>", 
        RowBox[{"DotPower", "[", 
         RowBox[{"P", ",", "n"}], "]"}]}]}], "/.", 
      RowBox[{
       SuperscriptBox["Q", "n_"], ":>", 
       RowBox[{"DotPower", "[", 
        RowBox[{"Q", ",", "n"}], "]"}]}]}]}], ",", 
    RowBox[{"Imply", ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "//", 
       RowBox[{
        RowBox[{"DotForm", "[", "#", "]"}], "&"}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"OpQP", "[", "tmp", "]"}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "k"}], "}"}]}], "]"}], "\[Rule]", "0"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "a_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "b_"}], "}"}]}], "]"}], "\[Rule]", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"j", ",", "k"}], "]"}], "\[Rule]", "0"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "//", "SumKronecker"}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", "a"}]}]}], ";", "Yield",
      ";", "\[IndentingNewLine]", 
     "\"\<\\nThen to O(\[Lambda]) with the substitutions: \>\""}], ",", 
    RowBox[{"sub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", 
        RowBox[{
         SubscriptBox["\[Kappa]", "A"], "\[Lambda]"}]}], ",", 
       RowBox[{"B", "\[Rule]", 
        RowBox[{
         SubscriptBox["\[Kappa]", "B"], "\[Lambda]"}]}]}], "}"}]}], ",", 
    "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", "sub"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"perturbEigenvector", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"tmp", ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
        "Normal"}], "//", "Simplify"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.463708718956514*^9, 3.4637087213011208`*^9}, {
   3.463708754730774*^9, 3.4637088730092487`*^9}, {3.463708905850733*^9, 
   3.463708907722816*^9}, {3.463708950153425*^9, 3.463708960242723*^9}, {
   3.463708991901335*^9, 3.4637090180634117`*^9}, {3.463709135099601*^9, 
   3.463709150160571*^9}, {3.463709190986845*^9, 3.4637092119101*^9}, {
   3.463709257380278*^9, 3.463709290467286*^9}, {3.4637111339866056`*^9, 
   3.463711167922929*^9}, {3.463768072360922*^9, 3.463768085254196*^9}, {
   3.46376812382603*^9, 3.463768126817357*^9}, {3.4637681862193527`*^9, 
   3.46376819549892*^9}, {3.463768265328341*^9, 3.463768305504834*^9}, {
   3.463769366584978*^9, 3.4637693829115067`*^9}, {3.463769799082951*^9, 
   3.463769825094594*^9}, 3.463770083350471*^9, {3.463770115253519*^9, 
   3.4637701781340647`*^9}, {3.463770218730299*^9, 3.463770274316987*^9}, {
   3.463770311991694*^9, 3.463770314755711*^9}, {3.463770367922545*^9, 
   3.4637703749344*^9}, {3.463770441892887*^9, 3.463770446069057*^9}, {
   3.4637704854558153`*^9, 3.463770485863752*^9}, 3.463770614698505*^9, {
   3.4637713175821457`*^9, 3.46377135594757*^9}, {3.463915790700433*^9, 
   3.463915792099481*^9}, {3.463915916378063*^9, 3.4639159346219587`*^9}, {
   3.463916477515313*^9, 3.4639165735035048`*^9}, {3.463917252930019*^9, 
   3.463917262756374*^9}, {3.463917296068449*^9, 3.46391730782061*^9}, {
   3.463918130062729*^9, 3.463918148601156*^9}, {3.463918628332498*^9, 
   3.46391863181382*^9}, {3.463918676722555*^9, 3.46391868253447*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    TagBox[
     RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "j", ",", "1"}], "}"}],
       Quantum`Notation`zz080KetArgs,
       Editable->True,
       Selectable->True], "\[RightAngleBracket]"}],
     Quantum`Notation`zz080Ket,
     Editable->False,
     Selectable->False], "\[Equal]", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "k", 
      RowBox[{"k", "\[NotEqual]", "j"}]], 
     RowBox[{
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "k"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False], ".", 
      FractionBox[
       RowBox[{
        TagBox[
         RowBox[{"\[LeftAngleBracket]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "k"}], "}"}],
           Quantum`Notation`zz080BraArgs,
           Editable->True,
           Selectable->True], "\[VerticalSeparator]"}],
         Quantum`Notation`zz080Bra,
         Editable->False,
         Selectable->False], ".", "H1", ".", 
        TagBox[
         RowBox[{"\[VerticalSeparator]", 
          TagBox[
           RowBox[{"{", 
            RowBox[{"0", ",", "j"}], "}"}],
           Quantum`Notation`zz080KetArgs,
           Editable->True,
           Selectable->True], "\[RightAngleBracket]"}],
         Quantum`Notation`zz080Ket,
         Editable->False,
         Selectable->False]}], 
       RowBox[{
        RowBox[{"En", "[", 
         RowBox[{"0", ",", "j"}], "]"}], "-", 
        RowBox[{"En", "[", 
         RowBox[{"0", ",", "k"}], "]"}]}]]}]}]}], 
   "\[InvisibleSpace]", "\<\"\\n\[DoubleRightArrow] \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    TagBox[
     RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "j", ",", "1"}], "}"}],
       Quantum`Notation`zz080KetArgs,
       Editable->True,
       Selectable->True], "\[RightAngleBracket]"}],
     Quantum`Notation`zz080Ket,
     Editable->False,
     Selectable->False], "\[Equal]", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "k", 
      RowBox[{"k", "\[NotEqual]", "j"}]], 
     RowBox[{
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "k"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False], ".", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"En", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "-", 
         RowBox[{"En", "[", 
          RowBox[{"0", ",", "k"}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              FractionBox["1", 
               RowBox[{"1", "+", "A"}]]}], ")"}], " ", 
            RowBox[{"P", ".", "P"}]}], ")"}], ".", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j"}], "}"}],
             Quantum`Notation`zz080KetArgs,
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           Editable->False,
           Selectable->False]}], "+", 
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], " ", "B", " ", 
            SuperscriptBox["\[Omega]", "2"], " ", 
            RowBox[{"Q", ".", "Q"}]}], ")"}], ".", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j"}], "}"}],
             Quantum`Notation`zz080KetArgs,
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           Editable->False,
           Selectable->False]}], "+", 
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "k"}], "}"}],
             Quantum`Notation`zz080BraArgs,
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           Editable->False,
           Selectable->False], ".", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", " ", 
            SuperscriptBox["\[Omega]", "3"], " ", 
            RowBox[{"Q", ".", "Q", ".", "Q", ".", "Q"}]}], ")"}], ".", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             RowBox[{"{", 
              RowBox[{"0", ",", "j"}], "}"}],
             Quantum`Notation`zz080KetArgs,
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           Editable->False,
           Selectable->False]}]}], ")"}]}]}]}]}], 
   "\[InvisibleSpace]", "\<\"\\nThen to O(\[Lambda]) with the substitutions: \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", 
      RowBox[{"\[Lambda]", " ", 
       SubscriptBox["\[Kappa]", "A"]}]}], ",", 
     RowBox[{"B", "\[Rule]", 
      RowBox[{"\[Lambda]", " ", 
       SubscriptBox["\[Kappa]", "B"]}]}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    TagBox[
     RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "j", ",", "1"}], "}"}],
       Quantum`Notation`zz080KetArgs,
       Editable->True,
       Selectable->True], "\[RightAngleBracket]"}],
     Quantum`Notation`zz080Ket,
     Editable->False,
     Selectable->False], "\[Equal]", 
    RowBox[{
     FractionBox["1", "4"], " ", "\[Lambda]", " ", "\[Omega]", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"-", "3"}], "+", "j"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "2"}], "+", "j"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "j"}]], " ", 
         SqrtBox["j"], " ", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "j"}]}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}], 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"En", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", "4"}], "+", "j"}]}], "]"}]}], "+", 
         RowBox[{"En", "[", 
          RowBox[{"0", ",", "j"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "j"}]], " ", 
         SqrtBox["j"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"4", " ", "j"}], "+", 
           SubscriptBox["\[Kappa]", "A"], "+", 
           SubscriptBox["\[Kappa]", "B"]}], ")"}], " ", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "j"}]}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}], 
        RowBox[{
         RowBox[{"En", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "j"}]}], "]"}], "-", 
         RowBox[{"En", "[", 
          RowBox[{"0", ",", "j"}], "]"}]}]], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "+", "j"}]], " ", 
        SqrtBox[
         RowBox[{"2", "+", "j"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"6", "+", 
              RowBox[{"4", " ", "j"}], "+", 
              SubscriptBox["\[Kappa]", "A"], "+", 
              SubscriptBox["\[Kappa]", "B"]}], ")"}], " ", 
            TagBox[
             RowBox[{"\[VerticalSeparator]", 
              TagBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", "+", "j"}]}], "}"}],
               Quantum`Notation`zz080KetArgs,
               Editable->True,
               Selectable->True], "\[RightAngleBracket]"}],
             Quantum`Notation`zz080Ket,
             Editable->False,
             Selectable->False]}], 
           RowBox[{
            RowBox[{"En", "[", 
             RowBox[{"0", ",", "j"}], "]"}], "-", 
            RowBox[{"En", "[", 
             RowBox[{"0", ",", 
              RowBox[{"2", "+", "j"}]}], "]"}]}]], "+", 
          FractionBox[
           RowBox[{
            SqrtBox[
             RowBox[{"3", "+", "j"}]], " ", 
            SqrtBox[
             RowBox[{"4", "+", "j"}]], " ", 
            TagBox[
             RowBox[{"\[VerticalSeparator]", 
              TagBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"4", "+", "j"}]}], "}"}],
               Quantum`Notation`zz080KetArgs,
               Editable->True,
               Selectable->True], "\[RightAngleBracket]"}],
             Quantum`Notation`zz080Ket,
             Editable->False,
             Selectable->False]}], 
           RowBox[{
            RowBox[{"En", "[", 
             RowBox[{"0", ",", "j"}], "]"}], "-", 
            RowBox[{"En", "[", 
             RowBox[{"0", ",", 
              RowBox[{"4", "+", "j"}]}], "]"}]}]]}], ")"}]}]}], ")"}]}]}]}],
  SequenceForm[Quantum`Notation`zz080Ket[{0, $CellContext`j, 1}] == Sum[
     Dot[
      Quantum`Notation`zz080Ket[{0, $CellContext`k}], Dot[
        Quantum`Notation`zz080Bra[{0, $CellContext`k}], $CellContext`H1, 
        Quantum`Notation`zz080Ket[{0, $CellContext`j}]]/($CellContext`En[
       0, $CellContext`j] - $CellContext`En[
      0, $CellContext`k])], {$CellContext`k, $CellContext`k != \
$CellContext`j}], "\n\[DoubleRightArrow] ", 
   Quantum`Notation`zz080Ket[{0, $CellContext`j, 1}] == Sum[
     Dot[
      Quantum`Notation`zz080Ket[{0, $CellContext`k}], (Dot[
         Quantum`Notation`zz080Bra[{0, $CellContext`k}], 
         Rational[1, 2] (-1 + (1 + $CellContext`A)^(-1)) 
         Dot[$CellContext`P, $CellContext`P], 
         Quantum`Notation`zz080Ket[{0, $CellContext`j}]] + Dot[
         Quantum`Notation`zz080Bra[{0, $CellContext`k}], 
         Rational[1, 2] $CellContext`B $CellContext`\[Omega]^2 
         Dot[$CellContext`Q, $CellContext`Q], 
         Quantum`Notation`zz080Ket[{0, $CellContext`j}]] + Dot[
         Quantum`Notation`zz080Bra[{
          0, $CellContext`k}], $CellContext`\[Lambda] $CellContext`\[Omega]^3 
         Dot[$CellContext`Q, $CellContext`Q, $CellContext`Q, $CellContext`Q], 
         
         Quantum`Notation`zz080Ket[{0, $CellContext`j}]])/($CellContext`En[
       0, $CellContext`j] - $CellContext`En[
      0, $CellContext`k])], {$CellContext`k, $CellContext`k != \
$CellContext`j}], 
   "\nThen to O(\[Lambda]) with the substitutions: ", {$CellContext`A -> \
$CellContext`\[Lambda] 
     Subscript[$CellContext`\[Kappa], $CellContext`A], $CellContext`B -> \
$CellContext`\[Lambda] Subscript[$CellContext`\[Kappa], $CellContext`B]}, 
   "\n\[RightArrow] ", Quantum`Notation`zz080Ket[{0, $CellContext`j, 1}] == 
   Rational[1, 
      4] $CellContext`\[Lambda] $CellContext`\[Omega] ((-3 + $CellContext`j)^
       Rational[1, 2] (-2 + $CellContext`j)^
       Rational[1, 2] (-1 + $CellContext`j)^Rational[1, 2] $CellContext`j^
       Rational[
        1, 2] (-$CellContext`En[0, -4 + $CellContext`j] + $CellContext`En[
         0, $CellContext`j])^(-1) 
      Quantum`Notation`zz080Ket[{
        0, -4 + $CellContext`j}] - (-1 + $CellContext`j)^
      Rational[1, 2] $CellContext`j^
      Rational[1, 2] ($CellContext`En[
        0, -2 + $CellContext`j] - $CellContext`En[
       0, $CellContext`j])^(-1) (-2 + 4 $CellContext`j + 
      Subscript[$CellContext`\[Kappa], $CellContext`A] + 
      Subscript[$CellContext`\[Kappa], $CellContext`B]) 
     Quantum`Notation`zz080Ket[{
       0, -2 + $CellContext`j}] + (1 + $CellContext`j)^
       Rational[1, 2] (2 + $CellContext`j)^
       Rational[
        1, 2] (($CellContext`En[0, $CellContext`j] - $CellContext`En[
          0, 2 + $CellContext`j])^(-1) (6 + 4 $CellContext`j + 
         Subscript[$CellContext`\[Kappa], $CellContext`A] + 
         Subscript[$CellContext`\[Kappa], $CellContext`B]) 
        Quantum`Notation`zz080Ket[{0, 2 + $CellContext`j}] + (
          3 + $CellContext`j)^Rational[1, 2] (4 + $CellContext`j)^
         Rational[1, 2] ($CellContext`En[0, $CellContext`j] - $CellContext`En[
          0, 4 + $CellContext`j])^(-1) 
        Quantum`Notation`zz080Ket[{0, 4 + $CellContext`j}]))],
  Editable->False]], "Print",
 CellChangeTimes->{3.4642139995932217`*^9}]
}, Open  ]],

Cell["\<\
Evaluate the ground and first excited states of the full system where \
En[0,1]-En[0,0]=\[Omega]\
\>", "Text",
 CellChangeTimes->{{3.463772657719432*^9, 3.463772693220162*^9}, {
  3.4639152631015873`*^9, 3.4639152844575157`*^9}, {3.463915346017849*^9, 
  3.4639153513705063`*^9}, {3.463916226781946*^9, 3.463916257242223*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"perturbative", " ", "eigenvalue", " ", "function"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"En", "[", 
      RowBox[{"0", ",", "k_", ",", "1"}], "]"}], ":=", 
     RowBox[{"perturbEigenvalueJ", "/.", 
      RowBox[{"j", "\[Rule]", "k"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<The defined excitation energy, \[Omega], \>\"", ",", "Yield", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"0", "\[Equal]", 
         RowBox[{
          RowBox[{"En", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "-", 
          RowBox[{"En", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}]}]}], "//", "Simplify"}]}],
       ",", "Yield", ",", "\[IndentingNewLine]", 
      RowBox[{"eq1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"tmp", ",", 
           SubscriptBox["\[Kappa]", "A"]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"Rule", "\[Rule]", "Equal"}]}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.4639153549696074`*^9, 3.4639155264096823`*^9}, {
  3.463915657327351*^9, 3.463915680939135*^9}, {3.4639160985634813`*^9, 
  3.4639161900489597`*^9}, {3.463916274476986*^9, 3.463916275114305*^9}, {
  3.463920040574978*^9, 3.4639201164621353`*^9}, {3.463920219726191*^9, 
  3.463920237223007*^9}, {3.4639202765073357`*^9, 3.463920390255601*^9}, {
  3.4639209276341467`*^9, 3.46392096152155*^9}, {3.463921002625079*^9, 
  3.46392100395113*^9}, {3.4639210769377623`*^9, 3.463921115426093*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The defined excitation energy, \[Omega], \"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", "\[Omega]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "6"}], "+", 
       SubscriptBox["\[Kappa]", "A"], "-", 
       SubscriptBox["\[Kappa]", "B"]}], ")"}]}], "\[Equal]", "0"}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Kappa]", "A"], "\[Equal]", 
     RowBox[{"6", "+", 
      SubscriptBox["\[Kappa]", "B"]}]}], "}"}]}],
  SequenceForm[
  "The defined excitation energy, \[Omega], ", 
   "\n\[RightArrow] ", $CellContext`\[Lambda] $CellContext`\[Omega] (-6 + 
     Subscript[$CellContext`\[Kappa], $CellContext`A] - 
     Subscript[$CellContext`\[Kappa], $CellContext`B]) == 0, 
   "\n\[RightArrow] ", {
   Subscript[$CellContext`\[Kappa], $CellContext`A] == 
    6 + Subscript[$CellContext`\[Kappa], $CellContext`B]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.464229549573946*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"perturbative", " ", "eigenvector", " ", "function"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"eigenVector", "[", "k_", "]"}], ":=", 
     RowBox[{"perturbEigenvector", "/.", 
      RowBox[{"j", "\[Rule]", "k"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"subV", "[", "k_", "]"}], ":=", 
     RowBox[{
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{"{", 
          RowBox[{"p", ",", "k"}], "}"}],
         Quantum`Notation`zz080KetArgs,
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       Editable->False,
       Selectable->False], "->", 
      RowBox[{
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "k"}], "}"}],
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False], "+", 
       RowBox[{
        RowBox[{"eigenVector", "[", "k", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"subVt", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"subV", "[", "k", "]"}], "/.", 
      RowBox[{
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox["a__",
          Quantum`Notation`zz080KetArgs,
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        Editable->False,
        Selectable->False], "->", 
       TagBox[
        RowBox[{"\[LeftAngleBracket]", 
         TagBox["a",
          Quantum`Notation`zz080BraArgs,
          Editable->True,
          Selectable->True], "\[VerticalSeparator]"}],
        Quantum`Notation`zz080Bra,
        Editable->False,
        Selectable->False]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<The suggested normalization\>\"", ",", "Yield", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         SqrtBox[
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Omega]"}], ")"}]]}], "==", 
        RowBox[{
         TagBox[
          RowBox[{"\[LeftAngleBracket]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"p", ",", "1"}], "}"}],
            Quantum`Notation`zz080BraArgs,
            Editable->True,
            Selectable->True], "\[VerticalSeparator]"}],
          Quantum`Notation`zz080Bra,
          Editable->False,
          Selectable->False], ".", "Q", ".", 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"p", ",", "0"}], "}"}],
            Quantum`Notation`zz080KetArgs,
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          Editable->False,
          Selectable->False]}]}]}], ",", "Yield", ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{"subVt", "[", "1", "]"}]}], "/.", 
         RowBox[{"subV", "[", "0", "]"}]}]}], ";", "Yield", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"OpQP", "[", "tmp", "]"}], "/.", 
          RowBox[{
           SuperscriptBox["\[Lambda]", "2"], "\[Rule]", "0"}]}], "//", 
         "Simplify"}]}]}], ",", "Yield", ",", "\[IndentingNewLine]", 
      RowBox[{"eq2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"tmp", ",", 
           SubscriptBox["\[Kappa]", "A"]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"Rule", "\[Rule]", "Equal"}]}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.4639157312455997`*^9, 3.4639157354351*^9}, {
  3.4639188018116693`*^9, 3.463918805426362*^9}, {3.463919052423685*^9, 
  3.463919118354986*^9}, {3.463919148884259*^9, 3.463919356808529*^9}, {
  3.463919418298976*^9, 3.463919490148437*^9}, {3.463919613566948*^9, 
  3.463919620133067*^9}, {3.463919682084066*^9, 3.463919684668214*^9}, {
  3.463919770366308*^9, 3.463919789606552*^9}, {3.4639204127514353`*^9, 
  3.4639205184094467`*^9}, {3.463920557295981*^9, 3.46392061037766*^9}, {
  3.4639206575607643`*^9, 3.463920661271305*^9}, {3.463920695644742*^9, 
  3.4639209126692963`*^9}, {3.463921007401464*^9, 3.4639210095033293`*^9}, {
  3.46392112695012*^9, 3.463921137244259*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The suggested normalization\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["\[Omega]"]}]], "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"p", ",", "1"}], "}"}],
        Quantum`Notation`zz080BraArgs,
        Editable->True,
        Selectable->True], "\[VerticalSeparator]"}],
      Quantum`Notation`zz080Bra,
      Editable->False,
      Selectable->False], ".", "Q", ".", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"p", ",", "0"}], "}"}],
        Quantum`Notation`zz080KetArgs,
        Editable->True,
        Selectable->True], "\[RightAngleBracket]"}],
      Quantum`Notation`zz080Ket,
      Editable->False,
      Selectable->False]}]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Lambda]", " ", 
      SqrtBox["\[Omega]"], " ", 
      RowBox[{"(", 
       RowBox[{"6", "+", 
        SubscriptBox["\[Kappa]", "A"], "+", 
        SubscriptBox["\[Kappa]", "B"]}], ")"}]}], 
     RowBox[{
      RowBox[{"En", "[", 
       RowBox[{"0", ",", "0"}], "]"}], "-", 
      RowBox[{"En", "[", 
       RowBox[{"0", ",", "2"}], "]"}]}]], "\[Equal]", "0"}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Kappa]", "A"], "\[Equal]", 
     RowBox[{
      RowBox[{"-", "6"}], "-", 
      SubscriptBox["\[Kappa]", "B"]}]}], "}"}]}],
  SequenceForm[
  "The suggested normalization", "\n\[RightArrow] ", 
   2^Rational[-1, 2] $CellContext`\[Omega]^Rational[-1, 2] == Dot[
     Quantum`Notation`zz080Bra[{$CellContext`p, 1}], $CellContext`Q, 
     Quantum`Notation`zz080Ket[{$CellContext`p, 0}]], 
   "\n\[RightArrow] ", $CellContext`\[Lambda] $CellContext`\[Omega]^
     Rational[1, 2] ($CellContext`En[0, 0] - $CellContext`En[0, 2])^(-1) (6 + 
     Subscript[$CellContext`\[Kappa], $CellContext`A] + 
     Subscript[$CellContext`\[Kappa], $CellContext`B]) == 0, 
   "\n\[RightArrow] ", {
   Subscript[$CellContext`\[Kappa], $CellContext`A] == -6 - 
     Subscript[$CellContext`\[Kappa], $CellContext`B]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.46422955867397*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Kappa]", "A"], ",", 
     SubscriptBox["\[Kappa]", "B"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.46392102010041*^9, 3.463921062388563*^9}, {
  3.463921155832924*^9, 3.463921162142993*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Kappa]", "A"], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[Kappa]", "B"], "\[Rule]", 
     RowBox[{"-", "6"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.4642295696581306`*^9}]
}, Open  ]],

Cell["\<\
VVVVVV
Propagator to O[\[Lambda]] in dimension->1\
\>", "Text",
 CellChangeTimes->{{3.46392199341253*^9, 3.4639220521261683`*^9}, {
  3.464091745989854*^9, 3.464091747760394*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Analogous with (14.4) where the perturbation term,\[CapitalPi], is \
derived from the 4 particle interaction term and where \>\"", ",", 
    RowBox[{"subAB", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", 
        RowBox[{"Z", "-", "1"}]}], ",", 
       RowBox[{"B", "\[Rule]", 
        RowBox[{
         SubscriptBox["Z", "m"], "-", "1"}]}]}], "}"}]}], ",", 
    "\"\< and the coefficient is lumped \>\"", ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["Z", "\[Lambda]"], "\[Lambda]", " ", 
      SuperscriptBox["\[Omega]", "3"]}], "\[Rule]", "\[Lambda]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefPrint", "[", 
   RowBox[{"\"\<a144\>\"", ",", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"\[CapitalPi]", "[", "k_", "]"}]}], "->", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]"}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "\[ImaginaryI]"}], ")"}], "3"], 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "h1", "}"}], ",", 
           RowBox[{"{", "h2", "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", 
           RowBox[{"(", "h1", ")"}], "]"}], 
          RowBox[{"\[CapitalDelta]", "[", 
           RowBox[{"(", 
            RowBox[{"h1", "+", "h2", "+", "k"}], ")"}], "]"}], 
          RowBox[{"\[CapitalDelta]", "[", "h2", "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "-", 
      RowBox[{"\[ImaginaryI]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", " ", 
          SuperscriptBox["k", "2"]}], "+", 
         RowBox[{"B", " ", 
          SuperscriptBox["m", "2"]}]}], ")"}]}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<The diagram of this interaction looks like:\>\"", 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraphPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "\[Rule]", "2"}], ",", 
      RowBox[{"2", "\[Rule]", "3"}], ",", 
      RowBox[{"2", "\[Rule]", "3"}], ",", 
      RowBox[{"2", "\[Rule]", "3"}], ",", 
      RowBox[{"3", "\[Rule]", "4"}]}], "}"}], ",", 
    RowBox[{"VertexCoordinateRules", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".08", ",", "0"}], "}"}]}], ",", 
       RowBox[{"2", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".1", ",", "0"}], "}"}]}], ",", 
       RowBox[{"3", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".18", ",", "0"}], "}"}]}], ",", 
       RowBox[{"4", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".2", ",", "0"}], "}"}]}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<Using (14.3), the free particle propagator,\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefPrint", "[", 
   RowBox[{"\"\<e143\>\"", ",", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", "[", "k_", "]"}], "->", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k", "2"], "+", 
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"Imply", ",", "\[IndentingNewLine]", 
     RowBox[{"tmp1", "=", 
      RowBox[{"tmp", "=", 
       RowBox[{"a144", "/.", "e143"}]}]}], ",", "Imply", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp1", "=", 
      RowBox[{"tmp1", "/.", 
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a_List", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"xIntegrate", "[", 
         RowBox[{"b", ",", 
          RowBox[{
           RowBox[{"Flatten", "[", "a", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Flatten", "[", "a", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\"\<\\nOr with Feymann's formula\>\"", ",", 
     "Yield", ",", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a__List", ",", 
          FractionBox["1", 
           RowBox[{"b_", " ", "c_", " ", "d_"}]]}], "]"}], ":>", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"a", ",", 
               RowBox[{"{", "x1", "}"}], ",", 
               RowBox[{"{", "x2", "}"}], ",", 
               RowBox[{"{", "x3", "}"}]}], "}"}], "]"}], ",", "1"}], "]"}], 
          ",", 
          RowBox[{"2", " ", 
           RowBox[{"DiracDelta", "[", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "1"}], "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x1", " ", "b"}], "+", 
              RowBox[{"x2", " ", "c"}], " ", "+", 
              RowBox[{"x3", " ", "d"}]}], ")"}], 
            RowBox[{"-", "3"}]]}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<and the  conditions \>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPi]", "[", 
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPi]", "'"}], "[", 
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "]"}], "\[Rule]", "0"}]}], "}"}], ",", 
    "\"\< to set the values of A and B.\>\""}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.463929566866127*^9, 3.463929586797605*^9}, {
   3.463929621269993*^9, 3.4639296583274603`*^9}, {3.46393030811409*^9, 
   3.4639303173929853`*^9}, {3.463930351156962*^9, 3.4639305512398977`*^9}, {
   3.4639306544721117`*^9, 3.463930860847726*^9}, {3.4639310089739113`*^9, 
   3.463931152863529*^9}, {3.463931192784108*^9, 3.463931213208591*^9}, {
   3.4639312460039673`*^9, 3.463931249688003*^9}, {3.463931293139785*^9, 
   3.4639313225077333`*^9}, {3.4639313560944567`*^9, 
   3.4639313775668793`*^9}, {3.4639314190028343`*^9, 
   3.4639314661529093`*^9}, {3.463931539793929*^9, 3.463931546331745*^9}, {
   3.463931590631246*^9, 3.463931674661943*^9}, {3.463931770844084*^9, 
   3.4639319092099237`*^9}, {3.46393199460666*^9, 3.4639320701676397`*^9}, {
   3.463945022824003*^9, 3.4639450702088757`*^9}, {3.46394668090536*^9, 
   3.463946888287055*^9}, {3.463947264352888*^9, 3.463947325338871*^9}, {
   3.463947372979727*^9, 3.463947394622382*^9}, {3.46394743667878*^9, 
   3.463947501416305*^9}, {3.4639651661962423`*^9, 3.46396518616893*^9}, {
   3.463965220889512*^9, 3.46396524041951*^9}, 3.463965384435546*^9, 
   3.463965470376608*^9, {3.463968553103077*^9, 3.463968555948032*^9}, 
   3.463968623591402*^9, 3.463968760168268*^9, {3.4639696095062733`*^9, 
   3.463969621801094*^9}, 3.464006057625888*^9, {3.464091817277131*^9, 
   3.4640918187109423`*^9}, {3.46409189612576*^9, 3.464091946910284*^9}, {
   3.464091993882372*^9, 3.4640920276286793`*^9}, {3.4640920904675217`*^9, 
   3.464092210279871*^9}, {3.4640922710475483`*^9, 3.464092291777248*^9}, {
   3.4640924562192593`*^9, 3.4640925206974363`*^9}, {3.464092595695807*^9, 
   3.464092686120405*^9}, {3.464092780398621*^9, 3.464092789372953*^9}, {
   3.464092867742293*^9, 3.464092869280635*^9}, {3.464093211645252*^9, 
   3.46409324959584*^9}, {3.464093303808014*^9, 3.464093411557665*^9}, {
   3.464093537009066*^9, 3.4640935417127028`*^9}, {3.464093892285248*^9, 
   3.4640938934422626`*^9}, {3.4640939564603863`*^9, 3.46409418840661*^9}, {
   3.4640942223245573`*^9, 3.464094237026218*^9}, {3.464094269694614*^9, 
   3.464094310751004*^9}, {3.464094779821332*^9, 3.464094780653071*^9}, {
   3.46409482352284*^9, 3.464094879720666*^9}, {3.4640949122742367`*^9, 
   3.4640949368217487`*^9}, 3.464094973828711*^9, {3.464095018035721*^9, 
   3.464095032943369*^9}, {3.464095355743178*^9, 3.464095374624135*^9}, {
   3.464095688307274*^9, 3.4640956893362722`*^9}, {3.4641936688319283`*^9, 
   3.46419367438223*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Analogous with (14.4) where the perturbation \
term,\[CapitalPi], is derived from the 4 particle interaction term and where \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "Z"}]}], ",", 
     RowBox[{"B", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["Z", "m"]}]}]}], "}"}], 
   "\[InvisibleSpace]", "\<\" and the coefficient is lumped \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", 
     SuperscriptBox["\[Omega]", "3"], " ", 
     SubscriptBox["Z", "\[Lambda]"]}], "\[Rule]", "\[Lambda]"}]}],
  SequenceForm[
  "Analogous with (14.4) where the perturbation term,\[CapitalPi], is derived \
from the 4 particle interaction term and where ", {$CellContext`A -> -1 + \
$CellContext`Z, $CellContext`B -> -1 + 
     Subscript[$CellContext`Z, $CellContext`m]}, 
   " and the coefficient is lumped ", $CellContext`\[Lambda] $CellContext`\
\[Omega]^3 
    Subscript[$CellContext`Z, $CellContext`\[Lambda]] -> $CellContext`\
\[Lambda]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464229573824051*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"a144: \"\>",
    StripOnInput->False,
    FontSize->12], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"\[CapitalPi]", "[", "k_", "]"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", " ", 
          SuperscriptBox["k", "2"]}], "+", 
         RowBox[{"B", " ", 
          SuperscriptBox["m", "2"]}]}], ")"}]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[Lambda]", "2"], " ", 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "h1", "}"}], ",", 
           RowBox[{"{", "h2", "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", "h1", "]"}], " ", 
          RowBox[{"\[CapitalDelta]", "[", "h2", "]"}], " ", 
          RowBox[{"\[CapitalDelta]", "[", 
           RowBox[{"h1", "+", "h2", "+", "k"}], "]"}]}]}], "]"}]}]}]}],
    StripOnInput->False,
    FontSize->12]}],
  SequenceForm[
   Style["a144: ", 12], 
   Style[Complex[0, 1] $CellContext`\[CapitalPi][
       Pattern[$CellContext`k, 
        Blank[]]] -> 
    Complex[0, -1] ($CellContext`A $CellContext`k^2 + $CellContext`B \
$CellContext`m^2) + Complex[0, 
        Rational[-1, 
         2]] $CellContext`\[Lambda]^2 \
$CellContext`IntegralOp[{{$CellContext`h1}, {$CellContext`h2}}, $CellContext`\
\[CapitalDelta][$CellContext`h1] \
$CellContext`\[CapitalDelta][$CellContext`h2] \
$CellContext`\[CapitalDelta][$CellContext`h1 + $CellContext`h2 + \
$CellContext`k]], 12]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464229573864686*^9}],

Cell[BoxData["\<\"The diagram of this interaction looks like:\"\>"], "Print",
 CellChangeTimes->{3.4642295738972054`*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQAWIQXS2yzv1h1RZ7BiiYNRMEdsL5XNcXF9hyHUeTPwnn
b/5wc3fX1t32B3YwCXXeT7Bv/pF6Zq/bHvsFiksuyAin2tcz8Oqy3wTyM/Nq
ShZn2H9qfctgmbPXnmG5D29Rf7Z96zZXJVWGffYHcr4yal/LtZ9p+tpg7pR9
9gmcBStflOXblxleXVCkud/+wmxdvSkWBfYxlltOlO3bb8+w6uMl36QCe+12
sZvnvh+G8+W42d4GOB2Bq+fl/L1kd88ReweoedNP+K75fu0I3L4HD37ueatw
1P7BMoh7Zim/WtaWdRTu3hnLbcNXbz5q3wD1T8Pq5vsuf4DyUP+i+X8/mv/3
o/l/P5r/96P5fz+a//ej+X8/mv/3o/l/P5r/96P5fz+a//ej+X8/mv/3o/l/
P5r/9wMAWykNxg==
    "], {
     {RGBColor[0.5, 0., 0.], 
      LineBox[{{1, 2}, {2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 
        19, 20, 3}, {2, 3}, {2, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 
        32, 33, 34, 35, 36, 3}, {3, 4}}]}, 
     {RGBColor[0, 0, 0.7], 
      TagBox[
       TooltipBox[PointBox[1],
        "1"],
       Annotation[#, 1, "Tooltip"]& ], 
      TagBox[
       TooltipBox[PointBox[2],
        "2"],
       Annotation[#, 2, "Tooltip"]& ], 
      TagBox[
       TooltipBox[PointBox[3],
        "3"],
       Annotation[#, 3, "Tooltip"]& ], 
      TagBox[
       TooltipBox[PointBox[4],
        "4"],
       Annotation[#, 4, "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{0.08, 0.}, {0.1, 0.}, {0.18, 0.}, {0.2, 
     0.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.464229574085754*^9}],

Cell[BoxData["\<\"Using (14.3), the free particle propagator,\"\>"], "Print",
 CellChangeTimes->{3.464229574131618*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"e143: \"\>",
    StripOnInput->False,
    FontSize->12], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"\[CapitalDelta]", "[", "k_", "]"}], "\[Rule]", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["k", "2"], "+", 
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}],
    StripOnInput->False,
    FontSize->12]}],
  SequenceForm[
   Style["e143: ", 12], 
   Style[$CellContext`\[CapitalDelta][
      Pattern[$CellContext`k, 
       Blank[]]] -> ($CellContext`k^2 + $CellContext`m^2 + 
      Complex[0, -1] $CellContext`\[Epsilon])^(-1), 12]],
  Editable->False]], "Print",
 CellChangeTimes->{3.464229574169265*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\[DoubleRightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"\[CapitalPi]", "[", "k_", "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{"B", " ", 
         SuperscriptBox["m", "2"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["\[Lambda]", "2"], " ", 
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "h1", "}"}], ",", 
          RowBox[{"{", "h2", "}"}]}], "}"}], ",", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h1", "2"], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h2", "2"], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"h1", "+", "h2", "+", "k"}], ")"}], "2"], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]]}], 
       "]"}]}]}]}], "\[InvisibleSpace]", "\<\"\\n\[DoubleRightArrow] \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"\[CapitalPi]", "[", "k_", "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{"B", " ", 
         SuperscriptBox["m", "2"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["\[Lambda]", "2"], " ", 
      RowBox[{"xIntegrate", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h1", "2"], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["h2", "2"], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"h1", "+", "h2", "+", "k"}], ")"}], "2"], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]], ",", 
        "h1", ",", "h2"}], "]"}]}]}]}], 
   "\[InvisibleSpace]", "\<\"\\nOr with Feymann's formula\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"\[CapitalPi]", "[", "k_", "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", " ", 
         SuperscriptBox["k", "2"]}], "+", 
        RowBox[{"B", " ", 
         SuperscriptBox["m", "2"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
      SuperscriptBox["\[Lambda]", "2"], " ", 
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "h1", "}"}], ",", 
          RowBox[{"{", "h2", "}"}], ",", 
          RowBox[{"{", "x1", "}"}], ",", 
          RowBox[{"{", "x2", "}"}], ",", 
          RowBox[{"{", "x3", "}"}]}], "}"}], ",", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x1", "+", "x2", "+", "x3"}], "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["h1", "2"], "+", 
               SuperscriptBox["m", "2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}], "+", 
            RowBox[{"x2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["h2", "2"], "+", 
               SuperscriptBox["m", "2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}], "+", 
            RowBox[{"x3", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"h1", "+", "h2", "+", "k"}], ")"}], "2"], "+", 
               SuperscriptBox["m", "2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]}], 
           ")"}], "3"]]}], "]"}]}]}]}]}],
  SequenceForm[
  "\n\[DoubleRightArrow] ", Complex[0, 1] $CellContext`\[CapitalPi][
      Pattern[$CellContext`k, 
       Blank[]]] -> 
   Complex[0, -1] ($CellContext`A $CellContext`k^2 + $CellContext`B \
$CellContext`m^2) + Complex[0, 
       Rational[-1, 
        2]] $CellContext`\[Lambda]^2 \
$CellContext`IntegralOp[{{$CellContext`h1}, {$CellContext`h2}}, \
($CellContext`h1^2 + $CellContext`m^2 + 
         Complex[0, -1] $CellContext`\[Epsilon])^(-1) ($CellContext`h2^2 + \
$CellContext`m^2 + 
         Complex[0, -1] $CellContext`\[Epsilon])^(-1)/(($CellContext`h1 + \
$CellContext`h2 + $CellContext`k)^2 + $CellContext`m^2 + 
       Complex[0, -1] $CellContext`\[Epsilon])], "\n\[DoubleRightArrow] ", 
   Complex[0, 1] $CellContext`\[CapitalPi][
      Pattern[$CellContext`k, 
       Blank[]]] -> 
   Complex[0, -1] ($CellContext`A $CellContext`k^2 + $CellContext`B \
$CellContext`m^2) + Complex[0, 
       Rational[-1, 
        2]] $CellContext`\[Lambda]^2 \
$CellContext`xIntegrate[($CellContext`h1^2 + $CellContext`m^2 + 
         Complex[0, -1] $CellContext`\[Epsilon])^(-1) ($CellContext`h2^2 + \
$CellContext`m^2 + 
         Complex[0, -1] $CellContext`\[Epsilon])^(-1)/(($CellContext`h1 + \
$CellContext`h2 + $CellContext`k)^2 + $CellContext`m^2 + 
       Complex[0, -1] $CellContext`\[Epsilon]), $CellContext`h1, \
$CellContext`h2], "\nOr with Feymann's formula", "\n\[RightArrow] ", 
   Complex[0, 1] $CellContext`\[CapitalPi][
      Pattern[$CellContext`k, 
       Blank[]]] -> 
   Complex[0, -1] ($CellContext`A $CellContext`k^2 + $CellContext`B \
$CellContext`m^2) + Complex[0, 
       Rational[-1, 
        2]] $CellContext`\[Lambda]^2 \
$CellContext`IntegralOp[{{$CellContext`h1}, {$CellContext`h2}, \
{$CellContext`x1}, {$CellContext`x2}, {$CellContext`x3}}, 
       2 ($CellContext`x1 ($CellContext`h1^2 + $CellContext`m^2 + 
           Complex[0, -1] $CellContext`\[Epsilon]) + $CellContext`x2 \
($CellContext`h2^2 + $CellContext`m^2 + 
           Complex[0, -1] $CellContext`\[Epsilon]) + $CellContext`x3 \
(($CellContext`h1 + $CellContext`h2 + $CellContext`k)^2 + $CellContext`m^2 + 
           Complex[0, -1] $CellContext`\[Epsilon]))^(-3) 
       DiracDelta[-1 + $CellContext`x1 + $CellContext`x2 + $CellContext`x3]]],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.464229574217321*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"and the  conditions \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPi]", "[", 
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[CapitalPi]", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "]"}], "\[Rule]", "0"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\" to set the values of A and B.\"\>"}],
  SequenceForm[
  "and the  conditions ", {$CellContext`\[CapitalPi][-$CellContext`m^2] -> 0, 
    Derivative[1][$CellContext`\[CapitalPi]][-$CellContext`m^2] -> 0}, 
   " to set the values of A and B."],
  Editable->False]], "Print",
 CellChangeTimes->{3.464229574272402*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Use Cauchy Residue Theorem for integration:\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp1", ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"Extract", "[", 
        RowBox[{"tmp1", ",", 
         RowBox[{"Position", "[", 
          RowBox[{"tmp1", ",", 
           RowBox[{"xIntegrate", "[", "___", "]"}]}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "\"\<For the h1 integration there are 4 potential poles to be selected by \
the contours of {h1,h2} to be in part along the x-axis and the portion around \
the upper half-circle equal to 0.\>\"", ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmpn", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"xIntegrate", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
        RowBox[{"Denominator", "[", "a", "]"}]}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pole", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"tmpn", "==", "0"}], ",", "h1"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    "\"\<\\nOf these poles h1={2,4} are only in the upper-half plane since \
{k,h2}\[Element]Reals.\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.463968804709115*^9, 3.463968934239356*^9}, {
   3.463969043833828*^9, 3.4639690699107037`*^9}, {3.46400087709195*^9, 
   3.4640008791070557`*^9}, 3.464005321583537*^9, {3.4640053884269247`*^9, 
   3.464005435654295*^9}, {3.464005478328001*^9, 3.464005513036243*^9}, {
   3.464005796888795*^9, 3.464005842738583*^9}, {3.464005875165065*^9, 
   3.464005882860639*^9}, {3.464005914896777*^9, 3.4640059575727577`*^9}, {
   3.464006018048655*^9, 3.46400602681601*^9}, {3.464095784575235*^9, 
   3.464095906173246*^9}, {3.4640960044556417`*^9, 3.464096007562585*^9}, {
   3.464096368226638*^9, 3.4640965768623943`*^9}, {3.464096613416605*^9, 
   3.464096669884918*^9}, {3.4640967197435713`*^9, 3.4640967432953157`*^9}, 
   3.464097250075305*^9, {3.4640973067581053`*^9, 3.4640973863459253`*^9}, {
   3.464097540627351*^9, 3.464097541915864*^9}, {3.4642296370547857`*^9, 
   3.46422989005468*^9}, {3.464229931033001*^9, 3.46422994828153*^9}, {
   3.464230301068802*^9, 3.464230323457992*^9}, {3.464232912761087*^9, 
   3.464232925132498*^9}, {3.464232980358117*^9, 3.464233077604906*^9}, {
   3.4642331261590633`*^9, 3.4642331401073313`*^9}, {3.464233277939719*^9, 
   3.464233328326123*^9}, {3.464233386349593*^9, 3.464233477847932*^9}, {
   3.464233612002172*^9, 3.464233623532309*^9}, {3.464233683584189*^9, 
   3.4642337322944727`*^9}, {3.4642337839985247`*^9, 3.464233787868557*^9}, {
   3.46423382346504*^9, 3.4642338422233067`*^9}, {3.4642711876606617`*^9, 
   3.464271192058827*^9}, {3.464271231667742*^9, 3.4642712393660507`*^9}, {
   3.4642712833621492`*^9, 3.464271288381122*^9}, {3.464271336733993*^9, 
   3.464271415961446*^9}, {3.4642736592876387`*^9, 3.46427401178041*^9}, {
   3.464274327751163*^9, 3.464274347620565*^9}, {3.464274696996655*^9, 
   3.464274712156166*^9}, {3.464275418373315*^9, 3.464275610328627*^9}, {
   3.464275654156795*^9, 3.464275735827643*^9}, {3.4642757699132013`*^9, 
   3.464275849731711*^9}, {3.4642758821310177`*^9, 3.464275947853364*^9}, {
   3.4642767740877857`*^9, 3.464276775044361*^9}, {3.4642768377737713`*^9, 
   3.464277073807734*^9}, {3.464277108353713*^9, 3.464277221215127*^9}, {
   3.4642772743411713`*^9, 3.464277358316924*^9}, {3.464277388852388*^9, 
   3.464277426221147*^9}, {3.464277458508376*^9, 3.4642775424075603`*^9}, {
   3.464277615369504*^9, 3.464277779073265*^9}, {3.4642778386865788`*^9, 
   3.464277910744548*^9}, {3.464277954112947*^9, 3.464278073135707*^9}, {
   3.4642781208722353`*^9, 3.464278138286771*^9}, {3.4642781775451603`*^9, 
   3.464278205674011*^9}, {3.4642782917087383`*^9, 3.464278412368813*^9}, {
   3.464278455116968*^9, 3.4642785116763287`*^9}, {3.464278605743988*^9, 
   3.464278606332768*^9}, {3.4642789088813963`*^9, 3.4642790438442783`*^9}, {
   3.464279090062292*^9, 3.464279668285103*^9}, {3.4642797110756407`*^9, 
   3.4642797576525087`*^9}, {3.464279815104692*^9, 3.464279858616312*^9}, {
   3.46427995007876*^9, 3.4642800142322683`*^9}, {3.4642801066054897`*^9, 
   3.464280149128916*^9}, {3.4642802167261066`*^9, 3.464280366507991*^9}, {
   3.464280399448312*^9, 3.464280400299728*^9}, {3.4642804691150637`*^9, 
   3.46428049291825*^9}, {3.464281190782462*^9, 3.464281347817028*^9}, {
   3.4642838395609627`*^9, 3.464283840594346*^9}, {3.4642838924959106`*^9, 
   3.464283928387188*^9}, {3.464284036287964*^9, 3.464284062408291*^9}, {
   3.4642840926942863`*^9, 3.4642842557635717`*^9}, {3.464284372804625*^9, 
   3.46428449079214*^9}, {3.46428453947302*^9, 3.464284556380885*^9}, {
   3.464284587343137*^9, 3.464284680294169*^9}, {3.4642847933390017`*^9, 
   3.4642848198341503`*^9}, {3.464284908715116*^9, 3.4642849441363087`*^9}, {
   3.464285146458193*^9, 3.464285304408893*^9}, {3.464285334564748*^9, 
   3.464285335240727*^9}, {3.464285367899544*^9, 3.464285374414109*^9}, 
   3.464285406378685*^9, {3.464285446407714*^9, 3.46428546937037*^9}, {
   3.464285561572517*^9, 3.464285580625692*^9}, {3.46428562606885*^9, 
   3.4642856345257187`*^9}, {3.464285706832157*^9, 3.464285707742784*^9}, {
   3.464285779510622*^9, 3.46428578974375*^9}, {3.464285826562298*^9, 
   3.464285897301106*^9}, {3.464286057001403*^9, 3.464286232348036*^9}, {
   3.4642862753976517`*^9, 3.4642862873606243`*^9}, {3.464286327221455*^9, 
   3.464286399019669*^9}, {3.464314736466895*^9, 3.464314745313846*^9}, {
   3.4643148380341597`*^9, 3.464314844466136*^9}, {3.4643149009840813`*^9, 
   3.464314956054051*^9}, {3.464321184861989*^9, 3.464321199190002*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Use Cauchy Residue Theorem for integration:\\n\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"xIntegrate", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["h1", "2"], "+", 
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["h2", "2"], "+", 
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"h1", "+", "h2", "+", "k"}], ")"}], "2"], "+", 
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]], ",", "h1", 
     ",", "h2"}], "]"}], 
   "\[InvisibleSpace]", "\<\"For the h1 integration there are 4 potential \
poles to be selected by the contours of {h1,h2} to be in part along the \
x-axis and the portion around the upper half-circle equal to 0.\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h1", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "h2"}], "-", "k", "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h1", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "h2"}], "-", "k", "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h1", "\[Rule]", 
       RowBox[{"-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h1", "\[Rule]", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}], "}"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\nOf these poles h1={2,4} are only in the \
upper-half plane since {k,h2}\[Element]Reals.\"\>"}],
  SequenceForm["Use Cauchy Residue Theorem for integration:\n", 
   $CellContext`xIntegrate[($CellContext`h1^2 + $CellContext`m^2 + 
      Complex[0, -1] $CellContext`\[Epsilon])^(-1) ($CellContext`h2^2 + \
$CellContext`m^2 + 
      Complex[0, -1] $CellContext`\[Epsilon])^(-1)/(($CellContext`h1 + \
$CellContext`h2 + $CellContext`k)^2 + $CellContext`m^2 + 
    Complex[0, -1] $CellContext`\[Epsilon]), $CellContext`h1, \
$CellContext`h2], 
   "For the h1 integration there are 4 potential poles to be selected by the \
contours of {h1,h2} to be in part along the x-axis and the portion around the \
upper half-circle equal to 0.", 
   "\n\[RightArrow] ", {{$CellContext`h1 -> -$CellContext`h2 - $CellContext`k - \
(-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
      Rational[1, 
        2]}, {$CellContext`h1 -> -$CellContext`h2 - $CellContext`k + \
(-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2]}, {$CellContext`h1 -> -(-$CellContext`m^2 + 
        Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2]}, {$CellContext`h1 -> (-$CellContext`m^2 + 
       Complex[0, 1] $CellContext`\[Epsilon])^Rational[1, 2]}}, 
   "\nOf these poles h1={2,4} are only in the upper-half plane since {k,h2}\
\[Element]Reals."],
  Editable->False]], "Print",
 CellChangeTimes->{3.4643212010165243`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ip", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Investigate the h1 Residue at pole[\>\"", ",", "ip", ",", 
    "\"\<],\nin the upper half plane: \>\"", ",", 
    RowBox[{"pole", "[", 
     RowBox[{"[", 
      RowBox[{"ip", ",", "1"}], "]"}], "]"}], ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "[", "ip", "]"}], "=", 
     RowBox[{"tmp", "/.", 
      RowBox[{
       RowBox[{"xIntegrate", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
       RowBox[{"Residue", "[", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pole", "[", 
            RowBox[{"[", 
             RowBox[{"ip", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"pole", "[", 
            RowBox[{"[", 
             RowBox[{"ip", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
        "]"}]}]}]}], ",", "Yield", ",", "\[IndentingNewLine]", 
    "\"\<The pole structure of h2 at h1 pole[\>\"", ",", "ip", ",", 
    "\"\<]:\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"pole2", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Denominator", "[", 
         RowBox[{"res", "[", "ip", "]"}], "]"}], "==", "0"}], ",", "h2"}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    "\"\<\\nOf these h2 poles {4} is the only one in the upper-half plane \
(assuming {k}\[Element]Reals)\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ip2", "=", "4"}], ";", "\[IndentingNewLine]", 
     "\"\<\\nSo the residue at \>\""}], ",", 
    RowBox[{"pole2", "[", 
     RowBox[{"[", 
      RowBox[{"ip2", ",", "1"}], "]"}], "]"}], ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res2", "[", 
      RowBox[{"ip", ",", "ip2"}], "]"}], "=", 
     RowBox[{"Residue", "[", 
      RowBox[{
       RowBox[{"res", "[", "ip", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pole2", "[", 
          RowBox[{"[", 
           RowBox[{"ip2", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pole2", "[", 
          RowBox[{"[", 
           RowBox[{"ip2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ",", "Yield", ",", "\[IndentingNewLine]", 
    "\"\<So the {h1,h2}->{4,4} residue \>\"", ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"res2", "[", 
       RowBox[{"ip", ",", "ip2"}], "]"}], " ", "/.", 
      RowBox[{"\[Epsilon]", "->", "0"}]}], "//", "Simplify"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.463968804709115*^9, 3.463968934239356*^9}, {
   3.463969043833828*^9, 3.4639690699107037`*^9}, {3.46400087709195*^9, 
   3.4640008791070557`*^9}, 3.464005321583537*^9, {3.4640053884269247`*^9, 
   3.464005435654295*^9}, {3.464005478328001*^9, 3.464005513036243*^9}, {
   3.464005796888795*^9, 3.464005842738583*^9}, {3.464005875165065*^9, 
   3.464005882860639*^9}, {3.464005914896777*^9, 3.4640059575727577`*^9}, {
   3.464006018048655*^9, 3.46400602681601*^9}, {3.464095784575235*^9, 
   3.464095906173246*^9}, {3.4640960044556417`*^9, 3.464096007562585*^9}, {
   3.464096368226638*^9, 3.4640965768623943`*^9}, {3.464096613416605*^9, 
   3.464096669884918*^9}, {3.4640967197435713`*^9, 3.4640967432953157`*^9}, 
   3.464097250075305*^9, {3.4640973067581053`*^9, 3.4640973863459253`*^9}, {
   3.464097540627351*^9, 3.464097541915864*^9}, {3.4642296370547857`*^9, 
   3.46422989005468*^9}, {3.464229931033001*^9, 3.46422994828153*^9}, {
   3.464230301068802*^9, 3.464230323457992*^9}, {3.464232912761087*^9, 
   3.464232925132498*^9}, {3.464232980358117*^9, 3.464233077604906*^9}, {
   3.4642331261590633`*^9, 3.4642331401073313`*^9}, {3.464233277939719*^9, 
   3.464233328326123*^9}, {3.464233386349593*^9, 3.464233477847932*^9}, {
   3.464233612002172*^9, 3.464233623532309*^9}, {3.464233683584189*^9, 
   3.4642337322944727`*^9}, {3.4642337839985247`*^9, 3.464233787868557*^9}, {
   3.46423382346504*^9, 3.4642338422233067`*^9}, {3.4642711876606617`*^9, 
   3.464271192058827*^9}, {3.464271231667742*^9, 3.4642712393660507`*^9}, {
   3.4642712833621492`*^9, 3.464271288381122*^9}, {3.464271336733993*^9, 
   3.464271415961446*^9}, {3.4642736592876387`*^9, 3.46427401178041*^9}, {
   3.464274327751163*^9, 3.464274347620565*^9}, {3.464274696996655*^9, 
   3.464274712156166*^9}, {3.464275418373315*^9, 3.464275610328627*^9}, {
   3.464275654156795*^9, 3.464275735827643*^9}, {3.4642757699132013`*^9, 
   3.464275849731711*^9}, {3.4642758821310177`*^9, 3.464275947853364*^9}, {
   3.4642767740877857`*^9, 3.464276775044361*^9}, {3.4642768377737713`*^9, 
   3.464277073807734*^9}, {3.464277108353713*^9, 3.464277221215127*^9}, {
   3.4642772743411713`*^9, 3.464277358316924*^9}, {3.464277388852388*^9, 
   3.464277426221147*^9}, {3.464277458508376*^9, 3.4642775424075603`*^9}, {
   3.464277615369504*^9, 3.464277779073265*^9}, {3.4642778386865788`*^9, 
   3.464277910744548*^9}, {3.464277954112947*^9, 3.464278073135707*^9}, {
   3.4642781208722353`*^9, 3.464278138286771*^9}, {3.4642781775451603`*^9, 
   3.464278205674011*^9}, {3.4642782917087383`*^9, 3.464278412368813*^9}, {
   3.464278455116968*^9, 3.4642785116763287`*^9}, {3.464278605743988*^9, 
   3.464278606332768*^9}, {3.4642789088813963`*^9, 3.4642790438442783`*^9}, {
   3.464279090062292*^9, 3.464279668285103*^9}, {3.4642797110756407`*^9, 
   3.4642797576525087`*^9}, {3.464279815104692*^9, 3.464279858616312*^9}, {
   3.46427995007876*^9, 3.4642800142322683`*^9}, {3.4642801066054897`*^9, 
   3.464280149128916*^9}, {3.4642802167261066`*^9, 3.464280366507991*^9}, {
   3.464280399448312*^9, 3.464280400299728*^9}, {3.4642804691150637`*^9, 
   3.46428049291825*^9}, {3.464281190782462*^9, 3.464281347817028*^9}, {
   3.4642838395609627`*^9, 3.464283840594346*^9}, {3.4642838924959106`*^9, 
   3.464283928387188*^9}, {3.464284036287964*^9, 3.464284062408291*^9}, {
   3.4642840926942863`*^9, 3.4642842557635717`*^9}, {3.464284372804625*^9, 
   3.46428449079214*^9}, {3.46428453947302*^9, 3.464284556380885*^9}, {
   3.464284587343137*^9, 3.464284680294169*^9}, {3.4642847933390017`*^9, 
   3.4642848198341503`*^9}, {3.464284908715116*^9, 3.4642849441363087`*^9}, {
   3.464285146458193*^9, 3.464285304408893*^9}, {3.464285334564748*^9, 
   3.464285335240727*^9}, {3.464285367899544*^9, 3.464285374414109*^9}, 
   3.464285406378685*^9, {3.464285446407714*^9, 3.46428546937037*^9}, {
   3.464285561572517*^9, 3.464285580625692*^9}, {3.46428562606885*^9, 
   3.4642856345257187`*^9}, {3.464285706832157*^9, 3.464285707742784*^9}, {
   3.464285779510622*^9, 3.46428578974375*^9}, {3.464285826562298*^9, 
   3.464285897301106*^9}, {3.464286057001403*^9, 3.464286232348036*^9}, {
   3.4642862753976517`*^9, 3.4642862873606243`*^9}, {3.464286327221455*^9, 
   3.464286399019669*^9}, {3.464314736466895*^9, 3.464314745313846*^9}, {
   3.4643148380341597`*^9, 3.464314844466136*^9}, {3.4643149009840813`*^9, 
   3.464314956054051*^9}, 3.464321184861989*^9, {3.464321260052246*^9, 
   3.4643212971362143`*^9}, 3.464321360810906*^9, {3.464321405284683*^9, 
   3.464321406900029*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Investigate the h1 Residue at pole[\"\>", "\[InvisibleSpace]", 
   "4", "\[InvisibleSpace]", "\<\"],\\nin the upper half plane: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"h1", "\[Rule]", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"h2", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"h2", "+", "k", "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["h2", "2"], "+", 
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", 
   "\[InvisibleSpace]", "\<\"The pole structure of h2 at h1 pole[\"\>", 
   "\[InvisibleSpace]", "4", "\[InvisibleSpace]", "\<\"]:\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       RowBox[{"-", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "k"}], "-", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       RowBox[{"-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}], "}"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\nOf these h2 poles {4} is the only one in the \
upper-half plane (assuming {k}\[Element]Reals)\"\>", 
   "\[InvisibleSpace]", "\<\"\\nSo the residue at \"\>", "\[InvisibleSpace]", 
   
   RowBox[{"h2", "\[Rule]", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"k", "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"k", "+", 
        RowBox[{"3", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["m", "2"], "-", 
        RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", 
   "\[InvisibleSpace]", "\<\"So the {h1,h2}->{4,4} residue \"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"4", " ", 
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "2"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{"4", " ", "k", " ", 
         SqrtBox[
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}]]}]}], ")"}]}]]}]}],
  SequenceForm[
  "Investigate the h1 Residue at pole[", 4, 
   "],\nin the upper half plane: ", $CellContext`h1 -> (-$CellContext`m^2 + 
     Complex[0, 1] $CellContext`\[Epsilon])^Rational[1, 2], 
   "\n\[RightArrow] ", 
   Rational[1, 
     2] ($CellContext`h2 + $CellContext`k)^(-1) ($CellContext`h2 + \
$CellContext`k + 
     2 (-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2])^(-1) ($CellContext`h2^2 + $CellContext`m^2 + 
     Complex[0, -1] $CellContext`\[Epsilon])^(-1) (-$CellContext`m^2 + 
     Complex[0, 1] $CellContext`\[Epsilon])^Rational[-1, 2], 
   "\n\[RightArrow] ", "The pole structure of h2 at h1 pole[", 4, 
   "]:", {{$CellContext`h2 -> -$CellContext`k}, {$CellContext`h2 -> \
-$CellContext`k - 
      2 (-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2]}, {$CellContext`h2 -> -(-$CellContext`m^2 + 
        Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2]}, {$CellContext`h2 -> (-$CellContext`m^2 + 
       Complex[0, 1] $CellContext`\[Epsilon])^Rational[1, 2]}}, 
   "\nOf these h2 poles {4} is the only one in the upper-half plane (assuming \
{k}\[Element]Reals)", 
   "\nSo the residue at ", $CellContext`h2 -> (-$CellContext`m^2 + 
     Complex[0, 1] $CellContext`\[Epsilon])^Rational[1, 2], 
   "\n\[RightArrow] ", 
   Rational[-1, 
     4] ($CellContext`k + (-$CellContext`m^2 + 
       Complex[0, 1] $CellContext`\[Epsilon])^
      Rational[1, 2])^(-1) ($CellContext`k + 
     3 (-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2])^(-1)/($CellContext`m^2 + 
   Complex[0, -1] $CellContext`\[Epsilon]), "\n\[RightArrow] ", 
   "So the {h1,h2}->{4,4} residue ", "\n\[RightArrow] ", 
   Rational[-1, 4] $CellContext`m^(-2)/($CellContext`k^2 - 3 $CellContext`m^2 + 
   4 $CellContext`k (-$CellContext`m^2)^Rational[1, 2])],
  Editable->False]], "Print",
 CellChangeTimes->{3.4643213018827143`*^9, 3.464321365688282*^9, 
  3.4643214084467993`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ip", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Investigate the h1 Residue at pole[\>\"", ",", "ip", ",", 
    "\"\<], \nin the upper half plane: \>\"", ",", 
    RowBox[{"pole", "[", 
     RowBox[{"[", 
      RowBox[{"ip", ",", "1"}], "]"}], "]"}], ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "[", "ip", "]"}], "=", 
     RowBox[{"tmp", "/.", 
      RowBox[{
       RowBox[{"xIntegrate", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
       RowBox[{"Residue", "[", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pole", "[", 
            RowBox[{"[", 
             RowBox[{"ip", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"pole", "[", 
            RowBox[{"[", 
             RowBox[{"ip", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
        "]"}]}]}]}], ",", "Yield", ",", "\[IndentingNewLine]", 
    "\"\<The pole structure of h2 at h1 pole[\>\"", ",", "ip", ",", 
    "\"\<]:\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"pole2", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Denominator", "[", 
         RowBox[{"res", "[", "ip", "]"}], "]"}], "==", "0"}], ",", "h2"}], 
      "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\"\<\\nOf these h2 poles {2,4} are in the upper-half plane (assuming {k}\
\[Element]Reals)\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ip2", "=", "2"}], ";", "\[IndentingNewLine]", 
     "\"\<\\nSo the residue at \>\"", ";", 
     RowBox[{"pole2", "[", 
      RowBox[{"[", 
       RowBox[{"ip2", ",", "1"}], "]"}], "]"}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res2", "[", 
       RowBox[{"ip", ",", "ip2"}], "]"}], "=", 
      RowBox[{"Residue", "[", 
       RowBox[{
        RowBox[{"res", "[", "ip", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pole2", "[", 
           RowBox[{"[", 
            RowBox[{"ip2", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pole2", "[", 
           RowBox[{"[", 
            RowBox[{"ip2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\"\<\\nThe {h1,h2}->{\>\""}], 
    ",", "ip", ",", "\"\<,\>\"", ",", "ip2", ",", "\"\<} residue \>\"", ",", 
    "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"res2", "[", 
       RowBox[{"ip", ",", "ip2"}], "]"}], " ", "/.", 
      RowBox[{"\[Epsilon]", "->", "0"}]}], "//", "Simplify"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ip2", "=", "4"}], ";", "\[IndentingNewLine]", 
     "\"\<\\nThe residue at \>\"", ";", 
     RowBox[{"pole2", "[", 
      RowBox[{"[", 
       RowBox[{"ip2", ",", "1"}], "]"}], "]"}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res2", "[", 
       RowBox[{"ip", ",", "ip2"}], "]"}], "=", 
      RowBox[{"Residue", "[", 
       RowBox[{
        RowBox[{"res", "[", "ip", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pole2", "[", 
           RowBox[{"[", 
            RowBox[{"ip2", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pole2", "[", 
           RowBox[{"[", 
            RowBox[{"ip2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\"\<\\nThe {h1,h2}->{\>\""}], 
    ",", "ip", ",", "\"\<,\>\"", ",", "ip2", ",", "\"\<} residue \>\"", ",", 
    "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"res2", "[", 
       RowBox[{"ip", ",", "ip2"}], "]"}], " ", "/.", 
      RowBox[{"\[Epsilon]", "->", "0"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.463968804709115*^9, 3.463968934239356*^9}, {
   3.463969043833828*^9, 3.4639690699107037`*^9}, {3.46400087709195*^9, 
   3.4640008791070557`*^9}, 3.464005321583537*^9, {3.4640053884269247`*^9, 
   3.464005435654295*^9}, {3.464005478328001*^9, 3.464005513036243*^9}, {
   3.464005796888795*^9, 3.464005842738583*^9}, {3.464005875165065*^9, 
   3.464005882860639*^9}, {3.464005914896777*^9, 3.4640059575727577`*^9}, {
   3.464006018048655*^9, 3.46400602681601*^9}, {3.464095784575235*^9, 
   3.464095906173246*^9}, {3.4640960044556417`*^9, 3.464096007562585*^9}, {
   3.464096368226638*^9, 3.4640965768623943`*^9}, {3.464096613416605*^9, 
   3.464096669884918*^9}, {3.4640967197435713`*^9, 3.4640967432953157`*^9}, 
   3.464097250075305*^9, {3.4640973067581053`*^9, 3.4640973863459253`*^9}, {
   3.464097540627351*^9, 3.464097541915864*^9}, {3.4642296370547857`*^9, 
   3.46422989005468*^9}, {3.464229931033001*^9, 3.46422994828153*^9}, {
   3.464230301068802*^9, 3.464230323457992*^9}, {3.464232912761087*^9, 
   3.464232925132498*^9}, {3.464232980358117*^9, 3.464233077604906*^9}, {
   3.4642331261590633`*^9, 3.4642331401073313`*^9}, {3.464233277939719*^9, 
   3.464233328326123*^9}, {3.464233386349593*^9, 3.464233477847932*^9}, {
   3.464233612002172*^9, 3.464233623532309*^9}, {3.464233683584189*^9, 
   3.4642337322944727`*^9}, {3.4642337839985247`*^9, 3.464233787868557*^9}, {
   3.46423382346504*^9, 3.4642338422233067`*^9}, {3.4642711876606617`*^9, 
   3.464271192058827*^9}, {3.464271231667742*^9, 3.4642712393660507`*^9}, {
   3.4642712833621492`*^9, 3.464271288381122*^9}, {3.464271336733993*^9, 
   3.464271415961446*^9}, {3.4642736592876387`*^9, 3.46427401178041*^9}, {
   3.464274327751163*^9, 3.464274347620565*^9}, {3.464274696996655*^9, 
   3.464274712156166*^9}, {3.464275418373315*^9, 3.464275610328627*^9}, {
   3.464275654156795*^9, 3.464275735827643*^9}, {3.4642757699132013`*^9, 
   3.464275849731711*^9}, {3.4642758821310177`*^9, 3.464275947853364*^9}, {
   3.4642767740877857`*^9, 3.464276775044361*^9}, {3.4642768377737713`*^9, 
   3.464277073807734*^9}, {3.464277108353713*^9, 3.464277221215127*^9}, {
   3.4642772743411713`*^9, 3.464277358316924*^9}, {3.464277388852388*^9, 
   3.464277426221147*^9}, {3.464277458508376*^9, 3.4642775424075603`*^9}, {
   3.464277615369504*^9, 3.464277779073265*^9}, {3.4642778386865788`*^9, 
   3.464277910744548*^9}, {3.464277954112947*^9, 3.464278073135707*^9}, {
   3.4642781208722353`*^9, 3.464278138286771*^9}, {3.4642781775451603`*^9, 
   3.464278205674011*^9}, {3.4642782917087383`*^9, 3.464278412368813*^9}, {
   3.464278455116968*^9, 3.4642785116763287`*^9}, {3.464278605743988*^9, 
   3.464278606332768*^9}, {3.4642789088813963`*^9, 3.4642790438442783`*^9}, {
   3.464279090062292*^9, 3.464279668285103*^9}, {3.4642797110756407`*^9, 
   3.4642797576525087`*^9}, {3.464279815104692*^9, 3.464279858616312*^9}, {
   3.46427995007876*^9, 3.4642800142322683`*^9}, {3.4642801066054897`*^9, 
   3.464280149128916*^9}, {3.4642802167261066`*^9, 3.464280366507991*^9}, {
   3.464280399448312*^9, 3.464280400299728*^9}, {3.4642804691150637`*^9, 
   3.46428049291825*^9}, {3.464281190782462*^9, 3.464281347817028*^9}, {
   3.4642838395609627`*^9, 3.464283840594346*^9}, {3.4642838924959106`*^9, 
   3.464283928387188*^9}, {3.464284036287964*^9, 3.464284062408291*^9}, {
   3.4642840926942863`*^9, 3.4642842557635717`*^9}, {3.464284372804625*^9, 
   3.46428449079214*^9}, {3.46428453947302*^9, 3.464284556380885*^9}, {
   3.464284587343137*^9, 3.464284680294169*^9}, {3.4642847933390017`*^9, 
   3.4642848198341503`*^9}, {3.464284908715116*^9, 3.4642849441363087`*^9}, {
   3.464285146458193*^9, 3.464285304408893*^9}, {3.464285334564748*^9, 
   3.464285335240727*^9}, {3.464285367899544*^9, 3.464285374414109*^9}, 
   3.464285406378685*^9, {3.464285446407714*^9, 3.46428546937037*^9}, {
   3.464285561572517*^9, 3.464285580625692*^9}, {3.46428562606885*^9, 
   3.4642856345257187`*^9}, {3.464285706832157*^9, 3.464285707742784*^9}, {
   3.464285779510622*^9, 3.46428578974375*^9}, {3.464285826562298*^9, 
   3.464285897301106*^9}, {3.464286057001403*^9, 3.464286232348036*^9}, {
   3.4642862753976517`*^9, 3.4642862873606243`*^9}, {3.464286327221455*^9, 
   3.464286399019669*^9}, {3.464314736466895*^9, 3.464314745313846*^9}, {
   3.4643148380341597`*^9, 3.464314844466136*^9}, {3.4643149009840813`*^9, 
   3.464314956054051*^9}, 3.464321184861989*^9, {3.464321260052246*^9, 
   3.4643212971362143`*^9}, {3.464321331000024*^9, 3.464321351295624*^9}, {
   3.4643216433438597`*^9, 3.464321643508328*^9}, {3.464321677514098*^9, 
   3.464321703088204*^9}, {3.4643217645852957`*^9, 3.464321776876998*^9}, {
   3.464321813701799*^9, 3.46432188162785*^9}, {3.464321928464134*^9, 
   3.464321965519088*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Investigate the h1 Residue at pole[\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"], \\nin the upper half plane: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"h1", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "h2"}], "-", "k", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"h2", "+", "k"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "h2"}], "-", "k", "+", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h2", "2"], "+", 
        SuperscriptBox["m", "2"], "-", 
        RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]]}], 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", 
   "\[InvisibleSpace]", "\<\"The pole structure of h2 at h1 pole[\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\"]:\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       RowBox[{"-", "k"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "k"}], "+", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       RowBox[{"-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h2", "\[Rule]", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}]]}], "}"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\nOf these h2 poles {2,4} are in the upper-half \
plane (assuming {k}\[Element]Reals)\"\>", 
   "\[InvisibleSpace]", "\<\"\\nThe {h1,h2}->{\"\>", "\[InvisibleSpace]", "2",
    "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"} residue \"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["k", "2"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{"4", " ", "k", " ", 
        SqrtBox[
         RowBox[{"-", 
          SuperscriptBox["m", "2"]}]]}]}], ")"}]}]], 
   "\[InvisibleSpace]", "\<\"\\nThe {h1,h2}->{\"\>", "\[InvisibleSpace]", "2",
    "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"} residue \"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"4", " ", 
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "2"], "+", 
        SuperscriptBox["m", "2"]}], ")"}]}]]}]}],
  SequenceForm[
  "Investigate the h1 Residue at pole[", 2, 
   "], \nin the upper half plane: ", $CellContext`h1 -> -$CellContext`h2 - \
$CellContext`k + (-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
     Rational[1, 2], "\n\[RightArrow] ", 
   Rational[-1, 
     2] ($CellContext`h2 + $CellContext`k)^(-1) (-$CellContext`h2 - \
$CellContext`k + 
     2 (-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2])^(-1) ($CellContext`h2^2 + $CellContext`m^2 + 
     Complex[0, -1] $CellContext`\[Epsilon])^(-1) (-$CellContext`m^2 + 
     Complex[0, 1] $CellContext`\[Epsilon])^Rational[-1, 2], 
   "\n\[RightArrow] ", "The pole structure of h2 at h1 pole[", 2, 
   "]:", {{$CellContext`h2 -> -$CellContext`k}, {$CellContext`h2 -> \
-$CellContext`k + 
      2 (-$CellContext`m^2 + Complex[0, 1] $CellContext`\[Epsilon])^
        Rational[1, 2]}, {$CellContext`h2 -> -(-$CellContext`m^2 + 
        Complex[0, 1] $CellContext`\[Epsilon])^
       Rational[1, 2]}, {$CellContext`h2 -> (-$CellContext`m^2 + 
       Complex[0, 1] $CellContext`\[Epsilon])^Rational[1, 2]}}, 
   "\nOf these h2 poles {2,4} are in the upper-half plane (assuming {k}\
\[Element]Reals)", "\nThe {h1,h2}->{", 2, ",", 2, "} residue ", 
   "\n\[RightArrow] ", Rational[1, 4] $CellContext`m^(-2)/(-$CellContext`k^2 + 
   3 $CellContext`m^2 + 4 $CellContext`k (-$CellContext`m^2)^Rational[1, 2]), 
   "\nThe {h1,h2}->{", 2, ",", 4, "} residue ", "\n\[RightArrow] ", 
   Rational[-1, 4] $CellContext`m^(-2)/($CellContext`k^2 + $CellContext`m^2)],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.464321780504632*^9, 3.4643218845379477`*^9, 
  3.46432193274496*^9, 3.4643219686744347`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<The sum of the residues, res2[4,4]+res2[2,2]+res2[2,4]\>\"", ",", 
    "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{"resSum", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"res2", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "+", 
        RowBox[{"res2", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "+", 
        RowBox[{"res2", "[", 
         RowBox[{"2", ",", "4"}], "]"}]}], "/.", 
       RowBox[{"\[Epsilon]", "->", "0"}]}], "//", "FullSimplify"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.463968804709115*^9, 3.463968934239356*^9}, {
   3.463969043833828*^9, 3.4639690699107037`*^9}, {3.46400087709195*^9, 
   3.4640008791070557`*^9}, 3.464005321583537*^9, {3.4640053884269247`*^9, 
   3.464005435654295*^9}, {3.464005478328001*^9, 3.464005513036243*^9}, {
   3.464005796888795*^9, 3.464005842738583*^9}, {3.464005875165065*^9, 
   3.464005882860639*^9}, {3.464005914896777*^9, 3.4640059575727577`*^9}, {
   3.464006018048655*^9, 3.46400602681601*^9}, {3.464095784575235*^9, 
   3.464095906173246*^9}, {3.4640960044556417`*^9, 3.464096007562585*^9}, {
   3.464096368226638*^9, 3.4640965768623943`*^9}, {3.464096613416605*^9, 
   3.464096669884918*^9}, {3.4640967197435713`*^9, 3.4640967432953157`*^9}, 
   3.464097250075305*^9, {3.4640973067581053`*^9, 3.4640973863459253`*^9}, {
   3.464097540627351*^9, 3.464097541915864*^9}, {3.4642296370547857`*^9, 
   3.46422989005468*^9}, {3.464229931033001*^9, 3.46422994828153*^9}, {
   3.464230301068802*^9, 3.464230323457992*^9}, {3.464232912761087*^9, 
   3.464232925132498*^9}, {3.464232980358117*^9, 3.464233077604906*^9}, {
   3.4642331261590633`*^9, 3.4642331401073313`*^9}, {3.464233277939719*^9, 
   3.464233328326123*^9}, {3.464233386349593*^9, 3.464233477847932*^9}, {
   3.464233612002172*^9, 3.464233623532309*^9}, {3.464233683584189*^9, 
   3.4642337322944727`*^9}, {3.4642337839985247`*^9, 3.464233787868557*^9}, {
   3.46423382346504*^9, 3.4642338422233067`*^9}, {3.4642711876606617`*^9, 
   3.464271192058827*^9}, {3.464271231667742*^9, 3.4642712393660507`*^9}, {
   3.4642712833621492`*^9, 3.464271288381122*^9}, {3.464271336733993*^9, 
   3.464271415961446*^9}, {3.4642736592876387`*^9, 3.46427401178041*^9}, {
   3.464274327751163*^9, 3.464274347620565*^9}, {3.464274696996655*^9, 
   3.464274712156166*^9}, {3.464275418373315*^9, 3.464275610328627*^9}, {
   3.464275654156795*^9, 3.464275735827643*^9}, {3.4642757699132013`*^9, 
   3.464275849731711*^9}, {3.4642758821310177`*^9, 3.464275947853364*^9}, {
   3.4642767740877857`*^9, 3.464276775044361*^9}, {3.4642768377737713`*^9, 
   3.464277073807734*^9}, {3.464277108353713*^9, 3.464277221215127*^9}, {
   3.4642772743411713`*^9, 3.464277358316924*^9}, {3.464277388852388*^9, 
   3.464277426221147*^9}, {3.464277458508376*^9, 3.4642775424075603`*^9}, {
   3.464277615369504*^9, 3.464277779073265*^9}, {3.4642778386865788`*^9, 
   3.464277910744548*^9}, {3.464277954112947*^9, 3.464278073135707*^9}, {
   3.4642781208722353`*^9, 3.464278138286771*^9}, {3.4642781775451603`*^9, 
   3.464278205674011*^9}, {3.4642782917087383`*^9, 3.464278412368813*^9}, {
   3.464278455116968*^9, 3.4642785116763287`*^9}, {3.464278605743988*^9, 
   3.464278606332768*^9}, {3.4642789088813963`*^9, 3.4642790438442783`*^9}, {
   3.464279090062292*^9, 3.464279668285103*^9}, {3.4642797110756407`*^9, 
   3.4642797576525087`*^9}, {3.464279815104692*^9, 3.464279858616312*^9}, {
   3.46427995007876*^9, 3.4642800142322683`*^9}, {3.4642801066054897`*^9, 
   3.464280149128916*^9}, {3.4642802167261066`*^9, 3.464280366507991*^9}, {
   3.464280399448312*^9, 3.464280400299728*^9}, {3.4642804691150637`*^9, 
   3.46428049291825*^9}, {3.464281190782462*^9, 3.464281347817028*^9}, {
   3.4642838395609627`*^9, 3.464283840594346*^9}, {3.4642838924959106`*^9, 
   3.464283928387188*^9}, {3.464284036287964*^9, 3.464284062408291*^9}, {
   3.4642840926942863`*^9, 3.4642842557635717`*^9}, {3.464284372804625*^9, 
   3.46428449079214*^9}, {3.46428453947302*^9, 3.464284556380885*^9}, {
   3.464284587343137*^9, 3.464284680294169*^9}, {3.4642847933390017`*^9, 
   3.4642848198341503`*^9}, {3.464284908715116*^9, 3.4642849441363087`*^9}, {
   3.464285146458193*^9, 3.464285304408893*^9}, {3.464285334564748*^9, 
   3.464285335240727*^9}, {3.464285367899544*^9, 3.464285374414109*^9}, 
   3.464285406378685*^9, {3.464285446407714*^9, 3.46428546937037*^9}, {
   3.464285561572517*^9, 3.464285580625692*^9}, {3.46428562606885*^9, 
   3.4642856345257187`*^9}, {3.464285706832157*^9, 3.464285707742784*^9}, {
   3.464285779510622*^9, 3.46428578974375*^9}, {3.464285826562298*^9, 
   3.464285897301106*^9}, {3.464286057001403*^9, 3.464286232348036*^9}, {
   3.4642862753976517`*^9, 3.4642862873606243`*^9}, {3.464286327221455*^9, 
   3.464286399019669*^9}, {3.464314736466895*^9, 3.464314745313846*^9}, {
   3.4643148380341597`*^9, 3.464314844466136*^9}, {3.4643149009840813`*^9, 
   3.464314956054051*^9}, 3.464321184861989*^9, {3.464321260052246*^9, 
   3.4643212971362143`*^9}, {3.464321331000024*^9, 3.464321351295624*^9}, {
   3.4643216433438597`*^9, 3.464321643508328*^9}, {3.464321677514098*^9, 
   3.464321703088204*^9}, {3.4643217645852957`*^9, 3.464321776876998*^9}, {
   3.46432200360776*^9, 3.464322038777947*^9}, {3.464322311275785*^9, 
   3.464322312860252*^9}, {3.464349587893868*^9, 3.46434960505958*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The sum of the residues, res2[4,4]+res2[2,2]+res2[2,4]\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\[RightArrow] \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["3", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"36", " ", 
       SuperscriptBox["m", "4"]}]}]]}]}],
  SequenceForm[
  "The sum of the residues, res2[4,4]+res2[2,2]+res2[2,4]", 
   "\n\[RightArrow] ", (-3)/(4 $CellContext`k^2 $CellContext`m^2 + 
   36 $CellContext`m^4)],
  Editable->False]], "Print",
 CellChangeTimes->{3.464349622623753*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ip2", "=", "1"}], ";", 
  RowBox[{"ip", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Does the pole at \>\"", ",", 
   RowBox[{"pole2", "[", 
    RowBox[{"[", 
     RowBox[{"ip2", ",", "1"}], "]"}], "]"}], ",", "\"\< contribute?\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<The residue at {h1,h2}->{\>\"", ",", "ip", ",", "\"\<,\>\"", ",", 
    "ip2", ",", "\"\<} = \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res2", "[", 
      RowBox[{"ip", ",", "ip2"}], "]"}], "=", 
     RowBox[{"Residue", "[", 
      RowBox[{
       RowBox[{"res", "[", "ip", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pole2", "[", 
          RowBox[{"[", 
           RowBox[{"ip2", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pole2", "[", 
          RowBox[{"[", 
           RowBox[{"ip2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ip", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<The residue at {h1,h2}->{\>\"", ",", "ip", ",", "\"\<,\>\"", ",", 
    "ip2", ",", "\"\<} = \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res2", "[", 
      RowBox[{"ip", ",", "ip2"}], "]"}], "=", 
     RowBox[{"Residue", "[", 
      RowBox[{
       RowBox[{"res", "[", "ip", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pole2", "[", 
          RowBox[{"[", 
           RowBox[{"ip2", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pole2", "[", 
          RowBox[{"[", 
           RowBox[{"ip2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Showing cancellation.\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.464322335873591*^9, 3.4643223554275007`*^9}, 
   3.464348139001783*^9, {3.464348174705579*^9, 3.46434818157743*^9}, {
   3.464348230889456*^9, 3.464348308671062*^9}, {3.464348339561857*^9, 
   3.464348399051292*^9}, {3.4643484341764297`*^9, 3.464348569108374*^9}, {
   3.464348615275156*^9, 3.464348759651539*^9}, {3.4643487954581757`*^9, 
   3.464348807969954*^9}, {3.464348926737598*^9, 3.4643489778059473`*^9}, {
   3.46434902116705*^9, 3.464349199680353*^9}, {3.4643492540747423`*^9, 
   3.464349268293138*^9}, {3.464349307899233*^9, 3.464349382365728*^9}, {
   3.464349414742078*^9, 3.464349470398624*^9}, {3.4643495231698637`*^9, 
   3.464349555195731*^9}, {3.464349655849143*^9, 3.4643496571283417`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Does the pole at \"\>", "\[InvisibleSpace]", 
   RowBox[{"h2", "\[Rule]", 
    RowBox[{"-", "k"}]}], "\[InvisibleSpace]", "\<\" contribute?\"\>"}],
  SequenceForm[
  "Does the pole at ", $CellContext`h2 -> -$CellContext`k, " contribute?"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.464348661748974*^9, 3.464348677967605*^9}, 
   3.464348763765892*^9, {3.464348798534943*^9, 3.4643488096880836`*^9}, {
   3.4643490955630293`*^9, 3.464349144635971*^9}, 3.46434920115924*^9, {
   3.464349357312722*^9, 3.464349383757195*^9}, {3.4643494270730343`*^9, 
   3.464349471935432*^9}, 3.464349562092392*^9, 3.464349659699011*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The residue at {h1,h2}->{\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"} = \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "2"], "+", 
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]]}],
  SequenceForm[
  "The residue at {h1,h2}->{", 2, ",", 1, "} = ", 
   Rational[1, 4] ($CellContext`m^2 + 
     Complex[0, -1] $CellContext`\[Epsilon])^(-1)/($CellContext`k^2 + \
$CellContext`m^2 + Complex[0, -1] $CellContext`\[Epsilon])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.464348661748974*^9, 3.464348677967605*^9}, 
   3.464348763765892*^9, {3.464348798534943*^9, 3.4643488096880836`*^9}, {
   3.4643490955630293`*^9, 3.464349144635971*^9}, 3.46434920115924*^9, {
   3.464349357312722*^9, 3.464349383757195*^9}, {3.4643494270730343`*^9, 
   3.464349471935432*^9}, 3.464349562092392*^9, 3.464349659700714*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The residue at {h1,h2}->{\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"} = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["m", "2"], "-", 
        RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k", "2"], "+", 
        SuperscriptBox["m", "2"], "-", 
        RowBox[{"\[ImaginaryI]", " ", "\[Epsilon]"}]}], ")"}]}]]}]}],
  SequenceForm[
  "The residue at {h1,h2}->{", 4, ",", 1, "} = ", 
   Rational[-1, 4] ($CellContext`m^2 + 
     Complex[0, -1] $CellContext`\[Epsilon])^(-1)/($CellContext`k^2 + \
$CellContext`m^2 + Complex[0, -1] $CellContext`\[Epsilon])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.464348661748974*^9, 3.464348677967605*^9}, 
   3.464348763765892*^9, {3.464348798534943*^9, 3.4643488096880836`*^9}, {
   3.4643490955630293`*^9, 3.464349144635971*^9}, 3.46434920115924*^9, {
   3.464349357312722*^9, 3.464349383757195*^9}, {3.4643494270730343`*^9, 
   3.464349471935432*^9}, 3.464349562092392*^9, 3.4643496597614098`*^9}],

Cell[BoxData["\<\"Showing cancellation.\"\>"], "Print",
 CellChangeTimes->{{3.464348661748974*^9, 3.464348677967605*^9}, 
   3.464348763765892*^9, {3.464348798534943*^9, 3.4643488096880836`*^9}, {
   3.4643490955630293`*^9, 3.464349144635971*^9}, 3.46434920115924*^9, {
   3.464349357312722*^9, 3.464349383757195*^9}, {3.4643494270730343`*^9, 
   3.464349471935432*^9}, 3.464349562092392*^9, 3.4643496597632713`*^9}]
}, Open  ]]
},
WindowSize->{694, 742},
WindowMargins->{{76, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 1211, 28, 59, "Input"],
Cell[1781, 52, 1316, 38, 42, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3134, 95, 2312, 61, 163, "Input"],
Cell[5449, 158, 171, 4, 26, "Output"],
Cell[5623, 164, 298, 9, 30, "Output"],
Cell[5924, 175, 556, 16, 46, "Output"]
}, Open  ]],
Cell[6495, 194, 250, 8, 29, "Text"],
Cell[CellGroupData[{
Cell[6770, 206, 588, 17, 56, "Input"],
Cell[7361, 225, 504, 15, 46, "Output"]
}, Open  ]],
Cell[7880, 243, 142, 2, 29, "Text"],
Cell[CellGroupData[{
Cell[8047, 249, 1193, 36, 108, "Input"],
Cell[9243, 287, 878, 29, 46, "Output"],
Cell[10124, 318, 688, 22, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10849, 345, 557, 18, 42, "Input"],
Cell[11409, 365, 508, 16, 46, "Output"]
}, Open  ]],
Cell[11932, 384, 621, 14, 67, "Text"],
Cell[12556, 400, 5328, 91, 58, "Input"],
Cell[CellGroupData[{
Cell[17909, 495, 10370, 286, 530, "Input"],
Cell[28282, 783, 2348, 49, 227, "Print"],
Cell[30633, 834, 4658, 135, 93, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35328, 974, 2668, 74, 150, "Input"],
Cell[37999, 1050, 2844, 75, 87, "Print"]
}, Open  ]],
Cell[40858, 1128, 144, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[41027, 1135, 11396, 318, 278, "Input"],
Cell[52426, 1455, 3118, 80, 72, "Print"]
}, Open  ]],
Cell[55559, 1538, 120, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[55704, 1543, 9386, 266, 263, "Input"],
Cell[65093, 1811, 4806, 144, 166, "Print"]
}, Open  ]],
Cell[69914, 1958, 374, 7, 29, "Text"],
Cell[CellGroupData[{
Cell[70313, 1969, 3210, 77, 207, "Input"],
Cell[73526, 2048, 6098, 160, 205, "Print"]
}, Open  ]],
Cell[79639, 2211, 263, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[79927, 2218, 4878, 116, 252, "Input"],
Cell[84808, 2336, 14287, 393, 353, "Print"]
}, Open  ]],
Cell[99110, 2732, 336, 6, 29, "Text"],
Cell[CellGroupData[{
Cell[99471, 2742, 1724, 41, 116, "Input"],
Cell[101198, 2785, 1111, 26, 56, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102346, 2816, 4739, 131, 199, "Input"],
Cell[107088, 2949, 2441, 66, 128, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109566, 3020, 398, 11, 40, "Input"],
Cell[109967, 3033, 288, 9, 24, "Output"]
}, Open  ]],
Cell[110270, 3045, 189, 5, 47, "Text"],
Cell[CellGroupData[{
Cell[110484, 3054, 8485, 204, 590, "Input"],
Cell[118972, 3260, 1201, 30, 58, "Print"],
Cell[120176, 3292, 1776, 50, 39, "Print"],
Cell[121955, 3344, 121, 1, 21, "Print"],
Cell[122079, 3347, 1440, 40, 37, "Output"],
Cell[123522, 3389, 119, 1, 21, "Print"],
Cell[123644, 3392, 749, 23, 41, "Print"],
Cell[124396, 3417, 7330, 184, 284, "Print"],
Cell[131729, 3603, 821, 21, 28, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132587, 3629, 5826, 93, 176, "Input"],
Cell[138416, 3724, 3753, 90, 203, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142206, 3819, 7152, 131, 266, "Input"],
Cell[149361, 3952, 6022, 155, 357, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155420, 4112, 8619, 164, 341, "Input"],
Cell[164042, 4278, 5386, 133, 315, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169465, 4416, 5434, 82, 71, "Input"],
Cell[174902, 4500, 654, 17, 60, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175593, 4522, 2702, 64, 176, "Input"],
Cell[178298, 4588, 677, 12, 21, "Print"],
Cell[178978, 4602, 1225, 26, 46, "Print"],
Cell[180206, 4630, 1258, 27, 46, "Print"],
Cell[181467, 4659, 416, 5, 21, "Print"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
