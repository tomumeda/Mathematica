(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    286806,       7733]
NotebookOptionsPosition[    261135,       6929]
NotebookOutlinePosition[    261849,       6955]
CellTagsIndexPosition[    261806,       6952]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initial Conditions", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.444562262901594*^9, 3.444562266773807*^9}}],

Cell["Gauge Invariant formalism", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.444562276749201*^9, 3.444562286363826*^9}}],

Cell["\<\
Express all the equation in the Gauge Invariant formalism of Bardeen, Durrer \
and others, essentially equivalent to the Conformal Newtonian gauge, then \
substitute to find gauge fixed equivalents if required. Use notation similar \
to Ma and Bertschinger.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4445624376396017`*^9, 3.444562502291601*^9}, {
  3.444571262592841*^9, 3.444571293740375*^9}, {3.462793066206937*^9, 
  3.4627930802294483`*^9}}],

Cell[CellGroupData[{

Cell["Background Equations", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.444562388978078*^9, 3.444562393544384*^9}}],

Cell["Equations for the FRW background solution.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.444562402990386*^9, 3.444562414950883*^9}}],

Cell[CellGroupData[{

Cell["Hubble Parameter", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4438001015468683`*^9, 3.443800107308387*^9}}],

Cell[BoxData[
 RowBox[{"hubble", ":=", 
  RowBox[{"H", "\[Rule]", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "'"}], "[", "t", "]"}], "/", 
      RowBox[{"a", "[", "t", "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44162483942782*^9, 3.4416248596396112`*^9}, {
   3.4416248988988857`*^9, 3.44162490000633*^9}, {3.441625870161561*^9, 
   3.441625870573073*^9}, 3.443793114956429*^9, {3.443801805247397*^9, 
   3.443801805673232*^9}, {3.444735312602016*^9, 3.444735317064012*^9}, {
   3.4450020940879917`*^9, 3.445002109098832*^9}, 3.445007165722126*^9, {
   3.445254063377297*^9, 3.445254071898265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Kappa]", "=", 
   RowBox[{"8", "\[Pi]", " ", 
    RowBox[{"G", " ", "/", " ", "3"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441625359868537*^9, 3.441625365724564*^9}, {
   3.441625406045999*^9, 3.441625446923826*^9}, {3.442148393331327*^9, 
   3.44214839811998*^9}, 3.4437931149610987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Friedmann equation", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.441625461886752*^9, 3.441625479550641*^9}, 
   3.443793114965705*^9, {3.4438003172081537`*^9, 3.443800319982205*^9}}],

Cell[BoxData[
 RowBox[{"friedmann", ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"H", "[", "t", "]"}], "2"], "==", 
   RowBox[{
    RowBox[{"\[Kappa]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], " ", 
     RowBox[{
      SubscriptBox["\[Rho]", "s"], "[", "t", "]"}]}], "-", 
    "kc"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441625485335999*^9, 3.441625564348825*^9}, {
   3.441625741940806*^9, 3.441625817712151*^9}, {3.441625848291212*^9, 
   3.441625860595999*^9}, {3.441625893435226*^9, 3.4416259023977013`*^9}, {
   3.4416259326104727`*^9, 3.441625934630003*^9}, {3.441627070607139*^9, 
   3.441627096281877*^9}, 3.4435184290192623`*^9, {3.4437375036532297`*^9, 
   3.443737517006947*^9}, 3.4437931149705467`*^9, {3.443801825796962*^9, 
   3.443801852336946*^9}, {3.445256115149996*^9, 3.4452561154813547`*^9}, {
   3.4507693366099567`*^9, 3.450769341353446*^9}, {3.451212161203039*^9, 
   3.451212164573702*^9}, {3.461057015193057*^9, 3.46105702304818*^9}}],

Cell[BoxData[
 RowBox[{"raychaudhuri", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"3", 
       RowBox[{
        SubscriptBox["w", "s"], "[", "t", "]"}]}]}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.441625485335999*^9, 3.441625564348825*^9}, {
   3.441625741940806*^9, 3.441625817712151*^9}, {3.441625848291212*^9, 
   3.441625860595999*^9}, {3.441625893435226*^9, 3.4416259023977013`*^9}, {
   3.4416259326104727`*^9, 3.441625934630003*^9}, {3.441627070607139*^9, 
   3.441627096281877*^9}, 3.4435184290192623`*^9, {3.4437375036532297`*^9, 
   3.443737517006947*^9}, 3.4437931149705467`*^9, {3.443801825796962*^9, 
   3.443801852336946*^9}, {3.44466659936908*^9, 3.444666602601465*^9}, {
   3.44466773371321*^9, 3.444667782341503*^9}, {3.444669010128561*^9, 
   3.444669017463356*^9}, {3.444741678573807*^9, 3.4447417839994993`*^9}, {
   3.4447418557740993`*^9, 3.444741863549684*^9}, {3.444821485025825*^9, 
   3.44482148632752*^9}, {3.445256121645912*^9, 3.445256121937215*^9}}],

Cell[BoxData[
 RowBox[{"energycons", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Rho]", "s"], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"H", "[", "t", "]"}], 
    RowBox[{
     SubscriptBox["\[Rho]", "s"], "[", "t", "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SubscriptBox["w", "s"], "[", "t", "]"}]}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444667796668721*^9, 3.4446678312994843`*^9}, {
  3.444740986185162*^9, 3.444740986885057*^9}, {3.444742082735566*^9, 
  3.444742089434181*^9}, {3.445256064745816*^9, 3.445256064825871*^9}, {
  3.445256126481649*^9, 3.445256143080895*^9}}],

Cell[BoxData[
 RowBox[{"BackgroundEq", ":=", 
  RowBox[{"{", "friedmann", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4421467865138807`*^9, 3.442146805182518*^9}, 
   3.442147931728589*^9, {3.4421479687796783`*^9, 3.4421479700420017`*^9}, {
   3.4421487916675577`*^9, 3.442148795060542*^9}, {3.442148921888915*^9, 
   3.442148923438932*^9}, {3.442149871548216*^9, 3.4421498766943617`*^9}, {
   3.443515330841402*^9, 3.443515374701825*^9}, 3.4437931150429573`*^9}],

Cell[BoxData[
 RowBox[{"BackgroundIC", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "==", "0"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4421468071346197`*^9, 3.44214686945642*^9}, {
   3.4421473761011868`*^9, 3.442147377930963*^9}, {3.4435153338409224`*^9, 
   3.4435153686940327`*^9}, 3.443793115047717*^9}],

Cell[BoxData[
 RowBox[{"BackgroundVar", ":=", 
  RowBox[{"{", 
   RowBox[{"a", "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.443515500434948*^9, {3.443518643565752*^9, 3.4435186552296867`*^9}, 
   3.443793115052459*^9, 3.444997090045602*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbations", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.443800281246842*^9, 3.4438002850701942`*^9}}],

Cell[CellGroupData[{

Cell["Einstein Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443515495146847*^9, 3.443515517289673*^9}, 
   3.443793115056868*^9, {3.443801038778203*^9, 3.443801042662171*^9}}],

Cell["\<\
The Einstein equations in Gauge Invariant Form. For ease of manipulation I \
have generally susbtituted in the Friedmann equation to replace any matter \
densities with the Hubble parameter.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789136769393*^9, 3.462789321830261*^9}}],

Cell[CellGroupData[{

Cell["Scalar Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443515529263959*^9, 3.4435155385524683`*^9}, 
   3.4437931150612593`*^9, {3.443801055931888*^9, 3.443801061504792*^9}, {
   3.4543154448940763`*^9, 3.454315479537071*^9}, 3.4627891223940907`*^9}],

Cell["The two constraint equations.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789371141161*^9, 3.462789377125111*^9}}],

Cell[BoxData[
 RowBox[{"cons1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["k", "2"], " ", 
     RowBox[{"\[CapitalPhi]", "[", "t", "]"}]}], " ", "+", " ", 
    RowBox[{"3", " ", 
     RowBox[{"H", "[", "t", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"H", "[", "t", "]"}], 
        RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}]}], ")"}]}]}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["3", "2"]}], 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "s"], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44351554165068*^9, 3.44351556333073*^9}, {
   3.44351560199332*^9, 3.443515637933178*^9}, {3.4435161738683653`*^9, 
   3.4435162953799562`*^9}, {3.443516960611978*^9, 3.4435169743249893`*^9}, 
   3.4437386694761744`*^9, 3.443793115066124*^9, {3.4438018334880857`*^9, 
   3.443801837790667*^9}, {3.444571954696802*^9, 3.44457196800517*^9}, 
   3.444572059478603*^9, {3.4445722785921593`*^9, 3.444572287857397*^9}, {
   3.4445724417632504`*^9, 3.444572475266871*^9}, 3.4445725169402533`*^9, {
   3.444573319546795*^9, 3.444573319746427*^9}, {3.44457335882101*^9, 
   3.444573361625733*^9}, {3.444573514783764*^9, 3.4445735166271048`*^9}, {
   3.444574930992113*^9, 3.444574932175441*^9}, {3.4445750884297657`*^9, 
   3.4445750970576353`*^9}, {3.444633218011026*^9, 3.4446332204391527`*^9}, {
   3.44473458478751*^9, 3.444734601686822*^9}, {3.445256151631825*^9, 
   3.445256151957445*^9}}],

Cell[BoxData[
 RowBox[{"cons2", ":=", 
  RowBox[{
   RowBox[{"k", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}], "+", 
      RowBox[{
       RowBox[{"H", "[", "t", "]"}], 
       RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}]}], ")"}]}], "\[Equal]", 
   RowBox[{
    FractionBox["3", "2"], " ", 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SubscriptBox["w", "s"], "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["V", "s"], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443516977180491*^9, 3.443517077665436*^9}, 
   3.443793115071082*^9, 3.443801839722785*^9, 3.444572463555192*^9, 
   3.4445725202688007`*^9, {3.444573322475903*^9, 3.4445733249699917`*^9}, {
   3.444573364121406*^9, 3.444573365273074*^9}, 3.444574731638143*^9, {
   3.444633234646202*^9, 3.444633237179346*^9}, {3.444734613604014*^9, 
   3.4447346283847847`*^9}, {3.445256155009305*^9, 3.445256159045124*^9}, {
   3.46115628138723*^9, 3.461156286187087*^9}}],

Cell["The dynamical equations", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789380796928*^9, 3.4627893868049192`*^9}}],

Cell[BoxData[
 RowBox[{"dyn1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]", "''"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"H", "[", "t", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "'"}], "[", "t", "]"}], "+", 
       RowBox[{"2", 
        RowBox[{
         RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{
         RowBox[{"H", "'"}], "[", "t", "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{"H", "[", "t", "]"}], "2"]}], ")"}], 
     RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "3"], 
     SuperscriptBox["k", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "t", "]"}], "-", 
       RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], ")"}]}]}], "\[Equal]", 
   RowBox[{
    FractionBox["3", "2"], " ", 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["c", "s"], "[", "t", "]"}], 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "s"], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["w", "s"], "[", "t", "]"}], 
       RowBox[{
        SubscriptBox["\[CapitalGamma]", "s"], "[", "t", "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443517105273724*^9, 3.4435171464237432`*^9}, 
   3.4435171949198627`*^9, {3.443517284855095*^9, 3.443517394771513*^9}, {
   3.4435175220873337`*^9, 3.443517541886816*^9}, {3.4435176194805193`*^9, 
   3.443517641279132*^9}, 3.443793115076207*^9, {3.443801840565778*^9, 
   3.4438018415778093`*^9}, {3.444117537104123*^9, 3.444117537608095*^9}, {
   3.4445724635861*^9, 3.444572463620595*^9}, {3.44457252030042*^9, 
   3.444572520333742*^9}, {3.444573328979293*^9, 3.444573330099173*^9}, {
   3.444573367202145*^9, 3.444573369633914*^9}, {3.4446419226324463`*^9, 
   3.444641957957917*^9}, {3.444642742825441*^9, 3.4446427451040907`*^9}, {
   3.444734644023921*^9, 3.44473465553828*^9}, {3.4452561691974773`*^9, 
   3.445256176679003*^9}}],

Cell[BoxData[
 RowBox[{"dyn2", ":=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["k", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "t", "]"}], "-", 
      RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], ")"}]}], "\[Equal]", 
   RowBox[{"3", " ", 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{
     SubscriptBox["w", "s"], "[", "t", "]"}], 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "s"], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44351765310489*^9, 3.4435177319392233`*^9}, 
   3.4437931150811043`*^9, 3.44457246365271*^9, 3.44457252036784*^9, {
   3.444573332977748*^9, 3.444573334025926*^9}, {3.444573371925254*^9, 
   3.444573374248597*^9}, 3.444574725302483*^9, {3.4446337102021027`*^9, 
   3.4446337142973223`*^9}, 3.4446616548211412`*^9, {3.444734700441293*^9, 
   3.444734721971801*^9}, {3.44525618567892*^9, 3.445256189705638*^9}, {
   3.461156386106089*^9, 3.461156398118587*^9}}],

Cell["The gauge invariant Bardeen variables to solve for.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789393844734*^9, 3.4627894228046513`*^9}}],

Cell[BoxData[
 RowBox[{"scalvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", "t", "]"}], ",", 
    RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.4435182730412188`*^9, {3.4435183551417923`*^9, 3.443518370925585*^9}, 
   3.443793115085676*^9, 3.4438011007646103`*^9, 3.444572463683432*^9, 
   3.4445725204150267`*^9, {3.444634522890411*^9, 3.444634528561116*^9}, {
   3.462789341343255*^9, 3.462789343085485*^9}}],

Cell["Auxilliary Potentials", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.463750581050544*^9, 3.463750586591545*^9}}],

Cell[BoxData[
 RowBox[{"auxpot", "=", 
  RowBox[{"mkpure", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Sigma]", "s"], "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["h", 
           RowBox[{"s", ",", "T"}]], "'"}], "[", "t", "]"}], "/", "k"}], "-", 
       
       RowBox[{
        SubscriptBox["B", "s"], "[", "t", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[ScriptCapitalR]", "s"], "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", 
         RowBox[{"s", ",", "L"}]], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", 
          RowBox[{"s", ",", "T"}]], "[", "t", "]"}], "/", "3"}]}]}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.463750610466195*^9, 3.463750751508608*^9}, {
  3.463750962930221*^9, 3.463750967129447*^9}, {3.46375505271509*^9, 
  3.4637550554640493`*^9}, {3.463761897860898*^9, 3.46376189827596*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4627885736901627`*^9, 3.4627885784012823`*^9}}],

Cell["The two constraint equation", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789371141161*^9, 3.462789377125111*^9}, {
  3.4627894572281513`*^9, 3.4627894573642063`*^9}}],

Cell[BoxData[
 RowBox[{"vcons", ":=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["k", "2"], 
    RowBox[{
     SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}]}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", "6"}], 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SubscriptBox["w", "s"], "[", "t", "]"}]}], ")"}], 
    RowBox[{
     SubscriptBox["\[CapitalOmega]", "V"], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.462788586612158*^9, 3.462788591414806*^9}, {
   3.462788684757147*^9, 3.462788729051238*^9}, 3.462788921761757*^9, {
   3.462885960989381*^9, 3.462885961899727*^9}, {3.4633930552534637`*^9, 
   3.4633930556451807`*^9}}],

Cell["The dynamical equation", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789380796928*^9, 3.4627893868049192`*^9}, 
   3.462789458796174*^9}],

Cell[BoxData[
 RowBox[{"vdyn", ":=", 
  RowBox[{
   RowBox[{"k", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sigma]", "V"], "'"}], "[", "t", "]"}], "+", 
      RowBox[{"2", 
       RowBox[{"H", "[", "t", "]"}], 
       RowBox[{
        SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}]}]}], ")"}]}], 
   "\[Equal]", 
   RowBox[{"3", 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{
     SubscriptBox["w", "s"], "[", "t", "]"}], 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "V"], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4627889241641006`*^9, 3.462788996192088*^9}}],

Cell["As a vector potential I use the spatial shear", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4627894818275127`*^9, 3.462789507419237*^9}}],

Cell[BoxData[
 RowBox[{"vecvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4627893472571907`*^9, 3.4627893605803127`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Equation", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443515529263959*^9, 3.4435155385524683`*^9}, 
   3.4437931150612593`*^9, {3.443801055931888*^9, 3.443801061504792*^9}, {
   3.4543154448940763`*^9, 3.45431548659352*^9}}],

Cell["The Tensor wave equation", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462789380796928*^9, 3.4627893868049192`*^9}, {
  3.462789467245556*^9, 3.4627894726518803`*^9}}],

Cell[BoxData[
 RowBox[{"tensor", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["h", "T"], "''"}], "[", "t", "]"}], "+", 
    RowBox[{"2", 
     RowBox[{"H", "[", "t", "]"}], 
     RowBox[{
      RowBox[{
       SubscriptBox["h", "T"], "'"}], "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["k", "2"], 
     RowBox[{
      SubscriptBox["h", "T"], "[", "t", "]"}]}]}], "\[Equal]", 
   RowBox[{"3", 
    SuperscriptBox[
     RowBox[{"H", "[", "t", "]"}], "2"], 
    RowBox[{
     SubscriptBox["w", "s"], "[", "t", "]"}], 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "T"], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44351554165068*^9, 3.44351556333073*^9}, {
   3.44351560199332*^9, 3.443515637933178*^9}, {3.4435161738683653`*^9, 
   3.4435162953799562`*^9}, {3.443516960611978*^9, 3.4435169743249893`*^9}, 
   3.4437386694761744`*^9, 3.443793115066124*^9, {3.4438018334880857`*^9, 
   3.443801837790667*^9}, {3.444571954696802*^9, 3.44457196800517*^9}, 
   3.444572059478603*^9, {3.4445722785921593`*^9, 3.444572287857397*^9}, {
   3.4445724417632504`*^9, 3.444572475266871*^9}, 3.4445725169402533`*^9, {
   3.444573319546795*^9, 3.444573319746427*^9}, {3.44457335882101*^9, 
   3.444573361625733*^9}, {3.444573514783764*^9, 3.4445735166271048`*^9}, {
   3.444574930992113*^9, 3.444574932175441*^9}, {3.4445750884297657`*^9, 
   3.4445750970576353`*^9}, {3.444633218011026*^9, 3.4446332204391527`*^9}, {
   3.44473458478751*^9, 3.444734601686822*^9}, {3.445256151631825*^9, 
   3.445256151957445*^9}, {3.454315598252883*^9, 3.454315600760096*^9}, {
   3.45431635540495*^9, 3.454316410315256*^9}, {3.454322719406431*^9, 
   3.454322726701345*^9}, {3.454322794429778*^9, 3.4543228063364964`*^9}, {
   3.4543243456658373`*^9, 3.4543243530308037`*^9}, {3.461162427905671*^9, 
   3.461162430881822*^9}}],

Cell[BoxData[
 RowBox[{"tensvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["h", "T"], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.4435182730412188`*^9, {3.4435183551417923`*^9, 3.443518370925585*^9}, 
   3.443793115085676*^9, 3.4438011007646103`*^9, 3.444572463683432*^9, 
   3.4445725204150267`*^9, {3.444634522890411*^9, 3.444634528561116*^9}, {
   3.454315609394678*^9, 3.454315624264071*^9}, {3.4543243573969707`*^9, 
   3.4543243579039516`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold Dark Matter", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.462793033788494*^9, 3.4627930387397614`*^9}}],

Cell[CellGroupData[{

Cell["Background Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462793108939045*^9, 3.462793113594659*^9}}],

Cell["\<\
CDM is pressureless, so set all background quantities accordingly.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462792835782922*^9, 3.46279286460667*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["w", "c"], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442146644161736*^9, 3.442146649174448*^9}, {
   3.4434660030667686`*^9, 3.443466012858336*^9}, 3.44346633180996*^9, 
   3.443793114984482*^9, 3.443799153362088*^9, 3.443799270486565*^9, 
   3.443802355630076*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "c"], "[", "t_", "]"}], ":=", 
  RowBox[{
   SubscriptBox["\[Rho]", "c0"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], 
    RowBox[{
     RowBox[{"-", "3"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["w", "c"], "[", "t", "]"}]}], ")"}]}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4434660527144136`*^9, 3.44346614168116*^9}, {
   3.4434661930949707`*^9, 3.443466208371256*^9}, 3.4437211700827513`*^9, 
   3.443793114989702*^9, 3.443799153376315*^9, 3.443799270486693*^9, 
   3.4438023556302*^9, {3.4440494232952642`*^9, 3.444049449425119*^9}, {
   3.444049572116852*^9, 3.444049574133445*^9}, {3.457181244785537*^9, 
   3.4571812479405622`*^9}, {3.461057149968754*^9, 3.461057152766836*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["P", "c"], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["w", "c"], "[", "t", "]"}], " ", 
   RowBox[{
    SubscriptBox["\[Rho]", "c"], "[", "t", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4434662328969584`*^9, 3.443466282331133*^9}, 
   3.443793114994726*^9, 3.443799270486821*^9, 3.44380235563032*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["c", "c"], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444058104016712*^9, 3.444058111615189*^9}, {
  3.444642754341165*^9, 3.444642757325728*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "c"], "[", "t_", "]"}], ":=", 
  "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444661239018787*^9, 3.444661252795733*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pertubation Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443800707054317*^9, 3.4438007111428423`*^9}, {
   3.443802183574585*^9, 3.4438021892134943`*^9}, 3.4446339107917223`*^9}],

Cell[CellGroupData[{

Cell["Scalar Perturbations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462792980420705*^9, 3.46279298598037*^9}}],

Cell[BoxData[
 RowBox[{"cdm1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "c"], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "k"}], " ", 
     RowBox[{
      SubscriptBox["V", "c"], "[", "t", "]"}]}], "+", 
    RowBox[{"3", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443517896483633*^9, 3.4435179549040823`*^9}, 
   3.4437931150043297`*^9, {3.4438004706472893`*^9, 3.443800471017705*^9}, 
   3.44457246372182*^9, {3.444633844886248*^9, 3.444633872677246*^9}, {
   3.444723913527975*^9, 3.444723918110914*^9}, {3.461163213314149*^9, 
   3.461163216982628*^9}}],

Cell[BoxData[
 RowBox[{"cdm2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["V", "c"], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"H", "[", "t", "]"}]}], 
     RowBox[{
      SubscriptBox["V", "c"], "[", "t", "]"}]}], "+", 
    RowBox[{"k", " ", 
     RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4435179584837303`*^9, 3.443518034237245*^9}, 
   3.443793115009251*^9, {3.443800476023596*^9, 3.44380047634663*^9}, 
   3.443801844123169*^9, 3.444572520449101*^9, {3.444633860433736*^9, 
   3.444633875346084*^9}, {3.4447239237375183`*^9, 3.444723925900754*^9}, {
   3.461156481214764*^9, 3.461156488308799*^9}, {3.4611624137285357`*^9, 
   3.461162416726183*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", "c"], "[", "t_", "]"}], ":=", "0"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.443517848689893*^9, 3.443517859854827*^9}, 
   3.443793114999453*^9, {3.461156491960218*^9, 3.461156493345154*^9}}],

Cell[BoxData[
 RowBox[{"cdm", ":=", 
  RowBox[{"{", 
   RowBox[{"cdm1", ",", "cdm2"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4435185904431667`*^9, 3.443518594667244*^9}, 
   3.4437931150139303`*^9, {3.443800481325594*^9, 3.44380048409761*^9}, {
   3.443802463120175*^9, 3.443802465088531*^9}, {3.443802541484148*^9, 
   3.443802544660596*^9}, {3.44463387940874*^9, 3.444633880774617*^9}, {
   3.444736331000465*^9, 3.444736333563953*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector Perturbations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462792722937155*^9, 3.462792727080531*^9}}],

Cell["\<\
CDM can't support any vector perturbations, so we just set them to zero.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462792742832416*^9, 3.462792774223874*^9}}],

Cell[BoxData[
 RowBox[{"vcdm1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalOmega]", 
      RowBox[{"V", ",", "c"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"H", "[", "t", "]"}]}], 
    RowBox[{
     SubscriptBox["\[CapitalOmega]", 
      RowBox[{"V", ",", "c"}]], "[", "t", "]"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795191947571*^9, 
   3.462795272436758*^9}, {3.462822740720812*^9, 3.4628227629193783`*^9}, {
   3.462822858040141*^9, 3.4628228613753653`*^9}, {3.462868072878591*^9, 
   3.4628680885237503`*^9}, {3.462874215203961*^9, 3.462874230597736*^9}, {
   3.4628742853974867`*^9, 3.462874291094965*^9}, {3.462874335540901*^9, 
   3.46287438881991*^9}, 3.4628752343254147`*^9, {3.462876652013803*^9, 
   3.462876698719413*^9}, {3.4628777414346123`*^9, 3.462877742383765*^9}, {
   3.4628781343486958`*^9, 3.462878150483508*^9}, {3.462878549821375*^9, 
   3.462878556155143*^9}, {3.4628804558348627`*^9, 3.462880461333378*^9}, {
   3.4628852501068373`*^9, 3.462885264935113*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalOmega]", 
     RowBox[{"V", ",", "c"}]], "[", "t_", "]"}], ":=", "0"}], "*)"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4627927817706203`*^9, 3.462792810118492*^9}, {
  3.462885268764676*^9, 3.462885272723997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", 
    RowBox[{"V", ",", "c"}]], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4627927944327507`*^9, 3.462792807110488*^9}}],

Cell[BoxData[
 RowBox[{"vcdmvars", "=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalOmega]", 
     RowBox[{"V", ",", "c"}]], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4628852794322844`*^9, 3.4628852923240147`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor perturbations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323912921566*^9, 3.454323917657029*^9}}],

Cell["As with the vectors there are no tensor CDM perturbations", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462792819071249*^9, 3.462792830470935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", 
    RowBox[{"T", ",", "c"}]], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454323919446952*^9, 3.454323928142765*^9}, {
  3.462792682871811*^9, 3.462792683762003*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4438024051975307`*^9, 3.443802407073696*^9}}],

Cell[BoxData[
 RowBox[{"cdmvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "c"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["V", "c"], "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443515275802705*^9, 3.443515277643744*^9}, {
   3.443518057205653*^9, 3.443518083147752*^9}, 3.4437931150186977`*^9, {
   3.444633919112493*^9, 3.444633925964162*^9}, {3.445001288854303*^9, 
   3.445001293698861*^9}, {3.461156503393469*^9, 3.461156504264818*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radiation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.443466309152873*^9, 3.443466363912809*^9}, 
   3.4435152738726683`*^9, 3.443793115023315*^9, {3.443799297033235*^9, 
   3.4437993002913933`*^9}, 3.4437993319736433`*^9, 3.443802355630487*^9}],

Cell[CellGroupData[{

Cell["Background Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462793139914*^9, 3.462793143794457*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["w", "\[Gamma]"], "[", "t_", "]"}], ":=", 
  RowBox[{"1", "/", "3"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466369856537*^9, 3.443466370017377*^9}, {
   3.4434664215881023`*^9, 3.443466422366137*^9}, 3.443793115028007*^9, 
   3.44379933197383*^9, 3.443802355630641*^9, {3.443982649825142*^9, 
   3.4439826527496977`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "\[Gamma]"], "[", "t_", "]"}], ":=", 
  RowBox[{
   SubscriptBox["\[Rho]", "\[Gamma]0"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], 
    RowBox[{
     RowBox[{"-", "3"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["w", "\[Gamma]"], "[", "t", "]"}]}], 
      ")"}]}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466381280816*^9, 3.4434663973353567`*^9}, 
   3.443793115033231*^9, 3.4437993319739637`*^9, 3.4438023556307592`*^9, {
   3.443982660944969*^9, 3.443982677839697*^9}, {3.444049409078491*^9, 
   3.444049414144347*^9}, {3.444049455186343*^9, 3.444049465408045*^9}, {
   3.44404957862646*^9, 3.4440495799967003`*^9}, 3.444660127669376*^9, {
   3.457181255832656*^9, 3.457181258300284*^9}, {3.4610571676250753`*^9, 
   3.4610571702472773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["P", "\[Gamma]"], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["w", "\[Gamma]"], "[", "t", "]"}], " ", 
   RowBox[{
    SubscriptBox["\[Rho]", "\[Gamma]"], "[", "t", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4434664050149107`*^9, 3.443466415086829*^9}, 
   3.4437931150382757`*^9, 3.443799331974092*^9, 3.443802355630879*^9, {
   3.443982684071748*^9, 3.443982699806807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["c", "\[Gamma]"], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["P", "\[Gamma]"], "'"}], "[", "t", "]"}], "/", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Rho]", "\[Gamma]"], "'"}], "[", "t", "]"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4440581270473022`*^9, 3.444058144127358*^9}, {
  3.444650076067616*^9, 3.444650117949974*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "\[Gamma]"], "[", "t_", "]"}], ":=", 
  "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444661239018787*^9, 3.444661268205345*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4627931526339893`*^9, 3.462793157730166*^9}}],

Cell[CellGroupData[{

Cell["Scalar Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443861166536331*^9, 3.443861174907585*^9}, 
   3.444634219339793*^9, {3.462793163379521*^9, 3.462793164418008*^9}}],

Cell[TextData[{
 "Substitution for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Tau]", "c"], TraditionalForm]]],
 "in terms of scattering cross section etc. Currently separate for ease of \
expansion."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438635477298594`*^9, 3.4438636018256893`*^9}}],

Cell[BoxData[
 RowBox[{"tauc", ":=", 
  RowBox[{"dtight", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", "[", "t", "]"}], 
     RowBox[{
      SubscriptBox["n", "e"], "[", "t", "]"}], 
     SubscriptBox["\[Sigma]", "T"]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443861458291163*^9, 3.443861522580482*^9}, {
  3.4438617025729837`*^9, 3.443861702952457*^9}, {3.443863562141486*^9, 
  3.44386356468789*^9}, {3.444041662531969*^9, 3.444041662831605*^9}}],

Cell[CellGroupData[{

Cell["Equations for the Bolzmann hierarchy", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443864019357623*^9, 3.443864042273459*^9}, 
   3.4438640806043587`*^9}],

Cell[BoxData[
 RowBox[{"photon1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "\[Gamma]"], "'"}], "[", "t", "]"}], 
   "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["4", "3"]}], "k", " ", 
     RowBox[{
      SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438611848861923`*^9, 3.44386129768935*^9}, 
   3.443864080604545*^9, 3.4445724637238894`*^9, {3.444633979286961*^9, 
   3.4446340110290327`*^9}, {3.444724031774456*^9, 3.4447240328661423`*^9}, {
   3.445070743684288*^9, 3.445070743853552*^9}, {3.461156856537408*^9, 
   3.4611568620225*^9}}],

Cell[BoxData[
 RowBox[{"photon2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["V", "\[Gamma]"], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"k", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "\[Gamma]"], "[", "t", "]"}], "/", 
        "4"}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPi]", "\[Gamma]"], "[", "t", "]"}], "/", 
        "6"}]}], ")"}]}], "+", 
    RowBox[{"k", " ", 
     RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "b"], "[", "t", "]"}], "-", 
       RowBox[{
        SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}]}], ")"}], "/", 
     RowBox[{
      SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861302054768*^9, 3.443861409745491*^9}, {
   3.443861565455989*^9, 3.443861598526485*^9}, 3.4438640806046753`*^9, 
   3.4439819021887083`*^9, {3.443981936028255*^9, 3.4439819373061543`*^9}, 
   3.4445725204516773`*^9, {3.444633982214971*^9, 3.444633982566668*^9}, {
   3.444634019380856*^9, 3.444634028398182*^9}, {3.4446340989128113`*^9, 
   3.444634110058052*^9}, 3.444661660651744*^9, {3.4447240384093437`*^9, 
   3.444724039212594*^9}, {3.4447398570514*^9, 3.444739859833009*^9}, {
   3.44507074637246*^9, 3.445070747615082*^9}, {3.461156868911483*^9, 
   3.461156895753997*^9}, {3.4611634348015947`*^9, 3.46116343916254*^9}}],

Cell[BoxData[
 RowBox[{"photon3", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalPi]", "\[Gamma]"], "'"}], "[", "t", "]"}], 
   "\[Equal]", 
   RowBox[{
    RowBox[{
     FractionBox["8", "5"], "k", " ", 
     RowBox[{
      SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}]}], "-", 
    RowBox[{
     FractionBox["9", "5"], "k", " ", 
     RowBox[{
      SubscriptBox["F", "\[Gamma]"], "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["9", "10"], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalPi]", "\[Gamma]"], "[", "t", "]"}], "/", 
      RowBox[{
       SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861748982449*^9, 3.4438617504847107`*^9}, {
   3.4438618021542397`*^9, 3.443861813108035*^9}, {3.443861853686108*^9, 
   3.44386197175904*^9}, 3.443864080604816*^9, {3.444633985238287*^9, 
   3.444633985558263*^9}, {3.444634115953532*^9, 3.4446341262815332`*^9}, {
   3.444661661955901*^9, 3.444661663026589*^9}, {3.44472404308057*^9, 
   3.4447240454838533`*^9}, {3.445070749772402*^9, 3.445070749915921*^9}, 
   3.4453317582762423`*^9, {3.461156959406592*^9, 3.4611570075850887`*^9}, {
   3.461163314760874*^9, 3.461163318195176*^9}}],

Cell[BoxData[
 RowBox[{"photon4", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", "\[Gamma]"], "'"}], "[", 
    RowBox[{"t", ",", "l"}], "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"k", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["l", 
         RowBox[{
          RowBox[{"2", "l"}], "-", "1"}]], " ", 
        RowBox[{
         SubscriptBox["F", "\[Gamma]"], "[", 
         RowBox[{"t", ",", 
          RowBox[{"l", "-", "1"}]}], "]"}]}], "-", 
       RowBox[{
        FractionBox[
         RowBox[{"l", "+", "1"}], 
         RowBox[{
          RowBox[{"2", "l"}], "+", "3"}]], " ", 
        RowBox[{
         SubscriptBox["F", "\[Gamma]"], "[", 
         RowBox[{"t", ",", 
          RowBox[{"l", "+", "1"}]}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "\[Gamma]"], "[", 
      RowBox[{"t", ",", "l"}], "]"}], "/", 
     RowBox[{
      SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.461158125810606*^9, 3.461158145018929*^9}}]
}, Open  ]],

Cell["\<\
Identify the photon shear with the quadrupole moment of the distribution \
function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", "\[Gamma]"], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{
      FractionBox["3", "5"], 
      RowBox[{
       SubscriptBox["F", "\[Gamma]"], "[", 
       RowBox[{"t", ",", "2"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4438623900855207`*^9, 3.443862436788541*^9}, {
   3.4438624731619053`*^9, 3.44386251194346*^9}, {3.444634135877689*^9, 
   3.444634138415599*^9}, 3.444661664089867*^9, {3.444740518552786*^9, 
   3.444740518796526*^9}, {3.444740574944374*^9, 3.444740578163487*^9}, {
   3.461157012459961*^9, 3.4611570221137733`*^9}, {3.4611581816183043`*^9, 
   3.461158182736497*^9}}],

Cell[CellGroupData[{

Cell["Truncate the photon hierarchy at a specified level", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438635165731363`*^9, 3.44386352785854*^9}, 
   3.443864094427287*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tphoton", "[", "0", "]"}], ":=", 
   RowBox[{"tphoton", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tphoton", "[", "1", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"photon1", ",", "photon2"}], "}"}], "/.", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "\[Gamma]"], "[", 
      RowBox[{"t", ",", "2"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tphoton", "[", "2", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"photon1", ",", "photon2", ",", "photon3"}], "}"}], "/.", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "\[Gamma]"], "[", 
      RowBox[{"t", ",", "3"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tphoton", "[", 
    RowBox[{"ll_", "/;", 
     RowBox[{"ll", ">", "2"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"photon1", ",", "photon2", ",", "photon3", ",", 
       RowBox[{"photon4", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], 
     "]"}], "/.", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", "\[Gamma]"], "[", 
      RowBox[{"t", ",", 
       RowBox[{"ll", "+", "1"}]}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"photonvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "\[Gamma]"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.461157091132946*^9, 3.4611570933194227`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462822700220673*^9, 3.462822721761623*^9}}],

Cell["\<\
Might need to modify the first equation, possibly adding in \[Sigma].\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462875855034946*^9, 3.4628759059679337`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vphoton1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Gamma]", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "k"}], 
     FractionBox[
      SqrtBox["3"], "5"], " ", 
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Gamma]", ",", "2"}]], "[", "t", "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]", 
          RowBox[{"V", ",", "b"}]], "[", "t", "]"}], "-", 
        RowBox[{
         SubscriptBox["\[CapitalOmega]", 
          RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}]}], ")"}], "/", 
      RowBox[{
       SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795191947571*^9, 
   3.462795272436758*^9}, {3.462822740720812*^9, 3.4628227629193783`*^9}, {
   3.462822858040141*^9, 3.4628228613753653`*^9}, {3.462868072878591*^9, 
   3.4628680885237503`*^9}, {3.462874215203961*^9, 3.462874230597736*^9}, {
   3.4628742853974867`*^9, 3.462874291094965*^9}, {3.462874335540901*^9, 
   3.46287438881991*^9}, 3.4628752343254147`*^9}],

Cell[BoxData[
 RowBox[{"vphoton2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Gamma]", ",", "2"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"k", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         SqrtBox["3"], "3"], " ", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Gamma]", ",", 
           RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
       RowBox[{
        FractionBox[
         SqrtBox["8"], "7"], " ", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Gamma]", ",", 
           RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["4", 
      SqrtBox["3"]], "k", " ", 
     RowBox[{
      SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}]}], "-", 
    RowBox[{
     FractionBox["9", "10"], 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Gamma]", ",", "2"}]], "[", "t", "]"}], "/", 
      RowBox[{
       SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.454252412587578*^9, 
   3.454252412735592*^9}, {3.45425273620201*^9, 3.454252837886224*^9}, {
   3.454257836611588*^9, 3.45425783685773*^9}, 3.454258869256315*^9, 
   3.454258987144186*^9, {3.4543234661077414`*^9, 3.4543234689570723`*^9}, {
   3.454325308567286*^9, 3.4543253192819767`*^9}, {3.462794490809224*^9, 
   3.462794494040781*^9}, {3.462794785740233*^9, 3.4627947938674717`*^9}, {
   3.462795279804367*^9, 3.462795283554476*^9}, {3.462795350326227*^9, 
   3.4627953950944433`*^9}, {3.4627954300611353`*^9, 3.46279545029436*^9}, {
   3.462795558795191*^9, 3.462795609892315*^9}, {3.462795835402629*^9, 
   3.462795843243017*^9}, {3.462822781100325*^9, 3.462822828180788*^9}, {
   3.4628228631851063`*^9, 3.462822865505048*^9}, {3.462868077691695*^9, 
   3.462868098850087*^9}, 3.462874485560213*^9, {3.4634042619065523`*^9, 
   3.4634042621522493`*^9}}],

Cell[BoxData[
 RowBox[{"vphoton3", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Gamma]", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"k", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         SqrtBox[
          RowBox[{
           SuperscriptBox["l", "2"], "-", "1"}]], 
         RowBox[{
          RowBox[{"2", "l"}], "-", "1"}]], " ", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Gamma]", ",", 
           RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
       RowBox[{
        FractionBox[
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "1"}]], 
         RowBox[{
          RowBox[{"2", "l"}], "+", "3"}]], " ", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Gamma]", ",", 
           RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Gamma]", ",", "l"}]], "[", "t", "]"}], "/", 
     RowBox[{
      SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795319230138*^9, 
   3.462795337007248*^9}, {3.462822834129685*^9, 3.462822871025073*^9}, 
   3.462868044450671*^9, {3.462868082237694*^9, 3.4628681105215*^9}, {
   3.4628744458922377`*^9, 3.4628744951953077`*^9}}]
}, Open  ]],

Cell["\<\
Identify the neutrino shear stress with the quadrupole moment of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}}],

Cell[BoxData[
 RowBox[{"vphotpert", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Gamma]", ",", "1"}]], "[", "t", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", 
        SqrtBox["3"]}], "5"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Gamma]", ",", "2"}]], "[", "t", "]"}]}]}]}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ3dfCeGXO+peOnHFJV0H0G5vtL0H0/p61b0H0jFaW
52+BdNUFXjD9qky7MHPDS8dbDf9LQPSb7PxGEP0luAxMfyhg7hHd+NLx0WNu
MG052/KILZA+tM3+GIjmi2RkWbf1pePy04GsIHpPmvGSsj0vHYsKzoFp58cy
TOVAOm7tBGYQrSARzA6iHfZ+A9PfHqySAtEFR2LkQHT+2tdJM4G045qPYJrp
i9byg2deOl551AGmQyJ5doHoKWoSYHrD8xcyx4D0zy+vwXTDx9nu54G0Ze3U
ABDN4JwXA6I5XQrBtNF3nZ6nQDqb0QVMy21pmgSiN/46ORNEi11yvACiT78I
BNMAv2PAMg==
  "]],

Cell["\<\
A new system for producing exactly Fermi-Dirac solutions (eliminates G using \
the fact that F = 2 G for Fermi-Dirac).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.451807463483613*^9, 3.451807504633762*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vphotinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"vphotpert", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Gamma]", ",", "1"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"vphotpert", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Gamma]", ",", "2"}]], "[", "t", "]"}]}], "]"}]}], "}"}],
      "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, 
   3.454253351103299*^9, {3.454253538359783*^9, 3.454253552017529*^9}, {
   3.454253743707362*^9, 3.4542537657274103`*^9}, {3.4543234938943033`*^9, 
   3.454323517472558*^9}, {3.462794636789838*^9, 3.4627946383038054`*^9}, {
   3.462803734240711*^9, 3.462803741808527*^9}, {3.462803844316331*^9, 
   3.462803867539607*^9}, {3.462868576706369*^9, 3.462868602931954*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vphot", "[", "2", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vphoton1", ",", "vphoton2"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Gamma]", ",", "3"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
       "}"}]}], "/.", "vphotinvert"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vphot", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "2"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vphoton1", ",", "vphoton2", ",", 
        RowBox[{"vphoton3", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], 
      "vphotinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Gamma]", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.454253366462283*^9, 
   3.454253565416397*^9}, {3.454323498788684*^9, 3.45432354573627*^9}, {
   3.462794569044945*^9, 3.462794574107589*^9}, {3.4627946067246428`*^9, 
   3.462794624347631*^9}, {3.4628036897422028`*^9, 3.462803694749954*^9}, {
   3.462803747308069*^9, 3.462803752643539*^9}, {3.4628039048286877`*^9, 
   3.4628039051486053`*^9}, {3.462804026695615*^9, 3.46280407033372*^9}, {
   3.462868623652315*^9, 3.46286872825311*^9}}],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"vpvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalOmega]", 
     RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
   3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
   3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
   3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
   3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
   3.454253519931979*^9, 3.45425352594897*^9}, {3.4543237038008327`*^9, 
   3.4543237039652977`*^9}, {3.462794661522745*^9, 3.462794663296857*^9}, {
   3.462794694664415*^9, 3.4627946959048233`*^9}, {3.462804082208498*^9, 
   3.462804082328738*^9}, {3.462868369421229*^9, 3.462868381109152*^9}, {
   3.462886175225974*^9, 3.462886176031827*^9}, {3.463321343961193*^9, 
   3.46332134421481*^9}, {3.463325175530283*^9, 3.463325183435598*^9}, 
   3.4633265121429157`*^9, {3.463391730766941*^9, 3.463391740949132*^9}, 
   3.463393167509392*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vphotonvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"vpvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Gamma]", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQbXa+kaVs9UvHeGN9HhDNo/edH0TfKJstBKKdbIrE
QLRHgbo0mH4YW1gOpB2+bQLT73r2hcxd/9JRPeZ0DIh+1C+YD6IVznuBaQ+u
DOeDQHq6ZoQriA7cz27+GkjzfI4F0zPrb+eB6ENbHUtA9JuAo/NB9Noc0QUg
OqTkosA7IM3WxCQIogMuzK3N3PDS8Wm3ZR2IFvM6v+oJkG47fWsTiL7yK0L1
7PaXjt0B2pog+pbuXj0QvevsEgMQvSG13bF8z0vHrDg9NxC9riS/fiaQNvJx
aQDRbo5NWw+eeen4sfjgdhB9QqvK7xiQFlK6CaYfcl++/xRIzzv3AkxvOBuX
8g5IG5gdA9Mel5yaQbRvqReYBgD0RcQf
  "]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323912921566*^9, 3.454323917657029*^9}, {
   3.461157102657085*^9, 3.4611571133664093`*^9}, 3.462868278526904*^9}],

Cell["\<\
There are no significant tensor perturbations in the photon distribution, so \
set them to zero.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4628683351897297`*^9, 3.4628683564129972`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", 
    RowBox[{"T", ",", "\[Gamma]"}]], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454323919446952*^9, 3.454323943404874*^9}, {
  3.461162360993046*^9, 3.461162364338077*^9}, {3.46279317410563*^9, 
  3.462793180537282*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Baryons", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.443864149459305*^9, 3.44386415119141*^9}}],

Cell[CellGroupData[{

Cell["Background quantities", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4438642300739737`*^9, 3.443864235542296*^9}}],

Cell["Assume baryons are essentially pressureless at early times", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.443864429543951*^9, 3.443864448314507*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["w", "b"], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442146644161736*^9, 3.442146649174448*^9}, {
   3.4434660030667686`*^9, 3.443466012858336*^9}, 3.44346633180996*^9, 
   3.443793114984482*^9, 3.443799153362088*^9, 3.443799270486565*^9, 
   3.443802355630076*^9, {3.44386435211972*^9, 3.443864352226156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "b"], "[", "t_", "]"}], ":=", 
  RowBox[{
   SubscriptBox["\[Rho]", "b0"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], 
    RowBox[{
     RowBox[{"-", "3"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["w", "b"], "[", "t", "]"}]}], ")"}]}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4434660527144136`*^9, 3.44346614168116*^9}, {
   3.4434661930949707`*^9, 3.443466208371256*^9}, 3.4437211700827513`*^9, 
   3.443793114989702*^9, 3.443799153376315*^9, 3.443799270486693*^9, 
   3.4438023556302*^9, {3.443864356065476*^9, 3.44386435619593*^9}, {
   3.4439542356569223`*^9, 3.4439542375698013`*^9}, {3.4439826288907013`*^9, 
   3.443982629665677*^9}, {3.4440493803438463`*^9, 3.444049391848276*^9}, {
   3.4440495894106007`*^9, 3.444049590628931*^9}, {3.457181281437229*^9, 
   3.457181284954687*^9}, {3.461057180167094*^9, 3.461057183038498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["P", "b"], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["w", "b"], "[", "t", "]"}], " ", 
   RowBox[{
    SubscriptBox["\[Rho]", "b"], "[", "t", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4434662328969584`*^9, 3.443466282331133*^9}, 
   3.443793114994726*^9, 3.443799270486821*^9, 3.44380235563032*^9, {
   3.443864359864196*^9, 3.443864370067881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["c", "b"], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443517848689893*^9, 3.443517859854827*^9}, 
   3.443793114999453*^9, {3.443864362518674*^9, 3.443864362640917*^9}, {
   3.44395461859056*^9, 3.443954629239148*^9}, 3.444058154821569*^9, {
   3.444650246699069*^9, 3.444650264049395*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "b"], "[", "t_", "]"}], ":=", 
  "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444661239018787*^9, 3.444661278898631*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", "t_", "]"}], ":=", 
  FractionBox[
   RowBox[{"4", 
    RowBox[{
     SubscriptBox["\[Rho]", "\[Gamma]"], "[", "t", "]"}]}], 
   RowBox[{"3", 
    RowBox[{
     SubscriptBox["\[Rho]", "b"], "[", "t", "]"}]}]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443956090138362*^9, 3.4439562116764402`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443954331102565*^9, 3.443954340109005*^9}, 
   3.445002002304935*^9}],

Cell[BoxData[
 RowBox[{"baryon1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "b"], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "k"}], " ", 
     RowBox[{
      SubscriptBox["V", "b"], "[", "t", "]"}]}], "+", 
    RowBox[{"3", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443954347214786*^9, 3.443954382994981*^9}, {
   3.4439544391570377`*^9, 3.443954440020732*^9}, 3.444572463725522*^9, {
   3.444634240013225*^9, 3.444634251012436*^9}, {3.444724054237722*^9, 
   3.444724055361176*^9}, {3.461157770958596*^9, 3.461157772534317*^9}}],

Cell[BoxData[
 RowBox[{"baryon2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["V", "b"], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"H", "[", "t", "]"}]}], 
     RowBox[{
      SubscriptBox["V", "b"], "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{
       SubscriptBox["c", "b"], "[", "t", "]"}], "2"], "k", " ", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "b"], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"R", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}], "-", 
        RowBox[{
         SubscriptBox["V", "b"], "[", "t", "]"}]}], ")"}], "/", 
      RowBox[{
       SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}], "+", 
    RowBox[{"k", " ", 
     RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], "k", " ", 
     RowBox[{"R", "[", "t", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["w", "\[Gamma]"], "[", "t", "]"}], 
        SubscriptBox["s", "B"]}], "-", 
       RowBox[{
        FractionBox["1", "2"], 
        SubscriptBox["d", "B"]}]}], ")"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443954442504263*^9, 3.4439546075334883`*^9}, 
   3.443956084336172*^9, 3.4445725204537983`*^9, {3.444634241709683*^9, 
   3.444634275590321*^9}, {3.444724059066486*^9, 3.4447240598298807`*^9}, 
   3.444738243654851*^9, {3.4531053759339523`*^9, 3.4531054763898563`*^9}, {
   3.453106977533875*^9, 3.453106980093733*^9}, {3.454756936445286*^9, 
   3.454756936685691*^9}, {3.4611577782314243`*^9, 3.46115780374196*^9}, {
   3.4611631376892433`*^9, 3.461163140329187*^9}, {3.461163964001422*^9, 
   3.461163980596345*^9}, {3.4611640368927402`*^9, 3.461164037000146*^9}, {
   3.4611675318777857`*^9, 3.461167533306862*^9}, {3.4628804229786243`*^9, 
   3.462880439458828*^9}, {3.462883465899928*^9, 3.462883467283091*^9}, {
   3.462883909709201*^9, 3.462883909832172*^9}}],

Cell[BoxData[
 RowBox[{"baryon", ":=", 
  RowBox[{"{", 
   RowBox[{"baryon1", ",", "baryon2"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4450706926019297`*^9, 3.445070707540547*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450014094228563`*^9, 3.445001413017332*^9}}],

Cell[BoxData[
 RowBox[{"baryonvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "b"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["V", "b"], "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981835922187*^9, 3.4439818569233847`*^9}, {
  3.444649889593082*^9, 3.444649896482703*^9}, {3.461157812444172*^9, 
  3.4611578131958513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", "b"], "[", "t_", "]"}], ":=", "0"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4611578170912323`*^9, 3.461157820242147*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462822700220673*^9, 3.462822721761623*^9}}],

Cell["\<\
Might need to modify the first equation, possibly adding in \[Sigma].\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462875855034946*^9, 3.4628759059679337`*^9}}],

Cell[BoxData[
 RowBox[{"vbaryon1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalOmega]", 
      RowBox[{"V", ",", "b"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"H", "[", "t", "]"}]}], 
     RowBox[{
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"V", ",", "b"}]], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"R", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]", 
          RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}], "-", 
        RowBox[{
         SubscriptBox["\[CapitalOmega]", 
          RowBox[{"V", ",", "b"}]], "[", "t", "]"}]}], ")"}], "/", 
      RowBox[{
       SubscriptBox["\[Tau]", "c"], "[", "t", "]"}]}]}], "-", 
    RowBox[{
     FractionBox["3", "8"], "k", " ", 
     RowBox[{"R", "[", "t", "]"}], 
     RowBox[{
      SubscriptBox["w", "\[Gamma]"], "[", "t", "]"}], 
     SubscriptBox["s", 
      RowBox[{"V", ",", "B"}]]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795191947571*^9, 
   3.462795272436758*^9}, {3.462822740720812*^9, 3.4628227629193783`*^9}, {
   3.462822858040141*^9, 3.4628228613753653`*^9}, {3.462868072878591*^9, 
   3.4628680885237503`*^9}, {3.462874215203961*^9, 3.462874230597736*^9}, {
   3.4628742853974867`*^9, 3.462874291094965*^9}, {3.462874335540901*^9, 
   3.46287438881991*^9}, 3.4628752343254147`*^9, {3.462876652013803*^9, 
   3.462876698719413*^9}, {3.4628777414346123`*^9, 3.462877742383765*^9}, {
   3.4628781343486958`*^9, 3.462878150483508*^9}, {3.462878549821375*^9, 
   3.462878556155143*^9}, {3.4628804558348627`*^9, 3.462880461333378*^9}, {
   3.463319219031238*^9, 3.463319219652011*^9}, {3.463325828772238*^9, 
   3.4633258294827223`*^9}, {3.463391550684943*^9, 3.463391551930621*^9}, {
   3.463391714715382*^9, 3.4633917188798027`*^9}, 3.463393175256604*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", 
    RowBox[{"V", ",", "b"}]], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.463322753312801*^9, 3.463322764064335*^9}, {
  3.463325139922866*^9, 3.463325166218836*^9}}],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"vbaryonvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalOmega]", 
     RowBox[{"V", ",", "b"}]], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.454253519931979*^9, 3.45425352594897*^9}, {3.4543237038008327`*^9, 
  3.4543237039652977`*^9}, {3.462794661522745*^9, 3.462794663296857*^9}, {
  3.462794694664415*^9, 3.4627946959048233`*^9}, {3.462804082208498*^9, 
  3.462804082328738*^9}, {3.462868369421229*^9, 3.462868381109152*^9}, {
  3.462880490866242*^9, 3.462880498943473*^9}, {3.463325128236807*^9, 
  3.463325164002659*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323912921566*^9, 3.454323917657029*^9}, {
  3.461157827676461*^9, 3.461157833290905*^9}, {3.4628687937359056`*^9, 
  3.4628687945352497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalPi]", 
    RowBox[{"T", ",", "b"}]], "[", "t_", "]"}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454323919446952*^9, 3.45432395034979*^9}, {
  3.462868798003275*^9, 3.4628687987423773`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tightcoupling Approximation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.443955996953218*^9, 3.4439560037674313`*^9}}],

Cell[TextData[{
 "Approximation for the tightest coupling approximation, assume ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalTheta]", "\[Gamma]"], "=", 
    SubscriptBox["\[CapitalTheta]", "b"]}], TraditionalForm]]],
 " at early times, and then eliminate the Thomson scattering terms that make \
this all so hard."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4439604416158037`*^9, 3.443960489936598*^9}, {
  3.443960948827216*^9, 3.443960969791917*^9}, {3.444634447302959*^9, 
  3.444634453180932*^9}}],

Cell[BoxData[
 RowBox[{"tight1", ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["V", "b"], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443960528083866*^9, 3.443960560636883*^9}, {
  3.4439608501332006`*^9, 3.443960851375161*^9}, {3.444634309572027*^9, 
  3.444634359075172*^9}, {3.461157843280984*^9, 3.461157847602717*^9}}],

Cell[BoxData[
 RowBox[{"tight2", ":=", 
  RowBox[{
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"Eliminate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"photon2", ",", "baryon2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Tau]", "c"], "[", "t", "]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Rho]", "b"], "[", "t", "]"}], "\[NotEqual]", "0"}]}],
       "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "b"], "\[Rule]", 
      SubscriptBox["V", "\[Gamma]"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", "\[Gamma]"], "[", 
       RowBox[{"t", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4439595345689793`*^9, 3.443959589518291*^9}, {
  3.443960019650635*^9, 3.4439600349188957`*^9}, {3.443960191859357*^9, 
  3.443960198266966*^9}, {3.443960229418953*^9, 3.443960249771924*^9}, {
  3.443960379984179*^9, 3.443960406482005*^9}, {3.4439605200789347`*^9, 
  3.443960534736532*^9}, {3.4439605763525543`*^9, 3.44396060511419*^9}, {
  3.443960734711022*^9, 3.443960792271833*^9}, {3.443960854497156*^9, 
  3.4439609130195847`*^9}, {3.4446343115304203`*^9, 3.444634311858588*^9}, {
  3.4446343641042137`*^9, 3.444634377823934*^9}, {3.445070851465806*^9, 
  3.445070851648202*^9}, {3.461157853395443*^9, 3.461157856155237*^9}}],

Cell[BoxData[
 RowBox[{"tight", ":=", 
  RowBox[{"{", 
   RowBox[{"photon1", ",", " ", "baryon1", ",", "tight1", ",", "tight2"}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4450706749058437`*^9, 3.445070677631084*^9}, {
  3.445070713485457*^9, 3.445070727428604*^9}}],

Cell[BoxData[
 RowBox[{"btightsub", ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Tau]", "c"], "[", "t", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"R", "[", "t", "]"}]}], ")"}], 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "b"], "[", "t", "]"}], "-", 
       RowBox[{
        SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}]}], ")"}], 
     RowBox[{
      RowBox[{"k", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalPi]", "\[Gamma]"], "[", "t", "]"}], "/", 
          "6"}], "-", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "\[Gamma]"], "[", "t", "]"}], "/", 
          "4"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"H", "[", "t", "]"}], 
       RowBox[{
        SubscriptBox["V", "b"], "[", "t", "]"}]}]}]]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445185280726523*^9, 3.445185286860292*^9}, {
  3.4451853396289577`*^9, 3.445185485784492*^9}, {3.445186616060132*^9, 
  3.445186621845484*^9}, {3.4611578858936996`*^9, 3.461157924089221*^9}, {
  3.461163121849904*^9, 3.461163122857736*^9}}],

Cell[BoxData[
 RowBox[{"bettertight", ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"baryon1", ",", "baryon2", ",", "photon1", ",", "tight1"}], 
     "}"}], "//.", 
    RowBox[{"{", 
     RowBox[{"btightsub", ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", "\[Gamma]"], "[", 
        RowBox[{"t", ",", "2"}], "]"}], "\[Rule]", "0"}]}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445185512721373*^9, 3.445185612688972*^9}, {
  3.445242737408717*^9, 3.445242737927603*^9}, {3.454742228646896*^9, 
  3.454742241093293*^9}}],

Cell[CellGroupData[{

Cell["Systematic way of doing tight coupling", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454754488843851*^9, 3.454754498747218*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"btsub1", ":=", 
   RowBox[{
    SubscriptBox["V", "b"], "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "\[Gamma]"], "[", "t", "]"}], "+", 
       RowBox[{"\[Delta]V", "[", "t", "]"}]}]}], "]"}]}]}], ";", 
  RowBox[{"btsub2", ":=", 
   RowBox[{
    SubscriptBox["V", "\[Gamma]"], "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "b"], "[", "t", "]"}], "-", 
       RowBox[{"\[Delta]V", "[", "t", "]"}]}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454752927473206*^9, 3.454752997612769*^9}, {
  3.4547531007705917`*^9, 3.454753120607127*^9}, {3.454753976355743*^9, 
  3.4547539780736732`*^9}, {3.4547548819635763`*^9, 3.454754896539528*^9}, {
  3.454757106568301*^9, 3.454757146858513*^9}, {3.46115793194536*^9, 
  3.4611579627362556`*^9}}],

Cell["\<\
Solve for difference between velocities, \[Delta].\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.454754523178437*^9, 3.454754547324795*^9}}],

Cell[BoxData[
 RowBox[{"btsub3", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"photon2", "/.", "btsub1"}], ",", 
      RowBox[{"\[Delta]V", "[", "t", "]"}]}], "]"}], "]"}], "/.", 
   "btsub2"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454753048234419*^9, 3.4547530667851067`*^9}, {
   3.454753197278463*^9, 3.45475320692829*^9}, {3.4547534923553057`*^9, 
   3.4547535027702093`*^9}, 3.4547540678138742`*^9, {3.4547549030467577`*^9, 
   3.454754904287726*^9}, {3.461157995404793*^9, 3.461157996362419*^9}}],

Cell[BoxData[
 RowBox[{"btsub4", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Refine", "[", 
      RowBox[{
       RowBox[{"Eliminate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"photon2", ",", "baryon2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[Tau]", "c"], "[", "t", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Rho]", "b"], "[", "t", "]"}], "\[NotEqual]", "0"}],
          ",", 
         RowBox[{"a0", ">", "0"}]}], "}"}]}], "]"}], "/.", "btsub2"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "b"], "'"}], "[", "t", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454753416792363*^9, 3.45475342980261*^9}, {
  3.454753476861867*^9, 3.454753499097954*^9}, {3.454754367260105*^9, 
  3.454754369333085*^9}, {3.454754909135257*^9, 3.4547549103898153`*^9}, {
  3.4610588474990253`*^9, 3.4610588492435617`*^9}, {3.461158002026845*^9, 
  3.461158002400593*^9}, {3.461162449281053*^9, 3.46116245052206*^9}}],

Cell["Eliminate individual velocities.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.454754563057822*^9, 3.4547545804260607`*^9}}],

Cell[BoxData[
 RowBox[{"btsub5", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"btsub3", "/.", "btsub4"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454753507657247*^9, 3.454753518010144*^9}, {
   3.4547536819891663`*^9, 3.454753683063642*^9}, {3.45475439103438*^9, 
   3.4547544023981447`*^9}, 3.454754585606954*^9, {3.454754639783648*^9, 
   3.454754641760521*^9}}],

Cell[BoxData[
 RowBox[{"bteq", ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"baryon2", "/.", "btsub2"}], "/.", "btsub5"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]V", "'"}], "[", "t", "]"}], "\[Rule]", "0"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4547546228894253`*^9, 3.454754629742159*^9}, {
  3.454754661645275*^9, 3.4547547491500998`*^9}, {3.454754783260458*^9, 
  3.454754863158692*^9}, {3.461158006228321*^9, 3.461158006609791*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"trsub", "=", 
   RowBox[{
    SubscriptBox["\[Rho]", "\[Gamma]0"], "\[Rule]", 
    RowBox[{"3", "R", " ", 
     SubscriptBox["\[Rho]", "b0"], 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "a0"}], ")"}]}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454838584106238*^9, 3.4548385875333843`*^9}}],

Cell[BoxData[
 RowBox[{"bettertight2", ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"baryon1", ",", "bteq", ",", "photon1", ",", "tight1"}], "}"}], 
     "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", "\[Gamma]"], "[", 
       RowBox[{"t", ",", "2"}], "]"}], "\[Rule]", "0"}], "}"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445185512721373*^9, 3.445185612688972*^9}, {
   3.445242737408717*^9, 3.445242737927603*^9}, {3.454742228646896*^9, 
   3.454742241093293*^9}, {3.4547550148997517`*^9, 3.4547550245177298`*^9}, {
   3.454755072379277*^9, 3.454755077894059*^9}, 3.4548379462810802`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector tight coupling", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462881131030786*^9, 3.462881138868453*^9}}],

Cell[BoxData[
 RowBox[{"vtight1", ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalOmega]", 
     RowBox[{"V", ",", "b"}]], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    SubscriptBox["\[CapitalOmega]", 
     RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443960528083866*^9, 3.443960560636883*^9}, {
  3.4439608501332006`*^9, 3.443960851375161*^9}, {3.444634309572027*^9, 
  3.444634359075172*^9}, {3.461157843280984*^9, 3.461157847602717*^9}, {
  3.462881144511135*^9, 3.462881189628933*^9}}],

Cell[BoxData[
 RowBox[{"vtight2", ":=", 
  RowBox[{
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"Eliminate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vphoton1", ",", "vbaryon1"}], "}"}], "/.", "vphotinvert"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Tau]", "c"], "[", "t", "]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Rho]", "b"], "[", "t", "]"}], "\[NotEqual]", "0"}]}],
       "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"V", ",", "b"}]], "\[Rule]", 
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"V", ",", "\[Gamma]"}]]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Gamma]", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalPi]", 
        RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}], "\[Rule]", "0"}]}], 
    "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQLWJ66e6VFS8dr0/d8AREM1wqkboKpGekx8qA6Fv1
v/VB9J+uEwYgWiBjrQmInrXZwhxEp9bVu4PoaTnnvUD0ojamSBC9ZuL1KBCt
4MGdAKKLli9OBtEbD1wrBtG3N3FUg+gtL843geiCBQpdINrk54cIuVUvHfsq
f4PpHaHN8SB6daxVIoh+9Dyv4TOQFtpXAqYrlq+pXnQSaM53lhoQ3dLl/P71
mZeOUz9u/gCi50lu/QqiD3HZ/ATRG//w/wfR32REwLSFciLXGyC952euAIjW
S/7gfPTsS8ckm0QXEH3IrCIZRKed3QymAXlitAg=
  "]],

Cell[BoxData[
 RowBox[{"vtight", ":=", 
  RowBox[{"{", 
   RowBox[{"vtight1", ",", "vtight2"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4450706749058437`*^9, 3.445070677631084*^9}, {
   3.445070713485457*^9, 3.445070727428604*^9}, {3.4628812337385798`*^9, 
   3.46288123579357*^9}, 3.462881276743926*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Massless Neutrinos", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.445330492421083*^9, 3.445330501651286*^9}, 
   3.445332301189081*^9, {3.4475030817894077`*^9, 3.447503082751878*^9}, {
   3.4634050538706923`*^9, 3.463405054276013*^9}}],

Cell[CellGroupData[{

Cell["Background Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462793511996546*^9, 3.462793515716267*^9}}],

Cell[TextData[{
 "The background equations for Massive Neutrinos. Correct to first order in \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["m", "n"], "2"], TraditionalForm]]],
 "."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462793520124469*^9, 3.462793555046144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["w", "\[Nu]"], "[", "t_", "]"}], ":=", 
  RowBox[{"1", "/", "3"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466369856537*^9, 3.443466370017377*^9}, {
   3.4434664215881023`*^9, 3.443466422366137*^9}, 3.443793115028007*^9, 
   3.44379933197383*^9, 3.443802355630641*^9, {3.443982649825142*^9, 
   3.4439826527496977`*^9}, {3.44533152302045*^9, 3.4453315315988503`*^9}, {
   3.4475082484773703`*^9, 3.4475082802912397`*^9}, {3.447933706242302*^9, 
   3.447933711093287*^9}, {3.448368590383363*^9, 3.448368594839273*^9}, {
   3.45102739432591*^9, 3.451027397091514*^9}, {3.46340506338933*^9, 
   3.463405069836537*^9}, {3.4634061069594793`*^9, 3.4634061105626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "\[Nu]"], "[", "t_", "]"}], ":=", 
  RowBox[{
   SubscriptBox["\[Rho]", "\[Nu]0"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], 
    RowBox[{"-", "4"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466381280816*^9, 3.4434663973353567`*^9}, 
   3.443793115033231*^9, 3.4437993319739637`*^9, 3.4438023556307592`*^9, {
   3.443982660944969*^9, 3.443982677839697*^9}, {3.444049409078491*^9, 
   3.444049414144347*^9}, {3.444049455186343*^9, 3.444049465408045*^9}, {
   3.44404957862646*^9, 3.4440495799967003`*^9}, 3.444660127669376*^9, {
   3.44533153460157*^9, 3.445331544207472*^9}, {3.4475204364041843`*^9, 
   3.447520436726087*^9}, {3.447520897831397*^9, 3.447520946292028*^9}, {
   3.447520985734481*^9, 3.447520987082387*^9}, {3.4475215126165667`*^9, 
   3.447521562450178*^9}, {3.447567325339489*^9, 3.447567328924259*^9}, 
   3.447575798565112*^9, {3.447933714875677*^9, 3.447933725252606*^9}, {
   3.448368533061132*^9, 3.448368558140216*^9}, {3.450692638185663*^9, 
   3.450692649230014*^9}, 3.4506956761532803`*^9, {3.451662228988721*^9, 
   3.451662233370388*^9}, {3.457181566635206*^9, 3.457181572072978*^9}, {
   3.457181951036047*^9, 3.457181952803647*^9}, {3.461058199939378*^9, 
   3.461058202249764*^9}, {3.4634050727997313`*^9, 3.4634050741362743`*^9}, 
   3.463405122189291*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["P", "\[Nu]"], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["w", "\[Nu]"], "[", "t", "]"}], 
   RowBox[{
    SubscriptBox["\[Rho]", "\[Nu]"], "[", "t", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466381280816*^9, 3.4434663973353567`*^9}, 
   3.443793115033231*^9, 3.4437993319739637`*^9, 3.4438023556307592`*^9, {
   3.443982660944969*^9, 3.443982677839697*^9}, {3.444049409078491*^9, 
   3.444049414144347*^9}, {3.444049455186343*^9, 3.444049465408045*^9}, {
   3.44404957862646*^9, 3.4440495799967003`*^9}, 3.444660127669376*^9, {
   3.44533153460157*^9, 3.445331544207472*^9}, {3.4475204364041843`*^9, 
   3.447520436726087*^9}, {3.447520897831397*^9, 3.447520946292028*^9}, {
   3.447520985734481*^9, 3.447521034226722*^9}, {3.447521567921034*^9, 
   3.447521578617491*^9}, {3.447521815079997*^9, 3.447521817462187*^9}, {
   3.447567332402793*^9, 3.44756733305993*^9}, {3.447933728275782*^9, 
   3.447933739476706*^9}, {3.448368564111837*^9, 3.4483685834446173`*^9}, {
   3.4506926540082912`*^9, 3.4506926573354073`*^9}, 3.4506956796476107`*^9, {
   3.451662237619267*^9, 3.4516622413234787`*^9}, {3.452507375961225*^9, 
   3.452507377257015*^9}, {3.457181573706067*^9, 3.457181576536735*^9}, {
   3.457181955716556*^9, 3.4571819583786297`*^9}, {3.461058206603882*^9, 
   3.4610582093705673`*^9}, {3.4634051276629457`*^9, 
   3.4634051320296183`*^9}, {3.463406128780076*^9, 3.463406150859355*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["c", "\[Nu]"], "[", "t_", "]"}], ":=", 
  RowBox[{"1", "/", "3"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4440581270473022`*^9, 3.444058144127358*^9}, {
  3.444650076067616*^9, 3.444650117949974*^9}, {3.4453315586784573`*^9, 
  3.445331568535426*^9}, {3.447520442399963*^9, 3.447520443123681*^9}, {
  3.447521889603238*^9, 3.4475218921386547`*^9}, {3.4475219520152397`*^9, 
  3.44752196882869*^9}, {3.447933742698606*^9, 3.4479337492296133`*^9}, {
  3.463405134078538*^9, 3.463405144010125*^9}, {3.463406153864053*^9, 
  3.4634061558415413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "\[Nu]"], "[", "t_", "]"}], ":=", 
  "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444661239018787*^9, 3.444661268205345*^9}, {
  3.44533157402223*^9, 3.445331575772962*^9}, {3.447567346476789*^9, 
  3.447567347335886*^9}, {3.447933751860895*^9, 3.447933752088317*^9}, {
  3.463405147193263*^9, 3.463405147807825*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462793657850719*^9, 3.462793662889585*^9}}],

Cell[TextData[{
 "Perturbation equations derived from the Boltzmann equation, again accurate \
to order ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["m", "n"], "2"], TraditionalForm]]],
 ", we leave both perturbation functions F and G in for generality, though we \
will usually eliminate G = F/2."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4627936685939703`*^9, 3.462793762890151*^9}}],

Cell[CellGroupData[{

Cell["Scalar Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443861166536331*^9, 3.443861174907585*^9}, 
   3.444634219339793*^9, {3.445332303644537*^9, 3.44533230757201*^9}, {
   3.4475089163513412`*^9, 3.4475089180782757`*^9}, {3.462793742562167*^9, 
   3.462793745976947*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"slnu1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "0"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["k", "3"]}], 
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Nu]", ",", "1"}]], "[", "t", "]"}]}], "+", 
    RowBox[{"4", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.4611586858742933`*^9, 
   3.461158704661861*^9}, {3.462793773576705*^9, 3.4627937738727818`*^9}, {
   3.463405155391615*^9, 3.463405182457708*^9}, 3.463405352999607*^9, {
   3.4634054109713087`*^9, 3.463405418563362*^9}}],

Cell[BoxData[
 RowBox[{"slnu2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     FractionBox["k", "5"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "0"}]], "[", "t", "]"}]}], "-", 
       RowBox[{"2", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"4", "k", " ", 
     RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.447514702537813*^9, 
   3.447514723722933*^9}, {3.447514754641056*^9, 3.447514755096957*^9}, {
   3.4479337740738373`*^9, 3.447933798644342*^9}, {3.4479339692522707`*^9, 
   3.4479339694120626`*^9}, {3.447938732048715*^9, 3.447938743283836*^9}, {
   3.448368615344191*^9, 3.448368664260498*^9}, {3.450695685437595*^9, 
   3.450695694230905*^9}, {3.461158721101822*^9, 3.461158754330236*^9}, {
   3.461165010893955*^9, 3.461165022143609*^9}, {3.462793776631559*^9, 
   3.462793777046589*^9}, {3.463405184571744*^9, 3.4634052045530033`*^9}, 
   3.4634053541684227`*^9, {3.4634054216246367`*^9, 3.4634054333935633`*^9}}],

Cell[BoxData[
 RowBox[{"slnu3", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"k", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["l", 
        RowBox[{
         RowBox[{"2", "l"}], "-", "1"}]], " ", 
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"l", "+", "1"}], 
        RowBox[{
         RowBox[{"2", "l"}], "+", "3"}]], " ", 
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.461158765865684*^9, 
   3.4611587927332363`*^9}, {3.4627937801124153`*^9, 3.462793780591357*^9}, {
   3.463405206851303*^9, 3.463405224730919*^9}, 3.46340535528893*^9, {
   3.463405436454626*^9, 3.4634054434921093`*^9}}]
}, Open  ]],

Cell["\<\
Identify the matter perturbations with the different moments of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}, {3.462793802216755*^9, 
  3.46279382278407*^9}}],

Cell[BoxData[
 RowBox[{"slnupert", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "\[Nu]"], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Nu]", ",", "0"}]], "[", "t", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "\[Nu]"], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Nu]", ",", "1"}]], "[", "t", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["3", "5"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}]}]}], "}"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.447514784047431*^9, 3.447514795073979*^9}, {
   3.4475149577261868`*^9, 3.447514989423431*^9}, {3.447680824141308*^9, 
   3.447680824431699*^9}, {3.447933833358266*^9, 3.447933863984479*^9}, {
   3.447933963481924*^9, 3.447933963697748*^9}, {3.4482863041075363`*^9, 
   3.4482863043715677`*^9}, {3.448368673800198*^9, 3.4483686899910593`*^9}, {
   3.450695712042121*^9, 3.45069572255611*^9}, {3.454252321606291*^9, 
   3.454252326451226*^9}, {3.461158821242527*^9, 3.461158826286461*^9}, {
   3.461159422775271*^9, 3.461159452783585*^9}, {3.462793791790045*^9, 
   3.462793791940754*^9}, 3.462794517321878*^9, {3.4634052328185863`*^9, 
   3.463405253777864*^9}, 3.4634053577758636`*^9, {3.463405447569721*^9, 
   3.463405455702486*^9}, {3.463405522776741*^9, 3.463405526667317*^9}}],

Cell["Generate the a hierarchy in the correct variables", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462793988421529*^9, 3.462794023676408*^9}}],

Cell["Truncate the neutrino hierarchy at a specified level", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438635165731363`*^9, 3.44386352785854*^9}, 
   3.443864094427287*^9, {3.445332291950252*^9, 3.445332293492944*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lnuinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"slnupert", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Nu]", ",", "0"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"slnupert", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Nu]", ",", "1"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"slnupert", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}], "]"}]}], "}"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, {
   3.462794073278899*^9, 3.4627940794862337`*^9}, {3.462794530408825*^9, 
   3.462794535167776*^9}, {3.4634052974209623`*^9, 3.463405311953183*^9}, {
   3.463405381033053*^9, 3.46340538343259*^9}, {3.463405534237773*^9, 
   3.463405556342018*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"slnu", "[", "0", "]"}], ":=", 
   RowBox[{"slnu", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"slnu", "[", "1", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"slnu1", ",", "slnu2"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
       "}"}]}], "//.", "lnuinvert"}], ")"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"slnu", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"slnu1", ",", "slnu2", ",", 
        RowBox[{"slnu3", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "2", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "//.",
       "lnuinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Nu]", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.4627940893694983`*^9, 
   3.462794101410314*^9}, {3.4627944125800734`*^9, 3.462794437779903*^9}, {
   3.4634053870613937`*^9, 3.463405396645473*^9}, {3.463405560888638*^9, 
   3.463405591575358*^9}, {3.463407621527252*^9, 3.46340763145319*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"slnvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "\[Nu]"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["V", "\[Nu]"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "t", "]"}]}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.46115949968496*^9, 3.4611595080110598`*^9}, {3.462794135005073*^9, 
  3.462794135131816*^9}, {3.463405595720352*^9, 3.463405606318487*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"slnuvars", "[", "0", "]"}], ":=", 
   RowBox[{"slnuvars", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"slnuvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"slnvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4453381480565443`*^9, 3.445338209475021*^9}, {
  3.445338239724371*^9, 3.4453382608582573`*^9}, {3.4453382915698557`*^9, 
  3.445338329232456*^9}, {3.44534106693375*^9, 3.44534106959256*^9}, {
  3.4475158139547033`*^9, 3.447515878354999*^9}, {3.447516024548814*^9, 
  3.447516026337784*^9}, {3.447589403251255*^9, 3.447589418755077*^9}, {
  3.447675320242104*^9, 3.447675322935919*^9}, {3.447675766859326*^9, 
  3.447675810053437*^9}, {3.447676158166128*^9, 3.447676160669516*^9}, {
  3.44768115854545*^9, 3.447681160078372*^9}, {3.447933932931679*^9, 
  3.447933937798327*^9}, {3.4481861984777937`*^9, 3.448186262837344*^9}, {
  3.4518080427806187`*^9, 3.451808073353582*^9}, {3.451808117911847*^9, 
  3.451808133150113*^9}, {3.4627941462730837`*^9, 3.462794146360402*^9}, {
  3.462794443901144*^9, 3.4627944837074537`*^9}, {3.463405618723892*^9, 
  3.4634056330796747`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector Perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4543234105947037`*^9, 3.454323427977261*^9}, {
  3.462794777554268*^9, 3.46279478165683*^9}}],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323433153398*^9, 3.454323437584491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vlnu1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"-", "k"}], 
    FractionBox[
     SqrtBox["3"], "5"], " ", 
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795191947571*^9, 
   3.462795272436758*^9}, {3.4628858255656357`*^9, 3.462885841651416*^9}, {
   3.463405647835781*^9, 3.4634056707595367`*^9}}],

Cell[BoxData[
 RowBox[{"vlnu2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "2"}]], "'"}], 
    RowBox[{"[", "t", "]"}]}], "\[Equal]", 
   RowBox[{
    RowBox[{"k", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         SqrtBox["3"], "3"], " ", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "1"}]], "[", "t", "]"}]}], "-", 
       RowBox[{
        FractionBox[
         SqrtBox["8"], "7"], " ", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "3"}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["4", 
      SqrtBox["3"]], "k", " ", 
     RowBox[{
      SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.454252412587578*^9, 
   3.454252412735592*^9}, {3.45425273620201*^9, 3.454252837886224*^9}, {
   3.454257836611588*^9, 3.45425783685773*^9}, 3.454258869256315*^9, 
   3.454258987144186*^9, {3.4543234661077414`*^9, 3.4543234689570723`*^9}, {
   3.454325308567286*^9, 3.4543253192819767`*^9}, {3.462794490809224*^9, 
   3.462794494040781*^9}, {3.462794785740233*^9, 3.4627947938674717`*^9}, {
   3.462795279804367*^9, 3.462795283554476*^9}, {3.462795350326227*^9, 
   3.4627953950944433`*^9}, {3.4627954300611353`*^9, 3.46279545029436*^9}, {
   3.462795558795191*^9, 3.462795609892315*^9}, {3.462795835402629*^9, 
   3.462795843243017*^9}, {3.462885847547092*^9, 3.4628858736156597`*^9}, {
   3.4634042379133883`*^9, 3.46340423818222*^9}, {3.463405672697287*^9, 
   3.463405710012787*^9}}],

Cell[BoxData[
 RowBox[{"vlnu3", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"k", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox["l", "2"], "-", "1"}]], 
        RowBox[{
         RowBox[{"2", "l"}], "-", "1"}]], " ", 
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "1"}]], 
        RowBox[{
         RowBox[{"2", "l"}], "+", "3"}]], " ", 
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795319230138*^9, 
   3.462795337007248*^9}, {3.463405713146306*^9, 3.46340574440077*^9}}]
}, Open  ]],

Cell["\<\
Identify the neutrino shear stress with the quadrupole moment of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}}],

Cell[BoxData[
 RowBox[{"vlnupert", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"V", ",", "\[Nu]"}]], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Nu]", ",", "1"}]], "[", "t", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"V", ",", "\[Nu]"}]], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", 
        SqrtBox["3"]}], "5"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}]}]}], "}"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ3dfCeGXO+peOnHFJV0H0G5vtL0H0/p61b0H0jFaW
52+BdNUFXjD9qky7MHPDS8dbDf9LQPSb7PxGEP0luAxMfyhg7hHd+NLx0WNu
MG052/KILZA+tM3+GIjmi2RkWbf1pePy04GsIHpPmvGSsj0vHYsKzoFp58cy
TOVAOm7tBGYQrSARzA6iHfZ+A9PfHqySAtEFR2LkQHT+2tdJM4G045qPYJrp
i9byg2deOl551AGmQyJ5doHoKWoSYHrD8xcyx4D0zy+vwXTDx9nu54G0Ze3U
ABDN4JwXA6I5XQrB9L97KvbvgPSKUEswXdA1XezN2ZeOy9ackwbRABrXtVY=

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vlnuinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"vlnupert", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Nu]", ",", "1"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"vlnupert", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}], "]"}]}], "}"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, 
   3.454253351103299*^9, {3.454253538359783*^9, 3.454253552017529*^9}, {
   3.454253743707362*^9, 3.4542537657274103`*^9}, {3.4543234938943033`*^9, 
   3.454323517472558*^9}, {3.462794636789838*^9, 3.4627946383038054`*^9}, {
   3.462803734240711*^9, 3.462803741808527*^9}, {3.462803844316331*^9, 
   3.462803867539607*^9}, {3.463405805668799*^9, 3.4634058265794*^9}, {
   3.4634058664093027`*^9, 3.4634058736054583`*^9}, {3.4634076046144648`*^9, 
   3.463407609234023*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vlnu", "[", "2", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vlnu1", ",", "vlnu2"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "3"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
       "}"}]}], "//.", "vlnuinvert"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlnu", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "2"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vlnu1", ",", "vlnu2", ",", 
        RowBox[{"vlnu3", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "//.",
       "vlnuinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Nu]", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.454253366462283*^9, 
   3.454253565416397*^9}, {3.454323498788684*^9, 3.45432354573627*^9}, {
   3.462794569044945*^9, 3.462794574107589*^9}, {3.4627946067246428`*^9, 
   3.462794624347631*^9}, {3.4628036897422028`*^9, 3.462803694749954*^9}, {
   3.462803747308069*^9, 3.462803752643539*^9}, {3.4628039048286877`*^9, 
   3.4628039051486053`*^9}, {3.462804026695615*^9, 3.46280407033372*^9}, {
   3.462868768554793*^9, 3.462868770218408*^9}, {3.463405829893928*^9, 
   3.463405892130293*^9}, {3.463407615302472*^9, 3.4634076403720703`*^9}, {
   3.463731856207151*^9, 3.463731857203134*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"vlnvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalOmega]", 
      RowBox[{"V", ",", "\[Nu]"}]], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalPi]", 
      RowBox[{"V", ",", "\[Nu]"}]], "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.454253519931979*^9, 3.45425352594897*^9}, {3.4543237038008327`*^9, 
  3.4543237039652977`*^9}, {3.462794661522745*^9, 3.462794663296857*^9}, {
  3.462794694664415*^9, 3.4627946959048233`*^9}, {3.462804082208498*^9, 
  3.462804082328738*^9}, {3.4628682207606897`*^9, 3.462868235040338*^9}, {
  3.462868777471631*^9, 3.462868777826232*^9}, {3.463405898633079*^9, 
  3.463405907425294*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vlnuvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"vlnvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQbXa+kaVs9UvHeGN9HhDNo/edH0TfKJstBKKdbIrE
QLRHgbo0mH4YW1gOpB2+bQLT73r2hcxd/9JRPeZ0DIh+1C+YD6IVznuBaQ+u
DOeDQHq6ZoQriA7cz27+GkjzfI4F0zPrb+eB6ENbHUtA9JuAo/NB9Noc0QUg
OqTkosA7IM3WxCQIogMuzK3N3PDS8Wm3ZR2IFvM6v+oJkG47fWsTiL7yK0L1
7PaXjt0B2pog+pbuXj0QvevsEgMQvSG13bF8z0vHrDg9NxC9riS/fiaQNvJx
aQDRbo5NWw+eeen4sfjgdhB9QqvK7xiQFlK6CaaDozs135x96fj4qLo2iAYA
ds+u6Q==
  "]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4543234105947037`*^9, 3.454323427977261*^9}}],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323433153398*^9, 3.454323437584491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tlnu1", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "2"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "k"}], 
     FractionBox[
      SqrtBox["5"], "7"], 
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Nu]", ",", "3"}]], "[", "t", "]"}]}], "-", 
    RowBox[{"4", 
     RowBox[{
      RowBox[{
       SubscriptBox["h", "T"], "'"}], "[", "t", "]"}]}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.454252412587578*^9, 
   3.454252412735592*^9}, {3.45425273620201*^9, 3.454252837886224*^9}, {
   3.454257836611588*^9, 3.45425783685773*^9}, 3.454258869256315*^9, 
   3.454258987144186*^9, {3.4543234661077414`*^9, 3.4543234689570723`*^9}, {
   3.454325308567286*^9, 3.4543253192819767`*^9}, {3.462794490809224*^9, 
   3.462794494040781*^9}, {3.463405920552751*^9, 3.463405936291972*^9}}],

Cell[BoxData[
 RowBox[{"tlnu2", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"k", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox["l", "2"], "-", "4"}]], 
        RowBox[{
         RowBox[{"2", "l"}], "-", "1"}]], " ", 
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "4"}]], 
        RowBox[{
         RowBox[{"2", "l"}], "+", "3"}]], " ", 
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.463405938711039*^9, 
   3.463405967649119*^9}}]
}, Open  ]],

Cell["\<\
Identify the neutrino shear stress with the quadrupole moment of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}}],

Cell[BoxData[
 RowBox[{"tlnupert", ":=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalPi]", 
     RowBox[{"T", ",", "\[Nu]"}]], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    FractionBox["2", "5"], 
    RowBox[{
     SubscriptBox["F", 
      RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.447514784047431*^9, 3.447514795073979*^9}, {
  3.4475149577261868`*^9, 3.447514989423431*^9}, {3.447680824141308*^9, 
  3.447680824431699*^9}, {3.447933833358266*^9, 3.447933863984479*^9}, {
  3.447933963481924*^9, 3.447933963697748*^9}, {3.4482863041075363`*^9, 
  3.4482863043715677`*^9}, {3.448368673800198*^9, 3.4483686899910593`*^9}, {
  3.450695712042121*^9, 3.45069572255611*^9}, {3.454252321606291*^9, 
  3.454252326451226*^9}, {3.454253072902742*^9, 3.454253084521163*^9}, {
  3.454253114596695*^9, 3.454253119710602*^9}, {3.454253269339961*^9, 
  3.454253298898979*^9}, {3.454323479364921*^9, 3.454323479552277*^9}, {
  3.462794553342286*^9, 3.462794556277689*^9}, {3.4627947043859043`*^9, 
  3.4627947047547092`*^9}, {3.463405973481762*^9, 3.463406006127575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tlnuinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Solve", "[", 
       RowBox[{"tlnupert", ",", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "2"}]], "[", "t", "]"}]}], "]"}], "}"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, 
   3.454253351103299*^9, {3.454253538359783*^9, 3.454253552017529*^9}, {
   3.454253743707362*^9, 3.4542537657274103`*^9}, {3.4543234938943033`*^9, 
   3.454323517472558*^9}, {3.462794636789838*^9, 3.4627946383038054`*^9}, {
   3.463406026635253*^9, 3.46340602737613*^9}, {3.4634060741666727`*^9, 
   3.46340608183987*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tlnu", "[", "2", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "tlnu1", "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"\[Nu]", ",", "3"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
       "}"}]}], "//.", "tlnuinvert"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tlnu", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "2"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tlnu1", ",", 
        RowBox[{"tlnu2", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "//.",
       "tlnuinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"\[Nu]", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.454253366462283*^9, 
   3.454253565416397*^9}, {3.454323498788684*^9, 3.45432354573627*^9}, {
   3.462794569044945*^9, 3.462794574107589*^9}, {3.4627946067246428`*^9, 
   3.462794624347631*^9}, {3.463406036176776*^9, 3.463406070884452*^9}, {
   3.463407644915885*^9, 3.4634076539299088`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"tlnvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalPi]", 
     RowBox[{"T", ",", "\[Nu]"}]], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.454253519931979*^9, 3.45425352594897*^9}, {3.4543237038008327`*^9, 
  3.4543237039652977`*^9}, {3.462794661522745*^9, 3.462794663296857*^9}, {
  3.462794694664415*^9, 3.4627946959048233`*^9}, {3.463406085672039*^9, 
  3.463406089884159*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tlnuvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"tlnvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"\[Nu]", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQbXa+kaVs9UvHeGN9HhDNo/edH0TfKJstBKKdbIrE
QLRHgbo0mH4YW1gOpB2+bQLT73r2hcxd/9JRPeZ0DIh+1C+YD6IVznuBaQ+u
DOeDQHq6ZoQriA7cz27+GkjzfI4F0zPrb+eB6ENbHUtA9JuAo/NB9Noc0QUg
OqTkosA7IM3WxCQIogMuzK3N3PDS8Wm3ZR2IFvM6v+oJkG47fWsTiL7yK0L1
7PaXjt0B2pog+pbuXj0QvevsEgMQvSG13bF8z0vHrDg9NxC9riS/fiaQNvJx
aQDRbo5NWw+eeen4sfjgdhAt/r/L8c3Zl449/YFOIBoA1hGmkA==
  "]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Massive Neutrinos", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.445330492421083*^9, 3.445330501651286*^9}, 
   3.445332301189081*^9, {3.4475030817894077`*^9, 3.447503082751878*^9}}],

Cell[CellGroupData[{

Cell["Background Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462793511996546*^9, 3.462793515716267*^9}}],

Cell[TextData[{
 "The background equations for Massive Neutrinos. Correct to first order in \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["m", "n"], "2"], TraditionalForm]]],
 "."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462793520124469*^9, 3.462793555046144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["f", "n0"], "[", "q_", "]"}], ":=", 
  RowBox[{
   FractionBox[
    SubscriptBox["g", "h"], 
    SuperscriptBox["h", "3"]], 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"q", " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"an", " ", 
         SubscriptBox["T", "n"]}], ")"}]}], "]"}], "+", "1"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.447503955805084*^9, 3.447504019107085*^9}, {
  3.447504175876768*^9, 3.4475041762483387`*^9}, {3.447506075638019*^9, 
  3.4475060956417723`*^9}, {3.447506197519456*^9, 3.4475061998073397`*^9}, {
  3.447933645802273*^9, 3.447933651319601*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["w", "n"], "[", "t_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "3"], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["m", "n"], "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466369856537*^9, 3.443466370017377*^9}, {
   3.4434664215881023`*^9, 3.443466422366137*^9}, 3.443793115028007*^9, 
   3.44379933197383*^9, 3.443802355630641*^9, {3.443982649825142*^9, 
   3.4439826527496977`*^9}, {3.44533152302045*^9, 3.4453315315988503`*^9}, {
   3.4475082484773703`*^9, 3.4475082802912397`*^9}, {3.447933706242302*^9, 
   3.447933711093287*^9}, {3.448368590383363*^9, 3.448368594839273*^9}, {
   3.45102739432591*^9, 3.451027397091514*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Rho]", "n"], "[", "t_", "]"}], ":=", 
  RowBox[{
   SubscriptBox["\[Rho]", "n0"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], 
    RowBox[{"-", "4"}]], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox[
       SubscriptBox["m", "n"], "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466381280816*^9, 3.4434663973353567`*^9}, 
   3.443793115033231*^9, 3.4437993319739637`*^9, 3.4438023556307592`*^9, {
   3.443982660944969*^9, 3.443982677839697*^9}, {3.444049409078491*^9, 
   3.444049414144347*^9}, {3.444049455186343*^9, 3.444049465408045*^9}, {
   3.44404957862646*^9, 3.4440495799967003`*^9}, 3.444660127669376*^9, {
   3.44533153460157*^9, 3.445331544207472*^9}, {3.4475204364041843`*^9, 
   3.447520436726087*^9}, {3.447520897831397*^9, 3.447520946292028*^9}, {
   3.447520985734481*^9, 3.447520987082387*^9}, {3.4475215126165667`*^9, 
   3.447521562450178*^9}, {3.447567325339489*^9, 3.447567328924259*^9}, 
   3.447575798565112*^9, {3.447933714875677*^9, 3.447933725252606*^9}, {
   3.448368533061132*^9, 3.448368558140216*^9}, {3.450692638185663*^9, 
   3.450692649230014*^9}, 3.4506956761532803`*^9, {3.451662228988721*^9, 
   3.451662233370388*^9}, {3.457181566635206*^9, 3.457181572072978*^9}, {
   3.457181951036047*^9, 3.457181952803647*^9}, {3.461058199939378*^9, 
   3.461058202249764*^9}, {3.463407169697653*^9, 3.463407170496559*^9}, {
   3.4634072081946774`*^9, 3.463407208600751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["P", "n"], "[", "t_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "3"], 
   SubscriptBox["\[Rho]", "n0"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], 
    RowBox[{"-", "4"}]], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      SuperscriptBox[
       SubscriptBox["m", "n"], "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}]}], 
    ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443466381280816*^9, 3.4434663973353567`*^9}, 
   3.443793115033231*^9, 3.4437993319739637`*^9, 3.4438023556307592`*^9, {
   3.443982660944969*^9, 3.443982677839697*^9}, {3.444049409078491*^9, 
   3.444049414144347*^9}, {3.444049455186343*^9, 3.444049465408045*^9}, {
   3.44404957862646*^9, 3.4440495799967003`*^9}, 3.444660127669376*^9, {
   3.44533153460157*^9, 3.445331544207472*^9}, {3.4475204364041843`*^9, 
   3.447520436726087*^9}, {3.447520897831397*^9, 3.447520946292028*^9}, {
   3.447520985734481*^9, 3.447521034226722*^9}, {3.447521567921034*^9, 
   3.447521578617491*^9}, {3.447521815079997*^9, 3.447521817462187*^9}, {
   3.447567332402793*^9, 3.44756733305993*^9}, {3.447933728275782*^9, 
   3.447933739476706*^9}, {3.448368564111837*^9, 3.4483685834446173`*^9}, {
   3.4506926540082912`*^9, 3.4506926573354073`*^9}, 3.4506956796476107`*^9, {
   3.451662237619267*^9, 3.4516622413234787`*^9}, {3.452507375961225*^9, 
   3.452507377257015*^9}, {3.457181573706067*^9, 3.457181576536735*^9}, {
   3.457181955716556*^9, 3.4571819583786297`*^9}, {3.461058206603882*^9, 
   3.4610582093705673`*^9}, {3.463407174465361*^9, 3.463407175577276*^9}, {
   3.463407211889759*^9, 3.463407212840445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["c", "n"], "[", "t_", "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["P", "n"], "'"}], "[", "t", "]"}], "/", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Rho]", "n"], "'"}], "[", "t", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4440581270473022`*^9, 3.444058144127358*^9}, {
  3.444650076067616*^9, 3.444650117949974*^9}, {3.4453315586784573`*^9, 
  3.445331568535426*^9}, {3.447520442399963*^9, 3.447520443123681*^9}, {
  3.447521889603238*^9, 3.4475218921386547`*^9}, {3.4475219520152397`*^9, 
  3.44752196882869*^9}, {3.447933742698606*^9, 3.4479337492296133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "n"], "[", "t_", "]"}], ":=", 
  "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444661239018787*^9, 3.444661268205345*^9}, {
  3.44533157402223*^9, 3.445331575772962*^9}, {3.447567346476789*^9, 
  3.447567347335886*^9}, {3.447933751860895*^9, 3.447933752088317*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.462793657850719*^9, 3.462793662889585*^9}}],

Cell[TextData[{
 "Perturbation equations derived from the Boltzmann equation, again accurate \
to order ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["m", "n"], "2"], TraditionalForm]]],
 ", we leave both perturbation functions F and G in for generality, though we \
will usually eliminate G = F/2."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4627936685939703`*^9, 3.462793762890151*^9}}],

Cell[CellGroupData[{

Cell["Scalar Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.443861166536331*^9, 3.443861174907585*^9}, 
   3.444634219339793*^9, {3.445332303644537*^9, 3.44533230757201*^9}, {
   3.4475089163513412`*^9, 3.4475089180782757`*^9}, {3.462793742562167*^9, 
   3.462793745976947*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"snu1", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "0"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["k", "3"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "1"}]], "[", "t", "]"}], "-", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox[
           SubscriptBox["m", "n"], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"4", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "0"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["k", "3"]}], " ", 
       RowBox[{
        SubscriptBox["G", 
         RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"2", 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}]}]}], 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.4611586858742933`*^9, 
   3.461158704661861*^9}, {3.462793773576705*^9, 3.4627937738727818`*^9}}],

Cell[BoxData[
 RowBox[{"snu2", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       FractionBox["k", "5"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["F", 
              RowBox[{"n", ",", "0"}]], "[", "t", "]"}], "-", 
            RowBox[{
             FractionBox["1", "2"], 
             SuperscriptBox[
              SubscriptBox["m", "n"], "2"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
             RowBox[{
              SubscriptBox["G", 
               RowBox[{"n", ",", "0"}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["F", 
              RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "-", 
            RowBox[{
             FractionBox["1", "2"], 
             SuperscriptBox[
              SubscriptBox["m", "n"], "2"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
             RowBox[{
              SubscriptBox["G", 
               RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["m", "n"], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}]}], 
        ")"}], "k", " ", 
       RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       FractionBox["k", "5"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", 
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "0"}]], "[", "t", "]"}]}], "-", 
         RowBox[{"2", 
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", "k", " ", 
       RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}]}]}]}], "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.447514702537813*^9, 
   3.447514723722933*^9}, {3.447514754641056*^9, 3.447514755096957*^9}, {
   3.4479337740738373`*^9, 3.447933798644342*^9}, {3.4479339692522707`*^9, 
   3.4479339694120626`*^9}, {3.447938732048715*^9, 3.447938743283836*^9}, {
   3.448368615344191*^9, 3.448368664260498*^9}, {3.450695685437595*^9, 
   3.450695694230905*^9}, {3.461158721101822*^9, 3.461158754330236*^9}, {
   3.461165010893955*^9, 3.461165022143609*^9}, {3.462793776631559*^9, 
   3.462793777046589*^9}}],

Cell[BoxData[
 RowBox[{"snu3", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"k", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["l", 
          RowBox[{
           RowBox[{"2", "l"}], "-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", 
              RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             SubscriptBox["m", "n"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
            RowBox[{
             SubscriptBox["G", 
              RowBox[{"n", ",", 
               RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
        
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"l", "+", "1"}], ")"}], 
          RowBox[{
           RowBox[{"2", "l"}], "+", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", 
              RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             SubscriptBox["m", "n"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
            RowBox[{
             SubscriptBox["G", 
              RowBox[{"n", ",", 
               RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["k", 
       RowBox[{
        RowBox[{"2", "l"}], "+", "1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l", " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", 
            RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}], " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", 
            RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}]}]}], 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.461158765865684*^9, 
   3.4611587927332363`*^9}, {3.4627937801124153`*^9, 3.462793780591357*^9}}]
}, Open  ]],

Cell["\<\
Identify the matter perturbations with the different moments of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}, {3.462793802216755*^9, 
  3.46279382278407*^9}}],

Cell[BoxData[
 RowBox[{"snupert", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "n"], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "0"}]], "[", "t", "]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox[
        SubscriptBox["m", "n"], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", "0"}]], "[", "t", "]"}], "-", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "0"}]], "[", "t", "]"}]}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "n"], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "1"}]], "[", "t", "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox["1", "4"], 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}]}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", "n"], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["3", "5"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "-", " ", 
           RowBox[{
            SubscriptBox["G", 
             RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.447514784047431*^9, 3.447514795073979*^9}, {
   3.4475149577261868`*^9, 3.447514989423431*^9}, {3.447680824141308*^9, 
   3.447680824431699*^9}, {3.447933833358266*^9, 3.447933863984479*^9}, {
   3.447933963481924*^9, 3.447933963697748*^9}, {3.4482863041075363`*^9, 
   3.4482863043715677`*^9}, {3.448368673800198*^9, 3.4483686899910593`*^9}, {
   3.450695712042121*^9, 3.45069572255611*^9}, {3.454252321606291*^9, 
   3.454252326451226*^9}, {3.461158821242527*^9, 3.461158826286461*^9}, {
   3.461159422775271*^9, 3.461159452783585*^9}, {3.462793791790045*^9, 
   3.462793791940754*^9}, 3.462794517321878*^9}],

Cell["Generate the a hierarchy in the correct variables", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.462793988421529*^9, 3.462794023676408*^9}}],

Cell["Truncate the neutrino hierarchy at a specified level", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438635165731363`*^9, 3.44386352785854*^9}, 
   3.443864094427287*^9, {3.445332291950252*^9, 3.445332293492944*^9}}],

Cell[BoxData[
 RowBox[{"sninvert", ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mkpure", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"snupert", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "0"}]], "[", "t", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"mkpure", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"snupert", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"mkpure", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"snupert", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], "]"}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448185985934389*^9, 3.448186073607868*^9}, {
  3.448186741663887*^9, 3.448186745878202*^9}, {3.4483693291313677`*^9, 
  3.448369330338736*^9}, {3.462793933673003*^9, 3.462793945159882*^9}, {
  3.462794518239333*^9, 3.462794523303947*^9}}],

Cell[TextData[{
 "Substitute such that we solve fro ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["a", "2"], "G"}], TraditionalForm]]],
 " in order to avoid the divergence problems."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.44836887152125*^9, 3.448368913511579*^9}}],

Cell[BoxData[
 RowBox[{"divsub", ":=", 
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"n", ",", "l_"}]], ":>", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["G", 
          RowBox[{"n", ",", "l"}]], "[", "t", "]"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}], ")"}], 
      "]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448368861789406*^9, 3.448368864620549*^9}, {
  3.450695764226343*^9, 3.450695767496092*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tmassive", "[", "0", "]"}], ":=", 
   RowBox[{"tmassive", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmassive", "[", "1", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mnnu1", ",", "mnnu2", ",", "mnpert"}], "}"}], "/.", "divsub"}],
     "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmassive", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mnnu1", ",", "mnnu2", ",", 
       RowBox[{"mnnu3", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2", ",", "ll"}], "}"}]}], "]"}]}], ",", 
       "mnpert"}], "}"}], "/.", "divsub"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", 
         RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], ",", 
     
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", 
         RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}]}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448368972929512*^9, 
   3.44836898308295*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tmassivealt", "[", "0", "]"}], ":=", 
   RowBox[{"tmassivealt", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmassivealt", "[", "1", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mnnu1", ",", "mnnu2"}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["F", 
            RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}], ",", 
         
         RowBox[{
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}]}], 
        "}"}]}], "//.", "mninvert"}], ")"}], "/.", "divsub"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmassivealt", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mnnu1", ",", "mnnu2", ",", 
         RowBox[{"mnnu3", "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "//.",
        "mninvert"}], ")"}], "/.", "divsub"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", 
         RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], ",", 
     
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", 
         RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}]}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}}]
}, Open  ]],

Cell["\<\
A new system for producing initially Fermi-Dirac solutions (eliminates G \
using the fact that F = 2 G for Fermi-Dirac).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.451807463483613*^9, 3.451807504633762*^9}, {
  3.4627940531828938`*^9, 3.462794054357236*^9}}],

Cell[BoxData[
 RowBox[{"fdsub", ":=", 
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"n", ",", "l_"}]], "\[Rule]", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "l"}]], "[", "t", "]"}], "/", "2"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45180611445358*^9, 3.451806168838479*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fdinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"snupert", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "fdsub"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "0"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"snupert", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", "fdsub"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"snupert", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "/.", "fdsub"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], "]"}]}], "}"}], "]"}],
     "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, {
   3.462794073278899*^9, 3.4627940794862337`*^9}, {3.462794530408825*^9, 
   3.462794535167776*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sfnu", "[", "0", "]"}], ":=", 
   RowBox[{"sfnu", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sfnu", "[", "1", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"snu1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"snu2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
        "}"}]}], "/.", "fdsub"}], "//.", "fdinvert"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sfnu", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"snu1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"snu2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"snu3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "/.",
        "fdsub"}], "//.", "fdinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"n", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.4627940893694983`*^9, 
   3.462794101410314*^9}, {3.4627944125800734`*^9, 3.462794437779903*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"snvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "n"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["V", "n"], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "n"], "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.46115949968496*^9, 3.4611595080110598`*^9}, {3.462794135005073*^9, 
  3.462794135131816*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tmassivevars", "[", "0", "]"}], ":=", 
   RowBox[{"tmassivevars", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmassivevars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"snvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "x"}]], "[", "t", "]"}], ",", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", "x"}]], "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4453381480565443`*^9, 3.445338209475021*^9}, {
  3.445338239724371*^9, 3.4453382608582573`*^9}, {3.4453382915698557`*^9, 
  3.445338329232456*^9}, {3.44534106693375*^9, 3.44534106959256*^9}, {
  3.4475158139547033`*^9, 3.447515878354999*^9}, {3.447516024548814*^9, 
  3.447516026337784*^9}, {3.447589403251255*^9, 3.447589418755077*^9}, {
  3.447675320242104*^9, 3.447675322935919*^9}, {3.447675766859326*^9, 
  3.447675810053437*^9}, {3.447676158166128*^9, 3.447676160669516*^9}, {
  3.44768115854545*^9, 3.447681160078372*^9}, {3.447933932931679*^9, 
  3.447933937798327*^9}, {3.4627941393704987`*^9, 3.462794139505862*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tmassivealtvars", "[", "0", "]"}], ":=", 
   RowBox[{"tmassivevars", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmassivealtvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"snvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"n", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["G", 
         RowBox[{"n", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4453381480565443`*^9, 3.445338209475021*^9}, {
  3.445338239724371*^9, 3.4453382608582573`*^9}, {3.4453382915698557`*^9, 
  3.445338329232456*^9}, {3.44534106693375*^9, 3.44534106959256*^9}, {
  3.4475158139547033`*^9, 3.447515878354999*^9}, {3.447516024548814*^9, 
  3.447516026337784*^9}, {3.447589403251255*^9, 3.447589418755077*^9}, {
  3.447675320242104*^9, 3.447675322935919*^9}, {3.447675766859326*^9, 
  3.447675810053437*^9}, {3.447676158166128*^9, 3.447676160669516*^9}, {
  3.44768115854545*^9, 3.447681160078372*^9}, {3.447933932931679*^9, 
  3.447933937798327*^9}, {3.4481861984777937`*^9, 3.448186262837344*^9}, {
  3.462794143174852*^9, 3.462794143292153*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sfnuvars", "[", "0", "]"}], ":=", 
   RowBox[{"sfnuvars", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sfnuvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"snvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"n", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4453381480565443`*^9, 3.445338209475021*^9}, {
  3.445338239724371*^9, 3.4453382608582573`*^9}, {3.4453382915698557`*^9, 
  3.445338329232456*^9}, {3.44534106693375*^9, 3.44534106959256*^9}, {
  3.4475158139547033`*^9, 3.447515878354999*^9}, {3.447516024548814*^9, 
  3.447516026337784*^9}, {3.447589403251255*^9, 3.447589418755077*^9}, {
  3.447675320242104*^9, 3.447675322935919*^9}, {3.447675766859326*^9, 
  3.447675810053437*^9}, {3.447676158166128*^9, 3.447676160669516*^9}, {
  3.44768115854545*^9, 3.447681160078372*^9}, {3.447933932931679*^9, 
  3.447933937798327*^9}, {3.4481861984777937`*^9, 3.448186262837344*^9}, {
  3.4518080427806187`*^9, 3.451808073353582*^9}, {3.451808117911847*^9, 
  3.451808133150113*^9}, {3.4627941462730837`*^9, 3.462794146360402*^9}, {
  3.462794443901144*^9, 3.4627944837074537`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector Perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4543234105947037`*^9, 3.454323427977261*^9}, {
  3.462794777554268*^9, 3.46279478165683*^9}}],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323433153398*^9, 3.454323437584491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vnu1", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"-", "k"}], 
      FractionBox[
       SqrtBox["3"], "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "-", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "1"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"-", "k"}], 
      FractionBox[
       SqrtBox["3"], "5"], " ", 
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}]}]}], "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795191947571*^9, 
   3.462795272436758*^9}, {3.4628858255656357`*^9, 3.462885841651416*^9}}],

Cell[BoxData[
 RowBox[{"vnu2", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "2"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"k", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           SqrtBox["3"], "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["F", 
              RowBox[{"n", ",", "1"}]], "[", "t", "]"}], "-", 
            RowBox[{
             FractionBox["1", "2"], 
             SuperscriptBox[
              SubscriptBox["m", "n"], "2"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
             RowBox[{
              SubscriptBox["G", 
               RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          FractionBox[
           SqrtBox["8"], "7"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["F", 
              RowBox[{"n", ",", "3"}]], "[", "t", "]"}], "-", 
            RowBox[{
             FractionBox["1", "2"], 
             SuperscriptBox[
              SubscriptBox["m", "n"], "2"], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
             RowBox[{
              SubscriptBox["G", 
               RowBox[{"n", ",", "3"}]], "[", "t", "]"}]}]}], ")"}]}]}], 
        ")"}]}], "-", 
      RowBox[{
       FractionBox["4", 
        SqrtBox["3"]], "k", " ", 
       RowBox[{
        SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "2"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"k", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           SqrtBox["3"], "3"], " ", 
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{
          FractionBox[
           SqrtBox["8"], "7"], " ", 
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "3"}]], "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["2", 
        SqrtBox["3"]], "k", " ", 
       RowBox[{
        SubscriptBox["\[Sigma]", "V"], "[", "t", "]"}]}]}]}]}], 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.454252412587578*^9, 
   3.454252412735592*^9}, {3.45425273620201*^9, 3.454252837886224*^9}, {
   3.454257836611588*^9, 3.45425783685773*^9}, 3.454258869256315*^9, 
   3.454258987144186*^9, {3.4543234661077414`*^9, 3.4543234689570723`*^9}, {
   3.454325308567286*^9, 3.4543253192819767`*^9}, {3.462794490809224*^9, 
   3.462794494040781*^9}, {3.462794785740233*^9, 3.4627947938674717`*^9}, {
   3.462795279804367*^9, 3.462795283554476*^9}, {3.462795350326227*^9, 
   3.4627953950944433`*^9}, {3.4627954300611353`*^9, 3.46279545029436*^9}, {
   3.462795558795191*^9, 3.462795609892315*^9}, {3.462795835402629*^9, 
   3.462795843243017*^9}, {3.462885847547092*^9, 3.4628858736156597`*^9}, {
   3.4634042379133883`*^9, 3.46340423818222*^9}}],

Cell[BoxData[
 RowBox[{"vnu3", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"k", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox["l", "2"], "-", "1"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", 
              RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             SubscriptBox["m", "n"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
            RowBox[{
             SubscriptBox["G", 
              RowBox[{"n", ",", 
               RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
        
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "1"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "+", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", 
              RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             SubscriptBox["m", "n"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
            RowBox[{
             SubscriptBox["G", 
              RowBox[{"n", ",", 
               RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"k", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox["l", "2"], "-", "1"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "-", "1"}]], " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", 
            RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "1"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "+", "3"}]], " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", 
            RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}]}]}], 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}, {3.462795319230138*^9, 
   3.462795337007248*^9}}]
}, Open  ]],

Cell["\<\
Identify the neutrino shear stress with the quadrupole moment of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}}],

Cell[BoxData[
 RowBox[{"vnupert", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"V", ",", "n"}]], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "1"}]], "[", "t", "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox["1", "4"], 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"]}]}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"V", ",", "n"}]], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", 
        SqrtBox["3"]}], "5"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "-", " ", 
           RowBox[{
            SubscriptBox["G", 
             RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ3dfCeGXO+peOnHFJV0H0G5vtL0H0/p61b0H0jFaW
52+BdNUFXjD9qky7MHPDS8dbDf9LQPSb7PxGEP0luAxMfyhg7hHd+NLx0WNu
MG052/KILZA+tM3+GIjmi2RkWbf1pePy04GsIHpPmvGSsj0vHYsKzoFp58cy
TOVAOm7tBGYQrSARzA6iHfZ+A9PfHqySAtEFR2LkQHT+2tdJM4G045qPYJrp
i9byg2deOl551AGmQyJ5doHoKWoSYHrD8xcyx4D0zy+vwXTDx9nu54G0Ze3U
ABDN4JwXA6I5XQrB9L97KvbvgPSKUEswDQAO+aut
  "]],

Cell["\<\
A new system for producing exactly Fermi-Dirac solutions (eliminates G using \
the fact that F = 2 G for Fermi-Dirac).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.451807463483613*^9, 3.451807504633762*^9}}],

Cell[BoxData[
 RowBox[{"fdvecsub", ":=", 
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"n", ",", "l_"}]], "\[Rule]", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "l"}]], "[", "t", "]"}], "/", "2"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45180611445358*^9, 3.451806168838479*^9}, 
   3.454253347140072*^9, {3.4543234837729673`*^9, 3.454323489216422*^9}, {
   3.4628037308729687`*^9, 3.462803731152494*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fdvecinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vnupert", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "fdvecsub"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "1"}]], "[", "t", "]"}]}], "]"}], ",", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vnupert", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", "fdvecsub"}], ",", 
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], "]"}]}], "}"}], "]"}],
     "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, 
   3.454253351103299*^9, {3.454253538359783*^9, 3.454253552017529*^9}, {
   3.454253743707362*^9, 3.4542537657274103`*^9}, {3.4543234938943033`*^9, 
   3.454323517472558*^9}, {3.462794636789838*^9, 3.4627946383038054`*^9}, {
   3.462803734240711*^9, 3.462803741808527*^9}, {3.462803844316331*^9, 
   3.462803867539607*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vfnu", "[", "2", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vnu1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"vnu2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "3"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
        "}"}]}], "/.", "fdvecsub"}], "//.", "fdvecinvert"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vfnu", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "2"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vnu1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"vnu2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"vnu3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "/.",
        "fdvecsub"}], "//.", "fdvecinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"n", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.454253366462283*^9, 
   3.454253565416397*^9}, {3.454323498788684*^9, 3.45432354573627*^9}, {
   3.462794569044945*^9, 3.462794574107589*^9}, {3.4627946067246428`*^9, 
   3.462794624347631*^9}, {3.4628036897422028`*^9, 3.462803694749954*^9}, {
   3.462803747308069*^9, 3.462803752643539*^9}, {3.4628039048286877`*^9, 
   3.4628039051486053`*^9}, {3.462804026695615*^9, 3.46280407033372*^9}, {
   3.462868768554793*^9, 3.462868770218408*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"vnvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalOmega]", 
      RowBox[{"V", ",", "n"}]], "[", "t", "]"}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalPi]", 
      RowBox[{"V", ",", "n"}]], "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.454253519931979*^9, 3.45425352594897*^9}, {3.4543237038008327`*^9, 
  3.4543237039652977`*^9}, {3.462794661522745*^9, 3.462794663296857*^9}, {
  3.462794694664415*^9, 3.4627946959048233`*^9}, {3.462804082208498*^9, 
  3.462804082328738*^9}, {3.4628682207606897`*^9, 3.462868235040338*^9}, {
  3.462868777471631*^9, 3.462868777826232*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vfnuvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"vnvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"n", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQbXa+kaVs9UvHeGN9HhDNo/edH0TfKJstBKKdbIrE
QLRHgbo0mH4YW1gOpB2+bQLT73r2hcxd/9JRPeZ0DIh+1C+YD6IVznuBaQ+u
DOeDQHq6ZoQriA7cz27+GkjzfI4F0zPrb+eB6ENbHUtA9JuAo/NB9Noc0QUg
OqTkosA7IM3WxCQIogMuzK3N3PDS8Wm3ZR2IFvM6v+oJkG47fWsTiL7yK0L1
7PaXjt0B2pog+pbuXj0QvevsEgMQvSG13bF8z0vHrDg9NxC9riS/fiaQNvJx
aQDRbo5NWw+eeen4sfjgdhB9QqvK7xiQFlK6CaYBzqKlyA==
  "]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Perturbations", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4543234105947037`*^9, 3.454323427977261*^9}}],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.454323433153398*^9, 3.454323437584491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tnu1", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "2"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "k"}], 
       FractionBox[
        SqrtBox["5"], "7"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "3"}]], "[", "t", "]"}], "-", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox[
           SubscriptBox["m", "n"], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
          RowBox[{
           SubscriptBox["G", 
            RowBox[{"n", ",", "3"}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"4", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "T"], "'"}], "[", "t", "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "2"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "k"}], 
       FractionBox[
        SqrtBox["5"], "7"], " ", 
       RowBox[{
        SubscriptBox["G", 
         RowBox[{"n", ",", "3"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"2", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "T"], "'"}], "[", "t", "]"}]}]}]}]}], 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447508550694851*^9, 3.447508645002645*^9}, {
   3.447508705355611*^9, 3.447508734869711*^9}, {3.4475087695255327`*^9, 
   3.447508823280249*^9}, {3.4475088798556757`*^9, 3.447508882624215*^9}, {
   3.447514573728552*^9, 3.447514608085339*^9}, {3.447514673947998*^9, 
   3.447514693850944*^9}, {3.447514749068499*^9, 3.447514749282153*^9}, {
   3.447933756908465*^9, 3.447933770375106*^9}, {3.447933972077326*^9, 
   3.447933972287314*^9}, {3.448368610858192*^9, 3.448368611442319*^9}, 
   3.448368647148193*^9, 3.450695682431108*^9, {3.454252412587578*^9, 
   3.454252412735592*^9}, {3.45425273620201*^9, 3.454252837886224*^9}, {
   3.454257836611588*^9, 3.45425783685773*^9}, 3.454258869256315*^9, 
   3.454258987144186*^9, {3.4543234661077414`*^9, 3.4543234689570723`*^9}, {
   3.454325308567286*^9, 3.4543253192819767`*^9}, {3.462794490809224*^9, 
   3.462794494040781*^9}}],

Cell[BoxData[
 RowBox[{"tnu2", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"k", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox["l", "2"], "-", "4"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "-", "1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", 
              RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             SubscriptBox["m", "n"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
            RowBox[{
             SubscriptBox["G", 
              RowBox[{"n", ",", 
               RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}], "-", 
        
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "4"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "+", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["F", 
             RowBox[{"n", ",", 
              RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}], "-", 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox[
             SubscriptBox["m", "n"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
            RowBox[{
             SubscriptBox["G", 
              RowBox[{"n", ",", 
               RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["G", 
        RowBox[{"n", ",", "l"}]], "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"k", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox["l", "2"], "-", "4"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "-", "1"}]], " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", 
            RowBox[{"l", "-", "1"}]}]], "[", "t", "]"}]}], "-", 
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"l", "+", "1"}], ")"}], "2"], "-", "4"}]], 
          RowBox[{
           RowBox[{"2", "l"}], "+", "3"}]], " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", 
            RowBox[{"l", "+", "1"}]}]], "[", "t", "]"}]}]}], ")"}]}]}]}], 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.443861996557891*^9, 3.4438620512014933`*^9}, {
   3.443862089707014*^9, 3.443862162429758*^9}, 3.4438640806049433`*^9, {
   3.44463398946272*^9, 3.444633989878587*^9}, {3.445070752316381*^9, 
   3.445070752668458*^9}, {3.4453317807118387`*^9, 3.445331823902717*^9}, {
   3.445332226566142*^9, 3.445332226600193*^9}, {3.445339481153764*^9, 
   3.445339483314044*^9}, {3.44533961844134*^9, 3.445339621157633*^9}, {
   3.445340947809744*^9, 3.445340975213894*^9}, {3.4475083807089376`*^9, 
   3.447508462414606*^9}, {3.447514730713665*^9, 3.447514758640812*^9}, {
   3.447933802283287*^9, 3.447933826707859*^9}, {3.44793396641222*^9, 
   3.447933966755527*^9}, {3.448368628488502*^9, 3.448368632743663*^9}, 
   3.448368667185032*^9, {3.44836883645684*^9, 3.448368839008931*^9}, {
   3.4506957061169786`*^9, 3.450695708703473*^9}, {3.454252856168777*^9, 
   3.454252930999053*^9}, {3.4542529625006943`*^9, 3.454253022472637*^9}, 
   3.4542533602800417`*^9, {3.454323473445345*^9, 3.454323475806469*^9}, {
   3.462794497373465*^9, 3.4627944991711597`*^9}}]
}, Open  ]],

Cell["\<\
Identify the neutrino shear stress with the quadrupole moment of the \
distribution function.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4438636128953533`*^9, 3.443863653688408*^9}, {
  3.445332263349429*^9, 3.445332287404632*^9}}],

Cell[BoxData[
 RowBox[{"tnupert", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalPi]", 
     RowBox[{"T", ",", "n"}]], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    FractionBox["2", "5"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox[
        SubscriptBox["m", "n"], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], "/", "a0"}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "2"}]], "[", "t", "]"}], "-", " ", 
         RowBox[{
          SubscriptBox["G", 
           RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.447514784047431*^9, 3.447514795073979*^9}, {
  3.4475149577261868`*^9, 3.447514989423431*^9}, {3.447680824141308*^9, 
  3.447680824431699*^9}, {3.447933833358266*^9, 3.447933863984479*^9}, {
  3.447933963481924*^9, 3.447933963697748*^9}, {3.4482863041075363`*^9, 
  3.4482863043715677`*^9}, {3.448368673800198*^9, 3.4483686899910593`*^9}, {
  3.450695712042121*^9, 3.45069572255611*^9}, {3.454252321606291*^9, 
  3.454252326451226*^9}, {3.454253072902742*^9, 3.454253084521163*^9}, {
  3.454253114596695*^9, 3.454253119710602*^9}, {3.454253269339961*^9, 
  3.454253298898979*^9}, {3.454323479364921*^9, 3.454323479552277*^9}, {
  3.462794553342286*^9, 3.462794556277689*^9}, {3.4627947043859043`*^9, 
  3.4627947047547092`*^9}}],

Cell["\<\
A new system for producing exactly Fermi-Dirac solutions (eliminates G using \
the fact that F = 2 G for Fermi-Dirac).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.451807463483613*^9, 3.451807504633762*^9}}],

Cell[BoxData[
 RowBox[{"fdtenssub", ":=", 
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"n", ",", "l_"}]], "\[Rule]", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["F", 
        RowBox[{"n", ",", "l"}]], "[", "t", "]"}], "/", "2"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45180611445358*^9, 3.451806168838479*^9}, 
   3.454253347140072*^9, {3.4543234837729673`*^9, 3.454323489216422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fdtensinvert", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"tnupert", "/.", "fdtenssub"}], ",", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"n", ",", "2"}]], "[", "t", "]"}]}], "]"}], "}"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451806646724556*^9, 3.451806679970942*^9}, {
   3.451806731018516*^9, 3.4518067987069397`*^9}, 3.451807405730074*^9, 
   3.454253351103299*^9, {3.454253538359783*^9, 3.454253552017529*^9}, {
   3.454253743707362*^9, 3.4542537657274103`*^9}, {3.4543234938943033`*^9, 
   3.454323517472558*^9}, {3.462794636789838*^9, 3.4627946383038054`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tfnu", "[", "2", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tnu1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["F", 
           RowBox[{"n", ",", "3"}]], "[", "t", "]"}], "\[Rule]", "0"}], 
        "}"}]}], "/.", "fdtenssub"}], "//.", "fdtensinvert"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tfnu", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "2"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tnu1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"tnu2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"l", "\[Rule]", "x"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}]}], "}"}], "/.",
        "fdtenssub"}], "//.", "fdtensinvert"}], ")"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["F", 
       RowBox[{"n", ",", 
        RowBox[{"ll", "+", "1"}]}]], "[", "t", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438628779261827`*^9, 3.443862899626062*^9}, {
   3.443862934385723*^9, 3.443863041742832*^9}, {3.443863203724868*^9, 
   3.443863370342099*^9}, {3.443863701515868*^9, 3.443863736910181*^9}, 
   3.4438640944274817`*^9, {3.444634148234127*^9, 3.4446342080234222`*^9}, {
   3.445070757752966*^9, 3.445070786487546*^9}, {3.4453318434624157`*^9, 
   3.445331855475533*^9}, {3.445331897067614*^9, 3.4453319794377413`*^9}, {
   3.445332232265697*^9, 3.4453322468908863`*^9}, {3.445339471431443*^9, 
   3.445339512565936*^9}, {3.4453395499912853`*^9, 3.4453395692081833`*^9}, {
   3.4453410375379066`*^9, 3.44534105875319*^9}, {3.447515072961982*^9, 
   3.4475150779813747`*^9}, {3.447515147612261*^9, 3.447515174549096*^9}, {
   3.4475153527338533`*^9, 3.447515426597033*^9}, {3.4475154911645107`*^9, 
   3.447515496988521*^9}, {3.447515534285224*^9, 3.447515536818514*^9}, 
   3.447515604161631*^9, {3.4476709887300673`*^9, 3.447671016322348*^9}, {
   3.447671081694624*^9, 3.4476710846591663`*^9}, {3.4476711159217997`*^9, 
   3.447671118785585*^9}, {3.447933873370017*^9, 3.447933875717002*^9}, {
   3.447933914298025*^9, 3.447933957313518*^9}, {3.448186125876781*^9, 
   3.4481861772959414`*^9}, {3.4481865410551443`*^9, 3.448186544048637*^9}, {
   3.448369003843886*^9, 3.448369048467098*^9}, {3.451806448777446*^9, 
   3.451806483160367*^9}, {3.4518072693730173`*^9, 3.451807307839787*^9}, {
   3.45180734888236*^9, 3.451807356519682*^9}, {3.454253366462283*^9, 
   3.454253565416397*^9}, {3.454323498788684*^9, 3.45432354573627*^9}, {
   3.462794569044945*^9, 3.462794574107589*^9}, {3.4627946067246428`*^9, 
   3.462794624347631*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4450013905405703`*^9, 3.445001393002399*^9}}],

Cell[BoxData[
 RowBox[{"tnvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalPi]", 
     RowBox[{"T", ",", "n"}]], "[", "t", "]"}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443981873680416*^9, 3.4439819518477573`*^9}, {
  3.444649865216064*^9, 3.444649871542547*^9}, {3.445070791921562*^9, 
  3.4450707920016327`*^9}, {3.4453319884972153`*^9, 3.445331998791936*^9}, {
  3.445332208971922*^9, 3.445332216555358*^9}, {3.4475157634880037`*^9, 
  3.4475157933390636`*^9}, {3.4479339226935463`*^9, 3.447933928672196*^9}, {
  3.454253519931979*^9, 3.45425352594897*^9}, {3.4543237038008327`*^9, 
  3.4543237039652977`*^9}, {3.462794661522745*^9, 3.462794663296857*^9}, {
  3.462794694664415*^9, 3.4627946959048233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tfnuvars", "[", 
   RowBox[{"ll_", "/;", 
    RowBox[{"ll", ">", "0"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"tnvars", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["F", 
         RowBox[{"n", ",", "x"}]], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "3", ",", "ll"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4453381480565443`*^9, 3.445338209475021*^9}, {
  3.445338239724371*^9, 3.4453382608582573`*^9}, {3.4453382915698557`*^9, 
  3.445338329232456*^9}, {3.44534106693375*^9, 3.44534106959256*^9}, {
  3.4475158139547033`*^9, 3.447515878354999*^9}, {3.447516024548814*^9, 
  3.447516026337784*^9}, {3.447589403251255*^9, 3.447589418755077*^9}, {
  3.447675320242104*^9, 3.447675322935919*^9}, {3.447675766859326*^9, 
  3.447675810053437*^9}, {3.447676158166128*^9, 3.447676160669516*^9}, {
  3.44768115854545*^9, 3.447681160078372*^9}, {3.447933932931679*^9, 
  3.447933937798327*^9}, {3.4481861984777937`*^9, 3.448186262837344*^9}, {
  3.4518080427806187`*^9, 3.451808073353582*^9}, {3.451808117911847*^9, 
  3.451808133150113*^9}, {3.454253580231163*^9, 3.454253617449025*^9}, {
  3.454323707482993*^9, 3.454323714134301*^9}, {3.462794668070468*^9, 
  3.462794686045403*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other Variables", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.4452534783399553`*^9, 3.4452534943438272`*^9}}],

Cell[TextData[{
 "Define the curvature perturbation (and ensure t->0 limit is set on ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", "s"], TraditionalForm]]],
 ")."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4452535989102488`*^9, 3.445253608679147*^9}, {
  3.445258860882781*^9, 3.445258879594885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["w", "s"], "[", "0", "]"}], "=", 
   RowBox[{"1", "/", "3"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44525877130624*^9, 3.445258786943725*^9}, 
   3.4475887452736893`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Zeta]", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", "t", "]"}], "+", 
   RowBox[{
    FractionBox["2", 
     RowBox[{"3", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SubscriptBox["w", "s"], "[", "t", "]"}]}], ")"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", "t", "]"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"H", "[", "t", "]"}]], 
       RowBox[{
        RowBox[{"\[CapitalPhi]", "'"}], "[", "t", "]"}]}]}], 
     ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445253506511653*^9, 3.44525355254631*^9}, {
  3.445253582727006*^9, 3.445253587767356*^9}, {3.445256230794729*^9, 
  3.445256231167645*^9}, {3.4668359210467663`*^9, 3.466835963295282*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Miscellaneous", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.4441126257449827`*^9, 3.444112629822328*^9}, {
  3.444131748572*^9, 3.44413175588116*^9}}],

Cell["Extract nterm leading order terms from a series expansion.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.444131941289289*^9, 3.4441319854453573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"leading", "[", 
   RowBox[{
    RowBox[{"sr", ":", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"SeriesData", "[", 
       RowBox[{
       "x_", ",", "x0_", ",", "cl__List", ",", "nmin_", ",", "nmax_", ",", 
        "den_"}], "]"}], "]"}]}], ",", "nterm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nz", ",", "ni"}], "}"}], ",", 
    RowBox[{
     RowBox[{"nz", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"cl", ",", 
         RowBox[{"Except", "[", "0", "]"}], ",", "1", ",", 
         RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nterm", "<", 
        RowBox[{"Length", "[", "cl", "]"}]}], ",", 
       RowBox[{"SeriesData", "[", 
        RowBox[{"x", ",", "x0", ",", 
         RowBox[{"Take", "[", 
          RowBox[{"cl", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"nz", "[", 
               RowBox[{"[", "nterm", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], 
         ",", "nmin", ",", 
         RowBox[{"nmin", "+", 
          RowBox[{"nz", "[", 
           RowBox[{"[", "nterm", "]"}], "]"}]}], ",", "den"}], "]"}], ",", 
       "sr"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4441143531128893`*^9, 3.4441144161757393`*^9}, {
   3.444114654208173*^9, 3.444114692877185*^9}, {3.4441147790501003`*^9, 
   3.444114787027584*^9}, {3.44411483757395*^9, 3.444114905043631*^9}, {
   3.4441150099257107`*^9, 3.444115022784307*^9}, {3.4441150938131447`*^9, 
   3.4441151926926537`*^9}, {3.4441152298190002`*^9, 3.444115279681892*^9}, {
   3.444115429416368*^9, 3.444115435299429*^9}, {3.444115506319972*^9, 
   3.444115527312854*^9}, {3.4441155623843946`*^9, 3.444115620820467*^9}, {
   3.444115702267132*^9, 3.444115738977961*^9}, {3.444115796976063*^9, 
   3.4441158235583076`*^9}, {3.444115946914606*^9, 3.444115960796624*^9}, {
   3.4441160489158916`*^9, 3.444116067940508*^9}, {3.444116394473049*^9, 
   3.444116394751028*^9}, 3.444116494837049*^9, 3.4441165268344917`*^9, {
   3.444129048144215*^9, 3.444129112433928*^9}, {3.463747722559849*^9, 
   3.4637478300668783`*^9}, {3.463747995416583*^9, 3.463748028201805*^9}, {
   3.463748063075301*^9, 3.463748141178381*^9}, 3.463748209281767*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"leadingterm", "[", 
   RowBox[{"expr_", ",", "nterm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sr", "}"}], ",", 
    RowBox[{"expr", "/.", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"sr", ":", 
        RowBox[{"SeriesData", "[", "___", "]"}]}], "]"}], "\[Rule]", 
      RowBox[{"leading", "[", 
       RowBox[{"sr", ",", "nterm"}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444115293988185*^9, 3.444115386343515*^9}, 
   3.444116480646388*^9, {3.4441165325763807`*^9, 3.444116538340259*^9}, {
   3.445243220726571*^9, 3.44524322158384*^9}, {3.4452432799731083`*^9, 
   3.445243280431323*^9}, {3.463749644122704*^9, 3.463749644176942*^9}}],

Cell["\<\
Make a function substitution (ala  dsolve) into the pure function form.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.444132619514799*^9, 3.44413264214545*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mkpure", "[", "ex_", "]"}], ":=", 
  RowBox[{"ex", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f_", "[", "x_", "]"}], "\[Rule]", "expr_"}], ")"}], "\[Rule]", 
    
    RowBox[{"(", 
     RowBox[{"f", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", "expr"}], "]"}]}], ")"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.443988809579013*^9, 3.443988846290894*^9}, {
  3.443988896268046*^9, 3.4439888974925137`*^9}, {3.443988945558617*^9, 
  3.443989003598806*^9}}],

Cell["\<\
A function for applying a function to component sub expressions.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.461162161520602*^9, 3.461162174975005*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mapply", "[", 
    RowBox[{"expr_List", ",", 
     RowBox[{"f_:", "Simplify"}], ",", "arg___"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"mapply", "[", 
       RowBox[{"#", ",", "f", ",", "arg"}], "]"}], "&"}], ",", "expr"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapply", "[", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"a_", " ", "\[Rule]", " ", "b_"}], "]"}], ",", "f_", ",", 
     "arg___"}], "]"}], ":=", 
   RowBox[{"a", "->", 
    RowBox[{"mapply", "[", 
     RowBox[{"b", ",", "f", ",", "arg"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapply", "[", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"a_", " ", "==", " ", "b_"}], "]"}], ",", "f_", ",", "arg___"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{"mapply", "[", 
     RowBox[{
      RowBox[{"a", "-", "b"}], ",", "f", ",", "arg"}], "]"}], "\[Equal]", 
    "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapply", "[", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"SeriesData", "[", 
       RowBox[{
       "a_", ",", "b_", ",", "ls_List", ",", "c_", ",", "d_", ",", "e_"}], 
       "]"}], "]"}], ",", "f_", ",", "arg___"}], "]"}], ":=", 
   RowBox[{"SeriesData", "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{"mapply", "[", 
      RowBox[{"ls", ",", "f", ",", "arg"}], "]"}], ",", "c", ",", "d", ",", 
     "e"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapply", "[", 
    RowBox[{"expr_", ",", "f_", ",", "arg___"}], "]"}], ":=", 
   RowBox[{"f", "[", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"{", 
      RowBox[{"expr", ",", "arg"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4486955310277*^9, 3.448695585603613*^9}, {
   3.4486956296613607`*^9, 3.44869563906742*^9}, {3.448695701884162*^9, 
   3.44869581988799*^9}, {3.448695862831128*^9, 3.4486959150532637`*^9}, 
   3.4486973998049173`*^9, {3.448697453008407*^9, 3.448697539591729*^9}, {
   3.448697941255274*^9, 3.448697942053152*^9}, {3.4486983920214987`*^9, 
   3.4486984672828493`*^9}, {3.448698634352542*^9, 3.448698639756123*^9}, 
   3.448699778999609*^9, {3.448704076191484*^9, 3.448704078348329*^9}, {
   3.448710350475937*^9, 3.4487103616342382`*^9}, {3.448798278788974*^9, 
   3.44879829580084*^9}, {3.4489596516378193`*^9, 3.448959653069119*^9}, {
   3.44895985432799*^9, 3.448959860822604*^9}, {3.448965523201104*^9, 
   3.448965527411213*^9}, 3.449217622020886*^9, {3.449928990946308*^9, 
   3.449928992403129*^9}, {3.449997170226756*^9, 3.449997170464759*^9}, {
   3.4573426256330748`*^9, 3.457342642004677*^9}, {3.457342897752079*^9, 
   3.457342905946793*^9}, {3.457342952410942*^9, 3.4573429587607718`*^9}, {
   3.457343216682395*^9, 3.4573432465902433`*^9}, {3.457343366345887*^9, 
   3.457343504966997*^9}, {3.461161996612258*^9, 3.461162008904654*^9}}],

Cell["\<\
A function that performs simplification whilst expanding in the given variable\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.448699826480167*^9, 3.448699846369223*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"msimp2", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"ex", ":", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"mapply", "[", 
   RowBox[{"expr", ",", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", "ex"}], "]"}], "]"}], "]"}], "&"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.461162016793511*^9, 3.461162111395063*^9}, {
   3.461162841619582*^9, 3.461162846647993*^9}, 3.461162994776822*^9}],

Cell["A few default assumptions for the kernel", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.44413199292286*^9, 3.4441320370809393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"G", ">", "0"}], ",", 
      RowBox[{"H0", ">", "0"}], ",", 
      RowBox[{"a0", ">", "0"}], ",", 
      RowBox[{"\[Omega]", ">", "0"}], ",", 
      RowBox[{"splist", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "#"], ">", "0"}], "&"}], "]"}], ",", 
      
      RowBox[{"Rc", ">=", "0"}], ",", 
      RowBox[{"Rb", ">=", "0"}], ",", 
      RowBox[{"k", ">", "0"}], ",", 
      RowBox[{"omm", ">", "0"}]}], "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444124789726734*^9, 3.4441248108350897`*^9}, {
   3.4441249252118483`*^9, 3.444124953791585*^9}, {3.4441320872898407`*^9, 
   3.4441321201477003`*^9}, {3.4441392121831217`*^9, 3.444139223332719*^9}, 
   3.444634476988175*^9, {3.4447400788151703`*^9, 3.444740080007667*^9}, {
   3.445246518133256*^9, 3.445246544127371*^9}, {3.445342537019331*^9, 
   3.445342543082345*^9}, 3.445611528157239*^9}],

Cell["\<\
Antony's strange variable susbstitutions, odd, but they do make every a \
little easier to write down.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.44413234809101*^9, 3.444132376384363*^9}}],

Cell[BoxData[
 RowBox[{"antsub", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Rho]", "b0"], " ", "->", 
     RowBox[{"3", "Rb", "  ", 
      SubscriptBox["\[CapitalOmega]", "m"], " ", 
      RowBox[{
       RowBox[{"H0", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"8", "\[Pi]", " ", "G"}], " ", ")"}]}]}]}], ",", 
    RowBox[{
     SubscriptBox["\[Rho]", "c0"], " ", "->", 
     RowBox[{"3", "Rc", "  ", 
      SubscriptBox["\[CapitalOmega]", "m"], " ", 
      RowBox[{
       RowBox[{"H0", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"8", "\[Pi]", " ", "G"}], " ", ")"}]}]}]}], ",", " ", 
    RowBox[{
     SubscriptBox["\[Rho]", "\[Gamma]0"], "->", 
     RowBox[{"3", "R\[Gamma]", "  ", 
      SuperscriptBox[
       SubscriptBox["\[CapitalOmega]", "m"], "2"], " ", 
      RowBox[{
       RowBox[{"H0", "^", "4"}], "/", 
       RowBox[{"(", 
        RowBox[{"8", "\[Pi]", " ", "G", "  ", 
         RowBox[{"\[Omega]", "^", "2"}]}], ")"}]}]}]}], ",", 
    RowBox[{
     SubscriptBox["\[Rho]", "\[Nu]0"], "->", 
     RowBox[{"3", "R\[Nu]", " ", 
      SuperscriptBox[
       SubscriptBox["\[CapitalOmega]", "m"], "2"], " ", 
      RowBox[{
       RowBox[{"H0", "^", "4"}], "/", 
       RowBox[{"(", 
        RowBox[{"8", "\[Pi]", " ", "G", "  ", 
         RowBox[{"\[Omega]", "^", "2"}]}], ")"}]}]}]}], ",", 
    RowBox[{
     SubscriptBox["\[Rho]", "n0"], "->", 
     RowBox[{"3", "Rn", " ", 
      SuperscriptBox[
       SubscriptBox["\[CapitalOmega]", "m"], "2"], " ", 
      RowBox[{
       RowBox[{"H0", "^", "4"}], "/", 
       RowBox[{"(", 
        RowBox[{"8", "\[Pi]", " ", "G", "  ", 
         RowBox[{"\[Omega]", "^", "2"}]}], ")"}]}]}]}], ",", 
    RowBox[{"H0", "\[Rule]", 
     RowBox[{"\[Omega]", 
      RowBox[{
       SqrtBox[
        SubscriptBox["\[CapitalOmega]", "r"]], "/", 
       SubscriptBox["\[CapitalOmega]", "m"]}]}]}], ",", 
    RowBox[{"R\[Gamma]", "\[Rule]", 
     RowBox[{"1", "-", "R\[Nu]", "-", "Rn"}]}], ",", 
    RowBox[{"Rb", "\[Rule]", 
     RowBox[{"1", "-", "Rc"}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444138595598024*^9, 3.444138655142136*^9}, {
   3.445165416144882*^9, 3.4451654573406343`*^9}, {3.445333414055922*^9, 
   3.4453334247576227`*^9}, {3.445611536848834*^9, 3.445611557108088*^9}, {
   3.449934853705735*^9, 3.44993485923835*^9}, 3.45069269593524*^9, {
   3.450770897211985*^9, 3.450770916803913*^9}, {3.457181684313273*^9, 
   3.457181694903132*^9}, {3.463407237368973*^9, 3.463407249447323*^9}, {
   3.463407296165223*^9, 3.463407297188892*^9}, {3.463746161695675*^9, 
   3.463746178580761*^9}, {3.463746306099697*^9, 3.463746344177705*^9}, {
   3.4637465078018427`*^9, 3.4637465134277697`*^9}}],

Cell["\<\
Define adiabatic conditions for the species given (expressed relative to the \
first species).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.445069585242258*^9, 3.445069615441926*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"adiabatic", "[", "sp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", "tail"}], "}"}], ",", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"First", "[", "sp", "]"}]}], ";", 
     RowBox[{"tail", "=", 
      RowBox[{"sp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
     RowBox[{"splist", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[Delta]", "h"], "[", "t", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SubscriptBox["w", "h"], "[", "t", "]"}]}], ")"}]}], "==", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Delta]", "#"], "[", "t", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SubscriptBox["w", "#"], "[", "t", "]"}]}], ")"}]}]}], "&"}], ",",
        "tail"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4444009346449537`*^9, 3.444400942555625*^9}, {
  3.444401128482991*^9, 3.444401265262315*^9}, {3.44440132002113*^9, 
  3.4444013564489813`*^9}, {3.444401403117365*^9, 3.444401433275578*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"isocurvature", "[", 
   RowBox[{"spl_", ",", "sp1_", ",", 
    RowBox[{"curv_:", "\[Zeta]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", "tail", ",", "adl"}], "}"}], ",", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"First", "[", "spl", "]"}]}], ";", 
     RowBox[{"tail", "=", 
      RowBox[{"spl", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", 
     RowBox[{"adl", "=", 
      RowBox[{"splist", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "h"], "'"}], "[", "0", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SubscriptBox["w", "h"], "[", "0", "]"}]}], ")"}]}], "==", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "#"], "'"}], "[", "0", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SubscriptBox["w", "#"], "[", "0", "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Delta]", "#"], "[", "0", "]"}], "\[Equal]", 
            "0"}]}], "}"}], "&"}], ",", "tail"}], "]"}]}], ";", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"adl", ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Delta]", "sp1"], "[", "0", "]"}], "\[Equal]", "1"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"curv", "[", "ts", "]"}], "\[Equal]", "0"}], "/.", 
         RowBox[{"ts", "\[Rule]", 
          RowBox[{"Hold", "[", "0", "]"}]}]}]}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4444009346449537`*^9, 3.444400942555625*^9}, {
  3.444401128482991*^9, 3.444401265262315*^9}, {3.44440132002113*^9, 
  3.4444013564489813`*^9}, {3.444401403117365*^9, 3.444401433275578*^9}, {
  3.445243502483522*^9, 3.445243558198729*^9}, {3.445243592790101*^9, 
  3.445243615348468*^9}, {3.445243651355925*^9, 3.44524370455571*^9}, {
  3.445243768324799*^9, 3.4452437714116383`*^9}, {3.445243990785695*^9, 
  3.445244005457099*^9}, {3.445246090454093*^9, 3.4452461159029922`*^9}, {
  3.4452538817750673`*^9, 3.445253896305498*^9}, {3.445269922284483*^9, 
  3.445269932723587*^9}, {3.4457705136801987`*^9, 3.445770518825659*^9}, {
  3.4457707632121696`*^9, 3.445770786389118*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge Fixing", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.444650666862574*^9, 3.444650672855584*^9}, {
  3.444996068292145*^9, 3.444996068950152*^9}}],

Cell["\<\
Map a quanitity over the matter species given (or b,c,\[Gamma] if not).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.444131779004731*^9, 3.444131823529607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"splist", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"i_:", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "\[Gamma]"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"f", ",", "i"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443961588915318*^9, 3.443961740736579*^9}, {
   3.443961803552936*^9, 3.443961818519855*^9}, {3.443961929403748*^9, 
   3.4439619554548473`*^9}, {3.443961997539114*^9, 3.443962003203477*^9}, 
   3.443962070239996*^9, {3.444112838582049*^9, 3.444112856171102*^9}, {
   3.444131806821609*^9, 3.444131812648047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2pattern", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", 
  RowBox[{"a", "\[Rule]", "b"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Make the default variable definitions summing over particle species.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.444131843317059*^9, 3.444131857367573*^9}, {
  3.4441318881509857`*^9, 3.444131935158402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"defvar", "[", 
    RowBox[{"i_:", 
     RowBox[{"{", 
      RowBox[{"b", ",", "c", ",", "\[Gamma]"}], "}"}]}], "]"}], ":=", 
   RowBox[{"mkpure", "[", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Rho]", "s"], "[", "t", "]"}], "->", 
       RowBox[{"Total", "[", 
        RowBox[{"splist", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], "&"}], ",", "i"}], 
         "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["P", "s"], "[", "t", "]"}], "->", 
       RowBox[{"Total", "[", 
        RowBox[{"splist", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["P", "#"], "[", "t", "]"}], "&"}], ",", "i"}], "]"}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["w", "s"], "[", "t", "]"}], "->", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"splist", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["w", "#"], "[", "t", "]"}], 
             RowBox[{
              SubscriptBox["\[Rho]", "#"], "[", "t", "]"}]}], "&"}], ",", 
           "i"}], "]"}], "]"}], "/", 
        RowBox[{
         SubscriptBox["\[Rho]", "s"], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["c", "s"], "[", "t", "]"}], "->", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"splist", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SubscriptBox["w", "#"], "[", "t", "]"}]}], ")"}], 
             RowBox[{
              SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], 
             RowBox[{
              SubscriptBox["c", "#"], "[", "t", "]"}]}], "&"}], ",", "i"}], 
          "]"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SubscriptBox["w", "s"], "[", "t", "]"}]}], ")"}], 
          RowBox[{
           SubscriptBox["\[Rho]", "s"], "[", "t", "]"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "s"], "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"splist", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "#"], "[", "t", "]"}]}], 
              "&"}], ",", "i"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Rho]", "\[Gamma]"], "[", "t", "]"}], 
           SubscriptBox["d", "B"]}]}], ")"}], "/", 
        RowBox[{
         SubscriptBox["\[Rho]", "s"], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "s"], "[", "t", "]"}], "->", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"splist", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], "+", 
               RowBox[{
                SubscriptBox["P", "#"], "[", "t", "]"}]}], ")"}], 
             RowBox[{
              SubscriptBox["V", "#"], "[", "t", "]"}]}], "&"}], ",", "i"}], 
          "]"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Rho]", "s"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["P", "s"], "[", "t", "]"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Delta]", "s"], "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"splist", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], 
               RowBox[{
                SubscriptBox["\[Delta]", "#"], "[", "t", "]"}]}], "&"}], ",", 
             "i"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Rho]", "\[Gamma]"], "[", "t", "]"}], 
           SubscriptBox["d", "B"]}]}], ")"}], "/", 
        RowBox[{
         SubscriptBox["\[Rho]", "s"], "[", "t", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["v", "s"], "[", "t", "]"}], "->", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"splist", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], "+", 
               RowBox[{
                SubscriptBox["P", "#"], "[", "t", "]"}]}], ")"}], 
             RowBox[{
              SubscriptBox["v", "#"], "[", "t", "]"}]}], "&"}], ",", "i"}], 
          "]"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Rho]", "s"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["P", "s"], "[", "t", "]"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPi]", "s"], "[", "t", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"splist", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["P", "#"], "[", "t", "]"}], 
                RowBox[{
                 SubscriptBox["\[CapitalPi]", "#"], "[", "t", "]"}]}], "&"}], 
              ",", "i"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", "\[Gamma]"], "[", "t", "]"}], 
            SubscriptBox["s", "B"]}]}], ")"}], "/", 
         RowBox[{
          SubscriptBox["P", "s"], "[", "t", "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", "\[Gamma]"], "[", 
         RowBox[{"t", ",", "2"}], "]"}], "\[Rule]", "0"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalGamma]", "s"], "[", "t", "]"}], "->", 
       RowBox[{"Total", "[", 
        RowBox[{"splist", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["P", "#"], "[", "t", "]"}], 
             RowBox[{
              SubscriptBox["\[CapitalGamma]", "#"], "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["c", "#"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["c", "s"], "[", "t", "]"}]}], ")"}], 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "#"], "[", "t", "]"}]}]}], 
           "&"}], ",", "i"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]", "V"], "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Total", "[", 
          RowBox[{"splist", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Rho]", "#"], "[", "t", "]"}], "+", 
                RowBox[{
                 SubscriptBox["P", "#"], "[", "t", "]"}]}], ")"}], 
              RowBox[{
               SubscriptBox["\[CapitalOmega]", 
                RowBox[{"V", ",", "#"}]], "[", "t", "]"}]}], "&"}], ",", 
            "i"}], "]"}], "]"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Rho]", "s"], "[", "t", "]"}], "+", 
          RowBox[{
           SubscriptBox["P", "s"], "[", "t", "]"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPi]", "V"], "[", "t", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"splist", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["P", "#"], "[", "t", "]"}], 
                RowBox[{
                 SubscriptBox["\[CapitalPi]", 
                  RowBox[{"V", ",", "#"}]], "[", "t", "]"}]}], "&"}], ",", 
              "i"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", "\[Gamma]"], "[", "t", "]"}], 
            SubscriptBox["s", 
             RowBox[{"V", ",", "B"}]]}]}], ")"}], "/", 
         RowBox[{
          SubscriptBox["P", "s"], "[", "t", "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPi]", 
          RowBox[{"V", ",", "\[Gamma]"}]], "[", "t", "]"}], "\[Rule]", 
        "0"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPi]", "T"], "[", "t", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"splist", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["P", "#"], "[", "t", "]"}], 
                RowBox[{
                 SubscriptBox["\[CapitalPi]", 
                  RowBox[{"T", ",", "#"}]], "[", "t", "]"}]}], "&"}], ",", 
              "i"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", "\[Gamma]"], "[", "t", "]"}], 
            SubscriptBox["s", 
             RowBox[{"T", ",", "B"}]]}]}], ")"}], "/", 
         RowBox[{
          SubscriptBox["P", "s"], "[", "t", "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPi]", 
          RowBox[{"T", ",", "\[Gamma]"}]], "[", "t", "]"}], "\[Rule]", 
        "0"}]}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.443962136712927*^9, 3.443962191883378*^9}, {
   3.443979702117626*^9, 3.4439797162990932`*^9}, {3.444112874382227*^9, 
   3.444112915764008*^9}, {3.4441130744906588`*^9, 3.444113144836*^9}, {
   3.4441319124877996`*^9, 3.4441319162042513`*^9}, {3.444661432687015*^9, 
   3.444661609748508*^9}, 3.444661665036034*^9, {3.4446617204081306`*^9, 
   3.44466186503509*^9}, {3.444661897235486*^9, 3.4446619403701487`*^9}, {
   3.444661987975712*^9, 3.4446621125396767`*^9}, {3.444742380665646*^9, 
   3.44474243673293*^9}, {3.445165976233364*^9, 3.445166068024598*^9}, {
   3.445166460341135*^9, 3.445166463438388*^9}, {3.445256213212357*^9, 
   3.445256308494622*^9}, {3.445256502751134*^9, 3.445256503909296*^9}, {
   3.4531056249042*^9, 3.453105704102453*^9}, {3.453106895043028*^9, 
   3.453106916333618*^9}, {3.453106952858808*^9, 3.453106956089596*^9}, {
   3.454322897773061*^9, 3.454322910518876*^9}, {3.4543229589325457`*^9, 
   3.454323017480399*^9}, {3.454324075296742*^9, 3.454324077596092*^9}, {
   3.454325574490203*^9, 3.4543255756839046`*^9}, {3.4611595406678143`*^9, 
   3.461159625111793*^9}, {3.462882967059374*^9, 3.4628829675846767`*^9}, {
   3.462885476365973*^9, 3.46288556302529*^9}, {3.4633827394152*^9, 
   3.463382756156519*^9}, {3.4633828859410267`*^9, 3.46338288853194*^9}, {
   3.463391689935574*^9, 3.4633916901932697`*^9}, {3.463393197302227*^9, 
   3.463393198075945*^9}}],

Cell["\<\
Definitions of the gauge invariant variables in terms of the gauge quantities.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.444650678152916*^9, 3.444650718885646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"symb", "[", 
   RowBox[{"sym_", ",", "sub_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"TrueQ", "[", "sub", "]"}], ",", "sym", ",", 
    SubscriptBox["sym", "sub"]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444653713517497*^9, 3.444653765876143*^9}}],

Cell[TextData[{
 "Assume that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", "a"], TraditionalForm]]],
 "is a constant (i.e. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "s"], TraditionalForm]]],
 "=w) for the fluid we are considering."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.44473787047182*^9, 3.444737922411569*^9}}],

Cell["\<\
Define the density and velocity like gauge invariant variables (identical to \
CNG definitions).\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.445002211247061*^9, 3.4450022370111637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"density", "[", 
   RowBox[{"sub_:", "True"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"symb", "[", 
       RowBox[{"\[Delta]", ",", "sub"}], "]"}], "[", "t", "]"}], "+", 
     RowBox[{"3", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"symb", "[", 
          RowBox[{"w", ",", "sub"}], "]"}], "[", "t", "]"}]}], ")"}], 
      RowBox[{"H", "[", "t", "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sigma]", "s"], "[", "t", "]"}], "/", "k"}]}]}], ")"}],
    "/.", "auxpot"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44465072662609*^9, 3.444650737645859*^9}, {
   3.444650801323208*^9, 3.44465081678686*^9}, {3.4446531767604513`*^9, 
   3.444653236104333*^9}, {3.444653289022357*^9, 3.444653329737615*^9}, {
   3.444653387078897*^9, 3.4446534189769707`*^9}, {3.444653467023651*^9, 
   3.444653476591387*^9}, {3.444653603148748*^9, 3.444653703975717*^9}, {
   3.444653781371584*^9, 3.4446538498737383`*^9}, {3.4446539376826344`*^9, 
   3.444653942926478*^9}, {3.4446592866676292`*^9, 3.444659288691349*^9}, {
   3.4446601844955873`*^9, 3.444660185514318*^9}, {3.44466889643309*^9, 
   3.444668897108068*^9}, {3.4447246823896227`*^9, 3.444724683116721*^9}, {
   3.4447369753619213`*^9, 3.4447369827893257`*^9}, {3.444737015078001*^9, 
   3.444737017908393*^9}, {3.444737143403071*^9, 3.44473722859441*^9}, {
   3.444737297717772*^9, 3.444737301976902*^9}, {3.444737393974677*^9, 
   3.4447373994565477`*^9}, {3.444737942306963*^9, 3.44473795887598*^9}, 
   3.444740307968721*^9, {3.463751120208761*^9, 3.4637511289658012`*^9}, {
   3.463754188233612*^9, 3.463754203362207*^9}, {3.46375503368267*^9, 
   3.4637550381914682`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"velocity", "[", 
   RowBox[{"sub_:", "True"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"symb", "[", 
      RowBox[{"v", ",", "sub"}], "]"}], "[", "t", "]"}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["h", 
        RowBox[{"s", ",", "T"}]], "'"}], "[", "t", "]"}], "/", "k"}]}], "/.", 
   "auxpot"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444653978407854*^9, 3.444654046772346*^9}, {
  3.444659303322584*^9, 3.4446593051460543`*^9}, {3.444660190311822*^9, 
  3.4446601906571007`*^9}, {3.444668881952263*^9, 3.444668882188369*^9}, {
  3.444724687956642*^9, 3.444724688270896*^9}, {3.444736988063369*^9, 
  3.444736999011979*^9}, {3.461161467447928*^9, 3.4611614748368473`*^9}, {
  3.463751141394047*^9, 3.463751152215933*^9}, {3.46375412536449*^9, 
  3.463754136122854*^9}, {3.463756833763438*^9, 3.463756835599757*^9}, {
  3.463757017625018*^9, 3.463757017964149*^9}}],

Cell["Define the two Bardeen potentials.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.445002243223928*^9, 3.445002253138682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phivar", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "t", "]"}], "->", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[ScriptCapitalR]", "s"], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"H", "[", "t", "]"}], 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Sigma]", "s"], "[", "t", "]"}], "/", "k"}]}]}]}], "/.",
      "auxpot"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4446549957517023`*^9, 3.4446550229989357`*^9}, {
   3.444655106060213*^9, 3.444655117812656*^9}, {3.444655932258003*^9, 
   3.444655973910594*^9}, {3.444659233183568*^9, 3.4446592355483913`*^9}, {
   3.444663670120323*^9, 3.444663702062587*^9}, {3.444665599784758*^9, 
   3.444665617838579*^9}, {3.444666944133334*^9, 3.444666957059079*^9}, {
   3.4446672732210093`*^9, 3.444667279000429*^9}, {3.444667369528944*^9, 
   3.444667369741171*^9}, 3.444994386636051*^9, {3.463750914438278*^9, 
   3.4637509465816793`*^9}, {3.463754908640527*^9, 3.4637549097816267`*^9}, {
   3.466324734868607*^9, 3.4663247467800694`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"psivar", "=", 
   RowBox[{"mkpure", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", "t", "]"}], "->", 
      RowBox[{
       RowBox[{"A", "[", "t", "]"}], "-", 
       RowBox[{
        RowBox[{"H", "[", "t", "]"}], 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Sigma]", "s"], "[", "t", "]"}], "/", "k"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[Sigma]", "s"], "'"}], "[", "t", "]"}], "/", 
        "k"}]}]}], "/.", "auxpot"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4446559680022583`*^9, 3.444656075942059*^9}, {
   3.444659241237056*^9, 3.4446592490917683`*^9}, {3.444663690968545*^9, 
   3.44466369987055*^9}, {3.4446656219147043`*^9, 3.444665634302503*^9}, {
   3.444666950821512*^9, 3.444666954313581*^9}, {3.444667283868169*^9, 
   3.444667284592547*^9}, {3.4446673647469683`*^9, 3.444667365781455*^9}, 
   3.444994387828598*^9, {3.463750863627575*^9, 3.463750898079245*^9}, {
   3.463754912870316*^9, 3.463754913990655*^9}, {3.466324750125972*^9, 
   3.46632476247718*^9}}],

Cell["\<\
A list of substitutions for all the gauge invariant variables. Use, and then \
susbtitute for the gauge conditions.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.445002270803364*^9, 3.4450023303534613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaugevar", "[", 
   RowBox[{"i_:", 
    RowBox[{"{", 
     RowBox[{"b", ",", "c", ",", "\[Gamma]"}], "}"}]}], "]"}], ":=", 
  RowBox[{"mkpure", "[", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"psivar", ",", "phivar", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "s"], "[", "t", "]"}], "\[Rule]", 
       RowBox[{"density", "[", "s", "]"}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "s"], "[", "t", "]"}], "\[Rule]", 
       RowBox[{"velocity", "[", "s", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"eq2pattern", "[", "raychaudhuri", "]"}], ",", 
      RowBox[{"eq2pattern", "[", "energycons", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"eq2pattern", "[", 
       RowBox[{"D", "[", 
        RowBox[{"raychaudhuri", ",", "t"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["w", "s"], "'"}], "[", "t", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[Rho]", "s"], "'"}], "[", "t", "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["c", "s"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["w", "s"], "[", "t", "]"}]}], ")"}], "/", 
         RowBox[{
          SubscriptBox["\[Rho]", "s"], "[", "t", "]"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"splist", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "#"], "[", "t", "]"}], "\[Rule]", 
          RowBox[{"density", "[", "#", "]"}]}], "&"}], ",", "i"}], "]"}], ",", 
      RowBox[{"splist", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["V", "#"], "[", "t", "]"}], "\[Rule]", 
          RowBox[{"velocity", "[", "#", "]"}]}], "&"}], ",", "i"}], "]"}]}], 
     "}"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444654908568212*^9, 3.444654953485119*^9}, {
   3.4446549847773247`*^9, 3.444654987223884*^9}, {3.444656080157146*^9, 
   3.444656084252809*^9}, {3.444656176158036*^9, 3.4446562583873796`*^9}, {
   3.444659353467454*^9, 3.444659359936974*^9}, {3.444737026241207*^9, 
   3.444737045924177*^9}, {3.444737118473423*^9, 3.4447371391946173`*^9}, {
   3.444737404446746*^9, 3.444737407629881*^9}, {3.444737450138348*^9, 
   3.444737455565607*^9}, {3.444742452780723*^9, 3.444742517903645*^9}, {
   3.4447425953203583`*^9, 3.444742621695671*^9}, 3.444994139043604*^9, {
   3.444998858327793*^9, 3.4449988751320553`*^9}, {3.444998912476481*^9, 
   3.444998916555587*^9}, {3.4449990046992197`*^9, 3.444999037612467*^9}, {
   3.4449993296078167`*^9, 3.4449993436034727`*^9}, {3.44525633485645*^9, 
   3.445256362975865*^9}, {3.44533929698446*^9, 3.445339302926893*^9}, {
   3.461161502502652*^9, 3.461161517626952*^9}, {3.463754002416573*^9, 
   3.463754006891836*^9}, {3.463754925270681*^9, 3.463754926809421*^9}}],

Cell["\<\
Take a set of variables, and return the gauge fixed equivalents\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4450023417301617`*^9, 3.44500236193709*^9}, {
  3.463754245817502*^9, 3.4637542475824823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixvar", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", "\[Rule]", "\[Delta]"}], ",", 
     RowBox[{"V", "\[Rule]", "v"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44500214956852*^9, 3.445002187616661*^9}, {
  3.4611615321706953`*^9, 3.461161536280768*^9}}],

Cell[CellGroupData[{

Cell["Conformal Newtonian Gauge", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.44500052623986*^9, 3.4450005316572123`*^9}}],

Cell[BoxData[
 RowBox[{"cngsub", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", "s"], "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"t", ",", "0"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["h", 
      RowBox[{"s", ",", "T"}]], "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"t", ",", "0"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["h", 
      RowBox[{"s", ",", "L"}]], "\[Rule]", "\[Phi]"}], ",", 
    RowBox[{"A", "\[Rule]", "\[Psi]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444656360316134*^9, 3.444656377153555*^9}, {
  3.4446564151705713`*^9, 3.444656445383218*^9}, {3.444656481067705*^9, 
  3.44465648281822*^9}, {3.444659254596908*^9, 3.444659262665861*^9}, {
  3.444659334089373*^9, 3.444659334796899*^9}, {3.445001207686833*^9, 
  3.4450012085655003`*^9}, {3.463754237059709*^9, 3.463754253655676*^9}, {
  3.463754287456201*^9, 3.4637543267608967`*^9}}],

Cell[BoxData[
 RowBox[{"cngvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "t", "]"}], ",", 
    RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445001210438355*^9, 3.4450012310014467`*^9}, 
   3.44500304417527*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Synchronous Gauge", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.445000536760927*^9, 3.445000541361299*^9}}],

Cell[BoxData[
 RowBox[{"synsub", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["B", "s"], "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{"t1", ",", "0"}], "]"}]}], ",", 
    RowBox[{"A", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "t1", "}"}], ",", "0"}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["h", 
      RowBox[{"s", ",", "L"}]], "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "t1", "}"}], ",", 
       RowBox[{
        RowBox[{"h", "[", "t1", "]"}], "/", "6"}]}], "]"}]}], ",", 
    RowBox[{
     SubscriptBox["h", 
      RowBox[{"s", ",", "T"}]], "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "t1", "}"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h", "[", "t1", "]"}], "+", 
           RowBox[{"6", 
            RowBox[{"\[Eta]", "[", "t1", "]"}]}]}], ")"}]}], "/", "2"}]}], 
      "]"}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4446630809274473`*^9, 3.444663100917033*^9}, {
   3.4446653390111113`*^9, 3.444665394457344*^9}, {3.444666980132738*^9, 
   3.44466698563599*^9}, 3.444667231885108*^9, 3.4446672692121277`*^9, 
   3.444667544017151*^9, {3.4637543358466988`*^9, 3.4637543489239073`*^9}, {
   3.463754821708083*^9, 3.4637548815724287`*^9}, {3.463761733078701*^9, 
   3.46376174312519*^9}}],

Cell[BoxData[
 RowBox[{"synvars", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h", "[", "t", "]"}], ",", 
    RowBox[{"\[Eta]", "[", "t", "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445001246748025*^9, 3.445001259001032*^9}, 
   3.445003045758564*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{869, 1141},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Subsubsection"]], 
   Cell[
    StyleData["Section"]]}, Visible -> False, FrontEndVersion -> 
  "7.0 for Mac OS X x86 (32-bit) (February 18, 2009)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 128, 2, 76, "Title",
 InitializationCell->True],
Cell[698, 26, 138, 2, 46, "Subtitle",
 InitializationCell->True],
Cell[839, 30, 476, 9, 43, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1340, 43, 132, 2, 67, "Section",
 InitializationCell->True],
Cell[1475, 47, 151, 2, 27, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1651, 53, 136, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[1790, 57, 695, 15, 28, "Input",
 InitializationCell->True],
Cell[2488, 74, 358, 8, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2883, 87, 210, 3, 25, "Subsubsection",
 InitializationCell->True],
Cell[3096, 92, 1076, 23, 33, "Input",
 InitializationCell->True],
Cell[4175, 117, 1231, 26, 48, "Input",
 InitializationCell->True],
Cell[5409, 145, 705, 19, 30, "Input",
 InitializationCell->True],
Cell[6117, 166, 487, 8, 28, "Input",
 InitializationCell->True],
Cell[6607, 176, 361, 8, 28, "Input",
 InitializationCell->True],
Cell[6971, 186, 282, 7, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7302, 199, 127, 2, 67, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7454, 205, 205, 3, 34, "Subsection",
 InitializationCell->True],
Cell[7662, 210, 307, 6, 43, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7994, 220, 286, 4, 25, "Subsubsection",
 InitializationCell->True],
Cell[8283, 226, 138, 2, 27, "Text",
 InitializationCell->True],
Cell[8424, 230, 1630, 36, 48, "Input",
 InitializationCell->True],
Cell[10057, 268, 1113, 28, 48, "Input",
 InitializationCell->True],
Cell[11173, 298, 134, 2, 27, "Text",
 InitializationCell->True],
Cell[11310, 302, 2207, 59, 87, "Input",
 InitializationCell->True],
Cell[13520, 363, 988, 23, 33, "Input",
 InitializationCell->True],
Cell[14511, 388, 162, 2, 27, "Text",
 InitializationCell->True],
Cell[14676, 392, 506, 11, 28, "Input",
 InitializationCell->True],
Cell[15185, 405, 130, 2, 27, "Text",
 InitializationCell->True],
Cell[15318, 409, 1067, 32, 34, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16422, 446, 138, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[16563, 450, 189, 3, 27, "Text",
 InitializationCell->True],
Cell[16755, 455, 745, 21, 33, "Input",
 InitializationCell->True],
Cell[17503, 478, 159, 3, 27, "Text",
 InitializationCell->True],
Cell[17665, 483, 677, 22, 33, "Input",
 InitializationCell->True],
Cell[18345, 507, 156, 2, 27, "Text",
 InitializationCell->True],
Cell[18504, 511, 236, 6, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18777, 522, 260, 4, 25, "Subsubsection",
 InitializationCell->True],
Cell[19040, 528, 186, 3, 27, "Text",
 InitializationCell->True],
Cell[19229, 533, 1878, 40, 33, "Input",
 InitializationCell->True],
Cell[21110, 575, 505, 11, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21676, 593, 130, 2, 67, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[21831, 599, 135, 2, 34, "Subsection",
 InitializationCell->True],
Cell[21969, 603, 182, 4, 27, "Text",
 InitializationCell->True],
Cell[22154, 609, 364, 8, 30, "Input",
 InitializationCell->True],
Cell[22521, 619, 883, 22, 35, "Input",
 InitializationCell->True],
Cell[23407, 643, 400, 11, 30, "Input",
 InitializationCell->True],
Cell[23810, 656, 244, 6, 30, "Input",
 InitializationCell->True],
Cell[24057, 664, 212, 6, 30, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[24306, 675, 214, 3, 34, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[24545, 682, 137, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[24685, 686, 725, 19, 30, "Input",
 InitializationCell->True],
Cell[25413, 707, 793, 20, 30, "Input",
 InitializationCell->True],
Cell[26209, 729, 280, 7, 30, "Input",
 InitializationCell->True],
Cell[26492, 738, 468, 9, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26997, 752, 138, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[27138, 756, 189, 4, 27, "Text",
 InitializationCell->True],
Cell[27330, 762, 2192, 38, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[29525, 802, 315, 9, 31, "Input",
 InitializationCell->True],
Cell[29843, 813, 233, 6, 31, "Input",
 InitializationCell->True],
Cell[30079, 821, 269, 7, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[30385, 833, 138, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[30526, 837, 166, 2, 27, "Text",
 InitializationCell->True],
Cell[30695, 841, 280, 7, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[31012, 853, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[31144, 857, 540, 12, 30, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31745, 876, 269, 4, 67, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[32039, 884, 132, 2, 34, "Subsection",
 InitializationCell->True],
Cell[32174, 888, 398, 9, 31, "Input",
 InitializationCell->True],
Cell[32575, 899, 943, 24, 37, "Input",
 InitializationCell->True],
Cell[33521, 925, 474, 12, 31, "Input",
 InitializationCell->True],
Cell[33998, 939, 445, 14, 35, "Input",
 InitializationCell->True],
Cell[34446, 955, 219, 6, 31, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[34702, 966, 139, 2, 34, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[34866, 972, 206, 3, 25, "Subsubsection",
 InitializationCell->True],
Cell[35075, 977, 313, 9, 29, "Text",
 InitializationCell->True],
Cell[35391, 988, 488, 12, 30, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[35904, 1004, 226, 4, 27, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[36133, 1010, 829, 22, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[36965, 1034, 1586, 39, 34, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[38554, 1075, 1333, 33, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[39890, 1110, 1348, 39, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[41253, 1152, 203, 5, 27, "Text",
 InitializationCell->True],
Cell[41459, 1159, 753, 18, 49, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[42237, 1181, 239, 4, 27, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[42479, 1187, 1927, 56, 104, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44455, 1249, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[44587, 1253, 487, 11, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45123, 1270, 135, 2, 34, "Subsection",
 InitializationCell->True],
Cell[45261, 1274, 188, 4, 27, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[45474, 1282, 2317, 48, 54, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[47794, 1332, 3097, 66, 59, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[50894, 1400, 2566, 60, 70, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[53475, 1463, 261, 6, 27, "Text",
 InitializationCell->True],
Cell[53739, 1471, 1154, 34, 54, "Input",
 InitializationCell->True],
Cell[54896, 1507, 235, 5, 27, "Text",
 InitializationCell->True],
Cell[55134, 1514, 1231, 29, 35, "Input",
 InitializationCell->True],
Cell[56368, 1545, 3206, 68, 91, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[CellGroupData[{
Cell[59599, 1617, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[59731, 1621, 1117, 19, 35, "Input",
 InitializationCell->True],
Cell[60851, 1642, 930, 25, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61830, 1673, 209, 3, 34, "Subsection",
 InitializationCell->True],
Cell[62042, 1678, 217, 5, 27, "Text",
 InitializationCell->True],
Cell[62262, 1685, 335, 8, 31, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62646, 1699, 118, 2, 67, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[62789, 1705, 141, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[62933, 1709, 167, 2, 27, "Text",
 InitializationCell->True],
Cell[63103, 1713, 409, 8, 30, "Input",
 InitializationCell->True],
Cell[63515, 1723, 1034, 24, 35, "Input",
 InitializationCell->True],
Cell[64552, 1749, 450, 12, 30, "Input",
 InitializationCell->True],
Cell[65005, 1763, 388, 8, 30, "Input",
 InitializationCell->True],
Cell[65396, 1773, 212, 6, 30, "Input",
 InitializationCell->True],
Cell[65611, 1781, 360, 11, 54, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[66008, 1797, 166, 3, 25, "Subsubsection",
 InitializationCell->True],
Cell[66177, 1802, 699, 18, 30, "Input",
 InitializationCell->True],
Cell[66879, 1822, 2086, 54, 65, "Input",
 InitializationCell->True],
Cell[68968, 1878, 209, 5, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[69214, 1888, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[69346, 1892, 425, 11, 30, "Input",
 InitializationCell->True],
Cell[69774, 1905, 210, 6, 30, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[70021, 1916, 135, 2, 34, "Subsection",
 InitializationCell->True],
Cell[70159, 1920, 188, 4, 27, "Text",
 InitializationCell->True],
Cell[70350, 1926, 3035, 61, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[73388, 1989, 280, 7, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[73693, 2000, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[73825, 2004, 960, 17, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74834, 2027, 237, 4, 34, "Subsection",
 InitializationCell->True],
Cell[75074, 2033, 281, 7, 31, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75404, 2046, 141, 2, 67, "Section",
 InitializationCell->True],
Cell[75548, 2050, 542, 13, 46, "Text",
 InitializationCell->True],
Cell[76093, 2065, 437, 10, 31, "Input",
 InitializationCell->True],
Cell[76533, 2077, 1547, 39, 51, "Input",
 InitializationCell->True],
Cell[78083, 2118, 296, 7, 28, "Input",
 InitializationCell->True],
Cell[78382, 2127, 1218, 36, 59, "Input",
 InitializationCell->True],
Cell[79603, 2165, 605, 17, 35, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[80233, 2186, 156, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[80392, 2190, 1009, 27, 54, "Input",
 InitializationCell->True],
Cell[81404, 2219, 167, 4, 27, "Text",
 InitializationCell->True],
Cell[81574, 2225, 581, 13, 28, "Input",
 InitializationCell->True],
Cell[82158, 2240, 1205, 32, 48, "Input",
 InitializationCell->True],
Cell[83366, 2274, 143, 2, 27, "Text",
 InitializationCell->True],
Cell[83512, 2278, 392, 8, 28, "Input",
 InitializationCell->True],
Cell[83907, 2288, 523, 13, 28, "Input",
 InitializationCell->True],
Cell[84433, 2303, 413, 12, 31, "Input",
 InitializationCell->True],
Cell[84849, 2317, 729, 18, 35, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[85615, 2340, 139, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[85757, 2344, 567, 13, 31, "Input",
 InitializationCell->True],
Cell[86327, 2359, 1575, 47, 51, "Input",
 InitializationCell->True],
Cell[87905, 2408, 332, 7, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88286, 2421, 256, 4, 67, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[88567, 2429, 135, 2, 34, "Subsection",
 InitializationCell->True],
Cell[88705, 2433, 305, 10, 32, "Text",
 InitializationCell->True],
Cell[89013, 2445, 736, 13, 30, "Input",
 InitializationCell->True],
Cell[89752, 2460, 1447, 27, 33, "Input",
 InitializationCell->True],
Cell[91202, 2489, 1501, 26, 30, "Input",
 InitializationCell->True],
Cell[92706, 2517, 619, 12, 30, "Input",
 InitializationCell->True],
Cell[93328, 2531, 408, 9, 30, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[93773, 2545, 137, 2, 34, "Subsection",
 InitializationCell->True],
Cell[93913, 2549, 425, 11, 48, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[94363, 2564, 309, 5, 25, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[94697, 2573, 1829, 36, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[96529, 2611, 1957, 40, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[98489, 2653, 1913, 44, 49, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[100417, 2700, 308, 7, 27, "Text",
 InitializationCell->True],
Cell[100728, 2709, 1617, 38, 49, "Input",
 InitializationCell->True],
Cell[102348, 2749, 158, 2, 27, "Text",
 InitializationCell->True],
Cell[102509, 2753, 287, 4, 27, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[102799, 2759, 1350, 35, 71, "Input",
 InitializationCell->True],
Cell[104152, 2796, 3120, 68, 89, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[107309, 2869, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[107441, 2873, 857, 18, 28, "Input",
 InitializationCell->True],
Cell[108301, 2893, 1525, 33, 50, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109875, 2932, 185, 3, 34, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[110085, 2939, 140, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[110250, 2945, 1666, 32, 54, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[111919, 2979, 2721, 56, 59, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[114643, 3037, 2205, 52, 70, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[116863, 3092, 261, 6, 27, "Text",
 InitializationCell->True],
Cell[117127, 3100, 1127, 34, 54, "Input",
 InitializationCell->True],
Cell[118257, 3136, 1326, 31, 35, "Input",
 InitializationCell->True],
Cell[119586, 3169, 3338, 70, 74, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[122961, 3244, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[123093, 3248, 1086, 21, 32, "Input",
 InitializationCell->True],
Cell[124182, 3271, 901, 25, 32, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125132, 3302, 137, 2, 34, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[125294, 3308, 140, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[125459, 3314, 2030, 40, 54, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[127492, 3356, 2160, 52, 70, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[129667, 3411, 261, 6, 27, "Text",
 InitializationCell->True],
Cell[129931, 3419, 1133, 22, 49, "Input",
 InitializationCell->True],
Cell[131067, 3443, 838, 19, 35, "Input",
 InitializationCell->True],
Cell[131908, 3464, 2995, 65, 74, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[134940, 3534, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[135072, 3538, 813, 15, 35, "Input",
 InitializationCell->True],
Cell[135888, 3555, 884, 24, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[136833, 3586, 203, 3, 67, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[137061, 3593, 135, 2, 34, "Subsection",
 InitializationCell->True],
Cell[137199, 3597, 305, 10, 32, "Text",
 InitializationCell->True],
Cell[137507, 3609, 689, 19, 51, "Input",
 InitializationCell->True],
Cell[138199, 3630, 905, 23, 49, "Input",
 InitializationCell->True],
Cell[139107, 3655, 1747, 38, 48, "Input",
 InitializationCell->True],
Cell[140857, 3695, 1850, 40, 49, "Input",
 InitializationCell->True],
Cell[142710, 3737, 875, 23, 30, "Input",
 InitializationCell->True],
Cell[143588, 3762, 355, 8, 30, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[143980, 3775, 137, 2, 34, "Subsection",
 InitializationCell->True],
Cell[144120, 3779, 425, 11, 32, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[144570, 3794, 309, 5, 29, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[144904, 3803, 2658, 66, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[147565, 3871, 3764, 99, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[151332, 3972, 3599, 98, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[154946, 4073, 308, 7, 32, "Text",
 InitializationCell->True],
Cell[155257, 4082, 2905, 83, 145, "Input",
 InitializationCell->True],
Cell[158165, 4167, 158, 2, 32, "Text",
 InitializationCell->True],
Cell[158326, 4171, 287, 4, 32, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[158616, 4177, 1234, 34, 32, "Input",
 InitializationCell->True],
Cell[159853, 4213, 300, 9, 32, "Text",
 InitializationCell->True],
Cell[160156, 4224, 680, 21, 32, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[160861, 4249, 2916, 73, 77, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[163780, 4324, 3198, 79, 77, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[166993, 4406, 288, 6, 32, "Text",
 InitializationCell->True],
Cell[167284, 4414, 404, 13, 32, "Input",
 InitializationCell->True],
Cell[167691, 4429, 1297, 36, 32, "Input",
 InitializationCell->True],
Cell[168991, 4467, 3376, 79, 77, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[172404, 4551, 129, 2, 29, "Subsubsection",
 InitializationCell->True],
Cell[172536, 4555, 794, 17, 32, "Input",
 InitializationCell->True],
Cell[173333, 4574, 1442, 34, 55, "Input",
 InitializationCell->True],
Cell[174778, 4610, 1568, 37, 55, "Input",
 InitializationCell->True],
Cell[176349, 4649, 1469, 32, 55, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[177867, 4687, 185, 3, 26, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[178077, 4694, 140, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[178242, 4700, 2442, 59, 100, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[180687, 4761, 4465, 111, 203, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[185155, 4874, 4226, 116, 248, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[189396, 4993, 261, 6, 27, "Text",
 InitializationCell->True],
Cell[189660, 5001, 2026, 62, 93, "Input",
 InitializationCell->True],
Cell[191689, 5065, 235, 5, 27, "Text",
 InitializationCell->True],
Cell[191927, 5072, 533, 15, 36, "Input",
 InitializationCell->True],
Cell[192463, 5089, 1246, 31, 71, "Input",
 InitializationCell->True],
Cell[193712, 5122, 3599, 80, 91, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[197348, 5207, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[197480, 5211, 1028, 20, 35, "Input",
 InitializationCell->True],
Cell[198511, 5233, 875, 24, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[199435, 5263, 137, 2, 34, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[199597, 5269, 140, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[199762, 5275, 2980, 74, 99, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[202745, 5351, 4176, 115, 248, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[206936, 5469, 261, 6, 27, "Text",
 InitializationCell->True],
Cell[207200, 5477, 1660, 41, 66, "Input",
 InitializationCell->True],
Cell[208863, 5520, 235, 5, 27, "Text",
 InitializationCell->True],
Cell[209101, 5527, 482, 14, 36, "Input",
 InitializationCell->True],
Cell[209586, 5543, 772, 18, 35, "Input",
 InitializationCell->True],
Cell[210361, 5563, 3177, 72, 91, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[213575, 5640, 129, 2, 25, "Subsubsection",
 InitializationCell->True],
Cell[213707, 5644, 759, 14, 35, "Input",
 InitializationCell->True],
Cell[214469, 5660, 1371, 29, 35, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[215901, 5696, 131, 2, 67, "Section",
 InitializationCell->True],
Cell[216035, 5700, 322, 9, 29, "Text",
 InitializationCell->True],
Cell[216360, 5711, 264, 8, 30, "Input",
 InitializationCell->True],
Cell[216627, 5721, 820, 24, 52, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[217484, 5750, 172, 3, 67, "Section",
 InitializationCell->True],
Cell[217659, 5755, 169, 2, 27, "Text",
 InitializationCell->True],
Cell[217831, 5759, 2407, 53, 81, "Input",
 InitializationCell->True],
Cell[220241, 5814, 766, 18, 48, "Input",
 InitializationCell->True],
Cell[221010, 5834, 187, 4, 27, "Text",
 InitializationCell->True],
Cell[221200, 5840, 591, 18, 30, "Input",
 InitializationCell->True],
Cell[221794, 5860, 181, 4, 27, "Text",
 InitializationCell->True],
Cell[221978, 5866, 3020, 73, 119, "Input",
 InitializationCell->True],
Cell[225001, 5941, 195, 4, 27, "Text",
 InitializationCell->True],
Cell[225199, 5947, 596, 17, 30, "Input",
 InitializationCell->True],
Cell[225798, 5966, 150, 2, 27, "Text",
 InitializationCell->True],
Cell[225951, 5970, 1049, 25, 28, "Input",
 InitializationCell->True],
Cell[227003, 5997, 218, 5, 27, "Text",
 InitializationCell->True],
Cell[227224, 6004, 2734, 69, 98, "Input",
 InitializationCell->True],
Cell[229961, 6075, 211, 5, 27, "Text",
 InitializationCell->True],
Cell[230175, 6082, 1255, 36, 47, "Input",
 InitializationCell->True],
Cell[231433, 6120, 2577, 66, 89, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[234047, 6191, 173, 3, 67, "Section",
 InitializationCell->True],
Cell[234223, 6196, 188, 4, 27, "Text",
 InitializationCell->True],
Cell[234414, 6202, 617, 14, 30, "Input",
 InitializationCell->True],
Cell[235034, 6218, 176, 5, 30, "Input",
 InitializationCell->True],
Cell[235213, 6225, 236, 5, 27, "Text",
 InitializationCell->True],
Cell[235452, 6232, 12025, 329, 373, "Input",
 InitializationCell->True],
Cell[247480, 6563, 195, 4, 27, "Text",
 InitializationCell->True],
Cell[247678, 6569, 333, 9, 35, "Input",
 InitializationCell->True],
Cell[248014, 6580, 348, 12, 29, "Text",
 InitializationCell->True],
Cell[248365, 6594, 215, 5, 27, "Text",
 InitializationCell->True],
Cell[248583, 6601, 1772, 37, 30, "Input",
 InitializationCell->True],
Cell[250358, 6640, 974, 23, 35, "Input",
 InitializationCell->True],
Cell[251335, 6665, 143, 2, 27, "Text",
 InitializationCell->True],
Cell[251481, 6669, 1168, 26, 30, "Input",
 InitializationCell->True],
Cell[252652, 6697, 1132, 27, 30, "Input",
 InitializationCell->True],
Cell[253787, 6726, 234, 5, 27, "Text",
 InitializationCell->True],
Cell[254024, 6733, 3137, 72, 151, "Input",
 InitializationCell->True],
Cell[257164, 6807, 232, 5, 27, "Text",
 InitializationCell->True],
Cell[257399, 6814, 385, 10, 30, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[257809, 6828, 141, 2, 34, "Subsection",
 InitializationCell->True],
Cell[257953, 6832, 950, 23, 35, "Input",
 InitializationCell->True],
Cell[258906, 6857, 293, 8, 28, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[259236, 6870, 132, 2, 34, "Subsection",
 InitializationCell->True],
Cell[259371, 6874, 1434, 40, 56, "Input",
 InitializationCell->True],
Cell[260808, 6916, 287, 8, 28, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
