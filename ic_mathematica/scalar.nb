(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     84960,       2250]
NotebookOptionsPosition[     80331,       2114]
NotebookOutlinePosition[     80949,       2136]
CellTagsIndexPosition[     80906,       2133]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[RawData[""], "Title",
 CellChangeTimes->{3.462883514456135*^9}],

Cell[CellGroupData[{

Cell["Massive Neutrinos", "Subtitle",
 CellChangeTimes->{{3.444562276749201*^9, 3.444562286363826*^9}, {
   3.445002605125948*^9, 3.445002607596531*^9}, {3.445006999305208*^9, 
   3.445007007743311*^9}, {3.445332329625093*^9, 3.4453323309024487`*^9}, {
   3.44533296110108*^9, 3.4453329679608097`*^9}, {3.447584633662448*^9, 
   3.4475846345520897`*^9}, 3.46288351445697*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Initialization", "Section"]], "Section",
 CellChangeTimes->{{3.443800239133483*^9, 3.443800242903244*^9}, 
   3.462883514457518*^9}],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<magnetic`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.445170111196775*^9, 3.445170132025473*^9}, {
   3.445332975852935*^9, 3.4453329786852217`*^9}, {3.447677688461997*^9, 
   3.447677690719285*^9}, {3.4531066742428827`*^9, 3.4531066779096613`*^9}, 
   3.462883514458632*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}], "]"}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.441625573508712*^9, 3.441625575746928*^9}, {
   3.441625619197209*^9, 3.441625622744987*^9}, {3.441625685432925*^9, 
   3.4416256868874617`*^9}, {3.4421471984134073`*^9, 3.442147201505908*^9}, {
   3.4421472662977858`*^9, 3.442147266634595*^9}, {3.44362619212748*^9, 
   3.44362622881428*^9}, {3.443777303390203*^9, 3.443777305985528*^9}, 
   3.443793114941895*^9, {3.443800155580203*^9, 3.4438001707056313`*^9}, 
   3.462883514467396*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\"\<dseries`*\>\"", "]"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.443800175920138*^9, {3.447572469858817*^9, 3.447572476929056*^9}, 
   3.462883514471573*^9}],

Cell[BoxData[
 RowBox[{"<<", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<dseries.m\>\""}], 
   ")"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.443777308480987*^9, 3.443777319311777*^9}, 
   3.443793114947034*^9, 3.443800155580368*^9, {3.443982384565901*^9, 
   3.443982401906034*^9}, {3.4475724610129423`*^9, 3.4475724730189447`*^9}, {
   3.4518270873543873`*^9, 3.451827087599469*^9}, 3.462883514475814*^9, {
   3.467412925666829*^9, 3.46741292600219*^9}}],

Cell[BoxData[
 RowBox[{"<<", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<gaugeinvariant.m\>\""}], ")"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.443777308480987*^9, 3.443777319311777*^9}, 
   3.443793114947034*^9, 3.443800155580368*^9, {3.443982384565901*^9, 
   3.443982401906034*^9}, {3.445002473072509*^9, 3.4450024779641733`*^9}, 
   3.461053558080097*^9, 3.4628820437411327`*^9, 3.4628835144800587`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matter and Radiation", "Section",
 CellChangeTimes->{{3.4441125903779097`*^9, 3.4441125949428463`*^9}, 
   3.4628835144908857`*^9}],

Cell[CellGroupData[{

Cell["Background bits", "Subsection",
 CellChangeTimes->{{3.444133816683442*^9, 3.4441338211325502`*^9}, 
   3.462883514491037*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kc", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.443518141874385*^9, 3.443518260708337*^9}, {
   3.443526713922646*^9, 3.443526758861496*^9}, {3.443787815263904*^9, 
   3.443787824828084*^9}, 3.4437931150956573`*^9, {3.443961424369553*^9, 
   3.443961511040667*^9}, 3.443979825109785*^9, 3.4441337816185102`*^9, {
   3.444137557163439*^9, 3.4441375812798862`*^9}, {3.445070617131624*^9, 
   3.445070617368647*^9}, {3.445166819652246*^9, 3.445166828475709*^9}, {
   3.4452465691107473`*^9, 3.445246577649969*^9}, {3.445333073868775*^9, 
   3.445333074570256*^9}, {3.4453424727276487`*^9, 3.4453424827633877`*^9}, {
   3.445345060243222*^9, 3.445345062085281*^9}, 3.4453452198384333`*^9, 
   3.462883514491967*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"funcsubs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"hubble", ",", 
      RowBox[{"defvar", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", "b", ",", "n", ",", "\[Nu]", ",", "\[Gamma]"}], 
        "}"}], "]"}], ",", "antsub"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.445166835043935*^9, 3.445166871450637*^9}, {
   3.4453330648854713`*^9, 3.4453330678275957`*^9}, {3.445339888071504*^9, 
   3.445339890088819*^9}, {3.445342459785746*^9, 3.445342460388582*^9}, {
   3.445344679629923*^9, 3.44534468111655*^9}, {3.445344777703734*^9, 
   3.445344784653933*^9}, {3.447567183146502*^9, 3.4475672115314817`*^9}, {
   3.447569143880807*^9, 3.447569151546178*^9}, {3.447576020483142*^9, 
   3.447576022826174*^9}, {3.4475763311228743`*^9, 3.4475763319891367`*^9}, {
   3.447581215008515*^9, 3.447581222715179*^9}, {3.447584645625285*^9, 
   3.44758465011754*^9}, {3.448369862488043*^9, 3.4483698626021357`*^9}, {
   3.448964733137867*^9, 3.4489647391421328`*^9}, {3.448965211162331*^9, 
   3.448965211390113*^9}, {3.448965261624916*^9, 3.448965291765099*^9}, {
   3.449219008101713*^9, 3.449219011088788*^9}, 3.462883514509959*^9, {
   3.463756391874008*^9, 3.4637563927653103`*^9}}],

Cell["\<\
Solve for the background solution. There are multiple solutions (as \
non-linear), so we pick the right one.\
\>", "Text",
 CellChangeTimes->{{3.444133871509181*^9, 3.444133901427288*^9}, 
   3.4628835145138397`*^9}],

Cell[BoxData[
 RowBox[{"eq1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Collect", "[", 
      RowBox[{"eq", ",", 
       RowBox[{"a", "[", "t", "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"a", "[", "t", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.447581660893141*^9, 3.44758169891437*^9}, {
   3.447581734010667*^9, 3.447581794148388*^9}, 3.447583428901334*^9, 
   3.462883514525791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq1", ",", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
     RowBox[{"Solve", "::", "ifun"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4475743948165293`*^9, 3.44757443036614*^9}, {
   3.447574487916366*^9, 3.447574553263048*^9}, {3.4475746028222713`*^9, 
   3.447574609535014*^9}, {3.44757550559938*^9, 3.447575519192789*^9}, {
   3.44757593061075*^9, 3.447575930834272*^9}, {3.44758102624372*^9, 
   3.447581116049015*^9}, {3.447581181914754*^9, 3.447581182056347*^9}, {
   3.4475813665594263`*^9, 3.447581484781201*^9}, {3.447581537900577*^9, 
   3.4475815406872396`*^9}, {3.4475815896776133`*^9, 3.447581590805279*^9}, {
   3.447581811382945*^9, 3.447581825058441*^9}, {3.447584706616007*^9, 
   3.4475847100438004`*^9}, {3.447584748879713*^9, 3.447584759222904*^9}, {
   3.447585499098258*^9, 3.44758551522058*^9}, {3.447585582250915*^9, 
   3.4475855983631067`*^9}, {3.447588128076496*^9, 3.447588129855495*^9}, 
   3.4628835145346327`*^9}],

Cell[BoxData[
 RowBox[{"ssol", "=", 
  RowBox[{"Union", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"msimp2", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], "//.", "sl"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "8"}], "}"}]}], "]"}], "/.", 
      RowBox[{"R\[Gamma]", "\[Rule]", 
       RowBox[{"1", "-", "R\[Nu]", "-", "Rn"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", ">", "0"}], ",", 
       RowBox[{"R\[Nu]", "<", "1"}], ",", 
       RowBox[{"omm", ">", "0"}], ",", 
       RowBox[{"H0", ">", "0"}], ",", 
       RowBox[{"a0", ">", "0"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.44758187181822*^9, 3.447581885789546*^9}, {
   3.447582790325082*^9, 3.447582802868421*^9}, {3.447582837847193*^9, 
   3.447582900725232*^9}, {3.447583486475189*^9, 3.4475834998474817`*^9}, {
   3.447583540799074*^9, 3.447583574409418*^9}, {3.447583666266798*^9, 
   3.447583678766038*^9}, {3.447588133928006*^9, 3.44758813433007*^9}, {
   3.447588184061925*^9, 3.447588226520608*^9}, {3.44758828449823*^9, 
   3.447588336423689*^9}, {3.447588537406083*^9, 3.447588544108274*^9}, {
   3.448369872614958*^9, 3.4483698893019667`*^9}, {3.448964945177455*^9, 
   3.448964953828755*^9}, {3.449906805930751*^9, 3.449906868403799*^9}, {
   3.449907102391561*^9, 3.4499071417290487`*^9}, {3.449929864693489*^9, 
   3.449929867310699*^9}, {3.449930054553412*^9, 3.449930055235491*^9}, {
   3.449934646237468*^9, 3.449934660000568*^9}, 3.462883514538451*^9, {
   3.463756400017757*^9, 3.463756400662705*^9}}],

Cell["\<\
Select the third equation as the actual solution (the +ve one), make it a \
normal expression as it is exact, this way the series solver doens't truncate \
everything at lower order.\
\>", "Text",
 CellChangeTimes->{{3.444133963667965*^9, 3.444134011339695*^9}, {
   3.444134045369959*^9, 3.444134094343719*^9}, 3.462883514556999*^9}],

Cell[BoxData[
 RowBox[{"bsol", "=", 
  RowBox[{"mkpure", "[", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"Normal", "[", 
     RowBox[{"ssol", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4441341008017483`*^9, 3.444134117500265*^9}, {
   3.4443980446521072`*^9, 3.444398048888727*^9}, {3.445333346421934*^9, 
   3.4453333483190947`*^9}, {3.447588561122703*^9, 3.447588571829179*^9}, {
   3.448964970294887*^9, 3.448964970402863*^9}, {3.449907149887917*^9, 
   3.449907150146796*^9}, {3.4499299555967903`*^9, 3.449929979635508*^9}, {
   3.449930043458503*^9, 3.449930072756525*^9}, {3.4499347538920116`*^9, 
   3.449934754028273*^9}, {3.4518272314685497`*^9, 3.451827233066165*^9}, {
   3.461053641827414*^9, 3.46105364386064*^9}, {3.461053707868168*^9, 
   3.461053712526575*^9}, {3.461058981475193*^9, 3.461058983804199*^9}, {
   3.4610590815297832`*^9, 3.4610590830876913`*^9}, 3.462883514557131*^9, 
   3.4637563816096373`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Synchronous Gauge", "Subsection",
 CellChangeTimes->{{3.444113966891231*^9, 3.4441139700869923`*^9}, {
   3.444116623683776*^9, 3.444116626884049*^9}, 3.444136726584606*^9, 
   3.4443970901432457`*^9, {3.4450702786174927`*^9, 3.445070281382442*^9}, 
   3.4492176220156193`*^9, 3.449911843380185*^9, 3.462883514566153*^9}],

Cell["Set up gauge fixing substitutions", "Text",
 CellChangeTimes->{{3.445002911463447*^9, 3.445002918270876*^9}, 
   3.449217622015914*^9, 3.449911843381402*^9, 3.462883514566412*^9}],

Cell[BoxData[
 RowBox[{"fixsubsyn", ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gaugevar", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "n", ",", "\[Nu]", ",", "\[Gamma]"}], 
       "}"}], "]"}], ",", "hubble", ",", 
     RowBox[{"defvar", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "n", ",", "\[Nu]", ",", "\[Gamma]"}], 
       "}"}], "]"}], ",", "bsol", ",", "synsub", ",", "antsub"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.445002922812468*^9, 3.4450029664117393`*^9}, {
   3.445003180071327*^9, 3.445003180914235*^9}, {3.445007457309368*^9, 
   3.445007468078937*^9}, {3.445070286142455*^9, 3.4450702872637033`*^9}, {
   3.445072747896411*^9, 3.445072748327194*^9}, {3.44517285309039*^9, 
   3.445172856148243*^9}, {3.445176635672333*^9, 3.445176635931588*^9}, {
   3.445338775498927*^9, 3.445338777661064*^9}, {3.445342585798378*^9, 
   3.445342586301111*^9}, {3.445344668923609*^9, 3.445344669048689*^9}, {
   3.4453447938367863`*^9, 3.4453447945139112`*^9}, {3.44758894735429*^9, 
   3.447588947632663*^9}, {3.4475919332131147`*^9, 3.44759193672653*^9}, 
   3.447592182545005*^9, {3.4483699429551497`*^9, 3.44836994306427*^9}, {
   3.448964754561084*^9, 3.4489647641885033`*^9}, 3.4492176220165462`*^9, 
   3.4499118433826027`*^9, {3.451827305450057*^9, 3.451827312344697*^9}, {
   3.461053678543429*^9, 3.461053679994657*^9}, {3.461053872254257*^9, 
   3.461053903441725*^9}, {3.46105402402211*^9, 3.461054029669113*^9}, {
   3.461059091425479*^9, 3.461059093362486*^9}, 3.461059317980749*^9, {
   3.461059389533828*^9, 3.4610593906296797`*^9}, 3.462883514567605*^9, 
   3.4637563872919188`*^9, {3.463756435211721*^9, 3.463756436400189*^9}, {
   3.463757868887684*^9, 3.46375787334593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varssyn", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"fixvar", "[", 
     RowBox[{"{", 
      RowBox[{"synvars", ",", "cdmvars", ",", 
       RowBox[{"sfnuvars", "[", "3", "]"}], ",", 
       RowBox[{"slnuvars", "[", "3", "]"}], ",", "baryonvars", ",", 
       "photonvars"}], "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.445003012409791*^9, 3.445003028433296*^9}, {
   3.445003063439734*^9, 3.4450031051175537`*^9}, {3.445007483785283*^9, 
   3.445007488589114*^9}, {3.4450702931743097`*^9, 3.445070294471384*^9}, {
   3.445072756862402*^9, 3.445072766405829*^9}, {3.4451766387838507`*^9, 
   3.4451766390429153`*^9}, {3.44533934587484*^9, 3.445339353730441*^9}, {
   3.4453425937740507`*^9, 3.445342595761085*^9}, {3.445344656609317*^9, 
   3.445344658853424*^9}, {3.445344761168399*^9, 3.445344765019745*^9}, {
   3.447588985527854*^9, 3.447588986422826*^9}, {3.447675859316608*^9, 
   3.4476758638127337`*^9}, {3.448369947904747*^9, 3.448369948288069*^9}, 
   3.449217622016987*^9, 3.449911843387227*^9, {3.4518273298711433`*^9, 
   3.4518273307262897`*^9}, {3.451827423469631*^9, 3.4518274238026733`*^9}, {
   3.452590649143512*^9, 3.4525906561615953`*^9}, {3.452863671333897*^9, 
   3.452863671507251*^9}, {3.452934109987845*^9, 3.452934124867674*^9}, {
   3.462881891973001*^9, 3.462881892706238*^9}, 3.462883514571988*^9, {
   3.463756441360035*^9, 3.4637564445240173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqnssyn", "=", 
   RowBox[{"msimp2", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cons1", ",", "cons2", ",", "dyn2", ",", "cdm", ",", 
         RowBox[{"sfnu", "[", "3", "]"}], ",", 
         RowBox[{"slnu", "[", "3", "]"}], ",", "tight"}], "}"}], "//.", 
       "fixsubsyn"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.445003108834991*^9, 3.445003172651479*^9}, {
   3.445003273306736*^9, 3.44500329815805*^9}, {3.445007503181744*^9, 
   3.445007551148587*^9}, 3.445069446275646*^9, {3.445072780599984*^9, 
   3.445072800348583*^9}, {3.445072860437874*^9, 3.445072860647303*^9}, {
   3.445176643887616*^9, 3.445176654714938*^9}, 3.4451856431579123`*^9, {
   3.445244337761262*^9, 3.44524433786733*^9}, 3.44524558785052*^9, {
   3.445339361065353*^9, 3.445339364425321*^9}, {3.445340481927142*^9, 
   3.4453404870676737`*^9}, {3.445342599905645*^9, 3.445342601081594*^9}, {
   3.445344630519559*^9, 3.44534464853503*^9}, 3.44534470458435*^9, {
   3.445344767490699*^9, 3.445344771655014*^9}, {3.445344842531536*^9, 
   3.445344844312126*^9}, {3.44534495230011*^9, 3.445344965994237*^9}, {
   3.4453451006804123`*^9, 3.445345111020447*^9}, {3.4453451727563457`*^9, 
   3.44534519063159*^9}, {3.44534656428018*^9, 3.44534656471244*^9}, {
   3.447589017811988*^9, 3.447589018170388*^9}, {3.4476700486923237`*^9, 
   3.4476700659412003`*^9}, {3.448369950890033*^9, 3.448369960690063*^9}, 
   3.449217622017601*^9, {3.449485335742399*^9, 3.4494853376289473`*^9}, 
   3.44991184339168*^9, {3.451827335391096*^9, 3.451827336030774*^9}, {
   3.452863673878126*^9, 3.4528636828756323`*^9}, {3.452934104075897*^9, 
   3.452934129708686*^9}, {3.45440687215863*^9, 3.4544068752040854`*^9}, {
   3.4544076090473623`*^9, 3.4544076099934397`*^9}, {3.4544088920002337`*^9, 
   3.454408893537175*^9}, 3.454410504374908*^9, {3.4547422506352587`*^9, 
   3.454742251582757*^9}, {3.45474246417694*^9, 3.4547424656585007`*^9}, {
   3.4547439135562687`*^9, 3.4547439144040003`*^9}, {3.454755227633357*^9, 
   3.454755229842998*^9}, {3.454841805765003*^9, 3.4548418079614687`*^9}, {
   3.461059137405931*^9, 3.4610591501068487`*^9}, {3.4628818955668716`*^9, 
   3.462881896215427*^9}, 3.462883514576721*^9, {3.4637564509537077`*^9, 
   3.4637564592955027`*^9}}],

Cell["\<\
Solutions. As gauge mode is present apply another initial conditions h[0]=0 \
to remove it.\
\>", "Text",
 CellChangeTimes->{{3.445070410182165*^9, 3.445070435583961*^9}, 
   3.449217622019004*^9, 3.4499118433951797`*^9, 3.462883514580277*^9}],

Cell["Solve with adiabatic initial conditions.", "Text",
 CellChangeTimes->{{3.4450699133851748`*^9, 3.44506992882185*^9}, 
   3.4492176220191317`*^9, 3.449911843395343*^9, 3.462883514580412*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rmden", "[", "ls_List", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"rmden", ",", "ls"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmden", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    RowBox[{"Together", "[", 
     RowBox[{"a", "-", "b"}], "]"}], "]"}], "\[Equal]", "0"}]}]}], "Input",
 CellChangeTimes->{{3.449301120487876*^9, 3.449301161103217*^9}, {
   3.449301504367216*^9, 3.449301522474679*^9}, {3.44930174022606*^9, 
   3.449301774776939*^9}, {3.449301813293762*^9, 3.449301819871887*^9}, 
   3.449911843396386*^9, 3.462883514581458*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rde", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"msimp2", "[", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"rmden", "[", "eqnssyn", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.449301778630765*^9, 3.449301786906345*^9}, {
   3.4493018334926023`*^9, 3.449301890020701*^9}, 3.4499118434008703`*^9, {
   3.4610619637385674`*^9, 3.461061970402358*^9}, 3.462883514594795*^9}],

Cell["\<\
Check to see if two solutions are identical (i.e. see if there is a \
consistent relationship between the constants).\
\>", "Text",
 CellChangeTimes->{{3.449405637994424*^9, 3.449405674654892*^9}, 
   3.449911843404389*^9, 3.462883514618544*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combrule", "[", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"a1_", "\[Rule]", "b1_"}], "]"}], ",", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"a2_", "\[Rule]", "b2_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"b1", "\[Equal]", "b2"}]}]], "Input",
 CellChangeTimes->{{3.449396637618*^9, 3.449396684361043*^9}, 
   3.4499118434053392`*^9, 3.462883514619553*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"identicalsol", "[", 
   RowBox[{"sol1_", ",", "sol2_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{"combrule", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sol1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sol2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//.", 
           RowBox[{
            RowBox[{"var", "[", "n_", "]"}], "\[Rule]", 
            RowBox[{"e", "[", "n", "]"}]}]}], ")"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Union", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{"sol1", ",", 
        RowBox[{"var", "[", "_", "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.449396486402547*^9, 3.449396501664857*^9}, {
   3.449396538618101*^9, 3.449396634981366*^9}, {3.449396772986208*^9, 
   3.4493968728192987`*^9}, {3.449397024560856*^9, 3.449397027762012*^9}, {
   3.449740328139017*^9, 3.449740328270879*^9}, {3.449844108862253*^9, 
   3.449844123675193*^9}, 3.4499118434100943`*^9, 3.462883514624427*^9}],

Cell["Prefixing bits and bobs.", "Text",
 CellChangeTimes->{{3.449405688361326*^9, 3.449405694518507*^9}, 
   3.449911843413608*^9, 3.462883514627947*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{"ls_List", ",", "str_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"prfwk", "[", 
       RowBox[{"#", ",", "str"}], "]"}], "&"}], ",", "ls"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{"x_Symbol", ",", "str_"}], "]"}], ":=", 
   RowBox[{"Symbol", "[", 
    RowBox[{"str", "<>", 
     RowBox[{"SymbolName", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"x_", ",", "n__"}], "]"}], ",", "str_"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"str", "<>", 
       RowBox[{"SymbolName", "[", "x", "]"}]}], "]"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prfwk", "[", 
   RowBox[{"x_", ",", "str_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], ",", "str"}], "]"}], "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", 
     RowBox[{"Level", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4482011982622128`*^9, 3.448201380961186*^9}, {
   3.448201477243189*^9, 3.448201526410407*^9}, {3.448201556720994*^9, 
   3.448201556938608*^9}, 3.448201606340026*^9, {3.4494057212163687`*^9, 
   3.4494057568437967`*^9}, 3.4499118434152737`*^9, 3.4628835146296062`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"varsep", "[", 
    RowBox[{"ls_List", ",", "ev_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"varsep", "[", 
       RowBox[{"#", ",", "ev"}], "]"}], "&"}], ",", "ls"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsep", "[", 
   RowBox[{"var_", ",", "ev_"}], "]"}], ":=", 
  RowBox[{"var", "->", 
   RowBox[{
    RowBox[{"prfwk", "[", 
     RowBox[{"var", ",", "\"\<z\>\""}], "]"}], "+", 
    RowBox[{"ev", " ", 
     RowBox[{"prfwk", "[", 
      RowBox[{"var", ",", "\"\<f\>\""}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.4494029077276382`*^9, 3.449402964342373*^9}, {
   3.449403009190057*^9, 3.449403011118037*^9}, {3.449403115107366*^9, 
   3.449403144676003*^9}, 3.4499118434198713`*^9, 3.462883514634204*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eqsep", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eqsep", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], "&"}], ",", 
     "ls"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqsep", "[", 
   RowBox[{
    RowBox[{"a_", "\[Equal]", "b_"}], ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"a", "-", "b"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], ",", "x"}], 
     "]"}], "\[Equal]", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4494033919023323`*^9, 3.449403444703335*^9}, {
   3.4494034816264668`*^9, 3.449403555337381*^9}, {3.449403727662798*^9, 
   3.4494037367672377`*^9}, {3.4494038017289953`*^9, 3.449403815816579*^9}, 
   3.449911843424634*^9, 3.4628835146390867`*^9}],

Cell[TextData[{
 "Seperate the equations up to linear order in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["m", "n"], "2"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.449405865395656*^9, 3.449405884688809*^9}, 
   3.4499118434293222`*^9, 3.462883514643969*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{"eqsep", "[", 
    RowBox[{
     RowBox[{"rde", "//.", 
      RowBox[{"mkpure", "[", 
       RowBox[{"varsep", "[", 
        RowBox[{"varssyn", ",", 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.449403838273947*^9, 3.449403879149241*^9}, {
   3.449403912595508*^9, 3.449403921918516*^9}, {3.4494039959654713`*^9, 
   3.449404000789456*^9}, 3.4499118434305363`*^9, {3.452876408751809*^9, 
   3.452876408900793*^9}, 3.4628835146451883`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "eq1", "]"}], ",", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "]"}], ",", 
     RowBox[{"omr", ">", "0"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.452861140578559*^9, 3.452861243826249*^9}, {
   3.452863725883465*^9, 3.452863741520987*^9}, {3.4528764112303762`*^9, 
   3.452876414271614*^9}, 3.4528769965604477`*^9, {3.461062498249983*^9, 
   3.461062500201087*^9}, 3.46288351465112*^9}],

Cell["Get the zeroth order equations.", "Text",
 CellChangeTimes->{{3.449405920885398*^9, 3.4494059364423733`*^9}, {
   3.449405970163059*^9, 3.449405970498189*^9}, 3.449911843435519*^9, 
   3.462883514654776*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"prfwk", "[", 
       RowBox[{"varssyn", ",", "\"\<z\>\""}], "]"}], ",", 
      RowBox[{"prfwk", "[", 
       RowBox[{"varssyn", ",", "\"\<f\>\""}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.449405985137431*^9, 3.44940601803258*^9}, {
   3.449495737304554*^9, 3.4494957412208*^9}, 3.449911843441182*^9, {
   3.4528764314090843`*^9, 3.452876459877008*^9}, 3.462883514655778*^9}],

Cell[BoxData[
 RowBox[{"Settiming", "[", "True", "]"}]], "Input",
 CellChangeTimes->{{3.449735229585229*^9, 3.4497352378852367`*^9}, 
   3.449911843445551*^9, 3.462883514669685*^9}],

Cell[BoxData[
 RowBox[{"Changeorder", "[", 
  RowBox[{"8", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.44973524309647*^9, 3.449735243323517*^9}, {
   3.449735291708096*^9, 3.4497353029971237`*^9}, 3.449911843451694*^9, {
   3.45286136090307*^9, 3.452861361830551*^9}, {3.452866958342491*^9, 
   3.452866960268372*^9}, {3.452876469149296*^9, 3.4528764692263308`*^9}, {
   3.452934200340118*^9, 3.452934200443468*^9}, {3.4529390716621437`*^9, 
   3.452939071858656*^9}, 3.452942427002638*^9, {3.4531164660473747`*^9, 
   3.45311647672005*^9}, {3.454406887704221*^9, 3.454406888221414*^9}, 
   3.462883514675723*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"scfile", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<mag3_1_4.dat\>\""}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.452876580635154*^9, 3.452876615650681*^9}, {
   3.452934085810904*^9, 3.4529340901391277`*^9}, {3.452939077379903*^9, 
   3.452939079043342*^9}, {3.452942392540894*^9, 3.452942392628192*^9}, {
   3.4531094185870533`*^9, 3.453109420146112*^9}, {3.453116489655986*^9, 
   3.4531164900243177`*^9}, {3.454406893711912*^9, 3.4544068938463078`*^9}, {
   3.454408955655464*^9, 3.4544089560751543`*^9}, {3.454755286995451*^9, 
   3.454755289861514*^9}, {3.454839893380855*^9, 3.454839893658538*^9}, {
   3.461054133859227*^9, 3.4610541379229727`*^9}, {3.4628822359519243`*^9, 
   3.4628822360184183`*^9}, 3.4628835146801147`*^9, {3.4628837930414057`*^9, 
   3.4628837931786757`*^9}, {3.46625441914861*^9, 3.466254424690007*^9}, {
   3.466255426993086*^9, 3.466255427110365*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solc", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "scfile", "]"}], ",", 
     RowBox[{"Get", "[", "scfile", "]"}], ",", 
     RowBox[{"DSeries", "[", 
      RowBox[{"eq2", ",", "var", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.452876573613624*^9, 3.4528765776004667`*^9}, {
   3.45287673709766*^9, 3.45287676633871*^9}, {3.453116493770091*^9, 
   3.4531164997609587`*^9}, {3.454407589375782*^9, 3.45440759000287*^9}, {
   3.4544076811009293`*^9, 3.454407681487486*^9}, {3.454408981309991*^9, 
   3.454408990984972*^9}, 3.4544105399641447`*^9, {3.454839878574498*^9, 
   3.45483987915152*^9}, {3.454841878898045*^9, 3.454841881538596*^9}, {
   3.462882215759171*^9, 3.46288222692912*^9}, {3.462883499101066*^9, 
   3.4628835146840076`*^9}, {3.462883926783286*^9, 3.462883933717515*^9}, {
   3.466254446283127*^9, 3.4662544496381397`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", "scfile", "]"}], ",", 
   RowBox[{"Print", "[", "\"\<File exists.\>\"", "]"}], ",", 
   RowBox[{"Put", "[", 
    RowBox[{"solc", ",", "scfile"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4528766780103197`*^9, 3.452876690794446*^9}, 
   3.452876739417861*^9, 3.4628835147533617`*^9}],

Cell["Reassemble solution", "Text",
 CellChangeTimes->{{3.4494105945503883`*^9, 3.449410601010234*^9}, 
   3.449911843622733*^9, 3.4628835147569523`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"csol", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"varsep", "[", 
      RowBox[{"varssyn", ",", 
       SuperscriptBox[
        SubscriptBox["m", "n"], "2"]}], "]"}], "/.", 
     RowBox[{"Flatten", "[", "solc", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4494105520516376`*^9, 3.44941057035559*^9}, {
   3.449410635042075*^9, 3.449410638323267*^9}, {3.449471726214342*^9, 
   3.4494717334472*^9}, {3.449472046151045*^9, 3.44947206584776*^9}, 
   3.449911843624037*^9, {3.449993872722911*^9, 3.449993921836329*^9}, {
   3.452876816345545*^9, 3.452876843196783*^9}, 3.462883514758011*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"truncorder", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"truncorder", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], "&"}], ",", 
     "ls"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"truncorder", "[", 
    RowBox[{
     RowBox[{"a_", "\[Rule]", "b_"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{"truncorder", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"truncorder", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"expr", "+", 
   RowBox[{
    RowBox[{"O", "[", 
     RowBox[{"x", "-", "x0"}], "]"}], "^", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{3.462883514763142*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expapply", "[", 
    RowBox[{"sol_", ",", "ic_", ",", "var_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "l1", ",", "ce", ",", "ce2", ",", "vl", ",", "vd", ",", "vs", ",", "vv",
        ",", "sv", ",", "si", ",", "sl", ",", "st", ",", "cs", ",", "rs", ",",
        "sc"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ce", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"msimp2", "[", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", 
           RowBox[{"ic", "//.", 
            RowBox[{"mkpure", "[", "sol", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ce", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "ce", "]"}], ",", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ce2", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"clist", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Equal]", "0"}], 
            "]"}], "&"}], ",", "ce"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vv", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{"sol", ",", 
          RowBox[{
           RowBox[{"f_", "[", "_", "]"}], "/;", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "var", "}"}], "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sv", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
          "&"}], ",", "ce2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sc", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
          "&"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"clist", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], ",", 
            RowBox[{"Flatten", "[", "sol", "]"}]}], "]"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"si", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SeriesCoefficient", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["m", "n"], ",", "0", ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}], "\[Equal]", "0"}], "&"}],
          ",", "sc"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"st", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"sv", ",", "si"}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "st", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sl", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Quiet", "[", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{"st", ",", "vv"}], "]"}], ",", 
          RowBox[{"Solve", "::", "svars"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "sl", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"cs", "=", 
       RowBox[{"Flatten", "[", "sl", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rs", "=", 
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"sol", "/.", "cs"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "rs"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
      "ce", ",", "ce2", ",", "vl", ",", "vs", ",", "vv", ",", "sv", ",", "sl",
        ",", "cs"}], "}"}], "*)"}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clist", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"_", ",", "_", ",", "ls_List", ",", "_", ",", "_", ",", "_"}], 
      "]"}], "]"}], "]"}], ":=", "ls"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"clist", "[", "expr_", "]"}], ":=", "expr"}]}], "Input",
 CellChangeTimes->{{3.452880591716803*^9, 3.4528806534589243`*^9}, {
   3.452880848856598*^9, 3.4528808945758343`*^9}, {3.45288122957858*^9, 
   3.4528812768960543`*^9}, {3.4528813329863377`*^9, 
   3.4528813340034437`*^9}, {3.452924821276586*^9, 3.452924853915715*^9}, {
   3.452933619297655*^9, 3.452933629534096*^9}, 3.462883514771028*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solutions", "Section",
 CellChangeTimes->{3.4628835147747498`*^9}],

Cell[CellGroupData[{

Cell["Adiabatic", "Subsubsection",
 CellChangeTimes->{3.462883514775508*^9}],

Cell[BoxData[
 RowBox[{"ad1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"expapply", "[", 
      RowBox[{
       RowBox[{"csol", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["s", "B"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["d", "B"], "\[Rule]", "0"}]}], "}"}]}], ",", 
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"adiabatic", "[", 
              RowBox[{"{", 
               RowBox[{
               "\[Gamma]", ",", "b", ",", "c", ",", "n", ",", "\[Nu]"}], 
               "}"}], "]"}], ",", 
             RowBox[{
              RowBox[{"\[Eta]", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{"h", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], "//.",
            "fixsubsyn"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       "c"}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rc", "\[Rule]", 
        RowBox[{"1", "-", "Rb"}]}], ",", 
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.4528791789427853`*^9, 3.4528791986436768`*^9}, {
   3.452879312026499*^9, 3.452879314238961*^9}, {3.4528793891376123`*^9, 
   3.452879394105085*^9}, 3.452879517711347*^9, {3.452933701930161*^9, 
   3.4529337052147408`*^9}, {3.4610632558081093`*^9, 3.461063276729455*^9}, {
   3.461063452477393*^9, 3.4610634702616568`*^9}, {3.461063563380842*^9, 
   3.461063563704483*^9}, {3.461063593894616*^9, 3.461063594422701*^9}, 
   3.4628835147782717`*^9, {3.46375734753312*^9, 3.463757348303481*^9}, {
   3.463808765137602*^9, 3.463808780737977*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neutrino density isocurvature", "Subsubsection",
 CellChangeTimes->{3.4628835147982616`*^9}],

Cell[BoxData[
 RowBox[{"ison1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"expapply", "[", 
      RowBox[{
       RowBox[{"csol", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["s", "B"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["d", "B"], "\[Rule]", "0"}]}], "}"}]}], ",", 
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"3", " ", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Delta]", "\[Gamma]"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "0", "]"}]}], "\[Equal]", 
              RowBox[{"4", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Delta]", "b"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "0", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "b"], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{"3", " ", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Delta]", "\[Gamma]"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "0", "]"}]}], "\[Equal]", 
              RowBox[{"4", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  SubscriptBox["\[Delta]", "c"], ")"}], "\[Prime]",
                 MultilineFunction->None], "[", "0", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "c"], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "n"], "[", "0", "]"}], "\[Equal]", 
              "1"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "\[Nu]"], "[", "0", "]"}], "\[Equal]",
               "1"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["v", "\[Nu]"], "[", "0", "]"}], "\[Equal]", 
              RowBox[{
               SubscriptBox["v", "n"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "0", "]"}], 
              "\[Equal]", 
              RowBox[{
               SubscriptBox["\[CapitalPi]", "n"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[Eta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"h", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"n", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"\[Nu]", ",", "3"}]], "[", "0", "]"}], "\[Equal]", 
              "0"}]}], "}"}], "//.", "fixsubsyn"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       "c"}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rc", "\[Rule]", 
        RowBox[{"1", "-", "Rb"}]}], ",", 
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.4528791789427853`*^9, 3.4528791986436768`*^9}, {
   3.452879312026499*^9, 3.452879314238961*^9}, {3.4528793891376123`*^9, 
   3.452879394105085*^9}, 3.452879517711347*^9, {3.452933701930161*^9, 
   3.4529337052147408`*^9}, {3.4610632558081093`*^9, 3.461063276729455*^9}, {
   3.461063609181068*^9, 3.461063642113566*^9}, 3.4628835148003397`*^9, {
   3.463827778020894*^9, 3.463827902717407*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neutrino velocity isocurvature", "Subsubsection",
 CellChangeTimes->{3.4628835148112183`*^9}],

Cell[TextData[{
 "One of the massive contributions at order ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["t", "3"], " "}], TraditionalForm]]],
 "is wrong (the whole thing doesn't satisfy the constraint equations, so I've \
truncated it to second order."
}], "Text",
 CellChangeTimes->{3.4628835148127117`*^9}],

Cell[BoxData[
 RowBox[{"isov1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"expapply", "[", 
      RowBox[{
       RowBox[{"csol", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["s", "B"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["d", "B"], "\[Rule]", "0"}]}], "}"}]}], ",", 
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["v", "n"], "[", "0", "]"}], "\[Equal]", "1"}], 
             ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["v", "\[Nu]"], "[", "0", "]"}], "\[Equal]", "1"}],
              ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "\[Gamma]"], "[", "0", "]"}], 
              "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "c"], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "b"], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{"\[Eta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "n"], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "\[Nu]"], "[", "0", "]"}], "\[Equal]",
               "0"}], ",", 
             RowBox[{
              RowBox[{"h", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "0", "]"}], 
              "\[Equal]", 
              RowBox[{
               SubscriptBox["\[CapitalPi]", "n"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"n", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"\[Nu]", ",", "3"}]], "[", "0", "]"}], "\[Equal]", 
              "0"}]}], "}"}], "//.", "fixsubsyn"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", "c", "}"}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rc", "\[Rule]", 
        RowBox[{"1", "-", "Rb"}]}], ",", 
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.45287933900977*^9, 3.452879361901305*^9}, 
   3.452879411106699*^9, {3.4528795275109863`*^9, 3.452879537610471*^9}, {
   3.452879620570614*^9, 3.452879625259453*^9}, 3.45287970278975*^9, {
   3.452879745361866*^9, 3.4528797463727827`*^9}, 3.452880069059697*^9, {
   3.452880478099279*^9, 3.452880486068563*^9}, {3.452883123982875*^9, 
   3.452883141895733*^9}, 3.452931685717482*^9, {3.4529317238927794`*^9, 
   3.452931729607655*^9}, {3.452931791821938*^9, 3.452931794082101*^9}, {
   3.452932065791789*^9, 3.452932078073732*^9}, {3.452940581355426*^9, 
   3.452940587513245*^9}, {3.4529409486000843`*^9, 3.4529409494701853`*^9}, {
   3.452943265423621*^9, 3.4529432723904*^9}, {3.4529433151883087`*^9, 
   3.45294331636473*^9}, {3.452944029605732*^9, 3.4529440319648952`*^9}, {
   3.4610636991765738`*^9, 3.461063712337624*^9}, {3.461063887193203*^9, 
   3.461063888121387*^9}, 3.4628835148151217`*^9, {3.4628851428873587`*^9, 
   3.4628851433420477`*^9}, {3.463816662164357*^9, 3.4638167019028893`*^9}, {
   3.463825789810321*^9, 3.463825799742278*^9}, {3.4638266276842327`*^9, 
   3.463826647952608*^9}, {3.463827886303536*^9, 3.4638278866092033`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CDM isocurvature", "Subsubsection",
 CellChangeTimes->{3.462883514827538*^9}],

Cell[BoxData[
 RowBox[{"isoc1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{"expapply", "[", 
     RowBox[{
      RowBox[{"csol", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["s", "B"], "\[Rule]", "0"}], ",", 
         RowBox[{
          SubscriptBox["d", "B"], "\[Rule]", "0"}]}], "}"}]}], ",", 
      RowBox[{"msimp2", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"isocurvature", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Gamma]", ",", "b", ",", "n", ",", "\[Nu]"}], "}"}], 
              ",", "c", ",", "\[Eta]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"h", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{
              SubscriptBox["F", 
               RowBox[{"n", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{
             RowBox[{
              SubscriptBox["F", 
               RowBox[{"\[Nu]", ",", "3"}]], "[", "0", "]"}], "\[Equal]", 
             "0"}], ",", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "0", "]"}], "==", 
             "0"}]}], "}"}], "//.", "fixsubsyn"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "c", "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.4528797550156193`*^9, 3.452879770361277*^9}, {
   3.452879849035246*^9, 3.4528798611228027`*^9}, {3.452944071033478*^9, 
   3.452944082205072*^9}, {3.461063928159474*^9, 3.461063951926537*^9}, 
   3.462883514829473*^9, {3.463811541432852*^9, 3.463811554020795*^9}, {
   3.463813261789298*^9, 3.463813268681509*^9}, {3.4638257649848433`*^9, 
   3.463825765090777*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Baryon isocurvature", "Subsubsection",
 CellChangeTimes->{3.462883514840035*^9}],

Cell[BoxData[
 RowBox[{"isob1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"expapply", "[", 
      RowBox[{
       RowBox[{"csol", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["s", "B"], "\[Rule]", "0"}], ",", 
          RowBox[{
           SubscriptBox["d", "B"], "\[Rule]", "0"}]}], "}"}]}], ",", 
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"isocurvature", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]", ",", "c", ",", "n", ",", "\[Nu]"}], "}"}],
                ",", "b", ",", "\[Eta]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"h", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"n", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"\[Nu]", ",", "3"}]], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "0", "]"}], "==", 
              "0"}]}], "}"}], "//.", "fixsubsyn"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", "c", "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"Rc", "\[Rule]", 
       RowBox[{"1", "-", "Rb"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.452879779675749*^9, 3.452879793609187*^9}, 
   3.452879873219486*^9, {3.4528799833148813`*^9, 3.4528800178321333`*^9}, {
   3.4528822650293427`*^9, 3.452882268203483*^9}, {3.452924924379088*^9, 
   3.452924928965899*^9}, {3.452944090167716*^9, 3.452944092142597*^9}, {
   3.4610640640392323`*^9, 3.461064072758758*^9}, 3.462883514842013*^9, {
   3.4638115787223186`*^9, 3.463811595411129*^9}, 3.463813282674931*^9, {
   3.463825761316848*^9, 3.4638257614130774`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic isocurvature", "Subsubsection",
 CellChangeTimes->{{3.4610647174227877`*^9, 3.46106471981315*^9}, 
   3.462883514852656*^9}],

Cell[BoxData[
 RowBox[{"mag1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"expapply", "[", 
      RowBox[{
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"csol", "/.", 
          RowBox[{
           SubscriptBox["s", "B"], "\[Rule]", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Eta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"h", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"n", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["F", 
                RowBox[{"\[Nu]", ",", "3"}]], "[", "0", "]"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalPi]", "\[Nu]"], "[", "0", "]"}], 
              "\[Equal]", 
              RowBox[{
               SubscriptBox["\[CapitalPi]", "n"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["v", "\[Nu]"], "[", "0", "]"}], "\[Equal]", 
              RowBox[{
               SubscriptBox["v", "n"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "\[Nu]"], "[", "0", "]"}], "\[Equal]", 
              RowBox[{
               SubscriptBox["\[Delta]", "n"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "b"], "[", "0", "]"}], "\[Equal]", 
              RowBox[{
               SubscriptBox["\[Delta]", "c"], "[", "0", "]"}]}], ",", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{
                SubscriptBox["\[Delta]", "\[Gamma]"], "[", "0", "]"}]}], 
              "\[Equal]", 
              RowBox[{"4", 
               RowBox[{
                SubscriptBox["\[Delta]", "b"], "[", "0", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["v", "\[Gamma]"], "[", "0", "]"}], "==", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "Rt"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["d", "B"], "+", 
                  RowBox[{
                   SubscriptBox["\[Delta]", "\[Gamma]"], "[", "0", "]"}]}], 
                 ")"}]}], "+", 
               RowBox[{"Rt", " ", 
                SubscriptBox["\[Delta]", "n"]}]}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Delta]", "\[Nu]"], "[", "0", "]"}], "\[Equal]", 
              RowBox[{
               SubscriptBox["\[Delta]", "\[Gamma]"], "[", "0", "]"}]}]}], 
            "}"}], "//.", 
           RowBox[{"(", 
            RowBox[{"fixsubsyn", "/.", 
             RowBox[{
              SubscriptBox["s", "B"], "\[Rule]", "0"}]}], ")"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", "c", "}"}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rc", "\[Rule]", 
        RowBox[{"1", "-", "Rb"}]}], ",", 
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.452879779675749*^9, 3.452879793609187*^9}, 
   3.452879873219486*^9, {3.4528799833148813`*^9, 3.4528800178321333`*^9}, {
   3.4528822650293427`*^9, 3.452882268203483*^9}, {3.452924924379088*^9, 
   3.452924928965899*^9}, {3.452944090167716*^9, 3.452944092142597*^9}, {
   3.4610640640392323`*^9, 3.461064072758758*^9}, {3.4610647361359987`*^9, 
   3.46106477595921*^9}, {3.4610648925171547`*^9, 3.4610649045609493`*^9}, 
   3.461065030079204*^9, {3.461065762876133*^9, 3.461065783705907*^9}, {
   3.461065865991065*^9, 3.4610658706976423`*^9}, {3.461065963760977*^9, 
   3.461065973870006*^9}, {3.4610660307542467`*^9, 3.4610660368242483`*^9}, 
   3.462883514854869*^9, {3.462885174113511*^9, 3.4628851771176453`*^9}, {
   3.4638134199902563`*^9, 3.463813441091795*^9}, {3.4638165535567923`*^9, 
   3.4638165784292507`*^9}, {3.463823777662578*^9, 3.463823787591639*^9}, {
   3.463824341859425*^9, 3.463824362427763*^9}, {3.463825249920727*^9, 
   3.463825302934029*^9}, {3.4638257545463037`*^9, 3.463825756184424*^9}, {
   3.465717808413806*^9, 3.465717830145556*^9}, {3.466257354324718*^9, 
   3.4662573602736053`*^9}, {3.466257902771017*^9, 3.4662579174540777`*^9}, {
   3.466258724068865*^9, 3.4662587595239697`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Routines for latex output of the initial conditions.", "Subsection",
 CellChangeTimes->{{3.467412894042523*^9, 3.467412906425562*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "ad1", ",", "ison1", ",", "isov1", ",", "isoc1", ",", "isob1", ",", 
     "mag1"}], "}"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<scalar_sols.dat\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.463831591419936*^9, 3.46383167288768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"scalsols", "=", 
   RowBox[{"Get", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<scalar_sols.dat\>\""}], ")"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4638318381810617`*^9, 3.4638318519213142`*^9}, 
   3.4638582137494907`*^9, {3.463859351545372*^9, 3.463859352257675*^9}, {
   3.463859385424609*^9, 3.463859385767912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"magl1", "=", 
   RowBox[{"msimp2", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"scalsols", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
      RowBox[{
       SubscriptBox["s", "B"], "\[Rule]", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.466259212105558*^9, 3.466259293044937*^9}, {
   3.466259619336506*^9, 3.466259632368029*^9}, 3.466707930684808*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"magl2", "=", 
   RowBox[{"msimp2", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"scalsols", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
      RowBox[{
       SubscriptBox["d", "B"], "\[Rule]", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.466259212105558*^9, 3.466259293044937*^9}, {
  3.466259619336506*^9, 3.466259622601472*^9}, {3.466707934024723*^9, 
  3.466707935074802*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"proc", "[", "sol_", "]"}], ":=", 
  RowBox[{"mapply", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mapply", "[", 
       RowBox[{
        RowBox[{"mapply", "[", 
         RowBox[{"sol", ",", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], 
           "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}]}], "]"}], "/.", "karrpat"}], "/.", "marrpat"}], ",", 
    "cftwrap"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.46675884904359*^9, 3.4667589000954027`*^9}, {
  3.466758958909902*^9, 3.466758985191132*^9}, {3.4667590270480337`*^9, 
  3.466759046053512*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonzero", "[", "l__", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"l", ",", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"PossibleZeroQ", "[", "#", "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4667570245324297`*^9, 3.466757064142437*^9}, {
  3.466757097057643*^9, 3.46675709832651*^9}}],

Cell[BoxData[
 RowBox[{"karrpat", ":=", 
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"SeriesData", "[", 
     RowBox[{
     "k", ",", "0", ",", "cl__List", ",", "min_", ",", "max_", ",", "den_"}], 
     "]"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"cft", "@@", 
    RowBox[{"nonzero", "[", 
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{"Factor", "[", "cl", "]"}], "*", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"k", "^", 
          RowBox[{"(", 
           RowBox[{"n", "/", "den"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "min", ",", 
           RowBox[{"min", "+", 
            RowBox[{"Length", "[", "cl", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.466756410091638*^9, 3.4667564438939533`*^9}, {
  3.466756484056635*^9, 3.466756590019882*^9}, {3.4667566679956293`*^9, 
  3.4667567843377542`*^9}, {3.466756824042446*^9, 3.46675688490312*^9}, {
  3.466756964472123*^9, 3.46675699175788*^9}, {3.4667570528933*^9, 
  3.466757057173935*^9}, {3.466757109565956*^9, 3.466757151197554*^9}, {
  3.466758213451933*^9, 3.466758213619544*^9}, {3.4667584071644793`*^9, 
  3.466758408388595*^9}, {3.466770348271192*^9, 3.466770362083025*^9}, {
  3.4667704478804617`*^9, 3.4667704486425*^9}}],

Cell[BoxData[
 RowBox[{"marrpat", ":=", 
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"SeriesData", "[", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "cl__List", ",", "min_", ",", 
      "max_", ",", "den_"}], "]"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"cft", "@@", 
    RowBox[{"nonzero", "[", 
     RowBox[{
      RowBox[{"Factor", "[", "cl", "]"}], "*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["m", "n"], "^", 
         RowBox[{"(", 
          RowBox[{"n1", "/", "den"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n1", ",", "min", ",", 
          RowBox[{"min", "+", 
           RowBox[{"Length", "[", "cl", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
      "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.466756410091638*^9, 3.4667564438939533`*^9}, {
   3.466756484056635*^9, 3.466756590019882*^9}, {3.4667566679956293`*^9, 
   3.4667567843377542`*^9}, {3.466756824042446*^9, 3.46675688490312*^9}, {
   3.466756964472123*^9, 3.46675699175788*^9}, {3.4667570528933*^9, 
   3.466757057173935*^9}, {3.466757109565956*^9, 3.466757151197554*^9}, {
   3.466758184868093*^9, 3.466758217252203*^9}, {3.466758270555121*^9, 
   3.466758282813738*^9}, 3.466758320394904*^9, {3.466758411114645*^9, 
   3.466758412482183*^9}, {3.466770364811186*^9, 3.466770369490973*^9}, {
   3.466770452770568*^9, 3.466770453673707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cftwrap", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"l", "/.", 
     RowBox[{"cft", "\[Rule]", "List"}]}], "/.", 
    RowBox[{"a__List", "\[Rule]", 
     RowBox[{"Flatten", "[", "a", "]"}]}]}], "/.", 
   RowBox[{"List", "\[Rule]", "cft"}]}]}]], "Input",
 CellChangeTimes->{{3.466758443643614*^9, 3.466758502519122*^9}, {
  3.466758549641176*^9, 3.466758566166641*^9}, {3.46675863155079*^9, 
  3.466758635733981*^9}, {3.4667591118798323`*^9, 3.466759144631198*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lterm", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lterm", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], "&"}], ",", 
     "ls"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lterm", "[", 
    RowBox[{
     RowBox[{"a_", "\[Rule]", "b_"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{"lterm", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lterm", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"PossibleZeroQ", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"l", "+", 
       RowBox[{
        RowBox[{"O", "[", 
         RowBox[{"x", "-", "x0"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], ",", 
    RowBox[{"leadingterm", "[", 
     RowBox[{"l", ",", "1"}], "]"}], ",", 
    RowBox[{"l", "+", 
     RowBox[{
      RowBox[{"O", "[", 
       RowBox[{"x", "-", "x0"}], "]"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.464003189894189*^9, 3.4640033472761583`*^9}, {
   3.464003394221793*^9, 3.4640034569288263`*^9}, 3.4640034882574463`*^9, {
   3.4640035485712433`*^9, 3.4640036439878473`*^9}, 3.464003679398302*^9, {
   3.464003792139065*^9, 3.464003804226769*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mrearrangetex", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "c", ",", "kl", ",", "kc", ",", "wl", ",", "wc"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"Series", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"s", ",", 
        SubscriptBox["m", "n"], ",", "0"}], "]"}]}], ";", 
     RowBox[{"kl", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"c", ",", "k"}], "]"}], ",", 
        RowBox[{"Except", "[", "0", "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"kc", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "kl", "]"}], ">", "0"}], ",", 
        RowBox[{"kl", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"wl", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"kc", ",", "\[Omega]"}], "]"}], ",", 
        RowBox[{"Except", "[", "0", "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"wc", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "wl", "]"}], ">", "0"}], ",", 
        RowBox[{"wl", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PossibleZeroQ", "[", "c", "]"}], ",", "expr", ",", 
        RowBox[{
         RowBox[{"am", "[", 
          RowBox[{"Factor", "[", 
           RowBox[{"FullSimplify", "[", "wc", "]"}], "]"}], "]"}], 
         RowBox[{"bm", "[", " ", 
          RowBox[{"Normal", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"s", "/", "c"}], "]"}], "]"}], "]"}], 
         RowBox[{"cm", "[", 
          RowBox[{"Factor", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"c", "/", "kc"}], "]"}], "]"}], "]"}], " ", 
         RowBox[{"dm", "[", 
          RowBox[{"Factor", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"kc", "/", "wc"}], "]"}], "]"}], "]"}]}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"dm", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"am", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"bm", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"cm", "[", "1", "]"}], "\[Rule]", "1"}]}], "}"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.457339272389717*^9, 3.457339296448085*^9}, {
  3.4573435906707582`*^9, 3.457343764451169*^9}, {3.4573437963003683`*^9, 
  3.457343897287125*^9}, {3.4573439371665163`*^9, 3.457343939499126*^9}, {
  3.4573443402385397`*^9, 3.457344441555283*^9}, {3.457344498883037*^9, 
  3.457344536165984*^9}, {3.457418329861457*^9, 3.4574183334592867`*^9}, {
  3.457418374003993*^9, 3.457418388075721*^9}, {3.463830790934496*^9, 
  3.463830839137805*^9}, {3.463851620847327*^9, 3.463851660564334*^9}, {
  3.4638517700823383`*^9, 3.463851800959392*^9}, {3.463851873660632*^9, 
  3.463851947794298*^9}, {3.463851979986959*^9, 3.463852110669928*^9}, {
  3.463853422395008*^9, 3.463853451537936*^9}, {3.46385362744516*^9, 
  3.4638536279809*^9}, {3.463858671252739*^9, 3.463858689218545*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"addbardeen", "[", "l__List", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"msimp2", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"psi", "\[Rule]", 
              RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], ",", 
             RowBox[{"phi", "\[Rule]", 
              RowBox[{"\[CapitalPhi]", "[", "t", "]"}]}]}], "}"}], "//.", 
           "fixsubsyn"}], "//.", 
          RowBox[{"mkpure", "[", "l", "]"}]}], "//.", 
         RowBox[{"R\[Gamma]", "\[Rule]", 
          RowBox[{"1", "-", "Rt"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
     "}"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"psi", "\[Rule]", 
      RowBox[{"\[CapitalPsi]", "[", "t", "]"}]}], ",", 
     RowBox[{"phi", "\[Rule]", 
      RowBox[{"\[CapitalPhi]", "[", "t", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.466769584831233*^9, 3.4667697117951117`*^9}, {
  3.466769775955822*^9, 3.466769796365308*^9}, {3.466769933644651*^9, 
  3.466769938045169*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mktexout", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"sub_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"TeXForm", "[", 
   RowBox[{"StandardForm", "[", 
    RowBox[{
     RowBox[{"mapply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lterm", "[", 
         RowBox[{
          RowBox[{"addbardeen", "[", "l", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}], "//.", "sub"}], 
       ",", "mrearrangetex"}], "]"}], "//.", "sub"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.46385357992561*^9, 3.463853635091895*^9}, {
   3.463854860977079*^9, 3.463854870230832*^9}, {3.463858377621849*^9, 
   3.463858406220718*^9}, 3.4638967280662937`*^9, {3.463897450179668*^9, 
   3.463897451483465*^9}, {3.4640040546674833`*^9, 3.464004060293559*^9}, {
   3.4667699856544228`*^9, 3.466769990021785*^9}, {3.4667701763874483`*^9, 
   3.4667701782992992`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mktexout2", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"sub_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"TeXForm", "[", 
   RowBox[{"StandardForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"proc", "[", 
       RowBox[{
        RowBox[{"mapply", "[", 
         RowBox[{
          RowBox[{"lterm", "[", 
           RowBox[{
            RowBox[{"addbardeen", "[", "l", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"Expand", "[", "#", "]"}], "]"}], "&"}]}], "]"}], "//.", 
        "sub"}], "]"}], "//.", "sub"}], "/.", 
     RowBox[{"cft", "\[Rule]", "Plus"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.46385357992561*^9, 3.463853635091895*^9}, {
   3.463854860977079*^9, 3.463854870230832*^9}, {3.463858377621849*^9, 
   3.463858406220718*^9}, 3.4638967280662937`*^9, {3.463897450179668*^9, 
   3.463897451483465*^9}, {3.4640040546674833`*^9, 3.464004060293559*^9}, {
   3.466766772415649*^9, 3.4667668052225647`*^9}, {3.466767096444219*^9, 
   3.466767110001738*^9}, {3.466769962414764*^9, 3.4667699654303417`*^9}, {
   3.466770181995284*^9, 3.4667701970938*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ad1", "=", 
   RowBox[{"scalsols", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ison1", "=", 
   RowBox[{"scalsols", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isov1", "=", 
   RowBox[{"scalsols", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isoc1", "=", 
   RowBox[{"scalsols", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isob1", "=", 
   RowBox[{"scalsols", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mag1", "=", 
   RowBox[{"scalsols", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.46385923351408*^9, 3.4638593433712187`*^9}, {
  3.463859389433571*^9, 3.463859402625244*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout", "[", 
    RowBox[{"ad1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_ad.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.463829286405821*^9, 3.4638293367688913`*^9}, {
   3.46383173363894*^9, 3.463831735955821*^9}, {3.46385943268009*^9, 
   3.463859451893895*^9}, {3.463896714241647*^9, 3.463896720725876*^9}, 
   3.466766892214329*^9, 3.466769995831006*^9}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{"ison1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_ison.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.463859459471727*^9, 3.4638594984046803`*^9}, 
   3.4638967346278057`*^9, 3.466766895374219*^9}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{"isov1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_isov.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.463859510406687*^9, 3.463859524283703*^9}, 
   3.46389673667927*^9, 3.466766896263974*^9}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{"isoc1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_isoc.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.463859513235944*^9, 3.463859529203581*^9}, 
   3.4638967378156*^9, 3.466766896983466*^9}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{"isob1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_isob.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4638595163959703`*^9, 3.4638595325634327`*^9}, 
   3.463896740318179*^9, 3.466766897718227*^9}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{
     RowBox[{"magl1", "/.", 
      RowBox[{
       SubscriptBox["d", "B"], "\[Rule]", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_magl1.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.46385954214076*^9, 3.4638595466350327`*^9}, 
   3.463896741861603*^9, {3.4662596510020647`*^9, 3.466259657504784*^9}, 
   3.466766898703703*^9, {3.466770682338234*^9, 3.466770690786744*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{
     RowBox[{"magl2", "/.", 
      RowBox[{
       SubscriptBox["s", "B"], "\[Rule]", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
        RowBox[{"-", "R\[Gamma]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/scalar_magl2.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.46385954214076*^9, 3.4638595466350327`*^9}, 
   3.463896741861603*^9, {3.466259653176731*^9, 3.4662596612419147`*^9}, 
   3.466766900403677*^9, {3.466770694318231*^9, 3.4667706973714523`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Subsubsection"]]}, Visible -> False, FrontEndVersion -> 
  "7.0 for Mac OS X x86 (32-bit) (February 18, 2009)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 68, 1, 20, "Title"],
Cell[CellGroupData[{
Cell[638, 25, 375, 5, 46, "Subtitle"],
Cell[CellGroupData[{
Cell[1038, 34, 156, 2, 67, "Section"],
Cell[1197, 38, 318, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[1540, 47, 697, 14, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2240, 63, 263, 6, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2506, 71, 544, 11, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[3053, 84, 501, 10, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3603, 100, 137, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[3765, 106, 131, 2, 34, "Subsection"],
Cell[3899, 110, 754, 12, 28, "Input"],
Cell[4656, 124, 1256, 22, 28, "Input"],
Cell[5915, 148, 226, 5, 27, "Text"],
Cell[6144, 155, 437, 11, 28, "Input"],
Cell[6584, 168, 1231, 24, 28, "Input"],
Cell[7818, 194, 1798, 38, 28, "Input"],
Cell[9619, 234, 344, 6, 27, "Text"],
Cell[9966, 242, 1006, 18, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11009, 265, 327, 4, 34, "Subsection"],
Cell[11339, 271, 185, 2, 27, "Text"],
Cell[11527, 275, 1779, 31, 28, "Input"],
Cell[13309, 308, 1437, 24, 28, "Input"],
Cell[14749, 334, 2447, 42, 28, "Input"],
Cell[17199, 378, 253, 5, 27, "Text"],
Cell[17455, 385, 195, 2, 27, "Text"],
Cell[17653, 389, 654, 15, 48, "Input"],
Cell[18310, 406, 564, 14, 28, "Input"],
Cell[18877, 422, 255, 5, 27, "Text"],
Cell[19135, 429, 406, 10, 30, "Input"],
Cell[19544, 441, 1211, 29, 30, "Input"],
Cell[20758, 472, 154, 2, 27, "Text"],
Cell[20915, 476, 1550, 45, 84, "Input"],
Cell[22468, 523, 829, 23, 48, "Input"],
Cell[23300, 548, 1199, 34, 48, "Input"],
Cell[24502, 584, 297, 9, 32, "Text"],
Cell[24802, 595, 687, 18, 35, "Input"],
Cell[25492, 615, 623, 15, 28, "Input"],
Cell[26118, 632, 213, 3, 27, "Text"],
Cell[26334, 637, 523, 13, 28, "Input"],
Cell[26860, 652, 181, 3, 28, "Input"],
Cell[27044, 657, 620, 10, 28, "Input"],
Cell[27667, 669, 1024, 18, 30, "Input"],
Cell[28694, 689, 1000, 20, 28, "Input"],
Cell[29697, 711, 366, 8, 28, "Input"],
Cell[30066, 721, 153, 2, 27, "Text"],
Cell[30222, 725, 652, 14, 35, "Input"],
Cell[30877, 741, 1170, 38, 66, "Input"],
Cell[32050, 781, 5641, 152, 288, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37740, 939, 72, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[37837, 944, 76, 1, 25, "Subsubsection"],
Cell[37916, 947, 2115, 55, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40068, 1007, 98, 1, 25, "Subsubsection"],
Cell[40169, 1010, 4249, 110, 115, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44455, 1125, 99, 1, 25, "Subsubsection"],
Cell[44557, 1128, 324, 9, 30, "Text"],
Cell[44884, 1139, 4182, 102, 113, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49103, 1246, 83, 1, 25, "Subsubsection"],
Cell[49189, 1249, 2006, 53, 56, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51232, 1307, 86, 1, 25, "Subsubsection"],
Cell[51321, 1310, 2269, 59, 71, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53627, 1374, 139, 2, 25, "Subsubsection"],
Cell[53769, 1378, 5222, 127, 113, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59028, 1510, 140, 1, 34, "Subsection"],
Cell[59171, 1513, 385, 11, 30, "Input"],
Cell[59559, 1526, 423, 10, 30, "Input"],
Cell[59985, 1538, 539, 16, 28, "Input"],
Cell[60527, 1556, 565, 17, 28, "Input"],
Cell[61095, 1575, 977, 28, 30, "Input"],
Cell[62075, 1605, 344, 9, 30, "Input"],
Cell[62422, 1616, 1312, 30, 30, "Input"],
Cell[63737, 1648, 1390, 31, 30, "Input"],
Cell[65130, 1681, 517, 12, 30, "Input"],
Cell[65650, 1695, 1802, 54, 66, "Input"],
Cell[67455, 1751, 3516, 86, 81, "Input"],
Cell[70974, 1839, 1230, 34, 30, "Input"],
Cell[72207, 1875, 954, 24, 30, "Input"],
Cell[73164, 1901, 1266, 30, 30, "Input"],
Cell[74433, 1933, 912, 26, 114, "Input"],
Cell[75348, 1961, 770, 20, 30, "Input"],
Cell[76121, 1983, 633, 18, 30, "Input"],
Cell[76757, 2003, 628, 18, 30, "Input"],
Cell[77388, 2023, 627, 18, 30, "Input"],
Cell[78018, 2043, 633, 18, 30, "Input"],
Cell[78654, 2063, 816, 22, 30, "Input"],
Cell[79473, 2087, 818, 22, 30, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

