(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     56532,       1533]
NotebookOptionsPosition[     52853,       1424]
NotebookOutlinePosition[     53473,       1446]
CellTagsIndexPosition[     53430,       1443]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[RawData[""], "Title"],

Cell[CellGroupData[{

Cell["Massive Neutrinos", "Subtitle",
 CellChangeTimes->{{3.444562276749201*^9, 3.444562286363826*^9}, {
  3.445002605125948*^9, 3.445002607596531*^9}, {3.445006999305208*^9, 
  3.445007007743311*^9}, {3.445332329625093*^9, 3.4453323309024487`*^9}, {
  3.44533296110108*^9, 3.4453329679608097`*^9}, {3.447584633662448*^9, 
  3.4475846345520897`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Initialization", "Section"]], "Section",
 CellChangeTimes->{{3.443800239133483*^9, 3.443800242903244*^9}}],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<magnetic`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.445170111196775*^9, 3.445170132025473*^9}, {
  3.445332975852935*^9, 3.4453329786852217`*^9}, {3.447677688461997*^9, 
  3.447677690719285*^9}, {3.4531066742428827`*^9, 3.4531066779096613`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}], "]"}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.441625573508712*^9, 3.441625575746928*^9}, {
   3.441625619197209*^9, 3.441625622744987*^9}, {3.441625685432925*^9, 
   3.4416256868874617`*^9}, {3.4421471984134073`*^9, 3.442147201505908*^9}, {
   3.4421472662977858`*^9, 3.442147266634595*^9}, {3.44362619212748*^9, 
   3.44362622881428*^9}, {3.443777303390203*^9, 3.443777305985528*^9}, 
   3.443793114941895*^9, {3.443800155580203*^9, 3.4438001707056313`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\"\<dseries`*\>\"", "]"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.443800175920138*^9, {3.447572469858817*^9, 3.447572476929056*^9}}],

Cell[BoxData[
 RowBox[{"<<", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<dseries.m\>\""}], 
   ")"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.443777308480987*^9, 3.443777319311777*^9}, 
   3.443793114947034*^9, 3.443800155580368*^9, {3.443982384565901*^9, 
   3.443982401906034*^9}, {3.4475724610129423`*^9, 3.4475724730189447`*^9}, {
   3.4518270873543873`*^9, 3.451827087599469*^9}, {3.467413055933543*^9, 
   3.467413056525292*^9}}],

Cell[BoxData[
 RowBox[{"<<", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<gaugeinvariant.m\>\""}], ")"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.443777308480987*^9, 3.443777319311777*^9}, 
   3.443793114947034*^9, 3.443800155580368*^9, {3.443982384565901*^9, 
   3.443982401906034*^9}, {3.445002473072509*^9, 3.4450024779641733`*^9}, 
   3.4571817810679693`*^9, 3.463406215472921*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matter and Radiation", "Section",
 CellChangeTimes->{{3.4441125903779097`*^9, 3.4441125949428463`*^9}}],

Cell[CellGroupData[{

Cell["Background bits", "Subsection",
 CellChangeTimes->{{3.444133816683442*^9, 3.4441338211325502`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kc", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.443518141874385*^9, 3.443518260708337*^9}, {
   3.443526713922646*^9, 3.443526758861496*^9}, {3.443787815263904*^9, 
   3.443787824828084*^9}, 3.4437931150956573`*^9, {3.443961424369553*^9, 
   3.443961511040667*^9}, 3.443979825109785*^9, 3.4441337816185102`*^9, {
   3.444137557163439*^9, 3.4441375812798862`*^9}, {3.445070617131624*^9, 
   3.445070617368647*^9}, {3.445166819652246*^9, 3.445166828475709*^9}, {
   3.4452465691107473`*^9, 3.445246577649969*^9}, {3.445333073868775*^9, 
   3.445333074570256*^9}, {3.4453424727276487`*^9, 3.4453424827633877`*^9}, {
   3.445345060243222*^9, 3.445345062085281*^9}, 3.4453452198384333`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"funcsubs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"hubble", ",", 
      RowBox[{"defvar", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", "b", ",", "n", ",", "\[Nu]", ",", "\[Gamma]"}], 
        "}"}], "]"}], ",", "antsub"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.445166835043935*^9, 3.445166871450637*^9}, {
  3.4453330648854713`*^9, 3.4453330678275957`*^9}, {3.445339888071504*^9, 
  3.445339890088819*^9}, {3.445342459785746*^9, 3.445342460388582*^9}, {
  3.445344679629923*^9, 3.44534468111655*^9}, {3.445344777703734*^9, 
  3.445344784653933*^9}, {3.447567183146502*^9, 3.4475672115314817`*^9}, {
  3.447569143880807*^9, 3.447569151546178*^9}, {3.447576020483142*^9, 
  3.447576022826174*^9}, {3.4475763311228743`*^9, 3.4475763319891367`*^9}, {
  3.447581215008515*^9, 3.447581222715179*^9}, {3.447584645625285*^9, 
  3.44758465011754*^9}, {3.448369862488043*^9, 3.4483698626021357`*^9}, {
  3.448964733137867*^9, 3.4489647391421328`*^9}, {3.448965211162331*^9, 
  3.448965211390113*^9}, {3.448965261624916*^9, 3.448965291765099*^9}, {
  3.449219008101713*^9, 3.449219011088788*^9}, {3.463407336179926*^9, 
  3.4634073366099873`*^9}}],

Cell["\<\
Solve for the background solution. There are multiple solutions (as \
non-linear), so we pick the right one.\
\>", "Text",
 CellChangeTimes->{{3.444133871509181*^9, 3.444133901427288*^9}}],

Cell[BoxData[
 RowBox[{"eq1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Collect", "[", 
      RowBox[{"eq", ",", 
       RowBox[{"a", "[", "t", "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"a", "[", "t", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.447581660893141*^9, 3.44758169891437*^9}, {
   3.447581734010667*^9, 3.447581794148388*^9}, 3.447583428901334*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq1", ",", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
     RowBox[{"Solve", "::", "ifun"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4475743948165293`*^9, 3.44757443036614*^9}, {
  3.447574487916366*^9, 3.447574553263048*^9}, {3.4475746028222713`*^9, 
  3.447574609535014*^9}, {3.44757550559938*^9, 3.447575519192789*^9}, {
  3.44757593061075*^9, 3.447575930834272*^9}, {3.44758102624372*^9, 
  3.447581116049015*^9}, {3.447581181914754*^9, 3.447581182056347*^9}, {
  3.4475813665594263`*^9, 3.447581484781201*^9}, {3.447581537900577*^9, 
  3.4475815406872396`*^9}, {3.4475815896776133`*^9, 3.447581590805279*^9}, {
  3.447581811382945*^9, 3.447581825058441*^9}, {3.447584706616007*^9, 
  3.4475847100438004`*^9}, {3.447584748879713*^9, 3.447584759222904*^9}, {
  3.447585499098258*^9, 3.44758551522058*^9}, {3.447585582250915*^9, 
  3.4475855983631067`*^9}, {3.447588128076496*^9, 3.447588129855495*^9}}],

Cell[BoxData[
 RowBox[{"ssol", "=", 
  RowBox[{"Union", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"msimp2", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], "//.", "sl"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "8"}], "}"}]}], "]"}], "/.", 
      RowBox[{"R\[Gamma]", "\[Rule]", 
       RowBox[{"1", "-", "R\[Nu]", "-", "Rn"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R\[Nu]", ">", "0"}], ",", 
       RowBox[{"R\[Nu]", "<", "1"}], ",", 
       RowBox[{"omm", ">", "0"}], ",", 
       RowBox[{"H0", ">", "0"}], ",", 
       RowBox[{"a0", ">", "0"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.44758187181822*^9, 3.447581885789546*^9}, {
  3.447582790325082*^9, 3.447582802868421*^9}, {3.447582837847193*^9, 
  3.447582900725232*^9}, {3.447583486475189*^9, 3.4475834998474817`*^9}, {
  3.447583540799074*^9, 3.447583574409418*^9}, {3.447583666266798*^9, 
  3.447583678766038*^9}, {3.447588133928006*^9, 3.44758813433007*^9}, {
  3.447588184061925*^9, 3.447588226520608*^9}, {3.44758828449823*^9, 
  3.447588336423689*^9}, {3.447588537406083*^9, 3.447588544108274*^9}, {
  3.448369872614958*^9, 3.4483698893019667`*^9}, {3.448964945177455*^9, 
  3.448964953828755*^9}, {3.449906805930751*^9, 3.449906868403799*^9}, {
  3.449907102391561*^9, 3.4499071417290487`*^9}, {3.449929864693489*^9, 
  3.449929867310699*^9}, {3.449930054553412*^9, 3.449930055235491*^9}, {
  3.449934646237468*^9, 3.449934660000568*^9}, {3.463407368100239*^9, 
  3.463407368691596*^9}}],

Cell["\<\
Select the third equation as the actual solution (the +ve one), make it a \
normal expression as it is exact, this way the series solver doens't truncate \
everything at lower order.\
\>", "Text",
 CellChangeTimes->{{3.444133963667965*^9, 3.444134011339695*^9}, {
  3.444134045369959*^9, 3.444134094343719*^9}}],

Cell[BoxData[
 RowBox[{"bsol", "=", 
  RowBox[{"mkpure", "[", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"Normal", "[", 
     RowBox[{"ssol", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4441341008017483`*^9, 3.444134117500265*^9}, {
  3.4443980446521072`*^9, 3.444398048888727*^9}, {3.445333346421934*^9, 
  3.4453333483190947`*^9}, {3.447588561122703*^9, 3.447588571829179*^9}, {
  3.448964970294887*^9, 3.448964970402863*^9}, {3.449907149887917*^9, 
  3.449907150146796*^9}, {3.4499299555967903`*^9, 3.449929979635508*^9}, {
  3.449930043458503*^9, 3.449930072756525*^9}, {3.4499347538920116`*^9, 
  3.449934754028273*^9}, {3.4518272314685497`*^9, 3.451827233066165*^9}, {
  3.454259237711389*^9, 3.454259252023614*^9}, {3.4574180519419003`*^9, 
  3.457418052043092*^9}}],

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "'"}], "[", "t", "]"}], "/", 
     RowBox[{"a", "[", "t", "]"}]}], "/.", "bsol"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4643337425691423`*^9, 3.46433380593231*^9}, {
  3.4643338752340117`*^9, 3.46433388142663*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.454325638061207*^9, 3.4543256417232933`*^9}}],

Cell[BoxData[
 RowBox[{"tenssub", ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gaugevar", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "n", ",", "\[Nu]", ",", "\[Gamma]"}], 
       "}"}], "]"}], ",", "hubble", ",", 
     RowBox[{"defvar", "[", 
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "n", ",", "\[Nu]", ",", "\[Gamma]"}], 
       "}"}], "]"}], ",", "bsol", ",", "antsub"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.445002922812468*^9, 3.4450029664117393`*^9}, {
   3.445003180071327*^9, 3.445003180914235*^9}, {3.445007457309368*^9, 
   3.445007468078937*^9}, {3.445070286142455*^9, 3.4450702872637033`*^9}, {
   3.445072747896411*^9, 3.445072748327194*^9}, {3.44517285309039*^9, 
   3.445172856148243*^9}, {3.445176635672333*^9, 3.445176635931588*^9}, {
   3.445338775498927*^9, 3.445338777661064*^9}, {3.445342585798378*^9, 
   3.445342586301111*^9}, {3.445344668923609*^9, 3.445344669048689*^9}, {
   3.4453447938367863`*^9, 3.4453447945139112`*^9}, {3.44758894735429*^9, 
   3.447588947632663*^9}, {3.4475919332131147`*^9, 3.44759193672653*^9}, 
   3.447592182545005*^9, {3.4483699429551497`*^9, 3.44836994306427*^9}, {
   3.448964754561084*^9, 3.4489647641885033`*^9}, 3.4492176220165462`*^9, 
   3.4499118433826027`*^9, {3.451827305450057*^9, 3.451827312344697*^9}, {
   3.4542569166475277`*^9, 3.454256928121084*^9}, {3.454259271421461*^9, 
   3.454259272762574*^9}, {3.454324256597921*^9, 3.4543242663610353`*^9}, {
   3.457183153825253*^9, 3.4571831571918087`*^9}, {3.457184012417378*^9, 
   3.457184015590496*^9}, {3.457252491485776*^9, 3.4572524941159687`*^9}, {
   3.457252583810013*^9, 3.457252614774596*^9}, {3.457256407459426*^9, 
   3.45725641012831*^9}, {3.4610536590753517`*^9, 3.4610536660520983`*^9}, {
   3.463407439239099*^9, 3.463407444032876*^9}, 3.463755983578888*^9}],

Cell[BoxData[
 RowBox[{"vartens", ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"tensvars", ",", 
     RowBox[{"tlnuvars", "[", "3", "]"}], ",", 
     RowBox[{"tfnuvars", "[", "3", "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.454256941060338*^9, 3.454256980523424*^9}, {
  3.4542570232723627`*^9, 3.454257025109591*^9}, {3.454324212443617*^9, 
  3.45432421730902*^9}, {3.463407503643611*^9, 3.4634075349257402`*^9}, {
  3.4638295589027*^9, 3.463829566000139*^9}}],

Cell[BoxData[
 RowBox[{"eqstens", ":=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tlnu", "[", "3", "]"}], ",", 
        RowBox[{"tfnu", "[", "3", "]"}], ",", "tensor"}], "}"}], "//.", 
      "tenssub"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.4542569830390472`*^9, 3.454257049613894*^9}, {
  3.454324239471119*^9, 3.4543242435257587`*^9}, {3.4634075604465427`*^9, 
  3.4634075646410646`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rmden", "[", "ls_List", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"rmden", ",", "ls"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmden", "[", 
   RowBox[{"a_", "\[Equal]", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    RowBox[{"Together", "[", 
     RowBox[{"a", "-", "b"}], "]"}], "]"}], "\[Equal]", "0"}]}]}], "Input",
 CellChangeTimes->{{3.449301120487876*^9, 3.449301161103217*^9}, {
   3.449301504367216*^9, 3.449301522474679*^9}, {3.44930174022606*^9, 
   3.449301774776939*^9}, {3.449301813293762*^9, 3.449301819871887*^9}, 
   3.449911843396386*^9}],

Cell["\<\
Check to see if two solutions are identical (i.e. see if there is a \
consistent relationship between the constants).\
\>", "Text",
 CellChangeTimes->{{3.449405637994424*^9, 3.449405674654892*^9}, 
   3.449911843404389*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"combrule", "[", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"a1_", "\[Rule]", "b1_"}], "]"}], ",", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"a2_", "\[Rule]", "b2_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"b1", "\[Equal]", "b2"}]}]], "Input",
 CellChangeTimes->{{3.449396637618*^9, 3.449396684361043*^9}, 
   3.4499118434053392`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"identicalsol", "[", 
   RowBox[{"sol1_", ",", "sol2_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{"combrule", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sol1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sol2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//.", 
           RowBox[{
            RowBox[{"var", "[", "n_", "]"}], "\[Rule]", 
            RowBox[{"e", "[", "n", "]"}]}]}], ")"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Union", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{"sol1", ",", 
        RowBox[{"var", "[", "_", "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.449396486402547*^9, 3.449396501664857*^9}, {
   3.449396538618101*^9, 3.449396634981366*^9}, {3.449396772986208*^9, 
   3.4493968728192987`*^9}, {3.449397024560856*^9, 3.449397027762012*^9}, {
   3.449740328139017*^9, 3.449740328270879*^9}, {3.449844108862253*^9, 
   3.449844123675193*^9}, 3.4499118434100943`*^9}],

Cell["Prefixing bits and bobs.", "Text",
 CellChangeTimes->{{3.449405688361326*^9, 3.449405694518507*^9}, 
   3.449911843413608*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{"ls_List", ",", "str_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"prfwk", "[", 
       RowBox[{"#", ",", "str"}], "]"}], "&"}], ",", "ls"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{"x_Symbol", ",", "str_"}], "]"}], ":=", 
   RowBox[{"Symbol", "[", 
    RowBox[{"str", "<>", 
     RowBox[{"SymbolName", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"x_", ",", "n__"}], "]"}], ",", "str_"}], "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"str", "<>", 
       RowBox[{"SymbolName", "[", "x", "]"}]}], "]"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prfwk", "[", 
   RowBox[{"x_", ",", "str_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"prfwk", "[", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], ",", "str"}], "]"}], "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", 
     RowBox[{"Level", "[", 
      RowBox[{"x", ",", "1"}], "]"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4482011982622128`*^9, 3.448201380961186*^9}, {
   3.448201477243189*^9, 3.448201526410407*^9}, {3.448201556720994*^9, 
   3.448201556938608*^9}, 3.448201606340026*^9, {3.4494057212163687`*^9, 
   3.4494057568437967`*^9}, 3.4499118434152737`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"varsep", "[", 
    RowBox[{"ls_List", ",", "ev_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"varsep", "[", 
       RowBox[{"#", ",", "ev"}], "]"}], "&"}], ",", "ls"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsep", "[", 
   RowBox[{"var_", ",", "ev_"}], "]"}], ":=", 
  RowBox[{"var", "->", 
   RowBox[{
    RowBox[{"prfwk", "[", 
     RowBox[{"var", ",", "\"\<z\>\""}], "]"}], "+", 
    RowBox[{"ev", " ", 
     RowBox[{"prfwk", "[", 
      RowBox[{"var", ",", "\"\<f\>\""}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.4494029077276382`*^9, 3.449402964342373*^9}, {
   3.449403009190057*^9, 3.449403011118037*^9}, {3.449403115107366*^9, 
   3.449403144676003*^9}, 3.4499118434198713`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eqsep", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eqsep", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], "&"}], ",", 
     "ls"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqsep", "[", 
   RowBox[{
    RowBox[{"a_", "\[Equal]", "b_"}], ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"a", "-", "b"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], ",", "x"}], 
     "]"}], "\[Equal]", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4494033919023323`*^9, 3.449403444703335*^9}, {
   3.4494034816264668`*^9, 3.449403555337381*^9}, {3.449403727662798*^9, 
   3.4494037367672377`*^9}, {3.4494038017289953`*^9, 3.449403815816579*^9}, 
   3.449911843424634*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rde", "=", 
   RowBox[{"msimp2", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"rmden", "[", "eqstens", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.449301778630765*^9, 3.449301786906345*^9}, {
   3.4493018334926023`*^9, 3.449301890020701*^9}, 3.4499118434008703`*^9, {
   3.454257118275384*^9, 3.454257127716243*^9}, {3.4543036856964493`*^9, 
   3.454303698344392*^9}, {3.454303793541913*^9, 3.454303794918117*^9}, 
   3.454324576854372*^9, 3.4543249310352583`*^9}],

Cell[TextData[{
 "Seperate the equations up to linear order in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["m", "n"], "2"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.449405865395656*^9, 3.449405884688809*^9}, 
   3.4499118434293222`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{"eqsep", "[", 
    RowBox[{
     RowBox[{"rde", "//.", 
      RowBox[{"mkpure", "[", 
       RowBox[{"varsep", "[", 
        RowBox[{"vartens", ",", 
         SuperscriptBox[
          SubscriptBox["m", "n"], "2"]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.449403838273947*^9, 3.449403879149241*^9}, {
   3.449403912595508*^9, 3.449403921918516*^9}, {3.4494039959654713`*^9, 
   3.449404000789456*^9}, 3.4499118434305363`*^9, {3.452876408751809*^9, 
   3.452876408900793*^9}, {3.454257243868078*^9, 3.454257246170072*^9}, {
   3.454257281240121*^9, 3.4542572828007393`*^9}, {3.4543249888352213`*^9, 
   3.454324991844385*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "eq1", "]"}], ",", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.452861140578559*^9, 3.452861243826249*^9}, {
   3.452863725883465*^9, 3.452863741520987*^9}, {3.4528764112303762`*^9, 
   3.452876414271614*^9}, 3.4528769965604477`*^9, {3.454257250620345*^9, 
   3.45425725294674*^9}, {3.454324994270685*^9, 3.454324996864835*^9}}],

Cell["Get the zeroth order equations.", "Text",
 CellChangeTimes->{{3.449405920885398*^9, 3.4494059364423733`*^9}, {
   3.449405970163059*^9, 3.449405970498189*^9}, 3.449911843435519*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"prfwk", "[", 
       RowBox[{"vartens", ",", "\"\<z\>\""}], "]"}], ",", 
      RowBox[{"prfwk", "[", 
       RowBox[{"vartens", ",", "\"\<f\>\""}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.449405985137431*^9, 3.44940601803258*^9}, {
   3.449495737304554*^9, 3.4494957412208*^9}, 3.449911843441182*^9, {
   3.4528764314090843`*^9, 3.452876459877008*^9}, {3.4542572992111998`*^9, 
   3.4542573042821283`*^9}}],

Cell[BoxData[
 RowBox[{"Changeorder", "[", 
  RowBox[{"9", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.44973524309647*^9, 3.449735243323517*^9}, {
   3.449735291708096*^9, 3.4497353029971237`*^9}, 3.449911843451694*^9, {
   3.45286136090307*^9, 3.452861361830551*^9}, {3.452866958342491*^9, 
   3.452866960268372*^9}, {3.452876469149296*^9, 3.4528764692263308`*^9}, {
   3.452934200340118*^9, 3.452934200443468*^9}, {3.4529390716621437`*^9, 
   3.452939071858656*^9}, 3.452942427002638*^9, {3.4531164660473747`*^9, 
   3.45311647672005*^9}, {3.4542573691934233`*^9, 3.454257380190888*^9}, {
   3.454303878839952*^9, 3.4543038790306063`*^9}, {3.463407767239812*^9, 
   3.46340776725569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solc", "=", 
   RowBox[{"DSeries", "[", 
    RowBox[{"eq2", ",", "var", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.4542573338935947`*^9, {3.454257375266633*^9, 3.454257376929654*^9}, {
   3.4542574242304363`*^9, 3.454257427509222*^9}, 3.454325085467214*^9, {
   3.4552754332866993`*^9, 3.455275437924972*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"truncorder", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"truncorder", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], "&"}], ",", 
     "ls"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"truncorder", "[", 
    RowBox[{
     RowBox[{"a_", "\[Rule]", "b_"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{"truncorder", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"truncorder", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"expr", "+", 
   RowBox[{
    RowBox[{"O", "[", 
     RowBox[{"x", "-", "x0"}], "]"}], "^", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}]}]}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expapply", "[", 
   RowBox[{"sol_", ",", "ic_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l1", ",", "ce", ",", "ce2", ",", "vl", ",", "vd", ",", "vs", ",", "vv", 
      ",", "sv", ",", "si", ",", "sl", ",", "st", ",", "cs", ",", "rs", ",", 
      "sc"}], "}"}], ",", 
    RowBox[{
     RowBox[{"ce", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"msimp2", "[", 
        RowBox[{
         RowBox[{"ReleaseHold", "[", 
          RowBox[{"ic", "//.", 
           RowBox[{"mkpure", "[", "sol", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ce", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "ce", "]"}], ",", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ce2", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"clist", "[", 
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"#1", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Equal]", "0"}], 
           "]"}], "&"}], ",", "ce"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vv", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"sol", ",", 
         RowBox[{
          RowBox[{"f_", "[", "_", "]"}], "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", "var", "}"}], "]"}], ",", "f"}], "]"}]}], ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sv", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}], ",", "ce2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sc", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"clist", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"Flatten", "[", "sol", "]"}]}], "]"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"si", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"SeriesCoefficient", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["m", "n"], ",", "0", ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "]"}], "\[Equal]", "0"}], "&"}], 
        ",", "sc"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"st", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"sv", ",", "si"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"#", ",", "True"}], "]"}], "&"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "st", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sl", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Quiet", "[", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"st", ",", "vv"}], "]"}], ",", 
         RowBox[{"Solve", "::", "svars"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "sl", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cs", "=", 
      RowBox[{"Flatten", "[", "sl", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rs", "=", 
      RowBox[{"msimp2", "[", 
       RowBox[{
        RowBox[{"sol", "/.", "cs"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "rs"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
     "ce", ",", "ce2", ",", "vl", ",", "vs", ",", "vv", ",", "sv", ",", "sl", 
      ",", "cs"}], "}"}], "*)"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clist", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"_", ",", "_", ",", "ls_List", ",", "_", ",", "_", ",", "_"}], 
      "]"}], "]"}], "]"}], ":=", "ls"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"clist", "[", "expr_", "]"}], ":=", "expr"}]}], "Input",
 CellChangeTimes->{{3.452880591716803*^9, 3.4528806534589243`*^9}, {
  3.452880848856598*^9, 3.4528808945758343`*^9}, {3.45288122957858*^9, 
  3.4528812768960543`*^9}, {3.4528813329863377`*^9, 3.4528813340034437`*^9}, {
  3.452924821276586*^9, 3.452924853915715*^9}, {3.452933619297655*^9, 
  3.452933629534096*^9}, {3.4543251251628923`*^9, 3.4543251255554667`*^9}, {
  3.454325174012054*^9, 3.454325174732881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"csol", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"varsep", "[", 
      RowBox[{"vartens", ",", 
       SuperscriptBox[
        SubscriptBox["m", "n"], "2"]}], "]"}], "/.", 
     RowBox[{"Flatten", "[", "solc", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4494105520516376`*^9, 3.44941057035559*^9}, {
   3.449410635042075*^9, 3.449410638323267*^9}, {3.449471726214342*^9, 
   3.4494717334472*^9}, {3.449472046151045*^9, 3.44947206584776*^9}, 
   3.449911843624037*^9, {3.449993872722911*^9, 3.449993921836329*^9}, {
   3.452876816345545*^9, 3.452876843196783*^9}, {3.454257416883016*^9, 
   3.454257418460857*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solutions", "Section",
 CellChangeTimes->{{3.454325627957344*^9, 3.454325629155334*^9}}],

Cell["General solution", "Text",
 CellChangeTimes->{{3.45433614434416*^9, 3.454336154972846*^9}, {
  3.45433744014349*^9, 3.454337477731647*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl1", "=", 
   RowBox[{"truncorder", "[", 
    RowBox[{
     RowBox[{"expapply", "[", 
      RowBox[{"csol", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["F", 
            RowBox[{"n", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["F", 
            RowBox[{"\[Nu]", ",", "3"}]], "[", "0", "]"}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalPi]", 
            RowBox[{"T", ",", "n"}]], "[", "0", "]"}], "\[Equal]", 
          RowBox[{
           SubscriptBox["\[CapitalPi]", 
            RowBox[{"T", ",", "\[Nu]"}]], "[", "0", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["h", "T"], "[", "0", "]"}], "\[Equal]", "A"}]}], 
        "}"}], ",", "c"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.454257437152809*^9, 3.454257437614333*^9}, {
   3.454257520708035*^9, 3.454257534954289*^9}, {3.454257615716022*^9, 
   3.454257651701068*^9}, {3.45430378694095*^9, 3.4543037873109922`*^9}, {
   3.454303852572349*^9, 3.4543038538598413`*^9}, {3.454325451211775*^9, 
   3.45432545281884*^9}, {3.4543259212729692`*^9, 3.454325921554696*^9}, {
   3.454336159300912*^9, 3.4543361598733788`*^9}, {3.4552754430725393`*^9, 
   3.455275443678521*^9}, {3.4634078464229517`*^9, 3.463407882006461*^9}, {
   3.4634079314862967`*^9, 3.463407934839321*^9}, 3.463730664466176*^9}],

Cell[CellGroupData[{

Cell["Gravitational Wave mode", "Subsubsection",
 CellChangeTimes->{{3.463730675050078*^9, 3.463730679120708*^9}}],

Cell[BoxData[
 RowBox[{"gw1", "=", 
  RowBox[{"mapply", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"sl1", "/.", 
        RowBox[{
         SubscriptBox["s", 
          RowBox[{"T", ",", "B"}]], "\[Rule]", "0"}]}], "/.", 
       RowBox[{"A", "\[Rule]", "1"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "Rn", "+", "R\[Nu]"}], "\[Rule]", 
       RowBox[{"-", "R\[Gamma]"}]}]}], "/.", 
     RowBox[{"R\[Nu]", "\[Rule]", 
      RowBox[{"Rt", "-", "Rn"}]}]}], ",", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
       "]"}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4634085570716*^9, 3.463408577628974*^9}, {
  3.463473805408083*^9, 3.4634738976471243`*^9}, {3.463475315256391*^9, 
  3.4634753509701777`*^9}, {3.4634754914240828`*^9, 3.463475500543179*^9}, {
  3.463730682636944*^9, 3.463730697686639*^9}, {3.463813919222981*^9, 
  3.463813920068028*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"TeXForm", "[", 
    RowBox[{"leadingterm", "[", 
     RowBox[{"gw1", ",", "2"}], "]"}], "]"}], ",", 
   "\"\<latex/tensor_gw.tmx\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.463813909702518*^9, 3.463813973591679*^9}, {
  3.463814028305339*^9, 3.463814045908393*^9}, {3.4638260939232063`*^9, 
  3.4638261082432623`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compensated Magnetic Mode", "Subsubsection",
 CellChangeTimes->{{3.4637307122264357`*^9, 3.463730716814412*^9}}],

Cell[BoxData[
 RowBox[{"mag1", "=", 
  RowBox[{"mapply", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sl1", "/.", 
       RowBox[{"A", "\[Rule]", "0"}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "Rn", "+", "R\[Nu]"}], "\[Rule]", 
       RowBox[{"-", "R\[Gamma]"}]}]}], "/.", 
     RowBox[{"R\[Nu]", "\[Rule]", 
      RowBox[{"Rt", "-", "Rn"}]}]}], ",", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
       "]"}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4634085570716*^9, 3.463408577628974*^9}, {
  3.463473805408083*^9, 3.4634738976471243`*^9}, {3.463475315256391*^9, 
  3.4634753509701777`*^9}, {3.4634754914240828`*^9, 3.463475500543179*^9}, {
  3.4638139286709223`*^9, 3.4638139293699007`*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"TeXForm", "[", 
    RowBox[{"leadingterm", "[", 
     RowBox[{"mag1", ",", "2"}], "]"}], "]"}], ",", 
   "\"\<latex/tensor_mag.tmx\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.463813909702518*^9, 3.463813973591679*^9}, {
  3.463814028305339*^9, 3.463814045908393*^9}, {3.4638260939232063`*^9, 
  3.463826132493782*^9}}],

Cell["Total anisotropic stress", "Text",
 CellChangeTimes->{{3.454336176031459*^9, 3.454336182164999*^9}}],

Cell[BoxData[
 RowBox[{"an1", "=", 
  RowBox[{"msimp2", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["P", "\[Gamma]"], "[", "t", "]"}], 
             SubscriptBox["s", 
              RowBox[{"T", ",", "B"}]]}], "+", 
            RowBox[{
             RowBox[{
              SubscriptBox["P", "n"], "[", "t", "]"}], 
             RowBox[{
              SubscriptBox["\[CapitalPi]", 
               RowBox[{"T", ",", "n"}]], "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{
              SubscriptBox["P", "\[Nu]"], "[", "t", "]"}], 
             RowBox[{
              SubscriptBox["\[CapitalPi]", 
               RowBox[{"T", ",", "\[Nu]"}]], "[", "t", "]"}]}]}], ")"}], "/", 
          
          RowBox[{
           SubscriptBox["P", "s"], "[", "t", "]"}]}], "//.", "tenssub"}], "/.",
         "sl1"}], "/.", 
       RowBox[{"R\[Nu]", "\[Rule]", 
        RowBox[{"Rt", "-", "Rn"}]}]}], "/.", 
      RowBox[{"A", "\[Rule]", "0"}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
      RowBox[{"-", "R\[Gamma]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.454325769428378*^9, 3.454325840707684*^9}, {
  3.454325879455983*^9, 3.454325905026904*^9}, {3.4543362085214443`*^9, 
  3.4543362105231256`*^9}, {3.463476664570241*^9, 3.463476680187707*^9}, {
  3.463476728728621*^9, 3.463476764302721*^9}, {3.463476797672975*^9, 
  3.463476826068289*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Routines for Latex output of solutions", "Subsection",
 CellChangeTimes->{{3.467413124657395*^9, 3.46741313343265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mrearrange", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "c"}], "}"}], ",", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"Series", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"s", ",", 
        SubscriptBox["m", "n"], ",", "0"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"PossibleZeroQ", "[", "c", "]"}], ",", "expr", ",", 
       RowBox[{
        RowBox[{"Factor", "[", 
         RowBox[{"FullSimplify", "[", "c", "]"}], "]"}], " ", 
        RowBox[{"Normal", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"s", "/", "c"}], "]"}], "]"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.457339272389717*^9, 3.457339296448085*^9}, {
  3.4573435906707582`*^9, 3.457343764451169*^9}, {3.4573437963003683`*^9, 
  3.457343897287125*^9}, {3.4573439371665163`*^9, 3.457343939499126*^9}, {
  3.4573443402385397`*^9, 3.457344441555283*^9}, {3.457344498883037*^9, 
  3.457344536165984*^9}, {3.457418329861457*^9, 3.4574183334592867`*^9}, {
  3.457418374003993*^9, 3.457418388075721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mrearrangetex", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "c", ",", "kl", ",", "kc", ",", "wl", ",", "wc"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"Series", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"s", ",", 
        SubscriptBox["m", "n"], ",", "0"}], "]"}]}], ";", 
     RowBox[{"kl", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"c", ",", "k"}], "]"}], ",", 
        RowBox[{"Except", "[", "0", "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"kc", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "kl", "]"}], ">", "0"}], ",", 
        RowBox[{"kl", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"wl", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"kc", ",", "\[Omega]"}], "]"}], ",", 
        RowBox[{"Except", "[", "0", "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"wc", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "wl", "]"}], ">", "0"}], ",", 
        RowBox[{"wl", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PossibleZeroQ", "[", "c", "]"}], ",", "expr", ",", 
        RowBox[{
         RowBox[{"am", "[", 
          RowBox[{"Factor", "[", 
           RowBox[{"FullSimplify", "[", "wc", "]"}], "]"}], "]"}], 
         RowBox[{"bm", "[", " ", 
          RowBox[{"Normal", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"s", "/", "c"}], "]"}], "]"}], "]"}], 
         RowBox[{"cm", "[", 
          RowBox[{"Factor", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"c", "/", "kc"}], "]"}], "]"}], "]"}], " ", 
         RowBox[{"dm", "[", 
          RowBox[{"Factor", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"kc", "/", "wc"}], "]"}], "]"}], "]"}]}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"dm", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"am", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"bm", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"cm", "[", "1", "]"}], "\[Rule]", "1"}]}], "}"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.457339272389717*^9, 3.457339296448085*^9}, {
  3.4573435906707582`*^9, 3.457343764451169*^9}, {3.4573437963003683`*^9, 
  3.457343897287125*^9}, {3.4573439371665163`*^9, 3.457343939499126*^9}, {
  3.4573443402385397`*^9, 3.457344441555283*^9}, {3.457344498883037*^9, 
  3.457344536165984*^9}, {3.457418329861457*^9, 3.4574183334592867`*^9}, {
  3.457418374003993*^9, 3.457418388075721*^9}, {3.463830790934496*^9, 
  3.463830839137805*^9}, {3.463851620847327*^9, 3.463851660564334*^9}, {
  3.4638517700823383`*^9, 3.463851800959392*^9}, {3.463851873660632*^9, 
  3.463851947794298*^9}, {3.463851979986959*^9, 3.463852110669928*^9}, {
  3.463853422395008*^9, 3.463853451537936*^9}, {3.46385362744516*^9, 
  3.4638536279809*^9}, {3.463858671252739*^9, 3.463858689218545*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"proc", "[", "sol_", "]"}], ":=", 
  RowBox[{"mapply", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mapply", "[", 
       RowBox[{
        RowBox[{"mapply", "[", 
         RowBox[{"sol", ",", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], 
           "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["m", "n"], ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}]}], "]"}], "/.", "karrpat"}], "/.", "marrpat"}], ",", 
    "cftwrap"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.46675884904359*^9, 3.4667589000954027`*^9}, {
  3.466758958909902*^9, 3.466758985191132*^9}, {3.4667590270480337`*^9, 
  3.466759046053512*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonzero", "[", "l__", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"l", ",", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"PossibleZeroQ", "[", "#", "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4667570245324297`*^9, 3.466757064142437*^9}, {
  3.466757097057643*^9, 3.46675709832651*^9}}],

Cell[BoxData[
 RowBox[{"karrpat", ":=", 
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"SeriesData", "[", 
     RowBox[{
     "k", ",", "0", ",", "cl__List", ",", "min_", ",", "max_", ",", "den_"}], 
     "]"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"cft", "@@", 
    RowBox[{"nonzero", "[", 
     RowBox[{"Reverse", "[", 
      RowBox[{"cl", "*", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"k", "^", 
          RowBox[{"(", 
           RowBox[{"n", "/", "den"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "min", ",", 
           RowBox[{"min", "+", 
            RowBox[{"Length", "[", "cl", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.466756410091638*^9, 3.4667564438939533`*^9}, {
  3.466756484056635*^9, 3.466756590019882*^9}, {3.4667566679956293`*^9, 
  3.4667567843377542`*^9}, {3.466756824042446*^9, 3.46675688490312*^9}, {
  3.466756964472123*^9, 3.46675699175788*^9}, {3.4667570528933*^9, 
  3.466757057173935*^9}, {3.466757109565956*^9, 3.466757151197554*^9}, {
  3.466758213451933*^9, 3.466758213619544*^9}, {3.4667584071644793`*^9, 
  3.466758408388595*^9}}],

Cell[BoxData[
 RowBox[{"marrpat", ":=", 
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"SeriesData", "[", 
     RowBox[{
      SubscriptBox["m", "n"], ",", "0", ",", "cl__List", ",", "min_", ",", 
      "max_", ",", "den_"}], "]"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"cft", "@@", 
    RowBox[{"nonzero", "[", 
     RowBox[{"cl", "*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["m", "n"], "^", 
         RowBox[{"(", 
          RowBox[{"n1", "/", "den"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n1", ",", "min", ",", 
          RowBox[{"min", "+", 
           RowBox[{"Length", "[", "cl", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
      "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.466756410091638*^9, 3.4667564438939533`*^9}, {
   3.466756484056635*^9, 3.466756590019882*^9}, {3.4667566679956293`*^9, 
   3.4667567843377542`*^9}, {3.466756824042446*^9, 3.46675688490312*^9}, {
   3.466756964472123*^9, 3.46675699175788*^9}, {3.4667570528933*^9, 
   3.466757057173935*^9}, {3.466757109565956*^9, 3.466757151197554*^9}, {
   3.466758184868093*^9, 3.466758217252203*^9}, {3.466758270555121*^9, 
   3.466758282813738*^9}, 3.466758320394904*^9, {3.466758411114645*^9, 
   3.466758412482183*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cftwrap", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"l", "/.", 
     RowBox[{"cft", "\[Rule]", "List"}]}], "/.", 
    RowBox[{"a__List", "\[Rule]", 
     RowBox[{"Flatten", "[", "a", "]"}]}]}], "/.", 
   RowBox[{"List", "\[Rule]", "cft"}]}]}]], "Input",
 CellChangeTimes->{{3.466758443643614*^9, 3.466758502519122*^9}, {
  3.466758549641176*^9, 3.466758566166641*^9}, {3.46675863155079*^9, 
  3.466758635733981*^9}, {3.4667591118798323`*^9, 3.466759144631198*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lterm", "[", 
    RowBox[{"ls_List", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lterm", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}], "&"}], ",", 
     "ls"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lterm", "[", 
    RowBox[{
     RowBox[{"a_", "\[Rule]", "b_"}], ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"a", "\[Rule]", 
    RowBox[{"lterm", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x0", ",", "n"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lterm", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_", ",", "n_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"PossibleZeroQ", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"l", "+", 
       RowBox[{
        RowBox[{"O", "[", 
         RowBox[{"x", "-", "x0"}], "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}]}]}], "]"}], "]"}], ",", 
    RowBox[{"leadingterm", "[", 
     RowBox[{"l", ",", "1"}], "]"}], ",", 
    RowBox[{"l", "+", 
     RowBox[{
      RowBox[{"O", "[", 
       RowBox[{"x", "-", "x0"}], "]"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.464003189894189*^9, 3.4640033472761583`*^9}, {
   3.464003394221793*^9, 3.4640034569288263`*^9}, 3.4640034882574463`*^9, {
   3.4640035485712433`*^9, 3.4640036439878473`*^9}, 3.464003679398302*^9, {
   3.464003792139065*^9, 3.464003804226769*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mktexout", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"sub_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"TeXForm", "[", 
   RowBox[{"StandardForm", "[", 
    RowBox[{
     RowBox[{"mapply", "[", 
      RowBox[{
       RowBox[{"lterm", "[", 
        RowBox[{"l", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       "mrearrangetex"}], "]"}], "/.", "sub"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.46385357992561*^9, 3.463853635091895*^9}, {
  3.463854860977079*^9, 3.463854870230832*^9}, {3.463858377621849*^9, 
  3.463858406220718*^9}, {3.464013401045801*^9, 3.464013407426461*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mktexout2", "[", 
   RowBox[{"l_", ",", 
    RowBox[{"sub_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"TeXForm", "[", 
   RowBox[{"StandardForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"proc", "[", 
       RowBox[{
        RowBox[{"lterm", "[", 
         RowBox[{"l", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}], "//.", "sub"}], 
       "]"}], "//.", "sub"}], "/.", 
     RowBox[{"cft", "\[Rule]", "Plus"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.46385357992561*^9, 3.463853635091895*^9}, {
   3.463854860977079*^9, 3.463854870230832*^9}, {3.463858377621849*^9, 
   3.463858406220718*^9}, 3.4638967280662937`*^9, {3.463897450179668*^9, 
   3.463897451483465*^9}, {3.4640038733376293`*^9, 3.4640038821124*^9}, {
   3.466768300214088*^9, 3.46676834179005*^9}, {3.4667684430277977`*^9, 
   3.466768445511585*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout", "[", 
    RowBox[{"gw1", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
       RowBox[{"-", "R\[Gamma]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/tensor_gw.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4638536380053673`*^9, 3.463853653154214*^9}, {
   3.4638537436087093`*^9, 3.463853786878234*^9}, {3.463854031823382*^9, 
   3.463854037660829*^9}, {3.463854388610531*^9, 3.46385439178435*^9}, {
   3.463854878062914*^9, 3.463854880038478*^9}, {3.463858282866448*^9, 
   3.4638583028716583`*^9}, {3.4638584154680223`*^9, 3.463858434795415*^9}, 
   3.466769247145074*^9, 3.466769324785536*^9}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"mktexout2", "[", 
    RowBox[{
     RowBox[{"mag1", "/.", 
      RowBox[{
       SubscriptBox["s", 
        RowBox[{"T", ",", "B"}]], "\[Rule]", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "Rt"}], "\[Rule]", 
       RowBox[{"-", "R\[Gamma]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<latex/tensor_mag.tmx\>\""}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4638536380053673`*^9, 3.463853653154214*^9}, {
   3.4638537436087093`*^9, 3.463853786878234*^9}, {3.463854031823382*^9, 
   3.463854037660829*^9}, {3.463854388610531*^9, 3.46385439178435*^9}, {
   3.463854878062914*^9, 3.463854880038478*^9}, 3.4638584480767813`*^9, 
   3.466769248756072*^9, {3.466769461205709*^9, 3.466769465934044*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1440, 852},
WindowMargins->{{-12, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Subsubsection"]]}, Visible -> False, FrontEndVersion -> 
  "7.0 for Mac OS X x86 (32-bit) (February 18, 2009)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 26, 0, 20, "Title"],
Cell[CellGroupData[{
Cell[596, 24, 350, 5, 46, "Subtitle"],
Cell[CellGroupData[{
Cell[971, 33, 130, 1, 67, "Section"],
Cell[1104, 36, 290, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[1419, 44, 671, 13, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2093, 59, 237, 5, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2333, 66, 523, 11, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2859, 79, 477, 10, 28, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3385, 95, 109, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[3519, 100, 105, 1, 34, "Subsection"],
Cell[3627, 103, 728, 11, 28, "Input"],
Cell[4358, 116, 1222, 22, 28, "Input"],
Cell[5583, 140, 198, 4, 27, "Text"],
Cell[5784, 146, 411, 10, 28, "Input"],
Cell[6198, 158, 1193, 23, 28, "Input"],
Cell[7394, 183, 1764, 38, 28, "Input"],
Cell[9161, 223, 321, 6, 27, "Text"],
Cell[9485, 231, 851, 16, 28, "Input"],
Cell[10339, 249, 395, 11, 28, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10783, 266, 92, 1, 67, "Section"],
Cell[10878, 269, 1865, 31, 28, "Input"],
Cell[12746, 302, 492, 10, 28, "Input"],
Cell[13241, 314, 595, 17, 28, "Input"],
Cell[13839, 333, 632, 15, 48, "Input"],
Cell[14474, 350, 233, 5, 27, "Text"],
Cell[14710, 357, 384, 10, 30, "Input"],
Cell[15097, 369, 1189, 29, 30, "Input"],
Cell[16289, 400, 132, 2, 27, "Text"],
Cell[16424, 404, 1526, 45, 84, "Input"],
Cell[17953, 451, 807, 23, 48, "Input"],
Cell[18763, 476, 1175, 34, 48, "Input"],
Cell[19941, 512, 641, 15, 28, "Input"],
Cell[20585, 529, 275, 9, 32, "Text"],
Cell[20863, 540, 813, 20, 35, "Input"],
Cell[21679, 562, 591, 14, 28, "Input"],
Cell[22273, 578, 187, 2, 27, "Text"],
Cell[22463, 582, 555, 14, 28, "Input"],
Cell[23021, 598, 697, 11, 28, "Input"],
Cell[23721, 611, 426, 10, 28, "Input"],
Cell[24150, 623, 1128, 37, 66, "Input"],
Cell[25281, 662, 5559, 152, 271, "Input"],
Cell[30843, 816, 680, 15, 35, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31560, 836, 94, 1, 67, "Section"],
Cell[31657, 839, 145, 2, 27, "Text"],
Cell[31805, 843, 1602, 38, 35, "Input"],
Cell[CellGroupData[{
Cell[33432, 885, 114, 1, 25, "Subsubsection"],
Cell[33549, 888, 1135, 31, 35, "Input"],
Cell[34687, 921, 380, 9, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35104, 935, 118, 1, 25, "Subsubsection"],
Cell[35225, 938, 967, 26, 28, "Input"],
Cell[36195, 966, 380, 9, 30, "Input"],
Cell[36578, 977, 106, 1, 27, "Text"],
Cell[36687, 980, 1690, 48, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38414, 1033, 125, 1, 34, "Subsection"],
Cell[38542, 1036, 1324, 33, 30, "Input"],
Cell[39869, 1071, 3516, 86, 81, "Input"],
Cell[43388, 1159, 977, 28, 30, "Input"],
Cell[44368, 1189, 344, 9, 30, "Input"],
Cell[44715, 1200, 1179, 28, 30, "Input"],
Cell[45897, 1230, 1257, 29, 30, "Input"],
Cell[47157, 1261, 517, 12, 30, "Input"],
Cell[47677, 1275, 1802, 54, 66, "Input"],
Cell[49482, 1331, 686, 18, 30, "Input"],
Cell[50171, 1351, 925, 23, 30, "Input"],
Cell[51099, 1376, 822, 19, 30, "Input"],
Cell[51924, 1397, 889, 22, 35, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

