(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     53878,       1501]*)
(*NotebookOutlinePosition[     54902,       1537]*)
(*  CellTagsIndexPosition[     54826,       1531]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["ExtractFreeIndices", "ObjectName",
  CellTags->"Function?"],

Cell[TextData[{
  "\[FilledSmallSquare] ",
  Cell[BoxData[
      RowBox[{
        StyleBox["ExtractFreeIndices",
          "MR"], 
        StyleBox["[",
          "MR"], 
        StyleBox["expression",
          "TI"], 
        StyleBox["]",
          "MR"]}]]],
  " will return ",
  Cell[BoxData[
      RowBox[{"{", 
        RowBox[{"upindices", ",", "downindices"}], "}"}]]],
  " where each is a list of the free indices in the expression."
}], "Usage",
  CellTags->"Function?"],

Cell["\<\
 The expression may be an equation, a sum of terms, or a single tensor \
term.\
\>", "MathCaption"],

Cell["\<\
 The routine may be used to check index balance in an equation or expression. \
If the terms don't all have the same free indices an error message is \
generated and False is returned.\
\>", "MathCaption"],

Cell["\<\
 This routine is primarily used in programming other routines.\
\>", "MathCaption"],

Cell["\<\
 Free indices are indices that appear only once in each term.\
\>", "MathCaption"],

Cell["\<\
 upindices and downindices are each returned in the natural sort order.\
\>", "MathCaption"],

Cell[TextData[{
  Cell[BoxData[
      \(ExtractFreeIndices\)]],
  " uses the ",
  Cell[BoxData[
      \(ParseTermIndices\)]],
  " routine. You can use ",
  Cell[BoxData[
      \(IndexParsingRules\)]],
  " to implement tensor expressions that are not normally recognized by ",
  Cell[BoxData[
      \(ParseTermIndices\)]],
  "."
}], "MathCaption"],

Cell[TextData[{
  "See also: ",
  ButtonBox["ParseTermIndices",
    ButtonData:>{"ParseTermIndices"},
    ButtonStyle->"AddOnsLink"],
  ", ",
  ButtonBox["IndexParsingRules",
    ButtonData:>{"IndexParsingRules"},
    ButtonStyle->"AddOnsLink"],
  ", ",
  ButtonBox["EinsteinArray",
    ButtonData:>{"EinsteinArray"},
    ButtonStyle->"AddOnsLink"],
  "."
}], "MathCaption"],

Cell[CellGroupData[{

Cell["Examples", "ExampleSection"],

Cell[BoxData[
    \(Needs["\<TensorCalculus4`Tensorial`\>"]\)], "Input",
  CellLabel->"In[1]:="],

Cell["Save the old settings.", "Text"],

Cell[BoxData[{
    \(\(oldindices = CompleteBaseIndices;\)\), "\n", 
    \(\(oldflavors = IndexFlavors;\)\), "\n", 
    \(\(ClearIndexFlavor /@ oldflavors;\)\)}], "Input",
  CellLabel->"In[2]:="],

Cell[BoxData[{
    \(\(DeclareBaseIndices[Range[3]];\)\), "\n", 
    \(\(DeclareIndexFlavor /@ {{red, Red}, {rocket, 
            SuperDagger}};\)\), "\n", 
    \(DefineTensorShortcuts[{{x, y, F, T}, 1}, {{S, T}, 2}]\)}], "Input",
  CellLabel->"In[5]:="],

Cell["With an equation...", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Sud[i, j] xu[j] yd[m] \[Equal] Tud[i, k] xu[k] yd[m] // 
      ToFlavor[red]\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[8]:="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["j",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["j",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            red[ i], Void}, {Void, 
            red[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["j",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["j",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ j]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", 
            TagBox[
              StyleBox["m",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["m",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            red[ m]}],
          Editable->False]}], "\[Equal]", 
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["k",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["k",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            red[ i], Void}, {Void, 
            red[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ k]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", 
            TagBox[
              StyleBox["m",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["m",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            red[ m]}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[8]="],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          TagBox[
            StyleBox["i",
              FontColor->RGBColor[1, 0, 0]],
            (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], "}"}], ",", 
        RowBox[{"{", 
          TagBox[
            StyleBox["m",
              FontColor->RGBColor[1, 0, 0]],
            (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], "}"}]}], 
      "}"}]], "Output",
  CellLabel->"Out[9]="]
}, Open  ]],

Cell["With a sum...", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Sud[i, j] xu[j] yd[m] - Tud[i, k] xu[k] yd[m] // 
      ToFlavor[rocket]\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[10]:="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[\(i\^\[Dagger]\),
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], \(j\^\[Dagger]\)}], 
            
            RowBox[{\(i\^\[Dagger]\), 
              TagBox[
                StyleBox[\(j\^\[Dagger]\),
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            rocket[ i], Void}, {Void, 
            rocket[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[\(j\^\[Dagger]\),
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], \(j\^\[Dagger]\)],
          Tensor[ x, {
            rocket[ j]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", \(m\^\[Dagger]\), 
            TagBox[
              StyleBox[\(m\^\[Dagger]\),
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            rocket[ m]}],
          Editable->False]}], "-", 
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[\(i\^\[Dagger]\),
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], \(k\^\[Dagger]\)}], 
            
            RowBox[{\(i\^\[Dagger]\), 
              TagBox[
                StyleBox[\(k\^\[Dagger]\),
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            rocket[ i], Void}, {Void, 
            rocket[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[\(k\^\[Dagger]\),
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], \(k\^\[Dagger]\)],
          Tensor[ x, {
            rocket[ k]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", \(m\^\[Dagger]\), 
            TagBox[
              StyleBox[\(m\^\[Dagger]\),
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            rocket[ m]}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[10]="],

Cell[BoxData[
    \({{i\^\[Dagger]}, {m\^\[Dagger]}}\)], "Output",
  CellLabel->"Out[11]="]
}, Open  ]],

Cell["The following expressions are incorrect.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Sud[i, j] xu[j] yd[m] \[Equal] Tud[i, k] xu[k] yd[n] // 
      ToFlavor[red]\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[12]:="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["j",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["j",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            red[ i], Void}, {Void, 
            red[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["j",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["j",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ j]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", 
            TagBox[
              StyleBox["m",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["m",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            red[ m]}],
          Editable->False]}], "\[Equal]", 
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["k",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["k",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            red[ i], Void}, {Void, 
            red[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ k]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", 
            TagBox[
              StyleBox["n",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["n",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            red[ n]}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[12]="],

Cell[BoxData[
    \(FreeIndices::"notmatched" \(\(:\)\(\ \)\) 
      "The free indices are not the same in all terms of the expression or \
some terms have bad indices."\)], "Message",
  CellLabel->"From In[12]:="],

Cell[BoxData[
    \(False\)], "Output",
  CellLabel->"Out[13]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Sud[i, j] xu[j] yd[m] \[Equal] Tud[i, k] xu[k] yd[k] // 
      ToFlavor[red]\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[14]:="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["j",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["j",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            red[ i], Void}, {Void, 
            red[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["j",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["j",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ j]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", 
            TagBox[
              StyleBox["m",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["m",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            red[ m]}],
          Editable->False]}], "\[Equal]", 
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["k",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["k",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            red[ i], Void}, {Void, 
            red[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ k]}, {Void}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["y", 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)]],
          Tensor[ y, {Void}, {
            red[ k]}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[14]="],

Cell[BoxData[
    \(FreeIndices::"notmatched" \(\(:\)\(\ \)\) 
      "The free indices are not the same in all terms of the expression or \
some terms have bad indices."\)], "Message",
  CellLabel->"From In[14]:="],

Cell[BoxData[
    \(False\)], "Output",
  CellLabel->"Out[15]="]
}, Open  ]],

Cell["Expressions involving differentiations.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Sud[i, j] xu[j] CovariantD[Td[\[Mu]], m] \[Equal] 
        Tud[i, k] xu[k] CovariantD[Td[\[Mu]], m] // 
      ToFlavor[red]\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[16]:="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubscriptBox[
            InterpretationBox[
              SubsuperscriptBox["T", 
                TagBox[
                  StyleBox["\[Mu]",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                TagBox[
                  StyleBox[
                    TagBox[
                      StyleBox["\[Mu]",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                    ShowContents->False],
                  (StyleForm[ #, ShowContents -> False]&)]],
              Tensor[ T, {Void}, {
                red[ \[Mu]]}],
              Editable->False], 
            RowBox[{";", 
              TagBox[
                StyleBox["m",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}]],
          CovariantD[ 
            Tensor[ T, {Void}, {
              red[ \[Mu]]}], 
            red[ m]],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["j",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["j",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            red[ i], Void}, {Void, 
            red[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["j",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["j",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ j]}, {Void}],
          Editable->False]}], "\[Equal]", 
      RowBox[{
        InterpretationBox[
          SubscriptBox[
            InterpretationBox[
              SubsuperscriptBox["T", 
                TagBox[
                  StyleBox["\[Mu]",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                TagBox[
                  StyleBox[
                    TagBox[
                      StyleBox["\[Mu]",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                    ShowContents->False],
                  (StyleForm[ #, ShowContents -> False]&)]],
              Tensor[ T, {Void}, {
                red[ \[Mu]]}],
              Editable->False], 
            RowBox[{";", 
              TagBox[
                StyleBox["m",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}]],
          CovariantD[ 
            Tensor[ T, {Void}, {
              red[ \[Mu]]}], 
            red[ m]],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["k",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["k",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            red[ i], Void}, {Void, 
            red[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ k]}, {Void}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[16]="],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          TagBox[
            StyleBox["i",
              FontColor->RGBColor[1, 0, 0]],
            (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            TagBox[
              StyleBox["m",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], ",", 
            TagBox[
              StyleBox["\[Mu]",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], "}"}]}], 
      "}"}]], "Output",
  CellLabel->"Out[17]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Sud[i, j] xu[j] CovariantD[Td[\[Mu]], m] \[Equal] 
        Tud[i, k] xu[k] CovariantD[Td[\[Mu]], m] // 
      ToFlavor[red]\), "\[IndentingNewLine]", 
    \(ExpandCovariantD[{x, \[Delta], g, \[CapitalGamma]}, 
        red@a] /@ %\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[18]:="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubscriptBox[
            InterpretationBox[
              SubsuperscriptBox["T", 
                TagBox[
                  StyleBox["\[Mu]",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                TagBox[
                  StyleBox[
                    TagBox[
                      StyleBox["\[Mu]",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                    ShowContents->False],
                  (StyleForm[ #, ShowContents -> False]&)]],
              Tensor[ T, {Void}, {
                red[ \[Mu]]}],
              Editable->False], 
            RowBox[{";", 
              TagBox[
                StyleBox["m",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}]],
          CovariantD[ 
            Tensor[ T, {Void}, {
              red[ \[Mu]]}], 
            red[ m]],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["j",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["j",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            red[ i], Void}, {Void, 
            red[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["j",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["j",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ j]}, {Void}],
          Editable->False]}], "\[Equal]", 
      RowBox[{
        InterpretationBox[
          SubscriptBox[
            InterpretationBox[
              SubsuperscriptBox["T", 
                TagBox[
                  StyleBox["\[Mu]",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                TagBox[
                  StyleBox[
                    TagBox[
                      StyleBox["\[Mu]",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                    ShowContents->False],
                  (StyleForm[ #, ShowContents -> False]&)]],
              Tensor[ T, {Void}, {
                red[ \[Mu]]}],
              Editable->False], 
            RowBox[{";", 
              TagBox[
                StyleBox["m",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}]],
          CovariantD[ 
            Tensor[ T, {Void}, {
              red[ \[Mu]]}], 
            red[ m]],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["k",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["k",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            red[ i], Void}, {Void, 
            red[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ k]}, {Void}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[18]="],

Cell[BoxData[
    RowBox[{
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["S", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["j",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["j",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ S, {
            red[ i], Void}, {Void, 
            red[ j]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["j",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["j",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ j]}, {Void}],
          Editable->False], " ", 
        RowBox[{"(", 
          RowBox[{
            RowBox[{
              RowBox[{"-", 
                InterpretationBox[
                  SubsuperscriptBox["T", 
                    TagBox[
                      StyleBox["a",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["a",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)]],
                  Tensor[ T, {Void}, {
                    red[ a]}],
                  Editable->False]}], " ", 
              InterpretationBox[
                SubsuperscriptBox["\[CapitalGamma]", 
                  RowBox[{
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["a",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)], 
                    TagBox[
                      StyleBox["m",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                    TagBox[
                      StyleBox["\[Mu]",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
                  RowBox[{
                    TagBox[
                      StyleBox["a",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["m",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)], 
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["\[Mu]",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)]}]],
                Tensor[ \[CapitalGamma], {
                  red[ a], Void, Void}, {Void, 
                  red[ m], 
                  red[ \[Mu]]}],
                Editable->False]}], "+", 
            InterpretationBox[
              FractionBox[
                RowBox[{"\[PartialD]", 
                  InterpretationBox[
                    SubsuperscriptBox["T", 
                      TagBox[
                        StyleBox["\[Mu]",
                          FontColor->RGBColor[1, 0, 0]],
                        (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                      TagBox[
                        StyleBox[
                          TagBox[
                            StyleBox["\[Mu]",
                              FontColor->RGBColor[1, 0, 0]],
                            (
                            StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                          
                          ShowContents->False],
                        (StyleForm[ #, ShowContents -> False]&)]],
                    Tensor[ T, {Void}, {
                      red[ \[Mu]]}],
                    Editable->False]}], 
                RowBox[{"\[PartialD]", 
                  InterpretationBox[
                    SubsuperscriptBox["x", 
                      TagBox[
                        StyleBox[
                          TagBox[
                            StyleBox["m",
                              FontColor->RGBColor[1, 0, 0]],
                            (
                            StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                          
                          ShowContents->False],
                        (StyleForm[ #, ShowContents -> False]&)], 
                      TagBox[
                        StyleBox["m",
                          FontColor->RGBColor[1, 0, 0]],
                        (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
                    Tensor[ x, {
                      red[ m]}, {Void}],
                    Editable->False]}]],
              PartialD[ {x, \[Delta], g, \[CapitalGamma]}][ 
                Tensor[ T, {Void}, {
                  red[ \[Mu]]}], 
                Tensor[ x, {
                  red[ m]}, {Void}]],
              Editable->False]}], ")"}]}], "\[Equal]", 
      RowBox[{
        InterpretationBox[
          SubsuperscriptBox["T", 
            RowBox[{
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["i",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)], 
              TagBox[
                StyleBox["k",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
            RowBox[{
              TagBox[
                StyleBox["i",
                  FontColor->RGBColor[1, 0, 0]],
                (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
              TagBox[
                StyleBox[
                  TagBox[
                    StyleBox["k",
                      FontColor->RGBColor[1, 0, 0]],
                    (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                  ShowContents->False],
                (StyleForm[ #, ShowContents -> False]&)]}]],
          Tensor[ T, {
            red[ i], Void}, {Void, 
            red[ k]}],
          Editable->False], " ", 
        InterpretationBox[
          SubsuperscriptBox["x", 
            TagBox[
              StyleBox[
                TagBox[
                  StyleBox["k",
                    FontColor->RGBColor[1, 0, 0]],
                  (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                ShowContents->False],
              (StyleForm[ #, ShowContents -> False]&)], 
            TagBox[
              StyleBox["k",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
          Tensor[ x, {
            red[ k]}, {Void}],
          Editable->False], " ", 
        RowBox[{"(", 
          RowBox[{
            RowBox[{
              RowBox[{"-", 
                InterpretationBox[
                  SubsuperscriptBox["T", 
                    TagBox[
                      StyleBox["a",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["a",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)]],
                  Tensor[ T, {Void}, {
                    red[ a]}],
                  Editable->False]}], " ", 
              InterpretationBox[
                SubsuperscriptBox["\[CapitalGamma]", 
                  RowBox[{
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["a",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)], 
                    TagBox[
                      StyleBox["m",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                    TagBox[
                      StyleBox["\[Mu]",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], 
                  RowBox[{
                    TagBox[
                      StyleBox["a",
                        FontColor->RGBColor[1, 0, 0]],
                      (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["m",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)], 
                    TagBox[
                      StyleBox[
                        TagBox[
                          StyleBox["\[Mu]",
                            FontColor->RGBColor[1, 0, 0]],
                          (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                        ShowContents->False],
                      (StyleForm[ #, ShowContents -> False]&)]}]],
                Tensor[ \[CapitalGamma], {
                  red[ a], Void, Void}, {Void, 
                  red[ m], 
                  red[ \[Mu]]}],
                Editable->False]}], "+", 
            InterpretationBox[
              FractionBox[
                RowBox[{"\[PartialD]", 
                  InterpretationBox[
                    SubsuperscriptBox["T", 
                      TagBox[
                        StyleBox["\[Mu]",
                          FontColor->RGBColor[1, 0, 0]],
                        (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], 
                      TagBox[
                        StyleBox[
                          TagBox[
                            StyleBox["\[Mu]",
                              FontColor->RGBColor[1, 0, 0]],
                            (
                            StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                          
                          ShowContents->False],
                        (StyleForm[ #, ShowContents -> False]&)]],
                    Tensor[ T, {Void}, {
                      red[ \[Mu]]}],
                    Editable->False]}], 
                RowBox[{"\[PartialD]", 
                  InterpretationBox[
                    SubsuperscriptBox["x", 
                      TagBox[
                        StyleBox[
                          TagBox[
                            StyleBox["m",
                              FontColor->RGBColor[1, 0, 0]],
                            (
                            StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)],
                          
                          ShowContents->False],
                        (StyleForm[ #, ShowContents -> False]&)], 
                      TagBox[
                        StyleBox["m",
                          FontColor->RGBColor[1, 0, 0]],
                        (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]],
                    Tensor[ x, {
                      red[ m]}, {Void}],
                    Editable->False]}]],
              PartialD[ {x, \[Delta], g, \[CapitalGamma]}][ 
                Tensor[ T, {Void}, {
                  red[ \[Mu]]}], 
                Tensor[ x, {
                  red[ m]}, {Void}]],
              Editable->False]}], ")"}]}]}]], "Output",
  CellLabel->"Out[19]="],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          TagBox[
            StyleBox["i",
              FontColor->RGBColor[1, 0, 0]],
            (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            TagBox[
              StyleBox["m",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)], ",", 
            TagBox[
              StyleBox["\[Mu]",
                FontColor->RGBColor[1, 0, 0]],
              (StyleForm[ #, FontColor -> RGBColor[ 1, 0, 0]]&)]}], "}"}]}], 
      "}"}]], "Output",
  CellLabel->"Out[20]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Fu[i] \[Equal] m\ TotalD[xu[i], {t, t}]\), "\[IndentingNewLine]", 
    \(% // ExtractFreeIndices\)}], "Input",
  CellLabel->"In[21]:="],

Cell[BoxData[
    RowBox[{
      InterpretationBox[
        SubsuperscriptBox["F", 
          TagBox[
            StyleBox["i",
              ShowContents->False],
            (StyleForm[ #, ShowContents -> False]&)], "i"],
        Tensor[ F, {i}, {Void}],
        Editable->False], "\[Equal]", 
      RowBox[{"m", " ", 
        InterpretationBox[
          FractionBox[
            RowBox[{\(\[DifferentialD]\^2\), 
              InterpretationBox[
                SubsuperscriptBox["x", 
                  TagBox[
                    StyleBox["i",
                      ShowContents->False],
                    (StyleForm[ #, ShowContents -> False]&)], "i"],
                Tensor[ x, {i}, {Void}],
                Editable->False]}], \(\[DifferentialD]t \[DifferentialD]t\)],
          TotalD[ 
            Tensor[ x, {i}, {Void}], {t, t}],
          Editable->False]}]}]], "Output",
  CellLabel->"Out[21]="],

Cell[BoxData[
    \({{i}, {}}\)], "Output",
  CellLabel->"Out[22]="]
}, Open  ]],

Cell["Restore the initial settings...", "Text"],

Cell[BoxData[
    \(ClearTensorShortcuts[{{x, y, F}, 1}, {{S, T}, 2}]\)], "Input",
  CellLabel->"In[23]:="],

Cell[BoxData[{
    \(DeclareBaseIndices @@ oldindices\), "\[IndentingNewLine]", 
    \(\(ClearIndexFlavor /@ IndexFlavors;\)\), "\[IndentingNewLine]", 
    \(\(DeclareIndexFlavor /@ oldflavors;\)\), "\[IndentingNewLine]", 
    \(Clear[oldindices, oldflavors]\)}], "Input",
  CellLabel->"In[24]:="]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"5.2 for Microsoft Windows",
ScreenRectangle->{{0, 1680}, {0, 965}},
ScreenStyleEnvironment->"Working",
WindowToolbars->{},
WindowSize->{669, 474},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
CommonDefaultFormatTypes->{"Output"->StandardForm},
Magnification->1,
StyleDefinitions -> "HelpBrowser.nb"
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{
  "Function?"->{
    Cell[1776, 53, 65, 1, 41, "ObjectName",
      CellTags->"Function?"],
    Cell[1844, 56, 480, 18, 50, "Usage",
      CellTags->"Function?"]}
  }
*)

(*CellTagsIndex
CellTagsIndex->{
  {"Function?", 54655, 1522}
  }
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 65, 1, 41, "ObjectName",
  CellTags->"Function?"],
Cell[1844, 56, 480, 18, 50, "Usage",
  CellTags->"Function?"],
Cell[2327, 76, 109, 3, 41, "MathCaption"],
Cell[2439, 81, 215, 4, 58, "MathCaption"],
Cell[2657, 87, 93, 2, 41, "MathCaption"],
Cell[2753, 91, 92, 2, 41, "MathCaption"],
Cell[2848, 95, 102, 2, 41, "MathCaption"],
Cell[2953, 99, 346, 13, 58, "MathCaption"],
Cell[3302, 114, 374, 14, 41, "MathCaption"],

Cell[CellGroupData[{
Cell[3701, 132, 34, 0, 39, "ExampleSection"],
Cell[3738, 134, 96, 2, 29, "Input"],
Cell[3837, 138, 38, 0, 25, "Text"],
Cell[3878, 140, 195, 4, 69, "Input"],
Cell[4076, 146, 254, 5, 69, "Input"],
Cell[4333, 153, 35, 0, 25, "Text"],

Cell[CellGroupData[{
Cell[4393, 157, 192, 4, 49, "Input"],
Cell[4588, 163, 5060, 136, 30, "Output"],
Cell[9651, 301, 467, 14, 27, "Output"]
}, Open  ]],
Cell[10133, 318, 29, 0, 25, "Text"],

Cell[CellGroupData[{
Cell[10187, 322, 189, 4, 49, "Input"],
Cell[10379, 328, 2608, 74, 36, "Output"],
Cell[12990, 404, 91, 2, 27, "Output"]
}, Open  ]],
Cell[13096, 409, 56, 0, 25, "Text"],

Cell[CellGroupData[{
Cell[13177, 413, 193, 4, 49, "Input"],
Cell[13373, 419, 5061, 136, 30, "Output"],
Cell[18437, 557, 214, 4, 35, "Message"],
Cell[18654, 563, 64, 2, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[18755, 570, 193, 4, 49, "Input"],
Cell[18951, 576, 5061, 136, 30, "Output"],
Cell[24015, 714, 214, 4, 35, "Message"],
Cell[24232, 720, 64, 2, 27, "Output"]
}, Open  ]],
Cell[24311, 725, 55, 0, 25, "Text"],

Cell[CellGroupData[{
Cell[24391, 729, 240, 5, 69, "Input"],
Cell[24634, 736, 5993, 160, 30, "Output"],
Cell[30630, 898, 668, 19, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[31335, 922, 346, 7, 89, "Input"],
Cell[31684, 931, 5993, 160, 30, "Output"],
Cell[37680, 1093, 13847, 330, 50, "Output"],
Cell[51530, 1425, 668, 19, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[52235, 1449, 156, 3, 49, "Input"],
Cell[52394, 1454, 913, 25, 44, "Output"],
Cell[53310, 1481, 68, 2, 27, "Output"]
}, Open  ]],
Cell[53393, 1486, 47, 0, 25, "Text"],
Cell[53443, 1488, 107, 2, 29, "Input"],
Cell[53553, 1492, 297, 5, 89, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

