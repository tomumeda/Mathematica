(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    480346,      13111]
NotebookOptionsPosition[    474503,      13004]
NotebookOutlinePosition[    474870,      13020]
CellTagsIndexPosition[    474827,      13017]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", "Local`QFTToolKit2`"}], "\[IndentingNewLine]", 
 RowBox[{"URL", "[", 
  "\"\<https://en.wikipedia.org/wiki/Quantum_Fourier_transform\>\"", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56864327369387*^9, 3.5686433185337973`*^9}, {
   3.636124223447123*^9, 3.6361242241696672`*^9}, {3.640430449322165*^9, 
   3.640430454418408*^9}, {3.6464973100744457`*^9, 3.646497314447693*^9}, {
   3.6694279608619347`*^9, 3.6694280040414133`*^9}, 3.670117817981682*^9, {
   3.671366579055991*^9, 3.6713666038803663`*^9}, {3.689772928097857*^9, 
   3.689772930433343*^9}, {3.732388727865262*^9, 3.732388755781152*^9}, {
   3.777221915099526*^9, 
   3.777221934544393*^9}},ExpressionUUID->"84b635f0-dfe8-4c63-9e30-\
ffbddbb730c0"],

Cell[BoxData["\<\"Tue 18 Feb 2020 14:21:55\"\>"], "Output",
 CellChangeTimes->{
  3.732389343875825*^9, {3.732624576840604*^9, 3.732624577814939*^9}, {
   3.7772219593224363`*^9, 3.777221959813287*^9}, 3.777371999897935*^9, {
   3.777901662983486*^9, 3.777901664113377*^9}, {3.778423753967823*^9, 
   3.778423754659061*^9}, {3.778763615896709*^9, 3.778763616251398*^9}, {
   3.778804135468916*^9, 3.7788041358499928`*^9}, 3.788269546263352*^9, 
   3.789220780875916*^9, 3.789872614733667*^9, 3.789995596584564*^9, 
   3.789996810367841*^9, 3.789996987445615*^9, {3.790614303213442*^9, 
   3.7906143039671297`*^9}, {3.790784390224893*^9, 3.79078441534319*^9}, {
   3.791053312982347*^9, 
   3.791053315518633*^9}},ExpressionUUID->"9173cde1-df8a-4ed2-8877-\
f9342bdbc985"],

Cell[BoxData[
 RowBox[{"URL", "[", 
  TemplateBox[{"\"https://en.wikipedia.org/wiki/Quantum_Fourier_transform\""},
   
   "URLArgument"], "]"}]], "Output",
 CellChangeTimes->{
  3.732389343875825*^9, {3.732624576840604*^9, 3.732624577814939*^9}, {
   3.7772219593224363`*^9, 3.777221959813287*^9}, 3.777371999897935*^9, {
   3.777901662983486*^9, 3.777901664113377*^9}, {3.778423753967823*^9, 
   3.778423754659061*^9}, {3.778763615896709*^9, 3.778763616251398*^9}, {
   3.778804135468916*^9, 3.7788041358499928`*^9}, 3.788269546263352*^9, 
   3.789220780875916*^9, 3.789872614733667*^9, 3.789995596584564*^9, 
   3.789996810367841*^9, 3.789996987445615*^9, {3.790614303213442*^9, 
   3.7906143039671297`*^9}, {3.790784390224893*^9, 3.79078441534319*^9}, {
   3.791053312982347*^9, 
   3.791053315538331*^9}},ExpressionUUID->"4f0f31c1-6d25-4783-bcfd-\
9e4a81a34815"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
   "\"\<Single qubit example: \>\"", ",", "\[IndentingNewLine]", "NL", ",", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$s", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["x", "0"], "\[Rule]", 
               RowBox[{
                RowBox[{"\[Alpha]", " ", 
                 RowBox[{"Ket", "[", "0", "]"}]}], "+", 
                RowBox[{"\[Beta]", " ", 
                 RowBox[{"Ket", "[", "1", "]"}]}]}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "\[Element]", 
               "\[DoubleStruckCapitalC]"}], ",", 
              RowBox[{
               RowBox[{"Norm", "[", 
                SubscriptBox["x", "0"], "]"}], "\[Rule]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "1", "}"}]}], "}"}]}], ",", 
              RowBox[{
               RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
             "}"}], "[", 
            RowBox[{"CG", "[", "\"\<basis\>\"", "]"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "[", 
         RowBox[{"CG", "[", "\"\<single qubit\>\"", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"$hada", "=", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"CG", "[", "\"\<Hadamar gate\>\"", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "/", 
           RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$", "=", 
            RowBox[{"H", ".", 
             SubscriptBox["x", "0"]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"$", "=", 
            RowBox[{"$", "//.", 
             RowBox[{"tuRule", "[", 
              RowBox[{"{", 
               RowBox[{"$hada", ",", "$s"}], "}"}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "}"}], "[", 
         RowBox[{
         "CG", "[", 
          "\"\<after Hadamar operation destinguishes between \
{\[Alpha],\[Beta]}->{1,1} and {\[Alpha],\[Beta]}->{1,-1} states\>\"", "]"}], 
         "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", 
      RowBox[{"$", "//", "MatrixForms"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.788269439928598*^9, 3.788269626999556*^9}, {
   3.78826968972011*^9, 3.788269909521428*^9}, {3.788269949563177*^9, 
   3.788270152670101*^9}, {3.788270334137499*^9, 3.7882703548017807`*^9}, {
   3.788270411533176*^9, 3.788270428902052*^9}, {3.788270459677696*^9, 
   3.788270463211211*^9}, {3.788270495450848*^9, 3.788270502538643*^9}, 
   3.788270763512867*^9, {3.788270839842999*^9, 3.788270854634262*^9}, {
   3.788270913487665*^9, 3.788270916839665*^9}, {3.7882709554473333`*^9, 
   3.7882711009156017`*^9}, {3.788271148330003*^9, 3.788271383892338*^9}, {
   3.788271419410075*^9, 3.788271494626346*^9}, {3.788271556665604*^9, 
   3.7882717501331463`*^9}, {3.788271809353796*^9, 3.788271873919417*^9}, {
   3.788271942376172*^9, 3.78827195696706*^9}, 3.788272027453775*^9, {
   3.788272064526188*^9, 3.78827224652561*^9}, {3.788272283847517*^9, 
   3.78827241823269*^9}, {3.788273559943215*^9, 
   3.788273660791875*^9}},ExpressionUUID->"6e9f982a-9d9a-4631-9902-\
323f8af8694d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Single qubit example: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "0"], "\[Rule]", 
                RowBox[{
                 RowBox[{"\[Alpha]", " ", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[0],
                   Editable->False,
                   SyntaxForm->Automatic]}], "+", 
                 RowBox[{"\[Beta]", " ", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[1],
                   Editable->False,
                   SyntaxForm->Automatic]}]}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "\[Element]", 
                "\[DoubleStruckCapitalC]"}], ",", 
               RowBox[{
                RowBox[{"Norm", "[", 
                 SubscriptBox["x", "0"], "]"}], "\[Rule]", "1"}], ",", 
               RowBox[{
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "0", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[0],
                 Editable->False,
                 SyntaxForm->Automatic], "\[Rule]", 
                TagBox[
                 RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0"},
                    {"1"}
                   },
                   
                   GridBoxAlignment->{
                    "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                   GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
                 Function[BoxForm`e$, 
                  MatrixForm[BoxForm`e$]]]}], ",", 
               RowBox[{
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "1", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[1],
                 Editable->False,
                 SyntaxForm->Automatic], "\[Rule]", 
                TagBox[
                 RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1"},
                    {"0"}
                   },
                   
                   GridBoxAlignment->{
                    "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                   GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                    "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
                 Function[BoxForm`e$, 
                  MatrixForm[BoxForm`e$]]]}]}], "}"}], "[", 
             StyleBox["\<\"basis\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"single qubit\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       RowBox[{
        RowBox[{"H", "[", 
         StyleBox["\<\"Hadamar gate\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}], "\[Rule]", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             FractionBox["1", 
              SqrtBox["2"]], 
             FractionBox["1", 
              SqrtBox["2"]]},
            {
             FractionBox["1", 
              SqrtBox["2"]], 
             RowBox[{"-", 
              FractionBox["1", 
               SqrtBox["2"]]}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"H", ".", 
             SubscriptBox["x", "0"]}]},
           {
            TagBox[
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {
                 RowBox[{
                  FractionBox["\[Alpha]", 
                   SqrtBox["2"]], "+", 
                  FractionBox["\[Beta]", 
                   SqrtBox["2"]]}]},
                {
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Alpha]", 
                    SqrtBox["2"]]}], "+", 
                  FractionBox["\[Beta]", 
                   SqrtBox["2"]]}]}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
             Function[BoxForm`e$, 
              MatrixForm[BoxForm`e$]]]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"after Hadamar operation destinguishes between \
{\[Alpha],\[Beta]}->{1,1} and {\[Alpha],\[Beta]}->{1,-1} states\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Single qubit example: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{
         {
         Subscript[$CellContext`x, 0] -> $CellContext`\[Alpha] 
            Ket[0] + $CellContext`\[Beta] Ket[1], 
          
          Element[{$CellContext`\[Alpha], $CellContext`\[Beta]}, \
$CellContext`\[DoubleStruckCapitalC]], Norm[
            Subscript[$CellContext`x, 0]] -> 1, Ket[0] -> 
          MatrixForm[{{0}, {1}}], Ket[1] -> MatrixForm[{{1}, {0}}]}[
          Style["basis", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["single qubit", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {$CellContext`H[
        Style["Hadamar gate", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]] -> 
      MatrixForm[{{2^Rational[-1, 2], 2^Rational[-1, 2]}, {
         2^Rational[-1, 2], -2^Rational[-1, 2]}}]}, {
      Grid[{{
         Dot[$CellContext`H, 
          Subscript[$CellContext`x, 0]]}, {
         MatrixForm[{{
           2^Rational[-1, 2] $CellContext`\[Alpha] + 
            2^Rational[-1, 2] $CellContext`\[Beta]}, {-2^
              Rational[-1, 2] $CellContext`\[Alpha] + 
            2^Rational[-1, 2] $CellContext`\[Beta]}}]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style[
       "after Hadamar operation destinguishes between \
{\[Alpha],\[Beta]}->{1,1} and {\[Alpha],\[Beta]}->{1,-1} states", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.788272247533723*^9, {3.788272284573114*^9, 3.788272360062121*^9}, {
   3.788272390194449*^9, 3.7882724190844927`*^9}, {3.788273632245182*^9, 
   3.788273661461309*^9}, 3.790614304127138*^9, 3.790784415524397*^9, 
   3.791053315787354*^9},ExpressionUUID->"f02714a1-bda7-447f-940b-\
09007adfd4f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{"$ft", "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["y", "k"], "\[Rule]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"Sqrt", "[", "N", "]"}]], 
            RowBox[{"xSum", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["x", "n"], " ", 
               SuperscriptBox[
                SubscriptBox["\[Omega]", "n"], "k"]}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "0", ",", 
                RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"N", "-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"n", "[", 
           RowBox[{"CG", "[", "\"\<number of qubits/states\>\"", "]"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Omega]", "n"], "\[Rule]", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "\[Pi]", " ", "n", " ", 
             RowBox[{"I", "/", "N"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"CG", "[", "\"\<Nth root of unity\>\"", "]"}], "]"}], 
           "\[Rule]", 
           SuperscriptBox["2", "n"]}]}], "\[IndentingNewLine]", "}"}], "[", 
        RowBox[{"CG", "[", "\"\<classical FT\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"$qft", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Ket", "[", "x", "]"}], "\[Rule]", 
            RowBox[{"xSum", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["x", "i"], 
               RowBox[{"Ket", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Ket", "[", "y", "]"}], "\[Rule]", 
            RowBox[{"xSum", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["y", "i"], 
               RowBox[{"Ket", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["y", "k"], "\[Rule]", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"Sqrt", "[", "N", "]"}]], 
             RowBox[{"xSum", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "n"], " ", 
                SuperscriptBox[
                 SubscriptBox["\[Omega]", "n"], "k"]}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "0", ",", 
                 RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"N", "-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["\[Omega]", "n_"], "\[Rule]", 
            RowBox[{"Exp", "[", 
             RowBox[{"2", "\[Pi]", " ", "n", " ", 
              RowBox[{"I", "/", "N"}]}], "]"}]}], ",", 
           RowBox[{"N", "\[Rule]", 
            SuperscriptBox["2", "n"]}], ",", "\[IndentingNewLine]", 
           RowBox[{"n", "[", 
            RowBox[{"CG", "[", "\"\<number of qubits/states\>\"", "]"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"QFT", "[", 
             RowBox[{"Ket", "[", 
              RowBox[{"x", "[", 
               RowBox[{"CG", "[", "\"\<basis\>\"", "]"}], "]"}], "]"}], "]"}],
             "\[Rule]", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"Sqrt", "[", "N", "]"}]], 
             RowBox[{"xSum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 SubscriptBox["\[Omega]", "x"], "k"], 
                RowBox[{"Ket", "[", "k", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", 
                 RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "[", 
         RowBox[{"CG", "[", "\"\<quantum FT\>\"", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.777221965911581*^9, 3.7772219746293364`*^9}, {
   3.7772220139251957`*^9, 3.777222172785494*^9}, {3.777222240554788*^9, 
   3.7772224766009817`*^9}, {3.777222507376376*^9, 3.777222550700674*^9}, {
   3.777222580787773*^9, 3.7772226836483383`*^9}, {3.7772227237953568`*^9, 
   3.7772227315479918`*^9}, {3.77722279621939*^9, 3.777222796768573*^9}, {
   3.777222847136895*^9, 3.7772228495023613`*^9}, {3.777290127639956*^9, 
   3.77729013169037*^9}, {3.7772906448776073`*^9, 3.7772906549994593`*^9}, {
   3.777290801720852*^9, 3.777290803519099*^9}, {3.777565055348175*^9, 
   3.7775650739505568`*^9}, {3.777566118768384*^9, 3.7775661337051973`*^9}, 
   3.777566167742527*^9},ExpressionUUID->"31c8abbb-2985-4fc2-bf7e-\
ffe56de322a5"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox["y", "k"], "\[Rule]", 
           FractionBox[
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {
                   RowBox[{"{", 
                    RowBox[{"n", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              RowBox[{
               SubscriptBox["x", "n"], " ", 
               SubsuperscriptBox["\[Omega]", "n", "k"]}], "]"}],
             $CellContext`xSum[
             Subscript[$CellContext`x, $CellContext`n] 
              Subscript[$CellContext`\[Omega], \
$CellContext`n]^$CellContext`k, {$CellContext`n, 0, -1 + N}],
             Editable->False,
             SyntaxForm->Automatic], 
            SqrtBox["N"]]}]},
         {
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "N"}]}], "}"}]},
         {
          RowBox[{"n", "[", 
           StyleBox["\<\"number of qubits/states\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]},
         {
          RowBox[{
           SubscriptBox["\[Omega]", "n"], "\[Rule]", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", "\[Pi]"}], 
              "N"]}]]}]},
         {
          RowBox[{
           StyleBox["\<\"Nth root of unity\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0., 0.6666666666666666, 0.],
            FrontFaceColor->RGBColor[0., 0.6666666666666666, 0.],
            BackFaceColor->RGBColor[0., 0.6666666666666666, 0.],
            GraphicsColor->RGBColor[0., 0.6666666666666666, 0.],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0., 0.6666666666666666, 0.]], "\[Rule]", 
           SuperscriptBox["2", "n"]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"classical FT\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "x", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[$CellContext`x],
            Editable->False,
            SyntaxForm->Automatic], "\[Rule]", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                StyleBox["\[LeftBracketingBar]",
                 FontWeight->Bold], "i", 
                StyleBox["\[RightAngleBracket]",
                 FontWeight->Bold]}],
               Ket[$CellContext`i],
               Editable->False,
               SyntaxForm->Automatic], " ", 
              SubscriptBox["x", "i"]}], "]"}],
            $CellContext`xSum[
            Ket[$CellContext`i] 
             Subscript[$CellContext`x, $CellContext`i], {$CellContext`i, 
              0, -1 + N}],
            Editable->False,
            SyntaxForm->Automatic]}]},
         {
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "y", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[$CellContext`y],
            Editable->False,
            SyntaxForm->Automatic], "\[Rule]", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                StyleBox["\[LeftBracketingBar]",
                 FontWeight->Bold], "i", 
                StyleBox["\[RightAngleBracket]",
                 FontWeight->Bold]}],
               Ket[$CellContext`i],
               Editable->False,
               SyntaxForm->Automatic], " ", 
              SubscriptBox["y", "i"]}], "]"}],
            $CellContext`xSum[
            Ket[$CellContext`i] 
             Subscript[$CellContext`y, $CellContext`i], {$CellContext`i, 
              0, -1 + N}],
            Editable->False,
            SyntaxForm->Automatic]}]},
         {
          RowBox[{
           SubscriptBox["y", "k"], "\[Rule]", 
           FractionBox[
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {
                   RowBox[{"{", 
                    RowBox[{"n", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              RowBox[{
               SubscriptBox["x", "n"], " ", 
               SubsuperscriptBox["\[Omega]", "n", "k"]}], "]"}],
             $CellContext`xSum[
             Subscript[$CellContext`x, $CellContext`n] 
              Subscript[$CellContext`\[Omega], \
$CellContext`n]^$CellContext`k, {$CellContext`n, 0, -1 + N}],
             Editable->False,
             SyntaxForm->Automatic], 
            SqrtBox["N"]]}]},
         {
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "N"}]}], "}"}]},
         {
          RowBox[{
           SubscriptBox["\[Omega]", "n_"], "\[Rule]", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", "\[Pi]"}], 
             "N"]]}]},
         {
          RowBox[{"N", "\[Rule]", 
           SuperscriptBox["2", "n"]}]},
         {
          RowBox[{"n", "[", 
           StyleBox["\<\"number of qubits/states\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]},
         {
          RowBox[{
           RowBox[{"QFT", "[", 
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], 
              RowBox[{"x", "[", 
               StyleBox["\<\"basis\"\>",
                StripOnInput->False,
                LineColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FrontFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                BackFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                GraphicsColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FontFamily->"Helvetica",
                FontColor->RGBColor[0, 
                  Rational[2, 3], 0]], "]"}], 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[
              $CellContext`x[
               Style["basis", 
                RGBColor[0, 
                 Rational[2, 3], 0], FontFamily -> "Helvetica"]]],
             Editable->False,
             SyntaxForm->Automatic], "]"}], "\[Rule]", 
           FractionBox[
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {
                   RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "k", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[$CellContext`k],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               SubsuperscriptBox["\[Omega]", "x", "k"]}], "]"}],
             $CellContext`xSum[
             Ket[$CellContext`k] 
              Subscript[$CellContext`\[Omega], \
$CellContext`x]^$CellContext`k, {$CellContext`k, 0, -1 + N}],
             Editable->False,
             SyntaxForm->Automatic], 
            SqrtBox["N"]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"quantum FT\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{
  3.7772221275139227`*^9, 3.777222158103948*^9, 3.777222249774105*^9, 
   3.777222324311007*^9, 3.7772223868171167`*^9, 3.777222467528143*^9, 
   3.777222732392392*^9, 3.777222797299852*^9, 3.777222850521514*^9, {
   3.777290120050495*^9, 3.7772901332320633`*^9}, 3.777290657922535*^9, 
   3.7772908044099817`*^9, 3.777372000046774*^9, 3.77756507482436*^9, 
   3.777566135893311*^9, 3.7775661701001587`*^9, 3.77775865948041*^9, 
   3.777901664321761*^9, 3.7784237547607718`*^9, 3.778763616338831*^9, 
   3.778804135923285*^9, 3.790614304245118*^9, 3.790784415664978*^9, 
   3.791053315959612*^9},ExpressionUUID->"10a89b6e-5cd3-4f43-8e0f-\
cca04308a2d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Show that the sum expressions are \[Delta]-function-like.\>\"", ",", 
   RowBox[{
    RowBox[{"$y", "=", 
     RowBox[{
      SubscriptBox["y", "k_"], "->", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "n1"], 
          SuperscriptBox[
           SubscriptBox["\[Omega]", "n1"], "k"]}], ",", 
         RowBox[{"{", 
          RowBox[{"n1", ",", "0", ",", 
           RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}], "/", 
       RowBox[{"Sqrt", "[", "N", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$x", "=", 
     RowBox[{
      SubscriptBox["x", "n"], "->", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["y", "k1"], 
          SuperscriptBox[
           SubscriptBox["\[Omega]", "n"], 
           RowBox[{"-", "k1"}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "0", ",", 
           RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}], "/", 
       RowBox[{"Sqrt", "[", "N", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$x", "/.", "$y"}], "//", "tuSumGather"}], "//", 
      RowBox[{"tuSumSimplify", "[", 
       RowBox[{"{", "N", "}"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$sn", "=", 
     RowBox[{"n", "\[Rule]", "3"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$sN", "=", 
     RowBox[{
      RowBox[{"N", "\[Rule]", 
       SuperscriptBox["2", "n"]}], "/.", "$sn"}]}], ";", 
    "\[IndentingNewLine]", "NL"}], ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$sN"}], "/.", 
      RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{"$qft", "/.", "$sN"}], "//", 
      RowBox[{"tuRuleSelect", "[", 
       SubscriptBox["\[Omega]", "_"], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$s"}]}], ";", "\[IndentingNewLine]", "NL"}], ",", 
   "\"\<Compute for \>\"", ",", 
   RowBox[{"$sn1", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"N", "-", "1"}]}], "}"}], "/.", "$sN"}]}], ",", 
   "\[IndentingNewLine]", "imply", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"xTable", "[", 
      RowBox[{"$", ",", "$sn1"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"$", "/.", 
      RowBox[{"xTable", "\[Rule]", "Table"}]}], "//", "Simplify"}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
   "CG", "[", "\"\<Demonstrates orthogonality of \[Omega]'s.\>\"", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdx0sowwEAx/E/imSzEWsY+W+mJTnJwaKNy0q2mnEzRVZqcbAcJuWRoWZ5
F5HNZU0ebdRqxRiW2lZ75LEdJHbZ2opstbj4//6Hb5++5PCEcjSfIIgaKhjp
1bZEGlLStQ1GOxz/+J3kCVNSUQF3HhaFZQYYMg+sQmI6tQ73BzuP4F7WcgHr
S9RO+hV1OpLSYWFNwVrNoQ0eM6NnMJUp9kK37ecJVsnuYlDe7KdluAVfMHig
ysF+Q5DNpwy/JGlHrIEK6HxgceCyqKwa+u/LSWgkxoTQE1uklbQ92yBn+/0U
cvmPrQJKb89cB/S7znWQEO8a4E0ubYT8Jd4m1HdHXmcpkzviOLQLcwko/2Qm
YVSu+oZvAV0Gmroa/2BlaYDWwVZe2im3NENO2EcWXsGFFcU1dOU1eaBZa/JB
vcYchPFbawLOSHxpeBJSZ+E/VXrJWw==
  
  "],ExpressionUUID->"e35c7f89-74f0-44c8-a9bc-ccced28c43d0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Show that the sum expressions are \
\[Delta]-function-like.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["x", "n"], "\[Rule]", 
    FractionBox[
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
        TagBox[GridBox[{
           {
            RowBox[{"{", 
             RowBox[{"n1", ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "N"}]}], "}"}]},
           {
            RowBox[{"{", 
             RowBox[{"k1", ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       RowBox[{
        SubscriptBox["x", "n1"], " ", 
        SubsuperscriptBox["\[Omega]", "n", 
         RowBox[{"-", "k1"}]], " ", 
        SubsuperscriptBox["\[Omega]", "n1", "k1"]}], "]"}],
      $CellContext`xSum[
      Subscript[$CellContext`x, $CellContext`n1] 
       Subscript[$CellContext`\[Omega], $CellContext`n]^(-$CellContext`k1) 
       Subscript[$CellContext`\[Omega], $CellContext`n1]^$CellContext`k1, \
{$CellContext`n1, 0, -1 + N}, {$CellContext`k1, 0, -1 + N}],
      Editable->False,
      SyntaxForm->Automatic], "N"]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Compute for \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "7"}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "0"], "\[Rule]", 
      SubscriptBox["x", "0"]}], ",", 
     RowBox[{
      SubscriptBox["x", "1"], "\[Rule]", 
      SubscriptBox["x", "1"]}], ",", 
     RowBox[{
      SubscriptBox["x", "2"], "\[Rule]", 
      SubscriptBox["x", "2"]}], ",", 
     RowBox[{
      SubscriptBox["x", "3"], "\[Rule]", 
      SubscriptBox["x", "3"]}], ",", 
     RowBox[{
      SubscriptBox["x", "4"], "\[Rule]", 
      SubscriptBox["x", "4"]}], ",", 
     RowBox[{
      SubscriptBox["x", "5"], "\[Rule]", 
      SubscriptBox["x", "5"]}], ",", 
     RowBox[{
      SubscriptBox["x", "6"], "\[Rule]", 
      SubscriptBox["x", "6"]}], ",", 
     RowBox[{
      SubscriptBox["x", "7"], "\[Rule]", 
      SubscriptBox["x", "7"]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Demonstrates orthogonality of \[Omega]'s.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]]}],
  SequenceForm[
   Style["Show that the sum expressions are \[Delta]-function-like.", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`x, $CellContext`n] -> 
   N^(-1) $CellContext`xSum[
     Subscript[$CellContext`x, $CellContext`n1] 
      Subscript[$CellContext`\[Omega], $CellContext`n]^(-$CellContext`k1) 
      Subscript[$CellContext`\[Omega], $CellContext`n1]^$CellContext`k1, \
{$CellContext`n1, 0, -1 + N}, {$CellContext`k1, 0, -1 + N}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compute for ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`n, 0, 7}, 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {
   Subscript[$CellContext`x, 0] -> Subscript[$CellContext`x, 0], 
    Subscript[$CellContext`x, 1] -> Subscript[$CellContext`x, 1], 
    Subscript[$CellContext`x, 2] -> Subscript[$CellContext`x, 2], 
    Subscript[$CellContext`x, 3] -> Subscript[$CellContext`x, 3], 
    Subscript[$CellContext`x, 4] -> Subscript[$CellContext`x, 4], 
    Subscript[$CellContext`x, 5] -> Subscript[$CellContext`x, 5], 
    Subscript[$CellContext`x, 6] -> Subscript[$CellContext`x, 6], 
    Subscript[$CellContext`x, 7] -> Subscript[$CellContext`x, 7]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Demonstrates orthogonality of \[Omega]'s.", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7775678321487293`*^9, {3.777567888995227*^9, 3.7775678978018*^9}, 
   3.777758628853595*^9, 3.777758663587089*^9, {3.777758958874174*^9, 
   3.777758980004229*^9}, 3.777759058106825*^9, {3.777759115669252*^9, 
   3.777759140574069*^9}, 3.777759199837495*^9, {3.777858980652164*^9, 
   3.777859004049408*^9}, {3.7778590529806547`*^9, 3.77785905924774*^9}, {
   3.777859091308702*^9, 3.77785911025124*^9}, 3.777859165523671*^9, {
   3.7778592071197*^9, 3.777859334577991*^9}, {3.777859368754942*^9, 
   3.7778594062871532`*^9}, {3.777859440004395*^9, 3.777859455370339*^9}, 
   3.77785949996941*^9, 3.777901664506844*^9, 3.778423754922468*^9, 
   3.7787636164376593`*^9, 3.7788041360264072`*^9, 3.790614304605083*^9, 
   3.790784415973377*^9, 
   3.791053316217989*^9},ExpressionUUID->"f9ed667f-cf2c-412a-b85c-\
f6dc42465a03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Compute transformation from x\[LongRightArrow]y \>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$qft", "//", 
     RowBox[{"tuRuleSelect", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["y", "k"], ",", 
         SubscriptBox["\[Omega]", "_"]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]", " ", "I", " ", 
          RowBox[{"n", "/", "N"}]}], "]"}], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<\[FilledCircle] For \>\"", ",", 
   RowBox[{
    RowBox[{"$sn", "=", 
     RowBox[{"n", "\[Rule]", "2"}]}], ";", 
    RowBox[{"$sn", "//", "Framed"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$sN", "=", 
     RowBox[{
      RowBox[{"N", "\[Rule]", 
       SuperscriptBox["2", "n"]}], "/.", "$sn"}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", "\[IndentingNewLine]", 
   RowBox[{"$y", "=", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$sN"}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<For explicit y's: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", 
       RowBox[{"$", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
      RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e", "[", 
      SubscriptBox["F", "N"], "]"}], "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"$", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}], "/.", "$sN"}]}]}], ";", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",", 
   RowBox[{"CG", "[", 
    RowBox[{"\"\<Coefficients are \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["F", "N"], "/.", "$sN"}]}], "]"}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Coefficients of variables: \>\"", 
   ",", 
   RowBox[{"$x", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       SubscriptBox["x", "n"], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}], "/.", "$sN"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "$"}], ",", "$x"}], 
        "]"}], "//", "Normal"}], "//", "Last"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], " ", ")"}]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"Sqrt", "[", "2", "]"}], " ", "$"}], ")"}]}], "//", 
     "MatrixForms"}]}], ",", 
   RowBox[{"CG", "[", 
    RowBox[{"\"\<=\>\"", ",", 
     RowBox[{
      SubscriptBox["F", "N"], "/.", "$sN"}]}], "]"}]}], "\[IndentingNewLine]",
   "]"}], "\n", 
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<Grouping into qubits? \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"e", "[", 
       SubscriptBox["F", "N"], "]"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Corresponding states for different values of x's\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$x", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["x", "n"], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", 
           RowBox[{"N", "-", "1"}]}], "}"}]}], "]"}], "/.", "$sN"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"N", "-", "1"}]}], "]"}], ")"}], "/.", "$sN"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Ket", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "#"}], "]"}], "]"}], "&"}], "/@", "$"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"0", "||", "1"}], "]"}], "&"}], "/@", "$x"}], ")"}], 
        "\[Rule]", "$"}], "//", "Thread"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7772901371382103`*^9, 3.7772902016179934`*^9}, {
   3.777290231887467*^9, 3.7772903329236298`*^9}, {3.777290504532927*^9, 
   3.777290505037891*^9}, {3.7772905870944443`*^9, 3.7772905901644917`*^9}, {
   3.7772908853282633`*^9, 3.777290931766836*^9}, {3.777290969633943*^9, 
   3.7772910394319773`*^9}, {3.777291070485731*^9, 3.7772912387396173`*^9}, {
   3.7772913024317217`*^9, 3.77729134857729*^9}, {3.777291423911414*^9, 
   3.777291425063198*^9}, {3.777291839912796*^9, 3.777292019580244*^9}, {
   3.777292127719385*^9, 3.7772922236208477`*^9}, {3.777293538819173*^9, 
   3.777293635569888*^9}, {3.77729369762932*^9, 3.7772937571543493`*^9}, {
   3.7772938066963873`*^9, 3.777293806941958*^9}, {3.777293841148614*^9, 
   3.7772938566415462`*^9}, 3.777293964145178*^9, {3.777295246484041*^9, 
   3.7772953424333057`*^9}, {3.777297097026783*^9, 3.777297136418529*^9}, {
   3.777300394107719*^9, 3.777300394444001*^9}, {3.777302253050675*^9, 
   3.777302253283617*^9}, {3.777371970807715*^9, 3.7773719718371363`*^9}, {
   3.77737207269048*^9, 3.7773720735379457`*^9}, {3.77737213937193*^9, 
   3.777372150927479*^9}, {3.777372216871087*^9, 3.777372218440798*^9}, {
   3.777372926031788*^9, 3.7773729323843613`*^9}, {3.7773729764557953`*^9, 
   3.7773730154300423`*^9}, {3.7773807378759604`*^9, 
   3.7773807398299713`*^9}, {3.777380882184409*^9, 3.777380904611722*^9}, {
   3.77738103870207*^9, 3.777381040830452*^9}, {3.7774030825574617`*^9, 
   3.7774030832779703`*^9}, {3.777403221502996*^9, 3.777403225691965*^9}, {
   3.77740341357763*^9, 3.7774034840538816`*^9}, {3.777403517203782*^9, 
   3.777403531026586*^9}, {3.777758584331242*^9, 3.777758614727581*^9}, {
   3.777759286731092*^9, 3.777759290543167*^9}, {3.7777593207429237`*^9, 
   3.7777593343012133`*^9}, {3.777766935846768*^9, 3.777766975611899*^9}, {
   3.7777670774341908`*^9, 3.777767082897747*^9}, {3.777894003734686*^9, 
   3.777894004856894*^9}, {3.777894282341024*^9, 3.7778943074817266`*^9}, {
   3.777897784285202*^9, 3.777897784625065*^9}, {3.777897929889847*^9, 
   3.7778979359482327`*^9}},ExpressionUUID->"07b00977-0484-4ee0-9692-\
41dc876b9de3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Compute transformation from x\[LongRightArrow]y \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", "k"], "\[Rule]", 
      FractionBox[
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", 
               RowBox[{"n", ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "N"}]}], "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          SubscriptBox["x", "n"], " ", 
          SubsuperscriptBox["\[Omega]", "n", "k"]}], "]"}],
        $CellContext`xSum[
        Subscript[$CellContext`x, $CellContext`n] 
         Subscript[$CellContext`\[Omega], $CellContext`n]^$CellContext`k, \
{$CellContext`n, 0, -1 + N}],
        Editable->False,
        SyntaxForm->Automatic], 
       SqrtBox["N"]]}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "n_"], "\[Rule]", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", "\[Pi]"}], 
        "N"]]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[FilledCircle] For \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"n", "\[Rule]", "2"}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", "k"], "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", 
               RowBox[{"n", ",", "0", ",", "3"}], "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          SubscriptBox["x", "n"], " ", 
          SubsuperscriptBox["\[Omega]", "n", "k"]}], "]"}],
        $CellContext`xSum[
        Subscript[$CellContext`x, $CellContext`n] 
         Subscript[$CellContext`\[Omega], $CellContext`n]^$CellContext`k, \
{$CellContext`n, 0, 3}],
        Editable->False,
        SyntaxForm->Automatic]}]}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "n_"], "\[Rule]", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "n", " ", "\[Pi]"}], "2"]]}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"For explicit y's: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        SubscriptBox["y", "0"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "+", 
           SubscriptBox["x", "1"], "+", 
           SubscriptBox["x", "2"], "+", 
           SubscriptBox["x", "3"]}], ")"}]}]}]},
      {
       RowBox[{
        SubscriptBox["y", "1"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "1"]}], "-", 
           SubscriptBox["x", "2"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "3"]}]}], ")"}]}]}]},
      {
       RowBox[{
        SubscriptBox["y", "2"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "-", 
           SubscriptBox["x", "1"], "+", 
           SubscriptBox["x", "2"], "-", 
           SubscriptBox["x", "3"]}], ")"}]}]}]},
      {
       RowBox[{
        SubscriptBox["y", "3"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "1"]}], "-", 
           SubscriptBox["x", "2"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "3"]}]}], ")"}]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"Coefficients are \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox[
    SubscriptBox["F", "4"],
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Coefficients of variables: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "0"], ",", 
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "3"]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], ".", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         SqrtBox["2"], 
         SqrtBox["2"], 
         SqrtBox["2"], 
         SqrtBox["2"]},
        {
         SqrtBox["2"], 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["2"]}], 
         RowBox[{"-", 
          SqrtBox["2"]}], 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SqrtBox["2"]}]},
        {
         SqrtBox["2"], 
         RowBox[{"-", 
          SqrtBox["2"]}], 
         SqrtBox["2"], 
         RowBox[{"-", 
          SqrtBox["2"]}]},
        {
         SqrtBox["2"], 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SqrtBox["2"]}], 
         RowBox[{"-", 
          SqrtBox["2"]}], 
         RowBox[{"\[ImaginaryI]", " ", 
          SqrtBox["2"]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "\[InvisibleSpace]", 
   StyleBox["\<\"=\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox[
    SubscriptBox["F", "4"],
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]]}],
  SequenceForm[
   Style["Compute transformation from x\[LongRightArrow]y ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], {
   Subscript[$CellContext`y, $CellContext`k] -> 
    N^Rational[-1, 2] $CellContext`xSum[
      Subscript[$CellContext`x, $CellContext`n] 
       Subscript[$CellContext`\[Omega], $CellContext`n]^$CellContext`k, \
{$CellContext`n, 0, -1 + N}], Subscript[$CellContext`\[Omega], 
      Pattern[$CellContext`n, 
       Blank[]]] -> E^(Complex[0, 2] $CellContext`n N^(-1) Pi)}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[FilledCircle] For ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Framed[$CellContext`n -> 2], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {
   Subscript[$CellContext`y, $CellContext`k] -> 
    Rational[1, 2] $CellContext`xSum[
      Subscript[$CellContext`x, $CellContext`n] 
       Subscript[$CellContext`\[Omega], $CellContext`n]^$CellContext`k, \
{$CellContext`n, 0, 3}], Subscript[$CellContext`\[Omega], 
      Pattern[$CellContext`n, 
       Blank[]]] -> E^(Complex[0, 
        Rational[1, 2]] $CellContext`n Pi)}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["For explicit y's: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
     Subscript[$CellContext`y, 0] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] + 
        Subscript[$CellContext`x, 1] + Subscript[$CellContext`x, 2] + 
        Subscript[$CellContext`x, 3])}, {
     Subscript[$CellContext`y, 1] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] + 
        Complex[0, 1] Subscript[$CellContext`x, 1] - 
        Subscript[$CellContext`x, 2] + 
        Complex[0, -1] Subscript[$CellContext`x, 3])}, {
     Subscript[$CellContext`y, 2] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] - 
        Subscript[$CellContext`x, 1] + Subscript[$CellContext`x, 2] - 
        Subscript[$CellContext`x, 3])}, {
     Subscript[$CellContext`y, 3] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] + 
        Complex[0, -1] Subscript[$CellContext`x, 1] - 
        Subscript[$CellContext`x, 2] + 
        Complex[0, 1] Subscript[$CellContext`x, 3])}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["Coefficients are ", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style[
    Subscript[$CellContext`F, 4], 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Coefficients of variables: ", 
    RGBColor[0.7, 0, 1, 1], Larger], {
    Subscript[$CellContext`x, 0], 
    Subscript[$CellContext`x, 1], 
    Subscript[$CellContext`x, 2], 
    Subscript[$CellContext`x, 3]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[Rational[1, 2] 2^Rational[-1, 2], 
    MatrixForm[{{
      2^Rational[1, 2], 2^Rational[1, 2], 2^Rational[1, 2], 2^
       Rational[1, 2]}, {
      2^Rational[1, 2], Complex[0, 1] 2^Rational[1, 2], -2^Rational[1, 2], 
       Complex[0, -1] 2^Rational[1, 2]}, {
      2^Rational[1, 2], -2^Rational[1, 2], 2^
       Rational[1, 2], -2^Rational[1, 2]}, {
      2^Rational[1, 2], Complex[0, -1] 2^Rational[1, 2], -2^Rational[1, 2], 
       Complex[0, 1] 2^Rational[1, 2]}}]], 
   Style["=", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style[
    Subscript[$CellContext`F, 4], 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.777767162794958*^9, 3.7778940263962717`*^9, {3.7778941597728157`*^9, 
   3.777894187825171*^9}, {3.777894236086273*^9, 3.77789424776655*^9}, 
   3.777897819571165*^9, 3.7778978617584248`*^9, 3.7778979368714314`*^9, 
   3.7779016648140287`*^9, 3.778423755210197*^9, 3.7787636165889482`*^9, 
   3.7788041361885223`*^9, 3.7906143049084682`*^9, 3.790784416315568*^9, 
   3.791053316630231*^9},ExpressionUUID->"9f43a498-e1d4-48bc-8944-\
6af650cf491d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Grouping into qubits? \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        SubscriptBox["y", "0"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "+", 
           SubscriptBox["x", "1"], "+", 
           SubscriptBox["x", "2"], "+", 
           SubscriptBox["x", "3"]}], ")"}]}]}]},
      {
       RowBox[{
        SubscriptBox["y", "1"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "1"]}], "-", 
           SubscriptBox["x", "2"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "3"]}]}], ")"}]}]}]},
      {
       RowBox[{
        SubscriptBox["y", "2"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "-", 
           SubscriptBox["x", "1"], "+", 
           SubscriptBox["x", "2"], "-", 
           SubscriptBox["x", "3"]}], ")"}]}]}]},
      {
       RowBox[{
        SubscriptBox["y", "3"], "\[Rule]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "0"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "1"]}], "-", 
           SubscriptBox["x", "2"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["x", "3"]}]}], ")"}]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Corresponding states for different values of x's\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    TagBox[GridBox[{
       {
        RowBox[{
         SubscriptBox["x", "0"], "[", 
         RowBox[{"0", "||", "1"}], "]"}]},
       {
        RowBox[{
         SubscriptBox["x", "1"], "[", 
         RowBox[{"0", "||", "1"}], "]"}]},
       {
        RowBox[{
         SubscriptBox["x", "2"], "[", 
         RowBox[{"0", "||", "1"}], "]"}]},
       {
        RowBox[{
         SubscriptBox["x", "3"], "[", 
         RowBox[{"0", "||", "1"}], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[Rule]", 
    TagBox[GridBox[{
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"0", ",", "0", ",", "0"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0, 0, 0],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"0", ",", "0", ",", "1"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0, 0, 1],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"0", ",", "1", ",", "0"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0, 1, 0],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"0", ",", "1", ",", "1"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0, 1, 1],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"1", ",", "0", ",", "0"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1, 0, 0],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"1", ",", "0", ",", "1"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1, 0, 1],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"1", ",", "1", ",", "0"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1, 1, 0],
         Editable->False,
         SyntaxForm->Automatic]},
       {
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{"1", ",", "1", ",", "1"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1, 1, 1],
         Editable->False,
         SyntaxForm->Automatic]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"]}]}],
  SequenceForm[
   Style["Grouping into qubits? ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
     Subscript[$CellContext`y, 0] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] + 
        Subscript[$CellContext`x, 1] + Subscript[$CellContext`x, 2] + 
        Subscript[$CellContext`x, 3])}, {
     Subscript[$CellContext`y, 1] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] + 
        Complex[0, 1] Subscript[$CellContext`x, 1] - 
        Subscript[$CellContext`x, 2] + 
        Complex[0, -1] Subscript[$CellContext`x, 3])}, {
     Subscript[$CellContext`y, 2] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] - 
        Subscript[$CellContext`x, 1] + Subscript[$CellContext`x, 2] - 
        Subscript[$CellContext`x, 3])}, {
     Subscript[$CellContext`y, 3] -> 
      Rational[1, 2] (Subscript[$CellContext`x, 0] + 
        Complex[0, -1] Subscript[$CellContext`x, 1] - 
        Subscript[$CellContext`x, 2] + 
        Complex[0, 1] Subscript[$CellContext`x, 3])}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Corresponding states for different values of x's", 
    RGBColor[0.7, 0, 1, 1], Larger], Grid[{{
       Subscript[$CellContext`x, 0][
        Or[0, 1]]}, {
       Subscript[$CellContext`x, 1][
        Or[0, 1]]}, {
       Subscript[$CellContext`x, 2][
        Or[0, 1]]}, {
       Subscript[$CellContext`x, 3][
        Or[0, 1]]}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left] -> Grid[{{
       Ket[0, 0, 0]}, {
       Ket[0, 0, 1]}, {
       Ket[0, 1, 0]}, {
       Ket[0, 1, 1]}, {
       Ket[1, 0, 0]}, {
       Ket[1, 0, 1]}, {
       Ket[1, 1, 0]}, {
       Ket[1, 1, 1]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
     Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.777767162794958*^9, 3.7778940263962717`*^9, {3.7778941597728157`*^9, 
   3.777894187825171*^9}, {3.777894236086273*^9, 3.77789424776655*^9}, 
   3.777897819571165*^9, 3.7778978617584248`*^9, 3.7778979368714314`*^9, 
   3.7779016648140287`*^9, 3.778423755210197*^9, 3.7787636165889482`*^9, 
   3.7788041361885223`*^9, 3.7906143049084682`*^9, 3.790784416315568*^9, 
   3.7910533168514442`*^9},ExpressionUUID->"5a02ded9-4593-464a-8ba0-\
a59b6dd09a68"]
}, Open  ]],

Cell["Circuit implementation", "Text",
 CellChangeTimes->{{3.777295391577323*^9, 
  3.777295399585812*^9}},ExpressionUUID->"bcb1fa6b-0ec7-42ae-a212-\
ef29d0ea973a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{"$circuit", "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"H", "[", 
          RowBox[{"CG", "[", "\"\<Hadamar gate\>\"", "]"}], "]"}], "\[Rule]", 
         
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "}"}], "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["R", "m_"], "[", 
          RowBox[{"CG", "[", "\"\<phase gate\>\"", "]"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             SubscriptBox["\[Omega]", "m"]}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["\[Omega]", "m_"], "\[Rule]", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "\[Pi]", " ", 
           RowBox[{"I", "/", 
            SuperscriptBox["2", "m"]}]}], "]"}]}]}], "\[IndentingNewLine]", 
       "}"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "]"}], "\n", 
 RowBox[{"Clear", "[", 
  RowBox[{"frac0", ",", "frac"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frac0", "[", 
   RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "k"], 
     SuperscriptBox["2", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"k", "-", "n", "+", "1"}], ")"}]}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "n", ",", "m"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frac", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"frac0", "[", 
     RowBox[{"n", ",", "m"}], "]"}], 
    SuperscriptBox["2", "m"]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PR", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$s0", "=", 
     RowBox[{
      RowBox[{"tuRule", "[", "$circuit", "]"}], "//", "Most"}]}], ";", 
    "\[IndentingNewLine]", "NL"}], ",", 
   "\"\<define corresponding state for each \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"$x", "=", 
    RowBox[{
     SubscriptBox["x", "i_"], "->", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        RowBox[{"Ket", "[", "0", "]"}], "i"], ",", 
       SubscriptBox[
        RowBox[{"Ket", "[", "1", "]"}], "i"]}], "}"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "line", ",", "NL", ",", 
   "\"\<\[FilledCircle] For \>\"", ",", 
   RowBox[{"$n", "=", 
    RowBox[{"n", "\[Rule]", "1"}]}], ",", 
   "\"\< qubits: (the bottom 1 lines of diagram)\>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The FT of \>\"", ",", 
   RowBox[{"Ket", "[", 
    SubscriptBox["x", "1"], "]"}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"H", ".", 
      SubscriptBox["x", "1"]}], "/.", "$x"}]}], ",", "\[IndentingNewLine]", 
   "yield", ",", 
   RowBox[{"$1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "//.", 
       RowBox[{"$s0", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "1"}], "]"}], "]"}]}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Ket", "[", "_", "]"}]}], "]"}], "&"}]}], "//", "Framed"}]}],
    ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Compare with fractional binary notation form\>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$k1", "=", 
    RowBox[{
     RowBox[{"Ket", "[", 
      SubscriptBox["x", "1"], "]"}], "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", "\[Pi]", " ", "I", " ", 
            RowBox[{"frac0", "[", 
             RowBox[{"1", ",", "1"}], "]"}]}], "]"}], 
          SubscriptBox[
           RowBox[{"Ket", "[", "1", "]"}], "1"]}], "+", 
         SubscriptBox[
          RowBox[{"Ket", "[", "0", "]"}], "1"]}], ")"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "line", ",", "NL", ",", 
   "\"\<\[FilledCircle] For \>\"", ",", 
   RowBox[{"$n", "=", 
    RowBox[{"n", "\[Rule]", "2"}]}], ",", 
   "\"\< qubits: (the bottom 2 lines of diagram)\>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The FT of \>\"", ",", 
   RowBox[{"Ket", "[", 
    SubscriptBox["x", "2"], "]"}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"H", ".", 
      SubscriptBox["x", "2"]}], "/.", "$x"}]}], ",", "\[IndentingNewLine]", 
   "yield", ",", 
   RowBox[{"$2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "//.", "$s0"}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Ket", "[", "_", "]"}]}], "]"}], "&"}]}], "//", "Framed"}]}],
    ",", "\[IndentingNewLine]", "NL", ",", "\"\<The FT of \>\"", ",", 
   RowBox[{"Ket", "[", 
    SubscriptBox["x", "1"], "]"}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "2"], "\[Equal]", "1"}], ",", 
        SubscriptBox["R", "2"], ",", "1"}], "]"}], ".", " ", "H", " ", ".", 
      " ", 
      SubscriptBox["x", "1"]}], "/.", "$x"}]}], ",", 
   RowBox[{"CG", "[", "\"\<doubles # of states\>\"", "]"}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$k2a", "=", 
    RowBox[{"$1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//.", 
        RowBox[{"$s0", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "//", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Ket", "[", "_", "]"}]}], "]"}], "&"}]}], "//", 
      "Framed"}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Compare with fractional binary notation \>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$k2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", 
        SubscriptBox["x", "1"], "]"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", "\[Pi]", " ", "I", " ", 
              RowBox[{"frac0", "[", 
               RowBox[{"1", ",", "2"}], "]"}]}], "]"}], 
            SubscriptBox[
             RowBox[{"Ket", "[", "1", "]"}], "1"]}], "+", 
           SubscriptBox[
            RowBox[{"Ket", "[", "0", "]"}], "1"]}], ")"}], "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ket", "[", 
        SubscriptBox["x", "2"], "]"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", "\[Pi]", " ", "I", " ", 
              RowBox[{"frac0", "[", 
               RowBox[{"2", ",", "2"}], "]"}]}], "]"}], 
            SubscriptBox[
             RowBox[{"Ket", "[", "1", "]"}], "2"]}], "+", 
           SubscriptBox[
            RowBox[{"Ket", "[", "0", "]"}], "2"]}], ")"}], "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{"Apply", "[", 
     RowBox[{"CircleTimes", ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Ket", "[", 
          SubscriptBox["x", "i"], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "/.", "$n"}]}], "]"}]}], 
   ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$k2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"$", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "2"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "line", ",", "NL", ",", 
   "\"\<\[FilledCircle] For \>\"", ",", 
   RowBox[{"$n", "=", 
    RowBox[{"n", "\[Rule]", "3"}]}], ",", 
   "\"\< qubits: (the bottom 3 lines of diagram)\>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The FT of \>\"", ",", 
   RowBox[{"Ket", "[", 
    SubscriptBox["x", "3"], "]"}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"H", ".", " ", 
      SubscriptBox["x", "3"]}], "/.", "$x"}]}], ",", "\[IndentingNewLine]", 
   "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "//.", "$s0"}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Ket", "[", "_", "]"}]}], "]"}], "&"}]}], "//", "Framed"}]}],
    ",", "\[IndentingNewLine]", "NL", ",", "\"\<The FT of \>\"", ",", 
   RowBox[{"Ket", "[", 
    SubscriptBox["x", "2"], "]"}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "3"], "\[Equal]", "1"}], ",", 
        SubscriptBox["R", "2"], ",", "1"}], "]"}], ".", "H", ".", 
      SubscriptBox["x", "2"]}], "/.", "$x"}]}], ",", 
   RowBox[{"CG", "[", "\"\<doubles # of states\>\"", "]"}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "//.", "$s0"}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Ket", "[", "_", "]"}]}], "]"}], "&"}]}], "//", "Framed"}]}],
    ",", "\[IndentingNewLine]", "NL", ",", "\"\<The FT of \>\"", ",", 
   RowBox[{"Ket", "[", 
    SubscriptBox["x", "1"], "]"}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "3"], "\[Equal]", "1"}], ",", 
        SubscriptBox["R", "3"], ",", "1"}], "]"}], ".", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "2"], "\[Equal]", "1"}], ",", 
        SubscriptBox["R", "2"], ",", "1"}], "]"}], ".", "H", ".", 
      SubscriptBox["x", "1"]}], "/.", "$x"}]}], ",", 
   RowBox[{"CG", "[", "\"\<doubles # of states\>\"", "]"}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$k3a", "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"$", "//.", "$s0"}], "//", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Ket", "[", "_", "]"}]}], "]"}], "&"}]}], "//", 
       "Simplify"}], "//", "Framed"}]}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<Compare with fractional binary notation \>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$k3", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Ket", "[", 
         SubscriptBox["x", "1"], "]"}], "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", "\[Pi]", " ", "I", " ", 
               RowBox[{"frac0", "[", 
                RowBox[{"1", ",", "3"}], "]"}]}], "]"}], 
             RowBox[{"Ket", "[", "1", "]"}]}], "+", 
            RowBox[{"Ket", "[", "0", "]"}]}], ")"}], "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ket", "[", 
         SubscriptBox["x", "2"], "]"}], "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", "\[Pi]", " ", "I", " ", 
               RowBox[{"frac0", "[", 
                RowBox[{"2", ",", "3"}], "]"}]}], "]"}], 
             RowBox[{"Ket", "[", "1", "]"}]}], "+", 
            RowBox[{"Ket", "[", "0", "]"}]}], ")"}], "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ket", "[", 
         SubscriptBox["x", "3"], "]"}], "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", "\[Pi]", " ", "I", " ", 
               RowBox[{"frac0", "[", 
                RowBox[{"3", ",", "3"}], "]"}]}], "]"}], 
             RowBox[{"Ket", "[", "1", "]"}]}], "+", 
            RowBox[{"Ket", "[", "0", "]"}]}], ")"}], "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}]}], "}"}], "//", 
     "Normal"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.777291475713196*^9, 3.777291479317357*^9}, {
   3.777292035474155*^9, 3.7772920621498404`*^9}, {3.7772954066971397`*^9, 
   3.777295611620784*^9}, {3.777296348304865*^9, 3.7772963587212753`*^9}, {
   3.777300774578465*^9, 3.77730081113967*^9}, {3.777300881587892*^9, 
   3.7773008861413317`*^9}, {3.7773412356832333`*^9, 3.777341240911215*^9}, {
   3.777341463402989*^9, 3.777341470372946*^9}, {3.777399123520996*^9, 
   3.77739913938868*^9}, 3.777894422068974*^9, {3.777894787128356*^9, 
   3.777894790859427*^9}, {3.777895248250084*^9, 3.777895253325836*^9}, {
   3.777897211859692*^9, 3.777897226956457*^9}, {3.777897280024156*^9, 
   3.7778974186998568`*^9}, {3.7778974620457983`*^9, 3.777897469946847*^9}, {
   3.777897509817099*^9, 3.777897510560255*^9}, {3.7778980083583393`*^9, 
   3.777898013458865*^9}, {3.777898354534234*^9, 3.777898411997508*^9}, {
   3.7779009662367563`*^9, 3.777900973930142*^9}, {3.7779010089130383`*^9, 
   3.7779010365534*^9}, {3.777901141434864*^9, 3.777901158873507*^9}, {
   3.7779043942012653`*^9, 3.777904476627571*^9}, {3.777904537575614*^9, 
   3.7779046503342113`*^9}, {3.7779777913782167`*^9, 3.777977859741584*^9}, {
   3.777977936749662*^9, 3.777977947404192*^9}, {3.7779781140463676`*^9, 
   3.777978129977038*^9}},ExpressionUUID->"5166199f-2f69-4a2a-8b09-\
e59c303aa5b8"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"H", "[", 
           StyleBox["\<\"Hadamar gate\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["1", 
               SqrtBox["2"]], ",", 
              FractionBox["1", 
               SqrtBox["2"]]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["1", 
               SqrtBox["2"]], ",", 
              RowBox[{"-", 
               FractionBox["1", 
                SqrtBox["2"]]}]}], "}"}]}], "}"}]}]},
        {
         RowBox[{
          RowBox[{
           SubscriptBox["R", "m_"], "[", 
           StyleBox["\<\"phase gate\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              SubscriptBox["\[Omega]", "m"]}], "}"}]}], "}"}]}]},
        {
         RowBox[{
          SubscriptBox["\[Omega]", "m_"], "\[Rule]", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["2", 
             RowBox[{"1", "-", "m"}]], " ", "\[Pi]"}]]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{
  3.7774684823005877`*^9, 3.77746950507092*^9, 3.7774696113185368`*^9, 
   3.77746980715301*^9, 3.777469916194207*^9, 3.777471336333439*^9, 
   3.7777585570125217`*^9, 3.7777671872471743`*^9, 3.7778558571398153`*^9, 
   3.777894793476506*^9, 3.777895255065336*^9, 3.777897423374373*^9, 
   3.777897479737193*^9, 3.777897511670938*^9, 3.777897964359578*^9, 
   3.777898016225596*^9, 3.77789836450959*^9, 3.777898412958493*^9, 
   3.777901038636558*^9, 3.77790115953172*^9, 3.7779016651483994`*^9, 
   3.777904491473489*^9, 3.7779045855055*^9, {3.777904630744233*^9, 
   3.777904651127246*^9}, 3.7779778266046*^9, 3.777977860834845*^9, {
   3.777977942701664*^9, 3.777977948183423*^9}, 3.777978119339451*^9, 
   3.7784237557006197`*^9, 3.778763616783807*^9, 3.778804136432457*^9, 
   3.790614305364835*^9, 3.790784416715268*^9, 
   3.791053317229588*^9},ExpressionUUID->"e0b4d5b4-1bd6-4cb8-a437-\
c42b345bf051"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"define corresponding state for each \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["x", "i_"], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "i"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "i"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[FilledCircle] For \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "1"}], "\[InvisibleSpace]", 
   StyleBox["\<\" qubits: (the bottom 1 lines of diagram)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The FT of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], 
     SubscriptBox["x", "1"], 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[
     Subscript[$CellContext`x, 1]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"H", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "1"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "1"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "1"], 
        SqrtBox["2"]], "+", 
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic], "1"], 
        SqrtBox["2"]]}], ",", 
      RowBox[{
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "1"], 
        SqrtBox["2"]], "-", 
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic], "1"], 
        SqrtBox["2"]]}]}], "}"}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Compare with fractional binary notation form\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      SubscriptBox["x", "1"], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[$CellContext`x, 1]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    FractionBox[
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "1"], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
         SubscriptBox["x", "1"]}]], " ", 
       SubscriptBox[
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "1", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1],
         Editable->False,
         SyntaxForm->Automatic], "1"]}]}], 
     SqrtBox["2"]]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[FilledCircle] For \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "2"}], "\[InvisibleSpace]", 
   StyleBox["\<\" qubits: (the bottom 2 lines of diagram)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The FT of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], 
     SubscriptBox["x", "2"], 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[
     Subscript[$CellContext`x, 2]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"H", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "2"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "2"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "2"], 
        SqrtBox["2"]], "+", 
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic], "2"], 
        SqrtBox["2"]]}], ",", 
      RowBox[{
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "2"], 
        SqrtBox["2"]], "-", 
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic], "2"], 
        SqrtBox["2"]]}]}], "}"}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The FT of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], 
     SubscriptBox["x", "1"], 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[
     Subscript[$CellContext`x, 1]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "2"], ",", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "2"]}], "}"}], "\[Equal]", "1"}], ",", 
      SubscriptBox["R", "2"], ",", "1"}], "]"}], ".", "H", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "1"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "1"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"doubles # of states\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "2"], ",", 
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "2"]}], "}"}], "\[Equal]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["\[Omega]", "2"]}], "}"}]}], "}"}], ",", "1"}], "]"}],
      ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "1"], 
         SqrtBox["2"]], "+", 
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "1"], 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "1"], 
         SqrtBox["2"]], "-", 
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "1"], 
         SqrtBox["2"]]}]}], "}"}]}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Compare with fractional binary notation \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        StyleBox["\[LeftBracketingBar]",
         FontWeight->Bold], 
        SubscriptBox["x", "1"], 
        StyleBox["\[RightAngleBracket]",
         FontWeight->Bold]}],
       Ket[
        Subscript[$CellContext`x, 1]],
       Editable->False,
       SyntaxForm->Automatic], "\[Rule]", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "1"], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "1"], "2"], "+", 
             FractionBox[
              SubscriptBox["x", "2"], "4"]}], ")"}]}]], " ", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "1"]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        StyleBox["\[LeftBracketingBar]",
         FontWeight->Bold], 
        SubscriptBox["x", "2"], 
        StyleBox["\[RightAngleBracket]",
         FontWeight->Bold]}],
       Ket[
        Subscript[$CellContext`x, 2]],
       Editable->False,
       SyntaxForm->Automatic], "\[Rule]", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "2"], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
           SubscriptBox["x", "2"]}]], " ", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "2"]}]}], 
       SqrtBox["2"]]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      SubscriptBox["x", "1"], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[$CellContext`x, 1]],
     Editable->False,
     SyntaxForm->Automatic], "\[CircleTimes]", 
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      SubscriptBox["x", "2"], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[$CellContext`x, 2]],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       TagBox[GridBox[{
          {
           RowBox[{
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "1"], "+", 
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "1", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[1],
                Editable->False,
                SyntaxForm->Automatic], "1"]}], 
             SqrtBox["2"]], "\[CircleTimes]", 
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "2"], "+", 
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "1", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[1],
                Editable->False,
                SyntaxForm->Automatic], "2"]}], 
             SqrtBox["2"]]}]},
          {
           RowBox[{
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "1"], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "1", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[1],
                 Editable->False,
                 SyntaxForm->Automatic], "1"]}]}], 
             SqrtBox["2"]], "\[CircleTimes]", 
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "2"], "-", 
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "1", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[1],
                Editable->False,
                SyntaxForm->Automatic], "2"]}], 
             SqrtBox["2"]]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "1"], "-", 
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "1", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[1],
                Editable->False,
                SyntaxForm->Automatic], "1"]}], 
             SqrtBox["2"]], "\[CircleTimes]", 
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "2"], "+", 
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "1", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[1],
                Editable->False,
                SyntaxForm->Automatic], "2"]}], 
             SqrtBox["2"]]}]},
          {
           RowBox[{
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "1", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[1],
                 Editable->False,
                 SyntaxForm->Automatic], "1"]}]}], 
             SqrtBox["2"]], "\[CircleTimes]", 
            FractionBox[
             RowBox[{
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "0", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[0],
                Editable->False,
                SyntaxForm->Automatic], "2"], "-", 
              SubscriptBox[
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "1", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[1],
                Editable->False,
                SyntaxForm->Automatic], "2"]}], 
             SqrtBox["2"]]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[FilledCircle] For \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "3"}], "\[InvisibleSpace]", 
   StyleBox["\<\" qubits: (the bottom 3 lines of diagram)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The FT of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], 
     SubscriptBox["x", "3"], 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[
     Subscript[$CellContext`x, 3]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"H", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "3"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "3"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "3"], 
        SqrtBox["2"]], "+", 
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic], "3"], 
        SqrtBox["2"]]}], ",", 
      RowBox[{
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic], "3"], 
        SqrtBox["2"]], "-", 
       FractionBox[
        SubscriptBox[
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic], "3"], 
        SqrtBox["2"]]}]}], "}"}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The FT of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], 
     SubscriptBox["x", "2"], 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[
     Subscript[$CellContext`x, 2]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "3"], ",", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "3"]}], "}"}], "\[Equal]", "1"}], ",", 
      SubscriptBox["R", "2"], ",", "1"}], "]"}], ".", "H", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "2"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "2"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"doubles # of states\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "3"], ",", 
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "3"]}], "}"}], "\[Equal]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["\[Omega]", "2"]}], "}"}]}], "}"}], ",", "1"}], "]"}],
      ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "2"], 
         SqrtBox["2"]], "+", 
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "2"], 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "2"], 
         SqrtBox["2"]], "-", 
        FractionBox[
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "2"], 
         SqrtBox["2"]]}]}], "}"}]}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The FT of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], 
     SubscriptBox["x", "1"], 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[
     Subscript[$CellContext`x, 1]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "3"], ",", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "3"]}], "}"}], "\[Equal]", "1"}], ",", 
      SubscriptBox["R", "3"], ",", "1"}], "]"}], ".", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "2"], ",", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "2"]}], "}"}], "\[Equal]", "1"}], ",", 
      SubscriptBox["R", "2"], ",", "1"}], "]"}], ".", "H", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "1"], ",", 
      SubscriptBox[
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "1", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[1],
        Editable->False,
        SyntaxForm->Automatic], "1"]}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"doubles # of states\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "3"], ",", 
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "3"]}], "}"}], "\[Equal]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["\[Omega]", "3"]}], "}"}]}], "}"}], ",", "1"}], "]"}],
      ".", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "2"], ",", 
          SubscriptBox[
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "2"]}], "}"}], "\[Equal]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["\[Omega]", "2"]}], "}"}]}], "}"}], ",", "1"}], "]"}],
      ".", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "1"], "+", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "1"]}], 
        SqrtBox["2"]], ",", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "1"], "-", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic], "1"]}], 
        SqrtBox["2"]]}], "}"}]}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Compare with fractional binary notation \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        StyleBox["\[LeftBracketingBar]",
         FontWeight->Bold], 
        SubscriptBox["x", "1"], 
        StyleBox["\[RightAngleBracket]",
         FontWeight->Bold]}],
       Ket[
        Subscript[$CellContext`x, 1]],
       Editable->False,
       SyntaxForm->Automatic], "\[Rule]", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "0", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0],
         Editable->False,
         SyntaxForm->Automatic], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "1"], "2"], "+", 
             FractionBox[
              SubscriptBox["x", "2"], "4"], "+", 
             FractionBox[
              SubscriptBox["x", "3"], "8"]}], ")"}]}]], " ", 
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        StyleBox["\[LeftBracketingBar]",
         FontWeight->Bold], 
        SubscriptBox["x", "2"], 
        StyleBox["\[RightAngleBracket]",
         FontWeight->Bold]}],
       Ket[
        Subscript[$CellContext`x, 2]],
       Editable->False,
       SyntaxForm->Automatic], "\[Rule]", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "0", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0],
         Editable->False,
         SyntaxForm->Automatic], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              SubscriptBox["x", "2"], "2"], "+", 
             FractionBox[
              SubscriptBox["x", "3"], "4"]}], ")"}]}]], " ", 
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       SqrtBox["2"]]}], ",", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        StyleBox["\[LeftBracketingBar]",
         FontWeight->Bold], 
        SubscriptBox["x", "3"], 
        StyleBox["\[RightAngleBracket]",
         FontWeight->Bold]}],
       Ket[
        Subscript[$CellContext`x, 3]],
       Editable->False,
       SyntaxForm->Automatic], "\[Rule]", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "0", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[0],
         Editable->False,
         SyntaxForm->Automatic], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
           SubscriptBox["x", "3"]}]], " ", 
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "1", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[1],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       SqrtBox["2"]]}]}], "}"}]}],
  SequenceForm[
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["define corresponding state for each ", 
    RGBColor[0.7, 0, 1, 1], Larger], Subscript[$CellContext`x, 
     Pattern[$CellContext`i, 
      Blank[]]] -> {
     Subscript[
      Ket[0], $CellContext`i], 
     Subscript[
      Ket[1], $CellContext`i]}, 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[FilledCircle] For ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 1, 
   Style[" qubits: (the bottom 1 lines of diagram)", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The FT of ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[
    Subscript[$CellContext`x, 1]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[$CellContext`H, {
     Subscript[
      Ket[0], 1], 
     Subscript[
      Ket[1], 1]}], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[{2^Rational[-1, 2] Subscript[
        Ket[0], 1] + 2^Rational[-1, 2] Subscript[
        Ket[1], 1], 2^Rational[-1, 2] Subscript[
        Ket[0], 1] - 2^Rational[-1, 2] Subscript[
       Ket[1], 1]}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compare with fractional binary notation form", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Ket[
     Subscript[$CellContext`x, 1]] -> 2^Rational[-1, 2] (Subscript[
       Ket[0], 1] + 
     E^(Complex[0, 1] Pi Subscript[$CellContext`x, 1]) Subscript[
        Ket[1], 1]), 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[FilledCircle] For ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 2, 
   Style[" qubits: (the bottom 2 lines of diagram)", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The FT of ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[
    Subscript[$CellContext`x, 2]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[$CellContext`H, {
     Subscript[
      Ket[0], 2], 
     Subscript[
      Ket[1], 2]}], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[{2^Rational[-1, 2] Subscript[
        Ket[0], 2] + 2^Rational[-1, 2] Subscript[
        Ket[1], 2], 2^Rational[-1, 2] Subscript[
        Ket[0], 2] - 2^Rational[-1, 2] Subscript[
       Ket[1], 2]}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The FT of ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[
    Subscript[$CellContext`x, 1]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[
    If[{
       Subscript[
        Ket[0], 2], 
       Subscript[
        Ket[1], 2]} == 1, 
     Subscript[$CellContext`R, 2], 1], $CellContext`H, {
     Subscript[
      Ket[0], 1], 
     Subscript[
      Ket[1], 1]}], 
   Style["doubles # of states", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[
    Dot[
     If[{
        Subscript[
         Ket[0], 2], 
        Subscript[
         Ket[1], 2]} == 1, {{1, 0}, {0, 
        Subscript[$CellContext`\[Omega], 2]}}, 1], {
     2^Rational[-1, 2] Subscript[
         Ket[0], 1] + 2^Rational[-1, 2] Subscript[
         Ket[1], 1], 2^Rational[-1, 2] Subscript[
         Ket[0], 1] - 2^Rational[-1, 2] Subscript[
        Ket[1], 1]}]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compare with fractional binary notation ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {Ket[
      Subscript[$CellContext`x, 1]] -> 2^Rational[-1, 2] (Subscript[
        Ket[0], 1] + 
      E^(Complex[0, 2] 
         Pi (Rational[1, 2] Subscript[$CellContext`x, 1] + 
          Rational[1, 4] Subscript[$CellContext`x, 2])) Subscript[
         Ket[1], 1]), Ket[
      Subscript[$CellContext`x, 2]] -> 2^Rational[-1, 2] (Subscript[
        Ket[0], 2] + 
      E^(Complex[0, 1] Pi Subscript[$CellContext`x, 2]) Subscript[
         Ket[1], 2])}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   CircleTimes[
    Ket[
     Subscript[$CellContext`x, 1]], 
    Ket[
     Subscript[$CellContext`x, 2]]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{
      Grid[{{
         CircleTimes[2^Rational[-1, 2] (Subscript[
             Ket[0], 1] + Subscript[
             Ket[1], 1]), 2^Rational[-1, 2] (Subscript[
             Ket[0], 2] + Subscript[
             Ket[1], 2])]}, {
         CircleTimes[2^Rational[-1, 2] (Subscript[
             Ket[0], 1] + Complex[0, 1] Subscript[
              Ket[1], 1]), 2^Rational[-1, 2] (Subscript[
             Ket[0], 2] - Subscript[
            Ket[1], 2])]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
       Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{
         CircleTimes[2^Rational[-1, 2] (Subscript[
             Ket[0], 1] - Subscript[
            Ket[1], 1]), 2^Rational[-1, 2] (Subscript[
             Ket[0], 2] + Subscript[
             Ket[1], 2])]}, {
         CircleTimes[2^Rational[-1, 2] (Subscript[
             Ket[0], 1] + Complex[0, -1] Subscript[
              Ket[1], 1]), 2^Rational[-1, 2] (Subscript[
             Ket[0], 2] - Subscript[
            Ket[1], 2])]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
       Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[FilledCircle] For ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 3, 
   Style[" qubits: (the bottom 3 lines of diagram)", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The FT of ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[
    Subscript[$CellContext`x, 3]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[$CellContext`H, {
     Subscript[
      Ket[0], 3], 
     Subscript[
      Ket[1], 3]}], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[{2^Rational[-1, 2] Subscript[
        Ket[0], 3] + 2^Rational[-1, 2] Subscript[
        Ket[1], 3], 2^Rational[-1, 2] Subscript[
        Ket[0], 3] - 2^Rational[-1, 2] Subscript[
       Ket[1], 3]}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The FT of ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[
    Subscript[$CellContext`x, 2]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[
    If[{
       Subscript[
        Ket[0], 3], 
       Subscript[
        Ket[1], 3]} == 1, 
     Subscript[$CellContext`R, 2], 1], $CellContext`H, {
     Subscript[
      Ket[0], 2], 
     Subscript[
      Ket[1], 2]}], 
   Style["doubles # of states", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[
    Dot[
     If[{
        Subscript[
         Ket[0], 3], 
        Subscript[
         Ket[1], 3]} == 1, {{1, 0}, {0, 
        Subscript[$CellContext`\[Omega], 2]}}, 1], {
     2^Rational[-1, 2] Subscript[
         Ket[0], 2] + 2^Rational[-1, 2] Subscript[
         Ket[1], 2], 2^Rational[-1, 2] Subscript[
         Ket[0], 2] - 2^Rational[-1, 2] Subscript[
        Ket[1], 2]}]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The FT of ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[
    Subscript[$CellContext`x, 1]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Dot[
    If[{
       Subscript[
        Ket[0], 3], 
       Subscript[
        Ket[1], 3]} == 1, 
     Subscript[$CellContext`R, 3], 1], 
    If[{
       Subscript[
        Ket[0], 2], 
       Subscript[
        Ket[1], 2]} == 1, 
     Subscript[$CellContext`R, 2], 1], $CellContext`H, {
     Subscript[
      Ket[0], 1], 
     Subscript[
      Ket[1], 1]}], 
   Style["doubles # of states", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[
    Dot[
     If[{
        Subscript[
         Ket[0], 3], 
        Subscript[
         Ket[1], 3]} == 1, {{1, 0}, {0, 
        Subscript[$CellContext`\[Omega], 3]}}, 1], 
     If[{
        Subscript[
         Ket[0], 2], 
        Subscript[
         Ket[1], 2]} == 1, {{1, 0}, {0, 
        Subscript[$CellContext`\[Omega], 2]}}, 1], {
     2^Rational[-1, 2] (Subscript[
         Ket[0], 1] + Subscript[
         Ket[1], 1]), 2^Rational[-1, 2] (Subscript[
         Ket[0], 1] - Subscript[
        Ket[1], 1])}]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compare with fractional binary notation ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {Ket[
      Subscript[$CellContext`x, 1]] -> 
    2^Rational[-1, 2] (Ket[0] + 
      E^(Complex[0, 2] 
         Pi (Rational[1, 2] Subscript[$CellContext`x, 1] + 
          Rational[1, 4] Subscript[$CellContext`x, 2] + 
          Rational[1, 8] Subscript[$CellContext`x, 3])) Ket[1]), Ket[
      Subscript[$CellContext`x, 2]] -> 
    2^Rational[-1, 2] (Ket[0] + 
      E^(Complex[0, 2] 
         Pi (Rational[1, 2] Subscript[$CellContext`x, 2] + 
          Rational[1, 4] Subscript[$CellContext`x, 3])) Ket[1]), Ket[
      Subscript[$CellContext`x, 3]] -> 
    2^Rational[-1, 2] (Ket[0] + 
      E^(Complex[0, 1] Pi Subscript[$CellContext`x, 3]) Ket[1])}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7774684823005877`*^9, 3.77746950507092*^9, 3.7774696113185368`*^9, 
   3.77746980715301*^9, 3.777469916194207*^9, 3.777471336333439*^9, 
   3.7777585570125217`*^9, 3.7777671872471743`*^9, 3.7778558571398153`*^9, 
   3.777894793476506*^9, 3.777895255065336*^9, 3.777897423374373*^9, 
   3.777897479737193*^9, 3.777897511670938*^9, 3.777897964359578*^9, 
   3.777898016225596*^9, 3.77789836450959*^9, 3.777898412958493*^9, 
   3.777901038636558*^9, 3.77790115953172*^9, 3.7779016651483994`*^9, 
   3.777904491473489*^9, 3.7779045855055*^9, {3.777904630744233*^9, 
   3.777904651127246*^9}, 3.7779778266046*^9, 3.777977860834845*^9, {
   3.777977942701664*^9, 3.777977948183423*^9}, 3.777978119339451*^9, 
   3.7784237557006197`*^9, 3.778763616783807*^9, 3.778804136432457*^9, 
   3.790614305364835*^9, 3.790784416715268*^9, 
   3.791053317497984*^9},ExpressionUUID->"f8ec5a19-749e-488f-aaaa-\
f48f56bc7e8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum phase estimation algorithm", "Subsection",
 CellChangeTimes->{{3.777985715827168*^9, 
  3.777985733064988*^9}},ExpressionUUID->"771d500e-c7d0-4e71-9405-\
c43b48f1c5e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "CG", "[", 
       "\"\<Find eigenvalues Exp[2\[Pi] \[DoubleStruckI] \[Theta]] given\>\"",
        "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"U", "[", 
         RowBox[{"CG", "[", "\"\<unitary operator\>\"", "]"}], "]"}], 
        "\[CenterDot]", 
        RowBox[{
         RowBox[{"Ket", "[", "\[Psi]", "]"}], "[", 
         RowBox[{"CG", "[", "\"\<m qubit eigenvector\>\"", "]"}], "]"}]}], 
       "\[Rule]", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"2", "\[Pi]", " ", "I", " ", "\[Theta]"}], "]"}], 
        "\[CenterDot]", 
        RowBox[{"Ket", "[", "\[Psi]", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"0", "\[LessEqual]", "\[Theta]", "<", "1"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "}"}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.777980089628927*^9, 3.7779800911709538`*^9}, {
  3.7779857494564342`*^9, 3.7779858532891273`*^9}, {3.7779858935973988`*^9, 
  3.7779860197875967`*^9}, {3.7779860555168037`*^9, 3.7779861109775553`*^9}, {
  3.777986268069662*^9, 3.7779862711593513`*^9}, {3.7780736868944798`*^9, 
  3.7780736958422413`*^9}},ExpressionUUID->"96515bda-69b0-4312-ab00-\
c0300faaab28"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Find eigenvalues Exp[2\[Pi] \[DoubleStruckI] \[Theta]] \
given\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"U", "[", 
        StyleBox["\<\"unitary operator\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}], "\[CenterDot]", 
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "\[Psi]", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[$CellContext`\[Psi]],
         Editable->False,
         SyntaxForm->Automatic], "[", 
        StyleBox["\<\"m qubit eigenvector\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], 
       "\[CenterDot]", 
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "\[Psi]", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[$CellContext`\[Psi]],
        Editable->False,
        SyntaxForm->Automatic]}]}]},
    {
     RowBox[{"0", "\[LessEqual]", "\[Theta]", "<", "1"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{3.777985854341421*^9, 3.777986021463431*^9, 
  3.777986125718851*^9, 3.777986272514289*^9, 3.7784237559013968`*^9, 
  3.778763616986205*^9, 3.778804136613502*^9, 3.790614305756434*^9, 
  3.790784417169483*^9, 
  3.7910533176276503`*^9},ExpressionUUID->"43705802-e1f4-495b-94e4-\
a6df2f33d016"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The algorithm", "Subsubsection",
 CellChangeTimes->{{3.778028437700235*^9, 
  3.778028443500668*^9}},ExpressionUUID->"472d0d1c-e266-408c-9e18-\
6a434ce5697f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$ev", "=", 
   RowBox[{"Ket", "[", 
    SubscriptBox["\[Psi]", "m"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"$algorithm", "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CG", "[", "\"\<Setup\>\"", "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<n-qubit register\>\"", ",", "\"\<m-qubit register\>\""}], 
          "}"}], "[", 
         RowBox[{"CG", "[", "\"\<n+m\[Rule]N-qubits\>\"", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CG", "[", "\"\<Create superposition\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Ket", "[", "0", "]"}], 
            RowBox[{"\[CircleTimes]", "n"}]], "\[CircleTimes]", "$ev"}], 
          "}"}], "[", 
         RowBox[{"CG", "[", "\"\<initial state\>\"", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox["H", 
              RowBox[{"\[CircleTimes]", "n"}]], "\[CircleTimes]", 
             SubscriptBox["1", "m"]}], "\[CenterDot]", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Ket", "[", "0", "]"}], 
              RowBox[{"\[CircleTimes]", "n"}]], "\[CircleTimes]", "$ev"}]}], 
           "\[Rule]", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ket", "[", "0", "]"}], "+", 
                RowBox[{"Ket", "[", "1", "]"}]}], ")"}], 
              RowBox[{"\[CircleTimes]", "n"}]], "/", 
             SuperscriptBox["2", 
              RowBox[{"n", "/", "2"}]]}], "\[CircleTimes]", "$ev"}]}], "}"}], 
         "[", 
         RowBox[{"CG", "[", "\"\<Superposition of states\>\"", "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"U", "[", 
             RowBox[{"CG", "[", "\"\<unitary operator\>\"", "]"}], "]"}], 
            "\[CenterDot]", 
            RowBox[{"$ev", "[", 
             RowBox[{"CG", "[", "\"\<m qubit eigenvector\>\"", "]"}], "]"}]}],
            "\[Rule]", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", "\[Pi]", " ", "I", " ", "\[Theta]"}], "]"}], 
            "\[CenterDot]", "$ev"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SuperscriptBox["U", 
             SuperscriptBox["2", "j"]], ".", "$ev"}], "->", 
           RowBox[{
            RowBox[{
             SuperscriptBox["U", 
              SuperscriptBox["2", 
               RowBox[{"j", "-", "1"}]]], ".", "U", ".", "$ev"}], "->", 
            RowBox[{
             RowBox[{
              SuperscriptBox["U", 
               SuperscriptBox["2", 
                RowBox[{"j", "-", "1"}]]], ".", 
              RowBox[{"Exp", "[", 
               RowBox[{"2", "\[Pi]", " ", "I", " ", "\[Theta]"}], "]"}], ".", 
              "$ev"}], "->", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"2", "\[Pi]", " ", "I", " ", 
                SuperscriptBox["2", "j"], "\[Theta]"}], "]"}], ".", 
              "$ev"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"CU", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ket", "[", "0", "]"}], "+", 
                  RowBox[{"Ket", "[", "1", "]"}]}], ")"}], "\[CircleTimes]", 
                "$ev"}], "]"}], "->", 
              RowBox[{
               RowBox[{
                RowBox[{"Ket", "[", "0", "]"}], "\[CircleTimes]", "$ev"}], 
               "+", 
               RowBox[{
                RowBox[{"Ket", "[", "1", "]"}], "\[CircleTimes]", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"2", "\[Pi]", " ", "I", " ", "\[Theta]"}], "]"}], 
                 ".", "$ev"}]}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Ket", "[", "0", "]"}], "\[CircleTimes]", "$ev"}], 
               "+", 
               RowBox[{
                RowBox[{"Ket", "[", "1", "]"}], "\[CircleTimes]", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"2", "\[Pi]", " ", "I", " ", "\[Theta]"}], "]"}], 
                 ".", "$ev"}]}]}], "\[Rule]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Ket", "[", "0", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"2", "\[Pi]", " ", "I", " ", "\[Theta]"}], "]"}], 
                  " ", 
                  RowBox[{"Ket", "[", "1", "]"}]}]}], ")"}], "\[CircleTimes]",
                "$ev"}]}]}], "\[IndentingNewLine]", "}"}], "[", 
           RowBox[{"CG", "[", "\"\<CU controlled-Unitary gate\>\"", "]"}], 
           "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$", "=", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"CircleTimes", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Ket", "[", "0", "]"}], "+", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"2", "\[Pi]", " ", "I", " ", 
                    SuperscriptBox["2", "i"], " ", "\[Theta]"}], "]"}], " ", 
                   RowBox[{"Ket", "[", "1", "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", "1"}], ",", "\[Ellipsis]", ",", "1", 
                    ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "]"}], "/", 
             SuperscriptBox["2", 
              RowBox[{"n", "/", "2"}]]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"$", "\[Rule]", 
            RowBox[{
             RowBox[{"xSum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", "\[Pi]", " ", "I", " ", "k", " ", "\[Theta]"}], 
                 "]"}], 
                RowBox[{
                 RowBox[{"Ket", "[", "k", "]"}], "[", 
                 RowBox[{"CG", "[", "\"\<binary rep. of k\>\"", "]"}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", 
                 RowBox[{
                  SuperscriptBox["2", "n"], "-", "1"}]}], "}"}]}], "]"}], "/", 
             SuperscriptBox["2", 
              RowBox[{"n", "/", "2"}]]}]}]}], "\[IndentingNewLine]", "}"}], 
         "[", 
         RowBox[{"CG", "[", "\"\<n-CU action\>\"", "]"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "5"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "line", ",", "NL", ",", 
   "\"\<\[FilledCircle] Visualize last formula for \>\"", ",", 
   RowBox[{"$s", "=", " ", 
    RowBox[{"n", "\[Rule]", "3"}]}], ",", 
   RowBox[{"CO", "[", 
    RowBox[{"\"\<. Note meaning of \>\"", ",", 
     RowBox[{"Ket", "[", "k", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   "NL", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$algorithm", "//", "tuRule"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$0", "=", 
     RowBox[{"$", "=", 
      RowBox[{"$", "//", "Last"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$0", "//", "First"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ket", "[", "0", "]"}], "+", 
         RowBox[{
          RowBox[{"Exp", "[", "a_", "]"}], 
          RowBox[{"Ket", "[", "1", "]"}]}]}], ")"}], "\[RuleDelayed]", 
       RowBox[{"1", "/;", 
        RowBox[{"tuHasAnyQ", "[", 
         RowBox[{"a", ",", "\[Ellipsis]"}], "]"}]}]}]}]}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//", 
       RowBox[{"tuOpDistributeF", "[", "CircleTimes", "]"}]}], "//", 
      RowBox[{"tuOpSimplifyF", "[", 
       RowBox[{"CircleTimes", ",", 
        RowBox[{"{", 
         RowBox[{"Exp", "[", "_", "]"}], "}"}]}], "]"}]}]}], ";", 
    RowBox[{"$", "//", "ColumnSumExp"}]}], ",", "\[IndentingNewLine]", "NL", 
   ",", "\"\<And LHS: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{"$pass", "=", 
     RowBox[{"$0", "//", "Last"}]}]}], ",", "\[IndentingNewLine]", "yield", 
   ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "/.", 
      RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ";", 
    RowBox[{"$", "//", "ColumnSumExp"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7780284454075203`*^9, 3.778028639054349*^9}, {
   3.778028682877058*^9, 3.778028786260811*^9}, {3.778028913549447*^9, 
   3.778029004271953*^9}, {3.778073384089035*^9, 3.778073461663189*^9}, {
   3.7780734998843412`*^9, 3.778073669796824*^9}, {3.778073705712816*^9, 
   3.778073831291472*^9}, {3.778073863926094*^9, 3.778073982096579*^9}, {
   3.77807402465823*^9, 3.778074084305564*^9}, {3.778074125162282*^9, 
   3.7780741256793137`*^9}, {3.7780743555691853`*^9, 
   3.7780744076297407`*^9}, {3.778074442949358*^9, 3.778074533030644*^9}, {
   3.778074577756403*^9, 3.778074680949728*^9}, {3.778074868334551*^9, 
   3.778074879517991*^9}, {3.7780749140077877`*^9, 3.778074983816154*^9}, {
   3.778075020478188*^9, 3.7780750374617367`*^9}, {3.7780807779544277`*^9, 
   3.778080804077709*^9}, {3.778080870090963*^9, 3.7780808706413193`*^9}, {
   3.778121712141433*^9, 3.778121716752447*^9}, 3.778121748729096*^9, {
   3.778121780906616*^9, 3.778121798214842*^9}, {3.778121832263977*^9, 
   3.77812198171506*^9}, {3.778122081265514*^9, 3.778122092389797*^9}, {
   3.778122289133995*^9, 3.778122314585536*^9}, {3.7781223581877527`*^9, 
   3.778122363900752*^9}, {3.778122413377219*^9, 3.778122495122353*^9}, {
   3.778122728145586*^9, 3.778122730538699*^9}, {3.7781607033475313`*^9, 
   3.7781607378388844`*^9}, {3.778240952010499*^9, 3.7782409591464663`*^9}, {
   3.7782420472166557`*^9, 3.778242282233341*^9}, {3.7782423200760803`*^9, 
   3.778242333977684*^9}, {3.778242373824765*^9, 3.778242389368128*^9}, {
   3.778242510838751*^9, 3.778242760916421*^9}, {3.778242791183494*^9, 
   3.778242802660483*^9}, {3.778242833189918*^9, 3.778242924290184*^9}, {
   3.778242988659657*^9, 3.7782429896364317`*^9}, {3.778243108957387*^9, 
   3.778243121649343*^9}, {3.778243225117815*^9, 3.778243230519072*^9}, {
   3.7782432806593933`*^9, 3.7782432983738327`*^9}, 3.778244169617194*^9, {
   3.778244711591797*^9, 3.778244721330491*^9}, {3.778340350813106*^9, 
   3.77834035668537*^9}},ExpressionUUID->"61c3d7c9-32c7-4153-bfb8-\
addf22cb3729"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[GridBox[{
      {
       StyleBox["\<\"Setup\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]]},
      {
       RowBox[{
        TagBox[GridBox[{
           {"\<\"n-qubit register\"\>"},
           {"\<\"m-qubit register\"\>"}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"n+m\[Rule]N-qubits\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       StyleBox["\<\"Create superposition\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                StyleBox["\[LeftBracketingBar]",
                 FontWeight->Bold], "0", 
                StyleBox["\[RightAngleBracket]",
                 FontWeight->Bold]}],
               Ket[0],
               Editable->False,
               SyntaxForm->Automatic], 
              RowBox[{"\[CircleTimes]", "n"}]], "\[CircleTimes]", 
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SubscriptBox["\[Psi]", "m"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               Subscript[$CellContext`\[Psi], $CellContext`m]],
              Editable->False,
              SyntaxForm->Automatic]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"initial state\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{
              RowBox[{
               SuperscriptBox["H", 
                RowBox[{"\[CircleTimes]", "n"}]], "\[CircleTimes]", 
               SubscriptBox["1", "m"]}], "\[CenterDot]", 
              RowBox[{
               SuperscriptBox[
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "0", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[0],
                 Editable->False,
                 SyntaxForm->Automatic], 
                RowBox[{"\[CircleTimes]", "n"}]], "\[CircleTimes]", 
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], 
                 SubscriptBox["\[Psi]", "m"], 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[
                 Subscript[$CellContext`\[Psi], $CellContext`m]],
                Editable->False,
                SyntaxForm->Automatic]}]}], "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["2", 
                 RowBox[{
                  RowBox[{"-", "n"}], "/", "2"}]], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[0],
                    Editable->False,
                    SyntaxForm->Automatic], "+", 
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[1],
                    Editable->False,
                    SyntaxForm->Automatic]}], ")"}], 
                 RowBox[{"\[CircleTimes]", "n"}]]}], ")"}], "\[CircleTimes]", 
              
              InterpretationBox[
               RowBox[{
                StyleBox["\[LeftBracketingBar]",
                 FontWeight->Bold], 
                SubscriptBox["\[Psi]", "m"], 
                StyleBox["\[RightAngleBracket]",
                 FontWeight->Bold]}],
               Ket[
                Subscript[$CellContext`\[Psi], $CellContext`m]],
               Editable->False,
               SyntaxForm->Automatic]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"Superposition of states\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"U", "[", 
              StyleBox["\<\"unitary operator\"\>",
               StripOnInput->False,
               LineColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FrontFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               BackFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               GraphicsColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FontFamily->"Helvetica",
               FontColor->RGBColor[0, 
                 Rational[2, 3], 0]], "]"}], "\[CenterDot]", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                StyleBox["\[LeftBracketingBar]",
                 FontWeight->Bold], 
                SubscriptBox["\[Psi]", "m"], 
                StyleBox["\[RightAngleBracket]",
                 FontWeight->Bold]}],
               Ket[
                Subscript[$CellContext`\[Psi], $CellContext`m]],
               Editable->False,
               SyntaxForm->Automatic], "[", 
              StyleBox["\<\"m qubit eigenvector\"\>",
               StripOnInput->False,
               LineColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FrontFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               BackFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               GraphicsColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FontFamily->"Helvetica",
               FontColor->RGBColor[0, 
                 Rational[2, 3], 0]], "]"}]}], "\[Rule]", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
              "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], 
             "\[CenterDot]", 
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SubscriptBox["\[Psi]", "m"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               Subscript[$CellContext`\[Psi], $CellContext`m]],
              Editable->False,
              SyntaxForm->Automatic]}]}]},
          {
           RowBox[{
            RowBox[{
             SuperscriptBox["U", 
              SuperscriptBox["2", "j"]], ".", 
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SubscriptBox["\[Psi]", "m"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               Subscript[$CellContext`\[Psi], $CellContext`m]],
              Editable->False,
              SyntaxForm->Automatic]}], "\[Rule]", 
            RowBox[{
             RowBox[{
              SuperscriptBox["U", 
               SuperscriptBox["2", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}]]], ".", "U", ".", 
              InterpretationBox[
               RowBox[{
                StyleBox["\[LeftBracketingBar]",
                 FontWeight->Bold], 
                SubscriptBox["\[Psi]", "m"], 
                StyleBox["\[RightAngleBracket]",
                 FontWeight->Bold]}],
               Ket[
                Subscript[$CellContext`\[Psi], $CellContext`m]],
               Editable->False,
               SyntaxForm->Automatic]}], "\[Rule]", 
             RowBox[{
              RowBox[{
               SuperscriptBox["U", 
                SuperscriptBox["2", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "j"}]]], ".", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], 
               ".", 
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], 
                 SubscriptBox["\[Psi]", "m"], 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[
                 Subscript[$CellContext`\[Psi], $CellContext`m]],
                Editable->False,
                SyntaxForm->Automatic]}], "\[Rule]", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", 
                 SuperscriptBox["2", 
                  RowBox[{"1", "+", "j"}]], " ", "\[Pi]", " ", "\[Theta]"}]], 
               ".", 
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], 
                 SubscriptBox["\[Psi]", "m"], 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[
                 Subscript[$CellContext`\[Psi], $CellContext`m]],
                Editable->False,
                SyntaxForm->Automatic]}]}]}]}]},
          {
           RowBox[{
            TagBox[GridBox[{
               {
                RowBox[{
                 RowBox[{"CU", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[0],
                    Editable->False,
                    SyntaxForm->Automatic], "+", 
                    InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[1],
                    Editable->False,
                    SyntaxForm->Automatic]}], ")"}], "\[CircleTimes]", 
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], 
                    SubscriptBox["\[Psi]", "m"], 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[
                    Subscript[$CellContext`\[Psi], $CellContext`m]],
                    Editable->False,
                    SyntaxForm->Automatic]}], "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[0],
                    Editable->False,
                    SyntaxForm->Automatic], "\[CircleTimes]", 
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], 
                    SubscriptBox["\[Psi]", "m"], 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[
                    Subscript[$CellContext`\[Psi], $CellContext`m]],
                    Editable->False,
                    SyntaxForm->Automatic]}], "+", 
                  RowBox[{
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[1],
                    Editable->False,
                    SyntaxForm->Automatic], "\[CircleTimes]", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
                    "\[Theta]"}]], ".", 
                    InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], 
                    SubscriptBox["\[Psi]", "m"], 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[
                    Subscript[$CellContext`\[Psi], $CellContext`m]],
                    Editable->False,
                    SyntaxForm->Automatic]}]}]}]}]},
               {
                RowBox[{
                 RowBox[{
                  RowBox[{
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[0],
                    Editable->False,
                    SyntaxForm->Automatic], "\[CircleTimes]", 
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], 
                    SubscriptBox["\[Psi]", "m"], 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[
                    Subscript[$CellContext`\[Psi], $CellContext`m]],
                    Editable->False,
                    SyntaxForm->Automatic]}], "+", 
                  RowBox[{
                   InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[1],
                    Editable->False,
                    SyntaxForm->Automatic], "\[CircleTimes]", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
                    "\[Theta]"}]], ".", 
                    InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], 
                    SubscriptBox["\[Psi]", "m"], 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[
                    Subscript[$CellContext`\[Psi], $CellContext`m]],
                    Editable->False,
                    SyntaxForm->Automatic]}]}]}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[0],
                    Editable->False,
                    SyntaxForm->Automatic], "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
                    "\[Theta]"}]], " ", 
                    InterpretationBox[
                    RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                    Ket[1],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], 
                    SubscriptBox["\[Psi]", "m"], 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[
                    Subscript[$CellContext`\[Psi], $CellContext`m]],
                   Editable->False,
                   SyntaxForm->Automatic]}]}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"], "[", 
            StyleBox["\<\"CU controlled-Unitary gate\"\>",
             StripOnInput->False,
             LineColor->RGBColor[0, 
               Rational[2, 3], 0],
             FrontFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             BackFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             GraphicsColor->RGBColor[0, 
               Rational[2, 3], 0],
             FontFamily->"Helvetica",
             FontColor->RGBColor[0, 
               Rational[2, 3], 0]], "]"}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"-", "n"}], "/", "2"}]], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "0", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[0],
                 Editable->False,
                 SyntaxForm->Automatic], "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", 
                   SuperscriptBox["2", "n"], " ", "\[Pi]", " ", "\[Theta]"}]],
                  " ", 
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
              RowBox[{"(", 
               RowBox[{
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "0", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[0],
                 Editable->False,
                 SyntaxForm->Automatic], "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", 
                   SuperscriptBox["2", 
                    RowBox[{"1", "+", "\[Ellipsis]"}]], " ", "\[Pi]", " ", 
                   "\[Theta]"}]], " ", 
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
              RowBox[{"(", 
               RowBox[{
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "0", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[0],
                 Editable->False,
                 SyntaxForm->Automatic], "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                  "4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]],
                  " ", 
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
              RowBox[{"(", 
               RowBox[{
                InterpretationBox[
                 RowBox[{
                  StyleBox["\[LeftBracketingBar]",
                   FontWeight->Bold], "0", 
                  StyleBox["\[RightAngleBracket]",
                   FontWeight->Bold]}],
                 Ket[0],
                 Editable->False,
                 SyntaxForm->Automatic], "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                  "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]],
                  " ", 
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic]}]}], ")"}]}]}]},
           {
            RowBox[{
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{
                RowBox[{"-", "n"}], "/", "2"}]], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["2", "n"], " ", "\[Pi]", " ", 
                    "\[Theta]"}]], " ", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[1],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
               RowBox[{"(", 
                RowBox[{
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["2", 
                    RowBox[{"1", "+", "\[Ellipsis]"}]], " ", "\[Pi]", " ", 
                    "\[Theta]"}]], " ", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[1],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
               RowBox[{"(", 
                RowBox[{
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
                    "\[Theta]"}]], " ", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[1],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
               RowBox[{"(", 
                RowBox[{
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
                    "\[Theta]"}]], " ", 
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[1],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}]}]}], "\[Rule]", 
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{
                RowBox[{"-", "n"}], "/", "2"}]], " ", 
              InterpretationBox[
               RowBox[{
                UnderscriptBox[
                 UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
                 TagBox[GridBox[{
                    {
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["2", "n"]}]}], "}"}]}
                   },
                   DefaultBaseStyle->"Column",
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Column"]], "[", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                  "2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]", " ", 
                   "\[Theta]"}]], " ", 
                 RowBox[{
                  InterpretationBox[
                   RowBox[{
                    StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "k", 
                    StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                   Ket[$CellContext`k],
                   Editable->False,
                   SyntaxForm->Automatic], "[", 
                  StyleBox["\<\"binary rep. of k\"\>",
                   StripOnInput->False,
                   LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   FontFamily->"Helvetica",
                   FontColor->RGBColor[0, 
                    Rational[2, 3], 0]], "]"}]}], "]"}],
               $CellContext`xSum[
               E^(Complex[0, 2] $CellContext`k Pi $CellContext`\[Theta]) 
                Ket[$CellContext`k][
                  Style["binary rep. of k", 
                   RGBColor[0, 
                    Rational[2, 3], 0], FontFamily -> 
                   "Helvetica"]], {$CellContext`k, 0, -1 + 2^$CellContext`n}],
               
               Editable->False,
               SyntaxForm->Automatic]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"n-CU action\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[FilledCircle] Visualize last formula for \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "3"}], "\[InvisibleSpace]", 
   StyleBox["\<\". Note meaning of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], "k", 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[$CellContext`k],
     Editable->False,
     SyntaxForm->Automatic],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], 
        " ", 
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "1", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1],
         Editable->False,
         SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", "1", 
     "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], 
        " ", 
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "1", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1],
         Editable->False,
         SyntaxForm->Automatic]}]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "0", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[0],
        Editable->False,
        SyntaxForm->Automatic], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], 
        " ", 
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], "1", 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[1],
         Editable->False,
         SyntaxForm->Automatic]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     StyleBox["\<\"\[Sum]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "[", 
     TagBox[GridBox[{
        {
         RowBox[{
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "\[CircleTimes]", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "\[CircleTimes]", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic]}]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic]}]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "6", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic]}]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "8", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic]}]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "10", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic]}]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "12", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "0", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[0],
            Editable->False,
            SyntaxForm->Automatic]}]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "14", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          
          RowBox[{
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic], "\[CircleTimes]", 
           InterpretationBox[
            RowBox[{
             StyleBox["\[LeftBracketingBar]",
              FontWeight->Bold], "1", 
             StyleBox["\[RightAngleBracket]",
              FontWeight->Bold]}],
            Ket[1],
            Editable->False,
            SyntaxForm->Automatic]}]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"], "]"}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"And LHS: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], " ", 
    InterpretationBox[
     RowBox[{
      UnderscriptBox[
       UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
       TagBox[GridBox[{
          {
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["2", "n"]}]}], "}"}]}
         },
         DefaultBaseStyle->"Column",
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Column"]], "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
        "2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]", " ", "\[Theta]"}]],
        " ", 
       InterpretationBox[
        RowBox[{
         StyleBox["\[LeftBracketingBar]",
          FontWeight->Bold], "k", 
         StyleBox["\[RightAngleBracket]",
          FontWeight->Bold]}],
        Ket[$CellContext`k],
        Editable->False,
        SyntaxForm->Automatic]}], "]"}],
     $CellContext`xSum[
     E^(Complex[0, 2] $CellContext`k Pi $CellContext`\[Theta]) 
      Ket[$CellContext`k], {$CellContext`k, 0, -1 + 2^$CellContext`n}],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     StyleBox["\<\"\[Sum]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "[", 
     TagBox[GridBox[{
        {
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "1", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[1],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "2", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[2],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "6", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "3", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[3],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "8", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "4", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[4],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "10", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "5", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[5],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "12", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "6", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[6],
           Editable->False,
           SyntaxForm->Automatic]}]},
        {
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
           "14", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Theta]"}]], " ", 
          
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "7", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[7],
           Editable->False,
           SyntaxForm->Automatic]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"], "]"}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}],
  SequenceForm[
   Grid[{{
      Style["Setup", 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"]}, {
      Grid[{{"n-qubit register"}, {"m-qubit register"}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["n+m\[Rule]N-qubits", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Style["Create superposition", 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"]}, {
      Grid[{{
         CircleTimes[Ket[0]^CircleTimes[$CellContext`n], 
          Ket[
           Subscript[$CellContext`\[Psi], $CellContext`m]]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["initial state", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{CenterDot[
           CircleTimes[$CellContext`H^CircleTimes[$CellContext`n], 
            Subscript[1, $CellContext`m]], 
           CircleTimes[Ket[0]^CircleTimes[$CellContext`n], 
            Ket[
             Subscript[$CellContext`\[Psi], $CellContext`m]]]] -> 
         CircleTimes[
          2^(Rational[-1, 2] $CellContext`n) (Ket[0] + Ket[1])^
            CircleTimes[$CellContext`n], 
           Ket[
            Subscript[$CellContext`\[Psi], $CellContext`m]]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["Superposition of states", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{CenterDot[
           $CellContext`U[
            Style["unitary operator", 
             RGBColor[0, 
              Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
           Ket[
            Subscript[$CellContext`\[Psi], $CellContext`m]][
            Style["m qubit eigenvector", 
             RGBColor[0, 
              Rational[2, 3], 0], FontFamily -> "Helvetica"]]] -> 
         CenterDot[E^(Complex[0, 2] Pi $CellContext`\[Theta]), 
           Ket[
            Subscript[$CellContext`\[Psi], $CellContext`m]]]}, {
        Dot[$CellContext`U^(2^$CellContext`j), 
           Ket[
            Subscript[$CellContext`\[Psi], $CellContext`m]]] -> (
          Dot[$CellContext`U^(2^(-1 + $CellContext`j)), $CellContext`U, 
            Ket[
             Subscript[$CellContext`\[Psi], $CellContext`m]]] -> (
           Dot[$CellContext`U^(2^(-1 + $CellContext`j)), 
             E^(Complex[0, 2] Pi $CellContext`\[Theta]), 
             Ket[
              Subscript[$CellContext`\[Psi], $CellContext`m]]] -> 
           Dot[E^(Complex[0, 1] 2^(1 + $CellContext`j) 
              Pi $CellContext`\[Theta]), 
             Ket[
              Subscript[$CellContext`\[Psi], $CellContext`m]]]))}, {
         Grid[{{$CellContext`CU[
              CircleTimes[Ket[0] + Ket[1], 
               Ket[
                Subscript[$CellContext`\[Psi], $CellContext`m]]]] -> 
            CircleTimes[
               Ket[0], 
               Ket[
                Subscript[$CellContext`\[Psi], $CellContext`m]]] + CircleTimes[
               Ket[1], 
               Dot[E^(Complex[0, 2] Pi $CellContext`\[Theta]), 
                Ket[
                 Subscript[$CellContext`\[Psi], $CellContext`m]]]]}, {
           CircleTimes[
               Ket[0], 
               Ket[
                Subscript[$CellContext`\[Psi], $CellContext`m]]] + CircleTimes[
               Ket[1], 
               Dot[E^(Complex[0, 2] Pi $CellContext`\[Theta]), 
                Ket[
                 Subscript[$CellContext`\[Psi], $CellContext`m]]]] -> 
            CircleTimes[
             Ket[0] + E^(Complex[0, 2] Pi $CellContext`\[Theta]) Ket[1], 
              Ket[
               Subscript[$CellContext`\[Psi], $CellContext`m]]]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["CU controlled-Unitary gate", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{
        2^(Rational[-1, 2] $CellContext`n) 
         CircleTimes[
          Ket[0] + E^(Complex[0, 1] 2^$CellContext`n Pi $CellContext`\[Theta])
               Ket[1], Ket[0] + 
           E^(Complex[0, 1] 2^(1 + $CellContext`\[Ellipsis]) 
              Pi $CellContext`\[Theta]) Ket[1], Ket[0] + 
           E^(Complex[0, 4] Pi $CellContext`\[Theta]) Ket[1], Ket[0] + 
           E^(Complex[0, 2] Pi $CellContext`\[Theta]) Ket[1]]}, {
        2^(Rational[-1, 2] $CellContext`n) 
          CircleTimes[
           Ket[0] + E^(Complex[0, 1] 2^$CellContext`n 
               Pi $CellContext`\[Theta]) Ket[1], Ket[0] + 
            E^(Complex[0, 1] 2^(1 + $CellContext`\[Ellipsis]) 
               Pi $CellContext`\[Theta]) Ket[1], Ket[0] + 
            E^(Complex[0, 4] Pi $CellContext`\[Theta]) Ket[1], Ket[0] + 
            E^(Complex[0, 2] Pi $CellContext`\[Theta]) Ket[1]] -> 
         2^(Rational[-1, 2] $CellContext`n) $CellContext`xSum[
           E^(Complex[0, 2] $CellContext`k Pi $CellContext`\[Theta]) 
            Ket[$CellContext`k][
              Style["binary rep. of k", 
               RGBColor[0, 
                Rational[2, 3], 0], FontFamily -> 
               "Helvetica"]], {$CellContext`k, 0, -1 + 2^$CellContext`n}]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["n-CU action", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[FilledCircle] Visualize last formula for ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 3, 
   Style[". Note meaning of ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Ket[$CellContext`k], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], Rational[1, 2] 2^Rational[-1, 2] 
   CircleTimes[
    Ket[0] + E^(Complex[0, 8] Pi $CellContext`\[Theta]) Ket[1], 1, Ket[0] + 
     E^(Complex[0, 4] Pi $CellContext`\[Theta]) Ket[1], Ket[0] + 
     E^(Complex[0, 2] Pi $CellContext`\[Theta]) Ket[1]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Rational[1, 2] 2^Rational[-1, 2] 
   Style["\[Sum]", 
     RGBColor[0.7, 0, 1, 1]][
     Grid[{{
        CircleTimes[
         Ket[0], 
         Ket[0], 
         Ket[0]]}, {E^(Complex[0, 2] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[0], 
          Ket[0], 
          Ket[1]]}, {E^(Complex[0, 4] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[0], 
          Ket[1], 
          Ket[0]]}, {E^(Complex[0, 6] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[0], 
          Ket[1], 
          Ket[1]]}, {E^(Complex[0, 8] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[1], 
          Ket[0], 
          Ket[0]]}, {E^(Complex[0, 10] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[1], 
          Ket[0], 
          Ket[1]]}, {E^(Complex[0, 12] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[1], 
          Ket[1], 
          Ket[0]]}, {E^(Complex[0, 14] Pi $CellContext`\[Theta]) CircleTimes[
          Ket[1], 
          Ket[1], 
          Ket[1]]}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]], Alignment -> Left]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["And LHS: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   2^(Rational[-1, 2] $CellContext`n) $CellContext`xSum[
    E^(Complex[0, 2] $CellContext`k Pi $CellContext`\[Theta]) 
     Ket[$CellContext`k], {$CellContext`k, 0, -1 + 2^$CellContext`n}], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Rational[1, 2] 2^Rational[-1, 2] 
   Style["\[Sum]", 
     RGBColor[0.7, 0, 1, 1]][
     Grid[{{
        Ket[0]}, {E^(Complex[0, 2] Pi $CellContext`\[Theta]) Ket[1]}, {
       E^(Complex[0, 4] Pi $CellContext`\[Theta]) Ket[2]}, {
       E^(Complex[0, 6] Pi $CellContext`\[Theta]) Ket[3]}, {
       E^(Complex[0, 8] Pi $CellContext`\[Theta]) Ket[4]}, {
       E^(Complex[0, 10] Pi $CellContext`\[Theta]) Ket[5]}, {
       E^(Complex[0, 12] Pi $CellContext`\[Theta]) Ket[6]}, {
       E^(Complex[0, 14] Pi $CellContext`\[Theta]) Ket[7]}}, 
      Dividers -> {{True}, {False}}, FrameStyle -> Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]], Alignment -> Left]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.778242202627254*^9, 3.778242215751272*^9}, {
   3.77824224615827*^9, 3.7782422835137453`*^9}, 3.778242338090364*^9, 
   3.778242391250536*^9, 3.778242512678938*^9, 3.7782426525785923`*^9, {
   3.77824270969722*^9, 3.778242761811323*^9}, 3.778242803669785*^9, {
   3.778242865067112*^9, 3.778242890860736*^9}, 3.778242925554978*^9, 
   3.77824299043473*^9, 3.778243122951907*^9, {3.778243287279414*^9, 
   3.778243299749988*^9}, 3.7782441797077293`*^9, 3.7782447277659187`*^9, 
   3.778340357885028*^9, 3.7784237561527863`*^9, 3.778763617157432*^9, 
   3.778804136855219*^9, 3.790614306018443*^9, 3.7907844174593887`*^9, 
   3.791053317867828*^9},ExpressionUUID->"6848e0ea-f809-403b-bd9a-\
06fedc41de46"]
}, Open  ]],

Cell["Inverse Quantum Fourier transform ", "Text",
 CellChangeTimes->{{3.778243467202632*^9, 
  3.7782434839679737`*^9}},ExpressionUUID->"9e9cb277-4edf-48ef-8aed-\
1567dc7fadd3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Inverse Quantum Fourier transform \>\"", ",", "\[IndentingNewLine]", 
   "NL", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CG", "[", "\"\<Find Inverse FT of\>\"", "]"}], ",", 
         RowBox[{"$", "=", "$pass"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$s", "=", 
          RowBox[{
           RowBox[{"Ket", "[", "k", "]"}], "->", 
           RowBox[{
            RowBox[{"xSum", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], "\[Pi]", " ", "I", " ", "x", " ", 
                 RowBox[{"k", "/", 
                  RowBox[{"(", 
                   SuperscriptBox["2", "n"], ")"}]}]}], "]"}], 
               RowBox[{"Ket", "[", "x", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{
                 SuperscriptBox["2", "n"], "-", "1"}]}], "}"}]}], "]"}], "/", 
            
            SuperscriptBox["2", 
             RowBox[{"n", "/", "2"}]]}]}]}], "}"}], "[", 
        RowBox[{"CG", "[", 
         RowBox[{"\"\<inverse FT of\>\"", ",", 
          RowBox[{"Ket", "[", "k", "]"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$pass1", "=", 
        RowBox[{"$", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"inv", "[", "FT", "]"}], "->", "$"}], "/.", "$s"}], "//",
            "tuSumGather"}], "//", 
          RowBox[{"tuSumSimplify", "[", 
           RowBox[{"{", 
            SuperscriptBox["2", "_"], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\n", 
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Phase approximation representation\>\"", ",", "\[IndentingNewLine]", 
   "NL", ",", 
   RowBox[{
    RowBox[{"$approximation", "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"$s", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "\[Element]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SuperscriptBox["2", "n"], "\[Theta]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{
               "CG", "[", 
                "\"\<nearest integer to \!\(\*SuperscriptBox[\(2\), \(n\)]\)\
\[Theta]\>\"", "]"}], "]"}], "+", 
              RowBox[{
               SuperscriptBox["2", "n"], 
               RowBox[{"\[Delta]", "[", 
                RowBox[{"CG", "[", 
                 RowBox[{"0", "\[LessEqual]", 
                  RowBox[{
                   SuperscriptBox["2", "n"], "\[Theta]"}], "\[LessEqual]", 
                  RowBox[{"1", "/", "2"}]}], "]"}], "]"}]}]}]}]}], 
           "\[IndentingNewLine]", "}"}], "[", 
          RowBox[{"CG", "[", "\"\<approximation to \[Theta]\>\"", "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"$pass2", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"$pass1", "/.", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tuRule", "[", "$s", "]"}], "//", 
              RowBox[{"tuRuleSolveF", "[", "\[Theta]", "]"}]}], ")"}]}], "//",
            "Simplify"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.778243491475568*^9, 3.778243492777061*^9}, 
   3.778244139847715*^9, {3.778244185570753*^9, 3.778244344537869*^9}, {
   3.778244392827518*^9, 3.778244393427327*^9}, {3.778244423466172*^9, 
   3.778244434702413*^9}, {3.778244506066408*^9, 3.7782445062875834`*^9}, {
   3.778244540096521*^9, 3.7782445913524523`*^9}, {3.778244659087089*^9, 
   3.778244691335258*^9}, {3.778244731893929*^9, 3.778244738168222*^9}, {
   3.778244839799263*^9, 3.7782449127384443`*^9}, {3.778244948304864*^9, 
   3.778244980396016*^9}, {3.778245394476067*^9, 3.778245414048304*^9}, {
   3.778245501115839*^9, 3.778245542423526*^9}, {3.7782531219507017`*^9, 
   3.77825312357898*^9}, {3.7782531700133142`*^9, 3.778253192569806*^9}, {
   3.7782532531050053`*^9, 3.778253377710019*^9}, {3.7782534865484867`*^9, 
   3.778253487428162*^9}, {3.778253658782112*^9, 3.778253660988881*^9}, {
   3.778255716000045*^9, 3.778255758852754*^9}, {3.7782557915141373`*^9, 
   3.7782558028760757`*^9}, {3.7782872117807503`*^9, 3.77828721939607*^9}, {
   3.77833999200105*^9, 3.778340003616069*^9}, {3.778340043814547*^9, 
   3.778340054075286*^9}},ExpressionUUID->"c89ff968-3d7c-46c8-b460-\
d889fe726f03"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Inverse Quantum Fourier transform \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       TagBox[GridBox[{
          {
           StyleBox["\<\"Find Inverse FT of\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]]},
          {
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"-", "n"}], "/", "2"}]], " ", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {
                   RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["2", "n"]}]}], "}"}]}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                "2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]", " ", 
                 "\[Theta]"}]], " ", 
               InterpretationBox[
                RowBox[{
                 StyleBox["\[LeftBracketingBar]",
                  FontWeight->Bold], "k", 
                 StyleBox["\[RightAngleBracket]",
                  FontWeight->Bold]}],
                Ket[$CellContext`k],
                Editable->False,
                SyntaxForm->Automatic]}], "]"}],
             $CellContext`xSum[
             E^(Complex[0, 2] $CellContext`k Pi $CellContext`\[Theta]) 
              Ket[$CellContext`k], {$CellContext`k, 0, -1 + 2^$CellContext`n}],
             Editable->False,
             SyntaxForm->Automatic]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], "k", 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[$CellContext`k],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{
                RowBox[{"-", "n"}], "/", "2"}]], " ", 
              InterpretationBox[
               RowBox[{
                UnderscriptBox[
                 UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
                 TagBox[GridBox[{
                    {
                    RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["2", "n"]}]}], "}"}]}
                   },
                   DefaultBaseStyle->"Column",
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Column"]], "[", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", 
                   SuperscriptBox["2", 
                    RowBox[{"1", "-", "n"}]], " ", "k", " ", "\[Pi]", " ", 
                   "x"}]], " ", 
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "x", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[$CellContext`x],
                  Editable->False,
                  SyntaxForm->Automatic]}], "]"}],
               $CellContext`xSum[
               E^(Complex[0, -1] 2^(1 - $CellContext`n) $CellContext`k 
                  Pi $CellContext`x) 
                Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
                 2^$CellContext`n}],
               Editable->False,
               SyntaxForm->Automatic]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        RowBox[{
         StyleBox["\<\"inverse FT of\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], ",", 
         StyleBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "k", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[$CellContext`k],
           Editable->False,
           SyntaxForm->Automatic],
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]}], "]"}]},
      {
       RowBox[{
        SuperscriptBox["FT", "\<\"-1\"\>"], "\[Rule]", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "n"}]], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", 
                 RowBox[{"x", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["2", "n"]}]}], "}"}]},
               {
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["2", "n"]}]}], "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k", " ", 
              "\[Pi]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["2", 
                  RowBox[{"-", "n"}]], " ", "x"}], "-", "\[Theta]"}], 
               ")"}]}]], " ", 
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], "x", 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[$CellContext`x],
             Editable->False,
             SyntaxForm->Automatic]}], "]"}],
          $CellContext`xSum[
          E^(Complex[0, -2] $CellContext`k 
             Pi (2^(-$CellContext`n) $CellContext`x - $CellContext`\[Theta])) 
           Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
            2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}],
          Editable->False,
          SyntaxForm->Automatic]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Inverse Quantum Fourier transform ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{
         Style["Find Inverse FT of", 
          RGBColor[0, 
           Rational[2, 3], 0], FontFamily -> "Helvetica"]}, {
        2^(Rational[-1, 2] $CellContext`n) $CellContext`xSum[
          E^(Complex[0, 2] $CellContext`k Pi $CellContext`\[Theta]) 
           Ket[$CellContext`k], {$CellContext`k, 0, -1 + 2^$CellContext`n}]}},
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{
        Ket[$CellContext`k] -> 
         2^(Rational[-1, 2] $CellContext`n) $CellContext`xSum[
           E^(Complex[0, -1] 2^(1 - $CellContext`n) $CellContext`k 
              Pi $CellContext`x) 
            Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
             2^$CellContext`n}]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
       Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["inverse FT of", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"], 
       Style[
        Ket[$CellContext`k], 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {$CellContext`FT^
       "-1" -> 2^(-$CellContext`n) $CellContext`xSum[
        E^(Complex[0, -2] $CellContext`k 
           Pi (2^(-$CellContext`n) $CellContext`x - $CellContext`\[Theta])) 
         Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
          2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.778244188001792*^9, 3.778244199040997*^9}, 
   3.778244350969647*^9, 3.7782443950352507`*^9, 3.778244436829825*^9, 
   3.7782445091379147`*^9, {3.778244541686756*^9, 3.7782445613650923`*^9}, 
   3.778244592390665*^9, 3.778244665600754*^9, 3.7782446956942377`*^9, 
   3.778244734250863*^9, {3.778244858454794*^9, 3.7782448789037323`*^9}, 
   3.778244913901526*^9, {3.778244954291995*^9, 3.7782449811435623`*^9}, {
   3.7782453957286997`*^9, 3.7782454180938063`*^9}, 3.7782455553991127`*^9, 
   3.77825313760653*^9, {3.778253183319292*^9, 3.7782531933527*^9}, 
   3.778253260381996*^9, {3.778253290509314*^9, 3.778253378465176*^9}, 
   3.77825348872892*^9, 3.778253662153109*^9, {3.778255739429529*^9, 
   3.7782557599345903`*^9}, 3.7782558048901033`*^9, 3.7782872207382383`*^9, 
   3.778340004935149*^9, 3.778340055245841*^9, 3.7784237563462667`*^9, 
   3.7787636172714767`*^9, 3.778804136996409*^9, 3.7906143063231087`*^9, 
   3.790784417703045*^9, 
   3.7910533181462793`*^9},ExpressionUUID->"2a8a06fe-4d08-411c-9a57-\
caed0e0f3a72"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Phase approximation representation\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"\[Theta]", "\[Element]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}]},
           {
            RowBox[{
             RowBox[{
              SuperscriptBox["2", "n"], " ", "\[Theta]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"a", "[", 
               
               StyleBox["\<\"nearest integer to \
\\!\\(\\*SuperscriptBox[\\(2\\), \\(n\\)]\\)\[Theta]\"\>",
                StripOnInput->False,
                LineColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FrontFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                BackFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                GraphicsColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FontFamily->"Helvetica",
                FontColor->RGBColor[0, 
                  Rational[2, 3], 0]], "]"}], "+", 
              RowBox[{
               SuperscriptBox["2", "n"], " ", 
               RowBox[{"\[Delta]", "[", 
                StyleBox[
                 RowBox[{"0", "\[LessEqual]", 
                  RowBox[{
                   SuperscriptBox["2", "n"], " ", "\[Theta]"}], 
                  "\[LessEqual]", 
                  FractionBox["1", "2"]}],
                 StripOnInput->False,
                 LineColor->RGBColor[0, 
                   Rational[2, 3], 0],
                 FrontFaceColor->RGBColor[0, 
                   Rational[2, 3], 0],
                 BackFaceColor->RGBColor[0, 
                   Rational[2, 3], 0],
                 GraphicsColor->RGBColor[0, 
                   Rational[2, 3], 0],
                 FontFamily->"Helvetica",
                 FontColor->RGBColor[0, 
                   Rational[2, 3], 0]], "]"}]}]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"approximation to \[Theta]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       RowBox[{
        SuperscriptBox["FT", "\<\"-1\"\>"], "\[Rule]", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "n"}]], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", 
                 RowBox[{"x", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["2", "n"]}]}], "}"}]},
               {
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SuperscriptBox["2", "n"]}]}], "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["2", 
               RowBox[{"1", "-", "n"}]], " ", "k", " ", "\[Pi]", " ", 
              RowBox[{"(", 
               RowBox[{"a", "-", "x", "+", 
                RowBox[{
                 SuperscriptBox["2", "n"], " ", "\[Delta]"}]}], ")"}]}]], " ", 
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], "x", 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[$CellContext`x],
             Editable->False,
             SyntaxForm->Automatic]}], "]"}],
          $CellContext`xSum[
          E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
             Pi ($CellContext`a - $CellContext`x + 
              2^$CellContext`n $CellContext`\[Delta])) 
           Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
            2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}],
          Editable->False,
          SyntaxForm->Automatic]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Phase approximation representation", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{
         Element[$CellContext`\[Theta], {0, 1}]}, {
        2^$CellContext`n $CellContext`\[Theta] -> $CellContext`a[
            Style[
            "nearest integer to \!\(\*SuperscriptBox[\(2\), \(n\)]\)\[Theta]", 
             RGBColor[0, 
              Rational[2, 3], 0], FontFamily -> "Helvetica"]] + 
          2^$CellContext`n $CellContext`\[Delta][
             Style[
             0 <= 2^$CellContext`n $CellContext`\[Theta] <= Rational[1, 2], 
              RGBColor[0, 
               Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["approximation to \[Theta]", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {$CellContext`FT^
       "-1" -> 2^(-$CellContext`n) $CellContext`xSum[
        E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
           Pi ($CellContext`a - $CellContext`x + 
            2^$CellContext`n $CellContext`\[Delta])) 
         Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
          2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.778244188001792*^9, 3.778244199040997*^9}, 
   3.778244350969647*^9, 3.7782443950352507`*^9, 3.778244436829825*^9, 
   3.7782445091379147`*^9, {3.778244541686756*^9, 3.7782445613650923`*^9}, 
   3.778244592390665*^9, 3.778244665600754*^9, 3.7782446956942377`*^9, 
   3.778244734250863*^9, {3.778244858454794*^9, 3.7782448789037323`*^9}, 
   3.778244913901526*^9, {3.778244954291995*^9, 3.7782449811435623`*^9}, {
   3.7782453957286997`*^9, 3.7782454180938063`*^9}, 3.7782455553991127`*^9, 
   3.77825313760653*^9, {3.778253183319292*^9, 3.7782531933527*^9}, 
   3.778253260381996*^9, {3.778253290509314*^9, 3.778253378465176*^9}, 
   3.77825348872892*^9, 3.778253662153109*^9, {3.778255739429529*^9, 
   3.7782557599345903`*^9}, 3.7782558048901033`*^9, 3.7782872207382383`*^9, 
   3.778340004935149*^9, 3.778340055245841*^9, 3.7784237563462667`*^9, 
   3.7787636172714767`*^9, 3.778804136996409*^9, 3.7906143063231087`*^9, 
   3.790784417703045*^9, 
   3.79105331826842*^9},ExpressionUUID->"e8dbd6b3-6408-4b31-b279-\
3983f30fb801"]
}, Open  ]],

Cell["Measurement", "Text",
 CellChangeTimes->{{3.778253699573349*^9, 
  3.778253701787796*^9}},ExpressionUUID->"f769fcde-3019-43bd-a365-\
6f4e2ac7c145"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Measurement. Probability that the \!\(\*SuperscriptBox[\(FT\), \(-1\)]\
\) is the state \>\"", ",", 
   RowBox[{"Ket", "[", "a", "]"}], ",", "\"\< where \>\"", ",", 
   RowBox[{"$approximation", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "0", ",", "2"}], "]"}], "]"}], ",", 
   RowBox[{"CR", "[", 
    RowBox[{"\"\<Note that \>\"", ",", 
     RowBox[{"Ket", "[", "a", "]"}], ",", "\"\< is the maximum of \>\"", ",", 
     
     RowBox[{"Ket", "[", "x", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"amp", "->", 
     RowBox[{
      RowBox[{"Bra", "[", "a", "]"}], ".", 
      RowBox[{"$pass2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "\"\<xPOFF\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//", 
     RowBox[{"tuOpSimplifyF", "[", 
      RowBox[{"dotOps", ",", 
       RowBox[{"{", 
        SuperscriptBox["2", "_"], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"Bra", "[", "a", "]"}], ".", 
        RowBox[{"xSum", "[", 
         RowBox[{"b_", ",", "c_", ",", "c1_"}], "]"}]}], "\[Rule]", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Bra", "[", "a", "]"}], ".", "b"}], ",", "c1", ",", "c"}], 
        "]"}]}]}], "//", 
     RowBox[{"tuOpSimplifyF", "[", 
      RowBox[{"dotOps", ",", 
       RowBox[{"{", 
        RowBox[{"Exp", "[", "__", "]"}], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "\"\<PON\>\"", ",", "\[IndentingNewLine]", "NL", 
   ",", "\"\<Use Orthogonality \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Bra", "[", "a", "]"}], ".", 
      RowBox[{"Ket", "[", "x", "]"}]}], "->", 
     RowBox[{"T", "[", 
      RowBox[{"\[Delta]", ",", "\"\<dd\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "x"}], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "//", 
      RowBox[{"tuSumKroneckerDelta", "[", "]"}]}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", 
   RowBox[{
    RowBox[{"$", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["#", "2"], "&"}], "/@", "$"}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ";", 
    RowBox[{"$", "//", "Framed"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 CellChangeTimes->{{3.778253667621181*^9, 3.7782536691463413`*^9}, {
   3.778253706293789*^9, 3.7782537222696238`*^9}, {3.778254833493289*^9, 
   3.778254926556716*^9}, {3.778255871718741*^9, 3.778255964300235*^9}, {
   3.77825599732598*^9, 3.778256038471456*^9}, {3.778258656459351*^9, 
   3.7782588079872103`*^9}, {3.778258857017242*^9, 3.778258902192753*^9}, {
   3.778258939648572*^9, 3.7782590328386183`*^9}, {3.77825920962455*^9, 
   3.778259303690155*^9}, {3.778259386523484*^9, 3.7782594105078773`*^9}, {
   3.7782595090179996`*^9, 3.7782596126692953`*^9}, {3.778259684829359*^9, 
   3.778259763380746*^9}, {3.7782598241289053`*^9, 3.778259844270418*^9}, {
   3.778260734258951*^9, 3.778260795582158*^9}, {3.778260979542893*^9, 
   3.778261009876404*^9}, {3.778261088498417*^9, 3.77826111229745*^9}, {
   3.778287135671443*^9, 3.7782871773493137`*^9}, {3.7782872268626213`*^9, 
   3.778287229152502*^9}, {3.778287267528925*^9, 3.778287443305657*^9}, {
   3.778288727596479*^9, 3.778288731873234*^9}, {3.778288778865917*^9, 
   3.7782888238463087`*^9}, {3.77828886256187*^9, 3.778288884306841*^9}, {
   3.778288917263727*^9, 3.7782890020956573`*^9}, {3.7782890537426367`*^9, 
   3.7782890815511827`*^9}, 3.778289133172447*^9, {3.778289165541668*^9, 
   3.778289244761764*^9}, {3.778289295487089*^9, 3.7782893037623367`*^9}, {
   3.778289378057201*^9, 3.7782894443297663`*^9}, {3.778289478796556*^9, 
   3.778289614322426*^9}, {3.7782897174194307`*^9, 3.7782897553218403`*^9}, {
   3.77833600205342*^9, 3.778336021706719*^9}, {3.7783361176244392`*^9, 
   3.778336117967267*^9}, {3.7783361638905783`*^9, 3.778336191249033*^9}, 
   3.7783398908864822`*^9, {3.778424543320072*^9, 
   3.778424544676134*^9}},ExpressionUUID->"70e48b36-21e9-4a49-90ab-\
a95275ac316c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Measurement. Probability that the \
\\!\\(\\*SuperscriptBox[\\(FT\\), \\(-1\\)]\\) is the state \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     StyleBox["\[LeftBracketingBar]",
      FontWeight->Bold], "a", 
     StyleBox["\[RightAngleBracket]",
      FontWeight->Bold]}],
    Ket[$CellContext`a],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\" where \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SuperscriptBox["2", "n"], " ", "\[Theta]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"a", "[", 
      StyleBox["\<\"nearest integer to \\!\\(\\*SuperscriptBox[\\(2\\), \
\\(n\\)]\\)\[Theta]\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}], "+", 
     RowBox[{
      SuperscriptBox["2", "n"], " ", 
      RowBox[{"\[Delta]", "[", 
       StyleBox[
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{
          SuperscriptBox["2", "n"], " ", "\[Theta]"}], "\[LessEqual]", 
         FractionBox["1", "2"]}],
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"Note that \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox[
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], "a", 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[$CellContext`a],
     Editable->False,
     SyntaxForm->Automatic],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" is the maximum of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox[
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], "x", 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[$CellContext`x],
     Editable->False,
     SyntaxForm->Automatic],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"amp", "\[Rule]", 
    RowBox[{
     InterpretationBox[
      RowBox[{
       StyleBox["\[LeftAngleBracket]",
        FontWeight->Bold], "a", 
       StyleBox["\[RightBracketingBar]",
        FontWeight->Bold]}],
      Bra[$CellContext`a],
      Editable->False,
      SyntaxForm->Automatic], ".", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"-", "n"}]], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["2", "n"]}]}], "}"}]},
             {
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["2", "n"]}]}], "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["2", 
             RowBox[{"1", "-", "n"}]], " ", "k", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"a", "-", "x", "+", 
              RowBox[{
               SuperscriptBox["2", "n"], " ", "\[Delta]"}]}], ")"}]}]], " ", 
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "x", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[$CellContext`x],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[
        E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
           Pi ($CellContext`a - $CellContext`x + 
            2^$CellContext`n $CellContext`\[Delta])) 
         Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
          2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}],
        Editable->False,
        SyntaxForm->Automatic]}], ")"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"xPOFF\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"amp", "\[Rule]", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"-", "n"}]], " ", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        StyleBox["\[LeftAngleBracket]",
         FontWeight->Bold], "a", 
        StyleBox["\[RightBracketingBar]",
         FontWeight->Bold]}],
       Bra[$CellContext`a],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      InterpretationBox[
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
         TagBox[GridBox[{
            {
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["2", "n"]}]}], "}"}]},
            {
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["2", "n"]}]}], "}"}]}
           },
           DefaultBaseStyle->"Column",
           GridBoxAlignment->{"Columns" -> {{Left}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Column"]], "[", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           SuperscriptBox["2", 
            RowBox[{"1", "-", "n"}]], " ", "k", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"a", "-", "x", "+", 
             RowBox[{
              SuperscriptBox["2", "n"], " ", "\[Delta]"}]}], ")"}]}]], " ", 
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "x", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[$CellContext`x],
          Editable->False,
          SyntaxForm->Automatic]}], "]"}],
       $CellContext`xSum[
       E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
          Pi ($CellContext`a - $CellContext`x + 
           2^$CellContext`n $CellContext`\[Delta])) 
        Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
         2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"amp", "\[Rule]", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"-", "n"}]], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
        TagBox[GridBox[{
           {
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["2", "n"]}]}], "}"}]},
           {
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["2", "n"]}]}], "}"}]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "k", " ", "\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "x", "+", 
            RowBox[{
             SuperscriptBox["2", "n"], " ", "\[Delta]"}]}], ")"}]}]], " ", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftAngleBracket]",
            FontWeight->Bold], "a", 
           StyleBox["\[RightBracketingBar]",
            FontWeight->Bold]}],
          Bra[$CellContext`a],
          Editable->False,
          SyntaxForm->Automatic], ".", 
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "x", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[$CellContext`x],
          Editable->False,
          SyntaxForm->Automatic]}]}], "]"}],
      $CellContext`xSum[
      E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
         Pi ($CellContext`a - $CellContext`x + 
          2^$CellContext`n $CellContext`\[Delta])) Dot[
         Bra[$CellContext`a], 
         Ket[$CellContext`x]], {$CellContext`k, 0, -1 + 
        2^$CellContext`n}, {$CellContext`x, 0, -1 + 2^$CellContext`n}],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Use Orthogonality \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      RowBox[{
       StyleBox["\[LeftAngleBracket]",
        FontWeight->Bold], "a", 
       StyleBox["\[RightBracketingBar]",
        FontWeight->Bold]}],
      Bra[$CellContext`a],
      Editable->False,
      SyntaxForm->Automatic], ".", 
     InterpretationBox[
      RowBox[{
       StyleBox["\[LeftBracketingBar]",
        FontWeight->Bold], "x", 
       StyleBox["\[RightAngleBracket]",
        FontWeight->Bold]}],
      Ket[$CellContext`x],
      Editable->False,
      SyntaxForm->Automatic]}], "\[Rule]", 
    InterpretationBox[
     SubsuperscriptBox["\[Delta]", 
      RowBox[{"a", "x"}], 
      StyleBox[
       RowBox[{"a", "x"}],
       StripOnInput->False,
       ShowContents->False]],
     $CellContext`Tensor[$CellContext`\[Delta], {$CellContext`Void, \
$CellContext`Void}, {$CellContext`a, $CellContext`x}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{
     SuperscriptBox["amp", "2"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "n"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["2", 
             RowBox[{"1", "+", "n"}]], " ", "\[Pi]", " ", "\[Delta]"}]]}], 
         ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
          "2", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "\[Delta]"}]]}], 
        ")"}], "2"]]}],
    StripOnInput->False]}],
  SequenceForm[
   Style["Measurement. Probability that the \!\(\*SuperscriptBox[\(FT\), \(-1\
\)]\) is the state ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Ket[$CellContext`a], 
   Style[" where ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   2^$CellContext`n $CellContext`\[Theta] -> $CellContext`a[
      Style["nearest integer to \!\(\*SuperscriptBox[\(2\), \(n\)]\)\[Theta]", 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"]] + 
    2^$CellContext`n $CellContext`\[Delta][
       Style[0 <= 2^$CellContext`n $CellContext`\[Theta] <= Rational[1, 2], 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
   Style["Note that ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[
    Ket[$CellContext`a], 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[" is the maximum of ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[
    Ket[$CellContext`x], 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`amp -> Dot[
     Bra[$CellContext`a], 
     2^(-$CellContext`n) $CellContext`xSum[
      E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
         Pi ($CellContext`a - $CellContext`x + 
          2^$CellContext`n $CellContext`\[Delta])) 
       Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
        2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}]], 
   Style["xPOFF", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`amp -> 2^(-$CellContext`n) Dot[
      Bra[$CellContext`a], 
      $CellContext`xSum[
      E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
         Pi ($CellContext`a - $CellContext`x + 
          2^$CellContext`n $CellContext`\[Delta])) 
       Ket[$CellContext`x], {$CellContext`x, 0, -1 + 
        2^$CellContext`n}, {$CellContext`k, 0, -1 + 2^$CellContext`n}]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`amp -> 
   2^(-$CellContext`n) $CellContext`xSum[
     E^(Complex[0, 1] 2^(1 - $CellContext`n) $CellContext`k 
        Pi ($CellContext`a - $CellContext`x + 
         2^$CellContext`n $CellContext`\[Delta])) Dot[
        Bra[$CellContext`a], 
        Ket[$CellContext`x]], {$CellContext`k, 0, -1 + 
       2^$CellContext`n}, {$CellContext`x, 0, -1 + 2^$CellContext`n}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Use Orthogonality ", 
    RGBColor[0.7, 0, 1, 1], Larger], Dot[
     Bra[$CellContext`a], 
     Ket[$CellContext`x]] -> $CellContext`Tensor[$CellContext`\[Delta], \
{$CellContext`Void, $CellContext`Void}, {$CellContext`a, $CellContext`x}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[$CellContext`amp^2 -> 
    2^((-2) $CellContext`n) (-1 + 
       E^(Complex[0, 2] Pi $CellContext`\[Delta]))^(-2) (-1 + 
       E^(Complex[0, 1] 2^(1 + $CellContext`n) Pi $CellContext`\[Delta]))^2]],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.778253723589121*^9, {3.7782548997575407`*^9, 3.778254928155463*^9}, 
   3.778255809314809*^9, {3.778255893789329*^9, 3.778255920588687*^9}, {
   3.7782559527103443`*^9, 3.778255965099078*^9}, {3.778255998398305*^9, 
   3.778256039638867*^9}, {3.778258673338173*^9, 3.77825871249478*^9}, {
   3.778258765175145*^9, 3.778258809312756*^9}, 3.7782588592211943`*^9, {
   3.778258890126809*^9, 3.778258903089052*^9}, {3.778258941089244*^9, 
   3.778258974705289*^9}, {3.7782590107585993`*^9, 3.77825903357344*^9}, {
   3.778259229255206*^9, 3.778259251482916*^9}, 3.778259304785696*^9, 
   3.778259411495174*^9, {3.778259511137398*^9, 3.778259527430637*^9}, {
   3.778259560143531*^9, 3.778259618535019*^9}, 3.77825968783888*^9, {
   3.7782597228230047`*^9, 3.778259764434948*^9}, {3.7782598315221243`*^9, 
   3.778259845641817*^9}, {3.778260738926878*^9, 3.7782607966119967`*^9}, {
   3.778260999908646*^9, 3.778261010889104*^9}, {3.778261089638932*^9, 
   3.77826111310084*^9}, {3.77828715673427*^9, 3.7782871782800303`*^9}, 
   3.7782872317568483`*^9, {3.778287273132862*^9, 3.778287280379375*^9}, {
   3.77828731044586*^9, 3.778287444244832*^9}, 3.7782901256245823`*^9, {
   3.778336185670392*^9, 3.778336192637368*^9}, 3.778339893013489*^9, 
   3.778423779928111*^9, 3.778424545459331*^9, 3.778763617406047*^9, 
   3.778804137103856*^9, 3.790614306713799*^9, 3.790784417930131*^9, 
   3.791053318612565*^9},ExpressionUUID->"bfbd4259-1ba7-401e-b4e1-\
b880fb4590fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bell states", "Subsection",
 CellChangeTimes->{{3.778764587757704*^9, 
  3.7787645921739187`*^9}},ExpressionUUID->"996f041b-cb21-47cf-8122-\
a61d8bf99e3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<4 maximally entabled quantum states of 2 qubits\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Ket", "[", 
            SuperscriptBox["\[CapitalPhi]", "+"], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "B"]}], "+", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "B"]}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ket", "[", 
            SuperscriptBox["\[CapitalPhi]", "-"], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "B"]}], "-", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "B"]}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ket", "[", 
            SuperscriptBox["\[CapitalPsi]", "+"], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "B"]}], "+", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "B"]}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ket", "[", 
            SuperscriptBox["\[CapitalPsi]", "-"], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "B"]}], "-", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Ket", "[", "1", "]"}], "A"], "\[CircleTimes]", 
               SubscriptBox[
                RowBox[{"Ket", "[", "0", "]"}], "B"]}]}], ")"}], "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], "}"}], "[", 
        RowBox[{"CG", "[", "\"\<Bell basis states\>\"", "]"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "6"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "NL", ",", 
   "\"\<The interpretation of symbols \>\"", ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"$s", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Ket", "[", "0", "]"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Ket", "[", "1", "]"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ket", "[", 
         RowBox[{
          SubscriptBox["0", "A"], ",", 
          SubscriptBox["0", "B"], ",", 
          SubscriptBox["0", "C"]}], "]"}], "\[Rule]", 
        RowBox[{
         SubscriptBox[
          RowBox[{"Ket", "[", "0", "]"}], "A"], "\[CircleTimes]", 
         SubscriptBox[
          RowBox[{"Ket", "[", "0", "]"}], "B"], "\[CircleTimes]", 
         SubscriptBox[
          RowBox[{"Ket", "[", "0", "]"}], "C"]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "HadamardMatrix", "]"}], "[", "2", "]"}], 
          ".", 
          RowBox[{"Ket", "[", "0", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{"$", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"$", "/.", 
              RowBox[{"tuRule", "[", "$s", "]"}]}], "//", "Activate"}], ")"}],
            "->", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{"$s", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "/", 
                 RowBox[{"Sqrt", "[", "2", "]"}]}], "&"}], "/@", 
               RowBox[{"tuRuleAdd", "[", "$s", "]"}]}], "//", "Reverse"}]}], 
            ")"}]}]}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "}"}]}], ";", 
    RowBox[{
     RowBox[{"$", "//", "MatrixForms"}], "//", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}]}]}], ",", "\[IndentingNewLine]",
    "\[IndentingNewLine]", "NL", ",", "\"\<Ex. show transform: \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{
       SubscriptBox["0", "A"], ",", 
       SubscriptBox["0", "B"]}], "]"}], "->", 
     RowBox[{"Ket", "[", 
      SuperscriptBox["\[CapitalPhi]", "+"], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        SubscriptBox["0", "A"], ",", 
        SubscriptBox["0", "B"]}], "]"}], "\[Rule]", 
      RowBox[{
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}]}], "}"}], "A"], "\[CircleTimes]", 
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}]}], "}"}], "B"]}]}]}], ";", 
    RowBox[{"$", "//", "MatrixForms"}]}], ",", "\[IndentingNewLine]", "Yield",
    ",", 
   RowBox[{
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "HadamardMatrix", "]"}], "[", "2", "]"}], ".", 
      RowBox[{"$", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "HadamardMatrix", "]"}], "[", "2", "]"}], ".", 
      RowBox[{"$", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}]}]}], ";", 
    RowBox[{"$", "//", "MatrixForms"}]}], ",", "\[IndentingNewLine]", "Yield",
    ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "//", "Activate"}]}], ";", 
    RowBox[{"$", "//", "MatrixForms"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7787645943233356`*^9, 3.778764698583445*^9}, {
   3.7787649555633287`*^9, 3.778765229325418*^9}, {3.778766045225995*^9, 
   3.7787660513277273`*^9}, 3.778766108618188*^9, 3.778766185306203*^9, {
   3.7787670064316387`*^9, 3.7787672175633383`*^9}, {3.7787672915651293`*^9, 
   3.778767421778798*^9}, {3.778767759611382*^9, 3.778767773009404*^9}, {
   3.778767850972651*^9, 3.778767853796941*^9}, {3.7787678997458076`*^9, 
   3.778767903623496*^9}, {3.778767937095455*^9, 3.778768003267355*^9}, {
   3.7787685230374193`*^9, 3.778768569331558*^9}, {3.7787701351459627`*^9, 
   3.7787702180230703`*^9}, {3.778770251168277*^9, 3.778770274273161*^9}, {
   3.778770333771247*^9, 3.778770390850149*^9}, {3.778770421502411*^9, 
   3.778770442709772*^9}, {3.7787704826806583`*^9, 3.7787705416636744`*^9}, {
   3.778770571960761*^9, 3.778770696841134*^9}, {3.778853188120348*^9, 
   3.778853212506908*^9}, {3.7788536437150297`*^9, 3.778853654863831*^9}, {
   3.77885369628999*^9, 3.7788536987430563`*^9}, {3.778853735814384*^9, 
   3.778853793983672*^9}, {3.7788538532867813`*^9, 3.778853887077767*^9}, {
   3.778853917480032*^9, 3.778853923914562*^9}, {3.778854002371718*^9, 
   3.7788540089039783`*^9}, {3.778854049684085*^9, 3.7788541419647427`*^9}, {
   3.77885422123065*^9, 3.778854243874114*^9}, 3.778854579099959*^9, {
   3.7788546800880747`*^9, 3.778854711713708*^9}, {3.778854757791689*^9, 
   3.778854796031199*^9}, {3.778855180689642*^9, 3.778855186375333*^9}, {
   3.7788552506085567`*^9, 3.778855320814968*^9}, {3.778855360909505*^9, 
   3.778855364070492*^9}, {3.778855404485183*^9, 3.778855406628893*^9}, {
   3.778862075309238*^9, 3.7788621042977324`*^9}, {3.778862138740966*^9, 
   3.7788621551116056`*^9}},ExpressionUUID->"883d9c44-5066-4ab9-acd8-\
4f6caff49f0f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[GridBox[{
      {"\<\"4 maximally entabled quantum states of 2 qubits\"\>"},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SuperscriptBox["\[CapitalPhi]", "+"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               SuperPlus[$CellContext`\[CapitalPhi]]],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             FractionBox[
              RowBox[{
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}], "+", 
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}]}], 
              SqrtBox["2"]]}]},
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SuperscriptBox["\[CapitalPhi]", "-"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               SuperMinus[$CellContext`\[CapitalPhi]]],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             FractionBox[
              RowBox[{
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}], "-", 
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}]}], 
              SqrtBox["2"]]}]},
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SuperscriptBox["\[CapitalPsi]", "+"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               SuperPlus[$CellContext`\[CapitalPsi]]],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             FractionBox[
              RowBox[{
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}], "+", 
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}]}], 
              SqrtBox["2"]]}]},
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               StyleBox["\[LeftBracketingBar]",
                FontWeight->Bold], 
               SuperscriptBox["\[CapitalPsi]", "-"], 
               StyleBox["\[RightAngleBracket]",
                FontWeight->Bold]}],
              Ket[
               SuperMinus[$CellContext`\[CapitalPsi]]],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             FractionBox[
              RowBox[{
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}], "-", 
               RowBox[{
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "1", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[1],
                  Editable->False,
                  SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
                SubscriptBox[
                 InterpretationBox[
                  RowBox[{
                   StyleBox["\[LeftBracketingBar]",
                    FontWeight->Bold], "0", 
                   StyleBox["\[RightAngleBracket]",
                    FontWeight->Bold]}],
                  Ket[0],
                  Editable->False,
                  SyntaxForm->Automatic], "B"]}]}], 
              SqrtBox["2"]]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"Bell basis states\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The interpretation of symbols \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       TagBox[GridBox[{
          {
           RowBox[{
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], "0", 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[0],
             Editable->False,
             SyntaxForm->Automatic], "\[Rule]", 
            TagBox[
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {"1"},
                {"0"}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
             Function[BoxForm`e$, 
              MatrixForm[BoxForm`e$]]]}]},
          {
           RowBox[{
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], "1", 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[1],
             Editable->False,
             SyntaxForm->Automatic], "\[Rule]", 
            TagBox[
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {"0"},
                {"1"}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
             Function[BoxForm`e$, 
              MatrixForm[BoxForm`e$]]]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftBracketingBar]",
           FontWeight->Bold], 
          RowBox[{
           SubscriptBox["0", "A"], ",", 
           SubscriptBox["0", "B"], ",", 
           SubscriptBox["0", "C"]}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         Ket[
          Subscript[0, $CellContext`A], 
          Subscript[0, $CellContext`B], 
          Subscript[0, C]],
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "A"], "\[CircleTimes]", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "B"], "\[CircleTimes]", 
         SubscriptBox[
          InterpretationBox[
           RowBox[{
            StyleBox["\[LeftBracketingBar]",
             FontWeight->Bold], "0", 
            StyleBox["\[RightAngleBracket]",
             FontWeight->Bold]}],
           Ket[0],
           Editable->False,
           SyntaxForm->Automatic], "C"]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{"HadamardMatrix"},
           "InactiveHead",
           BaseStyle->"Inactive",
           SyntaxForm->"Symbol",
           Tooltip->"Inactive[HadamardMatrix]"], "[", "2", "]"}], ".", 
         InterpretationBox[
          RowBox[{
           StyleBox["\[LeftBracketingBar]",
            FontWeight->Bold], "0", 
           StyleBox["\[RightAngleBracket]",
            FontWeight->Bold]}],
          Ket[0],
          Editable->False,
          SyntaxForm->Automatic]}], "\[Rule]", 
        RowBox[{
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              FractionBox["1", 
               SqrtBox["2"]]},
             {
              FractionBox["1", 
               SqrtBox["2"]]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[Rule]", 
         RowBox[{
          TagBox[
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               FractionBox["1", 
                SqrtBox["2"]]},
              {
               FractionBox["1", 
                SqrtBox["2"]]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], "\[Rule]", 
          FractionBox[
           RowBox[{
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], "0", 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[0],
             Editable->False,
             SyntaxForm->Automatic], "+", 
            InterpretationBox[
             RowBox[{
              StyleBox["\[LeftBracketingBar]",
               FontWeight->Bold], "1", 
              StyleBox["\[RightAngleBracket]",
               FontWeight->Bold]}],
             Ket[1],
             Editable->False,
             SyntaxForm->Automatic]}], 
           SqrtBox["2"]]}]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Ex. show transform: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      RowBox[{
       SubscriptBox["0", "A"], ",", 
       SubscriptBox["0", "B"]}], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[0, $CellContext`A], 
      Subscript[0, $CellContext`B]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      SuperscriptBox["\[CapitalPhi]", "+"], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      SuperPlus[$CellContext`\[CapitalPhi]]],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      RowBox[{
       SubscriptBox["0", "A"], ",", 
       SubscriptBox["0", "B"]}], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[0, $CellContext`A], 
      Subscript[0, $CellContext`B]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     SubscriptBox[
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], "A"], "\[CircleTimes]", 
     SubscriptBox[
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], "B"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      RowBox[{
       SubscriptBox["0", "A"], ",", 
       SubscriptBox["0", "B"]}], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[0, $CellContext`A], 
      Subscript[0, $CellContext`B]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     SubscriptBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"HadamardMatrix"},
         "InactiveHead",
         BaseStyle->"Inactive",
         SyntaxForm->"Symbol",
         Tooltip->"Inactive[HadamardMatrix]"], "[", "2", "]"}], ".", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1"},
           {"0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}], "A"], "\[CircleTimes]", 
     SubscriptBox[
      RowBox[{
       RowBox[{
        TemplateBox[{"HadamardMatrix"},
         "InactiveHead",
         BaseStyle->"Inactive",
         SyntaxForm->"Symbol",
         Tooltip->"Inactive[HadamardMatrix]"], "[", "2", "]"}], ".", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1"},
           {"0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}], "B"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      StyleBox["\[LeftBracketingBar]",
       FontWeight->Bold], 
      RowBox[{
       SubscriptBox["0", "A"], ",", 
       SubscriptBox["0", "B"]}], 
      StyleBox["\[RightAngleBracket]",
       FontWeight->Bold]}],
     Ket[
      Subscript[0, $CellContext`A], 
      Subscript[0, $CellContext`B]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     SubscriptBox[
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           FractionBox["1", 
            SqrtBox["2"]]},
          {
           FractionBox["1", 
            SqrtBox["2"]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], "A"], "\[CircleTimes]", 
     SubscriptBox[
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           FractionBox["1", 
            SqrtBox["2"]]},
          {
           FractionBox["1", 
            SqrtBox["2"]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], "B"]}]}]}],
  SequenceForm[
   Grid[{{"4 maximally entabled quantum states of 2 qubits"}, {
      Grid[{{Ket[
           SuperPlus[$CellContext`\[CapitalPhi]]] -> 
         2^Rational[-1, 2] (CircleTimes[
             Subscript[
              Ket[0], $CellContext`A], 
             Subscript[
              Ket[0], $CellContext`B]] + CircleTimes[
             Subscript[
              Ket[1], $CellContext`A], 
             Subscript[
              Ket[1], $CellContext`B]])}, {Ket[
           SuperMinus[$CellContext`\[CapitalPhi]]] -> 
         2^Rational[-1, 2] (CircleTimes[
             Subscript[
              Ket[0], $CellContext`A], 
             Subscript[
              Ket[0], $CellContext`B]] - CircleTimes[
            Subscript[
             Ket[1], $CellContext`A], 
            Subscript[
             Ket[1], $CellContext`B]])}, {Ket[
           SuperPlus[$CellContext`\[CapitalPsi]]] -> 
         2^Rational[-1, 2] (CircleTimes[
             Subscript[
              Ket[0], $CellContext`A], 
             Subscript[
              Ket[1], $CellContext`B]] + CircleTimes[
             Subscript[
              Ket[1], $CellContext`A], 
             Subscript[
              Ket[0], $CellContext`B]])}, {Ket[
           SuperMinus[$CellContext`\[CapitalPsi]]] -> 
         2^Rational[-1, 2] (CircleTimes[
             Subscript[
              Ket[0], $CellContext`A], 
             Subscript[
              Ket[1], $CellContext`B]] - CircleTimes[
            Subscript[
             Ket[1], $CellContext`A], 
            Subscript[
             Ket[0], $CellContext`B]])}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["Bell basis states", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The interpretation of symbols ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{
      Grid[{{Ket[0] -> MatrixForm[{{1}, {0}}]}, {
        Ket[1] -> MatrixForm[{{0}, {1}}]}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {Ket[
        Subscript[0, $CellContext`A], 
        Subscript[0, $CellContext`B], 
        Subscript[0, C]] -> CircleTimes[
        Subscript[
         Ket[0], $CellContext`A], 
        Subscript[
         Ket[0], $CellContext`B], 
        Subscript[
         Ket[0], C]]}, {Dot[
        Inactive[HadamardMatrix][2], 
        Ket[0]] -> (
       MatrixForm[{{2^Rational[-1, 2]}, {2^Rational[-1, 2]}}] -> (
        MatrixForm[{{2^Rational[-1, 2]}, {2^Rational[-1, 2]}}] -> 
        2^Rational[-1, 2] (Ket[0] + Ket[1])))}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Ex. show transform: ", 
    RGBColor[0.7, 0, 1, 1], Larger], Ket[
     Subscript[0, $CellContext`A], 
     Subscript[0, $CellContext`B]] -> Ket[
     SuperPlus[$CellContext`\[CapitalPhi]]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Ket[
     Subscript[0, $CellContext`A], 
     Subscript[0, $CellContext`B]] -> CircleTimes[
     Subscript[
      MatrixForm[{{1}, {0}}], $CellContext`A], 
     Subscript[
      MatrixForm[{{1}, {0}}], $CellContext`B]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Ket[
     Subscript[0, $CellContext`A], 
     Subscript[0, $CellContext`B]] -> CircleTimes[
     Subscript[
      Dot[
       Inactive[HadamardMatrix][2], 
       MatrixForm[{{1}, {0}}]], $CellContext`A], 
     Subscript[
      Dot[
       Inactive[HadamardMatrix][2], 
       MatrixForm[{{1}, {0}}]], $CellContext`B]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Ket[
     Subscript[0, $CellContext`A], 
     Subscript[0, $CellContext`B]] -> CircleTimes[
     Subscript[
      MatrixForm[{{2^Rational[-1, 2]}, {2^Rational[-1, 2]}}], $CellContext`A], 
     Subscript[
      MatrixForm[{{2^Rational[-1, 2]}, {
        2^Rational[-1, 2]}}], $CellContext`B]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7787650752533007`*^9, 3.778765083764679*^9}, 
   3.7787651684541893`*^9, {3.778765202166018*^9, 3.7787652297158623`*^9}, 
   3.7787661115844173`*^9, {3.778767068389827*^9, 3.778767094123857*^9}, 
   3.778767167001854*^9, {3.778767298247225*^9, 3.778767422695018*^9}, 
   3.7787677686730537`*^9, 3.778767905101912*^9, {3.778767970142254*^9, 
   3.7787680047818604`*^9}, {3.7787701916248083`*^9, 3.778770218820918*^9}, {
   3.7787702600391483`*^9, 3.778770275190776*^9}, {3.7787703724653473`*^9, 
   3.778770391609604*^9}, {3.7787704263433743`*^9, 3.778770443964521*^9}, 
   3.778770485899362*^9, {3.778770516011883*^9, 3.778770527790402*^9}, {
   3.778770576262734*^9, 3.7787705969221354`*^9}, {3.778770633049608*^9, 
   3.778770697688574*^9}, 3.7788041371874123`*^9, 3.778853213515513*^9, 
   3.778853655676517*^9, 3.778853699391349*^9, {3.778853744488543*^9, 
   3.778853753912445*^9}, 3.778853796029182*^9, 3.778853888206442*^9, 
   3.778853925141396*^9, 3.778854009809443*^9, 3.7788540791406593`*^9, {
   3.778854116189229*^9, 3.778854142992236*^9}, 3.778854252243643*^9, 
   3.778854583050476*^9, 3.778854712999976*^9, 3.778854797438052*^9, 
   3.77885518761845*^9, {3.7788552995001583`*^9, 3.778855324217393*^9}, 
   3.7788553650774603`*^9, 3.778855407980461*^9, 3.778862110403969*^9, 
   3.7788621560869207`*^9, 3.7906143068518133`*^9, 3.7907844180917997`*^9, 
   3.7910533187510366`*^9},ExpressionUUID->"a1fa2459-bb2d-4d80-895f-\
8ab3718f2db8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shor\[CloseCurlyQuote]s algorithm", "Subsection",
 CellChangeTimes->{{3.778507687307878*^9, 
  3.7785076942331257`*^9}},ExpressionUUID->"1a2c4e3e-2190-4bd2-8718-\
6e2da80f3de7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"URL", "[", 
  "\"\<https://en.wikipedia.org/wiki/Shor%27s_algorithm\>\"", "]"}]], "Input",\

 CellChangeTimes->{{3.7785076419434633`*^9, 
  3.778507671959365*^9}},ExpressionUUID->"75aada4e-937e-4504-a8fb-\
d7926482fb4c"],

Cell[BoxData[
 RowBox[{"URL", "[", 
  TemplateBox[{"\"https://en.wikipedia.org/wiki/Shor%27s_algorithm\""},
   "URLArgument"], "]"}]], "Output",
 CellChangeTimes->{3.778507673263476*^9, 3.778763617455792*^9, 
  3.778804137301737*^9, 3.790614306978112*^9, 3.790784418304454*^9, 
  3.7910533188700247`*^9},ExpressionUUID->"4e2a090b-5dc1-4619-9405-\
e234b560e23b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Shor's algorithm, which finds the prime factors of an integer N, \
consists of a classical part and a quantum part. \>\"", ",", 
   "\[IndentingNewLine]", "line", ",", "NL", ",", 
   "\"\<\[Bullet] The classical part reduces the factoring problem to the \
problem of group-order-finding.\>\"", ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Given N, \>\"", ",", 
   RowBox[{"1", "<", 
    RowBox[{"a", "[", 
     RowBox[{"CG", "[", "\"\<choose a random number\>\"", "]"}], "]"}], "<", 
    "N"}], ",", "\[IndentingNewLine]", "NL", ",", 
   RowBox[{"_If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GCD", "[", 
      RowBox[{"a", ",", "N"}], "]"}], "\[NotEqual]", "1"}], "]"}], ",", 
   "imply", ",", 
   RowBox[{"a", "[", 
    RowBox[{"CG", "[", "\"\<factor of N, DONE\>\"", "]"}], "]"}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<and test for Power[j,k]\[Rule]N, j\[NotEqual]a \>\"", ",", 
   RowBox[{"_If", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["N", 
        RowBox[{"1", "/", "k"}]], "\[Element]", "\[DoubleStruckCapitalZ]"}], 
      ",", 
      RowBox[{"2", "\[LessEqual]", "k", "\[LessEqual]", 
       RowBox[{"Log", "[", 
        RowBox[{"3", ",", "N"}], "]"}]}]}], "}"}], "]"}], ",", "imply", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Exists", "[", 
      RowBox[{"j", ",", 
       RowBox[{"j", "\[Element]", "\[DoubleStruckCapitalZ]"}], ",", 
       RowBox[{
        SuperscriptBox["j", "k"], "\[Rule]", "N"}]}], "]"}], ",", 
     RowBox[{"CG", "[", "\"\<DONE\>\"", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{"_Else", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$else", "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CO", "[", 
          RowBox[{
          "\"\<Assume N is a product of two coprimes {a,n}, \>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "n"}], "}"}], "\[SuchThat]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", " ", "n"}], "\[Rule]", "N"}], ",", 
                  RowBox[{
                   RowBox[{"GCD", "[", 
                    RowBox[{"a", ",", "n"}], "]"}], "\[Rule]", "1"}]}], 
                 "}"}]}], ")"}], "\[DoubleLeftRightArrow]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  SuperscriptBox["a", 
                   RowBox[{"EulerPhi", "[", "n", "]"}]], ",", "n"}], "]"}], 
                "\[Rule]", "1"}], ")"}]}], "}"}], "[", 
            RowBox[{"CG", "[", "\"\<Euler's theorem\>\"", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           "\"\<Use quantum period-finding to find smallest period r\>\""}], 
          "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"CG", "[", 
             RowBox[{"\"\<the smallest period of\>\"", ",", 
              RowBox[{"$", "=", 
               RowBox[{
                RowBox[{"f", "[", "x", "]"}], "\[Rule]", 
                RowBox[{"f", "[", 
                 RowBox[{"x", "+", "r"}], "]"}]}]}]}], "]"}], "]"}], ",", 
           RowBox[{"$f", "=", 
            RowBox[{
             RowBox[{"f", "[", "x_", "]"}], "\[Rule]", 
             RowBox[{"Mod", "[", 
              RowBox[{
               SuperscriptBox["a", "x"], ",", "N"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"$", "=", 
            RowBox[{
             RowBox[{"$", "/.", "$f"}], "//", "tuRule1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CR", "[", "\"\<Why?\>\"", "]"}]}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"_If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_OddQ", "[", "r", "]"}], "}"}], "[", 
             RowBox[{"CO", "[", "\"\<r/2 not integer\>\"", "]"}], "]"}], "||", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  SuperscriptBox["a", 
                   RowBox[{"r", "/", "2"}]], ",", "N"}], "]"}], "\[Rule]", 
                RowBox[{"-", "1"}]}], "}"}], "[", 
              RowBox[{"CR", "[", "\"\<isn't this >0 always\>\"", "]"}], "]"}],
              "}"}]}], ",", 
           RowBox[{"CG", "[", "\"\<Choose another a\>\"", "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"_Else", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GCD", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", 
                 RowBox[{"r", "/", "2"}]], "+", "1"}], ",", "N"}], "]"}], "||", 
             RowBox[{"GCD", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", 
                 RowBox[{"r", "/", "2"}]], "-", "1"}], ",", "N"}], "]"}]}], 
            "}"}], "[", 
           RowBox[{"CG", "[", "\"\<is factor of N: DONE\>\"", "]"}], "]"}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
     ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.77850770344965*^9, 3.7785077661142817`*^9}, 
   3.778507879943997*^9, {3.7785087915290194`*^9, 3.778509139900548*^9}, {
   3.7785091745236273`*^9, 3.778509228445612*^9}, {3.7785092647810087`*^9, 
   3.7785093218033733`*^9}, {3.7785101532293253`*^9, 3.77851015577564*^9}, {
   3.7785101911365347`*^9, 3.778510211131628*^9}, {3.778510257466444*^9, 
   3.778510329864978*^9}, {3.778510416034894*^9, 3.77851044160118*^9}, {
   3.778510486469459*^9, 3.7785105022209787`*^9}, {3.778510555128366*^9, 
   3.7785106147107277`*^9}, {3.778510684628077*^9, 3.778510685307639*^9}, {
   3.778510722658249*^9, 3.7785109179446497`*^9}, {3.778510957625972*^9, 
   3.778511007853498*^9}, {3.7785110703506193`*^9, 3.778511247402919*^9}, {
   3.778511341266272*^9, 3.7785113507458*^9}, {3.778511610841238*^9, 
   3.7785116214582787`*^9}, {3.778511658141816*^9, 3.778511668066537*^9}, {
   3.7785118262089367`*^9, 3.778511915365095*^9}, {3.7785119701490183`*^9, 
   3.7785119750691357`*^9}, {3.7892208225167522`*^9, 
   3.7892208624299583`*^9}, {3.789221376614791*^9, 3.789221425388145*^9}, {
   3.789221464836615*^9, 3.789221493172254*^9}, {3.78922242584931*^9, 
   3.789222467320792*^9}, {3.7892235643026133`*^9, 3.789223569845131*^9}, {
   3.789224123509116*^9, 3.789224281427918*^9}, {3.789224318566635*^9, 
   3.78922432666901*^9}, {3.789224377418487*^9, 3.7892243779955263`*^9}, {
   3.789224427704443*^9, 3.789224430609762*^9}, {3.789233120135007*^9, 
   3.7892331551409388`*^9}, {3.789234150313167*^9, 3.789234157346764*^9}, {
   3.789234232501771*^9, 3.7892342416105957`*^9}, {3.789234574499453*^9, 
   3.7892346932570066`*^9}, {3.789234728974121*^9, 3.7892347865533867`*^9}, {
   3.78923484670831*^9, 3.789234916476466*^9}, {3.789235191892519*^9, 
   3.78923521802141*^9}, 3.789235262898507*^9, {3.789235831483553*^9, 
   3.789236196225021*^9}, {3.7892363691424723`*^9, 3.789236376273757*^9}, {
   3.789477460248068*^9, 3.789477469390729*^9}, {3.789479126770116*^9, 
   3.789479127878543*^9}, {3.7894794197166557`*^9, 3.789479495325447*^9}, {
   3.789479639727601*^9, 3.789479642292035*^9}, {3.78947967605654*^9, 
   3.789479732992118*^9}, {3.789479793645753*^9, 3.789479828509576*^9}, {
   3.789479900292923*^9, 3.789479902050012*^9}, {3.789486155217272*^9, 
   3.789486197647626*^9}, {3.789486232386965*^9, 3.7894862853735332`*^9}, {
   3.789486340540118*^9, 3.789486458337734*^9}, {3.789505094686627*^9, 
   3.789505098381793*^9}, {3.7899098162997637`*^9, 3.7899098465385427`*^9}, {
   3.789909897882292*^9, 3.789909898056065*^9}, {3.789910047572077*^9, 
   3.789910048615466*^9}, {3.789910081032686*^9, 3.7899100953780403`*^9}, {
   3.789910687070065*^9, 3.789910794974881*^9}, {3.7899108614170094`*^9, 
   3.7899108633258123`*^9}, {3.789910895106736*^9, 3.789910959661834*^9}, {
   3.789911045451899*^9, 3.789911146037105*^9}, {3.7899111905189943`*^9, 
   3.789911204658667*^9}, {3.789911378840082*^9, 3.7899114123825407`*^9}, {
   3.789915280188754*^9, 3.789915293371768*^9}, {3.789997400024046*^9, 
   3.7899974279281607`*^9}, {3.789997612094976*^9, 3.78999764205042*^9}, {
   3.789997680685645*^9, 3.7899977561694803`*^9}, {3.789998826918714*^9, 
   3.789998840107272*^9}, {3.789999661182419*^9, 3.7899998557269583`*^9}, {
   3.789999891600501*^9, 3.7899999677082243`*^9}, {3.790000279301847*^9, 
   3.7900003867386417`*^9}, {3.790000426032339*^9, 3.790000454023511*^9}, {
   3.790000647211546*^9, 3.790000653043256*^9}, {3.790690644670905*^9, 
   3.790690647333909*^9}, {3.790690794233677*^9, 
   3.79069079556087*^9}},ExpressionUUID->"04247828-d4bc-4047-8280-\
7f28494c4694"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Shor's algorithm, which finds the prime factors of an \
integer N, consists of a classical part and a quantum part. \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] The classical part reduces the factoring problem \
to the problem of group-order-finding.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Given N, \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"1", "<", 
    RowBox[{"a", "[", 
     StyleBox["\<\"choose a random number\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], "]"}], "<", "N"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"_If", "[", 
    RowBox[{
     RowBox[{"GCD", "[", 
      RowBox[{"a", ",", "N"}], "]"}], "\[NotEqual]", "1"}], "]"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"a", "[", 
    StyleBox["\<\"factor of N, DONE\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0, 
       Rational[2, 3], 0],
     FrontFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     BackFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     GraphicsColor->RGBColor[0, 
       Rational[2, 3], 0],
     FontFamily->"Helvetica",
     FontColor->RGBColor[0, 
       Rational[2, 3], 0]], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"and test for Power[j,k]\[Rule]N, j\[NotEqual]a \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"_If", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["N", 
        FractionBox["1", "k"]], "\[Element]", "\[DoubleStruckCapitalZ]"}], 
      ",", 
      RowBox[{"2", "\[LessEqual]", "k", "\[LessEqual]", 
       FractionBox[
        RowBox[{"Log", "[", "N", "]"}], 
        RowBox[{"Log", "[", "3", "]"}]]}]}], "}"}], "]"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Exists]", 
       RowBox[{"j", ",", 
        RowBox[{"j", "\[Element]", "\[DoubleStruckCapitalZ]"}]}]], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["j", "k"], "\[Rule]", "N"}], ")"}]}], ",", 
     StyleBox["\<\"DONE\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"_Else", "[", 
    TagBox[GridBox[{
       {
        StyleBox["\<\"Assume N is a product of two coprimes {a,n}, \"\>",
         StripOnInput->False,
         LineColor->RGBColor[1, 0.5, 0],
         FrontFaceColor->RGBColor[1, 0.5, 0],
         BackFaceColor->RGBColor[1, 0.5, 0],
         GraphicsColor->RGBColor[1, 0.5, 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[1, 0.5, 0]]},
       {
        StyleBox[
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "n"}], "}"}], "\[SuchThat]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", " ", "n"}], "\[Rule]", "N"}], ",", 
                RowBox[{
                 RowBox[{"GCD", "[", 
                  RowBox[{"a", ",", "n"}], "]"}], "\[Rule]", "1"}]}], "}"}]}],
              ")"}], "\[DoubleLeftRightArrow]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                SuperscriptBox["a", 
                 RowBox[{"EulerPhi", "[", "n", "]"}]], ",", "n"}], "]"}], 
              "\[Rule]", "1"}], ")"}]}], "}"}], "[", 
          StyleBox["\<\"Euler's theorem\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}],
         StripOnInput->False,
         LineColor->RGBColor[1, 0.5, 0],
         FrontFaceColor->RGBColor[1, 0.5, 0],
         BackFaceColor->RGBColor[1, 0.5, 0],
         GraphicsColor->RGBColor[1, 0.5, 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[1, 0.5, 0]]},
       {
        StyleBox["\<\"Use quantum period-finding to find smallest period \
r\"\>",
         StripOnInput->False,
         LineColor->RGBColor[1, 0.5, 0],
         FrontFaceColor->RGBColor[1, 0.5, 0],
         BackFaceColor->RGBColor[1, 0.5, 0],
         GraphicsColor->RGBColor[1, 0.5, 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[1, 0.5, 0]]},
       {
        TagBox[GridBox[{
           {
            RowBox[{"r", "[", 
             RowBox[{
              StyleBox["\<\"the smallest period of\"\>",
               StripOnInput->False,
               LineColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FrontFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               BackFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               GraphicsColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FontFamily->"Helvetica",
               FontColor->RGBColor[0, 
                 Rational[2, 3], 0]], ",", 
              StyleBox[
               RowBox[{
                RowBox[{"f", "[", "x", "]"}], "\[Rule]", 
                RowBox[{"f", "[", 
                 RowBox[{"r", "+", "x"}], "]"}]}],
               StripOnInput->False,
               LineColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FrontFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               BackFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               GraphicsColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FontFamily->"Helvetica",
               FontColor->RGBColor[0, 
                 Rational[2, 3], 0]]}], "]"}]},
           {
            RowBox[{
             RowBox[{"f", "[", "x_", "]"}], "\[Rule]", 
             RowBox[{"Mod", "[", 
              RowBox[{
               SuperscriptBox["a", "x"], ",", "N"}], "]"}]}]},
           {
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               SuperscriptBox["a", "x"], ",", "N"}], "]"}], "\[Rule]", 
             RowBox[{"Mod", "[", 
              RowBox[{
               SuperscriptBox["a", 
                RowBox[{"r", "+", "x"}]], ",", "N"}], "]"}]}]},
           {
            StyleBox["\<\"Why?\"\>",
             StripOnInput->False,
             LineColor->RGBColor[1, 0, 0],
             FrontFaceColor->RGBColor[1, 0, 0],
             BackFaceColor->RGBColor[1, 0, 0],
             GraphicsColor->RGBColor[1, 0, 0],
             FontFamily->"Helvetica",
             FontColor->RGBColor[1, 0, 0]]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]},
       {
        RowBox[{"_If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_OddQ", "[", "r", "]"}], "}"}], "[", 
            StyleBox["\<\"r/2 not integer\"\>",
             StripOnInput->False,
             LineColor->RGBColor[1, 0.5, 0],
             FrontFaceColor->RGBColor[1, 0.5, 0],
             BackFaceColor->RGBColor[1, 0.5, 0],
             GraphicsColor->RGBColor[1, 0.5, 0],
             FontFamily->"Helvetica",
             FontColor->RGBColor[1, 0.5, 0]], "]"}], "||", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 SuperscriptBox["a", 
                  RowBox[{"r", "/", "2"}]], ",", "N"}], "]"}], "\[Rule]", 
               RowBox[{"-", "1"}]}], "}"}], "[", 
             StyleBox["\<\"isn't this >0 always\"\>",
              StripOnInput->False,
              LineColor->RGBColor[1, 0, 0],
              FrontFaceColor->RGBColor[1, 0, 0],
              BackFaceColor->RGBColor[1, 0, 0],
              GraphicsColor->RGBColor[1, 0, 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[1, 0, 0]], "]"}], "}"}]}], ",", 
          StyleBox["\<\"Choose another a\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]]}], "]"}]},
       {
        RowBox[{"_Else", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GCD", "[", 
             RowBox[{
              RowBox[{"1", "+", 
               SuperscriptBox["a", 
                RowBox[{"r", "/", "2"}]]}], ",", "N"}], "]"}], "||", 
            RowBox[{"GCD", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["a", 
                RowBox[{"r", "/", "2"}]]}], ",", "N"}], "]"}]}], "}"}], "[", 
          StyleBox["\<\"is factor of N: DONE\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "]"}]}],
  SequenceForm[
   Style["Shor's algorithm, which finds the prime factors of an integer N, \
consists of a classical part and a quantum part. ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] The classical part reduces the factoring problem to the \
problem of group-order-finding.", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Given N, ", 
    RGBColor[0.7, 0, 1, 1], Larger], 1 < $CellContext`a[
     Style["choose a random number", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]] < N, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Blank[If][GCD[$CellContext`a, N] != 1], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   $CellContext`a[
    Style["factor of N, DONE", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["and test for Power[j,k]\[Rule]N, j\[NotEqual]a ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Blank[If][{
     Element[N^($CellContext`k^(-1)), $CellContext`\[DoubleStruckCapitalZ]], 
     2 <= $CellContext`k <= Log[3]^(-1) Log[N]}], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {
    Exists[$CellContext`j, 
     Element[$CellContext`j, $CellContext`\[DoubleStruckCapitalZ]], \
$CellContext`j^$CellContext`k -> N], 
    Style["DONE", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Blank[$CellContext`Else][
    Grid[{{
       Style["Assume N is a product of two coprimes {a,n}, ", 
        RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]}, {
       Style[
        {
         DoubleLeftRightArrow[
          
          SuchThat[{$CellContext`a, $CellContext`n}, {$CellContext`a \
$CellContext`n -> N, GCD[$CellContext`a, $CellContext`n] -> 1}], 
          Mod[$CellContext`a^EulerPhi[$CellContext`n], $CellContext`n] -> 1]}[
        
         Style["Euler's theorem", 
          RGBColor[0, 
           Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
        RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]}, {
       Style["Use quantum period-finding to find smallest period r", 
        RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]}, {
       Grid[{{
          $CellContext`r[
           Style["the smallest period of", 
            RGBColor[0, 
             Rational[2, 3], 0], FontFamily -> "Helvetica"], 
           
           Style[$CellContext`f[$CellContext`x] -> \
$CellContext`f[$CellContext`r + $CellContext`x], 
            RGBColor[0, 
             Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {$CellContext`f[
            Pattern[$CellContext`x, 
             Blank[]]] -> Mod[$CellContext`a^$CellContext`x, N]}, {
         Mod[$CellContext`a^$CellContext`x, N] -> 
          Mod[$CellContext`a^($CellContext`r + $CellContext`x), N]}, {
          Style["Why?", 
           RGBColor[1, 0, 0], FontFamily -> "Helvetica"]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left]}, {
       Blank[If][
        Or[
         {
          Blank[OddQ][$CellContext`r]}[
          Style["r/2 not integer", 
           RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]], {
          {Mod[$CellContext`a^(Rational[1, 2] $CellContext`r), N] -> -1}[
           Style["isn't this >0 always", 
            RGBColor[1, 0, 0], FontFamily -> "Helvetica"]]}], 
        Style["Choose another a", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
       Blank[$CellContext`Else][
        {
         Or[
          GCD[1 + $CellContext`a^(Rational[1, 2] $CellContext`r), N], 
          GCD[-1 + $CellContext`a^(Rational[1, 2] $CellContext`r), N]]}[
         Style["is factor of N: DONE", 
          RGBColor[0, 
           Rational[2, 3], 0], FontFamily -> "Helvetica"]]]}}, 
     Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.789997813747369*^9, 3.789998840789239*^9, 3.789999744552882*^9, {
   3.789999795673786*^9, 3.789999849616982*^9}, 3.789999968539959*^9, 
   3.7900002842923517`*^9, 3.790000344282398*^9, 3.790000388164401*^9, 
   3.790000456608934*^9, 3.7900006538449287`*^9, 3.790614307084313*^9, 
   3.790690648410594*^9, 3.790690796439926*^9, 3.790784418424901*^9, 
   3.791053318980031*^9},ExpressionUUID->"4ffc75d4-e4f6-4676-b8a0-\
64191424b74a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<Euler's Theorem\>\"", ",", 
     RowBox[{"$0", "=", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"$else", ",", 
          RowBox[{"{", 
           RowBox[{"__", ",", 
            RowBox[{"CR", "[", "\"\<Why?\>\"", "]"}]}], "}"}]}], "]"}], "//", 
        "Flatten"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"EulerPhi", "[", "N", "]"}], "/", "r"}], "\[Rule]", "Integer"}], 
   ",", "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{
    RowBox[{"$", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"EulerPhi", "[", "N", "]"}]}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<In their example where \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "->", "15"}], ",", 
      RowBox[{"a", "\[Rule]", "7"}], ",", 
      RowBox[{"r", "\[Rule]", "4"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<The nontrivial factors of N: \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"GCD", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", 
        RowBox[{"r", "/", "2"}]], "+", 
       RowBox[{"pm", "[", "1", "]"}]}], ",", "N"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$", "/.", "pmDn"}], ",", 
      RowBox[{"$", "/.", "pmUp"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   "yield", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$", "=", 
      RowBox[{"$", "/.", "$s"}]}], "}"}], "[", 
    RowBox[{"CG", "[", "\"\<coprimes of N\>\"", "]"}], "]"}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{"$1", "=", 
    RowBox[{"EulerPhi", "[", "N", "]"}]}], ",", "\[IndentingNewLine]", 
   "yield", ",", 
   RowBox[{"$1", "/.", "$s"}], ",", 
   RowBox[{"CG", "[", "\"\< divisible by r\>\"", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"CR", "[", 
    RowBox[{"\"\< How is r determined? Period finding of \>\"", ",", 
     RowBox[{
      RowBox[{"$0", "//", 
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{
         RowBox[{"f", "[", "_", "]"}], ",", 
         RowBox[{"{", "Mod", "}"}]}], "]"}]}], "//", "First"}], ",", 
     "\"\< by \>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.790690619282997*^9, 3.790690654113905*^9}, {
   3.790690716219417*^9, 3.790690726423951*^9}, {3.790690760873228*^9, 
   3.790690844188919*^9}, {3.790692163328588*^9, 3.790692305843049*^9}, {
   3.790693157780735*^9, 3.790693568682983*^9}, {3.790693601783264*^9, 
   3.790693624909133*^9}, {3.790693817068178*^9, 3.790693869778575*^9}, {
   3.790693910051515*^9, 3.790694031391007*^9}, 3.790784388613509*^9, {
   3.7911208312202806`*^9, 3.791120889414424*^9}, {3.791121207617033*^9, 
   3.791121263990934*^9}, {3.791123626320672*^9, 
   3.791123627870962*^9}},ExpressionUUID->"0c43d2b4-cd3d-40ad-9fb8-\
dfbf938e0101"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Euler's Theorem\"\>", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
         StyleBox["\<\"the smallest period of\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], ",", 
         StyleBox[
          RowBox[{
           RowBox[{"f", "[", "x", "]"}], "\[Rule]", 
           RowBox[{"f", "[", 
            RowBox[{"r", "+", "x"}], "]"}]}],
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]}], "]"}], ",", 
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], "\[Rule]", 
        RowBox[{"Mod", "[", 
         RowBox[{
          SuperscriptBox["a", "x"], ",", "N"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          SuperscriptBox["a", "x"], ",", "N"}], "]"}], "\[Rule]", 
        RowBox[{"Mod", "[", 
         RowBox[{
          SuperscriptBox["a", 
           RowBox[{"r", "+", "x"}]], ",", "N"}], "]"}]}], ",", 
       StyleBox["\<\"Why?\"\>",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[1, 0, 0]]}], "}"}]}], "}"}], "\[InvisibleSpace]", 
   
   StyleBox["\<\"\\n\[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    FractionBox[
     RowBox[{"EulerPhi", "[", "N", "]"}], "r"], "\[Rule]", "Integer"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"Mod", "[", 
    RowBox[{
     SuperscriptBox["a", 
      RowBox[{"EulerPhi", "[", "N", "]"}]], ",", "N"}], "]"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"In their example where \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "\[Rule]", "15"}], ",", 
     RowBox[{"a", "\[Rule]", "7"}], ",", 
     RowBox[{"r", "\[Rule]", "4"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The nontrivial factors of N: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"GCD", "[", 
    RowBox[{"N", ",", 
     RowBox[{
      SuperscriptBox["a", 
       RowBox[{"r", "/", "2"}]], "+", 
      RowBox[{"\<\"\[PlusMinus]\"\>", "[", "1", "]"}]}]}], "]"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"GCD", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["a", 
         RowBox[{"r", "/", "2"}]]}], ",", "N"}], "]"}], ",", 
     RowBox[{"GCD", "[", 
      RowBox[{
       RowBox[{"1", "+", 
        SuperscriptBox["a", 
         RowBox[{"r", "/", "2"}]]}], ",", "N"}], "]"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], "}"}], "[", 
    StyleBox["\<\"coprimes of N\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0, 
       Rational[2, 3], 0],
     FrontFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     BackFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     GraphicsColor->RGBColor[0, 
       Rational[2, 3], 0],
     FontFamily->"Helvetica",
     FontColor->RGBColor[0, 
       Rational[2, 3], 0]], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"EulerPhi", "[", "N", "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", "8", "\[InvisibleSpace]", 
   StyleBox["\<\" divisible by r\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" How is r determined? Period finding of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"f", "[", "x_", "]"}], "\[Rule]", 
     RowBox[{"Mod", "[", 
      RowBox[{
       SuperscriptBox["a", "x"], ",", "N"}], "]"}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" by \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[{"Euler's Theorem", {
     $CellContext`r[
      Style["the smallest period of", 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"], 
      Style[$CellContext`f[$CellContext`x] -> $CellContext`f[$CellContext`r + \
$CellContext`x], 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"]], $CellContext`f[
       Pattern[$CellContext`x, 
        Blank[]]] -> Mod[$CellContext`a^$CellContext`x, N], 
     Mod[$CellContext`a^$CellContext`x, N] -> 
     Mod[$CellContext`a^($CellContext`r + $CellContext`x), N], 
     Style["Why?", 
      RGBColor[1, 0, 0], FontFamily -> "Helvetica"]}}, 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`r^(-1) EulerPhi[N] -> Integer, 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Mod[$CellContext`a^EulerPhi[N], N], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["In their example where ", 
    RGBColor[0.7, 0, 1, 1], Larger], {
   N -> 15, $CellContext`a -> 7, $CellContext`r -> 4}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The nontrivial factors of N: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   GCD[N, $CellContext`a^(Rational[1, 2] $CellContext`r) + "\[PlusMinus]"[1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {
    GCD[-1 + $CellContext`a^(Rational[1, 2] $CellContext`r), N], 
    GCD[1 + $CellContext`a^(Rational[1, 2] $CellContext`r), N]}, 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   {{3, 5}}[
    Style["coprimes of N", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   EulerPhi[N], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 8, 
   Style[" divisible by r", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style[" How is r determined? Period finding of ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[$CellContext`f[
      Pattern[$CellContext`x, 
       Blank[]]] -> Mod[$CellContext`a^$CellContext`x, N], 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[" by ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.790690654916606*^9, {3.790690779190236*^9, 3.790690844875936*^9}, {
   3.790692198337803*^9, 3.790692218212749*^9}, 3.790692316041686*^9, {
   3.790693201153357*^9, 3.790693222330393*^9}, 3.79069326663628*^9, {
   3.790693320541636*^9, 3.790693327197962*^9}, {3.790693360348261*^9, 
   3.79069342880037*^9}, {3.790693490242488*^9, 3.7906935195537786`*^9}, 
   3.790693569903892*^9, 3.7906936257291937`*^9, {3.790693853248089*^9, 
   3.790693870467667*^9}, {3.79069399969403*^9, 3.790694032131077*^9}, {
   3.7907843904464607`*^9, 3.790784418555883*^9}, 3.7910533191497507`*^9, 
   3.791120839386725*^9, {3.791120884497018*^9, 3.791120890091984*^9}, 
   3.791121265043868*^9, 
   3.791123628917577*^9},ExpressionUUID->"f473fe0e-5655-445a-9eb7-\
f04f3ca8deb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
   "\"\<Quantum part: period-finding for a choice of {N,a} and \>\"", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$else", "//", 
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{
         RowBox[{"f", "[", "x_", "]"}], ",", 
         RowBox[{"{", "Mod", "}"}]}], "]"}]}], "//", "First"}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<Problem: Find q \>\"", ",", 
    RowBox[{"$", "=", 
     RowBox[{"Exists", "[", 
      RowBox[{"q", ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["N", "2"], "\[LessEqual]", "Q", "<", 
         RowBox[{"2", 
          SuperscriptBox["N", "2"]}]}], "&&", 
        RowBox[{"(", 
         RowBox[{"Q", "\[Rule]", 
          SuperscriptBox["2", "q"]}], ")"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<Ex: \>\"", ",", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$", "/.", 
        RowBox[{"N", "\[Rule]", "15"}]}], "/.", "toEqual"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Resolve", "[", 
      RowBox[{"$", ",", 
       RowBox[{"{", "q", "}"}], ",", "Integers"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7785122848160686`*^9, 3.7785123199169073`*^9}, {
   3.778512358382599*^9, 3.778512449024086*^9}, {3.778512481836176*^9, 
   3.77851256259063*^9}, {3.778512612847131*^9, 3.778512630707241*^9}, {
   3.778512694010764*^9, 3.778512694502844*^9}, {3.778512775595838*^9, 
   3.7785127757851067`*^9}, {3.778512873143757*^9, 3.778512914995737*^9}, {
   3.778513085281824*^9, 3.778513157679598*^9}, 3.778763593166573*^9, {
   3.789657369283135*^9, 3.789657391916706*^9}, 3.7896596434493504`*^9, {
   3.789659700709127*^9, 3.7896597761209307`*^9}, 3.78975787742233*^9, {
   3.790785557354748*^9, 3.790785585441407*^9}, {3.790785632111589*^9, 
   3.790785645087281*^9}, {3.790785677292894*^9, 3.790785708775606*^9}, {
   3.7907857585029793`*^9, 3.790785793711972*^9}, 
   3.791123423134986*^9},ExpressionUUID->"897e70f1-286b-4796-93d2-\
1ea62e4b37c0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["\<\"Quantum part: period-finding for a choice of {N,a} and \
\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{
      RowBox[{"f", "[", "x_", "]"}], "\[Rule]", 
      RowBox[{"Mod", "[", 
       RowBox[{
        SuperscriptBox["a", "x"], ",", "N"}], "]"}]}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"Problem: Find q \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{
      SubscriptBox["\[Exists]", "q"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["N", "2"], "\[LessEqual]", "Q", "<", 
         RowBox[{"2", " ", 
          SuperscriptBox["N", "2"]}]}], "&&", 
        RowBox[{"(", 
         RowBox[{"Q", "\[Rule]", 
          SuperscriptBox["2", "q"]}], ")"}]}], ")"}]}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"Ex: \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", "q"}], "\[Element]", 
    TemplateBox[{},
     "Integers"]}], "&&", 
   RowBox[{"Q", "\[Equal]", "256"}]}],
  SequenceForm[
   Style["Quantum part: period-finding for a choice of {N,a} and ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`f[
     Pattern[$CellContext`x, 
      Blank[]]] -> Mod[$CellContext`a^$CellContext`x, N], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Problem: Find q ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Exists[$CellContext`q, 
    And[
     Inequality[N^2, LessEqual, $CellContext`Q, Less, 2 N^2], $CellContext`Q -> 
     2^$CellContext`q]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Ex: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   And[
    Element[$CellContext`q, Integers], $CellContext`Q == 256]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7907858149374647`*^9, 3.79105335861878*^9, 
  3.7911234456518307`*^9},ExpressionUUID->"300fcda4-87c9-4066-8aef-\
ce32560cf243"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{
    "URL", "[", 
     "\"\<https://en.wikipedia.org/wiki/Euler%27s_totient_function\>\"", 
     "]"}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\n\n\!\(\*StyleBox[\\\"Euler\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*\
StyleBox[\\\"'\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"s\\\",\
FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\" \\\",FontWeight->\\\"Bold\\\"]\
\)\!\(\*StyleBox[\\\"totient\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\
\" \\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"function\\\",FontWeight-\
>\\\"Bold\\\"]\)\!\(\*StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"\[CurlyPhi]\\\",FontWeight-\
>\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"[\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*\
StyleBox[\\\"n\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"]\\\",\
FontWeight->\\\"Bold\\\"]\) counts the positive integers up to an integer n \
that are relative prime to n, i.e.,\>\"", "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{"SuchThat", "[", 
      RowBox[{
       RowBox[{"_Length", "[", 
        RowBox[{"{", "i", "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"_GCD", "[", 
         RowBox[{"n", ",", "i"}], "]"}], "\[Rule]", 
        RowBox[{"1", "&&", 
         RowBox[{"1", "\[LessEqual]", "i", "<", "n"}]}]}]}], "]"}], "}"}], 
    ",", "  ", "NL", ",", "\"\<\[Bullet] Example: For\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$s", "=", 
       RowBox[{"n", "\[Rule]", "9"}]}], ",", 
      RowBox[{"$", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"GCD", "[", 
          RowBox[{"n", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"$", "=", 
       RowBox[{"$", "/.", "$s"}]}], ",", 
      RowBox[{
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{"\[CurlyPhi]", "[", "9", "]"}], "->", 
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"$", ",", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}], "]"}]}]}], ";", 
       RowBox[{"$", "//", "Framed"}]}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totient", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$", ",", "i", ",", "$s", ",", "nn"}], "}"}], ",", 
     RowBox[{
      RowBox[{"$s", "=", 
       RowBox[{"nn", "\[Rule]", "n"}]}], ";", 
      RowBox[{"$", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"GCD", "[", 
          RowBox[{"nn", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"nn", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"$", "=", 
       RowBox[{"$", "/.", "$s"}]}], ";", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"\[CurlyPhi]", "[", "nn", "]"}], "->", 
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"$", ",", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "/.", "$s"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Euler's product formula.\nMultiplication of totient[]'s \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "totient", "]"}], "[", 
       RowBox[{"5", "\[CenterDot]", "9"}], "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Inactive", "[", "totient", "]"}], "[", "5", "]"}], ",", 
        RowBox[{
         RowBox[{"Inactive", "[", "totient", "]"}], "[", "9", "]"}]}], 
       "}"}]}], "/.", "toTimes"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "//", "Activate"}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Look at Mathematica's EulerPhi[] as built in totient[].\>\"", ",", 
   "NL", ",", 
   "\"\<\[Bullet] Verify Euler's product formula by comparing with \
EulerPhi[].\>\"", ",", "NL", ",", "\[IndentingNewLine]", 
   "\"\<\[Bullet] For: \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"n", "\[Rule]", "19"}]}], ",", "imply", ",", 
   RowBox[{"$", "=", 
    RowBox[{"EulerPhi", "[", "n", "]"}]}], ",", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", "$s"}]}], ",", "NL", ",", "\[IndentingNewLine]", 
   "\"\<\[Bullet] Compare with \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"Inactivate", "[", 
     RowBox[{"n", " ", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"1", "/", "p"}]}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", 
          RowBox[{"First", "/@", 
           RowBox[{"FactorInteger", "[", "n", "]"}]}]}], "}"}]}], " ", 
       "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "/.", "$s"}], "//", "Activate"}]}]}], "\[IndentingNewLine]",
   "]"}], "\n", 
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<\!\(\*StyleBox[\\\"Euler\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\
\\\"'\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"s\\\",FontWeight->\\\"\
Bold\\\"]\)\!\(\*StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\)\!\(\*StyleBox[\\\"theorem\\\",FontWeight->\\\
\"Bold\\\"]\)\!\(\*StyleBox[\\\".\\\",FontWeight->\\\"Bold\\\"]\) If n and a \
are coprime positive integers\>\"", ",", "\[IndentingNewLine]", "imply", ",", 
   
   RowBox[{"$0", "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        SuperscriptBox["a", 
         RowBox[{"EulerPhi", "[", "n", "]"}]], ",", "n"}], "]"}], "\[Rule]", 
      "1"}]}]}], ",", "\[IndentingNewLine]", "NL", ",", "\"\<Examples: \>\"", 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$t", "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"n", ",", "a", ",", 
         RowBox[{"GCD", "[", 
          RowBox[{"a", ",", "n"}], "]"}], ",", 
         RowBox[{"$0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"EulerPhi", "[", "n", "]"}]}], "}"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{"$", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "15", ",", "21", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "n", ",", "1"}], "}"}]}], " ", "]"}],
           "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", 
         "\[IndentingNewLine]", "$t"}], "\[IndentingNewLine]", "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}]}]}],
   "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7785122848160686`*^9, 3.7785123199169073`*^9}, {
   3.778512358382599*^9, 3.778512449024086*^9}, {3.778512481836176*^9, 
   3.77851256259063*^9}, {3.778512612847131*^9, 3.778512630707241*^9}, {
   3.778512694010764*^9, 3.778512694502844*^9}, {3.778512775595838*^9, 
   3.7785127757851067`*^9}, {3.778512873143757*^9, 3.778512914995737*^9}, {
   3.778513085281824*^9, 3.778513157679598*^9}, 3.778763593166573*^9, {
   3.789657369283135*^9, 3.789657391916706*^9}, 3.7896596434493504`*^9, {
   3.789659700709127*^9, 3.7896597761209307`*^9}, 3.78975787742233*^9, {
   3.789758039040227*^9, 3.7897580466641006`*^9}, {3.789758808760581*^9, 
   3.789758853780271*^9}, {3.789758897309019*^9, 3.78975899471607*^9}, {
   3.789759027161302*^9, 3.789759048177034*^9}, {3.789759090170806*^9, 
   3.7897591287484903`*^9}, {3.789759172888494*^9, 3.789759340641288*^9}, {
   3.789759392431149*^9, 3.789759511180682*^9}, {3.789759544972019*^9, 
   3.789759545202911*^9}, {3.789759575461773*^9, 3.789759602035366*^9}, {
   3.7897599948939667`*^9, 3.789760001626402*^9}, {3.789760101370453*^9, 
   3.78976021130814*^9}, {3.789760262688974*^9, 3.789760457905581*^9}, {
   3.789760871196643*^9, 3.7897608740020523`*^9}, {3.789760909734076*^9, 
   3.789761204824136*^9}, {3.789761295324601*^9, 3.7897613545846443`*^9}, {
   3.789761423860094*^9, 3.789761463816181*^9}, {3.789761970094746*^9, 
   3.789762059388225*^9}, {3.789762598422871*^9, 3.789762635043981*^9}, {
   3.7897835121232986`*^9, 3.789783522603592*^9}, {3.789784612915262*^9, 
   3.789784917632695*^9}, {3.7897849529141808`*^9, 3.7897849986283216`*^9}, {
   3.7897850310543003`*^9, 3.789785046060981*^9}, {3.789785092698483*^9, 
   3.7897850933060293`*^9}, {3.789786273661522*^9, 3.7897862765167923`*^9}, {
   3.7898242449906607`*^9, 3.7898243989700003`*^9}, {3.789826619636804*^9, 
   3.789826647552298*^9}, {3.7898266985165863`*^9, 3.789826698692277*^9}, {
   3.789826732643528*^9, 3.789826734994138*^9}, 3.790689503794874*^9, {
   3.7906898844060917`*^9, 3.790689889297126*^9}, {3.790690306103677*^9, 
   3.7906903503558693`*^9}, {3.790691946897298*^9, 3.790691981362981*^9}, 
   3.790692023525949*^9, {3.790692476522626*^9, 3.790692479215724*^9}, 
   3.7910532712123003`*^9, {3.7911218947653*^9, 3.791121918186843*^9}, 
   3.791122040585774*^9, {3.791122080044368*^9, 3.7911220985204773`*^9}, {
   3.7911221449031982`*^9, 3.791122231512225*^9}, 3.791122368941062*^9, {
   3.791123053439948*^9, 3.791123061837349*^9}, {3.79112853551689*^9, 
   3.7911285517678833`*^9}},ExpressionUUID->"3905ba1f-85bd-4909-aeef-\
42936ce6c7a8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"URL", "[", 
    TemplateBox[{
     "\"https://en.wikipedia.org/wiki/Euler%27s_totient_function\""},
     "URLArgument"], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\\n\\!\\(\\*StyleBox[\\\"Euler\\\",FontWeight->\\\"Bold\\\
\"]\\)\\!\\(\\*StyleBox[\\\"'\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*\
StyleBox[\\\"s\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"totient\\\",FontWeight-\
>\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"function\\\",\
FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"\[CurlyPhi]\\\",\
FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"[\\\",FontWeight->\\\"Bold\\\
\"]\\)\\!\\(\\*StyleBox[\\\"n\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*\
StyleBox[\\\"]\\\",FontWeight->\\\"Bold\\\"]\\) counts the positive integers \
up to an integer n that are relative prime to n, i.e.,\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_Length", "[", 
      RowBox[{"{", "i", "}"}], "]"}], "\[SuchThat]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_GCD", "[", 
        RowBox[{"n", ",", "i"}], "]"}], "\[Rule]", 
       RowBox[{"1", "&&", 
        RowBox[{"1", "\[LessEqual]", "i", "<", "n"}]}]}], ")"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Example: For\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "9"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"GCD", "[", 
        RowBox[{"n", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "3", ",", "1", ",", "1", ",", "3", ",", "1", ",", 
       "1"}], "}"}], ",", 
     FrameBox[
      RowBox[{
       RowBox[{"\[CurlyPhi]", "[", "9", "]"}], "\[Rule]", "6"}],
      StripOnInput->False]}], "}"}]}],
  SequenceForm[
   URL["https://en.wikipedia.org/wiki/Euler%27s_totient_function"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\n\!\(\*StyleBox[\"Euler\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\
\"'\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"s\",FontWeight->\"Bold\"]\)\!\(\
\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"totient\",FontWeight->\"Bold\"]\)\!\
\(\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"function\",FontWeight->\"Bold\"]\)\
\!\(\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"\[CurlyPhi]\",FontWeight->\"Bold\"]\
\)\!\(\*StyleBox[\"[\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"n\",FontWeight-\
>\"Bold\"]\)\!\(\*StyleBox[\"]\",FontWeight->\"Bold\"]\) counts the positive \
integers up to an integer n that are relative prime to n, i.e.,", 
    RGBColor[0.7, 0, 1, 1], Larger], {
    SuchThat[
     Blank[Length][{$CellContext`i}], 
     Blank[GCD][$CellContext`n, $CellContext`i] -> And[1, 
       Inequality[1, LessEqual, $CellContext`i, Less, $CellContext`n]]]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Example: For", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`n -> 9, 
    Table[
     GCD[$CellContext`n, $CellContext`i], {$CellContext`i, -1 + \
$CellContext`n}], {1, 1, 3, 1, 1, 3, 1, 1}, 
    Framed[$CellContext`\[CurlyPhi][9] -> 6]}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7906294452583647`*^9, {3.790629505258873*^9, 3.790629549836474*^9}, 
   3.7906296121637278`*^9, {3.790630059948525*^9, 3.790630064085409*^9}, 
   3.790686740557691*^9, {3.790686795171245*^9, 3.7906868218584423`*^9}, 
   3.790686990299015*^9, 3.790687069332597*^9, {3.7906876652014914`*^9, 
   3.790687678179985*^9}, {3.790687818897108*^9, 3.7906878404155703`*^9}, {
   3.7906879056996307`*^9, 3.790687934339264*^9}, 3.790688083664466*^9, {
   3.7906881175831337`*^9, 3.7906881427816257`*^9}, {3.790688257611537*^9, 
   3.790688300218182*^9}, 3.7906883536160707`*^9, {3.7906883934332867`*^9, 
   3.7906884173508787`*^9}, {3.7906885320273743`*^9, 
   3.7906885509033833`*^9}, {3.790688591171176*^9, 3.790688626047544*^9}, 
   3.790688661233506*^9, {3.790688710906641*^9, 3.790688723297798*^9}, 
   3.790688774325941*^9, {3.790689393794426*^9, 3.790689417286689*^9}, 
   3.790689505353958*^9, 3.790690351318782*^9, 3.79069198291179*^9, 
   3.79069202490798*^9, 3.790692480050696*^9, 3.790784442631371*^9, 
   3.791053359301627*^9, 3.791121919189217*^9, 3.7911220414389763`*^9, 
   3.791122085944631*^9, {3.791122156065762*^9, 3.791122220194941*^9}, 
   3.7911223715346518`*^9, 3.791123064118957*^9, 
   3.79112855433603*^9},ExpressionUUID->"7df1efef-b67b-4c44-b835-\
606bb269a2d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Euler's product formula.\\nMultiplication of totient[]'s \
\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     TemplateBox[{"totient"},
      "InactiveHead",
      BaseStyle->"Inactive",
      SyntaxForm->"Symbol",
      Tooltip->"Inactive[totient]"], "[", "45", "]"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TemplateBox[{"totient"},
        "InactiveHead",
        BaseStyle->"Inactive",
        SyntaxForm->"Symbol",
        Tooltip->"Inactive[totient]"], "[", "5", "]"}], ",", 
      RowBox[{
       TemplateBox[{"totient"},
        "InactiveHead",
        BaseStyle->"Inactive",
        SyntaxForm->"Symbol",
        Tooltip->"Inactive[totient]"], "[", "9", "]"}]}], "}"}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CurlyPhi]", "[", "45", "]"}], "\[Rule]", "24"}], ")"}], 
    "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CurlyPhi]", "[", "5", "]"}], "\[Rule]", "4"}], ",", 
      RowBox[{
       RowBox[{"\[CurlyPhi]", "[", "9", "]"}], "\[Rule]", "6"}]}], "}"}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Look at Mathematica's EulerPhi[] as built in totient[].\"\>",
    
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Verify Euler's product formula by comparing with \
EulerPhi[].\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] For: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "19"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"EulerPhi", "[", "n", "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", "18", "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Compare with \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", "n", 
   TagBox["*",
    "InactiveToken",
    BaseStyle->"Inactive",
    SyntaxForm->"*"], 
   TemplateBox[{RowBox[{"(", 
       RowBox[{"1", 
         TagBox[
         "+", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> "+"], 
         RowBox[{
           RowBox[{"-", "1"}], 
           TagBox[
           "*", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> "*"], 
           
           RowBox[{"(", 
             RowBox[{"1", 
               TagBox[
               "*", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
                "*"], 
               RowBox[{"p", 
                 TagBox[
                 "^", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
                  "^"], 
                 RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], ")"}],"p",
     RowBox[{"First", 
       TagBox[
       "/@", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> "/@"], 
       RowBox[{
         TemplateBox[{"FactorInteger"}, "InactiveHead", BaseStyle -> 
          "Inactive", Tooltip -> "Inactive[FactorInteger]", SyntaxForm -> 
          "Symbol"], "[", "n", "]"}]}]},
    "InactiveProduct",
    DisplayFunction->(RowBox[{
       UnderoverscriptBox[
        StyleBox["\[Product]", "Inactive"], #2, #3], #}]& ),
    InterpretationFunction->(RowBox[{
       RowBox[{"Inactive", "[", "Product", "]"}], "[", 
       RowBox[{#, ",", 
         RowBox[{"{", 
           RowBox[{#2, ",", #3}], "}"}]}], "]"}]& )], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", "18"}],
  SequenceForm[
   Style["Euler's product formula.\nMultiplication of totient[]'s ", 
    RGBColor[0.7, 0, 1, 1], Larger], Inactive[$CellContext`totient][45] -> {
     Inactive[$CellContext`totient][5], 
     Inactive[$CellContext`totient][9]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], ($CellContext`\[CurlyPhi][45] -> 
    24) -> {$CellContext`\[CurlyPhi][5] -> 4, $CellContext`\[CurlyPhi][9] -> 
     6}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Look at Mathematica's EulerPhi[] as built in totient[].", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Verify Euler's product formula by comparing with \
EulerPhi[].", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] For: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 19, 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   EulerPhi[$CellContext`n], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 18, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Compare with ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Inactive[Times][$CellContext`n, 
    Inactive[Product][
     Inactive[Plus][1, 
      Inactive[Times][-1, 
       Inactive[Times][1, 
        Inactive[Power][$CellContext`p, -1]]]], {$CellContext`p, 
      Inactive[Map][First, 
       Inactive[FactorInteger][$CellContext`n]]}]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 18],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7906294452583647`*^9, {3.790629505258873*^9, 3.790629549836474*^9}, 
   3.7906296121637278`*^9, {3.790630059948525*^9, 3.790630064085409*^9}, 
   3.790686740557691*^9, {3.790686795171245*^9, 3.7906868218584423`*^9}, 
   3.790686990299015*^9, 3.790687069332597*^9, {3.7906876652014914`*^9, 
   3.790687678179985*^9}, {3.790687818897108*^9, 3.7906878404155703`*^9}, {
   3.7906879056996307`*^9, 3.790687934339264*^9}, 3.790688083664466*^9, {
   3.7906881175831337`*^9, 3.7906881427816257`*^9}, {3.790688257611537*^9, 
   3.790688300218182*^9}, 3.7906883536160707`*^9, {3.7906883934332867`*^9, 
   3.7906884173508787`*^9}, {3.7906885320273743`*^9, 
   3.7906885509033833`*^9}, {3.790688591171176*^9, 3.790688626047544*^9}, 
   3.790688661233506*^9, {3.790688710906641*^9, 3.790688723297798*^9}, 
   3.790688774325941*^9, {3.790689393794426*^9, 3.790689417286689*^9}, 
   3.790689505353958*^9, 3.790690351318782*^9, 3.79069198291179*^9, 
   3.79069202490798*^9, 3.790692480050696*^9, 3.790784442631371*^9, 
   3.791053359301627*^9, 3.791121919189217*^9, 3.7911220414389763`*^9, 
   3.791122085944631*^9, {3.791122156065762*^9, 3.791122220194941*^9}, 
   3.7911223715346518`*^9, 3.791123064118957*^9, 
   3.7911285546251593`*^9},ExpressionUUID->"a05483df-1595-435c-a792-\
2882a4e6a5d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\!\\(\\*StyleBox[\\\"Euler\\\",FontWeight->\\\"Bold\\\"]\\)\
\\!\\(\\*StyleBox[\\\"'\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"\
s\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"theorem\\\",FontWeight-\
>\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\".\\\",FontWeight->\\\"Bold\\\"]\\) If \
n and a are coprime positive integers\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      SuperscriptBox["a", 
       RowBox[{"EulerPhi", "[", "n", "]"}]], ",", "n"}], "]"}], "\[Rule]", 
    "1"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Examples: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {"n", "a", 
       RowBox[{"GCD", "[", 
        RowBox[{"a", ",", "n"}], "]"}], 
       RowBox[{"Mod", "[", 
        RowBox[{
         SuperscriptBox["a", 
          RowBox[{"EulerPhi", "[", "n", "]"}]], ",", "n"}], "]"}], 
       RowBox[{"EulerPhi", "[", "n", "]"}]},
      {"15", "1", "1", "1", "8"},
      {"15", "2", "1", "1", "8"},
      {"15", "3", "3", "6", "8"},
      {"15", "4", "1", "1", "8"},
      {"15", "5", "5", "10", "8"},
      {"15", "6", "3", "6", "8"},
      {"15", "7", "1", "1", "8"},
      {"15", "8", "1", "1", "8"},
      {"15", "9", "3", "6", "8"},
      {"15", "10", "5", "10", "8"},
      {"15", "11", "1", "1", "8"},
      {"15", "12", "3", "6", "8"},
      {"15", "13", "1", "1", "8"},
      {"15", "14", "1", "1", "8"},
      {"15", "15", "15", "0", "8"},
      {"21", "1", "1", "1", "12"},
      {"21", "2", "1", "1", "12"},
      {"21", "3", "3", "15", "12"},
      {"21", "4", "1", "1", "12"},
      {"21", "5", "1", "1", "12"},
      {"21", "6", "3", "15", "12"},
      {"21", "7", "7", "7", "12"},
      {"21", "8", "1", "1", "12"},
      {"21", "9", "3", "15", "12"},
      {"21", "10", "1", "1", "12"},
      {"21", "11", "1", "1", "12"},
      {"21", "12", "3", "15", "12"},
      {"21", "13", "1", "1", "12"},
      {"21", "14", "7", "7", "12"},
      {"21", "15", "3", "15", "12"},
      {"21", "16", "1", "1", "12"},
      {"21", "17", "1", "1", "12"},
      {"21", "18", "3", "15", "12"},
      {"21", "19", "1", "1", "12"},
      {"21", "20", "1", "1", "12"},
      {"21", "21", "21", "0", "12"}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["\!\(\*StyleBox[\"Euler\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"'\"\
,FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"s\",FontWeight->\"Bold\"]\)\!\(\*\
StyleBox[\" \",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"theorem\",FontWeight->\
\"Bold\"]\)\!\(\*StyleBox[\".\",FontWeight->\"Bold\"]\) If n and a are \
coprime positive integers", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Mod[$CellContext`a^EulerPhi[$CellContext`n], $CellContext`n] -> 1, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Examples: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`n, $CellContext`a, 
      GCD[$CellContext`a, $CellContext`n], 
      Mod[$CellContext`a^EulerPhi[$CellContext`n], $CellContext`n], 
      EulerPhi[$CellContext`n]}, {15, 1, 1, 1, 8}, {15, 2, 1, 1, 8}, {15, 3, 
     3, 6, 8}, {15, 4, 1, 1, 8}, {15, 5, 5, 10, 8}, {15, 6, 3, 6, 8}, {15, 7, 
     1, 1, 8}, {15, 8, 1, 1, 8}, {15, 9, 3, 6, 8}, {15, 10, 5, 10, 8}, {15, 
     11, 1, 1, 8}, {15, 12, 3, 6, 8}, {15, 13, 1, 1, 8}, {15, 14, 1, 1, 8}, {
     15, 15, 15, 0, 8}, {21, 1, 1, 1, 12}, {21, 2, 1, 1, 12}, {21, 3, 3, 15, 
     12}, {21, 4, 1, 1, 12}, {21, 5, 1, 1, 12}, {21, 6, 3, 15, 12}, {21, 7, 7,
      7, 12}, {21, 8, 1, 1, 12}, {21, 9, 3, 15, 12}, {21, 10, 1, 1, 12}, {21, 
     11, 1, 1, 12}, {21, 12, 3, 15, 12}, {21, 13, 1, 1, 12}, {21, 14, 7, 7, 
     12}, {21, 15, 3, 15, 12}, {21, 16, 1, 1, 12}, {21, 17, 1, 1, 12}, {21, 
     18, 3, 15, 12}, {21, 19, 1, 1, 12}, {21, 20, 1, 1, 12}, {21, 21, 21, 0, 
     12}}, Frame -> All]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7906294452583647`*^9, {3.790629505258873*^9, 3.790629549836474*^9}, 
   3.7906296121637278`*^9, {3.790630059948525*^9, 3.790630064085409*^9}, 
   3.790686740557691*^9, {3.790686795171245*^9, 3.7906868218584423`*^9}, 
   3.790686990299015*^9, 3.790687069332597*^9, {3.7906876652014914`*^9, 
   3.790687678179985*^9}, {3.790687818897108*^9, 3.7906878404155703`*^9}, {
   3.7906879056996307`*^9, 3.790687934339264*^9}, 3.790688083664466*^9, {
   3.7906881175831337`*^9, 3.7906881427816257`*^9}, {3.790688257611537*^9, 
   3.790688300218182*^9}, 3.7906883536160707`*^9, {3.7906883934332867`*^9, 
   3.7906884173508787`*^9}, {3.7906885320273743`*^9, 
   3.7906885509033833`*^9}, {3.790688591171176*^9, 3.790688626047544*^9}, 
   3.790688661233506*^9, {3.790688710906641*^9, 3.790688723297798*^9}, 
   3.790688774325941*^9, {3.790689393794426*^9, 3.790689417286689*^9}, 
   3.790689505353958*^9, 3.790690351318782*^9, 3.79069198291179*^9, 
   3.79069202490798*^9, 3.790692480050696*^9, 3.790784442631371*^9, 
   3.791053359301627*^9, 3.791121919189217*^9, 3.7911220414389763`*^9, 
   3.791122085944631*^9, {3.791122156065762*^9, 3.791122220194941*^9}, 
   3.7911223715346518`*^9, 3.791123064118957*^9, 
   3.7911285546437817`*^9},ExpressionUUID->"9c9216d5-c858-4cc4-828c-\
c59aec5caaa8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Explore periodic nature of \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       SuperscriptBox["a", "x"], ",", "N"}], "]"}], "\[Rule]", "1"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"a", ",", "N", ",", "$"}], "}"}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<For \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "\[Rule]", "21"}], ",", 
      RowBox[{"a", "\[Rule]", "10"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "/.", "$s"}], "//", "First"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{"x", ",", "$"}], "}"}]}], ";", "\[IndentingNewLine]", "Yield"}],
    ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"$t", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"$", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "N"}], "}"}]}], "]"}], "/.", "$s"}]}], ")"}], "//", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"#", ",", "$"}], "]"}], "&"}]}]}], ";", "\[IndentingNewLine]",
     "Yield"}], ",", 
   RowBox[{"$", "//", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "&"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$t", "=", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"$t", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "<", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "//", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "&"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.791123033033491*^9, 3.791123039100211*^9}, {
  3.791128610505488*^9, 3.7911287002157097`*^9}, {3.791128742562591*^9, 
  3.7911287962911453`*^9}, {3.7911288543108253`*^9, 3.791128870107952*^9}, {
  3.791130081397943*^9, 3.791130149679195*^9}, {3.7911302145757027`*^9, 
  3.791130260709908*^9}, {3.791130299146061*^9, 3.791130354062441*^9}, {
  3.7911304599690866`*^9, 3.7911304908157883`*^9}, {3.7911305216042957`*^9, 
  3.791130545724633*^9}, {3.791133106991996*^9, 3.791133108042283*^9}, {
  3.791133159268036*^9, 3.79113317269058*^9}, {3.791133208074732*^9, 
  3.791133219313944*^9}, {3.791133513492556*^9, 3.791133564827688*^9}, {
  3.791133596749981*^9, 3.791133598287332*^9}, {3.7911336367860126`*^9, 
  3.791133645179509*^9}},ExpressionUUID->"cb71767b-c770-4419-a52b-\
0a602b9c7cfe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Explore periodic nature of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      SuperscriptBox["a", "x"], ",", "N"}], "]"}], "\[Rule]", "1"}], 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"a", ",", "N", ",", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        SuperscriptBox["a", "x"], ",", "N"}], "]"}], "\[Rule]", "1"}]}], 
    "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"For \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "\[Rule]", "21"}], ",", 
     RowBox[{"a", "\[Rule]", "10"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"Mod", "[", 
    RowBox[{
     SuperscriptBox["10", "x"], ",", "21"}], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {"x", 
       RowBox[{"Mod", "[", 
        RowBox[{
         SuperscriptBox["10", "x"], ",", "21"}], "]"}]},
      {"1", "10"},
      {"2", "16"},
      {"3", "13"},
      {"4", "4"},
      {"5", "19"},
      {"6", "1"},
      {"7", "10"},
      {"8", "16"},
      {"9", "13"},
      {"10", "4"},
      {"11", "19"},
      {"12", "1"},
      {"13", "10"},
      {"14", "16"},
      {"15", "13"},
      {"16", "4"},
      {"17", "19"},
      {"18", "1"},
      {"19", "10"},
      {"20", "16"},
      {"21", "13"}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {"18", "1"},
      {"12", "1"},
      {"6", "1"},
      {"16", "4"},
      {"10", "4"},
      {"4", "4"},
      {"19", "10"},
      {"13", "10"},
      {"7", "10"},
      {"1", "10"},
      {"21", "13"},
      {"15", "13"},
      {"9", "13"},
      {"3", "13"},
      {"20", "16"},
      {"14", "16"},
      {"8", "16"},
      {"2", "16"},
      {"17", "19"},
      {"11", "19"},
      {"5", "19"}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Explore periodic nature of ", 
    RGBColor[0.7, 0, 1, 1], Larger], Mod[$CellContext`a^$CellContext`x, N] -> 
   1, {$CellContext`a, N, Mod[$CellContext`a^$CellContext`x, N] -> 1}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["For ", 
    RGBColor[0.7, 0, 1, 1], Larger], {N -> 21, $CellContext`a -> 10}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Mod[10^$CellContext`x, 21], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{$CellContext`x, 
      Mod[10^$CellContext`x, 21]}, {1, 10}, {2, 16}, {3, 13}, {4, 4}, {5, 
     19}, {6, 1}, {7, 10}, {8, 16}, {9, 13}, {10, 4}, {11, 19}, {12, 1}, {13, 
     10}, {14, 16}, {15, 13}, {16, 4}, {17, 19}, {18, 1}, {19, 10}, {20, 
     16}, {21, 13}}, Frame -> All], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{18, 1}, {12, 1}, {6, 1}, {16, 4}, {10, 4}, {4, 4}, {19, 10}, {13, 
    10}, {7, 10}, {1, 10}, {21, 13}, {15, 13}, {9, 13}, {3, 13}, {20, 16}, {
    14, 16}, {8, 16}, {2, 16}, {17, 19}, {11, 19}, {5, 19}}, Frame -> All]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.791128735071227*^9, {3.791128786096775*^9, 3.7911287987251997`*^9}, 
   3.7911288706901503`*^9, 3.7911300835915117`*^9, {3.791130128155077*^9, 
   3.791130150369852*^9}, {3.791130287354403*^9, 3.791130354954214*^9}, {
   3.791130467303211*^9, 3.791130491517428*^9}, {3.79113052856223*^9, 
   3.791130546608704*^9}, 3.791133109055168*^9, {3.791133165590467*^9, 
   3.7911331736506*^9}, {3.791133209962555*^9, 3.791133220474633*^9}, 
   3.7911335235492983`*^9, 3.791133601504779*^9, 
   3.7911336464837227`*^9},ExpressionUUID->"f4de3193-5458-4a9b-9bcf-\
f70be8a5c61a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
   "\"\<\!\(\*StyleBox[\"Fourier\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"Transform\",FontWeight->\"Bold\"]\)\
\!\(\*StyleBox[\".\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"  \
\",FontWeight->\"Bold\"]\) The totient[n](EulerPhi[n]) is the discrete \
Fourier transform of GCD[{k}].\>\"", ",", "NL", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"$s", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"\[ScriptCapitalF]", "[", 
                SubscriptBox["x", "k"], "]"}], "[", "m_", "]"}], "\[Rule]", 
              RowBox[{"xSum", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["x", "k"], "\[CenterDot]", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "2"}], "\[Pi]", " ", "I", " ", "m", " ", 
                   RowBox[{"k", "/", "n"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], "}"}], "[", 
            RowBox[{"CG", "[", "\"\<Fourier transform\>\"", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "k"], "\[Rule]", 
              RowBox[{"GCD", "[", 
               RowBox[{"k", ",", "n"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "n"}], "}"}]}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"$phi", "=", 
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{"EulerPhi", "[", "n", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"$", "=", 
               RowBox[{
                RowBox[{"\[ScriptCapitalF]", "[", 
                 SubscriptBox["x", "k"], "]"}], "[", 
                RowBox[{"1", "[", 
                 RowBox[{"CG", "[", "\"\<evaluation point\>\"", "]"}], "]"}], 
                "]"}]}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"$", "//.", 
               RowBox[{"tuRule", "[", "$s", "]"}]}], ")"}]}]}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
        "URL", "[", 
         "\"\<https://en.wikipedia.org/wiki/Euler%27s_totient_function#\
CITEREFSchramm2008\>\"", "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] Verify this relationship for a few small n: \>\"", ",", 
    "NL", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\"\<\[Bullet] For: \>\"", ",", 
    RowBox[{"$n", "=", 
     RowBox[{"n", "\[Rule]", "9"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$phi", "//", 
        RowBox[{"tuRuleSelect", "[", 
         RowBox[{
          RowBox[{"EulerPhi", "[", "n", "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "\[ScriptCapitalF]", "}"}]}], "]"}]}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", "imply"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"$", "/.", "$n"}], "/.", 
        RowBox[{"xSum", "\[Rule]", "Sum"}]}], "//.", "toTimes"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//", "ExpToTrig"}], "//", "TrigExpand"}], "//", 
      "FullSimplify"}]}], ",", "NL", ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\"\<\[Bullet] For: \>\"", ",", 
    RowBox[{"$n", "=", 
     RowBox[{"n", "\[Rule]", "55"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$phi", "//", 
        RowBox[{"tuRuleSelect", "[", 
         RowBox[{
          RowBox[{"EulerPhi", "[", "n", "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "\[ScriptCapitalF]", "}"}]}], "]"}]}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", "imply"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"$", "/.", "$n"}], "/.", 
        RowBox[{"xSum", "\[Rule]", "Sum"}]}], "//.", "toTimes"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//", "ExpToTrig"}], "//", "TrigExpand"}], "//", 
      "FullSimplify"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7898255223782177`*^9, 3.789825616148285*^9}, {
   3.7898260331754417`*^9, 3.789826160675705*^9}, {3.789826215137748*^9, 
   3.789826220972724*^9}, {3.789826559257597*^9, 3.7898265646639357`*^9}, {
   3.7898269360399237`*^9, 3.789826966311161*^9}, {3.789827091059944*^9, 
   3.7898271089605503`*^9}, {3.7898271929193687`*^9, 
   3.7898272034647093`*^9}, {3.789827457428746*^9, 3.7898275912474623`*^9}, {
   3.789827689507133*^9, 3.789827725581614*^9}, {3.789827765650593*^9, 
   3.789827893949025*^9}, 3.789827932449065*^9, {3.789828318509008*^9, 
   3.7898283320420237`*^9}, {3.7898283627972527`*^9, 3.789828421521875*^9}, {
   3.789828485959626*^9, 3.789828538188126*^9}, {3.789852562580759*^9, 
   3.789852573940475*^9}, {3.789906885687148*^9, 3.789907012729265*^9}, {
   3.7899070564107647`*^9, 3.789907114972226*^9}, {3.7899071938150253`*^9, 
   3.7899075561874037`*^9}, {3.7899090916462593`*^9, 3.78990910605399*^9}, {
   3.789995581395463*^9, 3.789995594932891*^9}, {3.789996957766493*^9, 
   3.789996980877666*^9}},ExpressionUUID->"a0fce8e3-8d97-4710-8a6e-\
8f290e4bc1fc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\!\\(\\*StyleBox[\\\"Fourier\\\",FontWeight->\\\"Bold\\\"]\\\
)\\!\\(\\*StyleBox[\\\" \\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\
\"Transform\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\".\\\",\
FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*StyleBox[\\\"  \\\",FontWeight->\\\"Bold\
\\\"]\\) The totient[n](EulerPhi[n]) is the discrete Fourier transform of \
GCD[{k}].\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"\[ScriptCapitalF]", "[", 
                SubscriptBox["x", "k"], "]"}], "[", "m_", "]"}], "\[Rule]", 
              InterpretationBox[
               RowBox[{
                UnderscriptBox[
                 UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
                 TagBox[GridBox[{
                    {
                    RowBox[{"{", 
                    RowBox[{"k", ",", "n"}], "}"}]}
                   },
                   DefaultBaseStyle->"Column",
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Column"]], "[", 
                RowBox[{
                 SubscriptBox["x", "k"], "\[CenterDot]", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "k", " ", "m", " ", 
                    "\[Pi]"}], "n"]}]]}], "]"}],
               $CellContext`xSum[
                CenterDot[
                 Subscript[$CellContext`x, $CellContext`k], 
                 E^(Complex[
                   0, -2] $CellContext`k $CellContext`m $CellContext`n^(-1) 
                  Pi)], {$CellContext`k, $CellContext`n}],
               Editable->False,
               SyntaxForm->Automatic]}], "}"}], "[", 
            StyleBox["\<\"Fourier transform\"\>",
             StripOnInput->False,
             LineColor->RGBColor[0, 
               Rational[2, 3], 0],
             FrontFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             BackFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             GraphicsColor->RGBColor[0, 
               Rational[2, 3], 0],
             FontFamily->"Helvetica",
             FontColor->RGBColor[0, 
               Rational[2, 3], 0]], "]"}]},
          {
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "k"], "\[Rule]", 
              RowBox[{"GCD", "[", 
               RowBox[{"k", ",", "n"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "n"}], "}"}]}], "}"}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"EulerPhi", "[", "n", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[ScriptCapitalF]", "[", 
               SubscriptBox["x", "k"], "]"}], "[", 
              RowBox[{"1", "[", 
               StyleBox["\<\"evaluation point\"\>",
                StripOnInput->False,
                LineColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FrontFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                BackFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                GraphicsColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FontFamily->"Helvetica",
                FontColor->RGBColor[0, 
                  Rational[2, 3], 0]], "]"}], "]"}], "\[Rule]", 
             InterpretationBox[
              RowBox[{
               UnderscriptBox[
                UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
                TagBox[GridBox[{
                   {
                    RowBox[{"{", 
                    RowBox[{"k", ",", "n"}], "}"}]}
                  },
                  DefaultBaseStyle->"Column",
                  GridBoxAlignment->{"Columns" -> {{Left}}},
                  
                  GridBoxItemSize->{
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                 "Column"]], "[", 
               RowBox[{
                RowBox[{"GCD", "[", 
                 RowBox[{"k", ",", "n"}], "]"}], "\[CenterDot]", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                   "2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]", " ", 
                    RowBox[{"1", "[", 
                    StyleBox["\<\"evaluation point\"\>",
                    StripOnInput->False,
                    LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    FontFamily->"Helvetica",
                    FontColor->RGBColor[0, 
                    Rational[2, 3], 0]], "]"}]}], "n"]}]]}], "]"}],
              $CellContext`xSum[
               CenterDot[
                GCD[$CellContext`k, $CellContext`n], 
                E^(Complex[0, -2] $CellContext`k $CellContext`n^(-1) Pi 1[
                   Style["evaluation point", 
                    RGBColor[0, 
                    Rational[2, 3], 0], FontFamily -> 
                    "Helvetica"]])], {$CellContext`k, $CellContext`n}],
              Editable->False,
              SyntaxForm->Automatic]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{"URL", "[", 
        TemplateBox[{
         "\"https://en.wikipedia.org/wiki/Euler%27s_totient_function#\
CITEREFSchramm2008\""},
         "URLArgument"], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Verify this relationship for a few small n: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] For: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "9"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"6", "\[Rule]", "6"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] For: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"n", "\[Rule]", "55"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"40", "\[Rule]", "40"}]}],
  SequenceForm[
   Style["\!\(\*StyleBox[\"Fourier\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"Transform\",FontWeight->\"Bold\"]\)\
\!\(\*StyleBox[\".\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"  \
\",FontWeight->\"Bold\"]\) The totient[n](EulerPhi[n]) is the discrete \
Fourier transform of GCD[{k}].", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{
         {$CellContext`\[ScriptCapitalF][
            Subscript[$CellContext`x, $CellContext`k]][
            Pattern[$CellContext`m, 
             Blank[]]] -> $CellContext`xSum[
            CenterDot[
             Subscript[$CellContext`x, $CellContext`k], 
             E^(Complex[
               0, -2] $CellContext`k $CellContext`m $CellContext`n^(-1) 
              Pi)], {$CellContext`k, $CellContext`n}]}[
          Style["Fourier transform", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {{
         Subscript[$CellContext`x, $CellContext`k] -> 
          GCD[$CellContext`k, $CellContext`n], {$CellContext`k, \
$CellContext`n}}}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{EulerPhi[$CellContext`n] -> ($CellContext`\[ScriptCapitalF][
            Subscript[$CellContext`x, $CellContext`k]][
            1[
             Style["evaluation point", 
              RGBColor[0, 
               Rational[2, 3], 0], FontFamily -> 
              "Helvetica"]]] -> $CellContext`xSum[
            CenterDot[
             GCD[$CellContext`k, $CellContext`n], 
             E^(Complex[0, -2] $CellContext`k $CellContext`n^(-1) Pi 1[
                Style["evaluation point", 
                 RGBColor[0, 
                  Rational[2, 3], 0], FontFamily -> 
                 "Helvetica"]])], {$CellContext`k, $CellContext`n}])}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      URL[
      "https://en.wikipedia.org/wiki/Euler%27s_totient_function#\
CITEREFSchramm2008"]}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Verify this relationship for a few small n: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] For: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 9, 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 6 -> 6, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] For: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`n -> 55, 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 40 -> 40],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.789907330284643*^9, {3.789907402073063*^9, 3.789907416518465*^9}, {
   3.789907458960307*^9, 3.789907466355754*^9}, 3.789907908880012*^9, 
   3.78990952985121*^9, 3.789995843521605*^9, 3.789997205978623*^9, 
   3.790614629406261*^9, 3.790784733920251*^9, 
   3.791053789345944*^9},ExpressionUUID->"8a761c3f-c0c5-43ac-b60b-\
7786cf6c6dfa"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 655},
WindowMargins->{{0, Automatic}, {Automatic, 24}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"tuTensorialStyle.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 768, 14, 58, "Input",ExpressionUUID->"84b635f0-dfe8-4c63-9e30-ffbddbb730c0",
 InitializationCell->True],
Cell[1351, 38, 770, 12, 25, "Output",ExpressionUUID->"9173cde1-df8a-4ed2-8877-f9342bdbc985"],
Cell[2124, 52, 866, 16, 34, "Output",ExpressionUUID->"4f0f31c1-6d25-4783-bcfd-9e4a81a34815"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3027, 73, 4171, 99, 218, "Input",ExpressionUUID->"6e9f982a-9d9a-4631-9902-323f8af8694d"],
Cell[7201, 174, 12440, 330, 213, "Print",ExpressionUUID->"f02714a1-bda7-447f-940b-09007adfd4f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19678, 509, 5533, 133, 367, "Input",ExpressionUUID->"31c8abbb-2985-4fc2-bf7e-ffe56de322a5"],
Cell[25214, 644, 13321, 360, 398, "Print",ExpressionUUID->"10a89b6e-5cd3-4f43-8e0f-cca04308a2d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38572, 1009, 3252, 88, 243, "Input",ExpressionUUID->"e35c7f89-74f0-44c8-a9bc-ccced28c43d0"],
Cell[41827, 1099, 7464, 205, 143, "Print",ExpressionUUID->"f9ed667f-cf2c-412a-b85c-f6dc42465a03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49328, 1309, 7396, 187, 414, "Input",ExpressionUUID->"07b00977-0484-4ee0-9692-41dc876b9de3"],
Cell[56727, 1498, 15956, 474, 405, "Print",ExpressionUUID->"9f43a498-e1d4-48bc-8944-6af650cf491d"],
Cell[72686, 1974, 9514, 285, 272, "Print",ExpressionUUID->"5a02ded9-4593-464a-8ba0-a59b6dd09a68"]
}, Open  ]],
Cell[82215, 2262, 164, 3, 29, "Text",ExpressionUUID->"bcb1fa6b-0ec7-42ae-a212-ef29d0ea973a"],
Cell[CellGroupData[{
Cell[82404, 2269, 14851, 401, 887, "Input",ExpressionUUID->"5166199f-2f69-4a2a-8b09-e59c303aa5b8"],
Cell[97258, 2672, 3750, 98, 98, "Print",ExpressionUUID->"e0b4d5b4-1bd6-4cb8-a437-c42b345bf051"],
Cell[101011, 2772, 76965, 2356, 910, "Print",ExpressionUUID->"f8ec5a19-749e-488f-aaaa-f48f56bc7e8a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178013, 5133, 182, 3, 47, "Subsection",ExpressionUUID->"771d500e-c7d0-4e71-9405-c43b48f1c5e0"],
Cell[CellGroupData[{
Cell[178220, 5140, 1503, 38, 152, "Input",ExpressionUUID->"96515bda-69b0-4312-ab00-c0300faaab28"],
Cell[179726, 5180, 2945, 86, 78, "Print",ExpressionUUID->"43705802-e1f4-495b-94e4-a6df2f33d016"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182708, 5271, 164, 3, 42, "Subsubsection",ExpressionUUID->"472d0d1c-e266-408c-9e18-6a434ce5697f"],
Cell[CellGroupData[{
Cell[182897, 5278, 11524, 274, 473, "Input",ExpressionUUID->"61c3d7c9-32c7-4153-bfb8-addf22cb3729"],
Cell[194424, 5554, 66514, 1767, 734, "Print",ExpressionUUID->"6848e0ea-f809-403b-bd9a-06fedc41de46"]
}, Open  ]],
Cell[260953, 7324, 178, 3, 29, "Text",ExpressionUUID->"9e9cb277-4edf-48ef-8aed-1567dc7fadd3"],
Cell[CellGroupData[{
Cell[261156, 7331, 5162, 125, 286, "Input",ExpressionUUID->"c89ff968-3d7c-46c8-b460-d889fe726f03"],
Cell[266321, 7458, 12670, 327, 201, "Print",ExpressionUUID->"2a8a06fe-4d08-411c-9a57-caed0e0f3a72"],
Cell[278994, 7787, 8655, 217, 148, "Print",ExpressionUUID->"e8dbd6b3-6408-4b31-b279-3983f30fb801"]
}, Open  ]],
Cell[287664, 8007, 153, 3, 29, "Text",ExpressionUUID->"f769fcde-3019-43bd-a365-6f4e2ac7c145"],
Cell[CellGroupData[{
Cell[287842, 8014, 4421, 100, 238, "Input",ExpressionUUID->"70e48b36-21e9-4a49-90ab-a95275ac316c"],
Cell[292266, 8116, 21269, 596, 391, "Print",ExpressionUUID->"bfbd4259-1ba7-401e-b4e1-b880fb4590fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[313596, 8719, 161, 3, 47, "Subsection",ExpressionUUID->"996f041b-cb21-47cf-8122-a61d8bf99e3b"],
Cell[CellGroupData[{
Cell[313782, 8726, 9506, 236, 418, "Input",ExpressionUUID->"883d9c44-5066-4ab9-acd8-4f6caff49f0f"],
Cell[323291, 8964, 33939, 942, 492, "Print",ExpressionUUID->"a1fa2459-bb2d-4d80-895f-8ab3718f2db8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[357279, 9912, 183, 3, 47, "Subsection",ExpressionUUID->"1a2c4e3e-2190-4bd2-8718-6e2da80f3de7"],
Cell[CellGroupData[{
Cell[357487, 9919, 244, 6, 42, "Input",ExpressionUUID->"75aada4e-937e-4504-a8fb-d7926482fb4c"],
Cell[357734, 9927, 361, 7, 34, "Output",ExpressionUUID->"4e2a090b-5dc1-4619-9405-e234b560e23b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358132, 9939, 9422, 194, 502, "Input",ExpressionUUID->"04247828-d4bc-4047-8280-7f28494c4694"],
Cell[367557, 10135, 21388, 579, 379, "Print",ExpressionUUID->"4ffc75d4-e4f6-4676-b8a0-64191424b74a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[388982, 10719, 3084, 77, 221, "Input",ExpressionUUID->"0c43d2b4-cd3d-40ad-9fb8-dfbf938e0101"],
Cell[392069, 10798, 12391, 360, 195, "Print",ExpressionUUID->"f473fe0e-5655-445a-9eb7-f04f3ca8deb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[404497, 11163, 2074, 47, 124, "Input",ExpressionUUID->"897e70f1-286b-4796-93d2-1ea62e4b37c0"],
Cell[406574, 11212, 3762, 112, 82, "Print",ExpressionUUID->"300fcda4-87c9-4066-8aef-ce32560cf243"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410373, 11329, 9796, 220, 779, "Input",ExpressionUUID->"3905ba1f-85bd-4909-aeef-42936ce6c7a8"],
Cell[420172, 11551, 6257, 148, 145, "Print",ExpressionUUID->"7df1efef-b67b-4c44-b835-606bb269a2d1"],
Cell[426432, 11701, 11152, 316, 178, "Print",ExpressionUUID->"a05483df-1595-435c-a792-2882a4e6a5d8"],
Cell[437587, 12019, 6946, 165, 728, "Print",ExpressionUUID->"9c9216d5-c858-4cc4-828c-c59aec5caaa8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444570, 12189, 2760, 72, 170, "Input",ExpressionUUID->"cb71767b-c770-4419-a52b-0a602b9c7cfe"],
Cell[447333, 12263, 6718, 209, 902, "Print",ExpressionUUID->"f4de3193-5458-4a9b-9bcf-f70be8a5c61a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[454088, 12477, 5815, 137, 392, "Input",ExpressionUUID->"a0fce8e3-8d97-4710-8a6e-8f290e4bc1fc"],
Cell[459906, 12616, 14569, 384, 250, "Print",ExpressionUUID->"8a761c3f-c0c5-43ac-b60b-7786cf6c6dfa"]
}, Open  ]]
}, Open  ]]
}
]
*)

