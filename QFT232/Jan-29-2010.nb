(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    101299,       2473]
NotebookOptionsPosition[     89250,       2190]
NotebookOutlinePosition[    100248,       2441]
CellTagsIndexPosition[    100205,       2438]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["29 Jan 2010", "Text",
 CellChangeTimes->{{3.473864702040862*^9, 3.4738647065675*^9}}],

Cell[BoxData[
 RowBox[{"<<", "Local`SrednickiInit`"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.443022792545981*^9, 3.443022800373374*^9}, {
  3.443022867899982*^9, 3.443022873974063*^9}, {3.447627927196126*^9, 
  3.447627930711165*^9}, {3.450116713813591*^9, 3.450116716196136*^9}, {
  3.450182134141851*^9, 3.450182169638639*^9}, {3.450182213659943*^9, 
  3.450182231120716*^9}, {3.450182287059018*^9, 3.4501822893887568`*^9}, {
  3.4501824754703817`*^9, 3.450182480146274*^9}}],

Cell["\<\
The non-relativistic Schrodinger equation with chemical potential \[Mu].\
\>", "Text",
 CellChangeTimes->{{3.4738647733287783`*^9, 3.473864805089055*^9}, {
  3.4738648474982033`*^9, 3.47386485549015*^9}, {3.473870010580042*^9, 
  3.4738700234603662`*^9}, {3.47417086739751*^9, 3.474170876801104*^9}, {
  3.474222581812154*^9, 3.474222582563902*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SEqn", "[", "\[Psi]_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[HBar]", " ", 
       RowBox[{"PartialD", "[", 
        RowBox[{"\[Psi]", ",", "0"}], "]"}]}], "==", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["\[HBar]", "2"], 
         RowBox[{"2", "m"}]], 
        RowBox[{"PartialD", "[", 
         RowBox[{"\[Psi]", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"space", "@", "i"}], ",", 
            RowBox[{"space", "@", "i"}]}], "}"}]}], "]"}]}], "-", 
       RowBox[{"\[Mu]", " ", "\[Psi]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"fn", "=", 
     RowBox[{
      RowBox[{"Tensor", "[", "\[Psi]", "]"}], "[", "x", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{"SEqn", "[", "fn", "]"}]}]}], ",", 
   RowBox[{"x", "//", "Expand"}], ",", "\[IndentingNewLine]", 
   "\"\<\\nwhere the RHS is the Hamiltonian, \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"subH", "=", 
    RowBox[{"H", "->", 
     RowBox[{"tmp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   "\"\<\\nThe Lagrangian: \>\"", ",", 
   RowBox[{"L", "->", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "x", "]"}], " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}]}], "-", 
     RowBox[{"H", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.473864812266521*^9, 3.4738648321145372`*^9}, {
   3.473864864275187*^9, 3.4738649566306677`*^9}, {3.473869191963399*^9, 
   3.47386926003585*^9}, {3.473869344419835*^9, 3.4738694258523273`*^9}, {
   3.473869457089931*^9, 3.473869523552032*^9}, {3.4738696186790257`*^9, 
   3.47386965046236*^9}, {3.473869747300228*^9, 3.4738697478759317`*^9}, {
   3.4738698743761177`*^9, 3.4738698950094213`*^9}, {3.473869934707685*^9, 
   3.473869967154351*^9}, {3.473870028142456*^9, 3.473870031022938*^9}, {
   3.473870096038066*^9, 3.473870207714101*^9}, {3.473870247124556*^9, 
   3.473870248010762*^9}, {3.473870501058626*^9, 3.4738705052577343`*^9}, 
   3.473870677307303*^9, {3.4738765232292128`*^9, 3.4738765255031023`*^9}, {
   3.473879111276885*^9, 3.4738791416267242`*^9}, 3.473880355649227*^9, {
   3.473913448786025*^9, 3.473913452665723*^9}, {3.474170905470742*^9, 
   3.4741709251904907`*^9}, {3.4741712784111547`*^9, 
   3.4741712915505466`*^9}, {3.474171333021771*^9, 3.474171334264636*^9}, {
   3.474222384889947*^9, 3.4742224084247227`*^9}, {3.4742225383447437`*^9, 
   3.474222539606431*^9}, {3.474809159025679*^9, 3.4748092449030457`*^9}, {
   3.474809361907979*^9, 3.474809426767048*^9}, {3.474809497212593*^9, 
   3.4748095454602137`*^9}, {3.474809598111874*^9, 3.474809618486046*^9}, {
   3.474809653018278*^9, 3.474809682364667*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[HBar]", " ", 
     InterpretationBox[
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         InterpretationBox["\[Psi]",
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
          Editable->False], "[", "x", "]"}], ")"}], 
       RowBox[{",", "0"}]],
      PartialD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
, 0],
      Editable->False]}], "\[Equal]", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[HBar]", "2"], " ", 
       InterpretationBox[
        SubscriptBox[
         RowBox[{"(", 
          RowBox[{
           InterpretationBox["\[Psi]",
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
            Editable->False], "[", "x", "]"}], ")"}], 
         RowBox[{",", 
          StyleBox[
           RowBox[{"i", "i"}],
           StripOnInput->False,
           FontColor->RGBColor[1, 0, 0]]}]],
        PartialD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`\
x], {
          $CellContext`space[$CellContext`i], 
          $CellContext`space[$CellContext`i]}],
        Editable->False]}], 
      RowBox[{"2", " ", "m"}]], "-", 
     RowBox[{"\[Mu]", " ", 
      RowBox[{
       InterpretationBox["\[Psi]",
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
        Editable->False], "[", "x", "]"}]}]}]}], "\[InvisibleSpace]", "x", 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\nwhere the RHS is the Hamiltonian, \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"H", "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[HBar]", "2"], " ", 
       InterpretationBox[
        SubscriptBox[
         RowBox[{"(", 
          RowBox[{
           InterpretationBox["\[Psi]",
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
            Editable->False], "[", "x", "]"}], ")"}], 
         RowBox[{",", 
          StyleBox[
           RowBox[{"i", "i"}],
           StripOnInput->False,
           FontColor->RGBColor[1, 0, 0]]}]],
        PartialD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`\
x], {
          $CellContext`space[$CellContext`i], 
          $CellContext`space[$CellContext`i]}],
        Editable->False]}], 
      RowBox[{"2", " ", "m"}]], "-", 
     RowBox[{"\[Mu]", " ", 
      RowBox[{
       InterpretationBox["\[Psi]",
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
        Editable->False], "[", "x", "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\nThe Lagrangian: \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"L", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"H", "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"p", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["field", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Tensor", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"q", ",", 
        RowBox[{"{", 
         StyleBox["x",
          StripOnInput->False,
          FontColor->RGBColor[0, 1, 0]], "}"}], ",", 
        RowBox[{"{", "Void", "}"}]}], "]"}]}]}]}]}],
  SequenceForm[Complex[0, -1] $CellContext`\[HBar] PartialD[
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x],
       0] == Rational[1, 2] $CellContext`m^(-1) $CellContext`\[HBar]^2 
     PartialD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
, {
        $CellContext`space[$CellContext`i], 
        $CellContext`space[$CellContext`i]}] - $CellContext`\[Mu] 
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x], \
$CellContext`x, 
   Style["\nwhere the RHS is the Hamiltonian, ", 
    RGBColor[0, 0, 1], Larger], $CellContext`H -> 
   Rational[1, 2] $CellContext`m^(-1) $CellContext`\[HBar]^2 PartialD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
, {
        $CellContext`space[$CellContext`i], 
        $CellContext`space[$CellContext`i]}] - $CellContext`\[Mu] 
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x], 
   Style["\nThe Lagrangian: ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`L -> -$CellContext`H[$CellContext`x] + \
$CellContext`p[$CellContext`x] 
     Derivative[1][$CellContext`field][$CellContext`x] 
     Derivative[0, {1}, {0}][
      TensorCalculus4V6`Tensorial`Tensor][$CellContext`q, {
        $CellContext`field[$CellContext`x]}, {
       TensorCalculus4V6`Tensorial`Void}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.474809178311831*^9, 3.474809250380515*^9}, {
  3.474809396880063*^9, 3.474809428610537*^9}, {3.47480961128267*^9, 
  3.474809619721352*^9}, {3.474809664326535*^9, 3.474809687333514*^9}}]
}, Open  ]],

Cell[TextData[{
 "The Lagrangian is the same as the application of ",
 Cell[BoxData[
  FormBox["\[Psi]", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " to the left of the Schrodinger equation."
}], "Text",
 CellChangeTimes->{{3.473870404338751*^9, 3.473870413322957*^9}, {
   3.473870512623259*^9, 3.47387051456542*^9}, {3.474222697332209*^9, 
   3.474222711532136*^9}, {3.474222749942971*^9, 3.474222754638999*^9}, {
   3.4742228017572803`*^9, 3.474222896723701*^9}, {3.474309235157702*^9, 
   3.474309235158437*^9}, {3.474309302115045*^9, 3.474309302117247*^9}, {
   3.474309346964995*^9, 3.474309359895961*^9}, {3.4743107910671463`*^9, 
   3.474310925638811*^9}, 3.4744668700338173`*^9, {3.474466994514618*^9, 
   3.474466998480279*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<The lagrangian: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"tmpL", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"L", "[", "x", "]"}], "->", 
      RowBox[{
       SuperscriptBox["fn", "\[Dagger]"], " ", 
       RowBox[{"tmp", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "//", "Expand"}]}], ",", 
   "\[IndentingNewLine]", "\"\<\\nand the action: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"tmpS", "=", 
    RowBox[{"S", "->", 
     RowBox[{"IntegralOp", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "x", "}"}], "}"}], ",", 
       RowBox[{"L", "[", "x", "]"}]}], "]"}]}]}], ",", "back", ",", 
   "\[IndentingNewLine]", 
   "\"\< we will use this IntegralOp[{{x}}_] to generated KroneckerDelta[]'s \
when the \[Psi][x]'s are represented as a series in p-space.\>\"", ",", 
   "\[IndentingNewLine]", 
   "\"\<Fourier decompose \[Psi][x] into energy-momentum modes over a 3-D \
spatial box and time interval 2T with frequency increment 1/(\[Beta] \[HBar]) \
where \[Beta]==T/\[HBar] . \>\"", ",", "Yield", ",", "\[IndentingNewLine]", 
   RowBox[{"tmp\[Psi]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Tensor", "[", "\[Psi]", "]"}], "[", 
      RowBox[{"x_", ",", "n_", ",", "p_"}], "]"}], "->", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["T", 
         RowBox[{"1", "/", "2"}]], 
        SuperscriptBox["L", 
         RowBox[{"3", "/", "2"}]]}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["Z", 
          RowBox[{"p", ",", "n"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"I", " ", 
            RowBox[{
             RowBox[{"p", ".", "x"}], "/", "\[HBar]"}]}], "+", 
           RowBox[{"I", " ", "2", "\[Pi]", " ", "n", " ", 
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Beta]", " ", "\[HBar]"}], ")"}]}]}]}], "]"}]}], ",", 
        "n", ",", "p"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "\"\<\\nApplied to lagrangian: \>\"", ",", "Yield", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tmpL", "/.", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{
            RowBox[{"Tensor", "[", "\[Psi]", "]"}], "[", "x", "]"}], "]"}], "->", 
          RowBox[{"Conjugate", "[", 
           RowBox[{
            RowBox[{"Tensor", "[", "\[Psi]", "]"}], "[", 
            RowBox[{"x", ",", "n1", ",", "p1"}], "]"}], "]"}]}]}], "/.", 
        "tmp\[Psi]"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", "\[Psi]", "]"}], "[", "x", "]"}], "->", 
        RowBox[{
         RowBox[{"Tensor", "[", "\[Psi]", "]"}], "[", 
         RowBox[{"x", ",", "n2", ",", "p2"}], "]"}]}]}], "/.", 
      "tmp\[Psi]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{
      RowBox[{"tmp1", "/.", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "->", 
        RowBox[{"Dot2", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}], "//", "DistConjugate"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
         RowBox[{"a", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "T", ",", "L", ",", "\[HBar]", ",", "m", ",", "n1", ",", "n2", 
              ",", "\[Beta]", ",", "x", ",", "y", ",", "p", ",", "\[Tau]", 
              ",", 
              RowBox[{"x", "[", "0", "]"}]}], "}"}], ",", "a"}], "]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"Dot2", "[", "a__", "]"}], "]"}], "->", 
         RowBox[{"Dot2", "[", "a", "]"}]}]}], "\[IndentingNewLine]", 
       "}"}]}]}], ";", "Yield"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{
      RowBox[{"tmp1", "/.", 
       RowBox[{"Sum", "->", "xSum"}]}], "/.", 
      RowBox[{"PartialD", "->", "xPartialD"}]}]}], ";", "Yield"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "//.", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ",", "c__"}], "]"}], "->", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}]}]}]}], ";", 
    "Yield"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{"a_", ",", "0"}], "]"}], ":>", 
       RowBox[{"D", "[", 
        RowBox[{"a", ",", 
         RowBox[{"x", "[", "0", "]"}]}], "]"}]}]}]}], ";", "Yield"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"p2", ",", "x"}], "]"}], "->", 
       RowBox[{"Dot2", "[", 
        RowBox[{"p2", ",", "x"}], "]"}]}]}]}], ";", "Yield"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"space", "@", "i"}], ",", 
           RowBox[{"space", "@", "i"}]}], "}"}]}], "]"}], ":>", 
       RowBox[{"D", "[", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}]}]}], ";", "Yield"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{
      RowBox[{"tmp1", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "a__", "]"}], "[", "Tensor", "]"}], 
           "[", "b__", "]"}], "->", "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"0", ",", "1"}], "]"}], "[", "Dot2", "]"}], "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "->", "a"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"0", ",", "2"}], "]"}], "[", "Dot2", "]"}], "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "->", "0"}]}], "}"}]}], "//", 
      "ExpandAll"}]}], ";", "Yield"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp1", "=", 
     RowBox[{
      RowBox[{"SumIntOpFront", "[", "tmp1", "]"}], "//", "ReleaseHold"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ",", "c__"}], "]"}], "->", 
       RowBox[{"xSum", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "a_"], ":>", 
       RowBox[{"Exp", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"Expand", "[", "a", "]"}], "]"}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"c_", " ", 
         RowBox[{"Dot2", "[", 
          RowBox[{"a_", ",", "x"}], "]"}]}], "-", 
        RowBox[{"c_", " ", 
         RowBox[{"Dot2", "[", 
          RowBox[{"b_", ",", "x"}], "]"}]}]}], "->", 
       RowBox[{"c", " ", 
        RowBox[{"Dot2", "[", 
         RowBox[{
          RowBox[{"a", "-", "b"}], ",", "x"}], "]"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{"tmp1", "/.", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
       RowBox[{"SumMoveNVarOut", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmp2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp1", "/.", 
        RowBox[{
         RowBox[{"Dot2", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "->", 
         RowBox[{"a", " ", "b"}]}]}], "/.", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], "->", "x0"}]}], "/.", 
      RowBox[{"Sum", "->", "xSum"}]}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.473870416442924*^9, 3.473870457525527*^9}, {
   3.473870552655923*^9, 3.473870559054411*^9}, 3.473871769470572*^9, {
   3.47422259976362*^9, 3.474222667021803*^9}, {3.47431093274471*^9, 
   3.474310954345347*^9}, {3.4743110172899857`*^9, 3.4743110597469807`*^9}, {
   3.474311229822784*^9, 3.47431128955687*^9}, {3.474311396341401*^9, 
   3.4743116262000628`*^9}, 3.474311660812728*^9, {3.474311998456002*^9, 
   3.4743120284494667`*^9}, {3.4743121809105177`*^9, 
   3.4743122460803013`*^9}, {3.474312569978458*^9, 3.474312640481428*^9}, {
   3.474312678424658*^9, 3.474312694024766*^9}, {3.4743129025622597`*^9, 
   3.47431290271189*^9}, {3.4743129633492002`*^9, 3.474312969301345*^9}, {
   3.474313800341625*^9, 3.4743138702988253`*^9}, {3.474378036031354*^9, 
   3.474378157363097*^9}, {3.4744669161247253`*^9, 3.474466916580233*^9}, {
   3.4744670165561647`*^9, 3.474467017509391*^9}, {3.4744670479114113`*^9, 
   3.474467051928392*^9}, {3.474467083268643*^9, 3.474467106849791*^9}, {
   3.474467194733007*^9, 3.47446726576593*^9}, {3.4744673941545143`*^9, 
   3.474467418931418*^9}, {3.474467490133762*^9, 3.474467582761198*^9}, {
   3.47447227833215*^9, 3.4744722797456503`*^9}, {3.474472315883399*^9, 
   3.474472374028738*^9}, {3.4744724861415873`*^9, 3.474472488038179*^9}, {
   3.474472617325498*^9, 3.474472645334066*^9}, {3.474472677126186*^9, 
   3.4744727869350443`*^9}, {3.4744728177116413`*^9, 3.474472947992937*^9}, {
   3.474472991835247*^9, 3.474473016012155*^9}, {3.474473440079183*^9, 
   3.474473471947687*^9}, 3.474473528320731*^9, 3.474473566284564*^9, {
   3.474473618465343*^9, 3.474473620297182*^9}, {3.4744736558498993`*^9, 
   3.474473681874064*^9}, {3.4744738920424967`*^9, 3.47447392777162*^9}, {
   3.474473961957831*^9, 3.4744739876290216`*^9}, {3.474474028462569*^9, 
   3.474474060832356*^9}, {3.474474100963468*^9, 3.4744741407463017`*^9}, {
   3.474474179586351*^9, 3.4744741998957167`*^9}, {3.4744742314737797`*^9, 
   3.474474254097711*^9}, {3.4744742952926407`*^9, 3.474474328693343*^9}, {
   3.474474425935957*^9, 3.474474434294878*^9}, {3.4744744769660807`*^9, 
   3.4744744816780777`*^9}, {3.474474535621016*^9, 3.474474543345175*^9}, 
   3.474474598677927*^9, {3.474477897243909*^9, 3.474477901266016*^9}, {
   3.4744830081954403`*^9, 3.474483075366262*^9}, 3.4744831090532007`*^9, {
   3.474483144531013*^9, 3.4744831509363832`*^9}, {3.474483244809442*^9, 
   3.474483278421818*^9}, 3.474483350042274*^9, {3.4745043004912987`*^9, 
   3.474504305872718*^9}, {3.4745043391009007`*^9, 3.474504353060161*^9}, {
   3.4745043849169283`*^9, 3.474504409950687*^9}, {3.474504533829218*^9, 
   3.4745045353819437`*^9}, {3.474504622997819*^9, 3.474504624248667*^9}, {
   3.4745091920519743`*^9, 3.47450919247902*^9}, {3.474509831347875*^9, 
   3.474509836818572*^9}, {3.474509944253909*^9, 3.4745099603356743`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The lagrangian: \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"L", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox["\[Psi]",
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
         Editable->False], "[", "x", "]"}], "*"], " ", 
      InterpretationBox[
       SubscriptBox[
        RowBox[{"(", 
         RowBox[{
          InterpretationBox["\[Psi]",
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
           Editable->False], "[", "x", "]"}], ")"}], 
        RowBox[{",", "0"}]],
       PartialD[
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`\
x], 0],
       Editable->False]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[HBar]", "2"], " ", 
       SuperscriptBox[
        RowBox[{
         InterpretationBox["\[Psi]",
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
          Editable->False], "[", "x", "]"}], "*"], " ", 
       InterpretationBox[
        SubscriptBox[
         RowBox[{"(", 
          RowBox[{
           InterpretationBox["\[Psi]",
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
            Editable->False], "[", "x", "]"}], ")"}], 
         RowBox[{",", 
          StyleBox[
           RowBox[{"i", "i"}],
           StripOnInput->False,
           FontColor->RGBColor[1, 0, 0]]}]],
        PartialD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`\
x], {
          $CellContext`space[$CellContext`i], 
          $CellContext`space[$CellContext`i]}],
        Editable->False]}], 
      RowBox[{"2", " ", "m"}]], "-", 
     RowBox[{"\[Mu]", " ", 
      SuperscriptBox[
       RowBox[{
        InterpretationBox["\[Psi]",
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
         Editable->False], "[", "x", "]"}], "*"], " ", 
      RowBox[{
       InterpretationBox["\[Psi]",
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
        Editable->False], "[", "x", "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\nand the action: \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"S", "\[Rule]", 
    RowBox[{"IntegralOp", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "x", "}"}], "}"}], ",", 
      RowBox[{"L", "[", "x", "]"}]}], "]"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongLeftArrow]\"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\" we will use this IntegralOp[{{x}}_] to generated \
KroneckerDelta[]'s when the \[Psi][x]'s are represented as a series in \
p-space.\"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Fourier decompose \[Psi][x] into energy-momentum modes over \
a 3-D spatial box and time interval 2T with frequency increment 1/(\[Beta] \
\[HBar]) where \[Beta]==T/\[HBar] . \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     InterpretationBox["\[Psi]",
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]],
      Editable->False], "[", 
     RowBox[{"x_", ",", "n_", ",", "p_"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      UnderscriptBox["\[Sum]", "n"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p"], 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"p", ".", "x"}]}], "\[HBar]"], "+", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", "\[Pi]", " ", 
            InterpretationBox[
             SubsuperscriptBox["x", 
              StyleBox[
               StyleBox["0",
                StripOnInput->False,
                FontColor->RGBColor[0, 1, 0]],
               StripOnInput->False,
               ShowContents->False], 
              StyleBox["0",
               StripOnInput->False,
               FontColor->RGBColor[0, 1, 0]]],
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {
               $CellContext`field[0]}, {TensorCalculus4V6`Tensorial`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], 
           RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", 
        SubscriptBox["Z", 
         RowBox[{"p", ",", "n"}]]}]}]}], 
     RowBox[{
      SuperscriptBox["L", 
       RowBox[{"3", "/", "2"}]], " ", 
      SqrtBox["T"]}]]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\nApplied to lagrangian: \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"L", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Mu]", " ", 
        RowBox[{"xSum", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"n1", "-", "n2"}], ")"}], " ", "\[Pi]", " ", 
                  "x0"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p1", "-", "p2"}], ")"}], " ", "x", " ", 
                  "\[Beta]"}]}], ")"}]}], 
              RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox["Z", 
              RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
           SubscriptBox["Z", 
            RowBox[{"p2", ",", "n2"}]]}], ",", "n2", ",", "p2", ",", "n1", 
          ",", "p1"}], "]"}]}], 
       RowBox[{
        SuperscriptBox["L", "3"], " ", "T"}]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", "\[Pi]", " ", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"n1", "-", "n2"}], ")"}], " ", "\[Pi]", " ", "x0"}],
                 "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p1", "-", "p2"}], ")"}], " ", "x", " ", 
                 "\[Beta]"}]}], ")"}]}], 
             RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", "n2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["Z", 
             RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
          SubscriptBox["Z", 
           RowBox[{"p2", ",", "n2"}]]}], ",", "n2", ",", "p2", ",", "n1", ",",
          "p1"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["L", "3"], " ", "T", " ", "\[Beta]"}]], "-", 
     FractionBox[
      RowBox[{"xSum", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"n1", "-", "n2"}], ")"}], " ", "\[Pi]", " ", "x0"}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p1", "-", "p2"}], ")"}], " ", "x", " ", 
                "\[Beta]"}]}], ")"}]}], 
            RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", 
         SuperscriptBox["p2", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox["Z", 
            RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
         SubscriptBox["Z", 
          RowBox[{"p2", ",", "n2"}]]}], ",", "n2", ",", "p2", ",", "n1", ",", 
        "p1"}], "]"}], 
      RowBox[{"2", " ", 
       SuperscriptBox["L", "3"], " ", "m", " ", "T"}]]}]}]}],
  SequenceForm[
   Style["The lagrangian: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`L[$CellContext`x] -> 
   Complex[0, 1] $CellContext`\[HBar] Conjugate[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
] PartialD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
, 0] + Rational[1, 2] $CellContext`m^(-1) $CellContext`\[HBar]^2 Conjugate[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
] PartialD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]\
, {
        $CellContext`space[$CellContext`i], 
        $CellContext`space[$CellContext`i]}] - $CellContext`\[Mu] Conjugate[
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x]]
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][$CellContext`x], 
   Style["\nand the action: ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`S -> $CellContext`IntegralOp[{{$CellContext`x}}, 
     $CellContext`L[$CellContext`x]], 
   Style[" \[LongLeftArrow]", 
    RGBColor[0, 0, 1], Larger], 
   Style[" we will use this IntegralOp[{{x}}_] to generated \
KroneckerDelta[]'s when the \[Psi][x]'s are represented as a series in \
p-space.", 
    RGBColor[0, 0, 1], Larger], 
   Style["Fourier decompose \[Psi][x] into energy-momentum modes over a 3-D \
spatial box and time interval 2T with frequency increment 1/(\[Beta] \[HBar]) \
where \[Beta]==T/\[HBar] . ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Psi]][
     Pattern[$CellContext`x, 
      Blank[]], 
     Pattern[$CellContext`n, 
      Blank[]], 
     Pattern[$CellContext`p, 
      Blank[]]] -> $CellContext`L^Rational[-3, 2] $CellContext`T^
     Rational[-1, 2] 
    Sum[E^(Complex[0, 1] $CellContext`\[HBar]^(-1) 
         Dot[$CellContext`p, $CellContext`x] + 
        Complex[0, 2] $CellContext`n 
         Pi $CellContext`\[Beta]^(-1) $CellContext`\[HBar]^(-1) 
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {
            $CellContext`field[0]}, {TensorCalculus4V6`Tensorial`Void}]) 
      Subscript[$CellContext`Z, $CellContext`p, $CellContext`n], \
$CellContext`n, $CellContext`p], 
   Style["\nApplied to lagrangian: ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`L[$CellContext`x] -> -$CellContext`L^(-3) \
$CellContext`T^(-1) $CellContext`\[Mu] $CellContext`xSum[
      E^(Complex[0, -1] $CellContext`\[Beta]^(-1) (
          2 ($CellContext`n1 - $CellContext`n2) 
           Pi $CellContext`x0 + ($CellContext`p1 - $CellContext`p2) \
$CellContext`x $CellContext`\[Beta])/$CellContext`\[HBar]) Conjugate[
         Subscript[$CellContext`Z, $CellContext`p1, $CellContext`n1]] 
       Subscript[$CellContext`Z, $CellContext`p2, $CellContext`n2], \
$CellContext`n2, $CellContext`p2, $CellContext`n1, $CellContext`p1] - 
    2 $CellContext`L^(-3) 
    Pi $CellContext`T^(-1) $CellContext`\[Beta]^(-1) $CellContext`xSum[
     E^(Complex[0, -1] $CellContext`\[Beta]^(-1) (
         2 ($CellContext`n1 - $CellContext`n2) 
          Pi $CellContext`x0 + ($CellContext`p1 - $CellContext`p2) \
$CellContext`x $CellContext`\[Beta])/$CellContext`\[HBar]) $CellContext`n2 
      Conjugate[
        Subscript[$CellContext`Z, $CellContext`p1, $CellContext`n1]] 
      Subscript[$CellContext`Z, $CellContext`p2, $CellContext`n2], \
$CellContext`n2, $CellContext`p2, $CellContext`n1, $CellContext`p1] + 
    Rational[-1, 
       2] $CellContext`L^(-3) $CellContext`m^(-1) $CellContext`T^(-1) \
$CellContext`xSum[
      E^(Complex[0, -1] $CellContext`\[Beta]^(-1) (
          2 ($CellContext`n1 - $CellContext`n2) 
           Pi $CellContext`x0 + ($CellContext`p1 - $CellContext`p2) \
$CellContext`x $CellContext`\[Beta])/$CellContext`\[HBar]) $CellContext`p2^2 
       Conjugate[
         Subscript[$CellContext`Z, $CellContext`p1, $CellContext`n1]] 
       Subscript[$CellContext`Z, $CellContext`p2, $CellContext`n2], \
$CellContext`n2, $CellContext`p2, $CellContext`n1, $CellContext`p1]],
  Editable->False]], "Print",
 CellChangeTimes->{3.474504592764699*^9, 3.474504625741789*^9, 
  3.47450908228743*^9, 3.474509117284033*^9, 3.474509193901906*^9, 
  3.474509282252688*^9, 3.474509344081002*^9, 3.474509486350513*^9, 
  3.474509517442079*^9, 3.4745095641488733`*^9, 3.4745097676810017`*^9, 
  3.4745098047086067`*^9, 3.4745098399028397`*^9, 3.474509961989492*^9, 
  3.4746357912107353`*^9, 3.474730428611171*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmp3", "=", 
   RowBox[{
    RowBox[{"tmpS", "/.", "tmp2"}], "/.", 
    RowBox[{
     RowBox[{"IntegralOp", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "x", "}"}], "}"}], ",", "a_"}], "]"}], "->", 
     RowBox[{"IntegralOp", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", 
         RowBox[{"{", "x0", "}"}]}], "}"}], ",", "a"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"tmp3", "=", 
  RowBox[{
   RowBox[{"SumIntOpFront", "[", "tmp3", "]"}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp3", "=", 
  RowBox[{"findIntDelta", "[", "tmp3", "]"}]}]}], "Input",
 CellChangeTimes->{{3.4744844823322372`*^9, 3.47448453711406*^9}, 
   3.47448460026644*^9, {3.474510057392005*^9, 3.474510138491304*^9}, {
   3.47451022328892*^9, 3.474510236751968*^9}}],

Cell[BoxData[
 RowBox[{"S", "\[Rule]", 
  RowBox[{
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{
     UnderscriptBox["\[Sum]", "p2"], 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p1"], 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"{", "x0", "}"}]}], "}"}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"n1", "-", "n2"}], ")"}], " ", "\[Pi]", " ", 
                   "x0"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p1", "-", "p2"}], ")"}], " ", "x", " ", 
                   "\[Beta]"}]}], ")"}]}], 
               RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["Z", 
               RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
            SubscriptBox["Z", 
             RowBox[{"p2", ",", "n2"}]]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["L", "3"], " ", "m", " ", "T"}]]}]}], 
        "]"}]}]}]}]}], "+", 
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{
     UnderscriptBox["\[Sum]", "p2"], 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p1"], 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"{", "x0", "}"}]}], "}"}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"n1", "-", "n2"}], ")"}], " ", "\[Pi]", " ", 
                   "x0"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p1", "-", "p2"}], ")"}], " ", "x", " ", 
                   "\[Beta]"}]}], ")"}]}], 
               RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", "n2", " ", 
            "\[Pi]", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["Z", 
               RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
            SubscriptBox["Z", 
             RowBox[{"p2", ",", "n2"}]]}], 
           RowBox[{
            SuperscriptBox["L", "3"], " ", "T", " ", "\[Beta]"}]]}]}], 
        "]"}]}]}]}]}], "+", 
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{
     UnderscriptBox["\[Sum]", "p2"], 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p1"], 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"{", "x0", "}"}]}], "}"}], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"n1", "-", "n2"}], ")"}], " ", "\[Pi]", " ", 
                   "x0"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p1", "-", "p2"}], ")"}], " ", "x", " ", 
                   "\[Beta]"}]}], ")"}]}], 
               RowBox[{"\[Beta]", " ", "\[HBar]"}]]}]], " ", "\[Mu]", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["Z", 
               RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
            SubscriptBox["Z", 
             RowBox[{"p2", ",", "n2"}]]}], 
           RowBox[{
            SuperscriptBox["L", "3"], " ", "T"}]]}]}], 
        "]"}]}]}]}]}]}]}]], "Output",
 CellChangeTimes->{{3.474484556982143*^9, 3.474484601537547*^9}, {
   3.474510061676558*^9, 3.474510094759419*^9}, 3.474510140143981*^9, 
   3.474510270735118*^9, 3.474635821804903*^9, 3.474730459343676*^9}],

Cell[BoxData[
 RowBox[{"S", "\[Rule]", 
  RowBox[{
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{
     UnderscriptBox["\[Sum]", "p2"], 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p1"], 
       RowBox[{"-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["L", "3"], " ", "m", " ", "T"}]], 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"Dim", "[", "x", "]"}], "+", 
            RowBox[{"Dim", "[", "x0", "]"}]}]], " ", 
          SuperscriptBox["p2", "2"], " ", 
          SuperscriptBox["\[Pi]", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Dim", "[", "x", "]"}], "+", 
            RowBox[{"Dim", "[", "x0", "]"}]}]], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["Z", 
             RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["p1", "\[HBar]"]}], "+", 
            FractionBox["p2", "\[HBar]"]}], "]"}], " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["n1", 
              RowBox[{"\[Beta]", " ", "\[HBar]"}]]}], "+", 
            FractionBox["n2", 
             RowBox[{"\[Beta]", " ", "\[HBar]"}]]}], "]"}], " ", 
          SubscriptBox["Z", 
           RowBox[{"p2", ",", "n2"}]]}]}]}]}]}]}]}], "+", 
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{
     UnderscriptBox["\[Sum]", "p2"], 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p1"], 
       RowBox[{"-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["L", "3"], " ", "T", " ", "\[Beta]"}]], 
         RowBox[{"n2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", " ", "\[Pi]"}], ")"}], 
           RowBox[{
            RowBox[{"Dim", "[", "x", "]"}], "+", 
            RowBox[{"Dim", "[", "x0", "]"}]}]], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["Z", 
             RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["p1", "\[HBar]"]}], "+", 
            FractionBox["p2", "\[HBar]"]}], "]"}], " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["n1", 
              RowBox[{"\[Beta]", " ", "\[HBar]"}]]}], "+", 
            FractionBox["n2", 
             RowBox[{"\[Beta]", " ", "\[HBar]"}]]}], "]"}], " ", 
          SubscriptBox["Z", 
           RowBox[{"p2", ",", "n2"}]]}]}]}]}]}]}]}], "+", 
   RowBox[{
    UnderscriptBox["\[Sum]", "n2"], 
    RowBox[{
     UnderscriptBox["\[Sum]", "p2"], 
     RowBox[{
      UnderscriptBox["\[Sum]", "n1"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "p1"], 
       RowBox[{"-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["L", "3"], " ", "T"}]], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", " ", "\[Pi]"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Dim", "[", "x", "]"}], "+", 
            RowBox[{"Dim", "[", "x0", "]"}]}]], " ", "\[Mu]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["Z", 
             RowBox[{"p1", ",", "n1"}]], ")"}], "*"], " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["p1", "\[HBar]"]}], "+", 
            FractionBox["p2", "\[HBar]"]}], "]"}], " ", 
          RowBox[{"DiracDelta", "[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["n1", 
              RowBox[{"\[Beta]", " ", "\[HBar]"}]]}], "+", 
            FractionBox["n2", 
             RowBox[{"\[Beta]", " ", "\[HBar]"}]]}], "]"}], " ", 
          SubscriptBox["Z", 
           RowBox[{"p2", ",", "n2"}]]}]}]}]}]}]}]}]}]}]], "Output",
 CellChangeTimes->{{3.474484556982143*^9, 3.474484601537547*^9}, {
   3.474510061676558*^9, 3.474510094759419*^9}, 3.474510140143981*^9, 
   3.474510270735118*^9, 3.474635821804903*^9, 3.474730476961479*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<The DiracDelta are KroneckerDelta's for the discrete case.\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{"tmp3", "/.", 
      RowBox[{"DiracDelta", "->", "KroneckerDelta"}]}]}], ";", "Yield", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{"SumKroneckerElim", "[", "tmp", "]"}]}], ";", "Yield", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{"tmp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Dim", "[", "x0", "]"}], "->", "0"}], ",", 
         RowBox[{
          RowBox[{"Dim", "[", "x", "]"}], "->", "0"}]}], "}"}]}], "/.", 
      RowBox[{"Sum", "->", "xSum"}]}]}], ";", "Yield", ";", 
    RowBox[{"(*", 
     RowBox[{"discrete", " ", "normalization"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{"tmp", "//.", 
      RowBox[{
       RowBox[{
        RowBox[{"xSum", "[", 
         RowBox[{"a_", ",", "b__"}], "]"}], "+", 
        RowBox[{"xSum", "[", 
         RowBox[{"c_", ",", "b__"}], "]"}]}], ":>", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"a", "+", "c"}], "]"}], ",", "b"}], "]"}]}]}]}], ";", 
    "Yield", ";", "\[IndentingNewLine]", 
    RowBox[{"tmp4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "/.", 
       RowBox[{"n1", "->", "n"}]}], "/.", 
      RowBox[{"p1", "->", "p"}]}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.474477336826618*^9, 3.474477344874929*^9}, {
   3.474479116002781*^9, 3.474479136891765*^9}, {3.474479241669613*^9, 
   3.474479243175743*^9}, {3.474484609528337*^9, 3.4744846184560413`*^9}, {
   3.474484714094762*^9, 3.474484738780869*^9}, {3.474502970136798*^9, 
   3.474502971662565*^9}, {3.474503079850439*^9, 3.474503081920846*^9}, 
   3.4745032208982487`*^9, {3.474503300474162*^9, 3.474503306727973*^9}, 
   3.4745101104784*^9, 3.474510319005156*^9, {3.474510387582697*^9, 
   3.474510402694525*^9}, {3.474510451880002*^9, 3.4745104675034113`*^9}, {
   3.474510552144844*^9, 3.474510563929175*^9}, {3.47451064246541*^9, 
   3.474510655176126*^9}, 3.474510803706366*^9, 3.474510836343339*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The DiracDelta are KroneckerDelta's for the discrete case.\"\
\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"S", "\[Rule]", 
    RowBox[{"xSum", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "m", " ", "n", " ", "\[Pi]"}], "+", 
           RowBox[{
            SuperscriptBox["p", "2"], " ", "\[Beta]"}], "+", 
           RowBox[{"2", " ", "m", " ", "\[Beta]", " ", "\[Mu]"}]}], ")"}], 
         " ", 
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox["Z", 
            RowBox[{"p", ",", "n"}]], ")"}], "*"], " ", 
         SubscriptBox["Z", 
          RowBox[{"p", ",", "n"}]]}], 
        RowBox[{"4", " ", 
         SuperscriptBox["L", "3"], " ", "m", " ", "\[Pi]", " ", "T", " ", 
         "\[Beta]"}]]}], ",", "n", ",", "p"}], "]"}]}]}],
  SequenceForm[
   Style["The DiracDelta are KroneckerDelta's for the discrete case.", 
    RGBColor[0, 0, 1], Larger], $CellContext`S -> $CellContext`xSum[
    Rational[-1, 4] $CellContext`L^(-3) $CellContext`m^(-1) 
     Pi^(-1) $CellContext`T^(-1) $CellContext`\[Beta]^(-1) (
      4 $CellContext`m $CellContext`n 
       Pi + $CellContext`p^2 $CellContext`\[Beta] + 
      2 $CellContext`m $CellContext`\[Beta] $CellContext`\[Mu]) Conjugate[
       Subscript[$CellContext`Z, $CellContext`p, $CellContext`n]] 
     Subscript[$CellContext`Z, $CellContext`p, $CellContext`n], \
$CellContext`n, $CellContext`p]],
  Editable->False]], "Print",
 CellChangeTimes->{3.474510362348795*^9, 3.4745104050259523`*^9, 
  3.474510468926681*^9, 3.474510566556038*^9, 3.4745106568457327`*^9, 
  3.474510805350312*^9, 3.474510840329356*^9, 3.4746358790652943`*^9, 
  3.4747305144766493`*^9}]
}, Open  ]],

Cell["\<\
Partition function.  The integrals over \[Psi]'s are functional integrals.\
\>", "Text",
 CellChangeTimes->{{3.4738702888060417`*^9, 3.473870293532569*^9}, {
  3.473871813701818*^9, 3.473871841812273*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
   "\"\<Partition function definition: \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"tmpZ", "=", 
     RowBox[{"Z", "->", 
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Psi]", "[", "x", "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["\[Psi]", "\[Dagger]"], "[", "x", "]"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{
          FractionBox["I", "\[HBar]"], " ", "S"}], "]"}]}], "]"}]}]}], ",", 
    "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<The functional integral over \[Psi]'s is replaced by functional \
integral over Fourier coefficients, \!\(\*SubscriptBox[\(Z\), \
\(__\)]\)'s.\>\"", ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"tmpZ", "/.", "tmp4"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]", "[", "_", "]"}], "->", 
           SubscriptBox["Z", 
            RowBox[{"p", ",", "n"}]]}], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Psi]", "\[Dagger]"], "[", "_", "]"}], "->", 
           SuperscriptBox[
            SubscriptBox["Z", 
             RowBox[{"p", ",", "n"}]], "\[Dagger]"]}]}], "}"}]}], "/.", 
       RowBox[{
        RowBox[{"a__", " ", 
         RowBox[{"xSum", "[", 
          RowBox[{"b_", ",", "c__"}], "]"}]}], "->", 
        RowBox[{"xSum", "[", 
         RowBox[{
          RowBox[{"a", " ", "b"}], ",", "c"}], "]"}]}]}]}], ";", "Yield", ";",
      "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"tmpZ", "/.", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"xSum", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}]], ":>", 
        RowBox[{"Product", "[", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "a"], ",", "b"}], "]"}]}]}]}], 
     ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"tmpZ", "/.", 
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"Product", "[", 
           RowBox[{"b_", ",", "c__"}], "]"}]}], "]"}], ":>", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}]}]}], ";", 
     "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"tmpZ", "/.", 
       RowBox[{
        RowBox[{"Exp", "[", "a__", "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"coef", "=", 
           RowBox[{"Coefficient", "[", " ", 
            RowBox[{"a", ",", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               SubscriptBox["Z", 
                RowBox[{"p", ",", "n"}]], "]"}], 
              SubscriptBox["Z", 
               RowBox[{"p", ",", "n"}]]}]}], "]"}]}], ";", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "CC"}], " ", 
            RowBox[{"Conjugate", "[", 
             SubscriptBox["Z", 
              RowBox[{"p", ",", "n"}]], "]"}], 
            SubscriptBox["Z", 
             RowBox[{"p", ",", "n"}]]}], "]"}]}], ")"}]}]}]}], ";", "Yield", 
     ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{
       RowBox[{"tmpZ", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", 
           SubscriptBox["Z", "a__"], "]"}], 
          SubscriptBox["Z", "a__"]}], "->", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Re", "[", 
            SubscriptBox["Z", "a"], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Im", "[", 
            SubscriptBox["Z", "a"], "]"}], "2"]}]}]}], "/.", 
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Im", "[", 
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", "b"}], 
         "]"}]}]}]}], ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{
       RowBox[{"tmpZ", "/.", 
        RowBox[{
         RowBox[{"Exp", "[", "a__", "]"}], ":>", 
         RowBox[{"Exp", "[", 
          RowBox[{"Expand", "[", "a", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"a_", "+", "b_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"HoldForm", "[", 
          RowBox[{"Exp", "[", "a", "]"}], "]"}], 
         RowBox[{"HoldForm", "[", 
          RowBox[{"Exp", "[", "b", "]"}], "]"}]}]}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"SeparateIntVar", "[", 
       RowBox[{"tmpZ", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Re", "[", 
            SubscriptBox["Z", 
             RowBox[{"p", ",", "n"}]], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Im", "[", 
            SubscriptBox["Z", 
             RowBox[{"p", ",", "n"}]], "]"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"tmpZ", "/.", 
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":>", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a", ",", 
          RowBox[{"IntegralOpMoveNVarOut", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}]}]}], ";", "Yield", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"tmpZ", "/.", 
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"d_", " ", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{"b_", ",", "c_"}], "]"}]}]}], "]"}], ":>", 
        RowBox[{"IntegralOpMoveNVarOut", "[", 
         RowBox[{"a", ",", 
          RowBox[{"d", " ", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], "]"}]}]}]}]}], ",", 
    "\[IndentingNewLine]", "\"\<\\nProduct of Gaussian integrals:\>\"", ",", 
    "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{"tmpZ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ReleaseHold", "[", "tmpZ", "]"}], "/.", 
       RowBox[{"Product", "->", "xProduct"}]}], "//.", 
      RowBox[{
       RowBox[{
        RowBox[{"Im", "[", "a_", "]"}], "|", 
        RowBox[{"Re", "[", "a_", "]"}]}], ":>", "x"}]}]}], ",", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmpZ", "=", 
      RowBox[{"tmpZ", "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "x", "}"}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], "}"}]}]}]}], 
     ";", "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{
       RowBox[{"tmpZ", "/.", "subxIntegrate"}], "/.", "subIntegrate"}]}], ";",
      "Yield", ";", "\[IndentingNewLine]", 
     RowBox[{"tmpZ", "=", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", "CC", "]"}], ">", "0"}], ",", 
        RowBox[{"Refine", "[", "tmpZ", "]"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp", "=", "coef"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{
    RowBox[{"tmp", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["L", "3"], "T", " ", "\[HBar]", " ", "\[Beta]", " ", 
       "2", " ", "\[Pi]", " ", "I"}], ")"}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "tmp"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "tmp"}], "/.", 
       RowBox[{"n", "->", 
        RowBox[{"-", "n"}]}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "tmp"}], "/.", 
       RowBox[{"n", "->", "0"}]}], ")"}]}], "/.", 
    RowBox[{"\[Mu]", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["p", "2"]}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "m"}], ")"}]}], "+", "Mp2"}]}]}], "//", 
   "ExpandAll"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp0", "=", 
   RowBox[{
    RowBox[{"tmp", " ", "Mp2", " ", "\[Beta]"}], "//", "FullSimplify"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"tmp2", "=", 
  RowBox[{"Rest", "[", "tmp", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "tmp2"}], "//", "FullSimplify"}], "//", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"#", ",", "n"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp3", "=", 
   RowBox[{"Last", "[", "tmp2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmp2", "=", 
   RowBox[{"tmp2", "/", "tmp3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tmp2", "=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", 
      SuperscriptBox["n", 
       RowBox[{"i", "-", "1"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], 
   "tmp3"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp2", "=", 
  RowBox[{
   RowBox[{"First", "[", "tmp", "]"}], "+", 
   RowBox[{"1", "/", "tmp2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp2", "=", 
  RowBox[{
   RowBox[{"tmp2", "/", 
    RowBox[{"First", "[", "tmp", "]"}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Product", "[", 
    RowBox[{"tmp2", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "Infinity"}], "}"}]}], "]"}], "//", 
   "TrigToExp"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.473870297721734*^9, 3.473870381918027*^9}, {
   3.473870735218487*^9, 3.4738707535831203`*^9}, {3.4738707976128283`*^9, 
   3.4738709073705482`*^9}, {3.473870942492261*^9, 3.473870969315783*^9}, {
   3.473871050428193*^9, 3.473871064173563*^9}, {3.473871725198807*^9, 
   3.473871796997862*^9}, {3.473871954882423*^9, 3.473871961742031*^9}, {
   3.4740645655375357`*^9, 3.474064565968169*^9}, {3.474312987553197*^9, 
   3.4743129933915377`*^9}, {3.47431318086966*^9, 3.4743132617234077`*^9}, {
   3.4743132958263474`*^9, 3.474313306330627*^9}, {3.474313343173897*^9, 
   3.4743134089281797`*^9}, {3.474313448354149*^9, 3.47431356279245*^9}, {
   3.4743135960292473`*^9, 3.474313665408958*^9}, {3.474314010234927*^9, 
   3.4743140680701303`*^9}, {3.474314166345192*^9, 3.474314218002696*^9}, 
   3.47431425043338*^9, {3.474314315227189*^9, 3.4743144249870777`*^9}, {
   3.474314468267234*^9, 3.4743144784137087`*^9}, {3.47431455861086*^9, 
   3.474314559082746*^9}, {3.474314594292099*^9, 3.474314595835232*^9}, {
   3.474314826623788*^9, 3.4743148725676394`*^9}, {3.474315003450863*^9, 
   3.474315076519388*^9}, {3.474315111504629*^9, 3.474315171474269*^9}, {
   3.4743152285992937`*^9, 3.474315277749633*^9}, {3.474315329641247*^9, 
   3.4743153536973753`*^9}, {3.474315398549673*^9, 3.474315405506*^9}, {
   3.474315460635154*^9, 3.47431550503274*^9}, {3.474315729055791*^9, 
   3.474315823839551*^9}, {3.474315864461067*^9, 3.474315894232716*^9}, {
   3.4743159315240793`*^9, 3.474315945010295*^9}, {3.474315985535878*^9, 
   3.474316013576659*^9}, {3.474316051726219*^9, 3.474316056176758*^9}, {
   3.4743160867867823`*^9, 3.474316091408772*^9}, {3.474316132003681*^9, 
   3.474316132714863*^9}, {3.4743162159087276`*^9, 3.4743162474590387`*^9}, {
   3.474316304645093*^9, 3.474316323836309*^9}, {3.474316371005368*^9, 
   3.474316409312861*^9}, {3.4743165390204973`*^9, 3.4743165497223597`*^9}, {
   3.474316587129768*^9, 3.474316605713344*^9}, {3.474316698533136*^9, 
   3.474316734817843*^9}, {3.4743167854630623`*^9, 3.474316790337096*^9}, {
   3.4743168504531116`*^9, 3.474316897924217*^9}, {3.4743170974860277`*^9, 
   3.474317100396583*^9}, 3.47431713559764*^9, {3.474317187030051*^9, 
   3.474317209814967*^9}, {3.474317521617443*^9, 3.474317627850916*^9}, {
   3.4743176747635098`*^9, 3.474317675589945*^9}, 3.4743177557189827`*^9, {
   3.474333519344392*^9, 3.474333526141165*^9}, {3.474333713615095*^9, 
   3.474333714016067*^9}, {3.4743337839967537`*^9, 3.474333837080797*^9}, {
   3.474339069168872*^9, 3.4743391230711946`*^9}, {3.474339154601186*^9, 
   3.474339155229549*^9}, {3.474339191604682*^9, 3.4743392038337927`*^9}, {
   3.474340142523923*^9, 3.4743401706258297`*^9}, {3.47434029163299*^9, 
   3.474340479357915*^9}, {3.4743405282213984`*^9, 3.474340541067555*^9}, {
   3.4743409466024303`*^9, 3.474340947306028*^9}, {3.47434098251105*^9, 
   3.474340984879608*^9}, 3.47434199634508*^9, {3.4745108208769827`*^9, 
   3.474510860691554*^9}, 3.47455940205621*^9, 3.474559477128915*^9, {
   3.474559565773801*^9, 3.47455956622327*^9}, {3.474559615747031*^9, 
   3.4745597146788054`*^9}, {3.474559781931891*^9, 3.4745598187918453`*^9}, {
   3.474559916666819*^9, 3.474559972348154*^9}, {3.4745600581336107`*^9, 
   3.47456025866566*^9}, {3.474560292949847*^9, 3.474560305445155*^9}, {
   3.4745603642977552`*^9, 3.47456042617058*^9}, {3.4745605022603483`*^9, 
   3.474560538827249*^9}, {3.474561315582438*^9, 3.4745613334127007`*^9}, {
   3.47456138838542*^9, 3.474561474009097*^9}, 3.474561520969119*^9, {
   3.474561572259851*^9, 3.4745615734420757`*^9}, {3.47456716299063*^9, 
   3.474567180804886*^9}, {3.4746360030228863`*^9, 3.474636232901005*^9}, {
   3.4746362632396393`*^9, 3.4746363688813667`*^9}, 3.474636404400099*^9, {
   3.47463648993288*^9, 3.474636524889522*^9}, {3.4746365884701433`*^9, 
   3.474636617888319*^9}, {3.474636655941196*^9, 3.474636770631431*^9}, {
   3.474636840482162*^9, 3.4746368878695173`*^9}, {3.474636934455508*^9, 
   3.4746370629159727`*^9}, {3.474637113436511*^9, 3.4746371353319273`*^9}, {
   3.4746371772216787`*^9, 3.474637190717061*^9}, {3.4746372285518093`*^9, 
   3.4746372369083633`*^9}, {3.474637370424692*^9, 3.474637374038106*^9}, {
   3.474637461618557*^9, 3.4746374667263803`*^9}, {3.474637595045268*^9, 
   3.474637733958274*^9}, {3.474637832609799*^9, 3.4746379480286293`*^9}, {
   3.474638292213546*^9, 3.4746382972129593`*^9}, {3.4746383307149467`*^9, 
   3.474638338471139*^9}, {3.474638444008801*^9, 3.474638447720133*^9}, {
   3.474638487564377*^9, 3.474638495831686*^9}, {3.4746385364844513`*^9, 
   3.474638547337124*^9}, {3.47463864553052*^9, 3.4746386469755774`*^9}, {
   3.474638694214245*^9, 3.474638778796165*^9}, {3.4746388320262623`*^9, 
   3.474638856852269*^9}, {3.4746389027407923`*^9, 3.4746389035047197`*^9}, {
   3.4746389623731728`*^9, 3.474639055236032*^9}, {3.474639105101036*^9, 
   3.474639180468409*^9}, {3.474639210562647*^9, 3.4746392232778797`*^9}, {
   3.474639266126135*^9, 3.47463930935682*^9}, {3.474639344871996*^9, 
   3.4746394726845083`*^9}, {3.474639573447508*^9, 3.474639602143301*^9}, {
   3.474639633336611*^9, 3.474639754003024*^9}, {3.474639793991919*^9, 
   3.474639794609741*^9}, 3.474639861357134*^9, 3.474639896190302*^9, {
   3.4746399298094797`*^9, 3.474639937374818*^9}, {3.474639974417882*^9, 
   3.474640019370792*^9}, {3.474640079625594*^9, 3.474640129091465*^9}, {
   3.4746401905088577`*^9, 3.47464019616154*^9}, {3.4746402577466173`*^9, 
   3.474640265301704*^9}, {3.474730637463091*^9, 3.4747307681682463`*^9}, {
   3.474730970972036*^9, 3.474730984404697*^9}, {3.474736637299944*^9, 
   3.474736667349901*^9}, 3.474736731434021*^9, {3.474736828855825*^9, 
   3.47473683957987*^9}, {3.4747368983097467`*^9, 3.474736936245699*^9}, {
   3.474736979204544*^9, 3.474737040373416*^9}, {3.474737087354521*^9, 
   3.47473709926822*^9}, {3.474737139892076*^9, 3.47473718794068*^9}, {
   3.474737225121763*^9, 3.474737360485519*^9}, {3.474737415110746*^9, 
   3.4747374231299963`*^9}, 3.4747374575942087`*^9, {3.47473749905442*^9, 
   3.474737499852167*^9}, {3.4747375366454773`*^9, 3.474737638377624*^9}, {
   3.474737682836349*^9, 3.4747377978128023`*^9}, {3.474748774313471*^9, 
   3.474748875322023*^9}, 3.474748943873068*^9, {3.474749000143903*^9, 
   3.474749020732389*^9}, {3.4747491155905237`*^9, 3.47474911576536*^9}, {
   3.474749693553694*^9, 3.474749792994059*^9}, {3.4747498342565327`*^9, 
   3.474749888136812*^9}, {3.474749931054597*^9, 3.4747500609635*^9}, {
   3.4747503577026176`*^9, 3.474750452131612*^9}, {3.474750491989485*^9, 
   3.4747505729650106`*^9}, {3.47475067988221*^9, 3.474750686038213*^9}, 
   3.4747507461189213`*^9, {3.4747508829155207`*^9, 3.4747508965597*^9}, 
   3.474750977431156*^9, {3.474751032281899*^9, 3.474751040353853*^9}, {
   3.474751088885783*^9, 3.474751198381418*^9}, {3.47477326777108*^9, 
   3.474773291986751*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Partition function definition: \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Z", "\[Rule]", 
    RowBox[{"IntegralOp", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", "[", "x", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["\[Psi]", "*"], "[", "x", "]"}], "}"}]}], "}"}], ",", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "S"}], "\[HBar]"]]}], "]"}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Z", "\[Rule]", 
    RowBox[{
     UnderscriptBox["\[Product]", "n"], 
     RowBox[{
      UnderscriptBox["\[Product]", "p"], 
      RowBox[{
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Im", "[", 
            SubscriptBox["Z", 
             RowBox[{"p", ",", "n"}]], "]"}], "}"}], "}"}], ",", 
         TagBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "CC"}], " ", 
            SuperscriptBox[
             RowBox[{"Im", "[", 
              SubscriptBox["Z", 
               RowBox[{"p", ",", "n"}]], "]"}], "2"]}], "]"}],
          HoldForm]}], "]"}], " ", 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Re", "[", 
            SubscriptBox["Z", 
             RowBox[{"p", ",", "n"}]], "]"}], "}"}], "}"}], ",", 
         TagBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "CC"}], " ", 
            SuperscriptBox[
             RowBox[{"Re", "[", 
              SubscriptBox["Z", 
               RowBox[{"p", ",", "n"}]], "]"}], "2"]}], "]"}],
          HoldForm]}], "]"}]}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\nProduct of Gaussian integrals:\"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Z", "\[Rule]", 
    RowBox[{"xProduct", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "x", "}"}], "}"}], ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "CC"}], " ", 
           SuperscriptBox["x", "2"]}]]}], "]"}], "2"], ",", "n", ",", "p"}], 
     "]"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Z", "\[Rule]", 
    RowBox[{"xProduct", "[", 
     RowBox[{
      FractionBox["\[Pi]", "CC"], ",", "n", ",", "p"}], "]"}]}]}],
  SequenceForm[
   Style["Partition function definition: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`Z -> $CellContext`IntegralOp[{{
       $CellContext`\[Psi][$CellContext`x]}, {
       Conjugate[$CellContext`\[Psi]][$CellContext`x]}}, 
     E^(Complex[0, 1] $CellContext`S/$CellContext`\[HBar])], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], $CellContext`Z -> 
   Product[$CellContext`IntegralOp[{{
         Im[
          Subscript[$CellContext`Z, $CellContext`p, $CellContext`n]]}}, 
       HoldForm[
        Exp[-$CellContext`CC Im[
            
            Subscript[$CellContext`Z, $CellContext`p, $CellContext`n]]^2]]] \
$CellContext`IntegralOp[{{
         Re[
          Subscript[$CellContext`Z, $CellContext`p, $CellContext`n]]}}, 
       HoldForm[
        Exp[-$CellContext`CC Re[
            
            Subscript[$CellContext`Z, $CellContext`p, $CellContext`n]]^2]]], \
$CellContext`n, $CellContext`p], 
   Style["\nProduct of Gaussian integrals:", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`Z -> \
$CellContext`xProduct[$CellContext`IntegralOp[{{$CellContext`x}}, 
       E^(-$CellContext`CC $CellContext`x^2)]^2, $CellContext`n, \
$CellContext`p], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`Z -> $CellContext`xProduct[$CellContext`CC^(-1) 
     Pi, $CellContext`n, $CellContext`p]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.474559791451383*^9, 3.47455981984581*^9}, 
   3.474559920840514*^9, 3.4745599781835747`*^9, 3.474560095880673*^9, 
   3.4745601280239773`*^9, {3.4745602144922523`*^9, 3.474560250259635*^9}, 
   3.474560312784586*^9, 3.474560428456635*^9, 3.474560539937701*^9, 
   3.474561336902656*^9, {3.474561441804991*^9, 3.4745614753522997`*^9}, 
   3.4745615223048487`*^9, 3.474561574699451*^9, 3.4745671820367537`*^9, 
   3.474635895995084*^9, 3.474636020765625*^9, 3.474636149208563*^9, 
   3.474636238702361*^9, {3.47463627588024*^9, 3.4746363152296553`*^9}, 
   3.4746363497347593`*^9, {3.474636379965479*^9, 3.4746364053721447`*^9}, 
   3.474636619488584*^9, 3.474636663791751*^9, {3.474636756506675*^9, 
   3.4746367719152403`*^9}, 3.474636892139292*^9, {3.4746370007393093`*^9, 
   3.474637037211916*^9}, 3.474637139197587*^9, 3.474637192697686*^9, 
   3.474637238689011*^9, 3.474637375408576*^9, 3.474637467957925*^9, {
   3.474637606672456*^9, 3.4746376360062*^9}, {3.4746376821719103`*^9, 
   3.474637737431017*^9}, {3.474637839034872*^9, 3.4746378667154827`*^9}, 
   3.474637908845292*^9, 3.474637954537277*^9, 3.474638340066906*^9, 
   3.474638449515481*^9, 3.4746384976284246`*^9, 3.474638548149619*^9, 
   3.474638648811894*^9, 3.4746387073581877`*^9, 3.4746387508776283`*^9, 
   3.474638789404821*^9, 3.4746388378450937`*^9, 3.4746389050376863`*^9, {
   3.474638988701394*^9, 3.474639048501511*^9}, 3.4746390793554564`*^9, 
   3.474639195920136*^9, {3.474639329649929*^9, 3.47463935436244*^9}, {
   3.474639453247847*^9, 3.47463947642068*^9}, {3.474639579012946*^9, 
   3.474639603387327*^9}, {3.4746397048209887`*^9, 3.4746397236365337`*^9}, 
   3.4746397553836317`*^9, 3.474639796074683*^9, 3.4746399017067947`*^9, 
   3.474639940469914*^9, {3.4746399791537237`*^9, 3.4746400210556498`*^9}, {
   3.474640111240588*^9, 3.474640136494975*^9}, 3.474640197365449*^9, 
   3.474640266212613*^9, 3.474730530457774*^9, {3.474730669607066*^9, 
   3.474730769441779*^9}, 3.474730985529147*^9, {3.47473665425987*^9, 
   3.4747366686965027`*^9}, 3.4747367325855227`*^9, 3.474736830211604*^9, 
   3.474736938612582*^9, 3.4747369827695093`*^9, {3.4747370234705057`*^9, 
   3.4747370362757463`*^9}, 3.474737105124587*^9, 3.47473714727103*^9, {
   3.474737180481213*^9, 3.474737189181355*^9}, {3.474737248772849*^9, 
   3.47473726055343*^9}, {3.474737316775297*^9, 3.47473736232941*^9}, 
   3.474737425107111*^9, 3.474737459749539*^9, {3.4747376035900507`*^9, 
   3.47473763966046*^9}, {3.474737706057425*^9, 3.4747377999368153`*^9}, 
   3.474748776848978*^9, 3.474748816213888*^9, {3.474748847904179*^9, 
   3.474748877388547*^9}, {3.474749006967525*^9, 3.474749022101411*^9}, {
   3.4747497008875637`*^9, 3.4747497234249487`*^9}, {3.474749761131971*^9, 
   3.4747497943342876`*^9}, {3.4747498366188583`*^9, 3.47474988971109*^9}, 
   3.474749946089818*^9, 3.4747500067376213`*^9, 3.474750063616662*^9, {
   3.474750435251152*^9, 3.474750460504589*^9}, {3.4747504950321608`*^9, 
   3.4747505181162252`*^9}, 3.474750574810402*^9, 3.474750688020915*^9, 
   3.4747508993778477`*^9, 3.474750979722983*^9, 3.474751045574107*^9, {
   3.474751121365705*^9, 3.474751165232067*^9}, 3.47475119988153*^9, {
   3.4747732744307756`*^9, 3.474773293339098*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"Mp2", " ", "\[Beta]"}]], "+", 
  FractionBox["1", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "n", " ", "\[Pi]"}], "+", 
    RowBox[{"Mp2", " ", "\[Beta]"}]}]], "+", 
  FractionBox["1", 
   RowBox[{
    RowBox[{"2", " ", "n", " ", "\[Pi]"}], "+", 
    RowBox[{"Mp2", " ", "\[Beta]"}]}]]}]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.474773293370564*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"Mp2", " ", "\[Beta]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "n", " ", "\[Pi]"}], "+", 
       RowBox[{"Mp2", " ", "\[Beta]"}]}]], "+", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"2", " ", "n", " ", "\[Pi]"}], "+", 
       RowBox[{"Mp2", " ", "\[Beta]"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.474773293488768*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "n", " ", "\[Pi]"}], "+", 
    RowBox[{"Mp2", " ", "\[Beta]"}]}]], "+", 
  FractionBox["1", 
   RowBox[{
    RowBox[{"2", " ", "n", " ", "\[Pi]"}], "+", 
    RowBox[{"Mp2", " ", "\[Beta]"}]}]]}]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.47477329350751*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[Pi]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["Mp2", "2"], " ", 
        SuperscriptBox["\[Beta]", "2"]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Pi]", "2"]}]]}], ")"}]}], 
   RowBox[{"Mp2", " ", "\[Beta]"}]]}]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.474773293538514*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"Mp2", " ", "\[Beta]"}]], "-", 
  FractionBox[
   RowBox[{"Mp2", " ", "\[Beta]"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Pi]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["Mp2", "2"], " ", 
        SuperscriptBox["\[Beta]", "2"]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Pi]", "2"]}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.474773293572378*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Mp2", "2"], " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Pi]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "2"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["Mp2", "2"], " ", 
        SuperscriptBox["\[Beta]", "2"]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Pi]", "2"]}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.474773293606008*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SqrtBox["3"]}], ")"}], " ", "Mp2", " ", "\[Beta]"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SqrtBox["3"], " ", "Mp2", " ", "\[Beta]"}]]}], ")"}]}], 
  RowBox[{
   SqrtBox["3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "Mp2", " ", "\[Beta]"}]]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{
  3.474737147302865*^9, {3.474737180516863*^9, 3.474737189218343*^9}, {
   3.474737248803997*^9, 3.474737260590622*^9}, {3.474737316806643*^9, 
   3.474737362359619*^9}, 3.474737425130425*^9, 3.474737459785163*^9, {
   3.474737603618105*^9, 3.474737639697729*^9}, {3.4747377060897207`*^9, 
   3.474737799976684*^9}, 3.4747487768766813`*^9, 3.474748816243272*^9, {
   3.474748847928244*^9, 3.474748877417378*^9}, {3.4747490069927263`*^9, 
   3.474749022131266*^9}, {3.474749700911579*^9, 3.474749723461265*^9}, {
   3.474749761164928*^9, 3.474749794360313*^9}, {3.47474983664108*^9, 
   3.47474988973549*^9}, 3.4747499461161222`*^9, 3.4747500067723417`*^9, 
   3.474750063639061*^9, {3.474750435288455*^9, 3.474750460507827*^9}, {
   3.474750495055471*^9, 3.4747505181399107`*^9}, 3.474750574814015*^9, 
   3.474750688041442*^9, 3.474750899404055*^9, 3.474750979748402*^9, 
   3.4747510456074343`*^9, {3.474751121390019*^9, 3.4747511652680473`*^9}, 
   3.474751199906138*^9, {3.474773274463829*^9, 3.474773293638562*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{740, 660},
WindowMargins->{{130, Automatic}, {Automatic, 0}},
ShowSelection->True,
InputAliases->{"bra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080BraArgs, Editable -> True, 
       Selectable -> True], "\[VerticalSeparator]"}], 
    Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False], 
  "braket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080BraArgs, Editable -> True, 
       Selectable -> True], "\[VerticalSeparator]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
       Selectable -> True], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080BraKet, Editable -> False, Selectable -> False], 
  "con" -> SuperscriptBox[
    RowBox[{"(", "\[Placeholder]", ")"}], "*"], "ebra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True], 
      "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> False, 
    Selectable -> False], "ebraket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True], 
      "\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080BraKet, Editable -> 
    False, Selectable -> False], "eebra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True], 
      "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> False, 
    Selectable -> False], "eebraket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True], 
      "\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080BraKet, Editable -> 
    False, Selectable -> False], "eeebra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True], 
      "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> False, 
    Selectable -> False], "eeebraket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True], 
      "\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080BraKet, Editable -> 
    False, Selectable -> False], "eeeket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> False, 
    Selectable -> False], "eeeketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True],
         "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> 
      False, Selectable -> False], "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True],
         "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> 
      False, Selectable -> False]}], "eeket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> False, 
    Selectable -> False], "eeketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True],
         "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> 
      False, Selectable -> False], "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True],
         "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> 
      False, Selectable -> False]}], "eket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> False, 
    Selectable -> False], "eketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], 
         Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True],
         "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> 
      False, Selectable -> False], "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], 
         Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True],
         "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> 
      False, Selectable -> False]}], "eval" -> 
  SubscriptBox["\[Placeholder]", 
    OverscriptBox["\[Placeholder]", "^"]], "her" -> SuperscriptBox[
    RowBox[{"(", "\[Placeholder]", ")"}], "\[Dagger]"], "ket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
       Selectable -> True], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False], 
  "ketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
        "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
         Selectable -> True], "\[RightAngleBracket]"}], 
      Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False], 
     "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
        "\[Placeholder]", Quantum`Notation`zz080BraArgs, Editable -> True, 
         Selectable -> True], "\[VerticalSeparator]"}], 
      Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False]}], 
  "ketdef" -> RowBox[{"\[Placeholder]", "/:", 
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
        "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
         Selectable -> True], "\[RightAngleBracket]"}], 
      Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False], "=",
      "\[Placeholder]"}], "norm" -> 
  RowBox[{"\[LeftDoubleBracketingBar]", "\[Placeholder]", 
     "\[RightDoubleBracketingBar]"}], "on" -> "\[CenterDot]", "op" -> 
  OverscriptBox["\[Placeholder]", "^"], "tp" -> "\[CircleTimes]", "tr" -> 
  RowBox[{
     SubscriptBox["Tr", 
      TagBox[
       OverscriptBox["\[Placeholder]", "^"], Quantum`Notation`zz080TrArgs]], 
     "[", "\[Placeholder]", "]"}]},
Magnification->1.25,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 91, 1, 35, "Text"],
Cell[639, 23, 526, 9, 50, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[1168, 34, 359, 6, 36, "Text"],
Cell[CellGroupData[{
Cell[1552, 44, 2917, 64, 257, "Input"],
Cell[4472, 110, 5431, 144, 150, "Print"]
}, Open  ]],
Cell[9918, 257, 749, 14, 37, "Text"],
Cell[CellGroupData[{
Cell[10692, 275, 11444, 282, 888, "Input"],
Cell[22139, 559, 16339, 410, 700, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38515, 974, 885, 25, 108, "Input"],
Cell[39403, 1001, 4634, 130, 365, "Output"],
Cell[44040, 1133, 4405, 125, 333, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48482, 1263, 2491, 61, 203, "Input"],
Cell[50976, 1326, 1994, 48, 80, "Print"]
}, Open  ]],
Cell[52985, 1377, 215, 4, 36, "Text"],
Cell[CellGroupData[{
Cell[53225, 1385, 17129, 389, 984, "Input"],
Cell[70357, 1776, 8360, 187, 257, "Print"],
Cell[78720, 1965, 1409, 27, 53, "Output"],
Cell[80132, 1994, 1463, 28, 53, "Output"],
Cell[81598, 2024, 1345, 25, 53, "Output"],
Cell[82946, 2051, 1465, 29, 73, "Output"],
Cell[84414, 2082, 1523, 31, 72, "Output"],
Cell[85940, 2115, 1522, 31, 76, "Output"],
Cell[87465, 2148, 1769, 39, 79, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
