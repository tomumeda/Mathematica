(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    134346,       3924]
NotebookOptionsPosition[    129251,       3767]
NotebookOutlinePosition[    129689,       3786]
CellTagsIndexPosition[    129646,       3783]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Doing Full Spectrum Physics", "Title"],

Cell["Three Aspects of Geometry", "Subtitle"],

Cell[TextData[{
 "Misner, Thorne & Wheeler, ",
 StyleBox["Gravitation",
  FontSlant->"Italic"],
 ",",
 " Section 8.3"
}], "Chaptertitle"],

Cell[CellGroupData[{

Cell["David Park, djmp@earthlink.net", "Subsubtitle"],

Cell[TextData[{
 "Misner, Thorne and Wheeler teach that we will have full power to do and \
communicate geometry and physics if this power \"can be exercised in three \
ways: in pictures, in abstract notation and in component notation.\"  With ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " and a proper suite of packages to close the gap between ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s basic power and the practice of mathematical physics we can do this - \
and better. We can also have active mathematical objects, incorporate units, \
and we can even bring solutions and diagrams alive with animation. This is \
what I call being able to do ",
 StyleBox["full spectrum physics",
  FontSlant->"Italic"],
 " within a single computer platform."
}], "Text"],

Cell[CellGroupData[{

Cell["Initiation", "Section"],

Cell[TextData[{
 "The following are a suite of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " packages that allow us to conveniently do physics."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<Miscellaneous`PhysicalConstants`\>\"", 
  "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<Units`ExtendUnits`\>\"", "]"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Get", "::", "\<\"noopen\"\>"}], ":", 
   " ", "\<\"Cannot open \
\\!\\(TraditionalForm\\`\\\"Units`ExtendUnits`\\\"\\). \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/noopen\\\", \
ButtonNote -> \\\"Get::noopen\\\"]\\)\"\>"}], TraditionalForm]], "Message",
 CellChangeTimes->{{3.417541086445615*^9, 3.417541088443465*^9}, {
  3.4175411469245243`*^9, 3.417541148912657*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Needs", "::", "\<\"nocont\"\>"}], ":", 
   " ", "\<\"Context \\!\\(TraditionalForm\\`\\\"Units`ExtendUnits`\\\"\\) \
was not created when Needs was evaluated. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Needs/nocont\\\", ButtonNote -> \
\\\"Needs::nocont\\\"]\\)\"\>"}], TraditionalForm]], "Message",
 CellChangeTimes->{{3.417541086445615*^9, 3.417541088443465*^9}, {
  3.4175411469245243`*^9, 3.4175411489155397`*^9}}],

Cell[BoxData[
 FormBox["$Failed", TraditionalForm]], "Output",
 CellChangeTimes->{{3.417541087768458*^9, 3.417541088448061*^9}, {
  3.417541148202948*^9, 3.417541148917327*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<TensorCalculus4V6`Tensorial`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<DrawGraphics`DrawingMaster`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<Cardano3`ComplexGraphics`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4175411105577087`*^9, 3.4175411110447083`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Get", "::", "\<\"noopen\"\>"}], ":", 
   " ", "\<\"Cannot open \
\\!\\(TraditionalForm\\`\\\"DrawGraphics`DrawingMaster`\\\"\\). \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/noopen\\\", \
ButtonNote -> \\\"Get::noopen\\\"]\\)\"\>"}], TraditionalForm]], "Message", \
"MSG",
 CellChangeTimes->{{3.4175410879013233`*^9, 3.417541113788014*^9}, {
  3.4175411484482718`*^9, 3.417541159047578*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Needs", "::", "\<\"nocont\"\>"}], ":", 
   " ", "\<\"Context \
\\!\\(TraditionalForm\\`\\\"DrawGraphics`DrawingMaster`\\\"\\) was not \
created when Needs was evaluated. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Needs/nocont\\\", \
ButtonNote -> \\\"Needs::nocont\\\"]\\)\"\>"}], TraditionalForm]], "Message", \
"MSG",
 CellChangeTimes->{{3.4175410879013233`*^9, 3.417541113788014*^9}, {
  3.4175411484482718`*^9, 3.41754115905191*^9}}],

Cell[BoxData[
 FormBox["$Failed", TraditionalForm]], "Output",
 CellChangeTimes->{{3.417541087932473*^9, 3.4175411142926273`*^9}, {
  3.417541148538612*^9, 3.417541159053824*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Get", "::", "\<\"noopen\"\>"}], ":", 
   " ", "\<\"Cannot open \
\\!\\(TraditionalForm\\`\\\"Cardano3`ComplexGraphics`\\\"\\). \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/noopen\\\", \
ButtonNote -> \\\"Get::noopen\\\"]\\)\"\>"}], TraditionalForm]], "Message", \
"MSG",
 CellChangeTimes->{{3.4175410879013233`*^9, 3.417541113788014*^9}, {
  3.4175411484482718`*^9, 3.417541159057963*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"Needs", "::", "\<\"nocont\"\>"}], ":", 
   " ", "\<\"Context \
\\!\\(TraditionalForm\\`\\\"Cardano3`ComplexGraphics`\\\"\\) was not created \
when Needs was evaluated. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Needs/nocont\\\", ButtonNote -> \
\\\"Needs::nocont\\\"]\\)\"\>"}], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.4175410879013233`*^9, 3.417541113788014*^9}, {
  3.4175411484482718`*^9, 3.4175411590599527`*^9}}],

Cell[BoxData[
 FormBox["$Failed", TraditionalForm]], "Output",
 CellChangeTimes->{{3.417541087932473*^9, 3.4175411142926273`*^9}, {
  3.417541148538612*^9, 3.41754115906122*^9}}]
}, Open  ]],

Cell[TextData[{
 "We are going to derive and solve the equations for planetary motion in \
polar coordinates. The following statements establish conditions for the ",
 StyleBox["Tensorial",
  FontSlant->"Italic"],
 " tensor calculus package. We define tensor shortcuts for the basis vectors ",
 Cell[BoxData["e"]],
 ", the velocity vector ",
 Cell[BoxData["v"]],
 ", and the coordinate positions ",
 Cell[BoxData["x"]],
 ". Since we will be using an orthonormal polar frame we use red indices to \
remind us that we are not working in a coordinate basis. Finally, we declare \
a 2-dimensional system with base indices corresponding the to coordinate \
symbols."
}], "Text"],

Cell[BoxData[{
 RowBox[{"DefineTensorShortcuts", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"e", ",", "v", ",", "x"}], "}"}], ",", "1"}], "}"}], "]"}], "\n", 
 RowBox[{"DeclareIndexFlavor", "[", 
  RowBox[{"{", 
   RowBox[{"red", ",", "Red"}], "}"}], "]"}], "\n", 
 RowBox[{"DeclareBaseIndices", "[", 
  RowBox[{"{", 
   RowBox[{"r", ",", "\[Phi]"}], "}"}], "]"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Abstract, Pictorial and Component Form of Keplerian Orbit Physics\
\>", "Section"],

Cell["\<\
We have the following general symbolic expression for the velocity of a \
planet, which we will take to be in a Keplerian orbit,\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "\[Equal]", 
   RowBox[{
    RowBox[{"vu", "[", "a", "]"}], 
    RowBox[{"ed", "[", "a", "]"}]}]}], "//", 
  RowBox[{"ToFlavor", "[", "red", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", "[", 
   RowBox[{"8", ",", "1"}], "]"}], "=", 
  RowBox[{"%", "//", 
   RowBox[{"EinsteinSum", "[", "]"}]}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"v", "\[LongEqual]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["e", 
      FormBox[
       StyleBox["a",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       TraditionalForm], 
      StyleBox[
       FormBox[
        StyleBox["a",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm],
       StripOnInput->False,
       ShowContents->False]],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
      TensorCalculus4V6`Tensorial`Void}, {
       $CellContext`red[$CellContext`a]}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], " ", 
    InterpretationBox[
     SubsuperscriptBox["v", 
      StyleBox[
       FormBox[
        StyleBox["a",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm],
       StripOnInput->False,
       ShowContents->False], 
      FormBox[
       StyleBox["a",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       TraditionalForm]],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
       $CellContext`red[$CellContext`a]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.41754117243311*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"v", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`r]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`\[Phi]]}, {
       TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.41754117246107*^9}]
}, Open  ]],

Cell[TextData[{
 "where the red flavor indicates we are working in an orthonormal frame where \
the ",
 Cell[BoxData["e"]],
 " are unit vectors."
}], "Text"],

Cell["\<\
The acceleration is obtained by taking the total derivative with respect to \
time.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TotalD", "[", 
  RowBox[{
   RowBox[{"eqn", "[", 
    RowBox[{"8", ",", "1"}], "]"}], ",", "t"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", "[", 
   RowBox[{"8", ",", "2"}], "]"}], "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"TotalD", "[", 
     RowBox[{"v", ",", "t"}], "]"}], "\[Rule]", "a"}]}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", "v"}], 
    RowBox[{"\[DifferentialD]", "t"}],
    MultilineFunction->None], "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`r]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`r]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`r]}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`\[Phi]]}, {
       TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`\[Phi]]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`\[Phi]]}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`r]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`r]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`\[Phi]]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`\[Phi]]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543615589761*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`r]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`r]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`r]}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`\[Phi]]}, {
       TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`\[Phi]]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`\[Phi]]}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`r]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`r]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`\[Phi]]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`\[Phi]]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543615627675*^9}]
}, Open  ]],

Cell["\<\
A diagram for the planet's motion is as follows. (Evaluate the thin close \
cell for the diagram. Open the cell with Alt-CRC to examine the graphics \
code.)\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "pts", ",", "orbit", ",", "sun", ",", "ptA", ",", "ptB", ",", "avector", 
      ",", "vvector", ",", "erA", ",", "e\[Phi]A", ",", "erB", ",", 
      "e\[Phi]B", ",", "drawarrow"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pts", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2.27893", ",", "7.1413"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.17476", ",", "6.90056"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.85995", ",", "6.53945"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7.78588", ",", "6.08806"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9.53125", ",", "5.60658"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11.3669", ",", "4.85426"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13.1725", ",", "3.8913"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbit", "=", 
      RowBox[{"SplineToLine", "[", 
       RowBox[{"pts", ",", "Bezier", ",", " ", "20"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drawvector", "[", 
       RowBox[{"start_", ",", "vector_"}], "]"}], ":=", 
      RowBox[{"Arrow", "[", 
       RowBox[{"start", ",", 
        RowBox[{"start", "+", "vector"}], ",", 
        RowBox[{"HeadScaling", "\[Rule]", "Relative"}], ",", 
        RowBox[{"HeadCenter", "\[Rule]", "0.5"}], ",", 
        RowBox[{"HeadLength", "\[Rule]", "0.2"}], ",", 
        RowBox[{"HeadWidth", "\[Rule]", "0.75"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sun", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ptA", "=", 
      RowBox[{"{", 
       RowBox[{"8.17142", ",", "5.92416"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ptB", "=", 
      RowBox[{"{", 
       RowBox[{"3.61412", ",", "6.98325"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"erA", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"#", "/", 
          SqrtBox[
           RowBox[{"#", ".", "#"}]]}]}], "&"}], "[", "ptA", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e\[Phi]A", "=", 
      RowBox[{"ToCoordinates", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
        RowBox[{"ToComplex", "[", "erA", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"erB", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"#", "/", 
          SqrtBox[
           RowBox[{"#", ".", "#"}]]}]}], "&"}], "[", "ptB", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e\[Phi]B", "=", 
      RowBox[{"ToCoordinates", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
        RowBox[{"ToComplex", "[", "erB", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"avector", "=", 
      RowBox[{"-", "erA"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vvector", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"3", 
         RowBox[{"#", "/", 
          SqrtBox[
           RowBox[{"#", ".", "#"}]]}]}], "&"}], "[", 
       RowBox[{
        RowBox[{"1.05", "ptB"}], "-", "ptA"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Draw2D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"orbit", ",", "\[IndentingNewLine]", "Gray", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"sun", ",", "ptA"}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"sun", ",", "ptB"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"sun", ",", 
            RowBox[{"{", 
             RowBox[{"5", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AngleArc", "[", 
          RowBox[{"sun", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"ArcTan", "@@", "ptA"}]}], "}"}], ",", "3", ",", 
           RowBox[{"StyleForm", "[", 
            RowBox[{"\"\<\[Phi]\>\"", ",", 
             RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Unit", " ", "basis", " ", "vectors"}], " ", "*)"}], 
         "\[IndentingNewLine]", "VenetianRed", ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptA", ",", "erA"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptA", ",", "e\[Phi]A"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptB", ",", "erB"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptB", ",", "e\[Phi]B"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ColorMix", "[", 
           RowBox[{"VenetianRed", ",", "White"}], "]"}], "[", "0.7", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptB", ",", "erA"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptB", ",", "e\[Phi]A"}], "]"}], ",", "\[IndentingNewLine]",
          "Chartreuse", ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{
           RowBox[{"ptB", "+", "erA"}], ",", 
           RowBox[{"erB", "-", "erA"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{
           RowBox[{"ptB", "+", "e\[Phi]A"}], ",", 
           RowBox[{"e\[Phi]B", "-", "e\[Phi]A"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Acceleration", " ", "and", " ", "velocity", " ", "vectors"}], " ", 
          "*)"}], "\[IndentingNewLine]", "Black", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptA", ",", "avector"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"drawvector", "[", 
          RowBox[{"ptA", ",", "vvector"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Points", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"CirclePoint", "[", 
          RowBox[{"sun", ",", "5", ",", " ", "Black", ",", "Gold"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"CirclePoint", "[", 
          RowBox[{"ptA", ",", "3", ",", " ", "Black", ",", "Blue"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"CirclePoint", "[", 
          RowBox[{"ptB", ",", "3", ",", " ", "Black", ",", "Blue"}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Text", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]",
          "Black", ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<r\>\"", ",", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "ptA"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<a\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"7.59905", ",", "5.08459"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<v\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"6.29826", ",", "7.00155"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"ed", "[", 
            RowBox[{"red", "@", "r"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"10.0979", ",", "7.30964"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"ed", "[", 
            RowBox[{"red", "@", "\[Phi]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"7.01712", ",", "7.89157"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"TotalD", "[", 
            RowBox[{
             RowBox[{"ed", "[", 
              RowBox[{"red", "@", "r"}], "]"}], ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"5.40824", ",", "8.74736"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"TotalD", "[", 
            RowBox[{
             RowBox[{"ed", "[", 
              RowBox[{"red", "@", "\[Phi]"}], "]"}], ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.57431", ",", "8.78159"}], "}"}]}], "]"}]}], "}"}], ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "15"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Keplerian Orbit in Polar Coordinates\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", "BlanchedAlmond"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellOpen->False],

Cell[TextData[{
 "The orthonormal basis vectors are shown in red. As the planet moves the \
basis vectors rotate and the rate of rotation is just the rate of change of ",
 Cell[BoxData["\[Phi]"]],
 ". This is, in fact, the advantage of using an orthonormal frame. We can \
express this by the following rules. We also write the rules for the red \
velocity components in terms of the coordinates."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqn", "[", 
   RowBox[{"8", ",", "3"}], "]"}], "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalD", "[", 
      RowBox[{
       RowBox[{"ed", "[", 
        RowBox[{"red", "@", "r"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
     RowBox[{"\[Omega]", " ", 
      RowBox[{"ed", "[", 
       RowBox[{"red", "@", "\[Phi]"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"TotalD", "[", 
      RowBox[{
       RowBox[{"ed", "[", 
        RowBox[{"red", "@", "\[Phi]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "\[Omega]"}], " ", 
      RowBox[{"ed", "[", 
       RowBox[{"red", "@", "r"}], "]"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Omega]rule", "=", 
  RowBox[{"\[Omega]", "\[Rule]", 
   RowBox[{"TotalD", "[", 
    RowBox[{
     RowBox[{"xu", "[", "\[Phi]", "]"}], ",", "t"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"vrules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"vu", "[", 
      RowBox[{"red", "@", "r"}], "]"}], "\[Rule]", 
     RowBox[{"TotalD", "[", 
      RowBox[{
       RowBox[{"xu", "[", "r", "]"}], ",", "t"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"vu", "[", 
      RowBox[{"red", "@", "\[Phi]"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"xu", "[", "r", "]"}], 
      RowBox[{"TotalD", "[", 
       RowBox[{
        RowBox[{"xu", "[", "\[Phi]", "]"}], ",", "t"}], "]"}]}]}]}], 
   "}"}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`r]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`r]}], $CellContext`t]], "\[Rule]", 
     RowBox[{"\[Omega]", " ", 
      InterpretationBox[
       SubsuperscriptBox["e", 
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm], 
        StyleBox[
         FormBox[
          StyleBox["\[Phi]",
           StripOnInput->False,
           FontColor->RGBColor[1, 0, 0]],
          TraditionalForm],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`\[Phi]]}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}]}], ",", 
    RowBox[{
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`\[Phi]]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`\[Phi]]}], $CellContext`t]], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "\[Omega]"}], " ", 
      InterpretationBox[
       SubsuperscriptBox["e", 
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm], 
        StyleBox[
         FormBox[
          StyleBox["r",
           StripOnInput->False,
           FontColor->RGBColor[1, 0, 0]],
          TraditionalForm],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`r]}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.417543628782935*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Omega]", "\[Rule]", 
   InterpretationBox[
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      InterpretationBox[
       SubsuperscriptBox["x", 
        StyleBox["\[Phi]",
         StripOnInput->False,
         ShowContents->False], "\[Phi]"],
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], 
     RowBox[{"\[DifferentialD]", "t"}]],
    TensorCalculus4V6`Tensorial`TotalD[
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {
      TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543628834896*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`r]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], "\[Rule]", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], ",", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`\[Phi]]}, {
       TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], "\[Rule]", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["x", 
        StyleBox["r",
         StripOnInput->False,
         ShowContents->False], "r"],
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, {
        TensorCalculus4V6`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      InterpretationBox[
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         InterpretationBox[
          SubsuperscriptBox["x", 
           StyleBox["\[Phi]",
            StripOnInput->False,
            ShowContents->False], "\[Phi]"],
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], 
        RowBox[{"\[DifferentialD]", "t"}]],
       TensorCalculus4V6`Tensorial`TotalD[
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543628902007*^9}]
}, Open  ]],

Cell["\<\
We then use these rules to substitute into equation 8.2, rearrange, and \
substitute coordinate expressions to obtain the components of the \
acceleration.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eqn", "[", 
  RowBox[{"8", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Substitute the rate of change of the basis vectors\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"%%", "/.", 
  RowBox[{"eqn", "[", 
   RowBox[{"8", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Collect terms in the two directions\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", "[", 
   RowBox[{"8", ",", "4"}], "]"}], "=", 
  RowBox[{"MapAt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"ed", "[", 
         RowBox[{"red", "@", "a"}], "]"}], "//", 
        RowBox[{"ToArrayValues", "[", "]"}]}]}], "]"}], "&"}], ",", "%%", ",",
     "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Substitute the velocity and \[Omega] expressions\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"equation1", "=", 
  RowBox[{
   RowBox[{"%%", "/.", "vrules"}], "/.", 
   "\[Omega]rule"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Substitute coordinates as functions of t\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", "[", 
   RowBox[{"8", ",", "4"}], "]"}], "=", 
  RowBox[{"%%", "//", 
   RowBox[{"UseCoordinates", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "[", "t", "]"}], ",", 
      RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}], "]"}]}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`r]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`r]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`r]}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`\[Phi]]}, {
       TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["e", 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm], 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
          TensorCalculus4V6`Tensorial`Void}, {
           $CellContext`red[$CellContext`\[Phi]]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`\[Phi]]}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`r]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`r]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`\[Phi]]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`\[Phi]]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.4175436431003523`*^9}],

Cell[BoxData[
 FormBox["\<\"Substitute the rate of change of the basis vectors\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.417543643135523*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{"\[Omega]", " ", 
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`r]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "-", 
    RowBox[{"\[Omega]", " ", 
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["v", 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False], 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
        $CellContext`red[$CellContext`\[Phi]]}, {
       TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`r]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`r]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`\[Phi]]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], 
       RowBox[{"\[DifferentialD]", "t"}]],
      TensorCalculus4V6`Tensorial`TotalD[
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
         $CellContext`red[$CellContext`\[Phi]]}, {
        TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543643203828*^9}],

Cell[BoxData[
 FormBox["\<\"Collect terms in the two directions\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.417543643251004*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        FractionBox[
         RowBox[{"\[DifferentialD]", 
          InterpretationBox[
           SubsuperscriptBox["v", 
            StyleBox[
             FormBox[
              StyleBox["r",
               StripOnInput->False,
               FontColor->RGBColor[1, 0, 0]],
              TraditionalForm],
             StripOnInput->False,
             ShowContents->False], 
            FormBox[
             StyleBox["r",
              StripOnInput->False,
              FontColor->RGBColor[1, 0, 0]],
             TraditionalForm]],
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
             $CellContext`red[$CellContext`r]}, {
            TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`r]}, {
          TensorCalculus4V6`Tensorial`Void}], $CellContext`t]], "-", 
       RowBox[{"\[Omega]", " ", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["\[Phi]",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`\[Phi]]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]", " ", 
        InterpretationBox[
         SubsuperscriptBox["v", 
          StyleBox[
           FormBox[
            StyleBox["r",
             StripOnInput->False,
             FontColor->RGBColor[1, 0, 0]],
            TraditionalForm],
           StripOnInput->False,
           ShowContents->False], 
          FormBox[
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]],
           TraditionalForm]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`r]}, {
          TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       InterpretationBox[
        FractionBox[
         RowBox[{"\[DifferentialD]", 
          InterpretationBox[
           SubsuperscriptBox["v", 
            StyleBox[
             FormBox[
              StyleBox["\[Phi]",
               StripOnInput->False,
               FontColor->RGBColor[1, 0, 0]],
              TraditionalForm],
             StripOnInput->False,
             ShowContents->False], 
            FormBox[
             StyleBox["\[Phi]",
              StripOnInput->False,
              FontColor->RGBColor[1, 0, 0]],
             TraditionalForm]],
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
             $CellContext`red[$CellContext`\[Phi]]}, {
            TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`v, {
           $CellContext`red[$CellContext`\[Phi]]}, {
          TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], ")"}]}]}]}],
   TraditionalForm]], "Output",
 CellChangeTimes->{3.417543643304823*^9}],

Cell[BoxData[
 FormBox["\<\"Substitute the velocity and \[Omega] expressions\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.417543643347452*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        FractionBox[
         RowBox[{
          SuperscriptBox["\[DifferentialD]", "2"], 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["r",
             StripOnInput->False,
             ShowContents->False], "r"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, $CellContext`t}],
        Editable->False], "-", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        FormBox[
         TagBox[
          SuperscriptBox[
           RowBox[{"(", 
            FormBox[
             InterpretationBox[
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                InterpretationBox[
                 SubsuperscriptBox["x", 
                  StyleBox["\[Phi]",
                   StripOnInput->False,
                   ShowContents->False], "\[Phi]"],
                 
                 TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]}], 
               RowBox[{"\[DifferentialD]", "t"}]],
              TensorCalculus4V6`Tensorial`TotalD[
               
               TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]],
             TraditionalForm], ")"}], "2"],
          DisplayForm],
         TraditionalForm]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["r",
              StripOnInput->False,
              ShowContents->False], "r"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["\[DifferentialD]", "2"], 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {
           TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, \
$CellContext`t}],
         Editable->False]}]}], ")"}]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.4175436434059143`*^9}],

Cell[BoxData[
 FormBox["\<\"Substitute coordinates as functions of t\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.417543643468547*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["r", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        RowBox[{"r", "(", "t", ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "(", "t", ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["r", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}], "+", 
       RowBox[{
        RowBox[{"r", "(", "t", ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543643529005*^9}]
}, Open  ]],

Cell[TextData[{
 "This is equivalent to the MTW equation 8.4.  MTW use the following \
equivalent expression for the ",
 Cell[BoxData["\[Phi]"]],
 " component. ",
 Cell[BoxData["HoldOp"]],
 " is a ",
 StyleBox["Tensorial",
  FontSlant->"Italic"],
 " command that allows us to delay certain operations that would otherwise be \
automatically performed."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], ",", "t"}], "]"}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "'"}], "[", "t", "]"}], 
    RowBox[{
     RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}]}], "//", 
  RowBox[{"HoldOp", "[", "D", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ReleaseHold"}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{
   TagBox[
    FractionBox[
     RowBox[{"\[PartialD]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "(", "t", ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}], ")"}]}], 
     RowBox[{"\[PartialD]", "t"}],
     MultilineFunction->None],
    HoldForm], "+", 
   RowBox[{
    RowBox[{
     SuperscriptBox["r", "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.4175436571476316`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{
     SuperscriptBox["r", "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}], "+", 
   RowBox[{
    RowBox[{"r", "(", "t", ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417543657201388*^9}]
}, Open  ]],

Cell["\<\
Why don't we go further and actually solve the equations and graphically \
represent the solutions? We do this in the next section. \
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Units, Solutions and Graphical Representations", "Section"],

Cell[TextData[{
 "Let's solve the orbit equations for the planet earth. We write the \
acceleration on the rhs and then derive the differential equations for ",
 Cell[BoxData["r"]],
 " and ",
 Cell[BoxData["\[Phi]"]],
 "."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"r", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"AU", ",", "Year"}], "}"}], ",", "Constant"}], 
  "]"}], "\[IndentingNewLine]", "equation1", "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Write acceleration on lhs for gravitational force.\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"%%", "/.", 
  RowBox[{"a", "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"ed", "[", 
      RowBox[{"red", "@", "r"}], "]"}]}], "G", " ", 
    RowBox[{"M", "/", 
     SuperscriptBox[
      RowBox[{"xu", "[", "r", "]"}], "2"]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Rearrange and collect terms\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "-", 
      RowBox[{"First", "[", "%%", "]"}]}], "&"}], "/@", "%%"}], "//", 
   "Reverse"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"step1", "=", 
  RowBox[{"MapAt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"ed", "[", 
         RowBox[{"red", "@", "a"}], "]"}], "//", 
        RowBox[{"EinsteinArray", "[", "]"}]}]}], "]"}], "&"}], ",", "%", ",", 
    "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Each of the components must be zero\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"First", "@", "step1"}], ",", 
     RowBox[{
      RowBox[{"ed", "[", 
       RowBox[{"red", "@", "a"}], "]"}], "//", 
      RowBox[{"EinsteinArray", "[", "]"}]}]}], "]"}], "\[Equal]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "//", "Thread"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Convert to Mathematica differential equations by substituting \
coordinate expressions.\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"diffeqns0", "=", 
  RowBox[{"%%", "//", 
   RowBox[{"UseCoordinates", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "[", "t", "]"}], ",", 
      RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}], "]"}]}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"a", "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        FractionBox[
         RowBox[{
          SuperscriptBox["\[DifferentialD]", "2"], 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["r",
             StripOnInput->False,
             ShowContents->False], "r"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, $CellContext`t}],
        Editable->False], "-", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        FormBox[
         TagBox[
          SuperscriptBox[
           RowBox[{"(", 
            FormBox[
             InterpretationBox[
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                InterpretationBox[
                 SubsuperscriptBox["x", 
                  StyleBox["\[Phi]",
                   StripOnInput->False,
                   ShowContents->False], "\[Phi]"],
                 
                 TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]}], 
               RowBox[{"\[DifferentialD]", "t"}]],
              TensorCalculus4V6`Tensorial`TotalD[
               
               TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]],
             TraditionalForm], ")"}], "2"],
          DisplayForm],
         TraditionalForm]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["r",
              StripOnInput->False,
              ShowContents->False], "r"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["\[DifferentialD]", "2"], 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {
           TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, \
$CellContext`t}],
         Editable->False]}]}], ")"}]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.41754417726956*^9}],

Cell[BoxData[
 FormBox["\<\"Write acceleration on lhs for gravitational force.\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.417544177299903*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"G", " ", "M", " ", 
      InterpretationBox[
       SubsuperscriptBox["e", 
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm], 
        StyleBox[
         FormBox[
          StyleBox["r",
           StripOnInput->False,
           FontColor->RGBColor[1, 0, 0]],
          TraditionalForm],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus4V6`Tensorial`Void}, {
         $CellContext`red[$CellContext`r]}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], 
     FormBox[
      TagBox[
       SuperscriptBox[
        RowBox[{"(", 
         FormBox[
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["r",
             StripOnInput->False,
             ShowContents->False], "r"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False],
          TraditionalForm], ")"}], "2"],
       DisplayForm],
      TraditionalForm]]}], "\[LongEqual]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        FractionBox[
         RowBox[{
          SuperscriptBox["\[DifferentialD]", "2"], 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["r",
             StripOnInput->False,
             ShowContents->False], "r"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, $CellContext`t}],
        Editable->False], "-", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        FormBox[
         TagBox[
          SuperscriptBox[
           RowBox[{"(", 
            FormBox[
             InterpretationBox[
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                InterpretationBox[
                 SubsuperscriptBox["x", 
                  StyleBox["\[Phi]",
                   StripOnInput->False,
                   ShowContents->False], "\[Phi]"],
                 
                 TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]}], 
               RowBox[{"\[DifferentialD]", "t"}]],
              TensorCalculus4V6`Tensorial`TotalD[
               
               TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]],
             TraditionalForm], ")"}], "2"],
          DisplayForm],
         TraditionalForm]}]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["r",
              StripOnInput->False,
              ShowContents->False], "r"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["\[DifferentialD]", "2"], 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {
           TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, \
$CellContext`t}],
         Editable->False]}]}], ")"}]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.4175441773696003`*^9}],

Cell[BoxData[
 FormBox["\<\"Rearrange and collect terms\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.417544177432419*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["r",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["r",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`r]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          SubsuperscriptBox["x", 
           StyleBox["r",
            StripOnInput->False,
            ShowContents->False], "r"],
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], " ", 
        FormBox[
         TagBox[
          SuperscriptBox[
           RowBox[{"(", 
            FormBox[
             InterpretationBox[
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                InterpretationBox[
                 SubsuperscriptBox["x", 
                  StyleBox["\[Phi]",
                   StripOnInput->False,
                   ShowContents->False], "\[Phi]"],
                 
                 TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]}], 
               RowBox[{"\[DifferentialD]", "t"}]],
              TensorCalculus4V6`Tensorial`TotalD[
               
               TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]],
             TraditionalForm], ")"}], "2"],
          DisplayForm],
         TraditionalForm]}], "+", 
       InterpretationBox[
        FractionBox[
         RowBox[{
          SuperscriptBox["\[DifferentialD]", "2"], 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["r",
             StripOnInput->False,
             ShowContents->False], "r"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, $CellContext`t}],
        Editable->False], "+", 
       FractionBox[
        RowBox[{"G", " ", "M"}], 
        FormBox[
         TagBox[
          SuperscriptBox[
           RowBox[{"(", 
            FormBox[
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["r",
                StripOnInput->False,
                ShowContents->False], "r"],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False],
             TraditionalForm], ")"}], "2"],
          DisplayForm],
         TraditionalForm]]}], ")"}]}], "+", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["e", 
       FormBox[
        StyleBox["\[Phi]",
         StripOnInput->False,
         FontColor->RGBColor[1, 0, 0]],
        TraditionalForm], 
       StyleBox[
        FormBox[
         StyleBox["\[Phi]",
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]],
         TraditionalForm],
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus4V6`Tensorial`Void}, {
        $CellContext`red[$CellContext`\[Phi]]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["r",
              StripOnInput->False,
              ShowContents->False], "r"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{"\[DifferentialD]", 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["\[DifferentialD]", "2"], 
           InterpretationBox[
            SubsuperscriptBox["x", 
             StyleBox["\[Phi]",
              StripOnInput->False,
              ShowContents->False], "\[Phi]"],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
         TensorCalculus4V6`Tensorial`TotalD[
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {
           TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, \
$CellContext`t}],
         Editable->False]}]}], ")"}]}]}], "\[LongEqual]", "0"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.4175441774862223`*^9}],

Cell[BoxData[
 FormBox["\<\"Each of the components must be zero\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.417544177533317*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         SubsuperscriptBox["x", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r"],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], " ", 
       FormBox[
        TagBox[
         SuperscriptBox[
          RowBox[{"(", 
           FormBox[
            InterpretationBox[
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["\[Phi]",
                  StripOnInput->False,
                  ShowContents->False], "\[Phi]"],
                
                TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]}], 
              RowBox[{"\[DifferentialD]", "t"}]],
             TensorCalculus4V6`Tensorial`TotalD[
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]],
            TraditionalForm], ")"}], "2"],
         DisplayForm],
        TraditionalForm]}], "+", 
      InterpretationBox[
       FractionBox[
        RowBox[{
         SuperscriptBox["\[DifferentialD]", "2"], 
         InterpretationBox[
          SubsuperscriptBox["x", 
           StyleBox["r",
            StripOnInput->False,
            ShowContents->False], "r"],
          
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], 
        RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
       TensorCalculus4V6`Tensorial`TotalD[
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, {
         TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, $CellContext`t}],
       Editable->False], "+", 
      FractionBox[
       RowBox[{"G", " ", "M"}], 
       FormBox[
        TagBox[
         SuperscriptBox[
          RowBox[{"(", 
           FormBox[
            InterpretationBox[
             SubsuperscriptBox["x", 
              StyleBox["r",
               StripOnInput->False,
               ShowContents->False], "r"],
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False],
            TraditionalForm], ")"}], "2"],
         DisplayForm],
        TraditionalForm]]}], "\[LongEqual]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", 
       InterpretationBox[
        FractionBox[
         RowBox[{"\[DifferentialD]", 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["r",
             StripOnInput->False,
             ShowContents->False], "r"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, \
{$CellContext`r}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, \
{TensorCalculus4V6`Tensorial`Void}], $CellContext`t]], " ", 
       InterpretationBox[
        FractionBox[
         RowBox[{"\[DifferentialD]", 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["\[Phi]",
             StripOnInput->False,
             ShowContents->False], "\[Phi]"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}], $CellContext`t]]}], "+", 
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["x", 
         StyleBox["r",
          StripOnInput->False,
          ShowContents->False], "r"],
        TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`r}, {
         TensorCalculus4V6`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], " ", 
       InterpretationBox[
        FractionBox[
         RowBox[{
          SuperscriptBox["\[DifferentialD]", "2"], 
          InterpretationBox[
           SubsuperscriptBox["x", 
            StyleBox["\[Phi]",
             StripOnInput->False,
             ShowContents->False], "\[Phi]"],
           
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {TensorCalculus4V6`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], 
         RowBox[{"\[DifferentialD]", "t", "\[DifferentialD]", "t"}]],
        TensorCalculus4V6`Tensorial`TotalD[
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`x, {$CellContext`\
\[Phi]}, {
          TensorCalculus4V6`Tensorial`Void}], {$CellContext`t, \
$CellContext`t}],
        Editable->False]}]}], "\[LongEqual]", "0"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417544177586327*^9}],

Cell[BoxData[
 FormBox["\<\"Convert to Mathematica differential equations by substituting \
coordinate expressions.\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.4175441776363077`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"r", "(", "t", ")"}]}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["r", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], "+", 
      FractionBox[
       RowBox[{"G", " ", "M"}], 
       SuperscriptBox[
        RowBox[{"r", "(", "t", ")"}], "2"]]}], "\[LongEqual]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["r", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "+", 
      RowBox[{
       RowBox[{"r", "(", "t", ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}]}], "\[LongEqual]", 
     "0"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.4175441776951513`*^9}]
}, Open  ]],

Cell["\<\
We then need to append the initial conditions and substitute the \
gravitational constant and the solar mass..\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"diffeqns0", ",", 
     RowBox[{
      RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}], " ", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "'"}], "[", "0", "]"}], "\[Equal]", "r0dot"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "\[Phi]0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "'"}], "[", "0", "]"}], "\[Equal]", "\[Phi]0dot"}]}],
     "}"}], "//", "Flatten"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"diffeqns1", "=", 
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"G", "\[Rule]", "GravitationalConstant"}], ",", 
     RowBox[{"M", "\[Rule]", "SolarMass"}]}], "}"}]}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"6.673`*^-11", " ", "Newton", " ", "SolarMass", " ", 
        SuperscriptBox["Meter", "2"]}], 
       RowBox[{
        SuperscriptBox["Kilogram", "2"], " ", 
        SuperscriptBox[
         RowBox[{"r", "(", "t", ")"}], "2"]}]], "-", 
      RowBox[{
       RowBox[{"r", "(", "t", ")"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["r", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], "\[LongEqual]", "0"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["r", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "+", 
      RowBox[{
       RowBox[{"r", "(", "t", ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}]}], "\[LongEqual]", "0"}],
     ",", 
    RowBox[{
     RowBox[{"r", "(", "0", ")"}], "\[LongEqual]", "r0"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "\[Prime]",
       MultilineFunction->None], "(", "0", ")"}], "\[LongEqual]", "r0dot"}], 
    ",", 
    RowBox[{
     RowBox[{"\[Phi]", "(", "0", ")"}], "\[LongEqual]", "\[Phi]0"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "(", "0", ")"}], "\[LongEqual]", 
     "\[Phi]0dot"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.417544190307809*^9}]
}, Open  ]],

Cell["\<\
We set up the data for aphelion of the earth. We calculate the rate of change \
of the angle at aphelion by using the aphelion rotational velocity and \
aphelion distance.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Omega]", "\[Equal]", 
  RowBox[{"v", "/", "r"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "\[Rule]", 
     RowBox[{"29.2944", " ", "Kilo", " ", 
      RowBox[{"Meter", "/", "Second"}]}]}], ",", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"1.0167", "AU"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{"ToUnitRule", "[", 
   RowBox[{"1", "/", "Day"}], "]"}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Omega]", "\[LongEqual]", 
   FractionBox["v", "r"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.41754423187009*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Omega]", "\[LongEqual]", 
   FractionBox[
    RowBox[{"28.813219238713486`", " ", "Kilo", " ", "Meter"}], 
    RowBox[{"AU", " ", "Second"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.417544231920665*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"ToUnitRule", "(", 
    FractionBox["1", "Day"], ")"}], "\[InvisibleApplication]", 
   RowBox[{"(", 
    RowBox[{"\[Omega]", "\[LongEqual]", 
     FractionBox[
      RowBox[{"28.813219238713486`", " ", "Kilo", " ", "Meter"}], 
      RowBox[{"AU", " ", "Second"}]]}], ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.417544231986575*^9}]
}, Open  ]],

Cell[TextData[{
 "We then establish the data for the initial conditions as a set of rules. \
The units are astronomical units ",
 Cell[BoxData["AU"]],
 " and days. We could have entered the data using any equivalent units."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"data", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r0", "\[Rule]", 
       RowBox[{"1.0167", "AU"}]}], ",", 
      RowBox[{"r0dot", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Phi]0", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Phi]0dot", "\[Rule]", 
       FractionBox["0.016641", "Day"]}]}], "}"}]}], ")"}], "//", 
  "TableForm"}]], "Input"],

Cell[BoxData[
 FormBox[
  TagBox[
   TagBox[GridBox[{
      {
       RowBox[{"r0", "\[Rule]", 
        RowBox[{"1.0167`", " ", "AU"}]}]},
      {
       RowBox[{"r0dot", "\[Rule]", "0"}]},
      {
       RowBox[{"\[Phi]0", "\[Rule]", "0"}]},
      {
       RowBox[{"\[Phi]0dot", "\[Rule]", 
        FractionBox["0.016641`", "Day"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{3.41754424224114*^9}]
}, Open  ]],

Cell[TextData[{
 "We will want to 'deunitize' the equations and the best method is to set up \
reduced units where ",
 Cell[BoxData[
  RowBox[{"G", "\[Equal]", "AU", "\[Equal]", "Year", "\[Equal]", "1"}]]],
 "."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetupReducedUnits", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"GravitationalConstant", " ", ",", "AU", ",", "Day"}], "}"}], ",",
    " ", 
   RowBox[{"{", 
    RowBox[{"Ampere", ",", "Kelvin"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"SetupReducedUnits", "(", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"6.673`*^-11", " ", 
        SuperscriptBox["Meter", "2"], " ", "Newton"}], 
       SuperscriptBox["Kilogram", "2"]], ",", "AU", ",", "Day"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ampere", ",", "Kelvin"}], "}"}]}], ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417544252335691*^9}]
}, Open  ]],

Cell["\<\
We then obtain the differential equations in 'geometrical' form.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"r", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"diffeqns2", "=", 
  RowBox[{
   RowBox[{"diffeqns1", "/.", "data"}], "//", "ReducedUnits"}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"ReducedUnits", "(", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"6.673`*^-11", " ", "Newton", " ", "SolarMass", " ", 
         SuperscriptBox["Meter", "2"]}], 
        RowBox[{
         SuperscriptBox["Kilogram", "2"], " ", 
         SuperscriptBox[
          RowBox[{"r", "(", "t", ")"}], "2"]}]], "-", 
       RowBox[{
        RowBox[{"r", "(", "t", ")"}], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "(", "t", ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["r", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "\[LongEqual]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["r", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}], "+", 
       RowBox[{
        RowBox[{"r", "(", "t", ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}]}], "\[LongEqual]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"r", "(", "0", ")"}], "\[LongEqual]", 
      RowBox[{"1.0167`", " ", "AU"}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "\[Prime]",
        MultilineFunction->None], "(", "0", ")"}], "\[LongEqual]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "(", "0", ")"}], "\[LongEqual]", "0"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "(", "0", ")"}], "\[LongEqual]", 
      FractionBox["0.016641`", "Day"]}]}], "}"}], ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.417544255757757*^9}]
}, Open  ]],

Cell[TextData[{
 "For an orbit we can use a ",
 Cell[BoxData["StoppingTest"]],
 " when one orbit is completed. Then we can extract the ",
 Cell[BoxData["period"]],
 " (in days) from the returned ",
 Cell[BoxData["InterpolatingFunction"]],
 ". "
}], "Text"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"r", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"First", "@", 
  RowBox[{"NDSolve", "[", 
   RowBox[{"diffeqns2", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Phi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "366"}], "}"}], ",", 
    RowBox[{"StoppingTest", "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "t", "]"}], "\[GreaterEqual]", 
       RowBox[{"2", "\[Pi]"}]}], ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r", "[", "t_", "]"}], ",", 
    RowBox[{"\[Phi]", "[", "t_", "]"}]}], "}"}], "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", "t", "]"}], ",", 
     RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}], "/.", 
   "%"}]}], "\[IndentingNewLine]", 
 RowBox[{"period", "=", 
  RowBox[{"Part", "[", 
   RowBox[{
    RowBox[{"Head", "[", 
     RowBox[{"r", "[", "t", "]"}], "]"}], ",", "1", ",", "1", ",", "2"}], 
   "]"}]}]}], "Input"],

Cell["\<\
The following plot shows the variation of earth's radial distance with time. \
The aphelion and perihelion radii are marked in red.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Draw2D", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Draw", "[", 
       RowBox[{
        RowBox[{"r", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "period"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "Red", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0.9832"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"period", ",", "0.9833"}], "}"}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1.0167"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"period", ",", "1.0167"}], "}"}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", "Black", ",", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<perihelion\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"64.3781", ",", "0.98528"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<aphelion\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"279.088", ",", "1.01493"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "r"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}], ";"}]], "Input"],

Cell["The perihelion velocity can be calculated as follows.", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "'"}], "[", 
   RowBox[{"period", "/", "2"}], "]"}], " ", 
  RowBox[{"R", "[", "aphelion", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ReducedEquivalent", "[", 
  RowBox[{"%", ",", "1", ",", 
   RowBox[{"1", "/", "Day"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{
   RowBox[{"R", "[", "aphelion", "]"}], "\[Rule]", 
   RowBox[{"0.9833", " ", "AU"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{"ToUnit", "[", 
   RowBox[{"Kilo", " ", 
    RowBox[{"Meter", "/", "Second"}]}], "]"}]}]}], "Input"],

Cell["\<\
An animation is easily produced for the orbital motion. The following defines \
one frame for the animation and displays a test frame at 75 days from \
aphelion.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frame", "[", "t_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Draw2D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CirclePoint", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "5", ",", "Black", ",", 
         "Gold"}], "]"}], ",", "\[IndentingNewLine]", "Gray", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ParametricDraw", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", "s", "]"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "[", "s", "]"}], "]"}], ",", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "[", "s", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "period"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"CirclePoint", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", "t", "]"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "}"}]}], ",", "3", 
         ",", "Black", ",", "Green"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Background", "\[Rule]", "SkyBlue"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frame", "[", "75", "]"}], ";"}]}], "Input"],

Cell[TextData[{
 "The following code will actuate the animation. (The animation itself is not \
shown in the pdf document.) The statements after the ",
 Cell[BoxData["Animate"]],
 " statement serve to select and close up the graphics cells and then start \
the animation. These statements were actually clicked in from a button on the \
",
 Cell[BoxData["DrawGraphics"]],
 " palette. The animation would be more interesting with a more elliptical \
orbit."
}], "Text"],

Cell[BoxData[{
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"frame", "[", "t", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{
      RowBox[{"del", "=", 
       RowBox[{"period", "/", "200"}]}], ";", 
      RowBox[{"period", "-", "del"}]}], ",", "del"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectionMove", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", "All", ",", 
   "GeneratedCell"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<OpenCloseGroup\>\"", "]"}], ";", 
  RowBox[{"Pause", "[", "0.5", "]"}], ";"}], "\n", 
 RowBox[{"FrontEndExecute", "[", 
  RowBox[{"{", 
   RowBox[{"FrontEnd`SelectionAnimate", "[", 
    RowBox[{"200", ",", 
     RowBox[{"AnimationDisplayTime", "\[Rule]", "0.05"}], ",", 
     RowBox[{"AnimationDirection", "\[Rule]", "Forward"}]}], "]"}], "}"}], 
  "]"}]}], "Input"],

Cell["\<\
We might ask the question: What is the maximum initial 'aphelion' velocity \
that will produce a closed orbit? We write an expression for the energy and \
transform it to coordinate expressions.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"r", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"AU", ",", "Constant"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[ScriptCapitalE]", "\[Equal]", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", "m", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"vu", "[", 
        RowBox[{"red", "@", "r"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"vu", "[", 
        RowBox[{"red", "@", "\[Phi]"}], "]"}], "2"]}], ")"}]}], "-", 
   RowBox[{"G", " ", "M", "  ", 
    RowBox[{"m", "/", 
     RowBox[{"xu", "[", "r", "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", "vrules"}], "\[IndentingNewLine]", 
 RowBox[{"step1", "=", 
  RowBox[{"%", "//", 
   RowBox[{"UseCoordinates", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "[", "t", "]"}], ",", 
      RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}], "]"}]}]}]}], "Input"],

Cell[TextData[{
 "The energy must be negative for a closed orbit. The maximum value of ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]]],
 " is obtained by setting the bracketed expression to zero."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Part", "[", 
   RowBox[{"step1", ",", "2"}], "]"}], "\[Equal]", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   RowBox[{"Solve", "[", 
    RowBox[{"%", ",", 
     RowBox[{
      RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], "]"}], 
   RowBox[{"\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]], "/.", 
  RowBox[{"t", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"G", "\[Rule]", "GravitationalConstant"}], ",", 
    RowBox[{"M", "\[Rule]", "SolarMass"}], ",", 
    RowBox[{
     RowBox[{"r", "[", "0", "]"}], "\[Rule]", "r0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "'"}], "[", "0", "]"}], "\[Rule]", "r0dot"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", "data"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{"ToUnitRule", "[", 
   RowBox[{"Radian", "/", "Day"}], "]"}]}]}], "Input"],

Cell["The earth's aphelion velocity is well below this.", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full Spectrum Physics", "Section"],

Cell[TextData[{
 "To do real physics on a computer we want to write equations the way that \
physicists write them, which is mostly in tensor notation. We want to be able \
to draw geometric diagrams the way physicists and geometers draw them. We \
want to be able to deal with real data with real units. It takes considerable \
extra programming on the part of users to close the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " gap. The ",
 Cell[BoxData["Tensorial"]],
 ", ",
 Cell[BoxData["DrawGraphics"]],
 ", ",
 Cell[BoxData["ExtendUnits"]],
 " and ",
 Cell[BoxData["Cardano3"]],
 " packages go a very long way in closing the gap. They allow students and \
researchers to think much more in terms of physics and mathematics and much \
less in terms of programming."
}], "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowToolbars->"EditBar",
WindowSize->{748, 725},
WindowMargins->{{216, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"TensorialStyle.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 44, 0, 57, "Title"],
Cell[614, 24, 45, 0, 40, "Subtitle"],
Cell[662, 26, 137, 6, 40, "Chaptertitle"],
Cell[CellGroupData[{
Cell[824, 36, 53, 0, 39, "Subsubtitle"],
Cell[880, 38, 781, 16, 151, "Text"],
Cell[CellGroupData[{
Cell[1686, 58, 29, 0, 57, "Section"],
Cell[1718, 60, 165, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[1908, 69, 196, 4, 62, "Input",
 InitializationCell->True],
Cell[2107, 75, 511, 10, 23, "Message"],
Cell[2621, 87, 552, 10, 23, "Message"],
Cell[3176, 99, 177, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3390, 107, 342, 5, 79, "Input",
 InitializationCell->True],
Cell[3735, 114, 531, 11, 23, "Message"],
Cell[4269, 127, 571, 12, 23, "Message"],
Cell[4843, 141, 179, 3, 31, "Output"],
Cell[5025, 146, 529, 11, 23, "Message"],
Cell[5557, 159, 570, 11, 23, "Message"],
Cell[6130, 172, 178, 3, 31, "Output"]
}, Open  ]],
Cell[6323, 178, 673, 15, 131, "Text"],
Cell[6999, 195, 424, 12, 79, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[7460, 212, 92, 2, 57, "Section"],
Cell[7555, 216, 152, 3, 51, "Text"],
Cell[CellGroupData[{
Cell[7732, 223, 362, 11, 62, "Input"],
Cell[8097, 236, 1360, 43, 33, "Output"],
Cell[9460, 281, 2731, 85, 41, "Output"]
}, Open  ]],
Cell[12206, 369, 157, 5, 51, "Text"],
Cell[12366, 376, 107, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[12498, 383, 359, 11, 62, "Input"],
Cell[12860, 396, 7050, 204, 66, "Output"],
Cell[19913, 602, 6929, 200, 66, "Output"]
}, Open  ]],
Cell[26857, 805, 181, 4, 51, "Text"],
Cell[27041, 811, 10090, 248, 19, "Input",
 CellOpen->False],
Cell[37134, 1061, 409, 7, 91, "Text"],
Cell[CellGroupData[{
Cell[37568, 1072, 1443, 46, 96, "Input"],
Cell[39014, 1120, 3664, 105, 66, "Output"],
Cell[42681, 1227, 788, 21, 66, "Output"],
Cell[43472, 1250, 3194, 89, 66, "Output"]
}, Open  ]],
Cell[46681, 1342, 179, 4, 51, "Text"],
Cell[CellGroupData[{
Cell[46885, 1350, 1458, 41, 181, "Input"],
Cell[48346, 1393, 6931, 200, 66, "Output"],
Cell[55280, 1595, 157, 3, 24, "Print"],
Cell[55440, 1600, 6168, 184, 66, "Output"],
Cell[61611, 1786, 142, 3, 24, "Print"],
Cell[61756, 1791, 5213, 149, 75, "Output"],
Cell[66972, 1942, 155, 3, 24, "Print"],
Cell[67130, 1947, 6500, 174, 76, "Output"],
Cell[73633, 2123, 147, 3, 24, "Print"],
Cell[73783, 2128, 2340, 72, 41, "Output"]
}, Open  ]],
Cell[76138, 2203, 364, 11, 71, "Text"],
Cell[CellGroupData[{
Cell[76527, 2218, 462, 15, 62, "Input"],
Cell[76992, 2235, 687, 23, 58, "Output"],
Cell[77682, 2260, 515, 16, 33, "Output"]
}, Open  ]],
Cell[78212, 2279, 156, 3, 51, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78405, 2287, 65, 0, 57, "Section"],
Cell[78473, 2289, 234, 7, 51, "Text"],
Cell[CellGroupData[{
Cell[78732, 2300, 2172, 62, 270, "Input"],
Cell[80907, 2364, 6497, 174, 76, "Output"],
Cell[87407, 2540, 157, 3, 24, "Print"],
Cell[87567, 2545, 7781, 215, 76, "Output"],
Cell[95351, 2762, 131, 2, 24, "Print"],
Cell[95485, 2766, 7219, 197, 76, "Output"],
Cell[102707, 2965, 142, 3, 24, "Print"],
Cell[102852, 2970, 5751, 151, 75, "Output"],
Cell[108606, 3123, 193, 3, 24, "Print"],
Cell[108802, 3128, 1164, 35, 60, "Output"]
}, Open  ]],
Cell[109981, 3166, 134, 3, 51, "Text"],
Cell[CellGroupData[{
Cell[110140, 3173, 732, 21, 62, "Input"],
Cell[110875, 3196, 1769, 52, 102, "Output"]
}, Open  ]],
Cell[112659, 3251, 195, 4, 51, "Text"],
Cell[CellGroupData[{
Cell[112879, 3259, 470, 13, 79, "Input"],
Cell[113352, 3274, 160, 4, 53, "Output"],
Cell[113515, 3280, 252, 6, 57, "Output"],
Cell[113770, 3288, 392, 10, 61, "Output"]
}, Open  ]],
Cell[114177, 3301, 235, 5, 51, "Text"],
Cell[CellGroupData[{
Cell[114437, 3310, 398, 12, 67, "Input"],
Cell[114838, 3324, 900, 28, 108, "Output"]
}, Open  ]],
Cell[115753, 3355, 223, 6, 51, "Text"],
Cell[CellGroupData[{
Cell[116001, 3365, 248, 7, 44, "Input"],
Cell[116252, 3374, 442, 13, 64, "Output"]
}, Open  ]],
Cell[116709, 3390, 88, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[116822, 3396, 217, 5, 62, "Input"],
Cell[117042, 3403, 1898, 54, 143, "Output"]
}, Open  ]],
Cell[118955, 3460, 256, 8, 51, "Text"],
Cell[119214, 3470, 1034, 31, 96, "Input"],
Cell[120251, 3503, 155, 3, 51, "Text"],
Cell[120409, 3508, 1546, 42, 181, "Input"],
Cell[121958, 3552, 69, 0, 31, "Text"],
Cell[122030, 3554, 588, 16, 96, "Input"],
Cell[122621, 3572, 185, 4, 51, "Text"],
Cell[122809, 3578, 1706, 45, 198, "Input"],
Cell[124518, 3625, 468, 10, 111, "Text"],
Cell[124989, 3637, 892, 24, 130, "Input"],
Cell[125884, 3663, 218, 4, 71, "Text"],
Cell[126105, 3669, 966, 27, 118, "Input"],
Cell[127074, 3698, 235, 6, 51, "Text"],
Cell[127312, 3706, 962, 28, 115, "Input"],
Cell[128277, 3736, 65, 0, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128379, 3741, 40, 0, 57, "Section"],
Cell[128422, 3743, 789, 19, 151, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
