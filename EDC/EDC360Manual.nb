(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    320273,      10828]
NotebookOptionsPosition[    270848,       9538]
NotebookOutlinePosition[    295782,      10019]
CellTagsIndexPosition[    295739,      10016]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
\t 
\
\>", "Text"],

Cell[CellGroupData[{

Cell["\<\
Exterior Differential Calculus
and
Symbolic Matrix Algebra\
\>", "Text",
 ShowGroupOpener->True,
 TextAlignment->Center,
 TextJustification->0,
 FontFamily->"Times",
 FontSize->36,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell["\<\

version 3.6.0 - May 2007\
\>", "Text",
 TextAlignment->Center,
 TextJustification->0,
 FontSlant->"Italic"],

Cell[TextData[{
 StyleBox["\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ButtonBox["S. Bonanos",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/~sbonano/SB.html"], None}],
 StyleBox["\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Bold"],
 StyleBox[ButtonBox["Institute of Nuclear Physics",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/"], None}],
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[",  ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[ButtonBox["NCSR \"Demokritos\"",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.demokritos.gr/index_muk.asp"], None}],
  FontSlant->"Italic"],
 StyleBox[", \nAghia Paraskevi 15310, Greece. ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontSize->14,
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Bold"],
 "Please send comments, suggestions, bug reports to:  ",
 ButtonBox["sbonano@inp.demokritos.gr",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["mailto:sbonano@inp.demokritos.gr"], None}],
 StyleBox[" \t",
  FontWeight->"Bold"]
}], "Text",
 TextAlignment->Center,
 TextJustification->0,
 FontFamily->"Times",
 FontSize->16]
}, Closed]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["Overview", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n\tThis package enables ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to carry out calculations with differential forms. It defines the two \
basic operations - ",
 StyleBox["Exterior Product",
  FontWeight->"Bold"],
 " ",
 StyleBox["(Wedge)",
  FontWeight->"Bold"],
 " and ",
 StyleBox["Exterior Derivative (d)",
  FontWeight->"Bold"],
 " - in such a way that:\n (1)  they can act on any valid ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expression\n (2)  they allow the use of any symbols to denote differential \
forms\n (3)  input - output notation is as close as possible to standard usage"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 " \tThere are two versions of this package: ",
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold"],
 " and ",
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold"],
 ". The first can handle scalar differential-form expressions only, while the \
second can also handle matrix-valued differential forms, i.e., matrices whose \
components are (scalar) differential forms.  ",
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold"],
 " can be used for calculations with scalar forms, but it is  ~15% slower \
than  ",
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold"],
 ".\n \tThe matrix package, allowing user-controlled application of trace \
identities and the Cayley-Hamilton theorem, can also be used for symbolic \
matrix calculations (see sample calculations (2) and (3) in the last section)."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "  \tFor exterior multiplication we use the infix operator symbol \[Wedge] \
(Wedge). This symbol is included in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " (see Sections 3.10.1, 3.10.4) but does not have a pre\[Hyphen]defined \
meaning. It can be input by typing  \[EscapeKey] ^ \[EscapeKey]  (where ^ is \
the symbol for exponent) or  \\ [Wedge] (without space after \\). Finally, it \
can be input by clicking the appropriate button in the notebook ",
 StyleBox["SymbolPalette.nb. \n  \t",
  FontWeight->"Bold"],
 "The same symbol (instead of Dot) is used to denote matrix multiplication."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "\tAll expressions are treated as sums of terms, which may have factors that \
are special symbols (declared by the user as denoting differential forms or \
matrices) or have ",
 StyleBox["Head",
  FontFamily->"Courier"],
 " ",
 StyleBox["Wedge",
  FontWeight->"Bold"],
 " or ",
 StyleBox["d",
  FontWeight->"Bold"],
 ", and rules are given for manipulating such expressions. ",
 StyleBox["All other (undeclared) symbols are treated as scalar 0-forms",
  FontSlant->"Italic"],
 ". The ordering of terms in an expression is determined by the built-in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " rules for ",
 StyleBox["Plus",
  FontFamily->"Courier"],
 " and ",
 StyleBox["Times",
  FontFamily->"Courier"],
 ", which sometimes results in an unexpected ordering of terms. ",
 StyleBox["All terms in a sum, and all components of a matrix, must be of the \
same (differential-form) degree.",
  FontSlant->"Italic"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "\t",
 StyleBox["Warning",
  FontWeight->"Bold"],
 ": The executable cells in this Manual must be evaluated ",
 StyleBox["in the order they appear",
  FontSlant->"Italic"],
 ", after evaluating ",
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold"],
 " first."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 StyleBox["Important Note",
  FontWeight->"Bold"],
 ": The notebooks are in the form of \"open code\", and the many global \
variables introduced are not protected. This is intentional, in order to \
allow the user to add new definitions on the fly, as required in a \
calculation, without having to go through ",
 StyleBox["Unprotect",
  FontFamily->"Courier"],
 ". However, it also carries the danger that an unprotected symbol might be \
used in a way that was not intended.",
 StyleBox[" If one obtains results that don't make sense, it is most likely \
that some global variable is used inappropriately (e.g.,  a symbol, declared \
to represent a matrix, is used in a later calculation as a scalar).  ",
  FontSlant->"Italic"],
 "Reevaluating the relevant EDCcode.nb notebook clears all variables and \
allows a fresh start."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "\t",
 StyleBox["Acknowledgement",
  FontWeight->"Bold"],
 ": I wish to thank ",
 ButtonBox["Wolfram Research",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.wolfram.com/"], None}],
 " for a ",
 ButtonBox["Visiting Scholar Grant",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.wolfram.com/company/opportunities/"], None}],
 ", during which version 2.6.1 of this package was developed."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 StyleBox["\tThe present version - 3.6.0 - is an update to make EDC \
compatible with Mathematica 6. See version history in the ",
  FontSlant->"Italic"],
 StyleBox[ButtonBox["EDC web page",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/~sbonano/EDC/"], None}],
  FontSlant->"Italic"],
 "."
}], "Text",
 FontSize->16]
}, Open  ]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["scalarEDC", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n\t",
 StyleBox["The notebook ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" allows calculations with scalar differential forms only. The \
following functions / operations are defined (examples are given in the cells \
in brackets. Sections marked by  \[FilledSquare]  can be skipped on a first \
reading):",
  FontColor->RGBColor[0, 0, 1]]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Wedge",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_,y_,...] ",
  FontFamily->"Courier"],
 " or  ",
 StyleBox[" x_\[Wedge]y_\[Wedge]...",
  FontFamily->"Courier"],
 " :: gives the exterior product of the expressions ",
 StyleBox["x,y,... Wedge",
  FontFamily->"Courier"],
 " reduces to",
 StyleBox[" Times",
  FontFamily->"Courier"],
 " when acting on 0-forms."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Wedge", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "a", " ", 
     RowBox[{"d", "[", "x", "]"}]}], "+", 
    RowBox[{"3", "b", " ", 
     RowBox[{"d", "[", "y", "]"}]}], "+", 
    RowBox[{"5", "c", " ", 
     RowBox[{"d", "[", "z", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", " ", "x"}], "+", 
      RowBox[{"b", " ", "y"}]}], "]"}], 
    RowBox[{"d", "[", "y", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}]}]}], "-", 
  RowBox[{"5", " ", "c", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Note that Wedge products are ordered alphabetically.  Instead of ",
 StyleBox["Wedge[...]",
  FontFamily->"Courier"],
 " one can use the infix symbol ",
 StyleBox["\[Wedge]",
  FontFamily->"Courier"],
 ":"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", "a", " ", 
     RowBox[{"d", "[", "x", "]"}]}], "+", 
    RowBox[{"3", "b", " ", 
     RowBox[{"d", "[", "y", "]"}]}], "+", 
    RowBox[{"5", "c", " ", 
     RowBox[{"d", "[", "z", "]"}]}]}], ")"}], 
  StyleBox["\[Wedge]",
   FontFamily->"Courier"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", " ", "x"}], "+", 
      RowBox[{"b", " ", "y"}]}], "]"}], 
    RowBox[{"d", "[", "y", "]"}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}]}]}], "-", 
  RowBox[{"5", " ", "c", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["d",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: gives the exterior derivative of the expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ", assuming all symbols are variable."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "/@", 
  RowBox[{"{", 
   RowBox[{"A", ",", 
    RowBox[{"A", "[", "0", "]"}], ",", 
    RowBox[{"A", "[", "x", "]"}], ",", 
    RowBox[{
     RowBox[{"A", "[", "2", "]"}], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "[", "A", "]"}], ",", 
   RowBox[{"d", "[", 
    RowBox[{"A", "[", "0", "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], " ", 
    RowBox[{
     SuperscriptBox["A", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "y", "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"A", "[", "2", "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"A", "[", "2", "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", "%%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "a", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}]}]}], "-", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "a", " ", "x", " ", 
      RowBox[{
       RowBox[{"d", "[", "a", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}], "+", 
     RowBox[{"2", " ", "a", " ", "y", " ", 
      RowBox[{
       RowBox[{"d", "[", "b", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}]}], ")"}]}], "-", 
  RowBox[{"5", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "c", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}], "-", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "5"}], " ", "c", " ", "x", " ", 
      RowBox[{
       RowBox[{"d", "[", "a", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "z", "]"}]}]}], "-", 
     RowBox[{"5", " ", "c", " ", "y", " ", 
      RowBox[{
       RowBox[{"d", "[", "b", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "z", "]"}]}]}], "-", 
     RowBox[{"5", " ", "a", " ", "c", " ", 
      RowBox[{
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "z", "]"}]}]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell["Constants must be explicitly declared:", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "a", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"d", "[", "b", "]"}], "=", "0"}], ";", "%"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "5"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "c", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}], "+", 
  RowBox[{"5", " ", "a", " ", "c", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"x", "^", "n"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", " ", 
   SuperscriptBox["x", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}]], " ", 
   RowBox[{"d", "[", "x", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "n"], " ", 
   RowBox[{"d", "[", "n", "]"}], " ", 
   RowBox[{"Log", "[", "x", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "n", "]"}], "=", "0"}], ";", "%"}]], "Input"],

Cell[BoxData[
 RowBox[{"n", " ", 
  SuperscriptBox["x", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], " ", 
  RowBox[{"d", "[", "x", "]"}]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["reWrite",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: rewrites the expression ",
 StyleBox["x,",
  FontFamily->"Courier"],
 " collecting together all terms having identical ",
 StyleBox["Wedge[_]",
  FontFamily->"Courier"],
 " or ",
 StyleBox["d[_]",
  FontFamily->"Courier"],
 " factors, applies the simplification rules defined in the list ",
 StyleBox["simpRules", "Inputt",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 ", and factors the coefficient of each such ",
 StyleBox["Wedge[_]",
  FontFamily->"Courier"],
 " or ",
 StyleBox["d[_]",
  FontFamily->"Courier"],
 " term. In complicated expressions, one can define a set of variables in the \
list ",
 StyleBox["varList", "Inputt",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 " to be used to collect terms in these coefficients so as to further \
simplify the result - see next section. ",
 StyleBox["The proper choice of rules in ",
  FontSlant->"Italic"],
 StyleBox["simpRules",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" and of variables in ",
  FontSlant->"Italic"],
 StyleBox["varList",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" is crucial for the effective simplification of complicated \
expressions",
  FontSlant->"Italic"],
 ". The default values of the global variables ",
 StyleBox["simpRules",
  FontFamily->"Courier"],
 " and ",
 StyleBox["varList",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 " are: ",
 Cell[BoxData[
  RowBox[{"simpRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_.", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "z_", "]"}], "2"]}], "+", 
      RowBox[{"x_.", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "z_", "]"}], "2"]}]}], "->", "x"}], "}"}]}]]],
 "; ",
 StyleBox["varList = {}",
  FontFamily->"Courier"],
 StyleBox[";", "OutputL"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"%%%", "-", 
   RowBox[{"3", "%%%", "*", 
    RowBox[{"a", "/", "5"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "+", 
     RowBox[{"3", " ", "a"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "c", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}], "-", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "+", 
     RowBox[{"3", " ", "a"}]}], ")"}], " ", "c", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Another application of ",
 StyleBox["reWrite",
  FontFamily->"Courier"],
 ", where the default value of ",
 StyleBox["simpRules",
  FontFamily->"Courier"],
 " is applied: "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "z", "]"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "->", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
    RowBox[{"y", "->", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
    RowBox[{"z", "->", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "3"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
  RowBox[{
   RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "\[Phi]", "]"}]}]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox[" ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["The use of ", "Text",
  FontFamily->"Times",
  FontSlant->"Italic"],
 StyleBox["varList", "Text",
  FontFamily->"Courier",
  FontSlant->"Italic"],
 StyleBox[" ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain"]
}], "Subsubsection"],

Cell[TextData[{
 "\tSuppose the function  ",
 StyleBox["g",
  FontFamily->"Courier"],
 "  of ",
 StyleBox["x,",
  FontFamily->"Courier"],
 " ",
 StyleBox["y,",
  FontFamily->"Courier"],
 " ",
 StyleBox["z",
  FontFamily->"Courier"],
 "  is known to depend on ",
 StyleBox["x,",
  FontFamily->"Courier"],
 " ",
 StyleBox["y",
  FontFamily->"Courier"],
 " through the two particular combinations - \n",
 StyleBox["(x",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["y)/(",
  FontFamily->"Courier"],
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["y", "2"]}]]],
 StyleBox[")",
  FontFamily->"Courier"],
 " and ",
 StyleBox["(x",
  FontFamily->"Courier"],
 " ",
 StyleBox["y",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["1)/(",
  FontFamily->"Courier"],
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["y", "2"]}]]],
 StyleBox[")",
  FontFamily->"Courier"],
 " -  and ",
 StyleBox["g",
  FontFamily->"Courier"],
 " is written with these as arguments. Then"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dg", "=", 
  RowBox[{"d", "[", 
   RowBox[{"g", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "+", "y"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", "y"}], " ", "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}]}], ",", "z"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "z", "]"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"y", " ", 
       RowBox[{"d", "[", "x", "]"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "+", 
     FractionBox[
      RowBox[{"x", " ", 
       RowBox[{"d", "[", "y", "]"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", "y", " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"], " ", "y", " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", "x", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"d", "[", "x", "]"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", "[", "y", "]"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", "x", " ", "y", " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "x", " ", "y", " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", "dg", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "z", "]"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}], "2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", "[", "x", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["x", "2"], " ", "y", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["y", "3"], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["x", "2"], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{"2", " ", "x", " ", "y", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["y", "2"], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}]}], ")"}]}], 
    ")"}]}], "-", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}], "2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", "[", "y", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["x", "3"]}], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{"2", " ", "y", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{"x", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["x", "2"], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{"2", " ", "x", " ", "y", " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["y", "2"], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}]}], ")"}]}], 
    ")"}]}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Note that ",
 StyleBox["reWrite",
  FontFamily->"Courier"],
 " collects together all terms having  ",
 StyleBox["d[x],",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[y]",
  FontFamily->"Courier"],
 " as factors, but it does not group together terms with the same derivatives \
of ",
 StyleBox["g",
  FontFamily->"Courier"],
 " in the coefficients of ",
 StyleBox["d[x],",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[y]",
  FontFamily->"Courier"],
 ". Therefore, choose"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", "__", "]"}], "[", "g", "]"}], "[", "__", 
     "]"}], "}"}]}], ";"}]], "Input"],

Cell[TextData[{
 "Now ",
 StyleBox["reWrite",
  FontFamily->"Courier"],
 " gives:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", "dg", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "z", "]"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", "y", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "3"]}], "+", 
          RowBox[{"2", " ", "y"}], "+", 
          RowBox[{"x", " ", 
           SuperscriptBox["y", "2"]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}], "2"]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "-", 
         RowBox[{"2", " ", "x", " ", "y"}], "-", 
         SuperscriptBox["y", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "x"}], "+", 
          RowBox[{
           SuperscriptBox["x", "2"], " ", "y"}], "-", 
          SuperscriptBox["y", "3"]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}], "2"]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         RowBox[{"2", " ", "x", " ", "y"}], "-", 
         SuperscriptBox["y", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell["Verify that it is a closed form:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"d", "[", "%", "]"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"varList", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"]
}, Closed]],

Cell[TextData[{
 StyleBox["FormDegree",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 ":: returns the (differential-form) degree of the expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ". It assumes that all terms in a sum have the same degree."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["DeclareForms",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[{p1_,x__},{p2_,y__},...]",
  FontFamily->"Courier"],
 " :: allows the user to introduce his particular notation for fundamental \
(undefined) p-forms. ",
 StyleBox["p1, p2",
  FontFamily->"Courier"],
 " must be positive integers (denoting the degree of the differential form(s) \
",
 StyleBox["x__, y__",
  FontFamily->"Courier"],
 ") and ",
 StyleBox["x__, y__",
  FontFamily->"Courier"],
 "  sequences of one or more symbols separated by commas. For example, \
evaluating the command ",
 StyleBox["DeclareForms[{1,a1,q[_]},{2,a2,b2,c2}]",
  FontFamily->"Courier"],
 " implies that, in all subsequent calculations, the symbols ",
 StyleBox["a1,",
  FontFamily->"Courier"],
 " ",
 StyleBox["q[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["q[2]",
  FontFamily->"Courier"],
 ",  etc., will be treated as 1-forms and the symbols ",
 StyleBox["a2,",
  FontFamily->"Courier"],
 " ",
 StyleBox["b2,",
  FontFamily->"Courier"],
 " ",
 StyleBox["c2",
  FontFamily->"Courier"],
 "  as 2-forms. If only forms of the same degree are introduced, the curly \
brackets can be omitted: ",
 StyleBox["DeclareForms[1,a1,q[_]]",
  FontFamily->"Courier"],
 " is the same as ",
 StyleBox["DeclareForms[{1,a1,q[_]}]",
  FontFamily->"Courier"],
 ". ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " also assigns the appropriate ",
 StyleBox["FormDegree",
  FontFamily->"Courier"],
 " to the newly introduced forms, and makes appropriate changes to other \
internal variables.",
 StyleBox[" All other undefined symbols are treated as scalars (0-forms)",
  FontSlant->"Italic"],
 ". \n",
 StyleBox["Note",
  FontWeight->"Bold"],
 ": Only ",
 StyleBox["undefined",
  FontSlant->"Italic"],
 " symbols should be declared as forms using ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 ". If all forms are expressed in terms of the coordinate differentials (",
 StyleBox["d[x]", "OutputL"],
 ", ",
 StyleBox["d[x]\[Wedge]d[y]", "OutputL"],
 ", etc.) ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " should not be used.",
 StyleBox[" The effects of ",
  FontSlant->"Italic"],
 StyleBox["DeclareForms",
  FontFamily->"Courier",
  FontSlant->"Italic"],
 StyleBox["  cannot be undone",
  FontSlant->"Italic"],
 "."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 StyleBox[
  RowBox[{"DeclareForms", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "a1", ",", 
      RowBox[{"q", "[", "_", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "a2", ",", "b2", ",", "c2"}], "}"}]}], "]"}],
  FontFamily->"Courier"]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", "1", "]"}], "\[Wedge]", "a1"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a1", "\[Wedge]", 
    RowBox[{"q", "[", "1", "]"}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Wedge orders forms in canonical order ",
 StyleBox["by degree",
  FontSlant->"Italic"],
 " (lower order forms first):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c2", "\[Wedge]", "%", "\[Wedge]", "a2"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a1", "\[Wedge]", 
    RowBox[{"q", "[", "1", "]"}], "\[Wedge]", "a2", "\[Wedge]", "c2"}], 
   ")"}]}]], "Output"]
}, Open  ]],

Cell["\<\
One can give arbitrary, but consistent, definitions for the exterior \
derivatives of undefined forms:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"q", "[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"q", "[", "2", "]"}], "\[Wedge]", 
    RowBox[{"q", "[", "3", "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"q", "[", "2", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"q", "[", "3", "]"}], "\[Wedge]", 
    RowBox[{"q", "[", "1", "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"q", "[", "3", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"q", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"q", "[", "2", "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], "\[Wedge]", 
      RowBox[{"q", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"q", "[", "3", "]"}], "\[Wedge]", 
      RowBox[{"q", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "\[Wedge]", 
      RowBox[{"q", "[", "2", "]"}]}]}], "}"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "consistency"}], " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Warning",
  FontWeight->"Bold"],
 ": One must not use ",
 StyleBox["Set",
  FontFamily->"Courier"],
 " (=) for relations between udefined forms. For example, if one discovers, \
in the course of a calculation, that the equations satisfied by an undefined \
form (say ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 ") imply that it can be expressed in terms of scalars as, say,  u d[v] + \
d[w], one must avoid making the assignment ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 " ",
 StyleBox["=",
  FontFamily->"Courier"],
 " ",
 StyleBox["u",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[v]",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[w]",
  FontFamily->"Courier"],
 " because it may lead to infinite loops (depending on previous calculations \
using ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 "). One must instead use the replacement rule ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 " ",
 StyleBox["->",
  FontFamily->"Courier"],
 " ",
 StyleBox["u",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[v]",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[w]",
  FontFamily->"Courier"],
 " where needed, or restart the calculations using a different notation for \
",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 " (say ",
 StyleBox["q3",
  FontFamily->"Courier"],
 ", ",
 StyleBox["which must not be declared as an 1-form",
  FontSlant->"Italic"],
 "), and then setting  ",
 StyleBox["q3",
  FontFamily->"Courier"],
 " ",
 StyleBox["=",
  FontFamily->"Courier"],
 " ",
 StyleBox["u",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[v]+d[w]",
  FontFamily->"Courier"],
 "."
}], "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Bar",
  FontWeight->"Bold"],
 "[x_]:: returns the complex conjugate of the expression x, assuming all \
symbols are complex. If some symbols are real, the user must set ",
 StyleBox["Bar[ai]=ai",
  FontFamily->"Courier"],
 ", for each real symbol ",
 StyleBox["ai",
  FontFamily->"Courier"],
 ". If most symbols are real one can define ",
 StyleBox["Bar[x_Symbol]:=x",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 ", and still set ",
 StyleBox["Bar[ci]=ciB;Bar[ciB]=ci;",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 " for pairs of complex-conjugate symbols ",
 StyleBox["ci,ciB",
  FontFamily->"Courier"],
 "."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{"{", 
   RowBox[{"z", "->", 
    RowBox[{"x", "+", 
     RowBox[{"I", " ", "y"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"z", "\[Rule]", 
   RowBox[{"x", "+", 
    RowBox[{"I", " ", "y"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"r1", ",", 
    RowBox[{"Bar", "[", "r1", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z", "\[Rule]", 
    RowBox[{"x", "+", 
     RowBox[{"I", " ", "y"}]}]}], ",", 
   RowBox[{
    RowBox[{"Bar", "[", "z", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"Bar", "[", "x", "]"}], "-", 
     RowBox[{"I", " ", 
      RowBox[{"Bar", "[", "y", "]"}]}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bar", "[", "x_Symbol", "]"}], ":=", "x"}], ";", 
  RowBox[{
   RowBox[{"Bar", "[", "z", "]"}], "=", "zB"}], ";", 
  RowBox[{
   RowBox[{"Bar", "[", "zB", "]"}], "=", "z"}], ";", "r2"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z", "\[Rule]", 
    RowBox[{"x", "+", 
     RowBox[{"I", " ", "y"}]}]}], ",", 
   RowBox[{"zB", "\[Rule]", 
    RowBox[{"x", "-", 
     RowBox[{"I", " ", "y"}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["ScalFormQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_], ",
  FontFamily->"Courier"],
 StyleBox["BasicScalFormQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 ": return ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a (basic) differential-form expression and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise. Basic means not expressible ",
 "(as sum or product)",
 " in terms of other forms."
}], "Text",
 TextJustification->0],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"d", "[", "x", "]"}], ",", 
     RowBox[{"3", " ", 
      RowBox[{"d", "[", "x", "]"}]}], ",", "a1", ",", 
     RowBox[{"a1", "+", 
      RowBox[{"q", "[", "1", "]"}]}], ",", 
     RowBox[{"a1", "\[Wedge]", 
      RowBox[{"q", "[", "1", "]"}]}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ScalFormQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasicScalFormQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "True", ",", "False", ",", "True", ",", "False", ",", 
   "False"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox[" ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Calculations with Series", "Text",
  FontFamily->"Times",
  FontSlant->"Italic"]
}], "Subsubsection"],

Cell[TextData[{
 "\tWhen working with series expansions, one must keep in mind that the \
notation ",
 StyleBox["d[x]",
  FontFamily->"Courier"],
 " for the differential of the expansion symbol (coordinate) cannot be used \
because ",
 StyleBox["Series",
  FontFamily->"Courier"],
 " will consider ",
 StyleBox["d[x]",
  FontFamily->"Courier"],
 " a function of ",
 StyleBox["x",
  FontFamily->"Courier"],
 " and formally expand it (using ",
 StyleBox["d[0]=0",
  FontFamily->"Courier"],
 "):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "\[Prime]",
      MultilineFunction->None], "[", "0", "]"}], " ", "x"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "\[DoublePrime]",
         MultilineFunction->None], "[", "0", "]"}], "2"]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "\[DoublePrime]",
         MultilineFunction->None], "[", "0", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{
        SuperscriptBox["d", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "0", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["x", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "4"],
    SeriesData[x, 0, {}, 1, 4, 1]]}],
  SeriesData[x, 0, {
    Derivative[1][d][0], Derivative[1][d][0] + 
    Rational[1, 2] Derivative[2][d][0], Derivative[1][d][0] + 
    Rational[1, 2] Derivative[2][d][0] + Rational[1, 6] Derivative[3][d][0]}, 
   1, 4, 1]]], "Output"]
}, Open  ]],

Cell[TextData[{
 "\tOne must therefore use ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " to introduce a new symbol for the differential of that scalar variable \
(and appropriately define its exterior derivative). For example:"
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DeclareForms", "[", 
   RowBox[{"1", ",", "dx"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "x", "]"}], "=", "dx"}], ";", 
  RowBox[{
   RowBox[{"d", "[", "dx", "]"}], "=", "0"}], ";"}]}], "Input"],

Cell[TextData[{
 "Then one can do calculations with series (one can still input ",
 StyleBox["d[x]",
  FontFamily->"Courier"],
 "):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ser1", "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "x", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"dx", "+", 
   RowBox[{"dx", " ", "x"}], "+", 
   RowBox[{"dx", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"dx", " ", 
    SuperscriptBox["x", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "4"],
    SeriesData[x, 0, {}, 0, 4, 1]]}],
  SeriesData[x, 0, {dx, dx, dx, dx}, 0, 4, 1]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", "ser1", "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "x", "]"}], "3"],
  SeriesData[x, 0, {}, 3, 3, 1]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ser1", 
  StyleBox["\[Wedge]",
   FontFamily->"Courier"], "ser1"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "x", "]"}], "4"],
  SeriesData[x, 0, {}, 4, 4, 1]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{
   RowBox[{"y", "^", "2"}], " ", "ser1"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", " ", 
       RowBox[{"dx", "\[Wedge]", 
        RowBox[{"d", "[", "y", "]"}]}]}], ")"}]}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"y", " ", 
      RowBox[{"dx", "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}], ")"}], " ", "x"}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"y", " ", 
      RowBox[{"dx", "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "3"],
    SeriesData[x, 0, {}, 0, 3, 1]]}],
  SeriesData[x, 0, {((-2) y) Wedge[dx, 
      d[y]], ((-2) y) Wedge[dx, 
      d[y]], ((-2) y) Wedge[dx, 
      d[y]]}, 0, 3, 1]]], "Output"]
}, Open  ]],

Cell["\<\
\tSeries has been modified to automatically expand (to the appropriate order) \
series coefficients that depend on x:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"y", "->", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", "x"}], "]"}], "u"}]}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"u", " ", 
       RowBox[{"dx", "\[Wedge]", 
        RowBox[{"d", "[", "u", "]"}]}]}], ")"}]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "3"],
    SeriesData[x, 0, {}, 0, 3, 1]]}],
  SeriesData[x, 0, {((-2) u) Wedge[dx, 
      d[u]]}, 0, 3, 1]]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["matrixEDC", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n\t",
 StyleBox["The notebook ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" allows calculations with differential form ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["matrices",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" - both explicit (list of lists) and symbolic (special symbols \
denoting matrices).",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" ",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["In addition to the functions defined in ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[", which can now have ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["matrices",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" as arguments (except for ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["DeclareForms",
  FontFamily->"Courier",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["), the following functions / operations are defined (examples are \
given in the cells in brackets. Sections marked by  \[FilledSquare]  can be \
skipped on a first reading):",
  FontColor->RGBColor[0, 0, 1]]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["DeclareMatrixForms",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[{p1_,x_,xt_},{p2_,y_,yt_},...]",
  FontFamily->"Courier"],
 " :: allows the user to introduce his particular notation for fundamental \
(undefined) p-form ",
 StyleBox["matrices",
  FontSlant->"Italic"],
 ". ",
 StyleBox["p1",
  FontFamily->"Courier"],
 " must be a positive integer or zero (denoting the differential form degree \
of ",
 StyleBox["x_,",
  FontFamily->"Courier"],
 " ",
 StyleBox["xt_",
  FontFamily->"Courier"],
 ") and ",
 StyleBox["x_,",
  FontFamily->"Courier"],
 " ",
 StyleBox["xt_",
  FontFamily->"Courier"],
 "  are symbols denoting a p1-form matrix and its transpose, respectively. \
For example, evaluating the command ",
 StyleBox["DeclareMatrixForms[{0,S,S},{1,U,-U},{1,Q,Qt}]",
  FontFamily->"Courier"],
 " has the effect that, in all subsequent calculations, the symbol  ",
 StyleBox["S",
  FontFamily->"Courier"],
 "  will be treated as a 0-form symmetric matrix, the symbol  ",
 StyleBox["U",
  FontFamily->"Courier"],
 "  as an 1-form antisymmetric matrix, and the symbols  ",
 StyleBox["Q,",
  FontFamily->"Courier"],
 " ",
 StyleBox["Qt",
  FontFamily->"Courier"],
 "  as 1-form matrices which are transposes of each other. "
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "S", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     StyleBox["U",
      FontFamily->"Courier"], ",", 
     RowBox[{"-", 
      StyleBox["U",
       FontFamily->"Courier"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Q", ",", "Qt"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"S", "\[Wedge]", 
   StyleBox["U",
    FontFamily->"Courier"]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"U", "\[Wedge]", "S"}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormDegree", "[", "%", "]"}]], "Input"],

Cell[BoxData["1"], "Output"]
}, Open  ]],

Cell["\<\
One can also use indexed variables to denote sets of matrices with common \
properties. For example, after evaluating the command \
\>", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 StyleBox[
  RowBox[{"DeclareMatrixForms", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"S0", "[", "_", "]"}], ",", 
      RowBox[{"S0", "[", "_", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"A1", "[", "_", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"A1", "[", "_", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"N1", "[", "_", "]"}], ",", 
      RowBox[{"N1t", "[", "_", "]"}]}], "}"}]}], "]"}],
  FontFamily->"Courier"]], "Input"],

Cell[TextData[{
 "the symbols",
 StyleBox[" S0[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["S0[2],...",
  FontFamily->"Courier"],
 " are treated as ",
 StyleBox["symmetric 0-form",
  FontSlant->"Italic"],
 " matrices, the symbols ",
 StyleBox["A1[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["A1[2],...",
  FontFamily->"Courier"],
 " as ",
 StyleBox["antisymmetric 1-form",
  FontSlant->"Italic"],
 " matrices, and the symbols ",
 StyleBox["N1[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["N1[2],..., N1t[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["N1t[2],...",
  FontFamily->"Courier"],
 ", as ",
 StyleBox["1-form",
  FontSlant->"Italic"],
 " matrices which are, respectively, transposes of each other."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{"N1", "[", "2", "]"}], "\[Wedge]", 
   RowBox[{"S0", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"N1", "[", "1", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"N1t", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"S0", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"N1t", "[", "2", "]"}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "The minus sign is correct - the ",
 StyleBox["N1[i]",
  FontFamily->"Courier"],
 " are ",
 StyleBox["1-form",
  FontSlant->"Italic"],
 " matrices!\n",
 StyleBox["N",
  FontFamily->"Times",
  FontWeight->"Bold"],
 StyleBox["ote ",
  FontWeight->"Bold"],
 ": No special symbol is used for the identity matrix, as it is not needed in \
symbolic calculations. The functions ",
 StyleBox["tr",
  FontFamily->"Courier"],
 " and ",
 StyleBox["toComponents",
  FontFamily->"Courier"],
 " have been defined so as to take into account the missing identity matrix."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14]
}, Closed]],

Cell[TextData[{
 StyleBox["Transpose",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: the built-in definition of ",
 StyleBox["Transpose",
  FontFamily->"Courier"],
 " is extended so that it handles properly symbolic matrix expressions \
containing the symbols introduced with ",
 StyleBox["DeclareMatrixForms",
  FontFamily->"Courier"],
 ". "
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["SymQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: returns ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["Transpose[x]=x",
  FontFamily->"Courier"],
 " and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise.",
 "\n",
 StyleBox["AntisymQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " ::returns ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["Transpose[x]=-x",
  FontFamily->"Courier"],
 " and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["\tIn ",
  FontWeight->"Plain"],
 StyleBox["SymQ/AntisymQ",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox["  equality is determined after taking into account the \
simplification rules contained in ",
  FontWeight->"Plain"],
 StyleBox["simpRules",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "a", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "a", "]"}], "2"]}], ")"}], 
    RowBox[{
     RowBox[{"S0", "[", "1", "]"}], "\[Wedge]", 
     RowBox[{"A1", "[", "1", "]"}]}]}], "+", 
   RowBox[{
    RowBox[{"A1", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"S0", "[", "1", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "a", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "a", "]"}], "2"]}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"A1", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"S0", "[", "1", "]"}]}]}], "-", 
  RowBox[{
   RowBox[{"S0", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"A1", "[", "1", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AntisymQ", "[", "%", "]"}]], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["MatQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_], ",
  FontFamily->"Courier"],
 StyleBox["BasicMatQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 ": return ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a (basic) matrix expression and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise. Basic means not expressible (as sum or product) in terms of \
other matrices."
}], "Text",
 TextJustification->0],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"d", "[", "x", "]"}], ",", "S", ",", 
     RowBox[{"d", "[", "S", "]"}], ",", 
     RowBox[{
      RowBox[{"N1", "[", "2", "]"}], "+", 
      RowBox[{"N1t", "[", "2", "]"}]}], ",", 
     RowBox[{"S", "\[Wedge]", "U"}], ",", 
     RowBox[{
      RowBox[{"d", "[", "x", "]"}], "\[Wedge]", "U"}], ",", 
     RowBox[{"Bar", "[", 
      RowBox[{"N1", "[", "_", "]"}], "]"}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasicMatQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "False", ",", "True", ",", "True", ",", "False", ",", "False",
    ",", "False", ",", "True"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["tr",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: returns the trace of the matrix expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ". If  ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a scalar, it is assumed to multiply the identity matrix, and thus ",
 StyleBox["tr",
  FontFamily->"Courier"],
 " returns ",
 StyleBox["x*matDimension",
  FontFamily->"Courier"],
 ", where ",
 StyleBox["matDimension",
  FontFamily->"Courier"],
 " is a global variable to be assigned by the user. \nWhen ",
 StyleBox["tr",
  FontFamily->"Courier"],
 "  acts on products of symbolic matrices, it can apply the cyclic property \
of trace (as well as the fact that ",
 StyleBox["tr[Transpose[x]]=tr[x]",
  FontFamily->"Courier"],
 "), to reduce its argument to a \"canonical\" form. It can thus be made to \
recognize that the trace of the matrix expression ",
 StyleBox["2",
  FontFamily->"Courier"],
 " ",
 StyleBox["A\[Wedge]B\[Wedge]C-C\[Wedge]A\[Wedge]B-At\[Wedge]Ct\[Wedge]Bt",
  FontFamily->"Courier"],
 " is identically zero (for 0-form matrices ",
 StyleBox["A,B,C",
  FontFamily->"Courier"],
 " with transposes ",
 StyleBox["At,Bt,Ct",
  FontFamily->"Courier"],
 " respectively)."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "A", ",", "At"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "B", ",", "Bt"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "C", ",", "Ct"}], "}"}]}], "]"}]], "Input"],

Cell[TextData[{
 "The behavior of ",
 StyleBox["tr",
  FontFamily->"Courier"],
 " is controlled by the value of the global variable ",
 StyleBox["traceOption",
  FontFamily->"Courier"],
 ",  as can be seen in the following examples:"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "=", 
   RowBox[{"{", 
    RowBox[{"At", ",", 
     RowBox[{"Ct", "\[Wedge]", "Bt"}], ",", 
     RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], ",", 
     RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt", "\[Wedge]", "At"}], 
     ",", 
     RowBox[{
      RowBox[{
       StyleBox["2",
        FontFamily->"Courier"], " ", 
       StyleBox[
        RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "C"}],
        FontFamily->"Courier"]}], 
      StyleBox["-",
       FontFamily->"Courier"], 
      StyleBox[
       RowBox[{"C", "\[Wedge]", "A", "\[Wedge]", "B"}],
       FontFamily->"Courier"], 
      StyleBox["-",
       FontFamily->"Courier"], 
      StyleBox[
       RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}],
       FontFamily->"Courier"]}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceOption", "=", "0"}], ";", 
   RowBox[{"tr", "/@", "testExpr"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", 
     StyleBox[" ",
      FontColor->RGBColor[0, 1, 0]], 
     StyleBox["No",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["rules",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["applied",
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[",",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[
     RowBox[{"other", " ", "than", " ", "linearity"}],
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", "A", "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"Ct", "\[Wedge]", "Bt"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt", "\[Wedge]", "At"}], 
    "]"}], ",", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"tr", "[", 
      RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "C"}], "]"}]}], "-", 
    RowBox[{"tr", "[", 
     RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], "]"}], "-", 
    RowBox[{"tr", "[", 
     RowBox[{"C", "\[Wedge]", "A", "\[Wedge]", "B"}], "]"}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceOption", "=", "1"}], ";", 
   RowBox[{"tr", "/@", "testExpr"}]}], 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    StyleBox["Only",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["cyclic",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["rule",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["applied",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", "A", "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"Bt", "\[Wedge]", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", "\[Wedge]", "At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], 
    "]"}], ",", 
   RowBox[{
    RowBox[{"tr", "[", 
     RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "C"}], "]"}], "-", 
    RowBox[{"tr", "[", 
     RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], "]"}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceOption", "=", "2"}], ";", 
   RowBox[{"tr", "/@", "testExpr"}]}], 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    StyleBox["Cyclic",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["and",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["Transpose",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["rules",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["applied",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", "A", "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"B", "\[Wedge]", "C"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "C"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "C"}], "]"}], 
   ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Note that, for single matrices, ",
 StyleBox["tr[At]=tr[A]",
  FontFamily->"Courier"],
 " independently of ",
 StyleBox["traceOption. \n\t",
  FontFamily->"Courier"],
 StyleBox["Warning",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 ": ",
 StyleBox["The default value of ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["traceOption",
  FontFamily->"Courier",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["  is ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["2",
  FontFamily->"Courier",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox[", to allow maximum simplification of complicated  ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["tr",
  FontFamily->"Courier",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["  expressions. However,",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["this value can sometimes lead to infinite loops",
  FontWeight->"Plain"],
 StyleBox[" if used together with a commutator rule like ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["S0[1]\[Wedge]S0[3]->S0[3]\[Wedge]S0[1]+2I",
  FontFamily->"Courier"],
 " ",
 StyleBox["S0[2]",
  FontFamily->"Courier"],
 " which reverses the canonical order of matrix products."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[TextData[{
 StyleBox["tr",
  FontFamily->"Courier"],
 " applies other rules also; for example, since ",
 StyleBox["S",
  FontFamily->"Courier"],
 " is a symmetric 0-form matrix and ",
 StyleBox["U",
  FontFamily->"Courier"],
 " antisymmetric, "
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tr", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "\[Wedge]", 
      StyleBox["U",
       FontFamily->"Courier"]}], ",", 
     RowBox[{"S", "\[Wedge]", 
      StyleBox["U",
       FontFamily->"Courier"], "\[Wedge]", "S", "\[Wedge]", "S"}]}], "}"}]}], 
  " "}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["toComponents",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_,rul_List]",
  FontFamily->"Courier"],
 ":: returns the component form of the symbolic matrix expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ", introducing the identity matrix where needed. The components of the basic \
symbolic matrices must be given as a set of replacement rules in the list ",
 StyleBox["rul",
  FontFamily->"Courier"],
 " and must satisfy the assumed matrix symmetries. If ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a scalar, ",
 StyleBox["toComponents",
  FontFamily->"Courier"],
 " returns ",
 StyleBox["x*IdentityMatrix[matDimension]",
  FontFamily->"Courier"],
 ".\n",
 StyleBox["Note",
  FontWeight->"Bold"],
 " : If the components of a p-form matrix are ",
 StyleBox["undefined",
  FontSlant->"Italic"],
 " scalar p-forms, ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " must be used to introduce them. For example, if ",
 StyleBox["U",
  FontFamily->"Courier"],
 " has been declared an antisymmetric 1-form matrix, and ",
 StyleBox["rul",
  FontFamily->"Courier"],
 " gives the components of ",
 StyleBox["U",
  FontFamily->"Courier"],
 "  in terms of the ",
 StyleBox["undefined",
  FontSlant->"Italic"],
 " scalar 1-forms ",
 StyleBox["u1,",
  FontFamily->"Courier"],
 " ",
 StyleBox["u2,",
  FontFamily->"Courier"],
 " ",
 StyleBox["u3,",
  FontFamily->"Courier"],
 " one must evaluate ",
 StyleBox["DeclareForms[1,u1,u2,u3]",
  FontFamily->"Courier"],
 " before using ",
 StyleBox["toComponents",
  FontFamily->"Courier"],
 "."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matDimension", "=", "3"}], ";"}], "\n", 
 RowBox[{"matComp", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "->", 
     RowBox[{"Array", "[", 
      RowBox[{"Ac", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"At", "->", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Array", "[", 
       RowBox[{"Ac", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"S", "->", 
     RowBox[{"Array", "[", 
      RowBox[{"Sc", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{
     StyleBox["U",
      FontFamily->"Courier"], "->", 
     RowBox[{"Array", "[", 
      RowBox[{"ucomp", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"At", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"S", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"U", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ucomp", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ucomp", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ucomp", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell["\<\
The components must be made to satisfy the assumed matrix symmetries, and \
must be declared to have the appropriate differential form degree (if >0):\
\>", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sc", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sc", "[", 
     RowBox[{"j", ",", "i"}], "]"}], "/;", 
    RowBox[{"i", ">", "j"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ucomp", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Signature", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], 
     RowBox[{"uc", "[", "k", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "3"}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"DeclareForms", "[", 
  RowBox[{"1", ",", 
   RowBox[{"uc", "[", "_", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["matComp"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"At", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"S", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"U", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"uc", "[", "3", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
        RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uc", "[", "2", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"S", "\[Wedge]", 
     StyleBox["U",
      FontFamily->"Courier"]}], ",", "matComp"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "2", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"uc", "[", "3", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sc", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], " ", 
        RowBox[{"uc", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"uc", "[", "3", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"uc", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"uc", "[", "2", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "2", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"uc", "[", "3", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sc", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], " ", 
        RowBox[{"uc", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"uc", "[", "3", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"uc", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"uc", "[", "2", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "2", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "3", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sc", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}], " ", 
        RowBox[{"uc", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "3", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"uc", "[", "2", "]"}]}]}]}
    }], ")"}],
  MatrixForm[#]& ]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%", "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormDegree", "[", "%%", "]"}]], "Input"],

Cell[BoxData["1"], "Output"]
}, Open  ]],

Cell[TextData[{
 StyleBox["toComponents",
  FontFamily->"Courier"],
 " understands that, in the expression  ",
 StyleBox["A",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["lamda",
  FontFamily->"Courier"],
 ", the scalar ",
 StyleBox["lamda",
  FontFamily->"Courier"],
 " multiplies the identity matrix:"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"A", " ", "+", " ", "lamda"}], ",", "matComp"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", GridBox[{
     {
      RowBox[{"lamda", "+", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "2"}], "]"}], 
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "3"}], "]"}]},
     {
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "1"}], "]"}], 
      RowBox[{"lamda", "+", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "3"}], "]"}]},
     {
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "1"}], "]"}], 
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "2"}], "]"}], 
      RowBox[{"lamda", "+", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]}
    }], ")"}],
  MatrixForm[#]& ]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", "lamda"}], "+", 
  RowBox[{"Ac", "[", 
   RowBox[{"1", ",", "1"}], "]"}], "+", 
  RowBox[{"Ac", "[", 
   RowBox[{"2", ",", "2"}], "]"}], "+", 
  RowBox[{"Ac", "[", 
   RowBox[{"3", ",", "3"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"A", " ", "+", " ", "lamda"}], ")"}], "\[Wedge]", 
  RowBox[{"Transpose", "[", 
   RowBox[{"A", " ", "+", " ", "lamda"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "lamda"}], "+", 
  RowBox[{"At", " ", "lamda"}], "+", 
  SuperscriptBox["lamda", "2"], "+", 
  RowBox[{"A", "\[Wedge]", "At"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["lamda", "2"]}], "+", 
  RowBox[{"2", " ", "lamda", " ", 
   RowBox[{"tr", "[", "A", "]"}]}], "+", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "At"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{"%%", ",", "matComp"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", GridBox[{
     {
      RowBox[{
       SuperscriptBox["lamda", "2"], "+", 
       RowBox[{"2", " ", "lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "2"]}], 
      RowBox[{
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "+", 
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox["lamda", "2"], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "2"], "+", 
       RowBox[{"2", " ", "lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "2"]}], 
      RowBox[{
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "+", 
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{"lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox["lamda", "2"], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}], "2"], "+", 
       RowBox[{"2", " ", "lamda", " ", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}], "2"]}]}
    }], ")"}],
  MatrixForm[#]& ]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymQ", "[", "%", "]"}]], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["lamda", "2"]}], "+", 
  RowBox[{"2", " ", "lamda", " ", 
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "2"], "+", 
  RowBox[{"2", " ", "lamda", " ", 
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "3"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "2"], "+", 
  RowBox[{"2", " ", "lamda", " ", 
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "3"}], "]"}], "2"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", "lamda", ",", "Factor"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["lamda", "2"]}], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "3"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "3"}], "]"}], "2"], "+", 
  RowBox[{"2", " ", "lamda", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "+", 
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "+", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"matDimension", "=."}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["CHrul",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[n_Integer, mat_:$]",
  FontFamily->"Courier"],
 ":: returns a rule for implementing the Cayley-Hamilton theorem for the n x \
n  0-form matrix ",
 StyleBox["mat",
  FontFamily->"Courier"],
 ". The second argument is optional; if it is missing ",
 StyleBox["CHrul",
  FontFamily->"Courier"],
 " returns a delayed rule that can be applied to any n x n  0-form matrix. ",
 StyleBox["CHrul",
  FontFamily->"Courier"],
 " introduces the symbol ",
 StyleBox["$",
  FontFamily->"Courier"],
 " as a 0-form matrix. After calling ",
 StyleBox["CHrul",
  FontFamily->"Courier"],
 ", ",
 StyleBox["matDimension",
  FontFamily->"Courier"],
 " is set to ",
 StyleBox["n",
  FontFamily->"Courier"],
 ". "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CHrul", "[", 
  RowBox[{"3", ",", "A"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "\[Rule]", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"tr", "[", "A", "]"}], "3"], "6"], "+", 
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"tr", "[", "A", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"tr", "[", 
         RowBox[{"A", "\[Wedge]", "A"}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"tr", "[", "A", "]"}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{"A", "\[Wedge]", "A"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"tr", "[", 
      RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"tr", "[", "A", "]"}], " ", 
     RowBox[{"A", "\[Wedge]", "A"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3", "=", 
  RowBox[{"CHrul", "[", "3", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"$_", "\[Wedge]", "$_", "\[Wedge]", "$_"}], "]"}], 
   "\[RuleDelayed]", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"tr", "[", "$", "]"}], "3"], "6"], "+", 
     RowBox[{"$", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"tr", "[", "$", "]"}], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"tr", "[", 
          RowBox[{"$", "\[Wedge]", "$"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"tr", "[", "$", "]"}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"$", "\[Wedge]", "$"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"$", "\[Wedge]", "$", "\[Wedge]", "$"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"tr", "[", "$", "]"}], " ", 
      RowBox[{"$", "\[Wedge]", "$"}]}]}], "/;", 
    RowBox[{
     RowBox[{"MatQ", "[", "$", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "$", "]"}], "===", "0"}], "&&", 
     RowBox[{"matDimension", "===", "3"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 StyleBox["The rule applies only when ",
  FontWeight->"Plain"],
 StyleBox["$",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" is a 0-form matrix expression. The pattern matches products of \
matrices also:",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
   "A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "A", 
    "\[Wedge]", "B", "\[Wedge]", "A"}], "/.", "CH3"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "6"], " ", 
      SuperscriptBox[
       RowBox[{"tr", "[", 
        RowBox[{"A", "\[Wedge]", "B"}], "]"}], "3"]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"A", "\[Wedge]", "B"}], "]"}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{
       "A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", 
        "A", "\[Wedge]", "B"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"tr", "[", 
        RowBox[{"A", "\[Wedge]", "B"}], "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B"}], 
       "]"}]}]}], ")"}], " ", 
   RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "A"}]}], "+", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"A", "\[Wedge]", "B"}], "]"}], " ", 
   RowBox[{
   "A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", 
    "A"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH4", "=", 
  RowBox[{"CHrul", "[", "4", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"$_", "\[Wedge]", "$_", "\[Wedge]", "$_", "\[Wedge]", "$_"}], 
    "]"}], "\[RuleDelayed]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "24"]}], " ", 
      SuperscriptBox[
       RowBox[{"tr", "[", "$", "]"}], "4"]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"tr", "[", "$", "]"}], "2"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"$", "\[Wedge]", "$"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "8"], " ", 
      SuperscriptBox[
       RowBox[{"tr", "[", 
        RowBox[{"$", "\[Wedge]", "$"}], "]"}], "2"]}], "+", 
     RowBox[{"$", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"tr", "[", "$", "]"}], "3"], "6"], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"tr", "[", "$", "]"}], " ", 
         RowBox[{"tr", "[", 
          RowBox[{"$", "\[Wedge]", "$"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "3"], " ", 
         RowBox[{"tr", "[", 
          RowBox[{"$", "\[Wedge]", "$", "\[Wedge]", "$"}], "]"}]}]}], ")"}]}],
      "-", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"tr", "[", "$", "]"}], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"$", "\[Wedge]", "$", "\[Wedge]", "$"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"$", "\[Wedge]", "$", "\[Wedge]", "$", "\[Wedge]", "$"}], 
       "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"tr", "[", "$", "]"}], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"tr", "[", 
          RowBox[{"$", "\[Wedge]", "$"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"$", "\[Wedge]", "$"}]}], "+", 
     RowBox[{
      RowBox[{"tr", "[", "$", "]"}], " ", 
      RowBox[{"$", "\[Wedge]", "$", "\[Wedge]", "$"}]}]}], "/;", 
    RowBox[{
     RowBox[{"MatQ", "[", "$", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "$", "]"}], "===", "0"}], "&&", 
     RowBox[{"matDimension", "===", "4"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Now ",
 StyleBox["matDimension",
  FontFamily->"Courier"],
 " is set to 4, so ",
 StyleBox["CH3",
  FontFamily->"Courier"],
 " has no effect:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
   "A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "A", 
    "\[Wedge]", "B", "\[Wedge]", "A"}], "/.", "CH3"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", 
  "A", "\[Wedge]", "B", "\[Wedge]", "A"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["\t",
  FontWeight->"Bold"],
 StyleBox["Warning",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" ",
  FontWeight->"Bold"],
 ": ",
 StyleBox["The rules returned by ",
  FontWeight->"Plain"],
 StyleBox["CHrul",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" must never be applied repeatedly (",
  FontWeight->"Plain"],
 StyleBox["//.",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox["), as there is a term on the rhs that matches the lhs (",
  FontWeight->"Plain"],
 StyleBox["tr[lhs]",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox["),  To apply these rules repeatedly, one must use another symbol, \
say ",
  FontWeight->"Plain"],
 StyleBox["trnA",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[", for the trace of the product of n A matrices.",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TimeConstrained", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "//.", 
    RowBox[{"CHrul", "[", 
     RowBox[{"3", ",", "A"}], "]"}]}], ",", "3"}], "]"}]], "Input"],

Cell[BoxData["$Aborted"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "//.", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CHrul", "[", 
      RowBox[{"3", ",", "A"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"tr", "[", 
       RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "]"}], "->", 
      "tr3A"}]}], ")"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.0499999999999989341`", " ", "Second"}], ",", 
   RowBox[{
    FractionBox["tr3A", "3"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"tr", "[", "A", "]"}], "3"], "6"], "+", 
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"tr", "[", "A", "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"tr", "[", 
         RowBox[{"A", "\[Wedge]", "A"}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"tr", "[", "A", "]"}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{"A", "\[Wedge]", "A"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"tr", "[", "A", "]"}], " ", 
     RowBox[{"A", "\[Wedge]", "A"}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Note ",
  FontWeight->"Bold"],
 ": ",
 StyleBox["Wedge,",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" instead of ",
  FontWeight->"Plain"],
 StyleBox["Dot",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[",  must be used to multiply matrices together and scalar \
differential forms with matrices. ",
  FontWeight->"Plain"],
 StyleBox["Wedge",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" can handle both symbolic and explicit matrices (list of lists). ",
  
  FontWeight->"Plain"],
 StyleBox["Wedge",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" also gives the correct result when multiplying explicit matrices \
(two-dim arrays) with vectors (one-dim arrays), but operations with symbolic \
vectors are not supported. For example:",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mat", "=", 
  RowBox[{"A", "/.", "matComp"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "1"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "2"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", "=", 
  RowBox[{"Array", "[", 
   RowBox[{"v", ",", 
    RowBox[{"{", "3", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", "1", "]"}], ",", 
   RowBox[{"v", "[", "2", "]"}], ",", 
   RowBox[{"v", "[", "3", "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareForms", "[", 
  RowBox[{"1", ",", 
   RowBox[{"v", "[", "_", "]"}]}], "]"}]], "Input"],

Cell[TextData[{
 "(i.e., ",
 StyleBox["Vec",
  FontFamily->"Courier"],
 " is an 1-form vector)"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mat", 
  StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "1"}], "]"}], " ", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "2"}], "]"}], " ", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "3"}], "]"}], " ", 
     RowBox[{"v", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "2"}], "]"}], " ", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "3"}], "]"}], " ", 
     RowBox[{"v", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "1"}], "]"}], " ", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "2"}], "]"}], " ", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "3"}], "]"}], " ", 
     RowBox[{"v", "[", "3", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", 
  StyleBox["\[Wedge]", "Output\[Times]"], "Mat"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "1"}], "]"}], " ", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "1"}], "]"}], " ", 
     RowBox[{"v", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "2"}], "]"}], " ", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "2"}], "]"}], " ", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "2"}], "]"}], " ", 
     RowBox[{"v", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "3"}], "]"}], " ", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "3"}], "]"}], " ", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "3"}], "]"}], " ", 
     RowBox[{"v", "[", "3", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"Vec", 
   StyleBox["\[Wedge]", "Output\[Times]"], "Mat", 
   StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "-", 
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "1"}], "]"}]}], ")"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"v", "[", "2", "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "3"}], "]"}], "-", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "1"}], "]"}]}], ")"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"v", "[", "3", "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "3"}], "]"}], "-", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "2"}], "]"}]}], ")"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
    RowBox[{"v", "[", "3", "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", 
  StyleBox["\[Wedge]", "Output\[Times]"], 
  RowBox[{"d", "[", "Vec", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", 
    RowBox[{"v", "[", "1", "]"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", 
    RowBox[{"v", "[", "2", "]"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"v", "[", "3", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", 
    RowBox[{"v", "[", "3", "]"}], "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", 
  StyleBox["\[Wedge]", "Output\[Times]"], "Mat", 
  StyleBox["\[Wedge]", "Output\[Times]"], 
  RowBox[{"d", "[", "Vec", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "1"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "1", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "2"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "2", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"1", ",", "3"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "3", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "1"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "1", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "2"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "2", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"2", ",", "3"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "3", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "1"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "3", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "1", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "2"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "3", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "2", "]"}], "]"}]}]}], "+", 
  RowBox[{
   RowBox[{"Ac", "[", 
    RowBox[{"3", ",", "3"}], "]"}], " ", 
   RowBox[{
    RowBox[{"v", "[", "3", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "3", "]"}], "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", "x", "]"}], 
  StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"v", "[", "1", "]"}]}], ",", 
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"v", "[", "2", "]"}]}], ",", 
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"v", "[", "3", "]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", "Mat", "]"}], 
  StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "3", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"Vec", 
   StyleBox["\[Wedge]", "Output\[Times]"], "%"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
     RowBox[{"v", "[", "2", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Ac", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Ac", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Ac", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Ac", "[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Ac", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "2", "]"}], "\[Wedge]", 
   RowBox[{"v", "[", "3", "]"}]}]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Introducing Custom Notation", "Text",
  FontFamily->"Times",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" :", "Text",
  FontFamily->"Times",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" Sometimes one may want to use a shorthand notation of the form ", 
  "Text",
  FontFamily->"Times",
  FontWeight->"Plain"],
 StyleBox["K[A]", "Text",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" for an operation with matrices (or other variables) that should \
not be interpreted as a function under ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain"],
 StyleBox["d", "Text",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[". I.e., one wants to avoid the following", "Text",
  FontFamily->"Times",
  FontWeight->"Plain"]
}], "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Inverse", "[", "S", "]"}], ",", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"form", ",", "vars"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "S", "]"}], " ", 
    RowBox[{
     SuperscriptBox["Inverse", "\[Prime]",
      MultilineFunction->None], "[", "S", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "vars", "]"}], " ", 
     RowBox[{
      SuperscriptBox["MyNotation", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"form", ",", "vars"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", "form", "]"}], " ", 
     RowBox[{
      SuperscriptBox["MyNotation", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"form", ",", "vars"}], "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "This can be achieved by: \t(1) Calling the function ",
 StyleBox["NoDif[heads__]",
  FontFamily->"Courier"],
 ", \n\t\t\t\t(2) Setting the value of ",
 StyleBox["FormDegree[..]",
  FontFamily->"Courier"],
 " if > 0 and\n\t\t\t\t(3) Setting the values of ",
 StyleBox["BasicMatQ[..]",
  FontFamily->"Courier"],
 " / ",
 StyleBox["BasicScalFormQ[..]",
  FontFamily->"Courier"],
 " if ",
 StyleBox["True. \n",
  FontFamily->"Courier"],
 "For example,"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NoDif", "[", 
   RowBox[{"Inverse", ",", "MyNotation"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicMatQ", "[", 
    RowBox[{"Inverse", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{"BasicMatQ", "[", "x", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FormDegree", "[", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
   RowBox[{"FormDegree", "[", "y", "]"}]}], ";"}]}], "Input"],

Cell[TextData[{
 "Now ",
 StyleBox["d",
  FontFamily->"Courier"],
 " has no effect"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Inverse", "[", "S", "]"}], ",", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"form", ",", "vars"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Inverse", "[", "S", "]"}], "]"}], ",", 
   RowBox[{"d", "[", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"form", ",", "vars"}], "]"}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
One can then assign values for the exterior derivatives of these operations \
and make other definitions:\
\>", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Inverse", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"Inverse", "[", "x", "]"}]}], ")"}]}], "/;", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x_", "\[Wedge]", 
    RowBox[{"Inverse", "[", "x_", "]"}]}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "x_", "]"}], "\[Wedge]", "x_"}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{"S", "\[Wedge]", 
  RowBox[{"d", "[", 
   RowBox[{"Inverse", "[", "S", "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"d", "[", "S", "]"}], "\[Wedge]", 
    RowBox[{"Inverse", "[", "S", "]"}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Of course, for a single matrix, it is much simpler to use a new symbol  ",
 StyleBox["DeclareMatrixForms[{0,invS,invS}]",
  FontFamily->"Courier"],
 " and then set ",
 StyleBox["d[invS]=-(invS",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["d[S]",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["invS);invS",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["S=1;S",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["invS=1;",
  FontFamily->"Courier"],
 "!"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14]
}, Closed]]
}, Closed]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["Sample Applications in Mathematical Physics", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n",
 StyleBox["Important",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ": Before proceeding, evaluate ",
 StyleBox["matEDCcode.nb",
  FontWeight->"Bold"],
 " to clear all previously defined symbols.\n\t",
 StyleBox["(All timings refer to an Apple iBook G3/900 computer running ",
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["Mathematica",
  FontSize->14,
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" 3.0 under Mac OS 9.2.2)",
  FontSize->14,
  FontWeight->"Plain"]
}], "Text",
 PageWidth->WindowWidth,
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["\<\
(1) Computing all Newman-Penrose scalars for the Vaidya metric (~ 25 sec)\
\>", "Subsection",
 ShowGroupOpener->True],

Cell[TextData[{
 "The following code calculates all Newman-Penrose scalars for the Vaidya \
metric and checks the cyclic and Bianchi idendities.\n(Takes  ~ 25 sec with \
",
 StyleBox["matEDCcode",
  FontWeight->"Bold"],
 " and ~ 21 sec with ",
 StyleBox["scalEDCcode",
  FontWeight->"Bold"],
 ". More than half of this time is spent in checking the identities). \nTo do \
the same calculation for other metrics make appropriate changes to the \
null-frame ",
 StyleBox["\[DoubleStruckL],\[DoubleStruckM],\[DoubleStruckM]B,\
\[DoubleStruckN]",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 " definitions. For complicated metrics additional simplification statements \
(or rules in ",
 StyleBox["simpRules",
  FontFamily->"Courier"],
 ") may be needed."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"Bar", "[", "x_", "]"}], ":=", "x"}], ";", 
  RowBox[{"sT", "=", 
   RowBox[{"TimeUsed", "[", "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[TextData[{
 "\tDEFINE NULL FRAME  ",
 StyleBox["\[DoubleStruckL],\[DoubleStruckM],\[DoubleStruckM]B,\
\[DoubleStruckN]",
  FontFamily->"Courier",
  FontWeight->"Bold"]
}], "Subsubsection",
 ShowGroupOpener->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Delta0", "=", 
    RowBox[{
     SuperscriptBox["r", "2"], "+", 
     SuperscriptBox["a", "2"]}]}], " ", ";", 
   RowBox[{"Delta", "=", 
    RowBox[{"Delta0", "-", 
     RowBox[{"2", "M", " ", "r"}]}]}], ";", 
   RowBox[{"Sigma", "=", 
    RowBox[{
     SuperscriptBox["r", "2"], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["x", "2"]}]}]}], ";"}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", " ", 
      StyleBox["x",
       FontColor->RGBColor[0, 0, 1]]}], 
     StyleBox["=",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}],
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], "**)"}],
   FontSlant->"Plain",
   FontTracking->"Plain",
   FontVariations->{"Outline"->False,
   "Shadow"->False,
   "Underline"->False}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BaseFrame", "=", 
   RowBox[{"reWrite", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"d", "[", "t", "]"}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], ")"}], " ", 
        RowBox[{"d", "[", "\[CurlyPhi]", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Sigma", "/", "Delta"}], " ", 
       RowBox[{"d", "[", "r", "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "Sigma"}], " ", 
       RowBox[{
        RowBox[{"d", "[", "x", "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"d", "[", "t", "]"}]}], "-", 
       RowBox[{"Delta0", " ", 
        RowBox[{"d", "[", "\[CurlyPhi]", "]"}]}]}]}], "}"}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["Transform",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["t",
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[",",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[
     RowBox[{"\[CurlyPhi]", " ", "coordinates"}],
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "t", "]"}], "=", 
    RowBox[{
     RowBox[{"d", "[", "u", "]"}], "+", 
     RowBox[{"Delta0", " ", 
      RowBox[{
       RowBox[{"d", "[", "r", "]"}], "/", "Delta"}]}]}]}], ";", 
   RowBox[{
    RowBox[{"d", "[", "\[CurlyPhi]", "]"}], "=", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "+", 
     RowBox[{"a", " ", 
      RowBox[{
       RowBox[{"d", "[", "r", "]"}], "/", "Delta"}]}]}]}], ";"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lCoef", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";"}], "\n", 
 RowBox[{"\[DoubleStruckL]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"lCoef", ".", "BaseFrame"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], "+", 
  RowBox[{"d", "[", "u", "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nCoef", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], 
    RowBox[{"Delta", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "Sigma"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{"\[DoubleStruckN]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"nCoef", ".", "BaseFrame"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "-", 
      RowBox[{"2", " ", "M", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]], "+", 
  RowBox[{"d", "[", "r", "]"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "-", 
      RowBox[{"2", " ", "M", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"d", "[", "u", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mCoef", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"I", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{"x", "^", "2"}]}], "]"}]}]}], "}"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", " ", "Sigma"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{"\[DoubleStruckM]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"mCoef", ".", "BaseFrame"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"dx", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "-", 
  FractionBox[
   RowBox[{"I", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "+", 
  FractionBox[
   RowBox[{"I", " ", "a", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    RowBox[{"d", "[", "u", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[DoubleStruckM]B", "=", 
   RowBox[{"Bar", "[", "\[DoubleStruckM]", "]"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LineElement", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"2", "\[DoubleStruckL]", "*", "\[DoubleStruckN]"}], "-", 
    RowBox[{"2", "\[DoubleStruckM]", "*", "\[DoubleStruckM]B"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[DoubleStruckM]", " ", "\[DoubleStruckM]B"}], 
   "+", 
   RowBox[{"2", " ", "\[DoubleStruckL]", " ", "\[DoubleStruckN]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.585401368929088*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "a", "]"}], "=", "0"}], ";", 
   RowBox[{"M", "=", 
    RowBox[{"m", "[", "u", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"*", " ", 
      StyleBox["Vaidya",
       FontColor->RGBColor[0, 0, 1]]}], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["-",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[
      RowBox[{"for", " ", "Kerr", " ", "set", " ", 
       RowBox[{"d", "[", "M", "]"}]}],
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox["=",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["0",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[TextData[{
 "\t",
 StyleBox["END DEFINE METRIC",
  FontWeight->"Bold"],
 " "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iden", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"I", " ", 
    RowBox[{
    "\[DoubleStruckL]", "\[Wedge]", "\[DoubleStruckN]", "\[Wedge]", 
     "\[DoubleStruckM]", "\[Wedge]", "\[DoubleStruckM]B"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["x", "2"]}]}], ")"}], " ", 
  RowBox[{"dx", "\[Wedge]", 
   RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "u", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"star4", "=", 
  RowBox[{
   RowBox[{"Times", "[", 
    RowBox[{"u__", ",", 
     RowBox[{"Wedge", "[", "x_", "]"}]}], "]"}], ":>", 
   RowBox[{"Times", "[", "u", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u__", " ", 
   RowBox[{"Wedge", "[", "x_", "]"}]}], "\[RuleDelayed]", 
  RowBox[{"Times", "[", "u", "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vol", "=", 
  RowBox[{"iden", "/.", "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], "+", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["x", "2"]}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Define the self-dual 2-forms ",
 StyleBox["f[i]",
  FontFamily->"Courier"],
 ":"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "0", "]"}], "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"\[DoubleStruckM]", "\[Wedge]", "\[DoubleStruckL]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "+", 
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "-", 
  FractionBox[
   RowBox[{"I", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   SqrtBox["2"]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "1", "]"}], "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[DoubleStruckM]", "\[Wedge]", "\[DoubleStruckM]B"}], "-", 
      RowBox[{"\[DoubleStruckL]", "\[Wedge]", "\[DoubleStruckN]"}]}], ")"}], 
    "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"a", "+", 
     RowBox[{"I", " ", "r"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", " ", "a"}], "+", "r"}], ")"}], " ", 
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "I", " ", "a", " ", 
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"d", "[", "u", "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "r", "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "u", "]"}]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "2", "]"}], "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"\[DoubleStruckN]", "\[Wedge]", "\[DoubleStruckM]B"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["r", "2"], "-", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"m", "[", "u", "]"}]}]}], ")"}], " ", 
     RowBox[{"dx", "\[Wedge]", 
      RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}]]}]]}], "-", 
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "r", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "-", 
  FractionBox[
   RowBox[{"I", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "r", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "-", 
  FractionBox[
   RowBox[{"I", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}], " ", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "-", 
  FractionBox[
   RowBox[{"I", " ", "a", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    RowBox[{
     RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fB", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"fB", "[", "i", "]"}], "=", 
    RowBox[{"Bar", "[", 
     RowBox[{"f", "[", "i", "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"df", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"df", "[", "i", "]"}], "=", 
    RowBox[{"reWrite", "[", 
     RowBox[{"d", "[", 
      RowBox[{"f", "[", "i", "]"}], "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["CALCULATE THE SPIN COEFFICIENTS:", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Kappa]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckL]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Sigma]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Rho]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckL]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{"r", "-", 
    RowBox[{"I", " ", "a", " ", "x"}]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Mu]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckN]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], "+", 
    SuperscriptBox["r", "2"], "-", 
    RowBox[{"2", " ", "r", " ", 
     RowBox[{"m", "[", "u", "]"}]}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r"}], "-", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Pi]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]B", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Tau]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "I"}], " ", "r"}], "+", 
     RowBox[{"a", " ", "x"}]}], ")"}], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]]}], 
  RowBox[{
   SqrtBox["2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Nu]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckN]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"I", " ", "a", " ", "r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["m", "\[Prime]",
      MultilineFunction->None], "[", "u", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Lambda]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]B", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Gamma]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Mu]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckM]", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    SuperscriptBox["a", "2"], " ", "r"}], "-", 
   RowBox[{"I", " ", 
    SuperscriptBox["a", "3"], " ", "x"}], "-", 
   RowBox[{"I", " ", "a", " ", 
    SuperscriptBox["r", "2"], " ", "x"}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", "r", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"m", "[", "u", "]"}]}], "+", 
   RowBox[{"2", " ", "I", " ", "a", " ", "r", " ", "x", " ", 
    RowBox[{"m", "[", "u", "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"m", "[", "u", "]"}]}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "+", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Epsilon]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Rho]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckM]B", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "x"}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", " ", "r"}], "-", 
     RowBox[{"a", " ", "x"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"r", "-", 
     RowBox[{"I", " ", "a", " ", "x"}]}], ")"}]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Beta]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Tau]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckN]", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "I"}], " ", "a", " ", "r"}], "+", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", "x"}], "+", 
   RowBox[{"I", " ", "a", " ", "r", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["x", "3"]}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Alpha]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Pi]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckL]", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], " ", "a", " ", "r"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"], " ", "x"}], "+", 
    RowBox[{
     SuperscriptBox["r", "2"], " ", "x"}], "+", 
    RowBox[{"I", " ", "a", " ", "r", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["x", "3"]}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Definition of connection 1-forms:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]0", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"NP\[Tau]", "*", "\[DoubleStruckL]"}], "+", 
    RowBox[{"NP\[Kappa]", "*", "\[DoubleStruckN]"}], " ", "-", 
    RowBox[{"NP\[Rho]", "*", "\[DoubleStruckM]"}], "-", 
    RowBox[{"NP\[Sigma]", "*", "\[DoubleStruckM]B"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"dx", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "-", 
  FractionBox[
   RowBox[{"I", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]1", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"NP\[Gamma]", "*", "\[DoubleStruckL]"}], "+", 
    RowBox[{"NP\[Epsilon]", "*", "\[DoubleStruckN]"}], " ", "-", 
    RowBox[{"NP\[Alpha]", "*", "\[DoubleStruckM]"}], "-", 
    RowBox[{"NP\[Beta]", "*", "\[DoubleStruckM]B"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", "dx", " ", "x"}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", "x", " ", 
    RowBox[{"d", "[", "r", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "I"}], " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"d", "[", "u", "]"}], " ", 
    RowBox[{"m", "[", "u", "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "r"}], "-", 
      RowBox[{"I", " ", 
       SuperscriptBox["a", "2"], " ", "x"}], "+", 
      RowBox[{"I", " ", 
       SuperscriptBox["r", "2"], " ", "x"}], "+", 
      RowBox[{"a", " ", "r", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"m", "[", "u", "]"}]}], "-", 
      RowBox[{"a", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]2", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"NP\[Nu]", "*", "\[DoubleStruckL]"}], "+", 
    RowBox[{"NP\[Pi]", "*", "\[DoubleStruckN]"}], " ", "-", 
    RowBox[{"NP\[Lambda]", "*", "\[DoubleStruckM]"}], "-", 
    RowBox[{"NP\[Mu]", "*", "\[DoubleStruckM]B"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]], " ", 
     RowBox[{"d", "[", "r", "]"}]}], 
    RowBox[{
     SqrtBox["2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "+", 
  FractionBox[
   RowBox[{"dx", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"r", "+", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "-", 
  FractionBox[
   RowBox[{"a", " ", "r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "3"], " ", 
    RowBox[{"d", "[", "u", "]"}], " ", 
    RowBox[{
     SuperscriptBox["m", "\[Prime]",
      MultilineFunction->None], "[", "u", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"r", "+", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"I", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], " ", "r"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"I", " ", "r"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], "3"], " ", 
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        SuperscriptBox["a", "2"], " ", "r"}], "-", 
       RowBox[{"I", " ", 
        SuperscriptBox["r", "3"]}], "+", 
       RowBox[{
        SuperscriptBox["a", "3"], " ", "x"}], "+", 
       RowBox[{"a", " ", 
        SuperscriptBox["r", "2"], " ", "x"}], "+", 
       RowBox[{"2", " ", "I", " ", 
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"m", "[", "u", "]"}]}], "-", 
       RowBox[{"2", " ", "a", " ", "r", " ", "x", " ", 
        RowBox[{"m", "[", "u", "]"}]}], "+", 
       RowBox[{"2", " ", "I", " ", 
        SuperscriptBox["a", "2"], " ", "r", " ", 
        RowBox[{
         SuperscriptBox["m", "\[Prime]",
          MultilineFunction->None], "[", "u", "]"}]}], "-", 
       RowBox[{"2", " ", "I", " ", 
        SuperscriptBox["a", "2"], " ", "r", " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{
         SuperscriptBox["m", "\[Prime]",
          MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], ")"}], "/", 
   
   RowBox[{"(", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", 
        RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"r", "+", 
       RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], 
      RowBox[{"5", "/", "2"}]]}], ")"}]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["2.28333333333333321`"], "Output"]
}, Open  ]],

Cell["Definition of curvature 2-forms:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"d", "[", "\[Omega]0", "]"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"\[Omega]0", "\[Wedge]", "\[Omega]1"}]}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"d", "[", "\[Omega]1", "]"}], "+", 
    RowBox[{"\[Omega]0", "\[Wedge]", "\[Omega]2"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"d", "[", "\[Omega]2", "]"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"\[Omega]1", "\[Wedge]", "\[Omega]2"}]}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "i", "]"}], "=", 
    RowBox[{"reWrite", "[", 
     RowBox[{"\[CapitalOmega]", "[", "i", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["7.74999999999999822`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tWEYL COMPONENTS AND SYMMETRIES", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]0", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]1", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPsi]1", "+", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]3", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "2", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"I", " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", "r"}], "+", 
     RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["m", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"], " ", 
   RowBox[{"(", 
    RowBox[{"r", "-", 
     RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPsi]3", "+", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]4", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "2", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", "r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "I", " ", 
       RowBox[{
        SuperscriptBox["m", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "+", 
      RowBox[{"I", " ", "r", " ", 
       RowBox[{
        SuperscriptBox["m", "\[DoublePrime]",
         MultilineFunction->None], "[", "u", "]"}]}], "+", 
      RowBox[{"a", " ", "x", " ", 
       RowBox[{
        SuperscriptBox["m", "\[DoublePrime]",
         MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "3"]}]]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f\[CapitalOmega]02", "=", 
   RowBox[{
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "/", "vol"}]}]}], "]"}], "/.",
     "star4"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f\[CapitalOmega]20", "=", 
   RowBox[{
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "2", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "/", "vol"}]}]}], "]"}], "/.",
     "star4"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f\[CapitalOmega]11", "=", 
   RowBox[{
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "/", "vol"}]}]}], "]"}], "/.",
     "star4"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]2", "=", 
  RowBox[{"-", 
   RowBox[{"reWrite", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", "f\[CapitalOmega]11"}], "+", "f\[CapitalOmega]02", "+", 
       "f\[CapitalOmega]20"}], ")"}], "/", "6"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"m", "[", "u", "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "3"]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"f\[CapitalOmega]02", "-", "f\[CapitalOmega]20"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\tNON-ZERO RICCI COMPONENTS", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalLambda]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "f\[CapitalOmega]11"}], "-", "f\[CapitalOmega]02", "-", 
      "f\[CapitalOmega]20"}], ")"}], "/", "6"}], "]"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "=", 
    RowBox[{
     RowBox[{"reWrite", "[", 
      RowBox[{"I", " ", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "i", "]"}], "\[Wedge]", 
        RowBox[{
         RowBox[{"fB", "[", "j", "]"}], "/", "vol"}]}]}], "]"}], "/.", 
     "star4"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnt", "=", "0"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tmp", "=!=", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\[CapitalPhi][\>\"", ",", "i", ",", "\"\<,\>\"", ",", "j", ",", 
          "\"\<] = \>\"", ",", "tmp"}], "]"}], ";", 
        RowBox[{"cnt", "++"}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"cnt", "===", "0"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[CapitalLambda]", "===", "0"}], ",", 
      RowBox[{"Print", "[", "\"\<Ricci Flat\>\"", "]"}], ",", 
      RowBox[{"Print", "[", "\"\<Einstein Space\>\"", "]"}]}], "]"}]}], "]"}],
   ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalPhi][\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"I", " ", "a", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "-", 
         RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "+", 
         RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["m", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}], 
       RowBox[{"9", "/", "2"}]]}]]}]}],
  SequenceForm["\[CapitalPhi][", 2, ",", 1, "] = ", ((((((((Complex[0, 
             Rational[-1, 2]] 2^Rational[-1, 2]) a) (-1 + x)^2) (1 + x)^2) (
         r + (Complex[0, -1] a) x)^4) (r + (Complex[0, 1] a) x)^2) (1 - x^2)^
      Rational[-3, 2]) (r^2 + a^2 x^2)^Rational[-9, 2]) Derivative[1][m][u]],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalPhi][\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"I", " ", "a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r", "+", 
        RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["m", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{"r", "-", 
        RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}]}],
  SequenceForm["\[CapitalPhi][", 1, ",", 2, "] = ", ((((((((Complex[0, 
             Rational[-1, 2]] 2^Rational[-1, 2]) a) (-1 + x)) (1 + x))/(
       r + (Complex[0, -1] a) x)) (r + (Complex[0, 1] a) x)) (1 - x^2)^
      Rational[-1, 2]) (r^2 + a^2 x^2)^Rational[-3, 2]) Derivative[1][m][u]],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalPhi][\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "r", " ", 
         RowBox[{
          SuperscriptBox["m", "\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{
          SuperscriptBox["m", "\[DoublePrime]",
           MultilineFunction->None], "[", "u", "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["x", "2"], " ", 
         RowBox[{
          SuperscriptBox["m", "\[DoublePrime]",
           MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "-", 
         RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "+", 
         RowBox[{"I", " ", "a", " ", "x"}]}], ")"}], "2"]}]]}]}],
  SequenceForm[
  "\[CapitalPhi][", 2, ",", 2, 
   "] = ", (((Rational[-1, 2] r) (r + (Complex[0, -1] a) x)^(-2)) (
      r + (Complex[0, 1] a) x)^(-2)) ((2 r) Derivative[1][m][u] + 
    a^2 Derivative[2][m][u] - (a^2 x^2) Derivative[2][m][u])],
  Editable->False]], "Print"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["9.95000000000000106`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tVERIFY \[CapitalPhi] SYMMETRY", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"0", ",", "2"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"0", ",", "0"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["10.0499999999999989`"], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tVERIFY CYCLIC IDENTITY", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "-", 
      RowBox[{"Bar", "[", 
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}]}], ")"}], "\[Wedge]",
     "\[DoubleStruckM]"}], "+", 
   RowBox[{
    RowBox[{"Bar", "[", 
     RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "]"}], "\[Wedge]", 
    "\[DoubleStruckL]"}], "-", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", 
    "\[DoubleStruckN]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "+", 
       RowBox[{"Bar", "[", 
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}]}], ")"}]}], 
    "\[Wedge]", "\[DoubleStruckL]"}], "+", 
   RowBox[{
    RowBox[{"Bar", "[", 
     RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "]"}], "\[Wedge]", 
    "\[DoubleStruckM]"}], "+", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", 
    "\[DoubleStruckM]B"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "+", 
       RowBox[{"Bar", "[", 
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}]}], ")"}]}], 
    "\[Wedge]", "\[DoubleStruckN]"}], "+", 
   RowBox[{
    RowBox[{"Bar", "[", 
     RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "]"}], "\[Wedge]", 
    "\[DoubleStruckM]B"}], "+", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "\[Wedge]", 
    "\[DoubleStruckM]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["12.3333333333333339`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\tVERIFY BIANCHI IDENTITIES", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "]"}], "+", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Omega]0", "\[Wedge]", 
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}]}], "-", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", 
       "\[Omega]1"}]}], ")"}]}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}], "+", 
   RowBox[{"\[Omega]0", "\[Wedge]", 
    RowBox[{"\[CapitalOmega]", "[", "2", "]"}]}], "-", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", "\[Omega]2"}]}], 
  "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]2", "\[Wedge]", 
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "\[Wedge]", 
        "\[Omega]1"}]}], ")"}]}]}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"12.7333333333333342`", " ", "Second"}], ",", "0"}], 
  "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["26.25`"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]], "Input"]
}, Open  ]],

Cell[TextData[{
 "More examples of calculations in Riemannian Geometry can be found in the \
package ",
 ButtonBox["Riemannian Geometry and Tensor Calculus",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/~sbonano/RGTC/"], None}],
 " (Sections 5 and 6).",
 "\n"
}], "Text"],

Cell[CellGroupData[{

Cell["(2) Polynomial Matrix Algebra", "Subsection",
 ShowGroupOpener->True],

Cell[TextData[{
 "Suppose one wishes to simplify products of polynomials in a matrix variable \
",
 StyleBox["X",
  FontFamily->"Courier"],
 ", say in 3 dimensions, using the Cayley-Hamilton theorem. ",
 StyleBox["matrixEDCcode",
  FontWeight->"Bold"],
 " cannot easily handle the notation ",
 StyleBox["X^n",
  FontFamily->"Courier"],
 " for powers of a matrix, but one can use the notation ",
 StyleBox["X[n]",
  FontFamily->"Courier"],
 " for the nth power of the matrix ",
 StyleBox["X[1] ",
  FontFamily->"Courier"],
 "and define appropriate rules for wedge-products of  ",
 StyleBox["X[k_]",
  FontFamily->"Courier"],
 " matrices",
 StyleBox[".",
  FontFamily->"Courier"],
 " Thus"
}], "Text",
 TextJustification->0],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"X", "[", "_", "]"}], ",", 
    RowBox[{"Xt", "[", "_", "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"X", "[", "i_", "]"}], "\[Wedge]", 
    RowBox[{"X", "[", "k_", "]"}]}], ":=", 
   RowBox[{"X", "[", 
    RowBox[{"i", "+", "k"}], "]"}]}], ";"}]], "Input"],

Cell[TextData[{
 " Use the Cayley-Hamilton Theorem to reduce the ",
 StyleBox["X[k]",
  FontFamily->"Courier"],
 " "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3", "=", 
  RowBox[{"CHrul", "[", 
   RowBox[{"3", ",", 
    RowBox[{"X", "[", "1", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", "3", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{
     FractionBox["1", "6"], " ", 
     SuperscriptBox[
      RowBox[{"tr", "[", 
       RowBox[{"X", "[", "1", "]"}], "]"}], "3"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"tr", "[", 
      RowBox[{"X", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{"X", "[", "2", "]"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"tr", "[", 
      RowBox[{"X", "[", "3", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"tr", "[", 
          RowBox[{"X", "[", "1", "]"}], "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"tr", "[", 
         RowBox[{"X", "[", "2", "]"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"X", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"X", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"X", "[", "2", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3rhs", "=", 
  RowBox[{
   RowBox[{"CH3", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "6"], " ", 
   SuperscriptBox[
    RowBox[{"tr", "[", 
     RowBox[{"X", "[", "1", "]"}], "]"}], "3"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "1", "]"}], "]"}], " ", 
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "2", "]"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "3", "]"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"tr", "[", 
        RowBox[{"X", "[", "1", "]"}], "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"tr", "[", 
       RowBox[{"X", "[", "2", "]"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "1", "]"}], "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[" For simplicity (and to avoid infinite loops!) set", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "1", "]"}], "]"}], "=", "s1"}], ";", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "2", "]"}], "]"}], "=", "s2"}], ";", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "3", "]"}], "]"}], "=", "s3"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["CH3rhs"], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["s1", "3"], "6"], "-", 
  FractionBox[
   RowBox[{"s1", " ", "s2"}], "2"], "+", 
  FractionBox["s3", "3"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["s1", "2"], "2"]}], "+", 
     FractionBox["s2", "2"]}], ")"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{"s1", " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "In this notation ",
 StyleBox["X[0]",
  FontFamily->"Courier"],
 " is the identity matrix. One can either set ",
 StyleBox["X[0]=1",
  FontFamily->"Courier"],
 ", or  set"
}], "Text"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"tr", "[", 
     RowBox[{"X", "[", "0", "]"}], "]"}], "=", "3"}], ";", 
   RowBox[{"Unprotect", "[", "Transpose", "]"}], ";", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"X", "[", "0", "]"}], "]"}], "=", 
    RowBox[{"X", "[", "0", "]"}]}], ";", " ", 
   RowBox[{"Protect", "[", "Transpose", "]"}], ";"}], " "}]], "Input"],

Cell[TextData[{
 "and use it to rewrite ",
 StyleBox["CH3rhs",
  FontFamily->"Courier"],
 ":"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3rhs", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"CH3rhs", "\[Wedge]", 
    RowBox[{"X", "[", "0", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["s1", "3"], "-", 
     RowBox[{"3", " ", "s1", " ", "s2"}], "+", 
     RowBox[{"2", " ", "s3"}]}], ")"}], " ", 
   RowBox[{"X", "[", "0", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["s1", "2"]}], "+", "s2"}], ")"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{"s1", " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"tr", "[", "%", "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", 
     StyleBox["check",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["that",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["trace",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["of",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["CHrhs",
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["=",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[
     RowBox[{"tr", "[", 
      RowBox[{"X", "[", "3", "]"}], "]"}],
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData["s3"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Now define rules for simplifying ",
 StyleBox["X[i]",
  FontFamily->"Courier"],
 " matrices"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{"i_", "/;", 
    RowBox[{"i", ">", "2"}]}], "]"}], ":=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"i", "-", "3"}], "]"}], "\[Wedge]", "CH3rhs"}], "]"}]}]], "Input"],

Cell["\<\
With these rules one can calculate arbitrary powers of matrix polynomials:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", "10", "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.216666666666668561`", " ", "Second"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "144"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "3"], "-", 
       RowBox[{"3", " ", "s1", " ", "s2"}], "+", 
       RowBox[{"2", " ", "s3"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "7"], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["s1", "5"], " ", "s2"}], "-", 
       RowBox[{"9", " ", 
        SuperscriptBox["s1", "3"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"3", " ", "s1", " ", 
        SuperscriptBox["s2", "3"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["s1", "4"], " ", "s3"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["s1", "2"], " ", "s2", " ", "s3"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["s2", "2"], " ", "s3"}], "+", 
       RowBox[{"8", " ", "s1", " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}], " ", 
     RowBox[{"X", "[", "0", "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "108"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "3"], "-", "s3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "6"], "-", 
       RowBox[{"27", " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["s2", "3"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["s1", "3"], " ", "s3"}], "+", 
       RowBox[{"36", " ", "s1", " ", "s2", " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}], " ", 
     RowBox[{"X", "[", "1", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "48"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "8"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["s1", "6"], " ", "s2"}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["s1", "4"], " ", 
        SuperscriptBox["s2", "2"]}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "3"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["s2", "4"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["s1", "5"], " ", "s3"}], "+", 
       RowBox[{"24", " ", "s1", " ", 
        SuperscriptBox["s2", "2"], " ", "s3"}], "+", 
       RowBox[{"24", " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s3", "2"]}], "+", 
       RowBox[{"8", " ", "s2", " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}], " ", 
     RowBox[{"X", "[", "2", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"X", "[", "5", "]"}], "\[Wedge]", 
    RowBox[{"X", "[", "7", "]"}]}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.283333333333331438`", " ", "Second"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2592"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["s1", "3"], "-", 
         RowBox[{"3", " ", "s1", " ", "s2"}], "+", 
         RowBox[{"2", " ", "s3"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", 
          SuperscriptBox["s1", "9"]}], "-", 
         RowBox[{"18", " ", 
          SuperscriptBox["s1", "7"], " ", "s2"}], "-", 
         RowBox[{"126", " ", 
          SuperscriptBox["s1", "3"], " ", 
          SuperscriptBox["s2", "3"]}], "+", 
         RowBox[{"27", " ", "s1", " ", 
          SuperscriptBox["s2", "4"]}], "+", 
         RowBox[{"60", " ", 
          SuperscriptBox["s1", "6"], " ", "s3"}], "-", 
         RowBox[{"144", " ", 
          SuperscriptBox["s1", "4"], " ", "s2", " ", "s3"}], "+", 
         RowBox[{"108", " ", 
          SuperscriptBox["s1", "2"], " ", 
          SuperscriptBox["s2", "2"], " ", "s3"}], "+", 
         RowBox[{"72", " ", 
          SuperscriptBox["s2", "3"], " ", "s3"}], "+", 
         RowBox[{"216", " ", 
          SuperscriptBox["s1", "3"], " ", 
          SuperscriptBox["s3", "2"]}], "+", 
         RowBox[{"216", " ", "s1", " ", "s2", " ", 
          SuperscriptBox["s3", "2"]}], "+", 
         RowBox[{"16", " ", 
          SuperscriptBox["s3", "3"]}]}], ")"}], " ", 
       RowBox[{"X", "[", "0", "]"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "432"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "3"], "-", "s3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["s1", "8"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["s1", "6"], " ", "s2"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["s1", "4"], " ", 
        SuperscriptBox["s2", "2"]}], "-", 
       RowBox[{"108", " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "3"]}], "+", 
       RowBox[{"45", " ", 
        SuperscriptBox["s2", "4"]}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["s1", "5"], " ", "s3"}], "-", 
       RowBox[{"64", " ", 
        SuperscriptBox["s1", "3"], " ", "s2", " ", "s3"}], "+", 
       RowBox[{"144", " ", "s1", " ", 
        SuperscriptBox["s2", "2"], " ", "s3"}], "+", 
       RowBox[{"64", " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s3", "2"]}], "+", 
       RowBox[{"32", " ", "s2", " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}], " ", 
     RowBox[{"X", "[", "1", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "864"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"7", " ", 
        SuperscriptBox["s1", "10"]}], "-", 
       RowBox[{"45", " ", 
        SuperscriptBox["s1", "8"], " ", "s2"}], "+", 
       RowBox[{"90", " ", 
        SuperscriptBox["s1", "6"], " ", 
        SuperscriptBox["s2", "2"]}], "-", 
       RowBox[{"126", " ", 
        SuperscriptBox["s1", "4"], " ", 
        SuperscriptBox["s2", "3"]}], "-", 
       RowBox[{"81", " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "4"]}], "+", 
       RowBox[{"27", " ", 
        SuperscriptBox["s2", "5"]}], "+", 
       RowBox[{"96", " ", 
        SuperscriptBox["s1", "7"], " ", "s3"}], "-", 
       RowBox[{"288", " ", 
        SuperscriptBox["s1", "5"], " ", "s2", " ", "s3"}], "-", 
       RowBox[{"288", " ", 
        SuperscriptBox["s1", "3"], " ", 
        SuperscriptBox["s2", "2"], " ", "s3"}], "+", 
       RowBox[{"288", " ", "s1", " ", 
        SuperscriptBox["s2", "3"], " ", "s3"}], "+", 
       RowBox[{"336", " ", 
        SuperscriptBox["s1", "4"], " ", 
        SuperscriptBox["s3", "2"]}], "+", 
       RowBox[{"576", " ", 
        SuperscriptBox["s1", "2"], " ", "s2", " ", 
        SuperscriptBox["s3", "2"]}], "+", 
       RowBox[{"144", " ", 
        SuperscriptBox["s2", "2"], " ", 
        SuperscriptBox["s3", "2"]}], "+", 
       RowBox[{"128", " ", "s1", " ", 
        SuperscriptBox["s3", "3"]}]}], ")"}], " ", 
     RowBox[{"X", "[", "2", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matPoly", "=", 
  RowBox[{
   RowBox[{"X", "[", "0", "]"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"X", "[", "1", "]"}]}], "+", 
   RowBox[{"k2", " ", 
    RowBox[{"X", "[", "2", "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", "0", "]"}], "+", 
  RowBox[{"k1", " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{"k2", " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"matPoly", "\[Wedge]", "matPoly", "\[Wedge]", "matPoly"}], "]"}], "//",
   "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.316666666666669982`", " ", "Second"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "36"], " ", 
     RowBox[{"(", 
      RowBox[{"36", "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "3"], " ", 
        SuperscriptBox["s1", "3"]}], "+", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", 
        SuperscriptBox["s1", "3"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "4"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "4"]}], "+", 
       RowBox[{"9", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "5"]}], "+", 
       RowBox[{
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "6"]}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "-", 
       RowBox[{"108", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
       RowBox[{"54", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
       RowBox[{"54", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
       RowBox[{"18", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
       RowBox[{"27", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", 
        SuperscriptBox["s2", "2"]}], "-", 
       RowBox[{"9", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "3"], " ", "s3"}], "+", 
       RowBox[{"72", " ", "k1", " ", "k2", " ", "s3"}], "+", 
       RowBox[{"36", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "+", 
       RowBox[{"36", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
       RowBox[{"18", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "3"], " ", "s3"}], "+", 
       RowBox[{"18", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}], " ", 
     RowBox[{"X", "[", "0", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"36", " ", "k1"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "3"], " ", 
        SuperscriptBox["s1", "2"]}], "-", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", 
        SuperscriptBox["s1", "2"]}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "3"]}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "3"]}], "-", 
       RowBox[{"3", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "4"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "3"], " ", "s2"}], "+", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", "s2"}], "-", 
       RowBox[{"18", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "3"], " ", "s2"}], "+", 
       RowBox[{"9", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", "s3"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k2", "2"], " ", "s3"}], "+", 
       RowBox[{"12", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", "s2", " ", "s3"}]}], ")"}], " ", 
     RowBox[{"X", "[", "1", "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "12"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"36", " ", 
        SuperscriptBox["k1", "2"]}], "+", 
       RowBox[{"36", " ", "k2"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "3"], " ", "s1"}], "+", 
       RowBox[{"72", " ", "k1", " ", "k2", " ", "s1"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "2"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"]}], "+", 
       RowBox[{"6", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "3"]}], "+", 
       RowBox[{
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "4"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", "s2"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k2", "2"], " ", "s2"}], "+", 
       RowBox[{"18", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", "s2"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"12", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s3"}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["k2", "3"], " ", "s1", " ", "s3"}]}], ")"}], " ", 
     RowBox[{"X", "[", "2", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Finding the inverse of  ",
  FontSize->14],
 StyleBox["matPoly",
  FontFamily->"Courier",
  FontSize->14]
}], "Subsubsection",
 ShowGroupOpener->True,
 FontSize->12],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testPoly", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], 
     RowBox[{"X", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zer0", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"testPoly", "\[Wedge]", "matPoly"}], "-", 
    RowBox[{"X", "[", "0", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "6"}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{"k2", " ", 
      SuperscriptBox["s1", "3"], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"3", " ", "k2", " ", "s1", " ", "s2", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", "k2", " ", "s3", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"k1", " ", 
      SuperscriptBox["s1", "3"], " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"k2", " ", 
      SuperscriptBox["s1", "4"], " ", 
      RowBox[{"a", "[", "2", "]"}]}], "-", 
     RowBox[{"3", " ", "k1", " ", "s1", " ", "s2", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "-", 
     RowBox[{"3", " ", "k2", " ", 
      SuperscriptBox["s1", "2"], " ", "s2", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"2", " ", "k1", " ", "s3", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"2", " ", "k2", " ", "s1", " ", "s3", " ", 
      RowBox[{"a", "[", "2", "]"}]}]}], ")"}], " ", 
   RowBox[{"X", "[", "0", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", "k1", " ", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"3", " ", "k2", " ", 
      SuperscriptBox["s1", "2"], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"3", " ", "k2", " ", "s2", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"3", " ", "k1", " ", 
      SuperscriptBox["s1", "2"], " ", 
      RowBox[{"a", "[", "2", "]"}]}], "-", 
     RowBox[{"2", " ", "k2", " ", 
      SuperscriptBox["s1", "3"], " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"3", " ", "k1", " ", "s2", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"2", " ", "k2", " ", "s3", " ", 
      RowBox[{"a", "[", "2", "]"}]}]}], ")"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "k2", " ", 
      RowBox[{"a", "[", "0", "]"}]}], "+", 
     RowBox[{"2", " ", "k1", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", "k2", " ", "s1", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"2", " ", "k1", " ", "s1", " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"k2", " ", 
      SuperscriptBox["s1", "2"], " ", 
      RowBox[{"a", "[", "2", "]"}]}], "+", 
     RowBox[{"k2", " ", "s2", " ", 
      RowBox[{"a", "[", "2", "]"}]}]}], ")"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zer0", "/.", 
      RowBox[{
       RowBox[{"X", "[", "0", "]"}], "->", "1"}]}], ",", 
     RowBox[{"zer0", "/.", 
      RowBox[{
       RowBox[{"X", "[", "1", "]"}], "->", "1"}]}], ",", 
     RowBox[{"zer0", "/.", 
      RowBox[{
       RowBox[{"X", "[", "2", "]"}], "->", "1"}]}]}], "}"}], "/.", 
   RowBox[{
    RowBox[{"X", "[", "_", "]"}], "->", "0"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"a", "[", "0", "]"}]}], "+", 
      RowBox[{"k2", " ", 
       SuperscriptBox["s1", "3"], " ", 
       RowBox[{"a", "[", "1", "]"}]}], "-", 
      RowBox[{"3", " ", "k2", " ", "s1", " ", "s2", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", "k2", " ", "s3", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"k1", " ", 
       SuperscriptBox["s1", "3"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"k2", " ", 
       SuperscriptBox["s1", "4"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "-", 
      RowBox[{"3", " ", "k1", " ", "s1", " ", "s2", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "-", 
      RowBox[{"3", " ", "k2", " ", 
       SuperscriptBox["s1", "2"], " ", "s2", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", "k1", " ", "s3", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", "k2", " ", "s1", " ", "s3", " ", 
       RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "k1", " ", 
       RowBox[{"a", "[", "0", "]"}]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "-", 
      RowBox[{"3", " ", "k2", " ", 
       SuperscriptBox["s1", "2"], " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"3", " ", "k2", " ", "s2", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "-", 
      RowBox[{"3", " ", "k1", " ", 
       SuperscriptBox["s1", "2"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "-", 
      RowBox[{"2", " ", "k2", " ", 
       SuperscriptBox["s1", "3"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"3", " ", "k1", " ", "s2", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", "k2", " ", "s3", " ", 
       RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "k2", " ", 
       RowBox[{"a", "[", "0", "]"}]}], "+", 
      RowBox[{"2", " ", "k1", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", "k2", " ", "s1", " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", "k1", " ", "s1", " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"k2", " ", 
       SuperscriptBox["s1", "2"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"k2", " ", "s2", " ", 
       RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invPolyRul", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"eqs", "==", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], ",", 
       RowBox[{"a", "[", "1", "]"}], ",", 
       RowBox[{"a", "[", "2", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
           RowBox[{"k2", " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"k2", " ", "s2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "k1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "k1"}], "+", 
              RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "6"], " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{"6", "-", 
              RowBox[{"3", " ", "k2", " ", 
               SuperscriptBox["s1", "2"]}], "+", 
              RowBox[{"3", " ", "k2", " ", "s2"}]}], ")"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", "2"]}], " ", "k1", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
                  RowBox[{"k2", " ", 
                   SuperscriptBox["s1", "2"]}], "+", 
                  RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "6"], " ", "k2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "k1", " ", 
                   SuperscriptBox["s1", "2"]}], "-", 
                  RowBox[{"2", " ", "k2", " ", 
                   SuperscriptBox["s1", "3"]}], "+", 
                  RowBox[{"3", " ", "k1", " ", "s2"}], "+", 
                  RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "k1"}], "-", 
                 RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "6"], " ", "k2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k2", " ", 
                  SuperscriptBox["s1", "3"]}], "-", 
                 RowBox[{"3", " ", "k2", " ", "s1", " ", "s2"}], "+", 
                 RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "2"]}], " ", "k1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "k1"}], "+", 
                 RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "6"], " ", "k2", " ", 
               RowBox[{"(", 
                RowBox[{"6", "-", 
                 RowBox[{"3", " ", "k2", " ", 
                  SuperscriptBox["s1", "2"]}], "+", 
                 RowBox[{"3", " ", "k2", " ", "s2"}]}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "-", 
                 RowBox[{"2", " ", "k1", " ", "s1"}], "-", 
                 RowBox[{"k2", " ", 
                  SuperscriptBox["s1", "2"]}], "-", 
                 RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "6"], " ", "k2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k1", " ", 
                  SuperscriptBox["s1", "3"]}], "+", 
                 RowBox[{"k2", " ", 
                  SuperscriptBox["s1", "4"]}], "-", 
                 RowBox[{"3", " ", "k1", " ", "s1", " ", "s2"}], "-", 
                 RowBox[{"3", " ", "k2", " ", 
                  SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
                 RowBox[{"2", " ", "k1", " ", "s3"}], "+", 
                 RowBox[{"2", " ", "k2", " ", "s1", " ", "s3"}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "k1"}], "+", 
          RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "k1", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
             RowBox[{"k2", " ", 
              SuperscriptBox["s1", "2"]}], "+", 
             RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "6"], " ", "k2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "k1", " ", 
              SuperscriptBox["s1", "2"]}], "-", 
             RowBox[{"2", " ", "k2", " ", 
              SuperscriptBox["s1", "3"]}], "+", 
             RowBox[{"3", " ", "k1", " ", "s2"}], "+", 
             RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], ")"}],
       "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "2"]}], " ", "k1", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
                 RowBox[{"k2", " ", 
                  SuperscriptBox["s1", "2"]}], "+", 
                 RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "6"], " ", "k2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "k1", " ", 
                  SuperscriptBox["s1", "2"]}], "-", 
                 RowBox[{"2", " ", "k2", " ", 
                  SuperscriptBox["s1", "3"]}], "+", 
                 RowBox[{"3", " ", "k1", " ", "s2"}], "+", 
                 RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "k1"}], "-", 
                RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "6"], " ", "k2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k2", " ", 
                 SuperscriptBox["s1", "3"]}], "-", 
                RowBox[{"3", " ", "k2", " ", "s1", " ", "s2"}], "+", 
                RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               FractionBox["1", "2"]}], " ", "k1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "k1"}], "+", 
                RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "6"], " ", "k2", " ", 
              RowBox[{"(", 
               RowBox[{"6", "-", 
                RowBox[{"3", " ", "k2", " ", 
                 SuperscriptBox["s1", "2"]}], "+", 
                RowBox[{"3", " ", "k2", " ", "s2"}]}], ")"}]}]}], ")"}], " ", 
           
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "-", 
                RowBox[{"2", " ", "k1", " ", "s1"}], "-", 
                RowBox[{"k2", " ", 
                 SuperscriptBox["s1", "2"]}], "-", 
                RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "6"], " ", "k2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k1", " ", 
                 SuperscriptBox["s1", "3"]}], "+", 
                RowBox[{"k2", " ", 
                 SuperscriptBox["s1", "4"]}], "-", 
                RowBox[{"3", " ", "k1", " ", "s1", " ", "s2"}], "-", 
                RowBox[{"3", " ", "k2", " ", 
                 SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
                RowBox[{"2", " ", "k1", " ", "s3"}], "+", 
                RowBox[{"2", " ", "k2", " ", "s1", " ", "s3"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "k1", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
             RowBox[{"k2", " ", 
              SuperscriptBox["s1", "2"]}], "+", 
             RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "6"], " ", "k2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "k1", " ", 
              SuperscriptBox["s1", "2"]}], "-", 
             RowBox[{"2", " ", "k2", " ", 
              SuperscriptBox["s1", "3"]}], "+", 
             RowBox[{"3", " ", "k1", " ", "s2"}], "+", 
             RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], ")"}],
       "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "2"]}], " ", "k1", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
               RowBox[{"k2", " ", 
                SuperscriptBox["s1", "2"]}], "+", 
               RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "6"], " ", "k2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "k1", " ", 
                SuperscriptBox["s1", "2"]}], "-", 
               RowBox[{"2", " ", "k2", " ", 
                SuperscriptBox["s1", "3"]}], "+", 
               RowBox[{"3", " ", "k1", " ", "s2"}], "+", 
               RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "k1"}], "-", 
              RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "6"], " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k2", " ", 
               SuperscriptBox["s1", "3"]}], "-", 
              RowBox[{"3", " ", "k2", " ", "s1", " ", "s2"}], "+", 
              RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "k1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "k1"}], "+", 
              RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "6"], " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{"6", "-", 
              RowBox[{"3", " ", "k2", " ", 
               SuperscriptBox["s1", "2"]}], "+", 
              RowBox[{"3", " ", "k2", " ", "s2"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "-", 
              RowBox[{"2", " ", "k1", " ", "s1"}], "-", 
              RowBox[{"k2", " ", 
               SuperscriptBox["s1", "2"]}], "-", 
              RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "6"], " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k1", " ", 
               SuperscriptBox["s1", "3"]}], "+", 
              RowBox[{"k2", " ", 
               SuperscriptBox["s1", "4"]}], "-", 
              RowBox[{"3", " ", "k1", " ", "s1", " ", "s2"}], "-", 
              RowBox[{"3", " ", "k2", " ", 
               SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
              RowBox[{"2", " ", "k1", " ", "s3"}], "+", 
              RowBox[{"2", " ", "k2", " ", "s1", " ", "s3"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], " ", "k1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "k1"}], "+", 
            RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox["1", "6"], " ", "k2", " ", 
          RowBox[{"(", 
           RowBox[{"6", "-", 
            RowBox[{"3", " ", "k2", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"3", " ", "k2", " ", "s2"}]}], ")"}]}]}], ")"}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "k1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"2", " ", "k1", " ", "s1"}], "+", 
              RowBox[{"k2", " ", 
               SuperscriptBox["s1", "2"]}], "+", 
              RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "6"], " ", "k2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "k1", " ", 
               SuperscriptBox["s1", "2"]}], "-", 
              RowBox[{"2", " ", "k2", " ", 
               SuperscriptBox["s1", "3"]}], "+", 
              RowBox[{"3", " ", "k1", " ", "s2"}], "+", 
              RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "k1"}], "-", 
             RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "6"], " ", "k2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k2", " ", 
              SuperscriptBox["s1", "3"]}], "-", 
             RowBox[{"3", " ", "k2", " ", "s1", " ", "s2"}], "+", 
             RowBox[{"2", " ", "k2", " ", "s3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "k1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "k1"}], "+", 
             RowBox[{"2", " ", "k2", " ", "s1"}]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "6"], " ", "k2", " ", 
           RowBox[{"(", 
            RowBox[{"6", "-", 
             RowBox[{"3", " ", "k2", " ", 
              SuperscriptBox["s1", "2"]}], "+", 
             RowBox[{"3", " ", "k2", " ", "s2"}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"2", " ", "k1", " ", "s1"}], "-", 
             RowBox[{"k2", " ", 
              SuperscriptBox["s1", "2"]}], "-", 
             RowBox[{"k2", " ", "s2"}]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "6"], " ", "k2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k1", " ", 
              SuperscriptBox["s1", "3"]}], "+", 
             RowBox[{"k2", " ", 
              SuperscriptBox["s1", "4"]}], "-", 
             RowBox[{"3", " ", "k1", " ", "s1", " ", "s2"}], "-", 
             RowBox[{"3", " ", "k2", " ", 
              SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
             RowBox[{"2", " ", "k1", " ", "s3"}], "+", 
             RowBox[{"2", " ", "k2", " ", "s1", " ", "s3"}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}]}], "}"}]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invPolyRul", "=", 
  RowBox[{"reWrite", "[", "invPolyRul", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"12", "+", 
         RowBox[{"12", " ", "k1", " ", "s1"}], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"4", " ", "k1", " ", "k2", " ", 
          SuperscriptBox["s1", "3"]}], "+", 
         RowBox[{
          SuperscriptBox["k2", "2"], " ", 
          SuperscriptBox["s1", "4"]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
         RowBox[{"12", " ", "k2", " ", "s2"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["k2", "2"], " ", 
          SuperscriptBox["s2", "2"]}], "-", 
         RowBox[{"4", " ", "k1", " ", "k2", " ", "s3"}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}]}], ")"}]}], ")"}],
      "/", 
     RowBox[{"(", 
      RowBox[{"36", "+", 
       RowBox[{"36", " ", "k1", " ", "s1"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["s1", "2"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "3"], " ", 
        SuperscriptBox["s1", "3"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "4"]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "4"]}], "+", 
       RowBox[{"3", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "5"]}], "+", 
       RowBox[{
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "6"]}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
       RowBox[{"36", " ", "k2", " ", "s2"}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "+", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
       RowBox[{"12", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "4"], " ", "s2"}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"9", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "3"], " ", "s3"}], "-", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", "s3"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "-", 
       RowBox[{"24", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
       RowBox[{"6", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "3"], " ", "s3"}], "-", 
       RowBox[{"6", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["k2", "3"], " ", "s1", " ", "s2", " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"12", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "k1"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["k1", "2"], " ", "s1"}], "+", 
          RowBox[{"3", " ", "k1", " ", "k2", " ", 
           SuperscriptBox["s1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["k2", "2"], " ", 
           SuperscriptBox["s1", "3"]}], "-", 
          RowBox[{
           SuperscriptBox["k2", "2"], " ", "s3"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"36", "+", 
        RowBox[{"36", " ", "k1", " ", "s1"}], "+", 
        RowBox[{"18", " ", 
         SuperscriptBox["k1", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["k1", "3"], " ", 
         SuperscriptBox["s1", "3"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["k1", "2"], " ", "k2", " ", 
         SuperscriptBox["s1", "4"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["k2", "2"], " ", 
         SuperscriptBox["s1", "4"]}], "+", 
        RowBox[{"3", " ", "k1", " ", 
         SuperscriptBox["k2", "2"], " ", 
         SuperscriptBox["s1", "5"]}], "+", 
        RowBox[{
         SuperscriptBox["k2", "3"], " ", 
         SuperscriptBox["s1", "6"]}], "-", 
        RowBox[{"18", " ", 
         SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
        RowBox[{"36", " ", "k2", " ", "s2"}], "-", 
        RowBox[{"18", " ", 
         SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "+", 
        RowBox[{"36", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
        RowBox[{"18", " ", 
         SuperscriptBox["k1", "2"], " ", "k2", " ", 
         SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
        RowBox[{"18", " ", 
         SuperscriptBox["k2", "2"], " ", 
         SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
        RowBox[{"12", " ", "k1", " ", 
         SuperscriptBox["k2", "2"], " ", 
         SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["k2", "3"], " ", 
         SuperscriptBox["s1", "4"], " ", "s2"}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["k2", "2"], " ", 
         SuperscriptBox["s2", "2"]}], "+", 
        RowBox[{"9", " ", "k1", " ", 
         SuperscriptBox["k2", "2"], " ", "s1", " ", 
         SuperscriptBox["s2", "2"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["k2", "3"], " ", 
         SuperscriptBox["s1", "2"], " ", 
         SuperscriptBox["s2", "2"]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["k1", "3"], " ", "s3"}], "-", 
        RowBox[{"36", " ", "k1", " ", "k2", " ", "s3"}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "-", 
        RowBox[{"24", " ", 
         SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
        RowBox[{"6", " ", "k1", " ", 
         SuperscriptBox["k2", "2"], " ", 
         SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["k2", "3"], " ", 
         SuperscriptBox["s1", "3"], " ", "s3"}], "-", 
        RowBox[{"6", " ", "k1", " ", 
         SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["k2", "3"], " ", "s1", " ", "s2", " ", "s3"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["k2", "3"], " ", 
         SuperscriptBox["s3", "2"]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"18", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["k1", "2"]}], "-", 
         RowBox[{"2", " ", "k2"}], "+", 
         RowBox[{"2", " ", "k1", " ", "k2", " ", "s1"}], "+", 
         RowBox[{
          SuperscriptBox["k2", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["k2", "2"], " ", "s2"}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"36", "+", 
       RowBox[{"36", " ", "k1", " ", "s1"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["s1", "2"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "3"], " ", 
        SuperscriptBox["s1", "3"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "4"]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "4"]}], "+", 
       RowBox[{"3", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "5"]}], "+", 
       RowBox[{
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "6"]}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
       RowBox[{"36", " ", "k2", " ", "s2"}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "+", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
       RowBox[{"12", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "4"], " ", "s2"}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"9", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "3"], " ", "s3"}], "-", 
       RowBox[{"36", " ", "k1", " ", "k2", " ", "s3"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "-", 
       RowBox[{"24", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
       RowBox[{"6", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s1", "3"], " ", "s3"}], "-", 
       RowBox[{"6", " ", "k1", " ", 
        SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["k2", "3"], " ", "s1", " ", "s2", " ", "s3"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "3"], " ", 
        SuperscriptBox["s3", "2"]}]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invPoly", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"testPoly", "/.", "invPolyRul"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"12", "+", 
       RowBox[{"12", " ", "k1", " ", "s1"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["s1", "2"]}], "+", 
       RowBox[{"4", " ", "k1", " ", "k2", " ", 
        SuperscriptBox["s1", "3"]}], "+", 
       RowBox[{
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "4"]}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
       RowBox[{"12", " ", "k2", " ", "s2"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s2", "2"]}], "-", 
       RowBox[{"4", " ", "k1", " ", "k2", " ", "s3"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}]}], ")"}], " ", 
     RowBox[{"X", "[", "0", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"36", "+", 
     RowBox[{"36", " ", "k1", " ", "s1"}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["s1", "2"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["k1", "3"], " ", 
      SuperscriptBox["s1", "3"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", 
      SuperscriptBox["s1", "4"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "4"]}], "+", 
     RowBox[{"3", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "5"]}], "+", 
     RowBox[{
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "6"]}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
     RowBox[{"36", " ", "k2", " ", "s2"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "+", 
     RowBox[{"36", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", 
      SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
     RowBox[{"12", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "4"], " ", "s2"}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"9", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", "s1", " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "2"], " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["k1", "3"], " ", "s3"}], "-", 
     RowBox[{"36", " ", "k1", " ", "k2", " ", "s3"}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
     RowBox[{"6", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "3"], " ", "s3"}], "-", 
     RowBox[{"6", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["k2", "3"], " ", "s1", " ", "s2", " ", "s3"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s3", "2"]}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"12", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "k1"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["k1", "2"], " ", "s1"}], "+", 
       RowBox[{"3", " ", "k1", " ", "k2", " ", 
        SuperscriptBox["s1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "3"]}], "-", 
       RowBox[{
        SuperscriptBox["k2", "2"], " ", "s3"}]}], ")"}], " ", 
     RowBox[{"X", "[", "1", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"36", "+", 
     RowBox[{"36", " ", "k1", " ", "s1"}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["s1", "2"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["k1", "3"], " ", 
      SuperscriptBox["s1", "3"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", 
      SuperscriptBox["s1", "4"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "4"]}], "+", 
     RowBox[{"3", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "5"]}], "+", 
     RowBox[{
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "6"]}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
     RowBox[{"36", " ", "k2", " ", "s2"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "+", 
     RowBox[{"36", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", 
      SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
     RowBox[{"12", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "4"], " ", "s2"}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"9", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", "s1", " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "2"], " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["k1", "3"], " ", "s3"}], "-", 
     RowBox[{"36", " ", "k1", " ", "k2", " ", "s3"}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
     RowBox[{"6", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "3"], " ", "s3"}], "-", 
     RowBox[{"6", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["k2", "3"], " ", "s1", " ", "s2", " ", "s3"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s3", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"18", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["k1", "2"]}], "-", 
       RowBox[{"2", " ", "k2"}], "+", 
       RowBox[{"2", " ", "k1", " ", "k2", " ", "s1"}], "+", 
       RowBox[{
        SuperscriptBox["k2", "2"], " ", 
        SuperscriptBox["s1", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["k2", "2"], " ", "s2"}]}], ")"}], " ", 
     RowBox[{"X", "[", "2", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"36", "+", 
     RowBox[{"36", " ", "k1", " ", "s1"}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["s1", "2"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["k1", "3"], " ", 
      SuperscriptBox["s1", "3"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", 
      SuperscriptBox["s1", "4"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "4"]}], "+", 
     RowBox[{"3", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "5"]}], "+", 
     RowBox[{
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "6"]}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", "s2"}], "+", 
     RowBox[{"36", " ", "k2", " ", "s2"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "3"], " ", "s1", " ", "s2"}], "+", 
     RowBox[{"36", " ", "k1", " ", "k2", " ", "s1", " ", "s2"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", 
      SuperscriptBox["s1", "2"], " ", "s2"}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "2"], " ", "s2"}], "-", 
     RowBox[{"12", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "3"], " ", "s2"}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "4"], " ", "s2"}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"9", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", "s1", " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "2"], " ", 
      SuperscriptBox["s2", "2"]}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["k1", "3"], " ", "s3"}], "-", 
     RowBox[{"36", " ", "k1", " ", "k2", " ", "s3"}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["k1", "2"], " ", "k2", " ", "s1", " ", "s3"}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["k2", "2"], " ", "s1", " ", "s3"}], "+", 
     RowBox[{"6", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["s1", "2"], " ", "s3"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s1", "3"], " ", "s3"}], "-", 
     RowBox[{"6", " ", "k1", " ", 
      SuperscriptBox["k2", "2"], " ", "s2", " ", "s3"}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["k2", "3"], " ", "s1", " ", "s2", " ", "s3"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["k2", "3"], " ", 
      SuperscriptBox["s3", "2"]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"matPoly", "\[Wedge]", "invPoly"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    StyleBox["check",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["inverse",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"X", "[", "0", "]"}]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell["", "Text"],

Cell[CellGroupData[{

Cell["(3)  SU(2) algebra: Trace calculations", "Subsection",
 ShowGroupOpener->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]], "Input"],

Cell["Introduce notation and define properties of Pauli matrices:", "Text"],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"\[Sigma]", "[", "_", "]"}], ",", 
    RowBox[{"\[Sigma]t", "[", "_", "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"\[Sigma]", "[", "a_", "]"}], "]"}], "=", "0"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matDimension", "=", "2"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"delta", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"a", "===", "b"}], ",", "1", ",", "0"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"epsilon", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Signature", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", "a_", "]"}], "\[Wedge]", 
   RowBox[{"\[Sigma]", "[", "b_", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"delta", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "+", 
   RowBox[{"I", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"epsilon", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
       RowBox[{"\[Sigma]", "[", "c", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "3"}], "}"}]}], "]"}]}]}]}]], "Input"],

Cell["Define A, B  to be two SU(2) algebra vectors:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], 
     RowBox[{"\[Sigma]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "3", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", "i", "]"}], 
     RowBox[{"\[Sigma]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "3", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"A", "\[Wedge]", "B"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}]}], "-", 
  RowBox[{"I", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}]}]}], ")"}], " ", 
   RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
  RowBox[{"I", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}]}]}], ")"}], " ", 
   RowBox[{"\[Sigma]", "[", "2", "]"}]}], "-", 
  RowBox[{"I", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}]}]}], ")"}], " ", 
   RowBox[{"\[Sigma]", "[", "3", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "B"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"b", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"b", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "3", "]"}], " ", 
     RowBox[{"b", "[", "3", "]"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "B"}], "]"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "B"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "1", "]"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"b", "[", "1", "]"}], " ", 
     RowBox[{"b", "[", "2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "2", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "3", "]"}], " ", 
     RowBox[{"b", "[", "1", "]"}], " ", 
     RowBox[{"b", "[", "3", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"a", "[", "3", "]"}], " ", 
     RowBox[{"b", "[", "2", "]"}], " ", 
     RowBox[{"b", "[", "3", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "3", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "3", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "3", "]"}], "2"]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"tr", "[", 
    RowBox[{
    "A", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "B", "\[Wedge]", "A", 
     "\[Wedge]", "B"}], "]"}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.10000000000000142`", " ", "Second"}], ",", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"b", "[", "3", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"matDimension", "=."}], ";", 
  RowBox[{"On", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]], "Input"]
}, Closed]]
}, Open  ]]
},
WindowToolbars->{},
CellGrouping->Manual,
WindowSize->{956, 721},
WindowMargins->{{Automatic, 110}, {Automatic, -1062}},
Magnification->1.25,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->Notebook[{
   Cell[
    CellGroupData[{
      Cell["Style Definitions", "Subtitle"], 
      Cell[
      "Modify the definitions below to change the default appearance of all \
cells in a given style.  Make modifications to any definition using commands \
in the Format menu.", "Text"], 
      Cell[
       CellGroupData[{
         Cell["Style Environment Names", "Section"], 
         Cell[
          StyleData[All, "Working"], PageWidth -> WindowWidth, ScriptMinSize -> 
          9], 
         Cell[
          StyleData[All, "Printout"], PageWidth -> PaperWidth, ScriptMinSize -> 
          7, FontSize -> 10, 
          PrivateFontOptions -> {"FontType" -> "Outline"}]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Notebook Options", "Section"], 
         Cell[
         "The options defined for the style below will be used at the \
Notebook level.", "Text"], 
         Cell[
          StyleData["Notebook"], PageHeaders -> {{
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"], None, 
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"]}, {
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"], None, 
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"]}}, 
          PageHeaderLines -> {True, True}, 
          PrintingOptions -> {
           "FacingPages" -> True, "FirstPageHeader" -> False}, 
          CellBracketOptions -> {"Color" -> RGBColor[0, 0, 0.466667]}, 
          StyleMenuListing -> None]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Header Graphic (to be pasted in)", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["HeaderCell"], ShowCellBracket -> False, 
             CellMargins -> {{0, 0}, {0, 0}}, Evaluatable -> False, 
             PageBreakBelow -> False, ImageSize -> {350, 24}, 
             ImageMargins -> {{0, 0}, {0, 0}}, 
             ImageRegion -> {{0, 1}, {0, 1}}, StyleMenuListing -> None], 
            Cell[
             GraphicsData[
             "CompressedBitmap", 
              "eJztXD2IM0l67tXPSDPft983u3frkznMCnOcLQyGsaMBOxgwNgw4Gf/BBIad\n\
w3hXxticLlNiUNhphwoVKlSqUKFCgW1Mhwo77LT8Pu9P1VstfXvrwIl9Aqm6\n\
q6urq6vreZ/3r/WX3/zq23/4529+9d0vvpn+xS+/+ddvv/vFYvrn//JLqup/\n\
VhSf/X1RFJNpge1Am/rzT4E+xU1oqTi3bTidz/w907dt2wEf7oeGilNdh3PT\n\
FEOuG0pd03B9Tc2pffFffKz4jov7QJVhczqGsqpCNZ+H9dtbWC0WYb5eh+Vm\n\
E3b7fWgadBTCgbrY4PhyycfpWI+7uQ01ujkcQkWnrl9fQ4kuqEt0sT9QF3Tl\n\
/5Qrf6sDPtG9HGYzVGHA9DsIp+k0zOnU1W4XjlXV14OnySTMyzLUNBB8j5NJ\n\
PAVdvK7KsKYr0VX+Qy7yj3oRTFpLk4i2Y/7th8VqhS3dk9/1Yh72uE3X7o3a\n\
7fY77unfpdtiFI7rI31P4UDfvDwWPWzR+Qdt0zlu+9Ks76vk1F73qJxsHQ9j\n\
Z8fumcWPrgwotTvGvvLtbqnH3PX8eaeLY53rFHwDtFaPVyfA3Vq8XOHuedAd\n\
R97eD03q9rs2NPRU3tmzHBfxyfbik62ozdg92dtwpjaPr8uwXe3CaVuH46am\n\
8hROVB63vE3n0xEs013NbahE3Q51Ner2NUqqq/dctz9jCyXXnel26sNZ6qk8\n\
H859bBS/Fc7HBrtU6pe3G92XskF5kv0G9adGjlHZnK6WPWyQIKghAFDX1C32\n\
rISQqNvi89CeU71s0/fcpnrbtrJp6WZoi/ptG6njL2+zbKIWH+iXQIK6BpKm\n\
1X3ZlhJoTPuyHQbYAFb1MPZ6WscfrftGMdgP82IVFvKllvi9obqS69KxEtty\n\
eOhPsWZ6aupuznuo+5h147tN5afqrd/R97Qttc2ge34vDcKqtOltdgvz60PT\n\
4Y+uDaszvO+bkkH3WmmSr83CcqjPZTl+CdX9QiUzfm9CWTwYJvm7Hz9Su4Wd\n\
UhMH5cJ4GJ7plOfxPCzvq7CalGE5qWhgq2lFna6m67CaVaGcrfHthfJhTSeW\n\
j5tQyZeaVk8bIP9pG6rnLZWoW79sqW7zsgub1y2+VLd53dHlNm+7sI3ffdjO\n\
d3RsO9/T5XYL2qevllSxPBTvw351CDv67u1bWklCirYPVSr31bGPDTrNifRM\n\
PB82VG5U9KFkWQTxt4U0PW1VPCVRBNHTV2kESXQS6SPSqMdyBtKmNhFEB0jK\n\
QCSpzKlF/vQgVCARTyZ6ROx40QKRQNuFiJYRiwUREyYqosigy7QmLEQ8iDiQ\n\
6huFeNspw98KsuVhDuXZPmywJ9/ZmrrEsXd6zL4bO+7KWIdlQefcdOvt3Lh2\n\
UpdFXkfrabZ2w7roQod14+v8UPp2qr8bPrzR0aXLVw+bi8vrnv6mO+v9oDob\n\
3ofusMKKvtvZkiZ9TOQ4Cc14QmrSOBzvn8L8cR9eHmntjmeG4ZfJS3h72Ibt\n\
dEkzUoW3x1M4jycDRe0rHX59PIbddKGwHxLMJ+HpYQEoMhDXzwzCZwEh7QOI\n\
AsnXXQ/YI2LaRAQyCsNunqEv7Je0je9C4AYw9rFFq1IgeJQS0AMUAb/yWAj+\n\
RqKyAJpeddkcVfkg5BESjqwDMP5MFxAdgYF3Yt1gyMgbMd+LHnCWUvg/IvFM\n\
cxdBqLoAyL5m4AlGVRegEhg1RN4R8pT0u0RfJ1Q2TPo11Bvh8CZyOQ4LhzM4\n\
+4zOfqRvUnWB0gYPPUS67gITPyFRcStUTE/4byJgGZokmklYlyywSVhL9VRk\n\
9TTKahwKK24Sm5J811LbrfB1x1Af2+h5pbWdWp9lbC/1PJyejAW88ZPs/Njf\n\
fbpG3I/jTf2VuI9JGredj/0VcxPu9zbV35fa78X4tO1Q7uve2vN143Ry3Vjn\n\
CPeBg1/ES6PbeJs2hbgkhknAXjzswoJAvHzY8/aSvhVuY/KsVtMwvM5Kbrua\n\
bfScvUJ3wNrxw3TFAmP+eDQh0EBpni2IatfAMSGbUS2gHiqot1wSpBPDCrjf\n\
M6AvgD0/SLk8CLCpFJAfBsB1D/DtgUpvFMIM2+qYUehhE62kDYMT+zmMWZ2H\n\
2WD8qXsE43eizu8EvrFUdf5kKnxS7Qm3RJgKa4Vz1OPrpMd7PPcFz6LA4wD9\n\
fpVwXSuuc4U9tHVSyAHktvaKeQPF3CnizLTKwGNRxE0JB3IjuhnYgupBUrCl\n\
VGAXfxhXGB4ZJg3yFrKwegQY1vysoTExSGilQG/Bg4FstgcEdQgPzNphXaAd\n\
5DnqsY9+7Twc27i2uB4vCVarjowAtPd9oG8sJ2xTHyLqP3ATDB0rNQ1tL8Ml\n\
RRGnoDvcBo4zdaz09Du5msKfr7YURsHVcYqODEvzWPx2lHQ8kO1JJgETQKct\n\
qR66MrrBg8Nqw8qBuoqbNaUPN4zRbf0kbXTySAD0o06zIUhvwdUK55uwmLxS\n\
HdQV4XnAmtoYGe+I4p+mC9ZgliQZzuNpRPvDbJ5I+ok0FsD56wRlU5hRqpKc\n\
aNrRNaNZy6VQNso9I9u0Zdk3TZkfPei6kse7r3iSla7Hgm+l64NzoShl9xnu\n\
fZ7wYwbzoTK3igBRm5W1hwpzg3Sy2NmKP2i9KtBnan8+RAveVGeBNmksYpaf\n\
k/6cUJ6hO5rjUY++SWhXZCvKjaqbZGVHULNl3RioHWVLaaBuE1U79br408ia\n\
eOCYMnzw9ISdS346+MC+M/DjdvBBiTXLnkB6KrzOpqK7Aj344HZwHtphGx88\n\
ZdY5tR59mtTBPtY8xoNHgg/GxaxLggaSl69HqwNI3qjQwQf7eFT48H1RP6jD\n\
B3jDuLCWxUU54jbcH13XdGEeU2zT5/GgnlZ4Ya5NjA0aB8/bo7tXeqToR0x0\n\
tP0AHZ77xPzgA9R833zh+ZLG008mjjwKYuz6/nGgLsfF/WOYTN9IkqzECFGL\n\
gZo5ffueSHvOtvGStPdmfB8hDj0cMo8N4idl7AFDHBPGUH/dijn8hZrHl0jf\n\
GX8r0iHjTBlnpAPVgnSaDyjlg3BwSFcmB7wN8IB5z4O9ax9vIthFPR+x4I3c\n\
rqq58bm4577yNrIYx57TI/DPHuyqmnc4Xcv6oFxefHnpp/OGsqrsl8AHvTtq\n\
P7Pa3tLiylm96brdktON1JQ2utAy0Ecwue3CIP8HcbFgWQLWEBnwHEHRhtaI\n\
58BigB61V4KtDucAdngeUEpLPQ91DL0HVY5Bpk95nSn082LJ9Zhcg6ZprQwT\n\
Wm50Ppw8pCL/icCb+jetdkHXxbLEpGPs6IcVZNCligOsGbRD/yyy2hDdVJh4\n\
u+fSjQfKodWjLcOazsV2mrd1eNP2ICscA7mxmBmroj+ruB8scyw67GPt8nw9\n\
dOZrluYGNP4yIwWfyJlg8Ujm9Yow3EZ67ocXwv4rqFucE6wBkLJ+EcAYkwYA\n\
in+aldH1VlOb54fScC9gN439Til+F8tPAL8P1Pdwz9SlWeMZtS/3YoR/4bB+\n\
8IxufjDxi62PSYOvLmITIG82xA3pJ4f0jkGuiH8fNfdLLV6QfvKIP9QD5XcH\n\
dAX4OAe4Y3Pd77Pq/rvmFFNMO5Pcq+y5DZ6BGzBszm3G6ChDE3JDvGkTuJPH\n\
TIHe/p3i/Ou4tmW9VTwFojqueR0aleJk7JthbZSLNYr1jAuy4Unbb7TWMdVC\n\
qYITrG2TD1gJy0kyXPn8urX2Uv1HfKq/DIa5ULjhqVsd2Nd8AajDlPPwIaYq\n\
0VYwvxg2LhWHprbyUTVu89ujTxZj812C3LiMGo2JIps2GxOuAcjjmeIzl3Zy\n\
Oz8SNBM20BUe5admyxB+un8Kp/Ek7It7pmlECIvJW5jOloVR/IHqngj+3pUp\n\
WsBDFAUnOn9O4uAcvevvwmY8JVt/bdo7G+XVMxkWz9uoMKkqr/7uLxnb1wge\n\
5M4kr4b5brG/IHi2xkiN37FtTpi/Ecybwy1hfsC8PnR8fjRjPcbwjub33tTJ\n\
eN8mv5uQvEbhEB42bV7IXdB/491uDum1eOCSG1xQDuTfdCi+MRNejPX3yuzn\n\
T0bbcvS34oR7n4G/VfC3Hvy5vS4OuFGKmxnOzSEnfrc8EJa8b7Rk4uo1Y50e\n\
J2YAHicGIBr+WTQll1LNvZyVQ1eOQ035sYt5gNh5ACID1lbpfQIiQGMeKeNY\n\
TNdiXGZ94AFxWzoXx00A4Dyz6VlXOcsdQzDg4aLO9BXucyp6hx+7nbOaJecj\n\
C5D1yZAp6vaYh9OouHorFnFbRZ3g/fOwwp2qr+3aTLU6UyvFbOPo+0x41xBX\n\
pGpou/C/leLwZ0pfsfFecYs7VelfZktxsimu1xLVet5KMGskbrbobssAzQGs\n\
nUSxvkhRLI/mpStXB3OAxFDWoTRfOsMaSGY9vZPLkMewzCi/NejyskvxK7ft\n\
2VshbS50YW/P2gnfNOnC3qPkbnNYzlxvsN1d2Fy+Z/W+9T1tq02eEOxD4VdD\n\
4lKyQ7346NjbbPLWo1ii3QnBmaquaDb3zkpxAPugh1VOz89wZHoo1ryRFS4d\n\
8UUlLsUEqbo1JpNwrivtLum5DpemM+zU/N+zZ4se9x/HKk9qOO2s3IhHb3dv\n\
xwE7dpLRpYErFjfHhrehHuB8eLkYplBDlJfRHksVx2sFl/XJQ6TbMtV7pRa5\n\
F0Pm0Xil65i6s0iqvE7B+6gq8XS1+XTVMl3Ri0bgv1Nhu1InW+k0LXQFdZys\n\
9Vtu9iFsiKKXgOujat0G3+dNNLczahZnufOVD1m92JmvfMEetkJU8EH0k2sp\n\
NHzLbvMUjj5Gv+pBMUzqdxYHYxW8usByYYZ2cp6foifN5cawJ83zsXKyHvsi\n\
J+OMmJPRfU65MYmNNRmG9r0D/afqZmtiZkyXlyUw1n5CEzcizk3sVveTNi4Z\n\
LeJv+zxp523KagldTdzqFM9men8dzV+/RnGLpa5bwc+RIYlHgfXLEG9Dtnax\n\
PvEIIdsN9qx631ep73Hp+Gula/33xJWupifO4ZVH/Qil5hjxVC5eqoOKm2Q6\n\
oz+cZ+PAMsK10Se2gUl8sPIRJig1VwPnvKosUFmRYmHOc4cyxcLuGPPeK7lR\n\
uVE6eo+6+Th6Fg7Xpssik32m6e10ocq30O1m8szhMudhi0IZMXGCuNrVIg52\n\
tL94OkjayZOmnyhdRyv7XbKuFeprEPWrd6abI92yTsZZ1gnz9cJCY87a7gs1\n\
C2UXvRjojhZ3hLun6kjZkm6iavedxszsW0fY5+p4bZSNQxdGt0bCr6Bd1O4x\n\
M7l3p9fmUhfwC9TfJfXbEt8+7VUvesrf5zrCXutusgQ3p4f3sEEiqvXquGdw\n\
n69menmTaNuzdzLAvelmJA4EbRV1+Gw16rQYr3RFLy+YbqXRZ0yfOdTYTz5N\n\
od+lt34jkn4/tsEHC8wMfZTGnCw1FO2GcHOUmY8/U5yrUzzXYlSsAdDDMSkG\n\
E3IZz6n48Zc6DoxTHHmVD3AzKmk9r+4rAy+q1yqrgChTVdADXXHAzT5KHFzD\n\
8xeTNKmyB7FkQK85saUZTzQr9I6TXg6TJw2U7S4eXiZWbpni1zMy71kGcBqp\n\
5ss8UIuS+H4v0QP8Js4vvBCIrnbnatu8bTNhEDV3GuIu87Xvu7xvirsIg2FM\n\
Pdu7vJcUNO/61WMgLQoAc7Ux2B3vp8Qz3h+oKd7xssWM1xz3Q8b9wGW5WvKL\n\
8fqN4/QmgV2zWQ3XqqUzrsV1fndVPY8gb6Ka3rfUs+hoM4DHkFnKTHNfwbmS\n\
+VA1Rw50Q5qqERpxOZGYjz0XZU1ZPj8T3VohZITL4V9aEktJcLwgWyNFVlKD\n\
s7uV+DYOKAzxaRWVaiNfG1ql6V+qMItbIEkL8xwc1UTGClu5S6G0aB5LMOjv\n\
QLwONfry1MVgADJAGgGjXbxNdT2Us5TPifVkOTHU3oJyEAPqFkxWkgbBkbfS\n\
40DYUHNetoxp7tYRuMN2EcXNg2Af4Ea5fJSyJMWd2gueB05/Z24XSH8VA+RR\n\
hbfygtclQL5bqIct2uKO19mzttdctkGWTkrbKWymKn0Mm91EbhfPeidcdhdj\n\
411EW3xckd230LhT5tUKj6HxU7TEa3WjDZICL2HxLMn0EP3oYowPUnKplILw\n\
UUJ4J2SWMfn50rPWgMkRIBskzIv+3tcsVO9Mp7LHHrVhykFPfvTI46NMY4/O\n\
L+bbU4wJ8+qdOc2bhgzUMPgkBqzL7HciixnwjfzQzgJN+JiDjDmVRvZSzLle\n\
DP9VzKAzJxp4gT1VysfGz5oyPi41u4fHSSgm7VuGP86Gjy7Mk4XFxNneGPnP\n\
s0Nsf2MW2AfTsOZi7gg8jDlngy/5SWD52+i1S27L+lVI/nq2G1RkJRfhKvZp\n\
ugBrHUnX75vZ4JyfucL+PnOMllceaM71mgos8XvOAXhcR71e8L+RVHJYT8/b\n\
bnaMZZJnVD73meR9r9PDlF8ipCbpq9EBZ3HzG5cdo751CZgL6G+d/e5zWTM/\n\
XGbHJ27PHXA39j5LInPY73vJkrkIlCvsP89Vd5cAV7vAeIqbnTUDTrxuznRX\n\
r9s7l/d2xeNWZ5HxIoN8Ut4F8sOY6ubeM9GXSYbG6Zm1nmWy3ifdr5NQEr3h\n\
zhXFiSzaFRZItC8/RksaA1xoYqzlhOAhWd4KjuPB8TaNWtYARjTgieccFuIe\n\
VnuEDfF8QUdi+wRObbGQqBczauBrm2FypFnaC78VgWPv+dn7lJiViiSTEyZy\n\
MER+TU26xB2ZH5BtfHb/4NiPpUsNtZuFYwEkm1BTZ3i2iKDQl8mDGLMTJ5u5\n\
AzzmVxc4XufNB93mmUffnV1ZWr69RQLYR/i75PU+kC9ov2XlPbnd94p6iZ9p\n\
oow67T6q173jefcvkWSANw2e6xPVuwB6pP31MQumrZnqC/HCf8xi6BH8uzrb\n\
5nJfd7NgNYF9lCe2H7I4ugqE4UU4LQXUR5032prkx4uu+KHG09rMJS96/gf3\n\
plrTFQbRf9d0LPnAZB+Da04HiILh1wXX7nK+iJHvNT8XAy/RltGR53kwZNIB\n\
fh4D52tW1hPQsHyQU4b8uIV6nW0BgmeY+bQtZ6+qVs3JOoQaLFwomFLu2JhA\n\
37z8XiW1o3Secs71i5CpLO/MgKbpeTLqn0RnmmTFpdx6MJ95vCx/HXeG4xix\n\
jcD0+51mGJqfn/pSpruL2pV3qFumIN+h2BA2yVd4vfj1x/r+WDGwX31fR0if\n\
hEOy37NwW9H3TjwNo38uZN8lfE1GTjnuPowuxA/O32mu3N7lyqU4+iFx/buU\n\
NlN1ffZd3jfYjy/eX/FpM1SKE+82SYBPZs7411jOFxKAPXYQAO9S7O1wRQtw\n\
2TSNZb+L8j/I8uTOdevjcG1Kl8vB7g38Rj16yV8fY3BZFk3IfPXiwWu9B89c\n\
PREetHhZXNEdYaLYVyU40bajGDvHhGDOMSJesNHKvItw91qF1KWXWMrpWl7y\n\
+KC7yS4vnbSw5kbRdnxlp480Gy1PCiil+QVOnPmvmBhl53bbmN2cLltFT0U5\n\
i+2iULGblSENDYl2Q1dG9D9D9fVjMsqbdOxxncQqXvqD4nP3A6JyjPgepwIP\n\
0ruhwvGi1N86J/3eOekz/5zi+8uUG7fKnHQxP45LnxNXuax3ezl0ffTvqeUY\n\
dwH2nc+bucvNekfnnXfWBMxfRas+D801XbM+ueevvp9+Tq+2MNL1PTX37nlk\n\
8vRaS08zXnPtXt5s6dubLcbg8RVyD+pw8eo4ofuvBeNDXZrxXTV5UavfWTKW\n\
mqpNBv8Lq/Q3x374MfZePuK5CUGrI04T90HQI2eQbznCFnNZX2GBb/QFtL1L\n\
Zt9fRtmWWZRt0MlvSy+V8hsrgxhL7/6/RwquCVZvlI+vBdO2SA5iuKYQ+vV3\n\
0WJOTJ6zLnluKaet80qaOdudHp7p4ChF11bjPAXW+snZPkqvlrLvzefDNGqR\n\
950SblgdXaazpr+AELPczNpokye0Fv+my2Lzm/L/YVnZG/qD6JarHu0FFuLw\n\
cfTKe4+cueO3SKaBoj72wbXsRRbFv5joQzXNc+7uqwzoJMMZd/e9Zb7u5NNs\n\
1DK/dWmuyRFvf/Nw+Xcz6YU1oe8f5zlxO0ffh45l7qPql9H1/D8fBpHGGyk5\n\
WY6kUeaCPzm2tr98qC/S4Lwd3kt5cbcpgp69jOrKT/zVS/xDiNcCfymAxLFX\n\
/b7Bjf2b6v9b1UOOD7xxlcQV5sVSQn/81zN9+Ah6UMaQvJP+GkD/Fkb+MGOV\n\
LIAHsebZmCfVG0q+ue/XL5skLF5dOL6bFe9eV9f4XY9deiMXjd/nTj2x4zkm\n\
X/Lrb5YO7/4Gpsf/FDa8Gotn+51faOVkd++nU6P9LgmIfWaod4zzWl5e/WmO\n\
/0xv76TXdLLaLZ3m7I3wLBG2ybLmmviW6ihHevbOSlv8lXL7Z/8N0qTycw==\n"], "Graphics", 
             ShowCellBracket -> False, 
             CellMargins -> {{0, 0}, {Inherited, 0}}, Evaluatable -> False, 
             ImageSize -> {350, 24}, ImageMargins -> {{0, 0}, {0, 0}}, 
             ImageRegion -> {{0, 1}, {0, 1}}]}, Closed]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headings", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Title"], ShowCellBracket -> False, 
             CellMargins -> {{60, 0}, {0, 5}}, PageBreakBelow -> False, 
             LineSpacing -> {0, 37}, 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontSize -> 36, FontTracking -> "Plain", 
             FontColor -> GrayLevel[0]], 
            Cell[
             StyleData["Title", "Printout"], CellMargins -> {{9, 0}, {0, 0}}, 
             FontSize -> 24, FontTracking -> "Plain"]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subtitle"], ShowCellBracket -> False, 
             CellMargins -> {{60, 0}, {0, 5}}, PageBreakBelow -> False, 
             LineSpacing -> {1, 0}, 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontFamily -> "Helvetica", FontSize -> 14, 
             FontSlant -> "Italic", FontColor -> GrayLevel[0]], 
            Cell[
             StyleData["Subtitle", "Printout"], 
             CellMargins -> {{9, 0}, {0, 0}}, ParagraphIndent -> -85, 
             FontSize -> 16]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubtitle"], ShowCellBracket -> False, 
             CellMargins -> {{60, 4}, {30, 10}}, PageBreakBelow -> False, 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontFamily -> "Helvetica", FontSize -> 12, 
             FontSlant -> "Italic"], 
            Cell[
             StyleData["Subsubtitle", "Printout"], 
             CellMargins -> {{9, 10}, {50, 10}}, FontSize -> 14]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Section"], CellFrame -> {{6, 0}, {0, 1}}, CellDingbat -> 
             None, CellMargins -> {{44, 0}, {10, 35}}, 
             CellGroupingRules -> {"SectionGrouping", 30}, PageBreakBelow -> 
             False, CellFrameMargins -> {{8, 4}, {0, 4}}, 
             LineSpacing -> {0, 22}, CounterIncrements -> "Section", 
             CounterAssignments -> {{"Subsection", 0}, {"Subsubsection", 0}}, 
             FontFamily -> "Times", FontSize -> 24, FontWeight -> "Bold", 
             FontSlant -> "Italic", FontColor -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["Section", "Printout"], 
             CellMargins -> {{9, 0}, {2, 50}}, 
             CellFrameMargins -> {{5, 4}, {0, 4}}, FontSize -> 14, 
             FontTracking -> "Plain", FontColor -> GrayLevel[0]]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsection"], CellMargins -> {{60, 0}, {8, 10}}, 
             CellGroupingRules -> {"SectionGrouping", 40}, PageBreakBelow -> 
             False, CounterIncrements -> "Subsection", 
             CounterAssignments -> {{"Subsubsection", 0}}, FontFamily -> 
             "Helvetica", FontSize -> 16, FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsection", "Printout"], 
             CellMargins -> {{9, 0}, {6, 40}}, FontSize -> 12]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubsection"], CellDingbat -> "\[FilledSquare]", 
             CellMargins -> {{60, Inherited}, {8, 12}}, 
             CellGroupingRules -> {"SectionGrouping", 50}, PageBreakBelow -> 
             False, CellFrameLabelMargins -> 6, CounterIncrements -> 
             "Subsubsection", FontFamily -> "Times", FontSize -> 13, 
             FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsubsection", "Printout"], 
             CellMargins -> {{22, 0}, {4, 20}}, FontSize -> 11]}, Closed]]}, 
        Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Body Text", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Text"], CellMargins -> {{54, 25}, {6, 6}}, 
             CellFrameMargins -> {{4, 10}, {6, 0}}, CellFrameLabelMargins -> 
             4, TextJustification -> 1, LineSpacing -> {1.25, 0}, 
             CounterIncrements -> "Text", FontSize -> 14], 
            Cell[
             StyleData["Text", "Printout"], CellMargins -> {{9, 0}, {4, 4}}, 
             ParagraphSpacing -> {0, 6}]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Commentary"], CellMargins -> {{60, 20}, {2, 8}}, 
             TextJustification -> 1, LineSpacing -> {1, 2}, FontFamily -> 
             "Helvetica", FontSize -> 12, FontColor -> RGBColor[0, 0, 0.4]], 
            Cell[
             StyleData["Commentary", "Printout"], 
             CellMargins -> {{9, 0}, {4, 4}}, LineSpacing -> {1, 3}, FontSize -> 
             8]}, Open]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Input/Output", "Section"], 
         Cell[
         "The cells in this section define styles used for input and output \
to the kernel.  Be careful when modifying, renaming, or removing these \
styles, because the front end associates special meanings with these style \
names.", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Input"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, 20}, {0, 0}}, Evaluatable -> True, 
             CellGroupingRules -> "InputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             CellFrameColor -> RGBColor[0.6, 0.2, 0], DefaultFormatType -> 
             DefaultInputFormatType, AutoItalicWords -> {}, FormatType -> 
             InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
             CounterIncrements -> "Input", FontWeight -> "Bold", Background -> 
             RGBColor[1, 0.8, 0.4]], 
            Cell[
             StyleData["Input", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, 0}, {6, 6}}, Background -> GrayLevel[0.8]]},
            Closed]], 
         Cell[
          StyleData["InlineInput"], Evaluatable -> True, CellGroupingRules -> 
          "InputGrouping", CellHorizontalScrolling -> True, PageBreakWithin -> 
          False, GroupPageBreakWithin -> False, DefaultFormatType -> 
          DefaultInputFormatType, AutoItalicWords -> {}, FormatType -> 
          InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
          CounterIncrements -> "Input", FontWeight -> "Bold"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Output"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, 20}, {15, 0}}, CellEditDuplicate -> True, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             CellFrameColor -> RGBColor[0, 0.500008, 0.6], DefaultFormatType -> 
             DefaultOutputFormatType, AutoItalicWords -> {}, FormatType -> 
             InputForm, CounterIncrements -> "Output", Background -> 
             RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["Output", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, 0}, {6, 2}}, Background -> 
             GrayLevel[0.900008]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Graphics"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, 20}, {0, 0}}, CellGroupingRules -> 
             "GraphicsGrouping", CellHorizontalScrolling -> True, 
             PageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             CellFrameColor -> RGBColor[0, 0.6, 0.6], DefaultFormatType -> 
             DefaultOutputFormatType, FormatType -> InputForm, 
             CounterIncrements -> "Graphics", ImageSize -> {250, 250}, 
             Background -> RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["Graphics", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, 0}, {6, 2}}, ImageSize -> {250, 250}, 
             ImageMargins -> {{28, Inherited}, {Inherited, 0}}]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Message"], 
             CellMargins -> {{72, 20}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             DefaultFormatType -> DefaultOutputFormatType, FormatType -> 
             InputForm, StyleMenuListing -> None, FontColor -> 
             RGBColor[1, 0, 0]], 
            Cell[
             StyleData["Message", "Printout"], 
             CellMargins -> {{44, Inherited}, {Inherited, Inherited}}, 
             FontColor -> GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Print"], 
             CellMargins -> {{72, 20}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, ShowCellLabel -> 
             False, CellLabelMargins -> {{23, Inherited}, {
               Inherited, Inherited}}, DefaultFormatType -> 
             DefaultOutputFormatType, FormatType -> InputForm, 
             StyleMenuListing -> None], 
            Cell[
             StyleData["Print", "Printout"], 
             CellMargins -> {{44, Inherited}, {Inherited, Inherited}}]}, 
           Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["CellLabel"], StyleMenuListing -> None, FontFamily -> 
             "Helvetica", FontSize -> 9, FontWeight -> "Plain", FontSlant -> 
             "Italic", FontTracking -> "Extended", FontColor -> 
             RGBColor[0, 0, 1]], 
            Cell[
             StyleData["CellLabel", "Printout"], FontFamily -> "Courier", 
             FontSize -> 8, FontSlant -> "Italic", FontColor -> 
             GrayLevel[0]]}, Open]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Unique Styles", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["DisplayText"], CellFrame -> 0.5, 
             CellMargins -> {{60, 20}, {15, 5}}, LineSpacing -> {0, 12}, 
             ParagraphSpacing -> {0, 6}, FontFamily -> "Helvetica", FontSize -> 
             14, FontWeight -> "Bold", FontSlant -> "Plain", Background -> 
             None], 
            Cell[
             StyleData["DisplayText", "Printout"], 
             CellMargins -> {{9, 0}, {4, 4}}, ParagraphSpacing -> {0, 6}, 
             FontSize -> 10, Background -> GrayLevel[0.900008]]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["PictureGroup"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, Inherited}, {0, 0}}, CellGroupingRules -> 
             "GraphicsGrouping", CellHorizontalScrolling -> True, 
             PageBreakWithin -> False, ShowCellLabel -> False, CellFrameColor -> 
             RGBColor[0, 0.6, 0.6], CounterIncrements -> "Graphics", 
             ImageSize -> {250, 250}, Background -> 
             RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["PictureGroup", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, Inherited}, {6, 2}}, 
             ImageSize -> {250, 250}, 
             ImageMargins -> {{28, Inherited}, {Inherited, 0}}]}, Open]]}, 
        Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headers and Footers", "Section"], 
         Cell[
          StyleData["Header"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 9, 
          FontSlant -> "Italic"], 
         Cell[
          StyleData["Footer"], CellMargins -> {{0, 0}, {0, 4}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 6], 
         Cell[
          StyleData["PageNumber"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 9, 
          FontWeight -> "Bold"]}, Open]]}, Open]]}, Visible -> False, 
  FrontEndVersion -> 
  "9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, 2013)", 
  StyleDefinitions -> "Default.nb"],
MacintoshSystemPageSetup -> \
"00<0001804P000000`d26_oQon@3:`8g0dL5N`?P0080001804P000000]P2:001\n\
0000I00000400`<30?l00BL?00400@0000000000000006P801T1T00000000000\n\
00000000004000000000000000000000"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 28, 3, 63, "Text"],
Cell[CellGroupData[{
Cell[610, 27, 291, 13, 183, "Text"],
Cell[904, 42, 118, 6, 135, "Text"],
Cell[1025, 50, 1271, 47, 135, "Text"]
}, Closed]],
Cell[2311, 100, 25, 3, 59, "Text"],
Cell[CellGroupData[{
Cell[2361, 107, 186, 7, 53, "Text"],
Cell[2550, 116, 706, 22, 228, "Text"],
Cell[3259, 140, 882, 22, 259, "Text"],
Cell[4144, 164, 692, 15, 197, "Text"],
Cell[4839, 181, 1010, 31, 259, "Text"],
Cell[5852, 214, 349, 14, 72, "Text"],
Cell[6204, 230, 918, 20, 290, "Text"],
Cell[7125, 252, 506, 18, 72, "Text"],
Cell[7634, 272, 367, 11, 72, "Text"]
}, Open  ]],
Cell[8016, 286, 25, 3, 63, "Text"],
Cell[CellGroupData[{
Cell[8066, 293, 187, 7, 53, "Text"],
Cell[8256, 302, 518, 15, 115, "Text"],
Cell[CellGroupData[{
Cell[8799, 321, 478, 19, 65, "Text"],
Cell[CellGroupData[{
Cell[9302, 344, 459, 15, 135, "Input"],
Cell[9764, 361, 534, 17, 135, "Output"]
}, Open  ]],
Cell[10313, 381, 295, 11, 135, "Text"],
Cell[CellGroupData[{
Cell[10633, 396, 519, 18, 135, "Input"],
Cell[11155, 416, 534, 17, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[11738, 439, 332, 13, 33, "Text"],
Cell[CellGroupData[{
Cell[12095, 456, 264, 8, 135, "Input"],
Cell[12362, 466, 958, 33, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13357, 504, 55, 1, 135, "Input"],
Cell[13415, 507, 2000, 59, 135, "Output"]
}, Open  ]],
Cell[15430, 569, 114, 3, 135, "Text"],
Cell[CellGroupData[{
Cell[15569, 576, 163, 5, 135, "Input"],
Cell[15735, 583, 647, 20, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16419, 608, 77, 2, 135, "Input"],
Cell[16499, 612, 301, 10, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16837, 627, 101, 3, 135, "Input"],
Cell[16941, 632, 156, 5, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[17146, 643, 1976, 71, 226, "Text"],
Cell[CellGroupData[{
Cell[19147, 718, 141, 4, 135, "Input"],
Cell[19291, 724, 820, 27, 135, "Output"]
}, Open  ]],
Cell[20126, 754, 202, 8, 135, "Text"],
Cell[CellGroupData[{
Cell[20353, 766, 608, 18, 135, "Input"],
Cell[20964, 786, 1542, 43, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22543, 834, 60, 1, 135, "Input"],
Cell[22606, 837, 267, 7, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22922, 850, 356, 14, 33, "Subsubsection"],
Cell[23281, 866, 1116, 56, 135, "Text"],
Cell[CellGroupData[{
Cell[24422, 926, 572, 20, 135, "Input"],
Cell[24997, 948, 3995, 136, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29029, 1089, 61, 1, 135, "Input"],
Cell[29093, 1092, 9364, 297, 135, "Output"]
}, Open  ]],
Cell[38472, 1392, 500, 21, 135, "Text"],
Cell[38975, 1415, 207, 7, 135, "Input"],
Cell[39185, 1424, 94, 5, 135, "Text"],
Cell[CellGroupData[{
Cell[39304, 1433, 61, 1, 135, "Input"],
Cell[39368, 1436, 4846, 159, 135, "Output"]
}, Open  ]],
Cell[44229, 1598, 48, 0, 135, "Text"],
Cell[CellGroupData[{
Cell[44302, 1602, 88, 2, 135, "Input"],
Cell[44393, 1606, 28, 0, 135, "Output"]
}, Open  ]],
Cell[44436, 1609, 92, 3, 135, "Input"]
}, Closed]],
Cell[44543, 1615, 371, 13, 60, "Text"],
Cell[CellGroupData[{
Cell[44939, 1632, 2383, 84, 388, "Text"],
Cell[47325, 1718, 295, 9, 135, "Input"],
Cell[CellGroupData[{
Cell[47645, 1731, 85, 2, 135, "Input"],
Cell[47733, 1735, 130, 4, 135, "Output"]
}, Open  ]],
Cell[47878, 1742, 148, 5, 135, "Text"],
Cell[CellGroupData[{
Cell[48051, 1751, 75, 1, 135, "Input"],
Cell[48129, 1754, 170, 5, 135, "Output"]
}, Open  ]],
Cell[48314, 1762, 126, 3, 135, "Text"],
Cell[48443, 1767, 583, 19, 135, "Input"],
Cell[CellGroupData[{
Cell[49051, 1790, 496, 15, 135, "Input"],
Cell[49550, 1807, 83, 2, 135, "Output"]
}, Open  ]],
Cell[49648, 1812, 1711, 75, 135, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[51396, 1892, 720, 25, 114, "Text"],
Cell[CellGroupData[{
Cell[52141, 1921, 149, 5, 135, "Input"],
Cell[52293, 1928, 128, 4, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52458, 1937, 139, 4, 135, "Input"],
Cell[52600, 1943, 334, 11, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52971, 1959, 242, 7, 135, "Input"],
Cell[53216, 1968, 236, 8, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[53501, 1982, 590, 24, 87, "Text"],
Cell[54094, 2008, 378, 11, 135, "Input"],
Cell[CellGroupData[{
Cell[54497, 2023, 84, 2, 135, "Input"],
Cell[54584, 2027, 138, 4, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54759, 2036, 89, 2, 135, "Input"],
Cell[54851, 2040, 142, 4, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55042, 2050, 221, 8, 33, "Subsubsection"],
Cell[55266, 2060, 505, 19, 92, "Text"],
Cell[CellGroupData[{
Cell[55796, 2083, 246, 8, 37, "Input"],
Cell[56045, 2093, 1455, 45, 77, "Output"]
}, Open  ]],
Cell[57515, 2141, 251, 6, 64, "Text"],
Cell[57769, 2149, 254, 8, 59, "Input"],
Cell[58026, 2159, 144, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[58195, 2168, 279, 9, 37, "Input"],
Cell[58477, 2179, 392, 12, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58906, 2196, 57, 1, 37, "Input"],
Cell[58966, 2199, 135, 4, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59138, 2208, 101, 3, 37, "Input"],
Cell[59242, 2213, 135, 4, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59414, 2222, 104, 3, 38, "Input"],
Cell[59521, 2227, 836, 27, 59, "Output"]
}, Open  ]],
Cell[60372, 2257, 141, 3, 63, "Text"],
Cell[CellGroupData[{
Cell[60538, 2264, 152, 5, 38, "Input"],
Cell[60693, 2271, 418, 14, 59, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[61150, 2290, 25, 3, 63, "Text"],
Cell[CellGroupData[{
Cell[61200, 2297, 187, 7, 53, "Text"],
Cell[61390, 2306, 1307, 40, 135, "Text"],
Cell[CellGroupData[{
Cell[62722, 2350, 1341, 46, 135, "Text"],
Cell[64066, 2398, 395, 13, 135, "Input"],
Cell[CellGroupData[{
Cell[64486, 2415, 133, 4, 135, "Input"],
Cell[64622, 2421, 99, 3, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64758, 2429, 63, 1, 135, "Input"],
Cell[64824, 2432, 28, 0, 135, "Output"]
}, Open  ]],
Cell[64867, 2435, 214, 6, 135, "Text"],
Cell[65084, 2443, 548, 17, 135, "Input"],
Cell[65635, 2462, 792, 35, 135, "Text"],
Cell[CellGroupData[{
Cell[66452, 2501, 199, 5, 135, "Input"],
Cell[66654, 2508, 211, 6, 135, "Output"]
}, Open  ]],
Cell[66880, 2517, 644, 24, 135, "Text"]
}, Closed]],
Cell[67539, 2544, 466, 17, 135, "Text"],
Cell[CellGroupData[{
Cell[68030, 2565, 707, 35, 135, "Text"],
Cell[CellGroupData[{
Cell[68762, 2604, 445, 17, 135, "Text"],
Cell[CellGroupData[{
Cell[69232, 2625, 470, 15, 135, "Input"],
Cell[69705, 2642, 452, 15, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70194, 2662, 61, 1, 135, "Input"],
Cell[70258, 2665, 31, 0, 135, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[70350, 2672, 564, 23, 135, "Text"],
Cell[70917, 2697, 502, 14, 135, "Input"],
Cell[CellGroupData[{
Cell[71444, 2715, 79, 2, 135, "Input"],
Cell[71526, 2719, 166, 4, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71729, 2728, 84, 2, 135, "Input"],
Cell[71816, 2732, 169, 4, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[72034, 2742, 1333, 45, 135, "Text"],
Cell[73370, 2789, 284, 8, 135, "Input"],
Cell[73657, 2799, 305, 11, 135, "Text"],
Cell[73965, 2812, 828, 25, 135, "Input"],
Cell[CellGroupData[{
Cell[74818, 2841, 763, 26, 135, "Input"],
Cell[75584, 2869, 694, 19, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76315, 2893, 586, 20, 135, "Input"],
Cell[76904, 2915, 576, 16, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77517, 2936, 704, 24, 135, "Input"],
Cell[78224, 2962, 374, 10, 135, "Output"]
}, Open  ]],
Cell[78613, 2975, 1391, 52, 135, "Text"],
Cell[80007, 3029, 321, 13, 135, "Text"],
Cell[CellGroupData[{
Cell[80353, 3046, 315, 11, 135, "Input"],
Cell[80671, 3059, 73, 2, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[80793, 3067, 1661, 62, 135, "Text"],
Cell[CellGroupData[{
Cell[82479, 3133, 862, 28, 135, "Input"],
Cell[83344, 3163, 3608, 111, 135, "Output"]
}, Open  ]],
Cell[86967, 3277, 234, 6, 135, "Text"],
Cell[87204, 3285, 587, 20, 135, "Input"],
Cell[87794, 3307, 118, 3, 135, "Input"],
Cell[CellGroupData[{
Cell[87937, 3314, 33, 0, 135, "Input"],
Cell[87973, 3316, 3281, 102, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91291, 3423, 209, 6, 135, "Input"],
Cell[91503, 3431, 2783, 91, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94323, 3527, 55, 1, 135, "Input"],
Cell[94381, 3530, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94446, 3535, 64, 1, 135, "Input"],
Cell[94513, 3538, 28, 0, 135, "Output"]
}, Open  ]],
Cell[94556, 3541, 420, 19, 135, "Text"],
Cell[CellGroupData[{
Cell[95001, 3564, 174, 5, 135, "Input"],
Cell[95178, 3571, 806, 28, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96021, 3604, 55, 1, 135, "Input"],
Cell[96079, 3607, 256, 8, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96372, 3620, 191, 5, 135, "Input"],
Cell[96566, 3627, 184, 5, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96787, 3637, 55, 1, 135, "Input"],
Cell[96845, 3640, 240, 7, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97122, 3652, 133, 3, 135, "Input"],
Cell[97258, 3657, 5945, 181, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103240, 3843, 57, 1, 135, "Input"],
Cell[103300, 3846, 31, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103368, 3851, 56, 1, 135, "Input"],
Cell[103427, 3854, 1199, 39, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104663, 3898, 102, 2, 135, "Input"],
Cell[104768, 3902, 1176, 39, 135, "Output"]
}, Open  ]],
Cell[105959, 3944, 56, 1, 135, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[106052, 3950, 796, 29, 135, "Text"],
Cell[CellGroupData[{
Cell[106873, 3983, 81, 2, 135, "Input"],
Cell[106957, 3987, 994, 31, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107988, 4023, 83, 2, 135, "Input"],
Cell[108074, 4027, 1280, 39, 135, "Output"]
}, Open  ]],
Cell[109369, 4069, 333, 12, 135, "Text"],
Cell[CellGroupData[{
Cell[109727, 4085, 211, 5, 135, "Input"],
Cell[109941, 4092, 1363, 43, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111341, 4140, 83, 2, 135, "Input"],
Cell[111427, 4144, 2330, 70, 135, "Output"]
}, Open  ]],
Cell[113772, 4217, 172, 8, 135, "Text"],
Cell[CellGroupData[{
Cell[113969, 4229, 211, 5, 135, "Input"],
Cell[114183, 4236, 145, 2, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114365, 4243, 938, 35, 135, "Text"],
Cell[CellGroupData[{
Cell[115328, 4282, 226, 6, 135, "Input"],
Cell[115557, 4290, 35, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115629, 4295, 366, 11, 135, "Input"],
Cell[115998, 4308, 884, 28, 135, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[116943, 4343, 917, 31, 135, "Text"],
Cell[CellGroupData[{
Cell[117885, 4378, 81, 2, 135, "Input"],
Cell[117969, 4382, 791, 26, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118797, 4413, 132, 4, 135, "Input"],
Cell[118932, 4419, 170, 5, 135, "Output"]
}, Open  ]],
Cell[119117, 4427, 117, 3, 135, "Input"],
Cell[119237, 4432, 107, 5, 135, "Text"],
Cell[CellGroupData[{
Cell[119369, 4441, 91, 2, 135, "Input"],
Cell[119463, 4445, 1220, 41, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120720, 4491, 91, 2, 135, "Input"],
Cell[120814, 4495, 1220, 41, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122071, 4541, 177, 4, 135, "Input"],
Cell[122251, 4547, 903, 31, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123191, 4583, 119, 3, 135, "Input"],
Cell[123313, 4588, 414, 13, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123764, 4606, 169, 4, 135, "Input"],
Cell[123936, 4612, 1920, 64, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125893, 4681, 117, 3, 135, "Input"],
Cell[126013, 4686, 269, 8, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126319, 4699, 119, 3, 135, "Input"],
Cell[126441, 4704, 1580, 50, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128058, 4759, 124, 3, 135, "Input"],
Cell[128185, 4764, 1290, 39, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[129524, 4809, 814, 26, 135, "Subsubsection"],
Cell[CellGroupData[{
Cell[130363, 4839, 208, 6, 135, "Input"],
Cell[130574, 4847, 826, 28, 135, "Output"]
}, Open  ]],
Cell[131415, 4878, 538, 20, 135, "Text"],
Cell[131956, 4900, 475, 14, 135, "Input"],
Cell[132434, 4916, 155, 8, 135, "Text"],
Cell[CellGroupData[{
Cell[132614, 4928, 208, 6, 135, "Input"],
Cell[132825, 4936, 238, 7, 135, "Output"]
}, Open  ]],
Cell[133078, 4946, 189, 6, 135, "Text"],
Cell[CellGroupData[{
Cell[133292, 4956, 1154, 37, 135, "Input"],
Cell[134449, 4995, 165, 5, 135, "Output"]
}, Open  ]],
Cell[134629, 5003, 553, 23, 135, "Text"]
}, Closed]]
}, Closed]],
Cell[135209, 5030, 25, 3, 59, "Text"],
Cell[CellGroupData[{
Cell[135259, 5037, 221, 7, 53, "Text"],
Cell[135483, 5046, 574, 21, 115, "Text"],
Cell[CellGroupData[{
Cell[136082, 5071, 127, 3, 43, "Subsection"],
Cell[136212, 5076, 766, 21, 196, "Text"],
Cell[136981, 5099, 318, 9, 38, "Input"],
Cell[CellGroupData[{
Cell[137324, 5112, 217, 7, 43, "Subsubsection"],
Cell[137544, 5121, 922, 33, 41, "Input"],
Cell[138469, 5156, 894, 28, 72, "Input"],
Cell[139366, 5186, 1011, 34, 59, "Input"],
Cell[CellGroupData[{
Cell[140402, 5224, 281, 8, 59, "Input"],
Cell[140686, 5234, 280, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141003, 5248, 367, 11, 59, "Input"],
Cell[141373, 5261, 1087, 37, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142497, 5303, 493, 15, 59, "Input"],
Cell[142993, 5320, 1191, 46, 103, "Output"]
}, Open  ]],
Cell[144199, 5369, 129, 3, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144365, 5377, 242, 6, 37, "Input"],
Cell[144610, 5385, 282, 8, 55, "Output"]
}, Open  ]],
Cell[144907, 5396, 750, 26, 38, "Input"],
Cell[145660, 5424, 93, 5, 36, "Text"],
Cell[CellGroupData[{
Cell[145778, 5433, 252, 7, 37, "Input"],
Cell[146033, 5442, 365, 11, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146435, 5458, 206, 6, 38, "Input"],
Cell[146644, 5466, 154, 4, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146835, 5475, 82, 2, 37, "Input"],
Cell[146920, 5479, 147, 5, 58, "Output"]
}, Open  ]],
Cell[147082, 5487, 110, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[147217, 5496, 176, 5, 37, "Input"],
Cell[147396, 5503, 1365, 51, 179, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148798, 5559, 320, 9, 37, "Input"],
Cell[149121, 5570, 917, 30, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150075, 5605, 177, 5, 37, "Input"],
Cell[150255, 5612, 3397, 122, 260, "Output"]
}, Open  ]],
Cell[153667, 5737, 217, 7, 38, "Input"],
Cell[153887, 5746, 253, 8, 38, "Input"],
Cell[CellGroupData[{
Cell[154165, 5758, 72, 1, 36, "Text"],
Cell[CellGroupData[{
Cell[154262, 5763, 285, 9, 135, "Input"],
Cell[154550, 5774, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154615, 5779, 285, 9, 135, "Input"],
Cell[154903, 5790, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154968, 5795, 283, 9, 135, "Input"],
Cell[155254, 5806, 125, 4, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155416, 5815, 282, 9, 135, "Input"],
Cell[155701, 5826, 497, 17, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156235, 5848, 283, 9, 135, "Input"],
Cell[156521, 5859, 556, 21, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157114, 5885, 283, 9, 135, "Input"],
Cell[157400, 5896, 519, 20, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157956, 5921, 282, 9, 135, "Input"],
Cell[158241, 5932, 687, 24, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158965, 5961, 287, 9, 135, "Input"],
Cell[159255, 5972, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159320, 5977, 402, 12, 135, "Input"],
Cell[159725, 5991, 996, 30, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160758, 6026, 406, 12, 135, "Input"],
Cell[161167, 6040, 290, 10, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161494, 6055, 402, 12, 135, "Input"],
Cell[161899, 6069, 676, 24, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162612, 6098, 402, 12, 135, "Input"],
Cell[163017, 6112, 789, 27, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[163855, 6145, 49, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[163929, 6149, 333, 7, 37, "Input"],
Cell[164265, 6158, 906, 34, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165208, 6197, 338, 7, 37, "Input"],
Cell[165549, 6206, 1681, 57, 143, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167267, 6268, 329, 7, 37, "Input"],
Cell[167599, 6277, 4850, 160, 290, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172498, 6443, 80, 2, 37, "Input"],
Cell[172581, 6447, 47, 0, 55, "Output"]
}, Open  ]],
Cell[172643, 6450, 48, 0, 36, "Text"],
Cell[172694, 6452, 246, 7, 37, "Input"],
Cell[172943, 6461, 220, 6, 37, "Input"],
Cell[173166, 6469, 246, 7, 37, "Input"],
Cell[173415, 6478, 286, 8, 37, "Input"],
Cell[CellGroupData[{
Cell[173726, 6490, 80, 2, 37, "Input"],
Cell[173809, 6494, 47, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173893, 6499, 72, 1, 36, "Text"],
Cell[CellGroupData[{
Cell[173990, 6504, 320, 10, 135, "Input"],
Cell[174313, 6516, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174378, 6521, 320, 10, 135, "Input"],
Cell[174701, 6533, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174766, 6538, 336, 10, 135, "Input"],
Cell[175105, 6550, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175170, 6555, 320, 10, 135, "Input"],
Cell[175493, 6567, 863, 30, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176393, 6602, 336, 10, 135, "Input"],
Cell[176732, 6614, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176797, 6619, 320, 10, 135, "Input"],
Cell[177120, 6631, 1117, 36, 135, "Output"]
}, Open  ]],
Cell[178252, 6670, 325, 10, 135, "Input"],
Cell[178580, 6682, 325, 10, 135, "Input"],
Cell[178908, 6694, 325, 10, 135, "Input"],
Cell[CellGroupData[{
Cell[179258, 6708, 285, 8, 135, "Input"],
Cell[179546, 6718, 208, 7, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179791, 6730, 117, 2, 135, "Input"],
Cell[179911, 6734, 28, 0, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[179988, 6740, 67, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[180080, 6745, 263, 7, 37, "Input"],
Cell[180346, 6754, 28, 0, 55, "Output"]
}, Open  ]],
Cell[180389, 6757, 478, 15, 38, "Input"],
Cell[CellGroupData[{
Cell[180892, 6776, 1022, 30, 80, "Input"],
Cell[181917, 6808, 1671, 45, 61, "Print"],
Cell[183591, 6855, 1468, 39, 64, "Print"],
Cell[185062, 6896, 1465, 39, 58, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186576, 6941, 80, 2, 37, "Input"],
Cell[186659, 6945, 47, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186743, 6950, 71, 1, 36, "Text"],
Cell[CellGroupData[{
Cell[186839, 6955, 248, 7, 37, "Input"],
Cell[187090, 6964, 28, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187155, 6969, 248, 7, 37, "Input"],
Cell[187406, 6978, 28, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187471, 6983, 248, 7, 37, "Input"],
Cell[187722, 6992, 28, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187787, 6997, 248, 7, 37, "Input"],
Cell[188038, 7006, 28, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188103, 7011, 248, 7, 37, "Input"],
Cell[188354, 7020, 28, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188419, 7025, 248, 7, 37, "Input"],
Cell[188670, 7034, 28, 0, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188735, 7039, 80, 2, 37, "Input"],
Cell[188818, 7043, 47, 0, 55, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188914, 7049, 64, 1, 36, "Text"],
Cell[CellGroupData[{
Cell[189003, 7054, 545, 16, 135, "Input"],
Cell[189551, 7072, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189616, 7077, 571, 17, 135, "Input"],
Cell[190190, 7096, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190255, 7101, 571, 17, 135, "Input"],
Cell[190829, 7120, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190894, 7125, 80, 2, 135, "Input"],
Cell[190977, 7129, 47, 0, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[191073, 7135, 67, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[191165, 7140, 412, 12, 135, "Input"],
Cell[191580, 7154, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191645, 7159, 335, 9, 135, "Input"],
Cell[191983, 7170, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192048, 7175, 452, 13, 135, "Input"],
Cell[192503, 7190, 124, 4, 135, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[192676, 7200, 80, 2, 37, "Input"],
Cell[192759, 7204, 33, 0, 55, "Output"]
}, Open  ]],
Cell[192807, 7207, 186, 5, 37, "Input"]
}, Open  ]],
Cell[193008, 7215, 306, 9, 89, "Text"],
Cell[CellGroupData[{
Cell[193339, 7228, 75, 1, 43, "Subsection"],
Cell[193417, 7231, 722, 25, 135, "Text"],
Cell[194142, 7258, 189, 5, 135, "Input"],
Cell[194334, 7265, 215, 7, 135, "Input"],
Cell[194552, 7274, 128, 5, 135, "Text"],
Cell[CellGroupData[{
Cell[194705, 7283, 137, 4, 135, "Input"],
Cell[194845, 7289, 1140, 37, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196022, 7331, 162, 5, 135, "Input"],
Cell[196187, 7338, 992, 34, 135, "Output"]
}, Open  ]],
Cell[197194, 7375, 66, 0, 135, "Text"],
Cell[197263, 7377, 316, 10, 135, "Input"],
Cell[CellGroupData[{
Cell[197604, 7391, 32, 0, 135, "Input"],
Cell[197639, 7393, 451, 16, 135, "Output"]
}, Open  ]],
Cell[198105, 7412, 201, 8, 135, "Text"],
Cell[198309, 7422, 399, 11, 135, "Input"],
Cell[198711, 7435, 105, 5, 135, "Text"],
Cell[CellGroupData[{
Cell[198841, 7444, 154, 4, 135, "Input"],
Cell[198998, 7450, 533, 18, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199568, 7473, 986, 34, 135, "Input"],
Cell[200557, 7509, 29, 0, 135, "Output"]
}, Open  ]],
Cell[200601, 7512, 122, 5, 135, "Text"],
Cell[200726, 7519, 255, 8, 135, "Input"],
Cell[200984, 7529, 98, 2, 135, "Text"],
Cell[CellGroupData[{
Cell[201107, 7535, 84, 2, 135, "Input"],
Cell[201194, 7539, 2643, 74, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203874, 7618, 180, 5, 135, "Input"],
Cell[204057, 7625, 4143, 111, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208237, 7741, 227, 7, 135, "Input"],
Cell[208467, 7750, 194, 6, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208698, 7761, 158, 4, 135, "Input"],
Cell[208859, 7767, 5594, 139, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214490, 7911, 192, 8, 135, "Subsubsection"],
Cell[CellGroupData[{
Cell[214707, 7923, 253, 8, 135, "Input"],
Cell[214963, 7933, 303, 10, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215303, 7948, 185, 5, 135, "Input"],
Cell[215491, 7955, 2799, 75, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218327, 8035, 462, 15, 135, "Input"],
Cell[218792, 8052, 2776, 73, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221605, 8130, 359, 11, 135, "Input"],
Cell[221967, 8143, 17421, 464, 135, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[239425, 8612, 101, 2, 135, "Input"],
Cell[239529, 8616, 10888, 269, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250454, 8890, 130, 3, 135, "Input"],
Cell[250587, 8895, 10180, 263, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260804, 9163, 346, 11, 135, "Input"],
Cell[261153, 9176, 55, 1, 135, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[261247, 9182, 16, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[261288, 9186, 84, 1, 43, "Subsection"],
Cell[261375, 9189, 187, 5, 135, "Input"],
Cell[261565, 9196, 75, 0, 135, "Text"],
Cell[261643, 9198, 203, 5, 135, "Input"],
Cell[261849, 9205, 135, 4, 135, "Input"],
Cell[261987, 9211, 78, 2, 135, "Input"],
Cell[262068, 9215, 446, 14, 135, "Input"],
Cell[262517, 9231, 512, 16, 135, "Input"],
Cell[263032, 9249, 61, 0, 135, "Text"],
Cell[CellGroupData[{
Cell[263118, 9253, 243, 8, 135, "Input"],
Cell[263364, 9263, 324, 10, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263725, 9278, 243, 8, 135, "Input"],
Cell[263971, 9288, 324, 10, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264332, 9303, 90, 2, 135, "Input"],
Cell[264425, 9307, 1227, 40, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265689, 9352, 120, 3, 135, "Input"],
Cell[265812, 9357, 368, 12, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266217, 9374, 137, 3, 135, "Input"],
Cell[266357, 9379, 28, 0, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266422, 9384, 157, 4, 135, "Input"],
Cell[266582, 9390, 516, 17, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267135, 9412, 157, 4, 135, "Input"],
Cell[267295, 9418, 2021, 63, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269353, 9486, 230, 6, 135, "Input"],
Cell[269586, 9494, 993, 31, 135, "Output"]
}, Open  ]],
Cell[270594, 9528, 226, 6, 135, "Input"]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
