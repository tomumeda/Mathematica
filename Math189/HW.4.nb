(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48395,       1384]
NotebookOptionsPosition[     47873,       1361]
NotebookOutlinePosition[     48237,       1377]
CellTagsIndexPosition[     48194,       1374]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"<<", "Local`QFTToolKit`"}], "\[IndentingNewLine]", 
 RowBox[{"Put", "[", 
  RowBox[{"SaveFile", "=", 
   RowBox[{
    RowBox[{"NBname", "[", "\"\<stub\>\"", "]"}], "<>", "\"\<.out\>\""}]}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56864327369387*^9, 3.5686433185337973`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "$n", "]"}], "\[IndentingNewLine]", 
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<\[FilledCircle](1): Local extermas for: \>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<\[Bullet] \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], " ", "y"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}]}], "\[Equal]", "3"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", "\"\<{min,max}: \>\"", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Minimize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
      RowBox[{"Maximize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "}"}], "//", "Column"}], 
   ",", "\[IndentingNewLine]", "NL", ",", "\"\<\[Bullet] \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"x", "^", "2"}]}], "+", 
       RowBox[{"5", " ", 
        RowBox[{"y", "^", "3"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "^", "2"}], "-", 
        RowBox[{"y", "^", "3"}]}], "\[Equal]", "1"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", "\"\<{min,max}: \>\"", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Minimize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
      RowBox[{"Maximize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "}"}], "//", "Column"}], 
   ",", "\[IndentingNewLine]", "NL", ",", "\"\<\[Bullet] for \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["p", "i"], 
          RowBox[{"Log", "[", 
           RowBox[{"2", ",", 
            SubscriptBox["p", "i"]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "$n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "$n"}], "}"}]}], "]"}], "\[Equal]", "1"}]}], 
     "}"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Minimize[] does not work, use EulerEquations for: \>\"", ",", 
   RowBox[{"$sn", "=", 
    RowBox[{"$n", "\[Rule]", "3"}]}], ",", "\[IndentingNewLine]", "Yield", 
   ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", 
     RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$L", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"$", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
      RowBox[{"a", "-", "b"}]}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "i"], "\[Rule]", 
      RowBox[{
       SubscriptBox["p", "i"], "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"Sequence", ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox["x", "i"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "$n"}], "}"}]}], "]"}], "/.", "$sn"}]}], "]"}],
        "]"}]}], "//", 
     RowBox[{"RuleVarPattern", "[", 
      RowBox[{"{", "i", "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", "Yield",
    ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"xEulerEquations", "[", 
       RowBox[{"$L", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "$n"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["x", "i"], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "$n"}], "}"}]}], "]"}]}], "]"}], "/.", "$s"}], "/.",
      "$sn"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"xEulerEquations", "\[Rule]", "EulerEquations"}]}]}], ";", 
    RowBox[{"Column", "[", "$", "]"}]}], ",", "\[IndentingNewLine]", "imply", 
   ",", "\"\<p's are equal.\>\"", ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[Bullet] \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"y", "^", "2"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"2", "y"}], "+", 
         RowBox[{"3", "z"}]}], "\[Equal]", "0"}], "&&", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "\[Equal]", "1"}]}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", "\"\<{min,max}: \>\"", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Minimize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
      RowBox[{"Maximize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "}"}], "//", 
    "Column"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[FilledCircle](2) Find min-max\>\"", ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<\[Bullet] \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"4", 
        RowBox[{"x", "^", "2"}]}], "+", 
       RowBox[{"10", 
        RowBox[{"y", "^", "2"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}]}], "\[LessEqual]", "4"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", "\"\<{min,max}: \>\"", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Minimize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
      RowBox[{"Maximize", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "}"}], "//", "Column"}]}],
   "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/cz4SvCr368c5z2+EQqi3fKXRILoF53ZMSB6yqGj
SSB6+bnGFBD9nNc6B0T3eLDmguhPXKcKQPQewQd1IPpa0cJWED2j070bRBdN
mz8JRNuU588C0Xofzq0D0WvZTx4F0b+cP5wE85X/XwfRDKEfnoPoLx9+vgfR
Vh67ov4B6YPX/GNBtBHDiXX/gfTd7BUbQLSV4s1dIPr06cjPIDp2c74Zw59X
juca/4Hpd9vOWoPoV2Xi9iB61SkHdxDt22LiDaL/OIUHg2iP7PZIEP3k2/44
EB3OyZIGohdM/5ADokt1xFpBdN+BX50CQNqsn7cLRAtfzewD0QUmMXNANAA5
H83P
  "]],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\[FilledCircle](1): Local extermas for: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "2"], " ", "y"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], "\[Equal]", "3"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"{min,max}: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"-", 
             SqrtBox["2"]}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"-", "1"}]}]}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"-", 
             SqrtBox["2"]}]}], ",", 
           RowBox[{"y", "\[Rule]", "1"}]}], "}"}]}], "}"}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"3", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["y", "3"]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "2"], "-", 
       SuperscriptBox["y", "3"]}], "\[Equal]", "1"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"{min,max}: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "0"}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"-", "1"}]}]}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"\[Infinity]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "Indeterminate"}], ",", 
           RowBox[{"y", "\[Rule]", "Indeterminate"}]}], "}"}]}], "}"}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] for \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
         TagBox[GridBox[{
            {
             RowBox[{"{", 
              RowBox[{"i", ",", "$n"}], "}"}]}
           },
           DefaultBaseStyle->"Column",
           GridBoxAlignment->{"Columns" -> {{Left}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Column"]], "[", 
        FractionBox[
         RowBox[{
          RowBox[{"Log", "[", 
           SubscriptBox["p", "i"], "]"}], " ", 
          SubscriptBox["p", "i"]}], 
         RowBox[{"Log", "[", "2", "]"}]], "]"}],
       $CellContext`xSum[Log[2]^(-1) Log[
          Subscript[$CellContext`p, $CellContext`i]] 
        Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}],
       Editable->False,
       SyntaxForm->Automatic]}], ",", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
         TagBox[GridBox[{
            {
             RowBox[{"{", 
              RowBox[{"i", ",", "$n"}], "}"}]}
           },
           DefaultBaseStyle->"Column",
           GridBoxAlignment->{"Columns" -> {{Left}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Column"]], "[", 
        SubscriptBox["p", "i"], "]"}],
       $CellContext`xSum[
        Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}],
       Editable->False,
       SyntaxForm->Automatic], "\[Equal]", "1"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Minimize[] does not work, use EulerEquations for: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"$n", "\[Rule]", "3"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", "i", "$n"], 
       FractionBox[
        RowBox[{
         RowBox[{"Log", "[", 
          SubscriptBox["p", "i"], "]"}], " ", 
         SubscriptBox["p", "i"]}], 
        RowBox[{"Log", "[", "2", "]"}]]}]}], ",", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", "i", "$n"], 
       SubscriptBox["p", "i"]}], "\[Equal]", "1"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", "i", "$n"], 
        SubscriptBox["p", "i"]}]}], ")"}]}], "-", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "i", "$n"], 
     FractionBox[
      RowBox[{
       RowBox[{"Log", "[", 
        SubscriptBox["p", "i"], "]"}], " ", 
       SubscriptBox["p", "i"]}], 
      RowBox[{"Log", "[", "2", "]"}]]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "i_"], "\[Rule]", 
    RowBox[{
     SubscriptBox["p", "i"], "[", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"], ",", 
      SubscriptBox["x", "3"]}], "]"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"xEulerEquations", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{
           SubscriptBox["p", "1"], "[", 
           RowBox[{
            SubscriptBox["x", "1"], ",", 
            SubscriptBox["x", "2"], ",", 
            SubscriptBox["x", "3"]}], "]"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["p", "1"], "[", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"]}], "]"}]}], 
        RowBox[{"Log", "[", "2", "]"}]]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{
          SubscriptBox["p", "2"], "[", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"]}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["p", "2"], "[", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"]}], "]"}]}], 
       RowBox[{"Log", "[", "2", "]"}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{
          SubscriptBox["p", "3"], "[", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"]}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["p", "3"], "[", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["x", "3"]}], "]"}]}], 
       RowBox[{"Log", "[", "2", "]"}]], "+", 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SubscriptBox["p", "1"], "[", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"]}], "]"}], "+", 
         RowBox[{
          SubscriptBox["p", "2"], "[", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"]}], "]"}], "+", 
         RowBox[{
          SubscriptBox["p", "3"], "[", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["x", "2"], ",", 
           SubscriptBox["x", "3"]}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "[", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"]}], "]"}], ",", 
       RowBox[{
        SubscriptBox["p", "2"], "[", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"]}], "]"}], ",", 
       RowBox[{
        SubscriptBox["p", "3"], "[", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["x", "2"], ",", 
       SubscriptBox["x", "3"]}], "}"}]}], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"Log", "[", "2", "]"}]}], "+", 
           RowBox[{"Log", "[", 
            RowBox[{
             SubscriptBox["p", "1"], "[", 
             RowBox[{
              SubscriptBox["x", "1"], ",", 
              SubscriptBox["x", "2"], ",", 
              SubscriptBox["x", "3"]}], "]"}], "]"}]}], 
          RowBox[{"Log", "[", "2", "]"}]]}], "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"Log", "[", "2", "]"}]}], "+", 
           RowBox[{"Log", "[", 
            RowBox[{
             SubscriptBox["p", "2"], "[", 
             RowBox[{
              SubscriptBox["x", "1"], ",", 
              SubscriptBox["x", "2"], ",", 
              SubscriptBox["x", "3"]}], "]"}], "]"}]}], 
          RowBox[{"Log", "[", "2", "]"}]]}], "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"Log", "[", "2", "]"}]}], "+", 
           RowBox[{"Log", "[", 
            RowBox[{
             SubscriptBox["p", "3"], "[", 
             RowBox[{
              SubscriptBox["x", "1"], ",", 
              SubscriptBox["x", "2"], ",", 
              SubscriptBox["x", "3"]}], "]"}], "]"}]}], 
          RowBox[{"Log", "[", "2", "]"}]]}], "\[Equal]", "0"}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"], "\[InvisibleSpace]", 
   StyleBox["\<\" \[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"p's are equal.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "2"], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["y", "2"]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "+", 
        RowBox[{"2", " ", "y"}], "+", 
        RowBox[{"3", " ", "z"}]}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], "\[Equal]", "1"}]}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"{min,max}: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "0"}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"z", "\[Rule]", 
            FractionBox["2", "3"]}]}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "1"}], ",", 
           RowBox[{"y", "\[Rule]", "0"}], ",", 
           RowBox[{"z", "\[Rule]", 
            RowBox[{"-", 
             FractionBox["1", "3"]}]}]}], "}"}]}], "}"}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[FilledCircle](2) Find min-max\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"10", " ", 
       SuperscriptBox["y", "2"]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], "\[LessEqual]", "4"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"{min,max}: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "0"}], ",", 
           RowBox[{"y", "\[Rule]", "0"}]}], "}"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"40", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "0"}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"-", "2"}]}]}], "}"}]}], "}"}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"]}],
  SequenceForm[
   Style["\[FilledCircle](1): Local extermas for: ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["\[Bullet] ", 
    RGBColor[0, 0, 1], 
    Larger], {$CellContext`x^2 $CellContext`y, $CellContext`x^2 + \
$CellContext`y^2 == 3}, 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["{min,max}: ", 
    RGBColor[0, 0, 1], Larger], 
   Column[{{-2, {$CellContext`x -> -2^
         Rational[1, 2], $CellContext`y -> -1}}, {
     2, {$CellContext`x -> -2^Rational[1, 2], $CellContext`y -> 1}}}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["\[Bullet] ", 
    RGBColor[0, 0, 1], Larger], {
   3 $CellContext`x^2 + 
    5 $CellContext`y^3, $CellContext`x^2 - $CellContext`y^3 == 1}, 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["{min,max}: ", 
    RGBColor[0, 0, 1], Larger], 
   Column[{{-5, {$CellContext`x -> 0, $CellContext`y -> -1}}, {
      DirectedInfinity[
      1], {$CellContext`x -> Indeterminate, $CellContext`y -> 
       Indeterminate}}}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["\[Bullet] for ", 
    RGBColor[0, 0, 1], Larger], {-$CellContext`xSum[Log[2]^(-1) Log[
        Subscript[$CellContext`p, $CellContext`i]] 
      Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}], $CellContext`xSum[
      Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}] == 1}, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Minimize[] does not work, use EulerEquations for: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`$n -> 3, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], {-Sum[Log[2]^(-1) Log[
        Subscript[$CellContext`p, $CellContext`i]] 
      Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}], Sum[
      Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}] == 1}, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[Lambda] (-1 + Sum[
       Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}]) - Sum[Log[2]^(-1) Log[
      Subscript[$CellContext`p, $CellContext`i]] 
    Subscript[$CellContext`p, $CellContext`i], {$CellContext`i, \
$CellContext`$n}], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], Subscript[$CellContext`p, 
     Pattern[$CellContext`i, 
      Blank[]]] -> Subscript[$CellContext`p, $CellContext`i][
     Subscript[$CellContext`x, 1], 
     Subscript[$CellContext`x, 2], 
     Subscript[$CellContext`x, 3]], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   $CellContext`xEulerEquations[-Log[2]^(-1) Log[
       Subscript[$CellContext`p, 1][
        Subscript[$CellContext`x, 1], 
        Subscript[$CellContext`x, 2], 
        Subscript[$CellContext`x, 3]]] Subscript[$CellContext`p, 1][
       Subscript[$CellContext`x, 1], 
       Subscript[$CellContext`x, 2], 
       Subscript[$CellContext`x, 3]] - Log[2]^(-1) Log[
      Subscript[$CellContext`p, 2][
       Subscript[$CellContext`x, 1], 
       Subscript[$CellContext`x, 2], 
       Subscript[$CellContext`x, 3]]] Subscript[$CellContext`p, 2][
      Subscript[$CellContext`x, 1], 
      Subscript[$CellContext`x, 2], 
      Subscript[$CellContext`x, 3]] - Log[2]^(-1) Log[
      Subscript[$CellContext`p, 3][
       Subscript[$CellContext`x, 1], 
       Subscript[$CellContext`x, 2], 
       Subscript[$CellContext`x, 3]]] Subscript[$CellContext`p, 3][
      Subscript[$CellContext`x, 1], 
      Subscript[$CellContext`x, 2], 
      Subscript[$CellContext`x, 3]] + $CellContext`\[Lambda] (-1 + 
      Subscript[$CellContext`p, 1][
        Subscript[$CellContext`x, 1], 
        Subscript[$CellContext`x, 2], 
        Subscript[$CellContext`x, 3]] + Subscript[$CellContext`p, 2][
        Subscript[$CellContext`x, 1], 
        Subscript[$CellContext`x, 2], 
        Subscript[$CellContext`x, 3]] + Subscript[$CellContext`p, 3][
        Subscript[$CellContext`x, 1], 
        Subscript[$CellContext`x, 2], 
        Subscript[$CellContext`x, 3]]), {
     Subscript[$CellContext`p, 1][
      Subscript[$CellContext`x, 1], 
      Subscript[$CellContext`x, 2], 
      Subscript[$CellContext`x, 3]], 
     Subscript[$CellContext`p, 2][
      Subscript[$CellContext`x, 1], 
      Subscript[$CellContext`x, 2], 
      Subscript[$CellContext`x, 3]], 
     Subscript[$CellContext`p, 3][
      Subscript[$CellContext`x, 1], 
      Subscript[$CellContext`x, 2], 
      Subscript[$CellContext`x, 3]]}, {
     Subscript[$CellContext`x, 1], 
     Subscript[$CellContext`x, 2], 
     Subscript[$CellContext`x, 3]}], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Column[{-Log[2]^(-1) (1 - $CellContext`\[Lambda] Log[2] + Log[
         Subscript[$CellContext`p, 1][
          Subscript[$CellContext`x, 1], 
          Subscript[$CellContext`x, 2], 
          Subscript[$CellContext`x, 3]]]) == 
     0, -Log[2]^(-1) (1 - $CellContext`\[Lambda] Log[2] + Log[
         Subscript[$CellContext`p, 2][
          Subscript[$CellContext`x, 1], 
          Subscript[$CellContext`x, 2], 
          Subscript[$CellContext`x, 3]]]) == 
     0, -Log[2]^(-1) (1 - $CellContext`\[Lambda] Log[2] + Log[
         Subscript[$CellContext`p, 3][
          Subscript[$CellContext`x, 1], 
          Subscript[$CellContext`x, 2], 
          Subscript[$CellContext`x, 3]]]) == 0}], 
   Style[" \[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["p's are equal.", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["\[Bullet] ", 
    RGBColor[0, 0, 1], Larger], {$CellContext`x^2 - 3 $CellContext`y^2, 
    And[$CellContext`x + 2 $CellContext`y + 3 $CellContext`z == 
     0, $CellContext`x^2 + $CellContext`y^2 == 1]}, 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["{min,max}: ", 
    RGBColor[0, 0, 1], Larger], 
   Column[{{-3, {$CellContext`x -> 0, $CellContext`y -> -1, $CellContext`z -> 
       Rational[2, 3]}}, {
     1, {$CellContext`x -> 1, $CellContext`y -> 0, $CellContext`z -> 
       Rational[-1, 3]}}}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["\[FilledCircle](2) Find min-max", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["\[Bullet] ", 
    RGBColor[0, 0, 1], Larger], {
   4 $CellContext`x^2 + 
    10 $CellContext`y^2, $CellContext`x^2 + $CellContext`y^2 <= 4}, 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Style["{min,max}: ", 
    RGBColor[0, 0, 1], Larger], 
   Column[{{0, {$CellContext`x -> 0, $CellContext`y -> 0}}, {
     40, {$CellContext`x -> 0, $CellContext`y -> -2}}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.621782396179153*^9, 3.621782428136907*^9, {3.621782550796344*^9, 
   3.62178256999039*^9}, 3.6218153792988243`*^9, 3.621815442686899*^9, 
   3.621815527058507*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<\[FilledCircle](4) \>\"", ",", 
   RowBox[{"$L", "=", 
    RowBox[{
     RowBox[{"L", "\[Rule]", 
      RowBox[{"xSum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"i", ",", "t"}], "]"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}], "]"}]}], "/.", 
     RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ",", "\[IndentingNewLine]", "NL",
    ",", "\"\<Constrained Lagrangian: \>\"", ",", 
   RowBox[{"$L1", "=", 
    RowBox[{
     RowBox[{"Lc", "->", 
      RowBox[{"L", " ", "+", " ", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"xSum", "[", 
           RowBox[{
            RowBox[{"i", "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}], "]"}]}], 
         ")"}]}]}]}], "/.", 
     RowBox[{"xSum", "\[Rule]", "Sum"}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$L1", "=", 
    RowBox[{
     RowBox[{"$L1", "/.", "$L"}], "/.", 
     RowBox[{
      RowBox[{"xx", ":", 
       RowBox[{"(", 
        RowBox[{"x", "|", "y", "|", "z"}], ")"}]}], "\[Rule]", 
      RowBox[{"xx", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"xEulerEquations", "[", 
       RowBox[{"Lc", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", "t", "]"}], ",", 
              RowBox[{"y", "[", "t", "]"}], ",", 
              RowBox[{"z", "[", "t", "]"}]}], "}"}]}], "}"}]}], "]"}], ",", 
        "t"}], "]"}], "/.", "$L1"}], "/.", 
     RowBox[{"xPartialD", "\[Rule]", "D"}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"xEulerEquations", "\[Rule]", "EulerEquations"}]}]}], ";", 
    RowBox[{"Column", "[", "$", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.621824865945984*^9, 3.62182510483331*^9}, {
  3.621825194100297*^9, 3.621825213837471*^9}, {3.621825394860692*^9, 
  3.6218254961302013`*^9}, {3.6218255706349583`*^9, 3.62182559664036*^9}, {
  3.621825638298427*^9, 3.6218257196196136`*^9}, {3.621825751765871*^9, 
  3.621825788611356*^9}, {3.621825835263423*^9, 3.621825848964179*^9}, {
  3.621825882805875*^9, 3.6218259080675488`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\[FilledCircle](4) \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"L", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "x", "]"}],
       $CellContext`xPartialD[$CellContext`x, $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"], "+", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "y", "]"}],
       $CellContext`xPartialD[$CellContext`y, $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"], "+", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
       $CellContext`xPartialD[$CellContext`z, $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Constrained Lagrangian: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Lc", "\[Rule]", 
    RowBox[{"L", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["y", "2"], "-", 
        SuperscriptBox["z", "2"]}], ")"}], " ", "\[Lambda]"}]}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Lc", "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        RowBox[{"x", "[", "t", "]"}], "]"}],
       $CellContext`xPartialD[
        $CellContext`x[$CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"], "+", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        RowBox[{"y", "[", "t", "]"}], "]"}],
       $CellContext`xPartialD[
        $CellContext`y[$CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"], "+", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        RowBox[{"z", "[", "t", "]"}], "]"}],
       $CellContext`xPartialD[
        $CellContext`z[$CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"], "+", 
     RowBox[{"\[Lambda]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"x", "[", "t", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"y", "[", "t", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}]}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"xEulerEquations", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"x", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"y", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["z", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"z", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"x", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["x", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "\[Equal]",
         "0"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"y", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["y", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "\[Equal]",
         "0"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"z", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["z", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "\[Equal]",
         "0"}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"]}],
  SequenceForm[
   Style["\[FilledCircle](4) ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`L -> $CellContext`xPartialD[$CellContext`x, \
$CellContext`t]^2 + $CellContext`xPartialD[$CellContext`y, $CellContext`t]^2 + \
$CellContext`xPartialD[$CellContext`z, $CellContext`t]^2, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Constrained Lagrangian: ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`Lc -> $CellContext`L + (
      1 - $CellContext`x^2 - $CellContext`y^2 - $CellContext`z^2) \
$CellContext`\[Lambda], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], $CellContext`Lc -> $CellContext`xPartialD[
       $CellContext`x[$CellContext`t], $CellContext`t]^2 + \
$CellContext`xPartialD[
       $CellContext`y[$CellContext`t], $CellContext`t]^2 + \
$CellContext`xPartialD[
       $CellContext`z[$CellContext`t], $CellContext`t]^2 + $CellContext`\
\[Lambda] (
      1 - $CellContext`x[$CellContext`t]^2 - $CellContext`y[$CellContext`t]^2 - \
$CellContext`z[$CellContext`t]^2), 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   $CellContext`xEulerEquations[$CellContext`\[Lambda] (
      1 - $CellContext`x[$CellContext`t]^2 - $CellContext`y[$CellContext`t]^2 - \
$CellContext`z[$CellContext`t]^2) + 
    Derivative[1][$CellContext`x][$CellContext`t]^2 + 
    Derivative[1][$CellContext`y][$CellContext`t]^2 + 
    Derivative[1][$CellContext`z][$CellContext`t]^2, {
     $CellContext`x[$CellContext`t], 
     $CellContext`y[$CellContext`t], 
     $CellContext`z[$CellContext`t]}, $CellContext`t], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   Column[{(-2) ($CellContext`\[Lambda] $CellContext`x[$CellContext`t] + 
       Derivative[2][$CellContext`x][$CellContext`t]) == 
     0, (-2) ($CellContext`\[Lambda] $CellContext`y[$CellContext`t] + 
       Derivative[2][$CellContext`y][$CellContext`t]) == 
     0, (-2) ($CellContext`\[Lambda] $CellContext`z[$CellContext`t] + 
       Derivative[2][$CellContext`z][$CellContext`t]) == 0}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.621825173974284*^9, 3.621825214705325*^9}, {
   3.621825406666844*^9, 3.621825436472931*^9}, 3.621825597422769*^9, {
   3.6218256416880713`*^9, 3.621825654606427*^9}, 3.621825720920323*^9, 
   3.621825794444406*^9, {3.621825839181697*^9, 3.62182585049279*^9}, {
   3.621825885894885*^9, 3.6218259092141523`*^9}}]
}, Open  ]]
},
WindowSize->{808, 656},
WindowMargins->{{60, Automatic}, {1, Automatic}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 329, 8, 58, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[912, 32, 6894, 199, 378, "Input"],
Cell[7809, 233, 28170, 800, 597, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36016, 1038, 2664, 71, 123, "Input"],
Cell[38683, 1111, 9174, 247, 160, "Print"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
