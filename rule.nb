(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     26373,        616]
NotebookOptionsPosition[     25447,        582]
NotebookOutlinePosition[     25819,        598]
CellTagsIndexPosition[     25776,        595]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"C", "[", "Rule", "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleSolve", "[", 
      RowBox[{"rules_", ",", "vars_"}], "]"}], " ", "Solves", " ", "for", " ",
      "rules_", " ", "for", " ", "vars_.", "  ", "Its", " ", "operation", " ",
      "depends", " ", "upon", " ", "the", " ", 
     RowBox[{"Head", "[", "]"}], " ", "of", " ", "rules_", " ", "and", " ", 
     "vars_.", " ", "rules_", " ", "and", " ", "vars_", " ", "may", " ", "be",
      " ", "a", " ", "List", " ", "of", " ", "Rules", " ", 
     RowBox[{"and", "/", "or"}], " ", "vars_.", "  ", "vars_", " ", "may", 
     " ", "contain", " ", "Patterns"}], ",", " ", 
    RowBox[{"however", " ", "Patterns", " ", "are", " ", 
     RowBox[{"removesd", "."}], " ", "*", "17", "Jun2013"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RuleSolve", "[", 
      RowBox[{"rules_", ",", "vars_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"Flatten", "[", "rules", "]"}]}], ",", "XXXXX", ",", 
         "list"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"First", "[", 
           RowBox[{
            RowBox[{"ExtractPatternXpat", "[", "vars", "]"}], "[", "rules", 
            "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Rule", "->", "Equal"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "rules", "]"}], "==", "Rule"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", "vars", "]"}], "=!=", "List"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Single", " ", 
            RowBox[{"Rule", "[", "]"}], " ", "and", " ", "single", " ", 
            "vars_.", " ", "Returns", " ", "all", " ", "solutions", " ", 
            "from", " ", 
            RowBox[{
             RowBox[{"Solve", "[", "]"}], ".", " ", "Replaces"}], " ", 
            "RuleX"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", 
             RowBox[{"vars", "\[Rule]", "XXXXX"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"tmp", ",", "XXXXX"}], "]"}], ",", 
             RowBox[{"tmp", "=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"(*", 
              RowBox[{"No", " ", "vars_"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmp", "=", 
               RowBox[{"Solve", "[", 
                RowBox[{"tmp", ",", "XXXXX"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "1"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"tmp", "=", 
                 RowBox[{"tmp", "//.", 
                  RowBox[{"XXXXX", "\[Rule]", 
                   RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"tmp", "=", 
               RowBox[{"tmp", "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"tmp", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MapAt", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "/.", 
                    RowBox[{"Pattern", "->", "xPattern"}]}], "/.", 
                    RowBox[{
                    RowBox[{"xPattern", "[", 
                    RowBox[{"x_", ",", "b_"}], "]"}], "->", "x"}]}], "&"}], 
                    ",", "#", ",", "2"}], "]"}], "&"}], ",", "tmp"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"tmp", "=", 
               RowBox[{"tmp", "/.", 
                RowBox[{
                 RowBox[{"Xpat", "[", "a_", "]"}], "->", "a"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmp", "=", 
               RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//", "Flatten"}]}]}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"(*", 
           RowBox[{
           "else", " ", "List", " ", "of", " ", "Rules", " ", "and", " ", 
            "List", " ", "of", " ", "vars_"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "rules", "]"}], "===", "List"}], 
              "\[IndentingNewLine]", "&&", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "&"}], ",", "rules"}], 
                 "]"}], "]"}], "===", 
               RowBox[{"{", "Rule", "}"}]}], "\[IndentingNewLine]", "&&", 
              RowBox[{
               RowBox[{"Head", "[", "vars", "]"}], "===", "List"}], 
              "\[IndentingNewLine]", "&&", 
              RowBox[{
               RowBox[{"Length", "[", "vars", "]"}], "===", 
               RowBox[{"Length", "[", "rules", "]"}]}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"tmp", ",", "vars"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tmp", "=", 
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{"tmp", ",", "vars"}], "]"}], "//", "Flatten"}]}]}]}],
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rule", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "b", "]"}], "->", 
         RowBox[{
          RowBox[{"c", "[", "b", "]"}], "+", "d"}]}], ",", 
        RowBox[{
         RowBox[{"c", "[", "b", "]"}], "->", 
         RowBox[{"f", "[", "b", "]"}]}]}], "}"}]}], ",", 
     RowBox[{"var", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "b", "]"}], ",", "d"}], "}"}]}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"RuleSolve", "[", 
    RowBox[{"rule", ",", "var"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"RuleX", "[", 
    RowBox[{"rule", ",", "var"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527879933930221*^9, 3.527880068966152*^9}, 
   3.555432637545333*^9, 3.5554327862608147`*^9, {3.555778199064436*^9, 
   3.555778200178644*^9}, {3.5557782330147963`*^9, 3.5557782677040253`*^9}, {
   3.56440458999321*^9, 3.564404592220203*^9}, 3.5644052361899147`*^9, {
   3.564405290952738*^9, 3.564405301267617*^9}, {3.564405368812229*^9, 
   3.5644054364898977`*^9}, {3.5644056110684757`*^9, 3.564405738816188*^9}, {
   3.5644063471465263`*^9, 3.564406375009626*^9}, 3.564413775437436*^9, {
   3.564841215338243*^9, 3.564841267301989*^9}, {3.5648412981148167`*^9, 
   3.564841302408098*^9}, {3.564841438400856*^9, 3.564841454162277*^9}, {
   3.5648426536876574`*^9, 3.56484266204705*^9}, 3.564844474848049*^9, {
   3.566825760129705*^9, 3.566825774453374*^9}, {3.5701054282640123`*^9, 
   3.570105511224777*^9}, {3.570202732481195*^9, 3.570202743935644*^9}, {
   3.5702029982641487`*^9, 3.5702030026177*^9}, {3.570204924170664*^9, 
   3.5702049338485527`*^9}, {3.5708421697737226`*^9, 3.570842185370248*^9}, {
   3.5708422324014683`*^9, 3.5708422443157473`*^9}, {3.570842287793892*^9, 
   3.570842350294593*^9}, {3.5708423959710903`*^9, 3.5708424294855747`*^9}, {
   3.570842479854141*^9, 3.570842487957382*^9}, {3.570842537170766*^9, 
   3.570842558091651*^9}, {3.5708425881073627`*^9, 3.5708426875465117`*^9}, {
   3.570842743911915*^9, 3.570842760098878*^9}, {3.5708428150620337`*^9, 
   3.57084283337428*^9}, {3.571232025341181*^9, 3.5712320602579823`*^9}, {
   3.571232217102319*^9, 3.571232287814302*^9}, {3.571423438946911*^9, 
   3.571423447071764*^9}, {3.571423784852826*^9, 3.57142390202459*^9}, {
   3.580211541277926*^9, 3.580211548090016*^9}, {3.5802116650011272`*^9, 
   3.580211670178278*^9}, {3.580211715859536*^9, 3.580211717215892*^9}, {
   3.5802117834097967`*^9, 3.580211806362259*^9}, {3.58023014966059*^9, 
   3.580230242722711*^9}, {3.580230279767311*^9, 3.5802302906262407`*^9}, {
   3.58048684698802*^9, 3.580487087730921*^9}, {3.58048862093692*^9, 
   3.580488738044199*^9}, {3.5804887737813*^9, 3.580488796271171*^9}, {
   3.5804889777191563`*^9, 3.580489045177387*^9}, {3.580489090734181*^9, 
   3.5804891942087603`*^9}, {3.580489228526277*^9, 3.580489285807743*^9}, {
   3.5804893177748213`*^9, 3.5804893333336*^9}, {3.580489364755959*^9, 
   3.580489385313993*^9}, {3.580489424046578*^9, 3.580489436499525*^9}, {
   3.580568090871161*^9, 3.5805681321781073`*^9}, {3.5805683148700113`*^9, 
   3.58056834201534*^9}, {3.5805683738420277`*^9, 3.580568400903637*^9}, {
   3.580568437123447*^9, 3.5805684752109118`*^9}, {3.580568520086956*^9, 
   3.580568548477025*^9}, {3.580568586233781*^9, 3.580568606983858*^9}, {
   3.5808629642556543`*^9, 3.580862977362153*^9}, {3.580863341965452*^9, 
   3.58086336304237*^9}, {3.5808633994745817`*^9, 3.5808634008670387`*^9}, {
   3.580863459308456*^9, 3.580863513512219*^9}, {3.580863575037491*^9, 
   3.5808635822341423`*^9}, {3.580863671484941*^9, 3.580863695545062*^9}, {
   3.580863750271426*^9, 3.580863822520761*^9}, {3.5808638929034653`*^9, 
   3.580863896452306*^9}, {3.580863926500268*^9, 3.5808639546799803`*^9}, {
   3.5808639966297894`*^9, 3.580864041173332*^9}, {3.580864082641519*^9, 
   3.5808641157795897`*^9}, 3.580864170291121*^9, 3.5808642388869543`*^9, {
   3.580864302666195*^9, 3.580864326416485*^9}, {3.580864372197308*^9, 
   3.5808644193908854`*^9}, {3.580864453280036*^9, 3.580864528882039*^9}, {
   3.58086456676476*^9, 3.580864589665*^9}, {3.580864626087126*^9, 
   3.580864665397657*^9}, {3.58086470668493*^9, 3.5808647578008003`*^9}, {
   3.580864806231516*^9, 3.580864811477377*^9}, {3.580865055573585*^9, 
   3.580865168533865*^9}, {3.580865200366478*^9, 3.580865257382554*^9}, {
   3.5808652893348637`*^9, 3.580865299190661*^9}, {3.580865333236642*^9, 
   3.580865349604258*^9}, {3.5808653896163692`*^9, 3.5808654125656557`*^9}, {
   3.580865457866885*^9, 3.5808657289867897`*^9}, {3.5811791814451723`*^9, 
   3.581179215649969*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "b", "]"}], "\[Rule]", 
      RowBox[{"d", "+", 
       RowBox[{"c", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"c", "[", "b", "]"}], "\[Rule]", 
      RowBox[{"f", "[", "b", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "b", "]"}], ",", "d"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5808636973919487`*^9, 3.580863751961689*^9, 3.580863824124208*^9, 
   3.580863897796193*^9, {3.5808639301507177`*^9, 3.580863955636343*^9}, {
   3.58086402455553*^9, 3.580864041693439*^9}, {3.580864090181798*^9, 
   3.580864117038522*^9}, 3.580864172033497*^9, {3.58086430485682*^9, 
   3.5808643279052553`*^9}, 3.580864405003092*^9, {3.580864474351555*^9, 
   3.580864531401308*^9}, {3.58086457975182*^9, 3.5808646084270697`*^9}, 
   3.580864669559857*^9, 3.5808653131802883`*^9, 3.580865356483943*^9, 
   3.580865544179126*^9, {3.580865577345495*^9, 3.580865655070652*^9}, {
   3.580865699015298*^9, 3.580865730092148*^9}, {3.5830694062592783`*^9, 
   3.583069406761492*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "b", "]"}], "\[Equal]", 
      RowBox[{"d", "+", 
       RowBox[{"c", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"c", "[", "b", "]"}], "\[Equal]", 
      RowBox[{"f", "[", "b", "]"}]}]}], "}"}], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "b", "]"}], ",", "d"}], "}"}]}],
  SequenceForm[{$CellContext`a[$CellContext`b] == $CellContext`d + \
$CellContext`c[$CellContext`b], $CellContext`c[$CellContext`b] == \
$CellContext`f[$CellContext`b]}, {
    $CellContext`f[$CellContext`b], $CellContext`d}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.580865602523242*^9, 3.580865655073316*^9}, {
  3.580865699017194*^9, 3.5808657300940943`*^9}, {3.5830694062607517`*^9, 
  3.583069406763266*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "b", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "b", "]"}]}], ",", 
   RowBox[{"d", "\[Rule]", 
    RowBox[{
     RowBox[{"a", "[", "b", "]"}], "-", 
     RowBox[{"c", "[", "b", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5808636973919487`*^9, 3.580863751961689*^9, 3.580863824124208*^9, 
   3.580863897796193*^9, {3.5808639301507177`*^9, 3.580863955636343*^9}, {
   3.58086402455553*^9, 3.580864041693439*^9}, {3.580864090181798*^9, 
   3.580864117038522*^9}, 3.580864172033497*^9, {3.58086430485682*^9, 
   3.5808643279052553`*^9}, 3.580864405003092*^9, {3.580864474351555*^9, 
   3.580864531401308*^9}, {3.58086457975182*^9, 3.5808646084270697`*^9}, 
   3.580864669559857*^9, 3.5808653131802883`*^9, 3.580865356483943*^9, 
   3.580865544179126*^9, {3.580865577345495*^9, 3.580865655070652*^9}, {
   3.580865699015298*^9, 3.580865730092148*^9}, {3.5830694062592783`*^9, 
   3.583069406764359*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "b", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "b", "]"}]}], ",", 
   RowBox[{"d", "\[Rule]", 
    RowBox[{
     RowBox[{"a", "[", "b", "]"}], "-", 
     RowBox[{"c", "[", "b", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5808636973919487`*^9, 3.580863751961689*^9, 3.580863824124208*^9, 
   3.580863897796193*^9, {3.5808639301507177`*^9, 3.580863955636343*^9}, {
   3.58086402455553*^9, 3.580864041693439*^9}, {3.580864090181798*^9, 
   3.580864117038522*^9}, 3.580864172033497*^9, {3.58086430485682*^9, 
   3.5808643279052553`*^9}, 3.580864405003092*^9, {3.580864474351555*^9, 
   3.580864531401308*^9}, {3.58086457975182*^9, 3.5808646084270697`*^9}, 
   3.580864669559857*^9, 3.5808653131802883`*^9, 3.580865356483943*^9, 
   3.580865544179126*^9, {3.580865577345495*^9, 3.580865655070652*^9}, {
   3.580865699015298*^9, 3.580865730092148*^9}, {3.5830694062592783`*^9, 
   3.583069406765449*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmp", "=", 
  RowBox[{"{", 
   RowBox[{"a_", ",", 
    RowBox[{"f", "[", "b_", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp1", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"XXXX", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Thread", "[", 
  RowBox[{"Rule", "[", 
   RowBox[{"tmp", ",", "tmp1"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Reverse", "/@", "%"}]}], "Input",
 CellChangeTimes->{{3.580862999655033*^9, 3.5808630336195297`*^9}, {
   3.5808633702995157`*^9, 3.580863384002351*^9}, {3.580864823566227*^9, 
   3.580864885379291*^9}, {3.580864997892282*^9, 3.580865040486726*^9}, {
   3.583070112041675*^9, 3.583070160876463*^9}, {3.583070231004529*^9, 
   3.583070246160466*^9}, {3.5830704505949993`*^9, 3.583070500120758*^9}, {
   3.583070572228895*^9, 3.583070587095537*^9}, 3.583070619744152*^9, {
   3.5830706550112467`*^9, 3.583070872562665*^9}, 3.583071130919158*^9, {
   3.583071193257032*^9, 3.58307123626237*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a_", ",", 
   RowBox[{"f", "[", "b_", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5830708548212013`*^9, 3.583070873483345*^9}, 
   3.583071132290361*^9, {3.583071204148093*^9, 3.583071236977934*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"XXXX", "[", "1", "]"}], ",", 
   RowBox[{"XXXX", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5830708548212013`*^9, 3.583070873483345*^9}, 
   3.583071132290361*^9, {3.583071204148093*^9, 3.583071236979396*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a_", "\[Rule]", 
    RowBox[{"XXXX", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"f", "[", "b_", "]"}], "\[Rule]", 
    RowBox[{"XXXX", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5830708548212013`*^9, 3.583070873483345*^9}, 
   3.583071132290361*^9, {3.583071204148093*^9, 3.58307123698059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"XXXX", "[", "1", "]"}], "\[Rule]", "a_"}], ",", 
   RowBox[{
    RowBox[{"XXXX", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"f", "[", "b_", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5830708548212013`*^9, 3.583070873483345*^9}, 
   3.583071132290361*^9, {3.583071204148093*^9, 3.583071236981709*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xRuleX", "[", 
    RowBox[{"rules_", ",", "vars_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Equal", ",", "rule"}], "]"}]}], ",", "XXXX", ",", "varlist",
        ",", "Xs", ",", "sub", ",", "subX", ",", "varPat", ",", 
       RowBox[{"xvars", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "vars", "}"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varlist", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ExtractPattern", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "rules", "}"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "vars", "}"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Xs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"XXXX", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "varlist", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{"varlist", ",", "Xs"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Substitute", " ", "vars_", " ", "for", " ", "Solve", " ", 
        "variables"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"rules", "/.", 
         RowBox[{"Rule", "->", "Equal"}]}], "//.", "sub"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "tmp", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"tmp", ",", "Xs"}], "]"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"tmp", "/.", 
         RowBox[{"Pattern", "->", "xPattern"}]}], "/.", 
        RowBox[{
         RowBox[{"xPattern", "[", 
          RowBox[{"x_", ",", "b_"}], "]"}], "->", "x"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"remove", " ", "Pattern"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "add", " ", "Pattern", " ", "to", " ", "LHS", " ", "for", " ", "only", 
        " ", 
        RowBox[{"Pattern", "[", "]"}], "s", " ", "in", " ", 
        RowBox[{"vars", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varPat", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"Pattern", "->", "xPattern"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"varPat", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{"xvars", ",", "varPat"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{
        RowBox[{"Reverse", "/@", "sub"}], "/.", "varPat"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"tmp", "/.", "sub"}], "/.", 
        RowBox[{"xPattern", "->", "Pattern"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "a_", "]"}], "->", 
    RowBox[{
     RowBox[{"g", "[", "b", "]"}], "+", "ss"}]}], ",", 
   RowBox[{"c", "->", "ss"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"xRuleX", "[", 
  RowBox[{"%", ",", 
   RowBox[{"g", "[", "b_", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.580862999655033*^9, 3.5808630336195297`*^9}, {
   3.5808633702995157`*^9, 3.580863384002351*^9}, {3.580864823566227*^9, 
   3.580864885379291*^9}, {3.580864997892282*^9, 3.580865040486726*^9}, {
   3.583070112041675*^9, 3.583070160876463*^9}, {3.583070231004529*^9, 
   3.583070246160466*^9}, {3.5830704505949993`*^9, 3.583070500120758*^9}, {
   3.583070572228895*^9, 3.583070587095537*^9}, 3.583070619744152*^9, {
   3.5830706550112467`*^9, 3.5830708521764593`*^9}, {3.5830708927393293`*^9, 
   3.5830710041906157`*^9}, 3.58307118535819*^9, {3.583071259400838*^9, 
   3.58307138131809*^9}, {3.583071463654108*^9, 3.583071501636742*^9}, {
   3.583071549425939*^9, 3.5830716261736097`*^9}, {3.583071666186013*^9, 
   3.583071669043612*^9}, {3.5830717280804*^9, 3.583071737390574*^9}, {
   3.583071767451343*^9, 3.58307178819226*^9}, {3.583071925107102*^9, 
   3.5830719267454967`*^9}, 3.583071978030778*^9, {3.583072239448491*^9, 
   3.583072245053492*^9}, {3.583072378059949*^9, 3.583072474767448*^9}, {
   3.583072525041048*^9, 3.5830726664475517`*^9}, {3.583072718596861*^9, 
   3.583072759049788*^9}, 3.583072830949559*^9, {3.583072880265691*^9, 
   3.58307290182775*^9}, {3.583072961060479*^9, 3.583072962590673*^9}, {
   3.58307305666189*^9, 3.583073056924748*^9}, {3.5830731375108747`*^9, 
   3.5830731841531754`*^9}, {3.5830732323301353`*^9, 
   3.5830732566484747`*^9}, {3.5830732872387857`*^9, 3.583073337149126*^9}, {
   3.58307341623096*^9, 3.583073590035541*^9}, {3.583073664117778*^9, 
   3.583073673897296*^9}, {3.583073728760262*^9, 3.583073778778414*^9}, {
   3.5830738243268557`*^9, 3.58307400473779*^9}, {3.583074038927636*^9, 
   3.58307417599647*^9}, {3.583074206778942*^9, 3.583074260407784*^9}, {
   3.583074293036487*^9, 3.583074346236511*^9}, {3.58307438233228*^9, 
   3.583074432435206*^9}, 3.583074471621648*^9, {3.5830745073325043`*^9, 
   3.583074521245996*^9}, {3.5830745909717503`*^9, 3.58307461739342*^9}, {
   3.583074663894106*^9, 3.583074689638681*^9}, {3.5830747509750147`*^9, 
   3.5830749610322313`*^9}, {3.583074992968294*^9, 3.5830750260065813`*^9}, {
   3.583075131942927*^9, 3.583075156276885*^9}, {3.58307584842353*^9, 
   3.58307617688801*^9}, 3.583076207175383*^9, 3.583076240253673*^9, {
   3.583076282537595*^9, 3.583076367589542*^9}, {3.583076397745141*^9, 
   3.583076434990596*^9}, {3.583076471724545*^9, 3.583076487913946*^9}, {
   3.583076536659321*^9, 3.58307656802067*^9}, {3.583076606435334*^9, 
   3.583076617028586*^9}, {3.583076932845491*^9, 3.5830769611878843`*^9}, {
   3.5830770138124323`*^9, 3.583077052268569*^9}, {3.58307709844565*^9, 
   3.583077364835355*^9}, {3.583090228134118*^9, 3.5830902347005787`*^9}, {
   3.58309026645809*^9, 3.583090282953107*^9}, {3.583114100065209*^9, 
   3.583114156612871*^9}, {3.583114190886964*^9, 3.58311421794142*^9}, {
   3.583114315598362*^9, 3.583114345302387*^9}, {3.583114408265617*^9, 
   3.583114436204824*^9}, {3.58311446945497*^9, 3.583114513919859*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "a_", "]"}], "\[Rule]", 
    RowBox[{"ss", "+", 
     RowBox[{"g", "[", "b", "]"}]}]}], ",", 
   RowBox[{"c", "\[Rule]", "ss"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.583114470623151*^9, 3.583114515432721*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "a_", "]"}], "\[Equal]", 
    RowBox[{"ss", "+", 
     RowBox[{"XXXX$131989", "[", "1", "]"}]}]}], ",", 
   RowBox[{"c", "\[Equal]", "ss"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.583114470624229*^9, 3.5831145154340754`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.583114470623151*^9, 3.583114515434676*^9}}]
}, Open  ]]
},
WindowSize->{740, 656},
WindowMargins->{{-276, Automatic}, {Automatic, -1094}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 11109, 228, 614, "Input",
 InitializationCell->True],
Cell[11691, 252, 1124, 25, 25, "Output"],
Cell[12818, 279, 851, 22, 21, "Print"],
Cell[13672, 303, 982, 20, 25, "Output"],
Cell[14657, 325, 982, 20, 25, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15676, 350, 1114, 24, 90, "Input"],
Cell[16793, 376, 244, 5, 26, "Output"],
Cell[17040, 383, 277, 6, 25, "Output"],
Cell[17320, 391, 370, 9, 26, "Output"],
Cell[17693, 402, 371, 9, 26, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18101, 416, 6621, 139, 328, "Input"],
Cell[24725, 557, 288, 8, 26, "Output"],
Cell[25016, 567, 301, 8, 21, "Print"],
Cell[25320, 577, 111, 2, 25, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
