(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    234251,       6124]
NotebookOptionsPosition[    233111,       6081]
NotebookOutlinePosition[    233478,       6097]
CellTagsIndexPosition[    233435,       6094]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"<<", "Local`QFTToolKit`"}], "\[IndentingNewLine]", 
 RowBox[{"Put", "[", 
  RowBox[{"SaveFile", "=", 
   RowBox[{
    RowBox[{"NBname", "[", "\"\<stub\>\"", "]"}], "<>", "\"\<.out\>\""}]}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56864327369387*^9, 3.5686433185337973`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Verify ~(3): \>\"", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     OverscriptBox["n", "\[RightVector]"], "->", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "z", "]"}], " ", ".", " ", 
      OverscriptBox["\[Sigma]", "\[RightVector]"], " ", ".", " ", "z"}]}]}], 
   ",", "\[IndentingNewLine]", "NL", ",", "\"\<where \>\"", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"subz", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"z", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["z", "1"], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["z", "2"], "}"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "z", "]"}], ".", "z"}], "->", 
         "1"}], ",", 
        RowBox[{
         OverscriptBox["\[Sigma]_", "\[RightVector]"], "->", 
         RowBox[{"\[Sigma]", "@", 
          RowBox[{"u", "[", "i", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          OverscriptBox["n", "\[RightVector]"], ".", 
          OverscriptBox["n", "\[RightVector]"]}], "->", "1"}]}], "}"}]}], 
     ")"}], "//", "MatrixForms"}], ",", "\[IndentingNewLine]", "and", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Sigma]", "@", 
      RowBox[{"u", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "}"}], ",", 
   "\"\< are Pauli matrices\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", "subz"}]}], ")"}], "//", "MatrixForms"}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<For each i\>\"", ",", 
   "\[IndentingNewLine]", "imply", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"subn", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "/.", "sPauli"}], "//.", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ll", ":", 
           RowBox[{"List", "[", "_", "]"}]}], ":>", 
          RowBox[{"Flatten", "[", "ll", "]"}]}], ")"}]}], "//", 
       "Simplify"}]}], ")"}], "//", "ColumnForm"}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Check constraint: \>\"", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"subz", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "Yield", 
   ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"MapAt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"subz", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "&"}], ",", "tmp", ",", 
      "1"}], "]"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "/.", "subn"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "//", "Factor"}]}], ",", 
   "\"\<\[LongLeftArrow]this is: \>\"", ",", 
   RowBox[{"subz", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", "OK", ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<Hence \>\"", ",", 
   RowBox[{"subz", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
   "\"\< can represent n with its 4-1 independant values. \>\""}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.583410084304195*^9, 3.583410134812748*^9}, {
  3.583410165851192*^9, 3.583410207952579*^9}, {3.583410786409561*^9, 
  3.583411026267509*^9}, {3.583411079870714*^9, 3.5834111086349583`*^9}, {
  3.58341114269128*^9, 3.583411276106461*^9}, {3.583411308734253*^9, 
  3.583411367611246*^9}, {3.5834114447497463`*^9, 3.583411587909189*^9}, {
  3.583411622546308*^9, 3.583411703020556*^9}, {3.583411751257758*^9, 
  3.583411785198965*^9}, {3.583411817610653*^9, 3.583411849612224*^9}, {
  3.5834119347025223`*^9, 3.583412016344224*^9}, {3.58341205410682*^9, 
  3.583412241959537*^9}, {3.5834122741703777`*^9, 3.583412368066085*^9}, {
  3.583412496873197*^9, 3.583412588680711*^9}, {3.583412623271387*^9, 
  3.58341262399706*^9}, {3.583412717569018*^9, 3.5834128006412983`*^9}, {
  3.583412887707766*^9, 3.58341303041715*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Verify ~(3): \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox["z", "\[Dagger]"],
      ConjugateTranspose[$CellContext`z],
      Editable->False,
      SyntaxForm->Automatic], ".", 
     OverscriptBox["\[Sigma]", "\[RightVector]"], ".", "z"}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"where \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "\[Rule]", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           SubscriptBox["z", "1"]},
          {
           SubscriptBox["z", "2"]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ",", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        SuperscriptBox["z", "\[Dagger]"],
        ConjugateTranspose[$CellContext`z],
        Editable->False,
        SyntaxForm->Automatic], ".", "z"}], "\[Rule]", "1"}], ",", 
     RowBox[{
      OverscriptBox["\[Sigma]_", "\[RightVector]"], "\[Rule]", 
      InterpretationBox[
       SubsuperscriptBox["\[Sigma]", 
        StyleBox["i",
         StripOnInput->False,
         ShowContents->False], "i"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], \
{$CellContext`i}, {TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], ",", 
     RowBox[{
      RowBox[{
       OverscriptBox["n", "\[RightVector]"], ".", 
       OverscriptBox["n", "\[RightVector]"]}], "\[Rule]", "1"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" and \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\[Sigma]", 
       StyleBox["i",
        StripOnInput->False,
        ShowContents->False], "i"],
      TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], \
{$CellContext`i}, {TensorCalculus5`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "}"}], "\[InvisibleSpace]", 
   
   StyleBox["\<\" are Pauli matrices\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["n", 
      StyleBox["i",
       StripOnInput->False,
       ShowContents->False], "i"],
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
      TensorCalculus5`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          InterpretationBox[
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox["z", "1"], ")"}], "*"],
           Conjugate[
            Subscript[$CellContext`z, 1]],
           Editable->False,
           SyntaxForm->Automatic], 
          InterpretationBox[
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox["z", "2"], ")"}], "*"],
           Conjugate[
            Subscript[$CellContext`z, 2]],
           Editable->False,
           SyntaxForm->Automatic]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ".", 
     InterpretationBox[
      SubsuperscriptBox["\[Sigma]", 
       StyleBox["i",
        StripOnInput->False,
        ShowContents->False], "i"],
      TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], \
{$CellContext`i}, {TensorCalculus5`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], ".", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          SubscriptBox["z", "1"]},
         {
          SubscriptBox["z", "2"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"For each i\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
          TensorCalculus5`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["z", "2"], ")"}], "*"],
            Conjugate[
             Subscript[$CellContext`z, 2]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           SubscriptBox["z", "1"]}], "+", 
          RowBox[{
           InterpretationBox[
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["z", "1"], ")"}], "*"],
            Conjugate[
             Subscript[$CellContext`z, 1]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           SubscriptBox["z", "2"]}]}], "}"}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
          TensorCalculus5`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SuperscriptBox[
               RowBox[{"(", 
                SubscriptBox["z", "2"], ")"}], "*"],
              Conjugate[
               Subscript[$CellContext`z, 2]],
              Editable->False,
              SyntaxForm->Automatic], " ", 
             SubscriptBox["z", "1"]}], "-", 
            RowBox[{
             InterpretationBox[
              SuperscriptBox[
               RowBox[{"(", 
                SubscriptBox["z", "1"], ")"}], "*"],
              Conjugate[
               Subscript[$CellContext`z, 1]],
              Editable->False,
              SyntaxForm->Automatic], " ", 
             SubscriptBox["z", "2"]}]}], ")"}]}], "}"}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
          TensorCalculus5`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["z", "1"], ")"}], "*"],
            Conjugate[
             Subscript[$CellContext`z, 1]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           SubscriptBox["z", "1"]}], "-", 
          RowBox[{
           InterpretationBox[
            SuperscriptBox[
             RowBox[{"(", 
              SubscriptBox["z", "2"], ")"}], "*"],
            Conjugate[
             Subscript[$CellContext`z, 2]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           SubscriptBox["z", "2"]}]}], "}"}]}]}
     },
     BaselinePosition->{Baseline, {1, 1}},
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}}],
    ColumnForm[{
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}] -> {Conjugate[
           Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 1] + 
        Conjugate[
           Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 2]}, 
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}] -> {Complex[0, 1] (Conjugate[
            Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 1] - 
         Conjugate[
           Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 2])}, 
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
        TensorCalculus5`Tensorial`Void}] -> {Conjugate[
           Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 1] - 
        Conjugate[
          Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 2]}}],
    Editable->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Check constraint: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     OverscriptBox["n", "\[RightVector]"], ".", 
     OverscriptBox["n", "\[RightVector]"]}], "\[Rule]", "1"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], ".", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], ".", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], ".", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}]}], "\[Rule]", "1"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox["z", "2"], ")"}], "*"],
           Conjugate[
            Subscript[$CellContext`z, 2]],
           Editable->False,
           SyntaxForm->Automatic], " ", 
          SubscriptBox["z", "1"]}], "-", 
         RowBox[{
          InterpretationBox[
           SuperscriptBox[
            RowBox[{"(", 
             SubscriptBox["z", "1"], ")"}], "*"],
           Conjugate[
            Subscript[$CellContext`z, 1]],
           Editable->False,
           SyntaxForm->Automatic], " ", 
          SubscriptBox["z", "2"]}]}], ")"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["z", "2"], ")"}], "*"],
          Conjugate[
           Subscript[$CellContext`z, 2]],
          Editable->False,
          SyntaxForm->Automatic], " ", 
         SubscriptBox["z", "1"]}], "+", 
        RowBox[{
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["z", "1"], ")"}], "*"],
          Conjugate[
           Subscript[$CellContext`z, 1]],
          Editable->False,
          SyntaxForm->Automatic], " ", 
         SubscriptBox["z", "2"]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["z", "1"], ")"}], "*"],
          Conjugate[
           Subscript[$CellContext`z, 1]],
          Editable->False,
          SyntaxForm->Automatic], " ", 
         SubscriptBox["z", "1"]}], "-", 
        RowBox[{
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"(", 
            SubscriptBox["z", "2"], ")"}], "*"],
          Conjugate[
           Subscript[$CellContext`z, 2]],
          Editable->False,
          SyntaxForm->Automatic], " ", 
         SubscriptBox["z", "2"]}]}], ")"}], "2"]}], "\[Rule]", "1"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox["z", "1"], ")"}], "*"],
         Conjugate[
          Subscript[$CellContext`z, 1]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        SubscriptBox["z", "1"]}], "+", 
       RowBox[{
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"(", 
           SubscriptBox["z", "2"], ")"}], "*"],
         Conjugate[
          Subscript[$CellContext`z, 2]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        SubscriptBox["z", "2"]}]}], ")"}], "2"], "\[Rule]", "1"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\[LongLeftArrow]this is: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      SuperscriptBox["z", "\[Dagger]"],
      ConjugateTranspose[$CellContext`z],
      Editable->False,
      SyntaxForm->Automatic], ".", "z"}], "\[Rule]", "1"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" OK \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontSize->Larger,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Hence \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         SubscriptBox["z", "1"], "}"}], ",", 
        RowBox[{"{", 
         SubscriptBox["z", "2"], "}"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        SuperscriptBox["z", "\[Dagger]"],
        ConjugateTranspose[$CellContext`z],
        Editable->False,
        SyntaxForm->Automatic], ".", "z"}], "\[Rule]", "1"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" can represent n with its 4-1 independant values. \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]]}],
  SequenceForm[
   Style["Verify ~(3): ", 
    RGBColor[0, 0, 1], Larger], OverVector[$CellContext`n] -> Dot[
     ConjugateTranspose[$CellContext`z], 
     OverVector[$CellContext`\[Sigma]], $CellContext`z], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["where ", 
    RGBColor[0, 0, 1], Larger], {$CellContext`z -> MatrixForm[{{
        Subscript[$CellContext`z, 1]}, {
        Subscript[$CellContext`z, 2]}}], Dot[
      ConjugateTranspose[$CellContext`z], $CellContext`z] -> 1, OverVector[
      Pattern[$CellContext`\[Sigma], 
       Blank[]]] -> 
    TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], {$CellContext`i}, \
{TensorCalculus5`Tensorial`Void}], Dot[
      OverVector[$CellContext`n], 
      OverVector[$CellContext`n]] -> 1}, 
   Style[" and ", 
    RGBColor[0, 0, 1], Larger], {
    TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], {$CellContext`i}, \
{TensorCalculus5`Tensorial`Void}], {$CellContext`i, 1, 3}}, 
   Style[" are Pauli matrices", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
     TensorCalculus5`Tensorial`Void}] -> Dot[
     MatrixForm[{{
        Conjugate[
         Subscript[$CellContext`z, 1]], 
        Conjugate[
         Subscript[$CellContext`z, 2]]}}], 
     TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], \
{$CellContext`i}, {TensorCalculus5`Tensorial`Void}], 
     MatrixForm[{{
        Subscript[$CellContext`z, 1]}, {
        Subscript[$CellContext`z, 2]}}]], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["For each i", 
    RGBColor[0, 0, 1], Larger], 
   Style[" \[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   ColumnForm[{
    TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
       TensorCalculus5`Tensorial`Void}] -> {Conjugate[
          Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 1] + 
       Conjugate[
          Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 2]}, 
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
       TensorCalculus5`Tensorial`Void}] -> {Complex[0, 1] (Conjugate[
           Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 1] - 
        Conjugate[
          Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 2])}, 
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
       TensorCalculus5`Tensorial`Void}] -> {Conjugate[
          Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 1] - 
       Conjugate[
         Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 2]}}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Check constraint: ", 
    RGBColor[0, 0, 1], Larger], Dot[
     OverVector[$CellContext`n], 
     OverVector[$CellContext`n]] -> 1, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], Dot[
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
       TensorCalculus5`Tensorial`Void}], 
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
       TensorCalculus5`Tensorial`Void}]] + Dot[
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
       TensorCalculus5`Tensorial`Void}], 
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
       TensorCalculus5`Tensorial`Void}]] + Dot[
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
       TensorCalculus5`Tensorial`Void}], 
      TensorCalculus5`Tensorial`Tensor[$CellContext`n, {3}, {
       TensorCalculus5`Tensorial`Void}]] -> 1, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], -(Conjugate[
          Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 1] - 
       Conjugate[
         Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 2])^2 + (
      Conjugate[
         Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 1] + 
      Conjugate[
         Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 2])^2 + (
      Conjugate[
         Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 1] - 
      Conjugate[
        Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 2])^2 -> 1, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], (Conjugate[
        Subscript[$CellContext`z, 1]] Subscript[$CellContext`z, 1] + Conjugate[
        Subscript[$CellContext`z, 2]] Subscript[$CellContext`z, 2])^2 -> 1, 
   Style["\[LongLeftArrow]this is: ", 
    RGBColor[0, 0, 1], Larger], Dot[
     ConjugateTranspose[$CellContext`z], $CellContext`z] -> 1, 
   Style[" OK ", 
    RGBColor[1, 0, 0], Larger], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Hence ", 
    RGBColor[0, 0, 1], Larger], {$CellContext`z -> {{
       Subscript[$CellContext`z, 1]}, {
       Subscript[$CellContext`z, 2]}}, Dot[
      ConjugateTranspose[$CellContext`z], $CellContext`z] -> 1}, 
   Style[" can represent n with its 4-1 independant values. ", 
    RGBColor[0, 0, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.5834121994907207`*^9, 3.5834122427502317`*^9}, {
   3.583412276256036*^9, 3.5834123689878883`*^9}, {3.583412501572588*^9, 
   3.583412510515586*^9}, {3.583412552252249*^9, 3.583412589750081*^9}, 
   3.58341262480398*^9, {3.5834127781901484`*^9, 3.583412801596362*^9}, 
   3.5834129377202663`*^9, 3.58341297007521*^9, 3.583413149879553*^9, 
   3.583514423749147*^9, 3.583534678837884*^9, 3.583637157466082*^9, 
   3.583673381391591*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<The equation of motion from (3) using (4) for the j-th {z,n} term in \
Sum: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmpz", "=", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "z", "]"}], ".", 
      RowBox[{"xPartialD", "[", 
       RowBox[{"z", ",", "t"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmp0", "=", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "t", "}"}], "}"}], ",", 
        RowBox[{"\[Delta]", "[", "tmpz", "]"}]}], "]"}], "->", 
      RowBox[{
       FractionBox["I", "2"], 
       RowBox[{"IntegralOp", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "t", "}"}], "}"}], ",", 
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], " ", "\[Wedge]", " ", 
            RowBox[{"xPartialD", "[", 
             RowBox[{
              OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}]}], 
           ")"}]}]}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Contribution to equation of motion from the additional term: \>\"", 
   ",", 
   RowBox[{"tmpp", "=", 
    RowBox[{"I", " ", 
     RowBox[{"xSum", "[", " ", 
      RowBox[{"tmpz", ",", "j"}], "]"}]}]}], ",", "\[IndentingNewLine]", "NL",
    ",", "\"\<The variation of the term: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp0", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "a_", "]"}], "->", "a"}]}]}], ")"}], "->", 
    RowBox[{
     RowBox[{"\[Delta]", "[", "tmpp", "]"}], "->", 
     RowBox[{"tmp0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", "NL", 
   ",", "\"\<The equation of motion from stationary point of \
(2)[\!\(\*OverscriptBox[\(n\), \(\[RightVector]\)]\)]: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"e2", "=", 
    RowBox[{"\[ScriptCapitalL]", "->", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", 
        RowBox[{"g", "^", "2"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}], ".", 
         RowBox[{"xPartialD", "[", 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          SubscriptBox["c", "s"], "^", "2"}], " ", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{
              OverscriptBox["n", "\[RightVector]"], ",", 
              RowBox[{"x", "@", 
               RowBox[{"u", "[", "l", "]"}]}]}], "]"}], ".", 
            RowBox[{"xPartialD", "[", 
             RowBox[{
              OverscriptBox["n", "\[RightVector]"], ",", 
              RowBox[{"x", "@", 
               RowBox[{"u", "[", "l", "]"}]}]}], "]"}]}], ",", 
           RowBox[{"{", "l", "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"0", "->", 
     RowBox[{"\[Delta]", "/@", "e2"}]}]}], ",", "\[IndentingNewLine]", "NL", 
   ",", "\"\<Use integration by parts ignoring surface terms: \>\"", ",", 
   RowBox[{"sub", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"xPartialD", "[", 
       RowBox[{
        OverscriptBox["n", "\[RightVector]"], ",", "t_"}], "]"}], ".", 
      RowBox[{"xPartialD", "[", 
       RowBox[{
        OverscriptBox["n", "\[RightVector]"], ",", "t_"}], "]"}]}], "->", 
     RowBox[{"-", 
      RowBox[{
       OverscriptBox["n", "\[RightVector]"], ".", 
       RowBox[{"xPartialD", "[", 
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}], ",", 
         "t"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "//.", "sub"}]}], ",", "\[IndentingNewLine]", 
   "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "//", 
     RowBox[{"\[Delta]Expand", "[", 
      RowBox[{"\[Delta]", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["c", "s"], ",", "g", ",", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"_", ",", "_"}], "]"}]}], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"xSum", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "->", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{"\[Delta]", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "//", 
     RowBox[{"\[Delta]Expand", "[", 
      RowBox[{"\[Delta]", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["c", "s"], ",", "g", ",", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"_", ",", "_"}], "]"}]}], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "\"\<PONdd\>\"", ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "//.", 
     RowBox[{"simpleDot2", "[", 
      RowBox[{"{", "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<The corrected Lagrangian with Berry phases adds: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"tmp1", "=", 
    RowBox[{"tmp0", "/.", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "->", "b"}]}]}], ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"tmp", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"tmp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"tmp1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "I"}]}]}], ";", 
    "\[IndentingNewLine]", "tmp"}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Hence the equation of motion: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"Framed", "[", 
    RowBox[{"tmp4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tmp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", 
        RowBox[{"tmp", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "_", "]"}], "->", "1"}]}], "//.", 
      RowBox[{"simpleDot2", "[", 
       RowBox[{"{", "}"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", "NL",
    ",", "\"\<Here \>\"", ",", 
   RowBox[{"subcs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "s"], "^", "2"}], "->", 
      RowBox[{"2", " ", 
       RowBox[{"a", "^", "2"}], " ", "J", " ", 
       RowBox[{"g", "^", "2"}]}]}], "}"}]}], ",", 
   "\"\< where a is the lattice spacing.\>\""}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.583413991980814*^9, 3.583414132746583*^9}, {
   3.5834141950186787`*^9, 3.583414221505932*^9}, {3.583414290113155*^9, 
   3.583414349011567*^9}, {3.583414380958888*^9, 3.5834144449981947`*^9}, {
   3.583414497850017*^9, 3.583414551054304*^9}, {3.583414772464954*^9, 
   3.583414846394764*^9}, {3.583414888536663*^9, 3.583414889035466*^9}, 
   3.583414932718416*^9, 3.583416026417321*^9, {3.5834161194182167`*^9, 
   3.5834162554801903`*^9}, {3.583416406021245*^9, 3.583416430376218*^9}, {
   3.583534438531309*^9, 3.583534527387816*^9}, {3.583534568006707*^9, 
   3.583534664164445*^9}, {3.583575610378745*^9, 3.5835757870431433`*^9}, {
   3.583575837229288*^9, 3.58357624071426*^9}, {3.583576401823381*^9, 
   3.583576473926921*^9}, {3.583576572475026*^9, 3.5835765732528152`*^9}, {
   3.58357672081662*^9, 3.583576817089903*^9}, {3.5835768706147633`*^9, 
   3.5835769218449173`*^9}, {3.583579807734543*^9, 3.583579808133621*^9}, {
   3.583579867858832*^9, 3.58357991483495*^9}, {3.583580023264512*^9, 
   3.583580081969193*^9}, {3.5835801494156*^9, 3.5835802153817453`*^9}, {
   3.583580326643093*^9, 3.583580339656672*^9}, {3.58358037598423*^9, 
   3.583580410757112*^9}, {3.583580502894796*^9, 3.583580735838838*^9}, {
   3.5835807733094873`*^9, 3.583580836088142*^9}, {3.5835812564739532`*^9, 
   3.583581258442993*^9}, {3.58375854457428*^9, 3.583758561383061*^9}, {
   3.583758720858646*^9, 3.583758761063179*^9}, {3.583760403671015*^9, 
   3.583760403885316*^9}, {3.5837629378016157`*^9, 3.583762969974758*^9}, {
   3.58376301131957*^9, 3.5837630120893707`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The equation of motion from (3) using (4) for the j-th {z,n} \
term in Sum: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox["\<\"\[Integral]\"\>", 
       TagBox[GridBox[{
          {
           RowBox[{"{", "t", "}"}]}
         },
         DefaultBaseStyle->"Column",
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Column"]], "[", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{
        InterpretationBox[
         SuperscriptBox["z", "\[Dagger]"],
         ConjugateTranspose[$CellContext`z],
         Editable->False,
         SyntaxForm->Automatic], ".", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
         $CellContext`xPartialD[$CellContext`z, $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], "]"}], "]"}],
     $CellContext`IntegralOp[{{$CellContext`t}}, 
      $CellContext`\[Delta][
       Dot[
        ConjugateTranspose[$CellContext`z], 
        $CellContext`xPartialD[$CellContext`z, $CellContext`t]]]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     InterpretationBox[
      RowBox[{
       SubscriptBox["\<\"\[Integral]\"\>", 
        TagBox[GridBox[{
           {
            RowBox[{"{", "t", "}"}]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          OverscriptBox["n", "\[RightVector]"], "\[Wedge]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], ")"}]}], "]"}],
      $CellContext`IntegralOp[{{$CellContext`t}}, 
       Dot[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], 
        Wedge[
         OverVector[$CellContext`n], 
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t]]]],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Contribution to equation of motion from the additional term: \
\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     RowBox[{
      UnderscriptBox[
       UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
       TagBox[GridBox[{
          {"j"}
         },
         DefaultBaseStyle->"Column",
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Column"]], "[", 
      RowBox[{
       InterpretationBox[
        SuperscriptBox["z", "\[Dagger]"],
        ConjugateTranspose[$CellContext`z],
        Editable->False,
        SyntaxForm->Automatic], ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
        $CellContext`xPartialD[$CellContext`z, $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], "]"}],
     $CellContext`xSum[
      Dot[
       ConjugateTranspose[$CellContext`z], 
       $CellContext`xPartialD[$CellContext`z, $CellContext`t]], \
$CellContext`j],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The variation of the term: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox["\<\"\[Integral]\"\>", 
       TagBox[GridBox[{
          {
           RowBox[{"{", "t", "}"}]}
         },
         DefaultBaseStyle->"Column",
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Column"]], "[", 
      RowBox[{
       InterpretationBox[
        SuperscriptBox["z", "\[Dagger]"],
        ConjugateTranspose[$CellContext`z],
        Editable->False,
        SyntaxForm->Automatic], ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
        $CellContext`xPartialD[$CellContext`z, $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], "]"}],
     $CellContext`IntegralOp[{{$CellContext`t}}, 
      Dot[
       ConjugateTranspose[$CellContext`z], 
       $CellContext`xPartialD[$CellContext`z, $CellContext`t]]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"\[ImaginaryI]", " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {"j"}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          InterpretationBox[
           SuperscriptBox["z", "\[Dagger]"],
           ConjugateTranspose[$CellContext`z],
           Editable->False,
           SyntaxForm->Automatic], ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
           $CellContext`xPartialD[$CellContext`z, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[
         Dot[
          ConjugateTranspose[$CellContext`z], 
          $CellContext`xPartialD[$CellContext`z, $CellContext`t]], \
$CellContext`j],
        Editable->False,
        SyntaxForm->Automatic]}], "]"}], "\[Rule]", 
     InterpretationBox[
      RowBox[{
       SubscriptBox["\<\"\[Integral]\"\>", 
        TagBox[GridBox[{
           {
            RowBox[{"{", "t", "}"}]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       RowBox[{"\[Delta]", "[", 
        RowBox[{
         InterpretationBox[
          SuperscriptBox["z", "\[Dagger]"],
          ConjugateTranspose[$CellContext`z],
          Editable->False,
          SyntaxForm->Automatic], ".", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", 
           "]"}],
          $CellContext`xPartialD[$CellContext`z, $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "]"}], "]"}],
      $CellContext`IntegralOp[{{$CellContext`t}}, 
       $CellContext`\[Delta][
        Dot[
         ConjugateTranspose[$CellContext`z], 
         $CellContext`xPartialD[$CellContext`z, $CellContext`t]]]],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The equation of motion from stationary point of \
(2)[\\!\\(\\*OverscriptBox[\\(n\\), \\(\[RightVector]\\)]\\)]: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"\[ScriptCapitalL]", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], "-", 
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic], ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[
         Dot[
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], 
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["g", "2"]}]]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"\[Delta]", "[", "\[ScriptCapitalL]", "]"}], "\[Rule]", 
     RowBox[{"\[Delta]", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}],
          $CellContext`xPartialD[
           OverVector[$CellContext`n], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic], ".", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}],
          $CellContext`xPartialD[
           OverVector[$CellContext`n], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}],
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic], ".", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}],
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic]}], "]"}],
          $CellContext`xSum[
           Dot[
            $CellContext`xPartialD[
             OverVector[$CellContext`n], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            $CellContext`xPartialD[
             OverVector[$CellContext`n], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Use integration by parts ignoring surface terms: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t_"], "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}],
      $CellContext`xPartialD[
       OverVector[$CellContext`n], 
       Pattern[$CellContext`t, 
        Blank[]]],
      Editable->False,
      SyntaxForm->Automatic], ".", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t_"], "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}],
      $CellContext`xPartialD[
       OverVector[$CellContext`n], 
       Pattern[$CellContext`t, 
        Blank[]]],
      Editable->False,
      SyntaxForm->Automatic]}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      OverscriptBox["n", "\[RightVector]"], ".", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}],
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"\[Delta]", "[", "\[ScriptCapitalL]", "]"}], "\[Rule]", 
     RowBox[{"\[Delta]", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          OverscriptBox["n", "\[RightVector]"], ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}],
             $CellContext`xPartialD[
              OverVector[$CellContext`n], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic], "]"}],
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}]}], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           RowBox[{"-", 
            RowBox[{
             OverscriptBox["n", "\[RightVector]"], ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                InterpretationBox[
                 SubsuperscriptBox["x", 
                  StyleBox["l",
                   StripOnInput->False,
                   ShowContents->False], "l"],
                 
                 TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]], "[", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                  InterpretationBox[
                   SubsuperscriptBox["x", 
                    StyleBox["l",
                    StripOnInput->False,
                    ShowContents->False], "l"],
                   
                   TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False]], "[", 
                 OverscriptBox["n", "\[RightVector]"], "]"}],
                $CellContext`xPartialD[
                 OverVector[$CellContext`n], 
                 
                 TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
                Editable->False,
                SyntaxForm->Automatic], "]"}],
              $CellContext`xPartialD[
               $CellContext`xPartialD[
                OverVector[$CellContext`n], 
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
              Editable->False,
              SyntaxForm->Automatic]}]}], "]"}],
          $CellContext`xSum[-Dot[
             OverVector[$CellContext`n], 
             $CellContext`xPartialD[
              $CellContext`xPartialD[
               OverVector[$CellContext`n], 
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n.......\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontSize->Larger,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"\[Delta]", "[", "\[ScriptCapitalL]", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             OverscriptBox["n", "\[RightVector]"], "]"}],
            $CellContext`xPartialD[
             OverVector[$CellContext`n], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`xPartialD[
           $CellContext`xPartialD[
            OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"]}]]}], "-", 
      FractionBox[
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Delta]", "[", 
             OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                 InterpretationBox[
                  SubsuperscriptBox["x", 
                   StyleBox["l",
                    StripOnInput->False,
                    ShowContents->False], "l"],
                  
                  TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]], "[", 
                OverscriptBox["n", "\[RightVector]"], "]"}],
               $CellContext`xPartialD[
                OverVector[$CellContext`n], 
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
               Editable->False,
               SyntaxForm->Automatic], "]"}],
             $CellContext`xPartialD[
              $CellContext`xPartialD[
               OverVector[$CellContext`n], 
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic]}]}], "]"}],
         $CellContext`xSum[-Dot[
            $CellContext`\[Delta][
             OverVector[$CellContext`n]], 
            $CellContext`xPartialD[
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The corrected Lagrangian with Berry phases adds: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{
      InterpretationBox[
       SuperscriptBox["z", "\[Dagger]"],
       ConjugateTranspose[$CellContext`z],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
       $CellContext`xPartialD[$CellContext`z, $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        OverscriptBox["n", "\[RightVector]"], "\[Wedge]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}],
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], ")"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"\[Delta]", "[", "\[ScriptCapitalL]", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          OverscriptBox["n", "\[RightVector]"], "\[Wedge]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], ")"}]}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic], "]"}],
         $CellContext`xPartialD[
          $CellContext`xPartialD[
           OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Delta]", "[", 
             OverscriptBox["n", "\[RightVector]"], "]"}], ".", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                 InterpretationBox[
                  SubsuperscriptBox["x", 
                   StyleBox["l",
                    StripOnInput->False,
                    ShowContents->False], "l"],
                  
                  TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]], "[", 
                OverscriptBox["n", "\[RightVector]"], "]"}],
               $CellContext`xPartialD[
                OverVector[$CellContext`n], 
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
               Editable->False,
               SyntaxForm->Automatic], "]"}],
             $CellContext`xPartialD[
              $CellContext`xPartialD[
               OverVector[$CellContext`n], 
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic]}]}], "]"}],
         $CellContext`xSum[-Dot[
            $CellContext`\[Delta][
             OverVector[$CellContext`n]], 
            $CellContext`xPartialD[
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Hence the equation of motion: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"0", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{
        OverscriptBox["n", "\[RightVector]"], "\[Wedge]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}],
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}]}], "-", 
      FractionBox[
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}],
          $CellContext`xPartialD[
           OverVector[$CellContext`n], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`xPartialD[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          RowBox[{"-", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
              InterpretationBox[
               SubsuperscriptBox["x", 
                StyleBox["l",
                 StripOnInput->False,
                 ShowContents->False], "l"],
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]], "[", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                InterpretationBox[
                 SubsuperscriptBox["x", 
                  StyleBox["l",
                   StripOnInput->False,
                   ShowContents->False], "l"],
                 
                 TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]], "[", 
               OverscriptBox["n", "\[RightVector]"], "]"}],
              $CellContext`xPartialD[
               OverVector[$CellContext`n], 
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`xPartialD[
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
            Editable->False,
            SyntaxForm->Automatic]}], "]"}],
         $CellContext`xSum[-$CellContext`xPartialD[
            $CellContext`xPartialD[
             OverVector[$CellContext`n], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]]}]}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Here \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SubsuperscriptBox["c", "s", "2"], "\[Rule]", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["g", "2"], " ", "J"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\" where a is the lattice spacing.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]]}],
  SequenceForm[
   Style["The equation of motion from (3) using (4) for the j-th {z,n} term \
in Sum: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`IntegralOp[{{$CellContext`t}}, 
     $CellContext`\[Delta][
      Dot[
       ConjugateTranspose[$CellContext`z], 
       $CellContext`xPartialD[$CellContext`z, $CellContext`t]]]] -> Complex[0, 
      Rational[1, 2]] $CellContext`IntegralOp[{{$CellContext`t}}, 
      Dot[
       $CellContext`\[Delta][
        OverVector[$CellContext`n]], 
       Wedge[
        OverVector[$CellContext`n], 
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t]]]], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Contribution to equation of motion from the additional term: ", 
    RGBColor[0, 0, 1], Larger], Complex[0, 1] $CellContext`xSum[
     Dot[
      ConjugateTranspose[$CellContext`z], 
      $CellContext`xPartialD[$CellContext`z, $CellContext`t]], \
$CellContext`j], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The variation of the term: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`IntegralOp[{{$CellContext`t}}, 
     Dot[
      ConjugateTranspose[$CellContext`z], 
      $CellContext`xPartialD[$CellContext`z, $CellContext`t]]] -> \
($CellContext`\[Delta][Complex[0, 1] $CellContext`xSum[
        Dot[
         ConjugateTranspose[$CellContext`z], 
         $CellContext`xPartialD[$CellContext`z, $CellContext`t]], \
$CellContext`j]] -> $CellContext`IntegralOp[{{$CellContext`t}}, 
      $CellContext`\[Delta][
       Dot[
        ConjugateTranspose[$CellContext`z], 
        $CellContext`xPartialD[$CellContext`z, $CellContext`t]]]]), 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The equation of motion from stationary point of \
(2)[\!\(\*OverscriptBox[\(n\), \(\[RightVector]\)]\)]: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[ScriptCapitalL] -> 
   Rational[1, 2] $CellContext`g^(-2) (Dot[
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]] - 
     Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
       Dot[
        $CellContext`xPartialD[
         OverVector[$CellContext`n], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]], 
        $CellContext`xPartialD[
         OverVector[$CellContext`n], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}]), 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Delta][$CellContext`\[ScriptCapitalL]] -> \
$CellContext`\[Delta][Rational[1, 2] $CellContext`g^(-2) (Dot[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t], 
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t]] - 
       Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
         Dot[
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], 
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}])]), 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Use integration by parts ignoring surface terms: ", 
    RGBColor[0, 0, 1], Larger], Dot[
     $CellContext`xPartialD[
      OverVector[$CellContext`n], 
      Pattern[$CellContext`t, 
       Blank[]]], 
     $CellContext`xPartialD[
      OverVector[$CellContext`n], 
      Pattern[$CellContext`t, 
       Blank[]]]] -> -Dot[
      OverVector[$CellContext`n], 
      $CellContext`xPartialD[
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t], $CellContext`t]], 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Delta][$CellContext`\[ScriptCapitalL]] -> \
$CellContext`\[Delta][Rational[1, 2] $CellContext`g^(-2) (-Dot[
          OverVector[$CellContext`n], 
          $CellContext`xPartialD[
           $CellContext`xPartialD[
            OverVector[$CellContext`n], $CellContext`t], $CellContext`t]] - 
       Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[-Dot[
           OverVector[$CellContext`n], 
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             OverVector[$CellContext`n], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}])]), 
   Style["\n.......", 
    RGBColor[1, 0, 0], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Delta][$CellContext`\[ScriptCapitalL]] -> 
    Rational[-1, 2] $CellContext`g^(-2) Dot[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], 
        $CellContext`xPartialD[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t], $CellContext`t]] + 
     Rational[-1, 2] $CellContext`g^(-2) 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[-Dot[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], 
          $CellContext`xPartialD[
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}]), 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The corrected Lagrangian with Berry phases adds: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[Delta][
     Dot[
      ConjugateTranspose[$CellContext`z], 
      $CellContext`xPartialD[$CellContext`z, $CellContext`t]]] -> Complex[0, 
      Rational[1, 2]] Dot[
      $CellContext`\[Delta][
       OverVector[$CellContext`n]], 
      Wedge[
       OverVector[$CellContext`n], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]]], 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Delta][$CellContext`\[ScriptCapitalL]] -> 
    Rational[-1, 2] Dot[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], 
        Wedge[
         OverVector[$CellContext`n], 
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t]]] + 
     Rational[-1, 2] $CellContext`g^(-2) Dot[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], 
        $CellContext`xPartialD[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t], $CellContext`t]] + 
     Rational[-1, 2] $CellContext`g^(-2) 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[-Dot[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], 
          $CellContext`xPartialD[
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}]), 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Hence the equation of motion: ", 
    RGBColor[0, 0, 1], Larger], 
   Framed[0 -> Rational[-1, 2] Wedge[
        OverVector[$CellContext`n], 
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t]] + 
     Rational[-1, 2] $CellContext`g^(-2) $CellContext`xPartialD[
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t], $CellContext`t] + 
     Rational[-1, 2] $CellContext`g^(-2) 
      Subscript[$CellContext`c, $CellContext`s]^2 \
$CellContext`xSum[-$CellContext`xPartialD[
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]], {$CellContext`l}]], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Here ", 
    RGBColor[0, 0, 1], Larger], {
   Subscript[$CellContext`c, $CellContext`s]^2 -> 
    2 $CellContext`a^2 $CellContext`g^2 $CellContext`J}, 
   Style[" where a is the lattice spacing.", 
    RGBColor[0, 0, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.583414112183988*^9, 3.5834144161966753`*^9, 3.5834144464233923`*^9, 
   3.583414511083036*^9, 3.5834160280640574`*^9, {3.583416141914218*^9, 
   3.5834161546012573`*^9}, 3.583416189775441*^9, 3.583416431935266*^9, 
   3.583514432843886*^9, 3.5835344952910223`*^9, 3.583534528056212*^9, {
   3.583534615546586*^9, 3.583534625543866*^9}, 3.5835346859229116`*^9, 
   3.583575695698257*^9, {3.5835757608852053`*^9, 3.583575788218334*^9}, {
   3.58357587653986*^9, 3.5835759207117033`*^9}, {3.583575958776986*^9, 
   3.58357597875112*^9}, {3.583576104365903*^9, 3.583576126089636*^9}, 
   3.583576159980997*^9, 3.583576208488299*^9, 3.5835762422290297`*^9, {
   3.583576423518524*^9, 3.58357647496297*^9}, 3.583576583001253*^9, 
   3.583576722510169*^9, {3.5835767884854383`*^9, 3.5835768180090237`*^9}, {
   3.583576871937757*^9, 3.58357689138481*^9}, 3.583576923526576*^9, 
   3.583579748313477*^9, 3.5835798097222757`*^9, {3.583579888694195*^9, 
   3.583579916343989*^9}, 3.5835800361711884`*^9, 3.58358008521775*^9, 
   3.58358021625213*^9, 3.583580340775091*^9, {3.5835803932961187`*^9, 
   3.583580411690098*^9}, {3.5835805173749638`*^9, 3.583580664251988*^9}, 
   3.5835807375132017`*^9, 3.583580774985839*^9, 3.583580805147834*^9, 
   3.583580837619706*^9, 3.583581260033041*^9, 3.583637157547039*^9, 
   3.583673381485711*^9, 3.583758773653078*^9, 3.583760405358354*^9, 
   3.58376297593506*^9, 3.583763013499358*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Derive (5) from \>\"", ",", 
   RowBox[{"tmp", "=", "tmp4"}], ",", "\"\< with assumptions: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"sub", "=", 
    RowBox[{
     OverscriptBox["n", "\[RightVector]"], "->", 
     RowBox[{
      OverscriptBox["z", "^"], "+", 
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", "sub"}], "//", 
     RowBox[{"DerivativeExpand", "[", 
      RowBox[{"{", 
       OverscriptBox["z", "^"], "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<Using momentum representation: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"sub", "=", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}], "->", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           OverscriptBox["k", "\[RightVector]"], ".", 
           OverscriptBox["x", "\[RightVector]"]}], "-", 
          RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}], "]"}]}]}]}], ",", 
   "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", "sub"}], "//", 
     RowBox[{"DerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{
        OverscriptBox["z", "^"], ",", 
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ",", "\[Omega]", ",", 
        "t", ",", 
        OverscriptBox["k", "\[RightVector]"], ",", 
        OverscriptBox["_", "^"]}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp", "//.", 
       RowBox[{"simpleDot2", "[", 
        RowBox[{"{", "}"}], "]"}]}], "//.", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{
         OverscriptBox["x", "\[RightVector]"], ",", 
         RowBox[{"x", "@", 
          RowBox[{"u", "[", "l", "]"}]}]}], "]"}], "->", 
       OverscriptBox[
        RowBox[{"x", "@", 
         RowBox[{"u", "[", "l", "]"}]}], "^"]}]}], "//", 
     RowBox[{"DerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{
        OverscriptBox["z", "^"], ",", 
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ",", "\[Omega]", ",", 
        "t", ",", 
        OverscriptBox["k", "\[RightVector]"], ",", 
        OverscriptBox["_", "^"], ",", 
        OverscriptBox["x", "\[RightVector]"]}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "//.", 
        RowBox[{"simpleDot2", "[", 
         RowBox[{"{", "}"}], "]"}]}], "//", 
       RowBox[{"WedgeSimplify", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"Exp", "[", "_", "]"}]}], "}"}], "]"}]}], "//", 
      RowBox[{"simpleSum", "[", 
       RowBox[{"{", "l", "}"}], "]"}]}], "//", "Simplify"}]}], ",", 
   "\"\<PONdd\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", "2", " ", 
         RowBox[{"g", "^", "2"}]}], "/.", 
        RowBox[{
         RowBox[{"Exp", "[", "_", "]"}], "->", "1"}]}], "&"}], ",", "tmp"}], 
     "]"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", 
      RowBox[{
       RowBox[{"Wedge", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"\[Delta]", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}]}], "]"}], "->", 
       RowBox[{
        RowBox[{"\[Epsilon]", "@", 
         RowBox[{"ddd", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], 
        RowBox[{"a", "[", "k", "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"n", "@", 
          RowBox[{"u", "[", "j", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}], "->", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"n", "@", 
        RowBox[{"u", "[", "i", "]"}]}], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           OverscriptBox["z", "^"], "[", "k", "]"}], "->", 
          RowBox[{"\[Delta]", "@", 
           RowBox[{"dd", "[", 
            RowBox[{"k", ",", "3"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           OverscriptBox["k", "\[RightVector]"], ".", 
           OverscriptBox[
            RowBox[{"x", "@", 
             RowBox[{"u", "[", "l", "]"}]}], "^"]}], "->", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"k", ",", "\"\<u\>\""}], "]"}], "[", "l", "]"}]}]}], 
        "}"}]}], "//", 
      RowBox[{"Contract", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"{", "k", "}"}]}], "]"}]}], "//", "Simplify"}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The 2 cases for {i,j}: \>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "->", "1"}], ",", 
          RowBox[{"j", "->", "2"}]}], "}"}]}], ",", 
       RowBox[{"tmp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "->", "2"}], ",", 
          RowBox[{"j", "->", "1"}]}], "}"}]}]}], "}"}], "//", 
     RowBox[{"simplifyLeviCivita", "[", "4", "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<In 2D this can be put in matrix form for vector \>\"", ",", " ", 
   RowBox[{"tmpv", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"n", "@", 
        RowBox[{"u", "[", "1", "]"}]}], "]"}], ",", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"n", "@", 
        RowBox[{"u", "[", "2", "]"}]}], "]"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"tmpa", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{"Rule", "->", "Equal"}]}], ",", "tmpv"}], "]"}], "//", 
        "Normal"}], "//", "Last"}]}], ")"}], "//", "MatrixForms"}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The term \>\"", ",", 
   RowBox[{"sub", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"ExtractPattern", "[", 
         RowBox[{"tmpa", ",", 
          RowBox[{"a_", " ", 
           RowBox[{"xSum", "[", 
            RowBox[{"_", ",", "_"}], "]"}]}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "->", 
     RowBox[{"(", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"xSum", "[", "__", "]"}], "->", 
        RowBox[{"k", "^", "2"}]}]}], ")"}]}]}], ",", 
   "\"\< which is AZee's \>\"", ",", 
   RowBox[{
    RowBox[{"h", "[", "k", "]"}], "->", 
    RowBox[{"2", " ", "J", " ", 
     RowBox[{"a", "^", "2"}], " ", 
     RowBox[{"k", "^", "2"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"tmpa", "=", 
      RowBox[{"tmpa", "/.", "sub"}]}], ")"}], "//", "MatrixForms"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5835812637628307`*^9, 3.583581264781344*^9}, {
   3.583581356966864*^9, 3.58358143167305*^9}, {3.583581549561935*^9, 
   3.5835815729928913`*^9}, {3.583581644843745*^9, 3.583581659386403*^9}, {
   3.583581692160721*^9, 3.583581694008169*^9}, {3.583581745908326*^9, 
   3.5835818245982237`*^9}, {3.583581864700487*^9, 3.583581878636868*^9}, {
   3.583581916712791*^9, 3.583581993315687*^9}, {3.5835821235473843`*^9, 
   3.583582133801528*^9}, {3.583582165472951*^9, 3.5835821902690763`*^9}, {
   3.583582222861155*^9, 3.583582245058511*^9}, {3.583582313638173*^9, 
   3.583582318980595*^9}, 3.583582368455969*^9, {3.5835829529931803`*^9, 
   3.58358303848001*^9}, 3.5835830765631247`*^9, {3.583583210897127*^9, 
   3.583583268294057*^9}, {3.5835834585745363`*^9, 3.583583485798387*^9}, {
   3.583584287277877*^9, 3.583584349136395*^9}, {3.583584379418111*^9, 
   3.583584393303141*^9}, {3.583584448985651*^9, 3.583584560723126*^9}, {
   3.583592523951692*^9, 3.583592538958907*^9}, {3.583592571497673*^9, 
   3.583592716635685*^9}, {3.583592748103154*^9, 3.583592756975161*^9}, {
   3.583592800651143*^9, 3.583592834668209*^9}, {3.583592870137683*^9, 
   3.583592880352539*^9}, 3.583593406011731*^9, {3.58359503264466*^9, 
   3.583595102871619*^9}, {3.583595250608974*^9, 3.583595384565497*^9}, {
   3.58359558693573*^9, 3.583595714138165*^9}, {3.583595806288685*^9, 
   3.583595806591485*^9}, {3.583595903961443*^9, 3.583595957047291*^9}, {
   3.583596046874775*^9, 3.583596048855967*^9}, {3.5835961253561277`*^9, 
   3.58359612713759*^9}, {3.58359615830451*^9, 3.5835961616821632`*^9}, {
   3.5835961955497*^9, 3.583596197463579*^9}, {3.58359629593049*^9, 
   3.5835966991678047`*^9}, {3.583596754019918*^9, 3.583596774754253*^9}, {
   3.583596819731317*^9, 3.5835969530692263`*^9}, {3.5835970024343243`*^9, 
   3.583597014506*^9}, {3.58359706262219*^9, 3.5835970713842154`*^9}, {
   3.583597798507971*^9, 3.583597865893317*^9}, {3.5835979502591457`*^9, 
   3.583597988592404*^9}, {3.583598040027672*^9, 3.583598072667863*^9}, {
   3.583598219874844*^9, 3.583598228494035*^9}, {3.583598284571414*^9, 
   3.583598313353339*^9}, {3.583598362974625*^9, 3.58359836563842*^9}, {
   3.5835984596046867`*^9, 3.5835984709053593`*^9}, 3.5835985203096952`*^9, {
   3.583672834851182*^9, 3.5836728494363737`*^9}, {3.5836729087450533`*^9, 
   3.583672909520225*^9}, 3.5836730433910913`*^9, {3.5836735051042624`*^9, 
   3.5836735479721413`*^9}, {3.583673590146719*^9, 3.5836736045417356`*^9}, {
   3.583674303467334*^9, 3.583674343580309*^9}, {3.583676363766608*^9, 
   3.583676379732398*^9}, {3.5836765476005*^9, 3.583676552733942*^9}, {
   3.583676590972088*^9, 3.583676796874914*^9}, {3.583676831287449*^9, 
   3.583676899943075*^9}, {3.5836769453360786`*^9, 3.5836770548398733`*^9}, {
   3.5836770862599*^9, 3.583677133200205*^9}, {3.583677784100905*^9, 
   3.583677860387176*^9}, {3.583678205113923*^9, 3.583678360047029*^9}, {
   3.5836784997662373`*^9, 3.583678550411065*^9}, {3.583758401630048*^9, 
   3.5837584048985233`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Derive (5) from \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{
       OverscriptBox["n", "\[RightVector]"], "\[Wedge]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}]}], "-", 
     FractionBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}],
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{"-", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}],
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic], "]"}],
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             OverVector[$CellContext`n], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[-$CellContext`xPartialD[
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" with assumptions: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
    RowBox[{
     OverscriptBox["z", "^"], "+", 
     RowBox[{"\[Delta]", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           OverscriptBox["z", "^"], "\[Wedge]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             RowBox[{"\[Delta]", "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
            $CellContext`xPartialD[
             $CellContext`\[Delta][
              OverVector[$CellContext`n]], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           RowBox[{"\[Delta]", "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
          $CellContext`xPartialD[
           $CellContext`\[Delta][
            OverVector[$CellContext`n]], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}]}], "-", 
     FractionBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          RowBox[{"\[Delta]", "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
         $CellContext`xPartialD[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialD[
         $CellContext`\[Delta][
          OverVector[$CellContext`n]], $CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{"-", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              RowBox[{"\[Delta]", "[", 
               OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
             $CellContext`xPartialD[
              $CellContext`\[Delta][
               OverVector[$CellContext`n]], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic], "]"}],
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             $CellContext`\[Delta][
              OverVector[$CellContext`n]], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[-$CellContext`xPartialD[
           $CellContext`xPartialD[
            $CellContext`\[Delta][
             OverVector[$CellContext`n]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Using momentum representation: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     OverscriptBox["n", "\[RightVector]"], "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "t"}], " ", "\[Omega]"}], "+", 
         RowBox[{
          OverscriptBox["k", "\[RightVector]"], ".", 
          OverscriptBox["x", "\[RightVector]"]}]}], ")"}]}]], " ", 
     RowBox[{"\[Delta]", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n.......\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontSize->Larger,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
      RowBox[{
       OverscriptBox["z", "^"], "\[Wedge]", 
       RowBox[{"\[Delta]", "[", 
        OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              OverscriptBox["k", "\[RightVector]"], ".", 
              OverscriptBox[
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "^"]}], ")"}], "2"], "]"}],
          $CellContext`xSum[Dot[
             OverVector[$CellContext`k], 
             OverHat[
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              OverscriptBox["k", "\[RightVector]"], ".", 
              OverscriptBox[
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "^"]}], ")"}], "2"], "]"}],
          $CellContext`xSum[Dot[
             OverVector[$CellContext`k], 
             OverHat[
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["i",
          StripOnInput->False,
          ShowContents->False], "i"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        RowBox[{"i", "j", "k"}], 
        StyleBox[
         RowBox[{"i", "j", "k"}],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
        TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
         TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, \
$CellContext`k}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["j",
          StripOnInput->False,
          ShowContents->False], "j"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}], " ", 
      RowBox[{
       OverscriptBox["z", "^"], "[", "k", "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           TagBox[
            SuperscriptBox[
             RowBox[{"(", 
              InterpretationBox[
               SubsuperscriptBox["k", 
                StyleBox["l",
                 StripOnInput->False,
                 ShowContents->False], "l"],
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ")"}], "2"],
            DisplayForm], "]"}],
          $CellContext`xSum[
          TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
             TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["i",
          StripOnInput->False,
          ShowContents->False], "i"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        RowBox[{"i", "j", "3"}], 
        StyleBox[
         RowBox[{"i", "j", "3"}],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
        TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
         TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, 3}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["j",
          StripOnInput->False,
          ShowContents->False], "j"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The 2 cases for {i,j}: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Rule]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "-", 
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          TagBox[
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["k", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], "2"],
           DisplayForm], "]"}],
         $CellContext`xSum[
         TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
            TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}]}]}], ",", 
     RowBox[{"0", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "-", 
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          TagBox[
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["k", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], "2"],
           DisplayForm], "]"}],
         $CellContext`xSum[
         TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
            TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}]}]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"In 2D this can be put in matrix form for vector \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}], ",", 
     RowBox[{"\[Delta]", "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["c", "s", "2"], " ", 
          InterpretationBox[
           RowBox[{
            UnderscriptBox[
             UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
             TagBox[GridBox[{
                {
                 RowBox[{"{", "l", "}"}]}
               },
               DefaultBaseStyle->"Column",
               GridBoxAlignment->{"Columns" -> {{Left}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Column"]], "[", 
            TagBox[
             SuperscriptBox[
              RowBox[{"(", 
               InterpretationBox[
                SubsuperscriptBox["k", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], ")"}], "2"],
             DisplayForm], "]"}],
           $CellContext`xSum[
           TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
           Editable->False,
           SyntaxForm->Automatic]}]}], 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}]},
       {
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["c", "s", "2"], " ", 
          InterpretationBox[
           RowBox[{
            UnderscriptBox[
             UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
             TagBox[GridBox[{
                {
                 RowBox[{"{", "l", "}"}]}
               },
               DefaultBaseStyle->"Column",
               GridBoxAlignment->{"Columns" -> {{Left}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Column"]], "[", 
            TagBox[
             SuperscriptBox[
              RowBox[{"(", 
               InterpretationBox[
                SubsuperscriptBox["k", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], ")"}], "2"],
             DisplayForm], "]"}],
           $CellContext`xSum[
           TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
           Editable->False,
           SyntaxForm->Automatic]}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The term \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["c", "s", "2"], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
        TagBox[GridBox[{
           {
            RowBox[{"{", "l", "}"}]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       TagBox[
        SuperscriptBox[
         RowBox[{"(", 
          InterpretationBox[
           SubsuperscriptBox["k", 
            StyleBox["l",
             StripOnInput->False,
             ShowContents->False], "l"],
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ")"}], "2"],
        DisplayForm], "]"}],
      $CellContext`xSum[
      TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
         TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
      Editable->False,
      SyntaxForm->Automatic]}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["k", "2"], " ", 
     SubsuperscriptBox["c", "s", "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" which is AZee's \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"h", "[", "k", "]"}], "\[Rule]", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"], " ", "J", " ", 
     SuperscriptBox["k", "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          SubsuperscriptBox["c", "s", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}]},
       {
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          SubsuperscriptBox["c", "s", "2"]}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Style["Derive (5) from ", 
    RGBColor[0, 0, 1], Larger], 0 -> Rational[-1, 2] Wedge[
       OverVector[$CellContext`n], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]] + (
      Rational[-1, 2] $CellContext`g^(-2)) $CellContext`xPartialD[
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t], $CellContext`t] + ((
       Rational[-1, 2] $CellContext`g^(-2)) 
      Subscript[$CellContext`c, $CellContext`s]^2) \
$CellContext`xSum[-$CellContext`xPartialD[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]], {$CellContext`l}], 
   Style[" with assumptions: ", 
    RGBColor[0, 0, 1], Larger], OverVector[$CellContext`n] -> 
   OverHat[$CellContext`z] + $CellContext`\[Delta][
      OverVector[$CellContext`n]], 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 0 -> Rational[1, 2] (-Wedge[
         OverHat[$CellContext`z], 
         $CellContext`xPartialD[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], $CellContext`t]] - Wedge[
       $CellContext`\[Delta][
        OverVector[$CellContext`n]], 
       $CellContext`xPartialD[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], $CellContext`t]]) + (
      Rational[-1, 2] $CellContext`g^(-2)) $CellContext`xPartialD[
       $CellContext`xPartialD[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], $CellContext`t], $CellContext`t] + ((
       Rational[-1, 2] $CellContext`g^(-2)) 
      Subscript[$CellContext`c, $CellContext`s]^2) \
$CellContext`xSum[-$CellContext`xPartialD[
         $CellContext`xPartialD[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]], {$CellContext`l}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Using momentum representation: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[Delta][
     OverVector[$CellContext`n]] -> 
   E^(Complex[0, 1] ((-$CellContext`t) $CellContext`\[Omega] + Dot[
         OverVector[$CellContext`k], 
         OverVector[$CellContext`x]])) $CellContext`\[Delta][
      OverVector[$CellContext`n]], 
   Style["\n.......", 
    RGBColor[1, 0, 0], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ((Complex[0, 1] $CellContext`g^2) $CellContext`\[Omega]) Wedge[
       OverHat[$CellContext`z], 
       $CellContext`\[Delta][
        OverVector[$CellContext`n]]] + ($CellContext`\[Omega]^2 - 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[Dot[
          OverVector[$CellContext`k], 
          OverHat[
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}]) $CellContext`\
\[Delta][
       OverVector[$CellContext`n]], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Omega]^2 - 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[Dot[
          OverVector[$CellContext`k], 
          OverHat[
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}]) $CellContext`\
\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
        TensorCalculus5`Tensorial`Void}]] + ((((
         Complex[0, 1] $CellContext`g^2) $CellContext`\[Omega]) 
       TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, \
$CellContext`k}]) $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
         TensorCalculus5`Tensorial`Void}]]) 
     OverHat[$CellContext`z][$CellContext`k], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Omega]^2 - 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
       TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}]) \
$CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
        TensorCalculus5`Tensorial`Void}]] + (((
        Complex[0, 1] $CellContext`g^2) $CellContext`\[Omega]) 
      TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
        TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
         TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, 
         3}]) $CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
        TensorCalculus5`Tensorial`Void}]], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The 2 cases for {i,j}: ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], {
   0 -> $CellContext`\[Omega]^2 $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
         TensorCalculus5`Tensorial`Void}]] - (
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
       TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}]) \
$CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}]] + ((
        Complex[0, 
          1] $CellContext`g^2) $CellContext`\[Omega]) $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
         TensorCalculus5`Tensorial`Void}]], 
    0 -> ((Complex[
         0, -1] $CellContext`g^2) $CellContext`\[Omega]) $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
         TensorCalculus5`Tensorial`Void}]] + $CellContext`\[Omega]^2 \
$CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
         TensorCalculus5`Tensorial`Void}]] - (
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
       TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}]) \
$CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}]]}, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["In 2D this can be put in matrix form for vector ", 
    RGBColor[0, 0, 1], Larger], {
    $CellContext`\[Delta][
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
      TensorCalculus5`Tensorial`Void}]], 
    $CellContext`\[Delta][
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
      TensorCalculus5`Tensorial`Void}]]}, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   MatrixForm[{{-$CellContext`\[Omega]^2 + 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
        TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}], (
       Complex[0, -1] $CellContext`g^2) $CellContext`\[Omega]}, {(
       Complex[0, 
         1] $CellContext`g^2) $CellContext`\[Omega], -$CellContext`\[Omega]^2 + 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
        TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}]}}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The term ", 
    RGBColor[0, 0, 1], Larger], 
   Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
     TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
        TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}] -> \
$CellContext`k^2 Subscript[$CellContext`c, $CellContext`s]^2, 
   Style[" which is AZee's ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`h[$CellContext`k] -> ((
      2 $CellContext`a^2) $CellContext`J) $CellContext`k^2, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   MatrixForm[{{-$CellContext`\[Omega]^2 + $CellContext`k^2 
       Subscript[$CellContext`c, $CellContext`s]^2, (
       Complex[0, -1] $CellContext`g^2) $CellContext`\[Omega]}, {(
       Complex[0, 
         1] $CellContext`g^2) $CellContext`\[Omega], -$CellContext`\[Omega]^2 + \
$CellContext`k^2 Subscript[$CellContext`c, $CellContext`s]^2}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5836743447863398`*^9, 3.583676384015682*^9, {3.583676549111575*^9, 
   3.5836765536511993`*^9}, {3.583676729003112*^9, 3.583676770275899*^9}, {
   3.583676866697666*^9, 3.583676901243849*^9}, {3.583676955557871*^9, 
   3.583677056301168*^9}, {3.5836771114985456`*^9, 3.583677134803149*^9}, 
   3.5836777878106413`*^9, {3.583677850022522*^9, 3.5836778624997463`*^9}, 
   3.583678220996735*^9, {3.583678268395666*^9, 3.583678289424477*^9}, {
   3.583678348845482*^9, 3.583678360953884*^9}, {3.58367851156773*^9, 
   3.583678551687462*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Apparently the Det[]->0 of this is related to the dispersion relation: \
\>\"", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"Det", "[", "tmpa", "]"}], "->", "0"}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Taking \>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]", "\[LessLess]", "1"}], ",", 
     RowBox[{"k", "\[LessLess]", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"tmp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Omega]", "^", "4"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "^", "2"}], 
         RowBox[{"\[Omega]", "^", "2"}]}], "->", "0"}]}], "}"}]}]}], ",", 
   "\[IndentingNewLine]", "imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"xRuleX", "[", 
     RowBox[{"tmp", ",", "\[Omega]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.583678513950173*^9, 3.583678514260297*^9}, {
  3.583678561411262*^9, 3.583678763053235*^9}, {3.583678803536449*^9, 
  3.583678904745674*^9}, {3.5836789372277822`*^9, 3.583678938570363*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Apparently the Det[]->0 of this is related to the dispersion \
relation: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["g", "4"]}], " ", 
      SuperscriptBox["\[Omega]", "2"]}], "+", 
     SuperscriptBox["\[Omega]", "4"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["k", "2"], " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SubsuperscriptBox["c", "s", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["k", "4"], " ", 
      SubsuperscriptBox["c", "s", "4"]}]}], "\[Rule]", "0"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Taking \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]", "\[LessLess]", "1"}], ",", 
     RowBox[{"k", "\[LessLess]", "1"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["g", "4"]}], " ", 
      SuperscriptBox["\[Omega]", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["k", "4"], " ", 
      SubsuperscriptBox["c", "s", "4"]}]}], "\[Rule]", "0"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["k", "2"], " ", 
         SubsuperscriptBox["c", "s", "2"]}], 
        SuperscriptBox["g", "2"]]}]}], ",", 
     RowBox[{"\[Omega]", "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        SubsuperscriptBox["c", "s", "2"]}], 
       SuperscriptBox["g", "2"]]}]}], "}"}]}],
  SequenceForm[
   Style["Apparently the Det[]->0 of this is related to the dispersion \
relation: ", 
    RGBColor[0, 0, 1], 
    Larger], -$CellContext`g^4 $CellContext`\[Omega]^2 + \
$CellContext`\[Omega]^4 - 2 $CellContext`k^2 $CellContext`\[Omega]^2 
    Subscript[$CellContext`c, $CellContext`s]^2 + $CellContext`k^4 
     Subscript[$CellContext`c, $CellContext`s]^4 -> 0, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Taking ", 
    RGBColor[0, 0, 1], Larger], {
    LessLess[$CellContext`\[Omega], 1], 
    LessLess[$CellContext`k, 1]}, 
   Style[" \[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], -$CellContext`g^4 $CellContext`\[Omega]^2 + $CellContext`k^4 
     Subscript[$CellContext`c, $CellContext`s]^4 -> 0, 
   Style[" \[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], {$CellContext`\[Omega] -> -$CellContext`g^(-2) $CellContext`k^2 
     Subscript[$CellContext`c, $CellContext`s]^2, $CellContext`\[Omega] -> \
$CellContext`g^(-2) $CellContext`k^2 
     Subscript[$CellContext`c, $CellContext`s]^2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.583678604737692*^9, 3.583678692329796*^9, {3.583678728330974*^9, 
   3.583678763819528*^9}, {3.583678846338276*^9, 3.583678866131227*^9}, 
   3.5836789400836897`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Recalculate the antiferromagnet case: \>\"", ",", 
   "\[IndentingNewLine]", "\"\<Derive (5) from \>\"", ",", 
   RowBox[{"tmp", "=", "tmp4"}], ",", 
   "\"\< with assumptions(j on n implicit): \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"sub", "=", 
    RowBox[{
     OverscriptBox["n", "\[RightVector]"], "->", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "j"}], "  ", 
       OverscriptBox["z", "^"]}], "+", 
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", "sub"}], "//", 
     RowBox[{"DerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{
        OverscriptBox["z", "^"], ",", 
        RowBox[{"_", "^", "j"}]}], "}"}], "]"}]}]}], ",", "CK", ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<Using momentum representation: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"sub", "=", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}], "->", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           OverscriptBox["k", "\[RightVector]"], ".", 
           OverscriptBox["x", "\[RightVector]"]}], "-", 
          RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}], "]"}]}]}]}], ",", 
   "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", "sub"}], "//", 
     RowBox[{"DerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{
        OverscriptBox["z", "^"], ",", 
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ",", "\[Omega]", ",", 
        "t", ",", 
        OverscriptBox["k", "\[RightVector]"], ",", 
        OverscriptBox["_", "^"], ",", 
        RowBox[{"_", "^", "j"}]}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp", "//.", 
       RowBox[{"simpleDot2", "[", 
        RowBox[{"{", 
         RowBox[{"_", "^", "j"}], "}"}], "]"}]}], "//.", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{
         OverscriptBox["x", "\[RightVector]"], ",", 
         RowBox[{"x", "@", 
          RowBox[{"u", "[", "l", "]"}]}]}], "]"}], "->", 
       OverscriptBox[
        RowBox[{"x", "@", 
         RowBox[{"u", "[", "l", "]"}]}], "^"]}]}], "//", 
     RowBox[{"DerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{
        OverscriptBox["z", "^"], ",", 
        RowBox[{"\[Delta]", "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}], ",", "\[Omega]", ",", 
        "t", ",", 
        OverscriptBox["k", "\[RightVector]"], ",", 
        OverscriptBox["_", "^"], ",", 
        OverscriptBox["x", "\[RightVector]"]}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "//.", 
        RowBox[{"simpleDot2", "[", 
         RowBox[{"{", "}"}], "]"}]}], "//", 
       RowBox[{"WedgeSimplify", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"Exp", "[", "_", "]"}], ",", 
          RowBox[{"_", "^", "j"}]}], "}"}], "]"}]}], "//", 
      RowBox[{"simpleSum", "[", 
       RowBox[{"{", "l", "}"}], "]"}]}], "//", "Simplify"}]}], ",", 
   "\"\<PONdd\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", "2", " ", 
         RowBox[{"g", "^", "2"}]}], "/.", 
        RowBox[{
         RowBox[{"Exp", "[", "_", "]"}], "->", "1"}]}], "&"}], ",", "tmp"}], 
     "]"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"tmp", "/.", 
      RowBox[{
       RowBox[{"Wedge", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"\[Delta]", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}]}], "]"}], "->", 
       RowBox[{
        RowBox[{"\[Epsilon]", "@", 
         RowBox[{"ddd", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], 
        RowBox[{"a", "[", "k", "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"n", "@", 
          RowBox[{"u", "[", "j", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}], "->", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"n", "@", 
        RowBox[{"u", "[", "i", "]"}]}], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           OverscriptBox["z", "^"], "[", "k", "]"}], "->", 
          RowBox[{"\[Delta]", "@", 
           RowBox[{"dd", "[", 
            RowBox[{"k", ",", "3"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           OverscriptBox["k", "\[RightVector]"], ".", 
           OverscriptBox[
            RowBox[{"x", "@", 
             RowBox[{"u", "[", "l", "]"}]}], "^"]}], "->", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"k", ",", "\"\<u\>\""}], "]"}], "[", "l", "]"}]}]}], 
        "}"}]}], "//", 
      RowBox[{"Contract", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"{", "k", "}"}]}], "]"}]}], "//", "Simplify"}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The 2 cases for {i,j}: \>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"tmp", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "->", "1"}], ",", 
          RowBox[{"j", "->", "2"}]}], "}"}]}], ",", 
       RowBox[{"tmp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "->", "2"}], ",", 
          RowBox[{"j", "->", "1"}]}], "}"}]}]}], "}"}], "//", 
     RowBox[{"simplifyLeviCivita", "[", "4", "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<In 2D this can be put in matrix form for vector \>\"", ",", " ", 
   RowBox[{"tmpv", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"n", "@", 
        RowBox[{"u", "[", "1", "]"}]}], "]"}], ",", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"n", "@", 
        RowBox[{"u", "[", "2", "]"}]}], "]"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"tmpa", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{"Rule", "->", "Equal"}]}], ",", "tmpv"}], "]"}], "//", 
        "Normal"}], "//", "Last"}]}], ")"}], "//", "MatrixForms"}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The term \>\"", ",", 
   RowBox[{"sub", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"ExtractPattern", "[", 
         RowBox[{"tmpa", ",", 
          RowBox[{"a_", " ", 
           RowBox[{"xSum", "[", 
            RowBox[{"_", ",", "_"}], "]"}]}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "->", 
     RowBox[{"(", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"xSum", "[", "__", "]"}], "->", 
        RowBox[{"k", "^", "2"}]}]}], ")"}]}]}], ",", 
   "\"\< which is AZee's \>\"", ",", 
   RowBox[{
    RowBox[{"h", "[", "k", "]"}], "->", 
    RowBox[{"2", " ", "J", " ", 
     RowBox[{"a", "^", "2"}], " ", 
     RowBox[{"k", "^", "2"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"tmpa", "=", 
      RowBox[{"tmpa", "/.", "sub"}]}], ")"}], "//", "MatrixForms"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.583679245757042*^9, 3.5836793473068237`*^9}, {
  3.583679395306286*^9, 3.5836794214337893`*^9}, {3.583679497415203*^9, 
  3.583679498679002*^9}, {3.583679530333037*^9, 3.583679553816064*^9}, {
  3.5836796090066357`*^9, 3.583679619485979*^9}, {3.583679717930435*^9, 
  3.5836797254267597`*^9}, {3.583717404643271*^9, 3.583717460137267*^9}, {
  3.583717493550337*^9, 3.583717518564328*^9}, {3.5837176017582693`*^9, 
  3.583717604806835*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Recalculate the antiferromagnet case: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Derive (5) from \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{
       OverscriptBox["n", "\[RightVector]"], "\[Wedge]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}]}], "-", 
     FractionBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}],
         $CellContext`xPartialD[
          OverVector[$CellContext`n], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{"-", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}],
             $CellContext`xPartialD[
              OverVector[$CellContext`n], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic], "]"}],
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             OverVector[$CellContext`n], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[-$CellContext`xPartialD[
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" with assumptions(j on n implicit): \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "j"], " ", 
      OverscriptBox["z", "^"]}], "+", 
     RowBox[{"\[Delta]", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "j"], " ", 
             OverscriptBox["z", "^"]}], ")"}], "\[Wedge]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             RowBox[{"\[Delta]", "[", 
              OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
            $CellContext`xPartialD[
             $CellContext`\[Delta][
              OverVector[$CellContext`n]], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           RowBox[{"\[Delta]", "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
          $CellContext`xPartialD[
           $CellContext`\[Delta][
            OverVector[$CellContext`n]], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}]}], "-", 
     FractionBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          RowBox[{"\[Delta]", "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
         $CellContext`xPartialD[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialD[
         $CellContext`\[Delta][
          OverVector[$CellContext`n]], $CellContext`t], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{"-", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]], "[", 
              RowBox[{"\[Delta]", "[", 
               OverscriptBox["n", "\[RightVector]"], "]"}], "]"}],
             $CellContext`xPartialD[
              $CellContext`\[Delta][
               OverVector[$CellContext`n]], 
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
             Editable->False,
             SyntaxForm->Automatic], "]"}],
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             $CellContext`\[Delta][
              OverVector[$CellContext`n]], 
             
             TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[-$CellContext`xPartialD[
           $CellContext`xPartialD[
            $CellContext`\[Delta][
             OverVector[$CellContext`n]], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["g", "2"]}]]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\[LongLeftArrow]CHECK\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontSize->Larger,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Using momentum representation: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     OverscriptBox["n", "\[RightVector]"], "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "t"}], " ", "\[Omega]"}], "+", 
         RowBox[{
          OverscriptBox["k", "\[RightVector]"], ".", 
          OverscriptBox["x", "\[RightVector]"]}]}], ")"}]}]], " ", 
     RowBox[{"\[Delta]", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n.......\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontSize->Larger,
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "j"], " ", 
      SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
      RowBox[{
       OverscriptBox["z", "^"], "\[Wedge]", 
       RowBox[{"\[Delta]", "[", 
        OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              OverscriptBox["k", "\[RightVector]"], ".", 
              OverscriptBox[
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "^"]}], ")"}], "2"], "]"}],
          $CellContext`xSum[Dot[
             OverVector[$CellContext`k], 
             OverHat[
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"\[Delta]", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              OverscriptBox["k", "\[RightVector]"], ".", 
              OverscriptBox[
               InterpretationBox[
                SubsuperscriptBox["x", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "^"]}], ")"}], "2"], "]"}],
          $CellContext`xSum[Dot[
             OverVector[$CellContext`k], 
             OverHat[
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["i",
          StripOnInput->False,
          ShowContents->False], "i"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "j"], " ", 
      SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        RowBox[{"i", "j", "k"}], 
        StyleBox[
         RowBox[{"i", "j", "k"}],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
        TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
         TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, \
$CellContext`k}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["j",
          StripOnInput->False,
          ShowContents->False], "j"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}], " ", 
      RowBox[{
       OverscriptBox["z", "^"], "[", "k", "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], "-", 
        RowBox[{
         SubsuperscriptBox["c", "s", "2"], " ", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {
                RowBox[{"{", "l", "}"}]}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           TagBox[
            SuperscriptBox[
             RowBox[{"(", 
              InterpretationBox[
               SubsuperscriptBox["k", 
                StyleBox["l",
                 StripOnInput->False,
                 ShowContents->False], "l"],
               
               TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ")"}], "2"],
            DisplayForm], "]"}],
          $CellContext`xSum[
          TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
             TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["i",
          StripOnInput->False,
          ShowContents->False], "i"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "j"], " ", 
      SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        RowBox[{"i", "j", "3"}], 
        StyleBox[
         RowBox[{"i", "j", "3"}],
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
        TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
         TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, 3}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      RowBox[{"\[Delta]", "[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["j",
          StripOnInput->False,
          ShowContents->False], "j"],
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The 2 cases for {i,j}: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Rule]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "-", 
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          TagBox[
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["k", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], "2"],
           DisplayForm], "]"}],
         $CellContext`xSum[
         TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
            TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}]}]}], ",", 
     RowBox[{"0", "\[Rule]", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["g", "2"], " ", "\[Omega]", " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}], "-", 
       RowBox[{
        SubsuperscriptBox["c", "s", "2"], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {
               RowBox[{"{", "l", "}"}]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          TagBox[
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["k", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], "2"],
           DisplayForm], "]"}],
         $CellContext`xSum[
         TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
            TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        RowBox[{"\[Delta]", "[", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
           TensorCalculus5`Tensorial`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}]}]}]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"In 2D this can be put in matrix form for vector \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}], ",", 
     RowBox[{"\[Delta]", "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["c", "s", "2"], " ", 
          InterpretationBox[
           RowBox[{
            UnderscriptBox[
             UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
             TagBox[GridBox[{
                {
                 RowBox[{"{", "l", "}"}]}
               },
               DefaultBaseStyle->"Column",
               GridBoxAlignment->{"Columns" -> {{Left}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Column"]], "[", 
            TagBox[
             SuperscriptBox[
              RowBox[{"(", 
               InterpretationBox[
                SubsuperscriptBox["k", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], ")"}], "2"],
             DisplayForm], "]"}],
           $CellContext`xSum[
           TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
           Editable->False,
           SyntaxForm->Automatic]}]}], 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}]},
       {
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["c", "s", "2"], " ", 
          InterpretationBox[
           RowBox[{
            UnderscriptBox[
             UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
             TagBox[GridBox[{
                {
                 RowBox[{"{", "l", "}"}]}
               },
               DefaultBaseStyle->"Column",
               GridBoxAlignment->{"Columns" -> {{Left}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Column"]], "[", 
            TagBox[
             SuperscriptBox[
              RowBox[{"(", 
               InterpretationBox[
                SubsuperscriptBox["k", 
                 StyleBox["l",
                  StripOnInput->False,
                  ShowContents->False], "l"],
                
                TensorCalculus5`Tensorial`Tensor[$CellContext`k, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], ")"}], "2"],
             DisplayForm], "]"}],
           $CellContext`xSum[
           TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
           Editable->False,
           SyntaxForm->Automatic]}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The term \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["c", "s", "2"], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
        TagBox[GridBox[{
           {
            RowBox[{"{", "l", "}"}]}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       TagBox[
        SuperscriptBox[
         RowBox[{"(", 
          InterpretationBox[
           SubsuperscriptBox["k", 
            StyleBox["l",
             StripOnInput->False,
             ShowContents->False], "l"],
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ")"}], "2"],
        DisplayForm], "]"}],
      $CellContext`xSum[
      TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
         TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}],
      Editable->False,
      SyntaxForm->Automatic]}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["k", "2"], " ", 
     SubsuperscriptBox["c", "s", "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" which is AZee's \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"h", "[", "k", "]"}], "\[Rule]", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"], " ", "J", " ", 
     SuperscriptBox["k", "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          SubsuperscriptBox["c", "s", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}]},
       {
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SuperscriptBox["g", "2"], " ", "\[Omega]"}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Omega]", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          SubsuperscriptBox["c", "s", "2"]}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Style["Recalculate the antiferromagnet case: ", 
    RGBColor[0, 0, 1], Larger], 
   Style["Derive (5) from ", 
    RGBColor[0, 0, 1], Larger], 0 -> Rational[-1, 2] Wedge[
       OverVector[$CellContext`n], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]] + 
    Rational[-1, 2] $CellContext`g^(-2) $CellContext`xPartialD[
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t], $CellContext`t] + 
    Rational[-1, 2] $CellContext`g^(-2) 
     Subscript[$CellContext`c, $CellContext`s]^2 \
$CellContext`xSum[-$CellContext`xPartialD[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]], {$CellContext`l}], 
   Style[" with assumptions(j on n implicit): ", 
    RGBColor[0, 0, 1], Larger], 
   OverVector[$CellContext`n] -> (-1)^$CellContext`j 
     OverHat[$CellContext`z] + $CellContext`\[Delta][
      OverVector[$CellContext`n]], 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 0 -> 
   Rational[1, 2] (-Wedge[(-1)^$CellContext`j OverHat[$CellContext`z], 
         $CellContext`xPartialD[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], $CellContext`t]] - Wedge[
       $CellContext`\[Delta][
        OverVector[$CellContext`n]], 
       $CellContext`xPartialD[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], $CellContext`t]]) + 
    Rational[-1, 2] $CellContext`g^(-2) $CellContext`xPartialD[
       $CellContext`xPartialD[
        $CellContext`\[Delta][
         OverVector[$CellContext`n]], $CellContext`t], $CellContext`t] + 
    Rational[-1, 2] $CellContext`g^(-2) 
     Subscript[$CellContext`c, $CellContext`s]^2 \
$CellContext`xSum[-$CellContext`xPartialD[
         $CellContext`xPartialD[
          $CellContext`\[Delta][
           OverVector[$CellContext`n]], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]], {$CellContext`l}], 
   Style["\[LongLeftArrow]CHECK", 
    RGBColor[1, 0, 0], Larger], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Using momentum representation: ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[Delta][
     OverVector[$CellContext`n]] -> 
   E^(Complex[0, 1] (-$CellContext`t $CellContext`\[Omega] + Dot[
         OverVector[$CellContext`k], 
         OverVector[$CellContext`x]])) $CellContext`\[Delta][
      OverVector[$CellContext`n]], 
   Style["\n.......", 
    RGBColor[1, 0, 0], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 0 -> 
   Complex[0, 1] (-1)^$CellContext`j $CellContext`g^2 $CellContext`\[Omega] 
     Wedge[
       OverHat[$CellContext`z], 
       $CellContext`\[Delta][
        OverVector[$CellContext`n]]] + ($CellContext`\[Omega]^2 - 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[Dot[
          OverVector[$CellContext`k], 
          OverHat[
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}]) $CellContext`\
\[Delta][
       OverVector[$CellContext`n]], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Omega]^2 - 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[Dot[
          OverVector[$CellContext`k], 
          OverHat[
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]]^2, {$CellContext`l}]) $CellContext`\
\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
        TensorCalculus5`Tensorial`Void}]] + 
    Complex[0, 1] (-1)^$CellContext`j $CellContext`g^2 $CellContext`\[Omega] 
     TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
       TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
        TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, \
$CellContext`k}] $CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
        TensorCalculus5`Tensorial`Void}]] 
     OverHat[$CellContext`z][$CellContext`k], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   0 -> ($CellContext`\[Omega]^2 - 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
       TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}]) \
$CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`i}, {
        TensorCalculus5`Tensorial`Void}]] + 
    Complex[0, 1] (-1)^$CellContext`j $CellContext`g^2 $CellContext`\[Omega] 
     TensorCalculus5`Tensorial`Tensor[$CellContext`\[Epsilon], {
       TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
        TensorCalculus5`Tensorial`Void}, {$CellContext`i, $CellContext`j, 
        3}] $CellContext`\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {$CellContext`j}, {
        TensorCalculus5`Tensorial`Void}]], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The 2 cases for {i,j}: ", 
    RGBColor[0, 0, 1], Larger], 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], {
   0 -> $CellContext`\[Omega]^2 $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
         TensorCalculus5`Tensorial`Void}]] - 
     Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
      TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
         TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}] $CellContext`\
\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
        TensorCalculus5`Tensorial`Void}]] + 
     Complex[0, 
        1] $CellContext`g^2 $CellContext`\[Omega] $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
         TensorCalculus5`Tensorial`Void}]], 0 -> 
    Complex[0, 1] $CellContext`g^2 $CellContext`\[Omega] $CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
         TensorCalculus5`Tensorial`Void}]] + $CellContext`\[Omega]^2 \
$CellContext`\[Delta][
        TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
         TensorCalculus5`Tensorial`Void}]] - 
     Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
      TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
         TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}] $CellContext`\
\[Delta][
       TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
        TensorCalculus5`Tensorial`Void}]]}, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["In 2D this can be put in matrix form for vector ", 
    RGBColor[0, 0, 1], Larger], {
    $CellContext`\[Delta][
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {1}, {
      TensorCalculus5`Tensorial`Void}]], 
    $CellContext`\[Delta][
     TensorCalculus5`Tensorial`Tensor[$CellContext`n, {2}, {
      TensorCalculus5`Tensorial`Void}]]}, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   MatrixForm[{{-$CellContext`\[Omega]^2 + 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
        TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}], 
      Complex[0, -1] $CellContext`g^2 $CellContext`\[Omega]}, {
     Complex[0, -1] $CellContext`g^2 $CellContext`\[Omega], -$CellContext`\
\[Omega]^2 + 
      Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
        TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}]}}], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The term ", 
    RGBColor[0, 0, 1], Larger], 
   Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
     TensorCalculus5`Tensorial`Tensor[$CellContext`k, {$CellContext`l}, {
        TensorCalculus5`Tensorial`Void}]^2, {$CellContext`l}] -> \
$CellContext`k^2 Subscript[$CellContext`c, $CellContext`s]^2, 
   Style[" which is AZee's ", 
    RGBColor[0, 0, 1], Larger], $CellContext`h[$CellContext`k] -> 
   2 $CellContext`a^2 $CellContext`J $CellContext`k^2, 
   Style["\n\[RightArrow] ", 
    RGBColor[0, 0, 1], Larger], 
   MatrixForm[{{-$CellContext`\[Omega]^2 + $CellContext`k^2 
       Subscript[$CellContext`c, $CellContext`s]^2, 
      Complex[0, -1] $CellContext`g^2 $CellContext`\[Omega]}, {
     Complex[0, -1] $CellContext`g^2 $CellContext`\[Omega], -$CellContext`\
\[Omega]^2 + $CellContext`k^2 Subscript[$CellContext`c, $CellContext`s]^2}}]],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.583679422906158*^9, 3.583679500399481*^9, {3.583679533817773*^9, 
   3.58367955634249*^9}, 3.583679621398539*^9, 3.583679726717217*^9, 
   3.583717419484585*^9, 3.583717462557019*^9, {3.58371750057066*^9, 
   3.5837175204614153`*^9}, 3.5837176061203814`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{
    "CO", "[", 
     "\"\<VI.5.1: Work out the two branches of the spin wave spectrum in the \
ferromagnetic case, paying particular attend to the polarization.\>\"", "]"}],
     ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Calculate eigenvalues of \>\"", ",", 
    RowBox[{"tmpH", "=", 
     RowBox[{"\[ScriptCapitalH]", "->", 
      RowBox[{
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{
          OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}], ".", 
        RowBox[{"xPartialD", "[", 
         RowBox[{"\[ScriptCapitalL]", ",", 
          RowBox[{"xPartialD", "[", 
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}]}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"z", ",", "t"}], "]"}], 
        RowBox[{"xPartialD", "[", 
         RowBox[{"\[ScriptCapitalL]", ",", 
          RowBox[{"xPartialD", "[", 
           RowBox[{"z", ",", "t"}], "]"}]}], "]"}]}], "-", 
       "\[ScriptCapitalL]"}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<where \>\"", ",", 
    RowBox[{"tmpL", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"e2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"e2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tmpp", "/.", 
            RowBox[{"Dot", "->", "Times"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"g", "^", "2"}]}], ")"}]}]}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{"a_", ",", "j"}], "]"}], "->", "a"}], "}"}]}], "//", 
      "Simplify"}]}], ",", "\[IndentingNewLine]", "Imply", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"tmpH", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "->", 
      RowBox[{"Hamiltonian", "[", 
       RowBox[{
        RowBox[{"tmpL", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xPartialD", "[", 
           RowBox[{"z", ",", "t"}], "]"}], ",", 
          RowBox[{"xPartialD", "[", 
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], ",", "t"}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"g", ",", 
          SubscriptBox["c", "s"]}], "}"}]}], "]"}]}], "/.", 
     RowBox[{"simpleDot2", "[", 
      RowBox[{"{", 
       RowBox[{"ConjugateTranspose", "[", "z", "]"}], "}"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<The Berry phase term \>\"", ",", 
    RowBox[{"tmp", "=", 
     RowBox[{"ExtractPattern", "[", 
      RowBox[{"tmpL", ",", 
       RowBox[{"__", " ", 
        RowBox[{"ConjugateTranspose", "[", "z", "]"}]}]}], "]"}]}], ",", 
    "\"\< does not contribute to the Hamiltonian.\>\""}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.583717058404662*^9, 3.583717122690653*^9}, {
   3.583761845174551*^9, 3.583761947959055*^9}, {3.583762149146324*^9, 
   3.583762290070373*^9}, {3.5837623212837467`*^9, 3.583762325116045*^9}, {
   3.5837625360963297`*^9, 3.58376254575089*^9}, {3.5837626167617493`*^9, 
   3.583762625880857*^9}, {3.583762660854294*^9, 3.583762679562665*^9}, {
   3.583763087447403*^9, 3.58376310063708*^9}, {3.583763132227778*^9, 
   3.583763135682706*^9}, {3.583769313793144*^9, 3.5837693504477873`*^9}, {
   3.5837780355062*^9, 3.583778045544839*^9}, {3.583778099565118*^9, 
   3.583778162230482*^9}, 3.583778196527279*^9, {3.583778236851501*^9, 
   3.5837782497033*^9}, {3.583779377604909*^9, 3.5837795002782087`*^9}, {
   3.583779660322647*^9, 3.5837796731297503`*^9}, {3.5837825244180403`*^9, 
   3.583782612262946*^9}, 3.583782654964045*^9, {3.583782700153167*^9, 
   3.58378270911407*^9}, {3.583782744934944*^9, 3.5837827464135513`*^9}, {
   3.583782789459984*^9, 3.583782791108905*^9}, {3.583782857030761*^9, 
   3.583782942080611*^9}, {3.583782991132965*^9, 3.583782993052475*^9}, {
   3.583842262433435*^9, 3.583842287631879*^9}, {3.5838423231254168`*^9, 
   3.583842332773151*^9}, {3.583842364979679*^9, 3.583842374412486*^9}, {
   3.583842407288126*^9, 3.5838424168219137`*^9}, 3.583842824945568*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"VI.5.1: Work out the two branches of the spin wave spectrum \
in the ferromagnetic case, paying particular attend to the polarization.\"\>",
    
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontSize->Larger,
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Calculate eigenvalues of \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"\[ScriptCapitalH]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ScriptCapitalL]"}], "+", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        OverscriptBox["n", "\[RightVector]"], "]"}],
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           OverscriptBox["n", "\[RightVector]"], "]"}],
          $CellContext`xPartialD[
           OverVector[$CellContext`n], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]], "[", "\[ScriptCapitalL]", "]"}],
       $CellContext`xPartialD[$CellContext`\[ScriptCapitalL], 
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t]],
       Editable->False,
       SyntaxForm->Automatic]}], "+", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
       $CellContext`xPartialD[$CellContext`z, $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", 
           "]"}],
          $CellContext`xPartialD[$CellContext`z, $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]], "[", "\[ScriptCapitalL]", "]"}],
       $CellContext`xPartialD[$CellContext`\[ScriptCapitalL], 
        $CellContext`xPartialD[$CellContext`z, $CellContext`t]],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"where \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"\[ScriptCapitalL]", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       InterpretationBox[
        SuperscriptBox["z", "\[Dagger]"],
        ConjugateTranspose[$CellContext`z],
        Editable->False,
        SyntaxForm->Automatic], " ", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
        $CellContext`xPartialD[$CellContext`z, $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], "-", 
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic], ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[
         Dot[
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], 
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["g", "2"]}]]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"\[ScriptCapitalH]", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         OverscriptBox["n", "\[RightVector]"], "]"}],
        $CellContext`xPartialD[
         OverVector[$CellContext`n], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], "+", 
      RowBox[{
       SubsuperscriptBox["c", "s", "2"], " ", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {
              RowBox[{"{", "l", "}"}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic], ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             InterpretationBox[
              SubsuperscriptBox["x", 
               StyleBox["l",
                StripOnInput->False,
                ShowContents->False], "l"],
              
              TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", 
            OverscriptBox["n", "\[RightVector]"], "]"}],
           $CellContext`xPartialD[
            OverVector[$CellContext`n], 
            
            TensorCalculus5`Tensorial`Tensor[$CellContext`x, \
{$CellContext`l}, {TensorCalculus5`Tensorial`Void}]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`xSum[
         Dot[
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]], 
          $CellContext`xPartialD[
           OverVector[$CellContext`n], 
           
           TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, \
{TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}],
        Editable->False,
        SyntaxForm->Automatic]}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["g", "2"]}]]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"The Berry phase term \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SuperscriptBox["z", "\[Dagger]"],
      ConjugateTranspose[$CellContext`z],
      Editable->False,
      SyntaxForm->Automatic], " ", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "z", "]"}],
      $CellContext`xPartialD[$CellContext`z, $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\" does not contribute to the Hamiltonian.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]]}],
  SequenceForm[
   Style["VI.5.1: Work out the two branches of the spin wave spectrum in the \
ferromagnetic case, paying particular attend to the polarization.", 
    RGBColor[1, 0.5, 0], Larger], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Calculate eigenvalues of ", 
    RGBColor[0, 0, 1], 
    Larger], $CellContext`\[ScriptCapitalH] -> \
-$CellContext`\[ScriptCapitalL] + Dot[
      $CellContext`xPartialD[
       OverVector[$CellContext`n], $CellContext`t], 
      $CellContext`xPartialD[$CellContext`\[ScriptCapitalL], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]]] + \
$CellContext`xPartialD[$CellContext`z, $CellContext`t] \
$CellContext`xPartialD[$CellContext`\[ScriptCapitalL], 
       $CellContext`xPartialD[$CellContext`z, $CellContext`t]], 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["where ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[ScriptCapitalL] -> 
   Rational[1, 2] $CellContext`g^(-2) (Dot[
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]] + 
     Complex[0, 1] 
      ConjugateTranspose[$CellContext`z] \
$CellContext`xPartialD[$CellContext`z, $CellContext`t] - 
     Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
       Dot[
        $CellContext`xPartialD[
         OverVector[$CellContext`n], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]], 
        $CellContext`xPartialD[
         OverVector[$CellContext`n], 
         TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
          TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}]), 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], $CellContext`\[ScriptCapitalH] -> 
   Rational[1, 2] $CellContext`g^(-2) (Dot[
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t], 
       $CellContext`xPartialD[
        OverVector[$CellContext`n], $CellContext`t]] + 
     Subscript[$CellContext`c, $CellContext`s]^2 $CellContext`xSum[
        Dot[
         $CellContext`xPartialD[
          OverVector[$CellContext`n], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]], 
         $CellContext`xPartialD[
          OverVector[$CellContext`n], 
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`x, {$CellContext`l}, {
           TensorCalculus5`Tensorial`Void}]]], {$CellContext`l}]), 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["The Berry phase term ", 
    RGBColor[0, 0, 1], Larger], {
   Complex[0, 1] 
    ConjugateTranspose[$CellContext`z] $CellContext`xPartialD[$CellContext`z, \
$CellContext`t]}, 
   Style[" does not contribute to the Hamiltonian.", 
    RGBColor[0, 0, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.583779476219679*^9, 3.583779676577779*^9, {3.583782638395289*^9, 
   3.583782655944068*^9}, 3.583782710496688*^9, 3.583782747413908*^9, {
   3.583782862889008*^9, 3.583782942693204*^9}, 3.5837829942720737`*^9, 
   3.5838423381949577`*^9, 3.5838423766808643`*^9, 3.583842418014668*^9, 
   3.5838428267837973`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "CO", "[", 
   "\"\<VI.5.2: Verify that in the antiferromagnetic case the Berry's phase \
term merely changes the spin wave velocity and does not affect the spectrum \
qualitatively as in the ferromagnetic case.\>\"", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.583717134844836*^9, 3.583717201997355*^9}}],

Cell[BoxData[
 StyleBox["\<\"VI.5.2: Verify that in the antiferromagnetic case the Berry's \
phase term merely changes the spin wave velocity and does not affect the \
spectrum qualitatively as in the ferromagnetic case.\"\>",
  StripOnInput->False,
  LineColor->RGBColor[1, 0.5, 0],
  FrontFaceColor->RGBColor[1, 0.5, 0],
  BackFaceColor->RGBColor[1, 0.5, 0],
  GraphicsColor->RGBColor[1, 0.5, 0],
  FontSize->Larger,
  FontColor->RGBColor[1, 0.5, 0]]], "Print",
 CellChangeTimes->{3.583717203601516*^9}]
}, Open  ]]
},
WindowSize->{740, 656},
WindowMargins->{{65, Automatic}, {46, Automatic}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 329, 8, 57, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[911, 32, 4289, 106, 276, "Input"],
Cell[5203, 140, 26476, 726, 309, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31716, 871, 8690, 215, 577, "Input"],
Cell[40409, 1088, 52798, 1368, 697, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93244, 2461, 10601, 256, 453, "Input"],
Cell[103848, 2719, 46271, 1183, 632, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150156, 3907, 1177, 31, 122, "Input"],
Cell[151336, 3940, 4216, 116, 86, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155589, 4061, 8414, 232, 469, "Input"],
Cell[164006, 4295, 47346, 1219, 692, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211389, 5519, 4292, 100, 265, "Input"],
Cell[215684, 5621, 16485, 431, 222, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232206, 6057, 381, 8, 121, "Input"],
Cell[232590, 6067, 505, 11, 59, "Print"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
