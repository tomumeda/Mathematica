(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7674,        209]
NotebookOptionsPosition[      6947,        179]
NotebookOutlinePosition[      7300,        195]
CellTagsIndexPosition[      7257,        192]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Solution of Anharmonic Oscillator By Spectral Methods", "Section",
 CellChangeTimes->{{3.6497601933459053`*^9, 3.649760202721039*^9}}],

Cell["From Wilke\[CloseCurlyQuote]s Lecture:", "Text",
 CellChangeTimes->{{3.649760107050797*^9, 3.6497601097069063`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nPoints", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"r", " ", "\[Pi]"}], 
           RowBox[{"nPoints", "-", "1"}]], "]"}], "^", "1"}]}], "//", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"#", ",", "50"}], "]"}], "&"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", 
        RowBox[{"nPoints", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DSpec", "=", 
   RowBox[{
    RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
     RowBox[{"1", ",", "x", ",", 
      RowBox[{"DifferenceOrder", "\[Rule]", 
       RowBox[{"nPoints", "-", "1"}]}]}], "]"}], "[", 
    "\"\<DifferentiationMatrix\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D2", "=", 
   RowBox[{"DSpec", ".", "DSpec"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.649759460381647*^9, 3.649759561153943*^9}, {
  3.649759625676145*^9, 3.6497596261078253`*^9}, {3.6497597479404793`*^9, 
  3.649759754364182*^9}, {3.649759820787096*^9, 3.6497598223227386`*^9}, {
  3.649759972218224*^9, 3.649760023156879*^9}, {3.649760115387877*^9, 
  3.649760119371171*^9}, {3.649760660086006*^9, 3.649760664707971*^9}, {
  3.649760702226309*^9, 3.649760720690528*^9}, {3.649761422941886*^9, 
  3.6497614843055887`*^9}}],

Cell["Eigenvalues of Schrodinger Equation", "Text",
 CellChangeTimes->{{3.649760097603072*^9, 3.649760104243161*^9}, {
  3.649761485602109*^9, 3.649761485999436*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "D2"}], "+", 
      RowBox[{"SparseArray", "@", 
       RowBox[{"DiagonalMatrix", "[", 
        SuperscriptBox["x", "4"], "]"}]}]}], "//", "Eigenvalues"}], "//", 
    "Sort"}], "//", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"#", ",", "10"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.649759727364292*^9, 3.649759816258699*^9}, {
  3.6497598963049192`*^9, 3.6497598974249573`*^9}, {3.649759951645811*^9, 
  3.649759952446745*^9}, {3.6497600344629707`*^9, 3.6497600428584414`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0603620904841828996470460166447571881827241092434394289376811539126963149\
2223`46.13785414234829", ",", 
   "3.799673029801394168783094187863635896096112234439553634617674860982133655\
24859`46.13785414234829", ",", 
   "7.455697937986738392156591344871985807650086936790403788461356092945203772\
14728`46.13785414234829", ",", 
   "11.64474551137816202085037337819741632859099528082725331785272692508990489\
788949`46.13785414234829", ",", 
   "16.26182601885022593789495622645940063691056611869036497152316683106546208\
541935`46.13785414234829", ",", 
   "21.23837291823594002414972212105851116268653886375598650827948538311389545\
552778`46.13785414234829", ",", 
   "26.52847118368251819181373400491134908372668551052102514930876475309326154\
483831`46.13785414234829", ",", 
   "32.09859771096832663427017904490434191081540227852957842019466272605258400\
128706`46.13785414234829", ",", 
   "37.92300102703398514650933809189404629284991187208514437508691032374265333\
150683`46.13785414234829", ",", 
   "43.98115809728973078543524478146756430987727529895599131235963066586107122\
084923`46.13785414234829"}], "}"}]], "Output",
 CellChangeTimes->{{3.6497597299320383`*^9, 3.6497598253642473`*^9}, 
   3.649759897801271*^9, {3.6497599526623707`*^9, 3.6497600454235773`*^9}, 
   3.649760128637938*^9, {3.64976146421946*^9, 3.6497614883924294`*^9}, 
   3.649849775619791*^9}]
}, Open  ]],

Cell["From Pedro\[CloseCurlyQuote]s lecture:", "Text",
 CellChangeTimes->{{3.649760082024891*^9, 3.649760088729063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RRMethod", "=", 
   RowBox[{"{", 
    RowBox[{
    "1.0603620904841828996470460167132260732483530402025955669794`22.", ",", 
     "3.7996730298013941687830941893333275035011195886889745896598`22.", ",", 
     "7.4556979379867383921565913605999734583352829350441153937947`22.", ",", 
     "11.6447455113781620208503733271343717542652073203317762771973`22.", ",",
      "16.2618260188502259378949576166856628482938265492408009690889`22.", 
     ",", "21.2383729182359400241497202440183396566182116790874859517259`22.",
      ",", "26.5284711836825181918140063711872542776091454137684771340625`22.\
", ",", "32.0985977109683266342741943182321542630526605445189694732707`22.", 
     ",", "37.9230010270339851465215517769037396694617708009347223581824`22.",
      ",", "43.9811580972897307853929272859244103773196408152174780218624`22.\
"}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.649759877160948*^9, 3.649759892768227*^9}, 
   3.649759932014779*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evs", "-", "RRMethod"}]], "Input",
 CellChangeTimes->{{3.649759935080594*^9, 3.649759962694047*^9}, 
   3.649760049906143*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0``21.974545807332603", ",", "0``21.42025377376808", ",", 
   "0``21.12751169541305", ",", "0``20.93386999825956", ",", 
   "0``20.788830689653103", ",", "0``20.67287875782121", ",", 
   "0``20.57628777736866", ",", 
   RowBox[{
   "-", "4.0152733278123522372582659893910530762`0.09722905409978332*^-21"}], 
   ",", 
   RowBox[{
   "-", "1.22136850096933766118589288495779830955`0.5079440175627526*^-20"}], 
   ",", "4.23174955431539325576344837385132904972`0.9832532962635937*^-20"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.649759938851824*^9, 3.649760008771319*^9}, 
   3.649760050258692*^9, 3.649760128705412*^9, {3.649761466175714*^9, 
   3.649761488509914*^9}, 3.649849775761434*^9}]
}, Open  ]],

Cell["\<\
You can change the 1 to a 3 in the definition of x to note that the agreement \
becomes much worse right away. If you put a uniform grid it is much worse \
still. \
\>", "Text",
 CellChangeTimes->{{3.649761488932371*^9, 3.649761529670581*^9}}]
}, Open  ]]
},
WindowSize->{1280, 672},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 140, 1, 64, "Section"],
Cell[723, 25, 122, 1, 30, "Text"],
Cell[848, 28, 1552, 40, 115, "Input"],
Cell[2403, 70, 166, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[2594, 76, 603, 16, 35, "Input"],
Cell[3200, 94, 1424, 26, 80, "Output"]
}, Open  ]],
Cell[4639, 123, 120, 1, 30, "Text"],
Cell[4762, 126, 988, 17, 49, "Code"],
Cell[CellGroupData[{
Cell[5775, 147, 150, 3, 28, "Input"],
Cell[5928, 152, 735, 16, 35, "Output"]
}, Open  ]],
Cell[6678, 171, 253, 5, 30, "Text"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
