(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     49475,       1422]
NotebookOptionsPosition[     46331,       1327]
NotebookOutlinePosition[     46754,       1344]
CellTagsIndexPosition[     46711,       1341]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Exercise 1 solutions\n\n\n",
 StyleBox["Toby Wiseman (Imperial College)  \n\nMathematica Summer School, \
Porto 2014",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Plain"]
}], "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614576625613048*^9, 3.614576630693656*^9}, {
   3.614577125300946*^9, 3.61457725923139*^9}, {3.614577328790803*^9, 
   3.614577332045426*^9}, 3.614580707520459*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NX", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NY", "=", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6145303865786867`*^9, 3.614530390572673*^9}, {
   3.614530427651465*^9, 3.614530428473796*^9}, {3.614531398025475*^9, 
   3.614531399361471*^9}, 3.6145807075213633`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 1 : create the basic domain", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614577337291471*^9, 3.614577341746352*^9}, 
   3.614580707522833*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"array", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boundary", "=", 
    RowBox[{"{", "}"}]}], ";", 
   RowBox[{"interior", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count1", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count2", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"boundary", ",", 
          RowBox[{"count", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"array", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<b\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"count1", "++"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"interior", ",", 
          RowBox[{"count", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"array", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<f\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"count2", "++"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "NX"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", "NY"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1."}], ")"}], 
          RowBox[{"(", 
           RowBox[{"NX", "-", "0.5"}], ")"}]], ",", 
         RowBox[{"2", "\[Pi]", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "0.5"}], ")"}], 
           RowBox[{"(", "NY", ")"}]]}]}], "}"}], ",", "#2"}], "}"}], "]"}], "@@@",
     "array"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614490948611979*^9, 3.614490949133404*^9}, {
   3.614491066717723*^9, 3.614491125572743*^9}, {3.614491168444928*^9, 
   3.614491248915493*^9}, {3.6144912837342052`*^9, 3.614491399683971*^9}, {
   3.61449144347707*^9, 3.614491618367524*^9}, {3.6144916502730703`*^9, 
   3.614491650601327*^9}, {3.614491681093424*^9, 3.614491707587887*^9}, {
   3.61449173964145*^9, 3.614491754304418*^9}, {3.614491991437695*^9, 
   3.6144921247146063`*^9}, {3.614492173967345*^9, 3.614492230543776*^9}, {
   3.6144935032077303`*^9, 3.614493546616418*^9}, {3.614493597438211*^9, 
   3.614493599582695*^9}, {3.614493885541829*^9, 3.614493885898114*^9}, {
   3.614494142957699*^9, 3.614494146807969*^9}, {3.614494299418024*^9, 
   3.6144943260964327`*^9}, {3.614494683054352*^9, 3.6144947425534563`*^9}, {
   3.614494774656637*^9, 3.614494776043077*^9}, {3.614494875727984*^9, 
   3.614494898961502*^9}, {3.614495758276513*^9, 3.6144958049420443`*^9}, {
   3.614496598307961*^9, 3.614496645906208*^9}, {3.6144969829505787`*^9, 
   3.614497006164504*^9}, {3.614499193949827*^9, 3.6144992415659113`*^9}, {
   3.614499750709916*^9, 3.614499763076477*^9}, {3.6145009194065847`*^9, 
   3.614501012634551*^9}, {3.614501147026832*^9, 3.614501161360704*^9}, {
   3.614501619140008*^9, 3.614501642753359*^9}, {3.614508961605669*^9, 
   3.61450896222124*^9}, {3.6145090497187977`*^9, 3.614509050333304*^9}, 
   3.614509084774301*^9, {3.6145198596647177`*^9, 3.614519861025425*^9}, {
   3.6145774630593576`*^9, 3.614577464384624*^9}, 3.614580707524137*^9}],

Cell["\<\
Notes;

For future convenience I have created lists \[OpenCurlyQuote]boundary\
\[CloseCurlyQuote] and \[OpenCurlyQuote]interior\[CloseCurlyQuote] that  \
store which elements in ' grid' corresponding to the boundary at x = 0 and \
those which are interior points. \
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145773734985237`*^9, 3.6145774463102703`*^9}, {
   3.6145774898083143`*^9, 3.614577497517848*^9}, 3.614580707525635*^9, {
   3.614583669122788*^9, 3.614583686454414*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "grid", "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614577449996694*^9, 3.614577450735108*^9}, {
   3.61457772402173*^9, 3.614577726261739*^9}, 3.614580707526553*^9}],

Cell[BoxData[{
 RowBox[{"boundary", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<For example; \>\"", ",", 
    RowBox[{"grid", "[", 
     RowBox[{"[", 
      RowBox[{"boundary", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}]}], "Input",\

 Editable->False,
 CellChangeTimes->{{3.614577407964095*^9, 3.614577408560423*^9}, {
   3.614580447567789*^9, 3.614580472184948*^9}, 3.614580707530518*^9}],

Cell[BoxData[{
 RowBox[{"interior", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<For example; \>\"", ",", 
    RowBox[{"grid", "[", 
     RowBox[{"[", 
      RowBox[{"interior", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ";"}]}], "Input",\

 Editable->False,
 CellChangeTimes->{{3.6145774093457413`*^9, 3.614577410647581*^9}, {
   3.6145804567171993`*^9, 3.614580479805422*^9}, 3.614580707536749*^9}],

Cell["\<\
Notes;

For future convenience I will also create a list of the boundary variables \
and the interior variables, together with a combined list of all variables.\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145773734985237`*^9, 3.6145774463102703`*^9}, {
   3.6145774898083143`*^9, 3.614577521572569*^9}, 3.614580707541301*^9}],

Cell[BoxData[
 RowBox[{"boundaryvar", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"\"\<b\>\"", "<>", 
      RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "1", ",", 
      RowBox[{"count1", "-", "1"}]}], "}"}]}], "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145775230548697`*^9, 3.6145775294853687`*^9}, 
   3.614580707542231*^9}],

Cell[BoxData[
 RowBox[{"interiorvar", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"\"\<f\>\"", "<>", 
      RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "1", ",", 
      RowBox[{"count2", "-", "1"}]}], "}"}]}], "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145775230548697`*^9, 3.614577532629661*^9}, 
   3.614580707545454*^9}],

Cell[BoxData[
 RowBox[{"variables", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"boundaryvar", ",", "interiorvar"}], "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145775230548697`*^9, 3.614577532629661*^9}, 
   3.614580707548738*^9}],

Cell["Also create ' size' variable to store length of grid list;", "Text",
 Editable->False,
 CellChangeTimes->{{3.614577911832389*^9, 3.61457792707672*^9}, 
   3.614580707552165*^9}],

Cell[BoxData[
 RowBox[{"size", "=", 
  RowBox[{"Length", "[", "grid", "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{3.6145807075530367`*^9}],

Cell["\<\
Likewise for future convenience create size variables for the boundary and \
interior lists;\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614577911832389*^9, 3.61457792707672*^9}, {
   3.614577965184102*^9, 3.614577986926856*^9}, 3.614580707556162*^9, {
   3.614583712790277*^9, 3.614583713069603*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sizeboundary", "=", 
   RowBox[{"Length", "[", "boundary", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"sizeinterior", "=", 
  RowBox[{"Length", "[", "interior", "]"}]}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.61457795920792*^9, 3.614577959545187*^9}, 
   3.614580707557004*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Problem 2 : create an extended domain to implement reflection and periodic \
boundary conditions\
\>", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614577337291471*^9, 3.614577341746352*^9}, {
   3.614577555446321*^9, 3.61457756303717*^9}, 3.614580707561635*^9}],

Cell["\<\
Firstly double the grid in x to implement reflection boundary condition about \
x = 1;\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614577583475937*^9, 3.6145776030706177`*^9}, 
   3.614577689243626*^9, 3.614580707562501*^9, {3.6145837248677883`*^9, 
   3.614583727116415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"griddouble", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"grid", ",", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "-", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"#1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "#2"}], "}"}], 
       "]"}], "@@@", "grid"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6144937709292*^9, 3.614493792867722*^9}, 
   3.614493840291645*^9, 3.614580707563903*^9}],

Cell["\<\
Secondly put a copy of the grid at y = 0 and y = 2 \[Pi] to implement \
periodicity in y;\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614577583475937*^9, 3.6145776374360332`*^9}, 
   3.6145776892441587`*^9, 3.614580707565877*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridfull", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"2", "\[Pi]"}]}]}], "}"}], ",", "#2"}], "}"}], "]"}], "@@@",
       "griddouble"}], ",", "griddouble", ",", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", 
            RowBox[{"2", "\[Pi]"}]}]}], "}"}], ",", "#2"}], "}"}], "]"}], "@@@",
       "griddouble"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614492193317868*^9, 3.614492220313496*^9}, {
   3.614493696165401*^9, 3.614493765749354*^9}, {3.614493809814633*^9, 
   3.614493836687636*^9}, {3.614520090320492*^9, 3.61452009836322*^9}, 
   3.614577640453486*^9, 3.614577730079754*^9, 3.614580707567535*^9}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "gridfull", "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.61457773167669*^9, 3.61457773590186*^9}, 
   3.614580707569105*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Problem 3 : use \[OpenCurlyQuote]Interpolation\[CloseCurlyQuote] to create \
finite difference stencil\
\>", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614576705562067*^9, 3.614576729772881*^9}, {
   3.614576801747323*^9, 3.6145768131382303`*^9}, 3.614580707577256*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fninterp", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"gridfull", ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.614493859552343*^9, 3.614493860439653*^9}, {
   3.614494083426981*^9, 3.6144940872501907`*^9}, {3.614495075177869*^9, 
   3.6144950787625933`*^9}, 3.614497526026338*^9, 3.61449796966538*^9, 
   3.61449828200152*^9, {3.614498376819167*^9, 3.614498376883424*^9}, {
   3.614498793381364*^9, 3.614498826709447*^9}, {3.6144989558463182`*^9, 
   3.614498973837081*^9}, {3.614499453795888*^9, 3.614499474556699*^9}, 
   3.6144997814050694`*^9, 3.614500178934518*^9, 3.6145019727426023`*^9, 
   3.614580707578149*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dxfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dyfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dxxfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dyyfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxyfninterp", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"fninterp", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{3.6145807075799093`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xval", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yval", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fval", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"grid", "[", 
      RowBox[{"[", 
       RowBox[{"ii", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145006261275797`*^9, 3.61450065104106*^9}, 
   3.614580707581608*^9}],

Cell["Note; this takes a few seconds for higher resolutions;", "Text",
 Editable->False,
 CellChangeTimes->{{3.614577857873378*^9, 3.614577874546034*^9}, 
   3.614580707583194*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<This takes \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dxfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dxfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dyfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dyfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dxxfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dxxfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dyyfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dyyfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dxyfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dxyfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< seconds to run!\>\""}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614494096647558*^9, 3.6144941530582533`*^9}, {
   3.614494216552705*^9, 3.614494248459633*^9}, {3.614494527655267*^9, 
   3.614494551254593*^9}, {3.614494810605715*^9, 3.614494815150736*^9}, {
   3.61449491846887*^9, 3.614494931619648*^9}, {3.614494973004328*^9, 
   3.6144950167935953`*^9}, {3.614495098260392*^9, 3.614495098468608*^9}, {
   3.614495160830015*^9, 3.614495195481889*^9}, {3.614497056200307*^9, 
   3.614497076775544*^9}, {3.6144984966667213`*^9, 3.614498511232622*^9}, {
   3.614500053625019*^9, 3.614500107285192*^9}, {3.6145002747399817`*^9, 
   3.614500279042839*^9}, {3.6145005259529247`*^9, 3.6145005727343807`*^9}, {
   3.6145006098995934`*^9, 3.614500613074885*^9}, {3.6145006567586393`*^9, 
   3.6145006660837393`*^9}, {3.614578002884861*^9, 3.6145780284196253`*^9}, 
   3.614580707584566*^9}],

Cell["Let us check the results;", "Text",
 Editable->False,
 CellChangeTimes->{{3.61457804328526*^9, 3.6145780515072603`*^9}, 
   3.614580707587381*^9}],

Cell[BoxData[{
 RowBox[{"xval", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"yval", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "fval"}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614578040713296*^9, 3.614578058525817*^9}, 
   3.614580707588238*^9}],

Cell[BoxData[{
 RowBox[{"dxfval", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dyfval", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dxxfval", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dyyfval", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "dxyfval"}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614578073359029*^9, 3.614578081789784*^9}, 
   3.614580707594788*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 4 : check our discretization", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614576705562067*^9, 3.6145767360290527`*^9}, {
   3.614576817449678*^9, 3.614576822001588*^9}, 3.6145807076054907`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Cos", "[", "y", "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"0.5", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6144953006610527`*^9, 3.6144953584630613`*^9}, {
   3.614495613223735*^9, 3.614495614301653*^9}, {3.614495928484627*^9, 
   3.614495956055395*^9}, {3.61449615481246*^9, 3.614496160619524*^9}, {
   3.614519874134243*^9, 3.614519876626915*^9}, 3.614580707606429*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fnx", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fny", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fnxx", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fnyy", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fnxy", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"fn", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614496134502334*^9, 3.614496163683592*^9}, {
   3.614497297986053*^9, 3.614497314754484*^9}, 3.614580707608143*^9}],

Cell[BoxData[
 RowBox[{"varrepl", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{"variables", "->", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{
        RowBox[{"grid", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"grid", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{3.614580707609622*^9}],

Cell["\<\
Check our discretized x derivatives; since we used 2nd order polynominal \
interpolation and fn is only quadratic in x this should agree (up to \
numerical precision). \
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145781958647842`*^9, 3.614578240360318*^9}, {
   3.614578352106783*^9, 3.6145783610510063`*^9}, 3.614580707612966*^9, 
   3.614583876591422*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fnx", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"xval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
      RowBox[{"y", "\[Rule]", 
       RowBox[{"yval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "1", ",", 
     RowBox[{"Length", "[", "xval", "]"}]}], "}"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145784014166393`*^9, 3.6145784118079643`*^9}, 
   3.6145807076139393`*^9}],

Cell[BoxData[
 RowBox[{"dxfval", "/.", "varrepl"}]], "Input",
 Editable->False,
 CellChangeTimes->{3.614580707617449*^9}],

Cell["Let' s plot these results;", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145783618425503`*^9, 3.614578367662908*^9}, 
   3.61458070762072*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"dxfval", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "/.", "varrepl"}]}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxfval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "varrepl"}], ")"}], "-", 
       RowBox[{"fnx", "[", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
     "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], "]"}]}], "Input",
 Editable->False,
 CellChangeTimes->{3.614580707621813*^9}],

Cell["\<\
Let\[CloseCurlyQuote]s do the same for the discretized y derivatives; now we \
shouldn\[CloseCurlyQuote]t see exact agreement. In fact for low resolution we \
shouldn\[CloseCurlyQuote]t see very good agreement; go back and rerun this \
for NX=NY=10 and InterpolationOrder->6 and you should see a much better \
agreement.\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145781958647842`*^9, 3.614578240360318*^9}, {
   3.614578352106783*^9, 3.6145783610510063`*^9}, {3.614578427789214*^9, 
   3.6145784918187733`*^9}, 3.614580707632764*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fny", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"xval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
      RowBox[{"y", "\[Rule]", 
       RowBox[{"yval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "1", ",", 
     RowBox[{"Length", "[", "xval", "]"}]}], "}"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145784014166393`*^9, 3.6145784118079643`*^9}, {
   3.614578494622889*^9, 3.614578494694076*^9}, 3.6145807076337976`*^9}],

Cell[BoxData[
 RowBox[{"dyfval", "/.", "varrepl"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145784968460197`*^9, 3.614578496931294*^9}, 
   3.614580707637082*^9}],

Cell["Let' s plot these results;", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145783618425503`*^9, 3.614578367662908*^9}, 
   3.614580707640292*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"dyfval", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "/.", "varrepl"}]}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyfval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "varrepl"}], ")"}], "-", 
       RowBox[{"fny", "[", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
     "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], "]"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614578500590431*^9, 3.614578504188818*^9}, 
   3.6145807076413813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Problem 5 : implement boundary conditions, initial guess and p.d.e. to be \
solved.\
\>", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614576705562067*^9, 3.6145767136572123`*^9}, 
   3.614576755717746*^9, {3.614576826273418*^9, 3.6145768529049883`*^9}, 
   3.614580707651608*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bfn", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Cos", "[", "y", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6144953006610527`*^9, 3.6144953584630613`*^9}, {
   3.614495613223735*^9, 3.614495614301653*^9}, {3.614495928484627*^9, 
   3.614495956055395*^9}, {3.61449615481246*^9, 3.614496160619524*^9}, {
   3.614500876428585*^9, 3.614500883644013*^9}, {3.614501052761271*^9, 
   3.614501061565872*^9}, {3.61451995691461*^9, 3.614519957271803*^9}, 
   3.6145807076525393`*^9}],

Cell["\<\
This code creates the boundary and interior replacelists for the boundary \
condition at x=0 and the initial guess for the interior points respectively. \
Note that we are using the lists ' boundary' and ' interior' that we created \
initially when we built ' grid'.\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614578594526362*^9, 3.614578637782448*^9}, {
   3.6145786846497726`*^9, 3.6145787001295633`*^9}, 3.614580707654162*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"boundaryrepl", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"boundaryvar", "->", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bfn", "[", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"boundary", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "1", ",", "1"}], "]"}], 
          "]"}], ",", 
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"boundary", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "1", ",", "2"}], "]"}], 
          "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeboundary"}], "}"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"interiorrepl", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{"interiorvar", "->", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bfn", "[", 
       RowBox[{
        RowBox[{"grid", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"interior", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "1", ",", "1"}], "]"}], 
         "]"}], ",", 
        RowBox[{"grid", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"interior", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "1", ",", "2"}], "]"}], 
         "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}]}], 
   "]"}]}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614495633817226*^9, 3.6144956554623003`*^9}, {
   3.614495692509696*^9, 3.614495719091959*^9}, {3.614495791997139*^9, 
   3.6144957940464354`*^9}, {3.61449582539677*^9, 3.6144958444576693`*^9}, {
   3.614496793682639*^9, 3.614496821551915*^9}, {3.6144968629891872`*^9, 
   3.61449686394834*^9}, {3.614497083792452*^9, 3.614497084144854*^9}, 
   3.6145008951369267`*^9, {3.61450107763931*^9, 3.614501079326416*^9}, {
   3.614501121712565*^9, 3.6145011308935537`*^9}, 3.614501209145512*^9, {
   3.614501287576763*^9, 3.614501292222649*^9}, {3.614502083111821*^9, 
   3.61450210439332*^9}, 3.614580707655267*^9, {3.614583785088035*^9, 
   3.6145838341685543`*^9}}],

Cell["\<\
Now creating the equation list at the interior points is very straightforward \
(where we also impose the boundary condition at x=0 using boundaryrepl)\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614578594526362*^9, 3.614578680937636*^9}, 
   3.614580707660225*^9}],

Cell[BoxData[
 RowBox[{"interiorequations", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dxxfval", "+", 
        RowBox[{"5", "dyyfval"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"interior", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "/.", "boundaryrepl"}],
     "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}]}]], "Input",\

 Editable->False,
 CellChangeTimes->{3.614578715748101*^9, 3.614580707661166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 6 : Solve the Laplace equation", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614576705562067*^9, 3.6145767136572123`*^9}, 
   3.614576755717746*^9, {3.614576826273418*^9, 3.61457687396128*^9}, {
   3.6145769941541157`*^9, 3.614577002088945*^9}, 3.614580707664572*^9}],

Cell[BoxData[
 RowBox[{"varandguess", "=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"interiorvar", ",", 
       RowBox[{"interiorvar", "/.", "interiorrepl"}]}], "]"}], ",", 
     "sizeinterior"}], "]"}], "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{3.6145787401789703`*^9, 3.614580707665509*^9}],

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{"FindRoot", "[", 
   RowBox[{"interiorequations", ",", "varandguess", ",", 
    RowBox[{"StepMonitor", "\[RuleDelayed]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<norm = \>\"", ",", 
       RowBox[{"Norm", "[", "interiorequations", "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614578756779745*^9, 3.614578766699243*^9}, 
   3.614580707668994*^9}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"fval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "boundaryrepl"}], "/.", 
        "solution"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{3.614580707673514*^9}],

Cell["\<\
The exact analytic solution for these boundary conditions is;\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.61458051916094*^9, 3.6145805296159697`*^9}, 
   3.6145807076798897`*^9, 3.6145839378104477`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Cos", "[", "y", "]"}], 
   FractionBox[
    RowBox[{"Cosh", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", "5", "]"}], 
      RowBox[{"(", 
       RowBox[{"x", "-", "1"}], ")"}]}], "]"}], 
    RowBox[{"Cosh", "[", 
     RowBox[{"Sqrt", "[", "5", "]"}], "]"}]]}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614580568405904*^9, 3.614580598124295*^9}, 
   3.614580707680813*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Simplify", "[", 
   StyleBox[
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", " ", "y"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"5", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"x", ",", " ", "y"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", " ", "2"}], "}"}]}], "]"}]}]}],
    FontWeight->"Bold"], 
   StyleBox["]",
    FontWeight->"Bold"]}], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"Simplify", "[", 
   RowBox[{"f", "[", 
    RowBox[{"0", ",", "y"}], "]"}], "]"}],
  FontWeight->"Bold"]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614580552321052*^9, 3.614580554749523*^9}, {
   3.6145806032915287`*^9, 3.614580616199935*^9}, 3.614580707682535*^9, 
   3.6145839503892593`*^9}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}],
      "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145806347189407`*^9, 3.614580638114566*^9}, 
   3.614580707687738*^9}],

Cell["The difference with our discrete solution is;", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145806488818703`*^9, 3.614580707694092*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"fval", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "/.", "boundaryrepl"}], "/.", 
          "solution"}], ")"}], "-", 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
      "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145806586992073`*^9, 3.614580661171213*^9}, 
   3.614580707695112*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 7 : Solve a non-linear Laplace equation", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614576705562067*^9, 3.6145767136572123`*^9}, 
   3.614576755717746*^9, {3.614576826273418*^9, 3.61457687396128*^9}, {
   3.6145769941541157`*^9, 3.614577013104905*^9}, 3.6145787848037*^9, 
   3.6145807077014847`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"interiorequations", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dxxfval", "+", 
         RowBox[{"5", "dyyfval"}], "-", 
         RowBox[{"2", 
          RowBox[{"fval", "^", "2"}]}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "/.", 
      "boundaryrepl"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145003841488953`*^9, 3.614500428323286*^9}, {
   3.614500705058229*^9, 3.614500712058281*^9}, {3.614500830859104*^9, 
   3.614500835117132*^9}, {3.614501230161429*^9, 3.614501266312193*^9}, {
   3.6145013105143538`*^9, 3.614501315067554*^9}, {3.614501750254573*^9, 
   3.614501750586434*^9}, {3.6145018667553997`*^9, 3.6145018684599047`*^9}, {
   3.61450190086061*^9, 3.614501943784333*^9}, {3.614502237763332*^9, 
   3.614502238072193*^9}, {3.6145022973995953`*^9, 3.614502306457015*^9}, {
   3.614502359684677*^9, 3.6145023597771177`*^9}, {3.61451997680156*^9, 
   3.614519994087853*^9}, {3.614520133676655*^9, 3.614520139538454*^9}, {
   3.614520201232716*^9, 3.614520210420478*^9}, {3.61457614041253*^9, 
   3.614576140528648*^9}, {3.614578844392745*^9, 3.614578869566476*^9}, 
   3.614580707702491*^9}],

Cell[BoxData[
 RowBox[{"solution2", "=", 
  RowBox[{"FindRoot", "[", 
   RowBox[{"interiorequations", ",", "varandguess", ",", 
    RowBox[{"StepMonitor", "\[RuleDelayed]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Step; norm = \>\"", ",", 
       RowBox[{"Norm", "[", "interiorequations", "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{3.614578827201395*^9, 3.614580707704117*^9}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"fval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "boundaryrepl"}], "/.", 
        "solution2"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{3.614580707716255*^9}]
}, Open  ]]
},
WindowSize->{740, 867},
WindowMargins->{{52, Automatic}, {Automatic, 22}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 22, \
2012)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "PastelColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 483, 14, 126, "Subtitle"],
Cell[1065, 38, 371, 9, 68, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1473, 52, 165, 3, 21, "Subtitle"],
Cell[1641, 57, 4561, 111, 344, "Input"],
Cell[6205, 170, 500, 11, 71, "Text"],
Cell[6708, 183, 221, 4, 37, "Input"],
Cell[6932, 189, 476, 12, 68, "Input"],
Cell[7411, 203, 480, 12, 68, "Input"],
Cell[7894, 217, 346, 8, 71, "Text"],
Cell[8243, 227, 439, 12, 37, "Input"],
Cell[8685, 241, 437, 12, 37, "Input"],
Cell[9125, 255, 244, 6, 37, "Input"],
Cell[9372, 263, 183, 3, 26, "Text"],
Cell[9558, 268, 150, 4, 37, "Input"],
Cell[9711, 274, 321, 7, 26, "Text"],
Cell[10035, 283, 352, 9, 68, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10424, 297, 279, 6, 21, "Subtitle"],
Cell[10706, 305, 296, 7, 26, "Text"],
Cell[11005, 314, 639, 19, 37, "Input"],
Cell[11647, 335, 249, 6, 26, "Text"],
Cell[11899, 343, 1269, 35, 53, "Input"],
Cell[13171, 380, 178, 4, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13386, 389, 288, 6, 21, "Subtitle"],
Cell[13677, 397, 731, 14, 37, "Input"],
Cell[14411, 413, 1633, 55, 158, "Input"],
Cell[16047, 470, 1239, 37, 188, "Input"],
Cell[17289, 509, 180, 3, 26, "Text"],
Cell[17472, 514, 4810, 106, 398, "Input"],
Cell[22285, 622, 152, 3, 26, "Text"],
Cell[22440, 627, 277, 6, 98, "Input"],
Cell[22720, 635, 422, 8, 158, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23179, 648, 216, 3, 21, "Subtitle"],
Cell[23398, 653, 645, 18, 37, "Input"],
Cell[24046, 673, 1662, 56, 158, "Input"],
Cell[25711, 731, 646, 19, 68, "Input"],
Cell[26360, 752, 378, 8, 41, "Text"],
Cell[26741, 762, 628, 19, 37, "Input"],
Cell[27372, 783, 121, 3, 37, "Input"],
Cell[27496, 788, 153, 3, 26, "Text"],
Cell[27652, 793, 1676, 48, 143, "Input"],
Cell[29331, 843, 556, 10, 56, "Text"],
Cell[29890, 855, 674, 19, 37, "Input"],
Cell[30567, 876, 173, 4, 37, "Input"],
Cell[30743, 882, 154, 3, 26, "Text"],
Cell[30900, 887, 1728, 49, 143, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32665, 941, 297, 7, 21, "Subtitle"],
Cell[32965, 950, 562, 12, 37, "Input"],
Cell[33530, 964, 450, 8, 56, "Text"],
Cell[33983, 974, 2300, 56, 128, "Input"],
Cell[36286, 1032, 285, 6, 41, "Text"],
Cell[36574, 1040, 585, 17, 68, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37196, 1062, 289, 4, 21, "Subtitle"],
Cell[37488, 1068, 379, 10, 53, "Input"],
Cell[37870, 1080, 441, 11, 53, "Input"],
Cell[38314, 1093, 826, 23, 68, "Input"],
Cell[39143, 1118, 222, 5, 26, "Text"],
Cell[39368, 1125, 496, 16, 59, "Input"],
Cell[39867, 1143, 999, 31, 68, "Input"],
Cell[40869, 1176, 1014, 28, 68, "Input"],
Cell[41886, 1206, 147, 2, 26, "Text"],
Cell[42036, 1210, 1246, 35, 83, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43319, 1250, 324, 5, 21, "Subtitle"],
Cell[43646, 1257, 1454, 31, 68, "Input"],
Cell[45103, 1290, 420, 10, 53, "Input"],
Cell[45526, 1302, 789, 22, 68, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
