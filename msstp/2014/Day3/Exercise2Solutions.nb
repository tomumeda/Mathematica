(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    140741,       3979]
NotebookOptionsPosition[    133326,       3759]
NotebookOutlinePosition[    134282,       3794]
CellTagsIndexPosition[    134209,       3789]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Exercise 2 solutions\n\n\n",
 StyleBox["Toby Wiseman (Imperial College)  \n\nMathematica Summer School, \
Porto 2014",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Plain"]
}], "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.614584219797332*^9, 3.614584268165765*^9}, {
  3.614584641614275*^9, 3.614584712622758*^9}, {3.614585501680337*^9, 
  3.6145855453766813`*^9}, {3.614585926991672*^9, 3.6145859728042297`*^9}, {
  3.614592537678425*^9, 3.614592539180182*^9}}],

Cell[TextData[StyleBox["The first subsection must be run to set up the \
Harmonic Einstein equations.",
 Editable->True]], "Text",
 Editable->False,
 CellChangeTimes->{{3.614584624256028*^9, 3.614584638327978*^9}, {
   3.614584715505117*^9, 3.614584800405653*^9}, {3.614584972557116*^9, 
   3.614584994318863*^9}, 3.614585037402227*^9, {3.614585776442357*^9, 
   3.614585815249324*^9}, {3.614600298101905*^9, 3.614600342194913*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Harmonic Einstein equations - RUN THIS SUBSECTION (note that this takes a few \
moments to complete)\
\>", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.408796983010241*^9, 3.408796989128707*^9}, {
   3.415942197687789*^9, 3.415942199707787*^9}, {3.428318203595373*^9, 
   3.4283182110266533`*^9}, {3.4318556687961187`*^9, 3.431855668994246*^9}, {
   3.495174647742872*^9, 3.460515504326817*^9}, {3.503996600043788*^9, 
   3.503996603042028*^9}, {3.5419997664314537`*^9, 3.541999771805746*^9}, {
   3.549861410741426*^9, 3.5498614119962797`*^9}, {3.549861578273839*^9, 
   3.5498615808290033`*^9}, {3.549861954461465*^9, 3.5498619549643087`*^9}, {
   3.5498626978119802`*^9, 3.5498627069566727`*^9}, {3.5498628806594*^9, 
   3.549862882306438*^9}, {3.549864538110551*^9, 3.549864538876906*^9}, {
   3.550483235301546*^9, 3.550483236620832*^9}, {3.550483693888809*^9, 
   3.5504836979364767`*^9}, {3.6145035649138536`*^9, 3.614503567664414*^9}, {
   3.614585755351248*^9, 3.614585763508545*^9}, {3.614585822057248*^9, 
   3.614585833769083*^9}, 3.614600327318509*^9}],

Cell["The following subsection derives the Einstein equations....", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145850880792913`*^9, 3.614585104277103*^9}, {
  3.614585143494481*^9, 3.614585153223049*^9}}],

Cell[CellGroupData[{

Cell["GRSetup2.nb ", "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.478330969800351*^9, 3.478330971159855*^9}, 
   3.61459099176807*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Latest", " ", "Version"}], " ", "*)"}]], "Input",
 Editable->False],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"{", 
    RowBox[{
    "gtt", ",", "grr", ",", "g\[Theta]\[Theta]", ",", "g\[Phi]\[Phi]", ",", 
     "gzz"}], "}"}]}], "\n"}], "\n", 
 RowBox[{"Gd", "=", 
  RowBox[{"DiagonalMatrix", "[", "metric", "]"}]}]}], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "gtt", ",", "grr", ",", "g\[Theta]\[Theta]", ",", "g\[Phi]\[Phi]", ",", 
   "gzz"}], "}"}]], "Output",
 CellChangeTimes->{3.644102714454481*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gtt", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "grr", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "g\[Theta]\[Theta]", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "g\[Phi]\[Phi]", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "gzz"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.644102714461215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Gd", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", "grt"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Gd", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", "grt"}]}], "Input",
 Editable->False],

Cell[BoxData["grt"], "Output",
 CellChangeTimes->{3.64410272484761*^9}],

Cell[BoxData["grt"], "Output",
 CellChangeTimes->{3.644102724851595*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"BuildMetric", ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gu", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "Gd", "]"}], "]"}]}], ";", 
    RowBox[{"G", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "d"}], "}"}], ",", 
       RowBox[{"IdentityMatrix", "[", "Nind", "]"}]}], "}"}]}], ";"}], 
   ")"}]}]], "Input",
 Editable->False],

Cell[BoxData["BuildMetric"], "Input",
 Editable->False],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]", ",", "z"}], 
    "}"}]}], "\n"}], "\n", 
 RowBox[{"Nind", "=", 
  RowBox[{"Length", "[", "ind", "]"}]}]}], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]", ",", "z"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.644102796428273*^9}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.644102796432708*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getind", "[", "i1_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IntegerQ", "[", "i1", "]"}], ",", "i1", ",", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"ind", ",", "i1"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ")"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lstind", "[", "i1_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"lsttmp2", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"lsttmp2", ",", 
         RowBox[{"getind", "[", 
          RowBox[{"i1", "[", 
           RowBox[{"[", 
            RowBox[{"lsttmp1", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"lsttmp1", ",", "1", ",", 
         RowBox[{"Length", "[", "i1", "]"}]}], "}"}]}], "]"}], ";", 
     "lsttmp2"}], ")"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"up", "[", 
   RowBox[{"i1_", ",", "i2_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"lsttmp2", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"lsttmp2", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i1", "[", 
            RowBox[{"[", 
             RowBox[{"lsttmp1", ",", "2"}], "]"}], "]"}], "=!=", 
           RowBox[{"i2", "[", 
            RowBox[{"[", "lsttmp1", "]"}], "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i1", "[", 
              RowBox[{"[", 
               RowBox[{"lsttmp1", ",", "2"}], "]"}], "]"}], "===", "d"}], ",",
             "d", ",", "u"}], "]"}], ",", "0"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"lsttmp1", ",", "1", ",", 
        RowBox[{"Length", "[", "i1", "]"}]}], "}"}]}], "]"}], ";", 
    "lsttmp2"}], ")"}]}]}], "Input",
 Editable->False],

Cell[BoxData[""], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"MT", "[", 
   RowBox[{"t1_", ",", "dim_", ",", "indpos_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"MTtmp1", "=", "0"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "indpos", "]"}], "=!=", "dim"}], ",", 
      RowBox[{"Print", "[", "\"\<Error in index position\>\"", "]"}]}], "]"}],
     ";", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"MTtmp1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"MTtmp1", ",", 
         RowBox[{"{", 
          RowBox[{"MTtmp3", ",", "1", ",", "Nind"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"MTtmp2", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
    RowBox[{"t1", "=", 
     RowBox[{"{", 
      RowBox[{"indpos", ",", "MTtmp1"}], "}"}]}]}], ")"}]}]], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ST", "[", 
    RowBox[{"t1_", ",", "tind_", ",", "val_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"STtmp1", "=", "t1"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"up", "[", 
         RowBox[{"tind", ",", 
          RowBox[{"t1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=!=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "tind", "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Error in Index Assignment!!\>\"", "]"}], 
        ";"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"STtmp1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"t1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "val", ",", 
        RowBox[{"lstind", "[", "tind", "]"}]}], "]"}]}], ";", "STtmp1"}], 
    ")"}]}], "\n"}]], "Input",
 Editable->False],

Cell["\<\


Edited the expression below as 7.0 seems to complain about Sum[x] whereas 6.0 \
would just return x (ie. if there is no sum index!)

\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.465736646430695*^9, 3.4657366879261303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GT", "[", 
   RowBox[{"t1_", ",", "tind_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"GTtmp2", "=", 
     RowBox[{"up", "[", 
      RowBox[{"tind", ",", 
       RowBox[{"t1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"GTtmp3", "=", "\"\<\>\""}], ";", 
    RowBox[{"GTtmp4", "=", "\"\<\>\""}], ";", 
    RowBox[{"GTtmp5", "=", "\"\<\>\""}], ";", 
    RowBox[{"GTtmp6", "=", "t1"}], ";", "\n", "\t\t", 
    RowBox[{"Do", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"GTtmp2", "[", 
          RowBox[{"[", "GTtmp1", "]"}], "]"}], ",", "\n", "\t\t\t\t", "0", 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"GTtmp3", "=", 
            RowBox[{"GTtmp3", "<>", "\"\<,\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"getind", "[", 
               RowBox[{"tind", "[", 
                RowBox[{"[", 
                 RowBox[{"GTtmp1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}],
            ";"}], ")"}], ",", "\n", "\t\t\t\t", "u", ",", "\n", "\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"GTtmp3", "=", 
            RowBox[{"GTtmp3", "<>", "\"\<,\>\"", "<>", "\"\<tmpind\>\"", "<>", 
             RowBox[{"ToString", "[", "GTtmp1", "]"}]}]}], ";", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"GTtmp4", "=", 
            RowBox[{"GTtmp4", "<>", "\"\< Gu[[\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"getind", "[", 
               RowBox[{"tind", "[", 
                RowBox[{"[", 
                 RowBox[{"GTtmp1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
             "<>", "\"\<, tmpind\>\"", "<>", 
             RowBox[{"ToString", "[", "GTtmp1", "]"}], "<>", 
             "\"\<]] \>\""}]}], ";", "\n", "\t\t\t\t\t", 
           RowBox[{"GTtmp5", "=", 
            RowBox[{"GTtmp5", "<>", "\"\<,{tmpind\>\"", "<>", 
             RowBox[{"ToString", "[", "GTtmp1", "]"}], "<>", 
             "\"\<,1,Nind}\>\""}]}]}], ")"}], ",", "\n", "\t\t\t\t", "d", ",",
          "\n", "\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"GTtmp3", "=", 
            RowBox[{"GTtmp3", "<>", "\"\<,\>\"", "<>", "\"\<tmpind\>\"", "<>", 
             RowBox[{"ToString", "[", "GTtmp1", "]"}]}]}], ";", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"GTtmp4", "=", 
            RowBox[{"GTtmp4", "<>", "\"\< Gd[[\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"getind", "[", 
               RowBox[{"tind", "[", 
                RowBox[{"[", 
                 RowBox[{"GTtmp1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
             "<>", "\"\<, tmpind\>\"", "<>", 
             RowBox[{"ToString", "[", "GTtmp1", "]"}], "<>", 
             "\"\<]] \>\""}]}], ";", "\n", "\t\t\t\t\t", 
           RowBox[{"GTtmp5", "=", 
            RowBox[{"GTtmp5", "<>", "\"\<,{tmpind\>\"", "<>", 
             RowBox[{"ToString", "[", "GTtmp1", "]"}], "<>", 
             "\"\<,1,Nind}\>\""}]}], ";"}], ")"}]}], "]"}], ";"}], "\n", 
      "\t\t\t", ",", 
      RowBox[{"{", 
       RowBox[{"GTtmp1", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"t1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GTtmp4", "===", "\"\<\>\""}], "&&", 
       RowBox[{"GTtmp5", "===", "\"\<\>\""}]}], ",", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<GTtmp6[[2\>\"", "<>", "GTtmp3", "<>", "\"\<]]\>\""}], 
       "]"}], ",", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
       "\"\<Sum[GTtmp6[[2\>\"", "<>", "GTtmp3", "<>", "\"\<]]\>\"", "<>", 
        "GTtmp4", "<>", "GTtmp5", "<>", "\"\<]\>\""}], "]"}]}], "]"}]}], 
   ")"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.465736640865263*^9, 3.4657366432796392`*^9}, {
  3.465736699767317*^9, 3.4657367470041943`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Trace, Outer Product and Covariant Derivative! - GREinstein.nb\
\>", "Subsubtitle",
 Editable->False],

Cell["\<\
Syntax:   trT[tensor,{{1,4},{2,3}}]   -  ie. contract 1 and 4 plus 2 and 3 \
positions\
\>", "Text",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"trT", "[", 
   RowBox[{"t1_", ",", "lst_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dimt1", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"t1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmpt1", "=", "t1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "tracetmp", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dimt1", "===", "2"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tracetmp", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"GT", "[", 
           RowBox[{"tmpt1", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"s1", ",", "d"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"s1", ",", "u"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "1", ",", "Nind"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MT", "[", 
        RowBox[{"tracetmp", ",", 
         RowBox[{"dimt1", "-", 
          RowBox[{"2", 
           RowBox[{"Length", "[", "lst", "]"}]}]}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"d", ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{"dimt1", "-", 
              RowBox[{"2", 
               RowBox[{"Length", "[", "lst", "]"}]}]}]}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmpstring1", "=", "\"\<\>\""}], ";", 
       RowBox[{"tmpstring2", "=", "\"\<\>\""}], ";", 
       RowBox[{"tmpstring3", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "}"}], "===", 
             RowBox[{"Position", "[", 
              RowBox[{"lst", ",", "indno"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tmpstring1", "=", 
              RowBox[{"tmpstring1", "<>", "\"\<{i\>\"", "<>", 
               RowBox[{"ToString", "[", "indno", "]"}], "<>", 
               "\"\<,d},\>\""}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"tmpstring3", "=", 
              RowBox[{"tmpstring3", "<>", "\"\<{i\>\"", "<>", 
               RowBox[{"ToString", "[", "indno", "]"}], "<>", 
               "\"\<,1,Nind},\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"tmpstring2", "=", 
           RowBox[{"tmpstring2", "<>", "\"\<{i\>\"", "<>", 
            RowBox[{"ToString", "[", "indno", "]"}], "<>", "\"\<,d},\>\""}]}],
           ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"indno", ",", "1", ",", "dimt1"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmpstring4", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       "\n", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tmpstring4", "=", 
           RowBox[{"tmpstring4", "<>", "\"\<{s\>\"", "<>", 
            RowBox[{"ToString", "[", "indno", "]"}], "<>", 
            "\"\<,1,Nind},\>\""}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"tmpstring2", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"tmpstring2", ",", 
             RowBox[{
              RowBox[{"\"\<i\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"lst", "[", 
                 RowBox[{"[", 
                  RowBox[{"indno", ",", "1"}], "]"}], "]"}], "]"}]}], "->", 
              RowBox[{"\"\<s\>\"", "<>", 
               RowBox[{"ToString", "[", "indno", "]"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"tmpstring2", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"tmpstring2", ",", 
             RowBox[{
              RowBox[{"\"\<i\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"lst", "[", 
                 RowBox[{"[", 
                  RowBox[{"indno", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
               "\"\<,d}\>\""}], "->", 
              RowBox[{"\"\<s\>\"", "<>", 
               RowBox[{"ToString", "[", "indno", "]"}], "<>", 
               "\"\<,u}\>\""}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"indno", ",", "1", ",", 
           RowBox[{"Length", "[", "lst", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmpeval", "=", 
        RowBox[{"\"\<Do[tracetmp=ST[tracetmp,{\>\"", "<>", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"tmpstring1", ",", 
           RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<},Sum[GT[tmpt1,{\>\"", "<>", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"tmpstring2", ",", 
           RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<}],\>\"", "<>", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"tmpstring4", ",", 
           RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<]],\>\"", "<>", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"tmpstring3", ",", 
           RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<]\>\""}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ToExpression", "[", "tmpeval", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "tracetmp"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 Editable->False],

Cell["Syntax:   outerT[tensor1,tensor2] ", "Text",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"outerT", "[", 
   RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dimt1", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"t1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
    RowBox[{"dimt2", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"t2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmpt1", "=", "t1"}], ";", 
    RowBox[{"tmpt2", "=", "t2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "outertmp", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"MT", "[", 
     RowBox[{"outertmp", ",", 
      RowBox[{"dimt1", "+", "dimt2"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"d", ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"dimt1", "+", "dimt2"}]}], "}"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tmpstring1", "=", "\"\<\>\""}], ";", 
    RowBox[{"tmpstring2", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmpstring1", "=", 
        RowBox[{"tmpstring1", "<>", "\"\<{i\>\"", "<>", 
         RowBox[{"ToString", "[", "indno", "]"}], "<>", "\"\<,d},\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmpstring2", "=", 
        RowBox[{"tmpstring2", "<>", "\"\<{i\>\"", "<>", 
         RowBox[{"ToString", "[", "indno", "]"}], "<>", 
         "\"\<,1,Nind},\>\""}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"indno", ",", "1", ",", "dimt1"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tmpstring3", "=", "\"\<\>\""}], ";", 
    RowBox[{"tmpstring4", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", "\n", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmpstring3", "=", 
        RowBox[{"tmpstring3", "<>", "\"\<{j\>\"", "<>", 
         RowBox[{"ToString", "[", "indno", "]"}], "<>", "\"\<,d},\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmpstring4", "=", 
        RowBox[{"tmpstring4", "<>", "\"\<{j\>\"", "<>", 
         RowBox[{"ToString", "[", "indno", "]"}], "<>", 
         "\"\<,1,Nind},\>\""}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"indno", ",", "1", ",", "dimt2"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tmpeval", "=", 
     RowBox[{"\"\<Do[outertmp=ST[outertmp,{\>\"", "<>", "tmpstring1", "<>", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"tmpstring3", ",", 
        RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<},GT[tmpt1,{\>\"", "<>", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"tmpstring1", ",", 
        RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<}]GT[tmpt2,{\>\"", "<>", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"tmpstring3", ",", 
        RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<}]],\>\"", "<>", "tmpstring2",
       "<>", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"tmpstring4", ",", 
        RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<]\>\""}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ToExpression", "[", "tmpeval", "]"}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "outertmp"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"scalarDT", "[", "t1_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmpt1", "=", "t1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "covDTtmp", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"MT", "[", 
     RowBox[{"covDTtmp", ",", "1", ",", 
      RowBox[{"{", "d", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "tmpeval", "=", 
     "\"\<Do[covDTtmp=ST[covDTtmp,{{i1,d}},D[tmpt1,ind[[i1]]]],{i1,1,Nind}]\>\
\""}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ToExpression", "[", "tmpeval", "]"}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "covDTtmp"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"covDT", "[", "t1_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dimt1", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", 
        RowBox[{"t1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmpt1", "=", "t1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "covDTtmp", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MT", "[", 
      RowBox[{"covDTtmp", ",", 
       RowBox[{"dimt1", "+", "1"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"d", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"dimt1", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Build", " ", "expression"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tmpstring1", "=", "\"\<\>\""}], ";", 
     RowBox[{"tmpstring2", "=", "\"\<\>\""}], ";", 
     RowBox[{"tmpstring3", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tmpstring1", "=", 
         RowBox[{"tmpstring1", "<>", "\"\<{i\>\"", "<>", 
          RowBox[{"ToString", "[", "indno", "]"}], "<>", "\"\<,d},\>\""}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmpstring2", "=", 
         RowBox[{"tmpstring2", "<>", "\"\<{i\>\"", "<>", 
          RowBox[{"ToString", "[", "indno", "]"}], "<>", 
          "\"\<,1,Nind},\>\""}]}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"indno", ",", "1", ",", "dimt1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tmpstring4", "=", 
         RowBox[{"\"\<-Sum[GT[tmpt1,{\>\"", "<>", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"tmpstring1", ",", 
            RowBox[{"-", "1"}]}], "]"}], "<>", 
          "\"\<}]GT[\[CapitalGamma],{{REPL,d},{s1,d},{s2,u}}],{s2,1,Nind}]\>\"\
"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmpstring4", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"tmpstring4", ",", 
           RowBox[{
            RowBox[{"\"\<i\>\"", "<>", 
             RowBox[{"ToString", "[", "indno", "]"}]}], "\[Rule]", " ", 
            "\"\<s2\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpstring4", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"tmpstring4", ",", 
           RowBox[{"\"\<REPL\>\"", "\[Rule]", 
            RowBox[{"\"\<i\>\"", "<>", 
             RowBox[{"ToString", "[", "indno", "]"}]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmpstring3", "=", 
         RowBox[{"tmpstring3", "<>", "tmpstring4"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"indno", ",", "1", ",", "dimt1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tmpeval", "=", 
      RowBox[{
      "\"\<Do[covDTtmp=ST[covDTtmp,{\>\"", "<>", "tmpstring1", "<>", 
       "\"\<{s1,d}},D[GT[tmpt1,{\>\"", "<>", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"tmpstring1", ",", 
         RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<}],ind[[s1]]]\>\"", "<>", 
       "tmpstring3", "<>", "\"\<],\>\"", "<>", "tmpstring2", "<>", 
       "\"\<{s1,1,Nind}]\>\""}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", "tmpeval", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "covDTtmp"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 Editable->False],

Cell[BoxData["."], "Input",
 Editable->False,
 CellChangeTimes->{3.399009138941909*^9},
 EmphasizeSyntaxErrors->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Buildmetric", "Subsubtitle",
 Editable->False],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P", "[", "x_", "]"}], "=", 
    RowBox[{"4", "-", 
     RowBox[{"5", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], "4"]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gd", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"x", "^", "2"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "-", "x"}], ")"}], "^", "2"}]}]], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{" ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "^", "2"}], 
          RowBox[{"P", "[", "x", "]"}], 
          RowBox[{"T", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], "0", "0", "0"},
       {"0", 
        RowBox[{
         FractionBox["4", 
          RowBox[{"P", "[", "x", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "+", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"x", ",", "y"}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "x"}], ")"}], "^", "2"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], 
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "0"},
       {"0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], 
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], 
        RowBox[{"B", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "0"},
       {"0", "0", "0", 
        RowBox[{
         RowBox[{"Q", "[", "y", "]"}], 
         RowBox[{
          RowBox[{"Sin", "[", "y", "]"}], "^", "2"}], 
         RowBox[{"S", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}
      }], ")"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "\[Phi]"}], "}"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nind", "=", 
   RowBox[{"Length", "[", "ind", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"BuildMetric", ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.408796998476103*^9, 3.408797030516582*^9}, {
   3.408799071597343*^9, 3.408799082644943*^9}, {3.408949739095245*^9, 
   3.408949739644734*^9}, {3.408949841695282*^9, 3.40894984293303*^9}, {
   3.415862083663703*^9, 3.4158620851642113`*^9}, {3.415862334623486*^9, 
   3.415862336021243*^9}, {3.415862388498528*^9, 3.4158623965197372`*^9}, {
   3.4158641082437763`*^9, 3.415864116357332*^9}, {3.415865034672494*^9, 
   3.415865047473855*^9}, {3.415943026431671*^9, 3.415943056090918*^9}, {
   3.42453089354659*^9, 3.424530981705195*^9}, {3.4262330694486513`*^9, 
   3.426233078224708*^9}, {3.42831552177035*^9, 3.428315531925826*^9}, {
   3.482669504390863*^9, 3.482669559589313*^9}, {3.482669593648382*^9, 
   3.4826696108221407`*^9}, {3.4826696421684*^9, 3.460306349771068*^9}, {
   3.460306681872867*^9, 3.4603066892293873`*^9}, {3.460306743915044*^9, 
   3.460306776656151*^9}, {3.4603068906726713`*^9, 3.4603069154556093`*^9}, 
   3.4606109474491568`*^9, {3.5039972414730186`*^9, 3.503997244123049*^9}, {
   3.5172982618161573`*^9, 3.517298294501769*^9}, {3.517302332920382*^9, 
   3.517302353678054*^9}, {3.51730241996021*^9, 3.517302425934087*^9}, {
   3.517302556663072*^9, 3.5173025584548187`*^9}, 3.517579091871194*^9, {
   3.517642973774815*^9, 3.517642975072443*^9}, 3.517658611602713*^9, {
   3.517660901410638*^9, 3.460392650166881*^9}, {3.4603926980532846`*^9, 
   3.460392722992764*^9}, {3.460396656885631*^9, 3.460356665674651*^9}, {
   3.460356724881654*^9, 3.4603567425493803`*^9}, 3.460372510789526*^9, 
   3.5498611534242992`*^9, {3.549861221304264*^9, 3.549861338866568*^9}, {
   3.5498614170567207`*^9, 3.5498614406904373`*^9}, {3.5498614830595903`*^9, 
   3.549861614471263*^9}, {3.5498624136152153`*^9, 3.549862442786866*^9}, {
   3.549862507318513*^9, 3.5498625115946712`*^9}, {3.549862552901826*^9, 
   3.5498625780523453`*^9}, {3.5498628907617188`*^9, 3.549863049930829*^9}, {
   3.549863146815732*^9, 3.5498633042484007`*^9}, {3.549863346035844*^9, 
   3.549863356771145*^9}, {3.549863391003997*^9, 3.54986340523691*^9}, {
   3.550483302428178*^9, 3.5504833437623863`*^9}, {3.614503576455516*^9, 
   3.6145036679132423`*^9}, {3.614503732778458*^9, 3.6145038618907757`*^9}, {
   3.614504044827949*^9, 3.61450405213966*^9}, {3.6145046217073793`*^9, 
   3.6145046410873117`*^9}, {3.6145048758900623`*^9, 
   3.6145048829295607`*^9}, {3.6145049214498177`*^9, 3.614504952058324*^9}, {
   3.614505030343039*^9, 3.6145050997381144`*^9}, {3.614505294794681*^9, 
   3.614505295979863*^9}, {3.6145151574624443`*^9, 3.614515174587103*^9}, {
   3.614518849157544*^9, 3.614518867253261*^9}, 3.6145219796324*^9, {
   3.6145860614346447`*^9, 3.614586066085288*^9}, {3.614587999153762*^9, 
   3.61458804452868*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"5", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "4"]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "2"], " ", 
       RowBox[{"T", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "-", "x"}], ")"}], "2"], " ", 
       SuperscriptBox["x", "2"]}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"], " ", 
          RowBox[{"A", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"T", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"5", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "4"]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "-", "x"}], ")"}], "2"], " ", 
       SuperscriptBox["x", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], " ", 
       RowBox[{"F", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "-", "x"}], ")"}], "2"], " ", 
       SuperscriptBox["x", "2"]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], " ", 
       RowBox[{"F", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "-", "x"}], ")"}], "2"], " ", 
       SuperscriptBox["x", "2"]}]], ",", 
     FractionBox[
      RowBox[{"B", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "-", "x"}], ")"}], "2"], " ", 
       SuperscriptBox["x", "2"]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"Q", "[", "y", "]"}], " ", 
       RowBox[{"S", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "y", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "-", "x"}], ")"}], "2"], " ", 
       SuperscriptBox["x", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.644103020776038*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "\[Phi]"}], "}"}]], "Output",
 CellChangeTimes->{3.644103020783062*^9}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.644103020791504*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GRrun2.nb", "Subsubtitle",
 Editable->False],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalGamma]", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MT", "[", 
   RowBox[{"\[CapitalGamma]", ",", "3", ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "d", ",", "u"}], "}"}]}], "]"}], ";"}], "\n"}], "Input",
 Editable->False,
 CellTags->"calcgeom"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "R4", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MT", "[", 
   RowBox[{"R4", ",", "4", ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "d", ",", "d", ",", "u"}], "}"}]}], "]"}], 
  ";"}], "\n"}], "Input",
 Editable->False,
 CellTags->"calcgeom"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "R2", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MT", "[", 
   RowBox[{"R2", ",", "2", ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "d"}], "}"}]}], "]"}], ";"}]}], "Input",
 Editable->False,
 CellTags->"calcgeom"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "G2", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MT", "[", 
   RowBox[{"G2", ",", "2", ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "d"}], "}"}]}], "]"}], ";"}]}], "Input",
 Editable->False,
 CellTags->"calcgeom"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]", "=", 
    RowBox[{"ST", "[", 
     RowBox[{"\[CapitalGamma]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", "u"}], "}"}]}], "}"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"GT", "[", 
          RowBox[{"G", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], ",", "u"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "ss1", "]"}], "]"}], ",", "u"}], "}"}]}], 
            "}"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"GT", "[", 
              RowBox[{"G", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind", "[", 
                    RowBox[{"[", "ss1", "]"}], "]"}], ",", "d"}], "}"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"ind", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"GT", "[", 
              RowBox[{"G", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind", "[", 
                    RowBox[{"[", "ss1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"ind", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"GT", "[", 
              RowBox[{"G", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"ind", "[", 
              RowBox[{"[", "ss1", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ss1", ",", "1", ",", "Nind"}], "}"}]}], "]"}]}], "]"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"i1", ",", "1", ",", "Nind"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i2", ",", "1", ",", "Nind"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i3", ",", "1", ",", "Nind"}], "}"}]}], "]"}]], "Input",
 Editable->False,
 CellTags->"calcgeom"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]", "=", 
   RowBox[{"Simplify", "[", "\[CapitalGamma]", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.426232729469757*^9, 3.426232735540435*^9}, {
  3.614593184362365*^9, 3.614593184832036*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\n", "\t", 
  RowBox[{
   RowBox[{"R4", "=", 
    RowBox[{"ST", "[", 
     RowBox[{"R4", ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", "u"}], "}"}]}], "}"}], ",", 
      "\n", "\t", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"GT", "[", 
          RowBox[{"\[CapitalGamma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i4", "]"}], "]"}], ",", "u"}], "}"}]}], "}"}]}],
           "]"}], ",", 
         RowBox[{"ind", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"GT", "[", 
          RowBox[{"\[CapitalGamma]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ind", "[", 
                RowBox[{"[", "i4", "]"}], "]"}], ",", "u"}], "}"}]}], "}"}]}],
           "]"}], ",", 
         RowBox[{"ind", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "+", "\n", "\t\t\t", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"GT", "[", 
            RowBox[{"\[CapitalGamma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i3", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "ss1", "]"}], "]"}], ",", "u"}], "}"}]}], 
              "}"}]}], "]"}], 
           RowBox[{"GT", "[", 
            RowBox[{"\[CapitalGamma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "ss1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i4", "]"}], "]"}], ",", "u"}], "}"}]}], 
              "}"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"GT", "[", 
            RowBox[{"\[CapitalGamma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i3", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "ss1", "]"}], "]"}], ",", "u"}], "}"}]}], 
              "}"}]}], "]"}], 
           RowBox[{"GT", "[", 
            RowBox[{"\[CapitalGamma]", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "ss1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ind", "[", 
                  RowBox[{"[", "i4", "]"}], "]"}], ",", "u"}], "}"}]}], 
              "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ss1", ",", "1", ",", "Nind"}], "}"}]}], "]"}]}]}], "\n", 
     "\t\t", "\n", "\t\t", "]"}]}], "\n", "\t\t", ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"i1", ",", "1", ",", "Nind"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i2", ",", "1", ",", "Nind"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i3", ",", "1", ",", "Nind"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i4", ",", "1", ",", "Nind"}], "}"}]}], "]"}]], "Input",
 Editable->False,
 CellTags->"calcgeom"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"R2", "=", 
    RowBox[{"ST", "[", 
     RowBox[{"R2", ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}]}], "}"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"GT", "[", 
         RowBox[{"R4", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ind", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", "d"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ind", "[", 
               RowBox[{"[", "ss1", "]"}], "]"}], ",", "u"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ind", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", "d"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ind", "[", 
               RowBox[{"[", "ss1", "]"}], "]"}], ",", "d"}], "}"}]}], "}"}]}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ss1", ",", "1", ",", "Nind"}], "}"}]}], "]"}]}], "\n", 
     "\t\t", "]"}]}], "\n", "\t", ",", 
   RowBox[{"{", 
    RowBox[{"i1", ",", "1", ",", "Nind"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i2", ",", "1", ",", "Nind"}], "}"}]}], "]"}]], "Input",
 Editable->False,
 CellTags->"calcgeom"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Harmonic Einstein equations", "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614585244446553*^9, 3.614585249301941*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", "1"}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614505911447616*^9, 3.614505951006248*^9}, 
   3.6145127456114063`*^9, 3.614518961937374*^9, {3.614588052802936*^9, 
   3.614588063735674*^9}}],

Cell["Create reference connection \[CapitalGamma]0", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]0", "=", 
   RowBox[{"Simplify", "[", "\[CapitalGamma]", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614505905584175*^9, 3.614505940335352*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"T", ",", "A", ",", "B", ",", "F", ",", "S"}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.61450595488443*^9, 3.614505959406155*^9}, {
  3.6145129485202103`*^9, 3.614512948800308*^9}, {3.6145152940481033`*^9, 
  3.6145153095364037`*^9}}],

Cell["Difference the connections \[CapitalGamma] and the reference \
connection", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.61458557503995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[CapitalGamma]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "d", ",", "u"}], "}"}], ",", 
     RowBox[{
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"\[CapitalGamma]0", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614517686575716*^9, 3.614517702624796*^9}}],

Cell["Create the \[Xi] vector by contracting this difference", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.614585583679666*^9}, {3.614585620055389*^9, 
  3.614585629794331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]", "=", 
   RowBox[{"trT", "[", 
    RowBox[{"d\[CapitalGamma]", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614506019952074*^9, 3.614506044381568*^9}, {
  3.614506077934951*^9, 3.6145060968059597`*^9}, {3.614593144265449*^9, 
  3.614593146664258*^9}}],

Cell["Take the covariant derivative \[Del]\[Xi]", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.614585583679666*^9}, {3.614585620055389*^9, 
  3.614585669734633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Xi]", "=", 
   RowBox[{"covDT", "[", "\[Xi]", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145060991178617`*^9, 3.614506114045738*^9}, {
  3.6145066679826307`*^9, 3.614506669670529*^9}}],

Cell["And symmetrize it", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.614585583679666*^9}, {3.614585620055389*^9, 
  3.614585679646414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"symd\[Xi]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "d"}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d\[Xi]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"Transpose", "[", 
         RowBox[{"d\[Xi]", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}]}], "}"}]}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614506119121779*^9, 3.6145061544028378`*^9}, {
  3.614506710952483*^9, 3.614506713225738*^9}}],

Cell["Construct the harmonic Einstein equations", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.614585583679666*^9}, {3.614585620055389*^9, 
  3.61458569235865*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EinEq", "=", 
   RowBox[{
    RowBox[{"R2", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "+", 
    RowBox[{"3", "Gd"}], "-", " ", 
    RowBox[{"symd\[Xi]", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614506194098303*^9, 3.614506218625701*^9}, 
   3.614506732645961*^9, {3.614507094770166*^9, 3.6145071002914333`*^9}}],

Cell["Construct the norm \[Xi].\[Xi]", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.614585583679666*^9}, {3.614585620055389*^9, 
  3.614585708349897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]sqr", "=", 
   RowBox[{"trT", "[", 
    RowBox[{
     RowBox[{"outerT", "[", 
      RowBox[{"\[Xi]", ",", "\[Xi]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145177164195843`*^9, 3.614517743304159*^9}, {
  3.614517779407414*^9, 3.614517780822051*^9}}],

Cell["\<\
Put the non-vanishing components of the Einstein equations into a list, \
EinList.\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614585216517089*^9, 3.6145852327702427`*^9}, {
  3.614585564666483*^9, 3.614585583679666*^9}, {3.614585620055389*^9, 
  3.614585736477336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EinList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"EinEq", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"EinEq", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"EinEq", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"EinEq", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"EinEq", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614506780516389*^9, 3.6145068145142193`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 1 - the ansatz", "Subtitle",
 Editable->False,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/TT4wbLDqS8d4+SWLAfTTNvaUopfOhou+wamfXiL
6/93vXSMuJXQAKLPVc48tm/iS8e7F+aD6TlHv9u1cL1y9CzlupZx4qXjtjTG
6+HSrxy9IxLBdMW5s0JXkl85rjlRKQyiD+8MP3Kp6JVj28N6MO112OMmiDZq
nwWmg474cVwG0vNux4Hpfb8tU0G0wNy4NBB9TlK0BkSHn/ME04s6nb2vAOm5
/DFg2mVZZgpTySvH23cng2mFwj1zQfS877bzQLSX3dxAuXevHB86fQXTObbZ
xW5AmsGtoARE/7pysBpE6+aw1YHo5rgHp91B6uzTzoBo5yK/IE8gLePDEQKi
Ab08qsc=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", "[", "y_", "]"}], ":=", "1"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614592655475396*^9, 3.614592655571638*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", "1"}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614592656718527*^9, 3.614592669756716*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"R2", "[", 
    RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
   RowBox[{"3", " ", "Gd"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614592677782209*^9, 3.614592683033539*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"R2", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "+", 
   RowBox[{"3", " ", "Gd"}], "-", 
   RowBox[{"symd\[Xi]", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{3.6145926909998617`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"T", ",", "A", ",", "B", ",", "F", ",", "S", ",", "Q"}], 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145950414333887`*^9, 3.614595045734807*^9}}],

Cell[BoxData[
 RowBox[{"met", "=", 
  RowBox[{
   RowBox[{"Dt", "[", "ind", "]"}], ".", "Gd", ".", 
   RowBox[{"Dt", "[", "ind", "]"}]}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614592699983016*^9, 3.6145927143691273`*^9}}],

Cell[BoxData[{
 RowBox[{"By", " ", "comparing", " ", "with"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SuperscriptBox["ds", "2"], " ", "=", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "r", "]"}], 
     SuperscriptBox["dt", "2"]}], " ", "+", " ", 
    FractionBox[
     SuperscriptBox["dr", "2"], 
     RowBox[{"h", "[", "r", "]"}]], "+", 
    RowBox[{
     SuperscriptBox["r", "2"], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       SuperscriptBox["d\[Theta]", "2"], "+", " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
        SuperscriptBox["d\[Phi]", "2"]}]}], " ", ")"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"for", " ", 
    RowBox[{"h", "[", "r", "]"}]}], "=", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", "1", "-", 
    FractionBox["2", "r"]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"we", " ", "see", " ", "that", " ", "we", " ", "require"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]", "=", 
  RowBox[{
   RowBox[{"y", " ", "and", " ", "r"}], "=", 
   FractionBox["1", 
    RowBox[{"x", 
     RowBox[{"(", 
      RowBox[{"2", "-", "x"}], ")"}]}]]}]}]}], "Text",
 Editable->False,
 CellChangeTimes->{{3.614588610901991*^9, 3.6145887427331543`*^9}, {
   3.614588784657811*^9, 3.6145888031153173`*^9}, {3.614588843560465*^9, 
   3.614588963369417*^9}, 3.61459224038104*^9, {3.614592348350897*^9, 
   3.614592351433765*^9}, {3.614592456210737*^9, 3.6145924567747097`*^9}, {
   3.61459273634824*^9, 3.614592747065029*^9}, {3.614592802089707*^9, 
   3.614592804473123*^9}, {3.614592888497813*^9, 3.6145929000129623`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"met2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", "r", "]"}], 
      RowBox[{
       RowBox[{"Dt", "[", "t", "]"}], "^", "2"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Dt", "[", "r", "]"}], "^", "2"}], 
      RowBox[{"h", "[", "r", "]"}]], "+", 
     RowBox[{
      RowBox[{"r", "^", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dt", "[", "\[Theta]", "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], " ", 
         RowBox[{
          RowBox[{"Dt", "[", "\[Phi]", "]"}], "^", "2"}]}]}], ")"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", "r_", "]"}], ":=", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", "1", "-", 
    FractionBox["2", "r"]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"x", 
      RowBox[{"(", 
       RowBox[{"2", "-", "x"}], ")"}]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", "y"}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145927686948423`*^9, 3.614592771947454*^9}, {
  3.614592806872137*^9, 3.614592873533552*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"met2", "-", "met"}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145928585470448`*^9, 3.614592884392941*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"r", ",", "\[Theta]", ",", "h"}], "]"}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145929099057503`*^9, 3.614592917712286*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Problem 2 - discretizing the equations and a check that Q=1 is solved by \
AdS-Schwarschild\
\>", "Subtitle",
 Editable->False,
 CellChangeTimes->{{3.408796983010241*^9, 3.408796989128707*^9}, {
   3.415942197687789*^9, 3.415942199707787*^9}, {3.428318203595373*^9, 
   3.4283182110266533`*^9}, {3.4318556687961187`*^9, 3.431855668994246*^9}, {
   3.495174647742872*^9, 3.460515504326817*^9}, {3.503996600043788*^9, 
   3.503996603042028*^9}, {3.5419997664314537`*^9, 3.541999771805746*^9}, {
   3.549861410741426*^9, 3.5498614119962797`*^9}, {3.549861578273839*^9, 
   3.5498615808290033`*^9}, {3.549861954461465*^9, 3.5498619549643087`*^9}, {
   3.5498626978119802`*^9, 3.5498627069566727`*^9}, {3.5498628806594*^9, 
   3.549862882306438*^9}, {3.549864538110551*^9, 3.549864538876906*^9}, {
   3.550483235301546*^9, 3.550483236620832*^9}, {3.550483693888809*^9, 
   3.5504836979364767`*^9}, {3.6145035649138536`*^9, 3.614503567664414*^9}, {
   3.614585755351248*^9, 3.614585763508545*^9}, {3.614585822057248*^9, 
   3.614585840200705*^9}, 3.614588511011537*^9, {3.614592545674659*^9, 
   3.614592547034919*^9}, {3.6145929345540133`*^9, 3.614592939920896*^9}}],

Cell[BoxData[
 RowBox[{"Firstly", " ", "we", " ", "will", " ", "use", " ", "exactly", " ", 
  "the", " ", "same", " ", "code", " ", "as", " ", "in", " ", "Exercise", " ",
   "1", " ", "to", " ", "generate", " ", "grid", " ", "and", " ", 
  "discretize", " ", "functionson", " ", "it", " ", "with", " ", "the", " ", 
  "appropriate", " ", "boundary", " ", 
  RowBox[{"conditions", ".", " ", "The"}], " ", "below", " ", "code", " ", 
  "is", " ", "exactly", " ", "the", " ", "same", " ", "as", " ", "for", " ", 
  "Exercise", " ", "1."}]], "Text",
 Editable->False,
 CellChangeTimes->{{3.614585844554368*^9, 3.614585869874013*^9}, {
  3.614585994071548*^9, 3.614586012384099*^9}, {3.614587989301999*^9, 
  3.614587992903851*^9}, {3.614588081240851*^9, 3.614588148750102*^9}, {
  3.614589092377944*^9, 3.614589272821694*^9}, {3.614590969945325*^9, 
  3.614591028600806*^9}, {3.614591214527464*^9, 3.614591228691869*^9}, {
  3.614591388139455*^9, 3.614591388830089*^9}, {3.614592123827688*^9, 
  3.614592159027808*^9}, {3.614592556323515*^9, 3.614592604164275*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NX", "=", "8"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NY", "=", "8"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"interpolationOrder", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6145303865786867`*^9, 3.614530390572673*^9}, {
   3.614530427651465*^9, 3.614530428473796*^9}, {3.614531398025475*^9, 
   3.614531399361471*^9}, 3.6145807075213633`*^9, {3.614592987224511*^9, 
   3.614592988551828*^9}, {3.6145933099533987`*^9, 3.614593311261826*^9}, {
   3.614594946500606*^9, 3.614594947605751*^9}, {3.614595577974928*^9, 
   3.614595578927058*^9}, {3.61460024747838*^9, 3.614600248427435*^9}}],

Cell[CellGroupData[{

Cell["Setup discretization - extracted from Exercise 1", "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.614593295861124*^9}, {
  3.614594164457634*^9, 3.6145941668979177`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"array", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boundary", "=", 
    RowBox[{"{", "}"}]}], ";", 
   RowBox[{"interior", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count1", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count2", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"boundary", ",", 
          RowBox[{"count", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"array", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<b\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"count1", "++"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"interior", ",", 
          RowBox[{"count", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"array", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<f\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"count2", "++"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "NX"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", "NY"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1."}], ")"}], 
          RowBox[{"(", 
           RowBox[{"NX", "-", "0.5"}], ")"}]], ",", 
         RowBox[{"2", "\[Pi]", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "0.5"}], ")"}], 
           RowBox[{"(", "NY", ")"}]]}]}], "}"}], ",", "#2"}], "}"}], "]"}], "@@@",
     "array"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614490948611979*^9, 3.614490949133404*^9}, {
   3.614491066717723*^9, 3.614491125572743*^9}, {3.614491168444928*^9, 
   3.614491248915493*^9}, {3.6144912837342052`*^9, 3.614491399683971*^9}, {
   3.61449144347707*^9, 3.614491618367524*^9}, {3.6144916502730703`*^9, 
   3.614491650601327*^9}, {3.614491681093424*^9, 3.614491707587887*^9}, {
   3.61449173964145*^9, 3.614491754304418*^9}, {3.614491991437695*^9, 
   3.6144921247146063`*^9}, {3.614492173967345*^9, 3.614492230543776*^9}, {
   3.6144935032077303`*^9, 3.614493546616418*^9}, {3.614493597438211*^9, 
   3.614493599582695*^9}, {3.614493885541829*^9, 3.614493885898114*^9}, {
   3.614494142957699*^9, 3.614494146807969*^9}, {3.614494299418024*^9, 
   3.6144943260964327`*^9}, {3.614494683054352*^9, 3.6144947425534563`*^9}, {
   3.614494774656637*^9, 3.614494776043077*^9}, {3.614494875727984*^9, 
   3.614494898961502*^9}, {3.614495758276513*^9, 3.6144958049420443`*^9}, {
   3.614496598307961*^9, 3.614496645906208*^9}, {3.6144969829505787`*^9, 
   3.614497006164504*^9}, {3.614499193949827*^9, 3.6144992415659113`*^9}, {
   3.614499750709916*^9, 3.614499763076477*^9}, {3.6145009194065847`*^9, 
   3.614501012634551*^9}, {3.614501147026832*^9, 3.614501161360704*^9}, {
   3.614501619140008*^9, 3.614501642753359*^9}, {3.614508961605669*^9, 
   3.61450896222124*^9}, {3.6145090497187977`*^9, 3.614509050333304*^9}, 
   3.614509084774301*^9, {3.6145198596647177`*^9, 3.614519861025425*^9}, {
   3.6145774630593576`*^9, 3.614577464384624*^9}, 3.614580707524137*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"boundaryvar", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<b\>\"", "<>", 
       RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"count1", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145775230548697`*^9, 3.6145775294853687`*^9}, 
   3.614580707542231*^9, {3.614593003024508*^9, 3.614593011959347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"interiorvar", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<f\>\"", "<>", 
       RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"count2", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145775230548697`*^9, 3.614577532629661*^9}, 
   3.614580707545454*^9, {3.614593003678658*^9, 3.614593012591413*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"boundaryvar", ",", "interiorvar"}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145775230548697`*^9, 3.614577532629661*^9}, 
   3.614580707548738*^9, 3.614593013271974*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{"Length", "[", "grid", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{3.6145807075530367`*^9, 3.6145930219503403`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sizeboundary", "=", 
    RowBox[{"Length", "[", "boundary", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeinterior", "=", 
   RowBox[{"Length", "[", "interior", "]"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.61457795920792*^9, 3.614577959545187*^9}, 
   3.614580707557004*^9, {3.614593031409151*^9, 3.614593032010467*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"griddouble", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"grid", ",", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "-", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"#1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "#2"}], "}"}], 
       "]"}], "@@@", "grid"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6144937709292*^9, 3.614493792867722*^9}, 
   3.614493840291645*^9, 3.614580707563903*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridfull", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"2", "\[Pi]"}]}]}], "}"}], ",", "#2"}], "}"}], "]"}], "@@@",
       "griddouble"}], ",", "griddouble", ",", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", 
            RowBox[{"2", "\[Pi]"}]}]}], "}"}], ",", "#2"}], "}"}], "]"}], "@@@",
       "griddouble"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614492193317868*^9, 3.614492220313496*^9}, {
   3.614493696165401*^9, 3.614493765749354*^9}, {3.614493809814633*^9, 
   3.614493836687636*^9}, {3.614520090320492*^9, 3.61452009836322*^9}, 
   3.614577640453486*^9, 3.614577730079754*^9, 3.614580707567535*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fninterp", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"gridfull", ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "interpolationOrder"}]}], 
    "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614493859552343*^9, 3.614493860439653*^9}, {
   3.614494083426981*^9, 3.6144940872501907`*^9}, {3.614495075177869*^9, 
   3.6144950787625933`*^9}, 3.614497526026338*^9, 3.61449796966538*^9, 
   3.61449828200152*^9, {3.614498376819167*^9, 3.614498376883424*^9}, {
   3.614498793381364*^9, 3.614498826709447*^9}, {3.6144989558463182`*^9, 
   3.614498973837081*^9}, {3.614499453795888*^9, 3.614499474556699*^9}, 
   3.6144997814050694`*^9, 3.614500178934518*^9, 3.6145019727426023`*^9, 
   3.614580707578149*^9, 3.614593048038927*^9, {3.614593303257522*^9, 
   3.6145933053503923`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dxfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dyfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dxxfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dyyfninterp", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"fninterp", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxyfninterp", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"fninterp", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{3.6145807075799093`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xval", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yval", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fval", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"grid", "[", 
      RowBox[{"[", 
       RowBox[{"ii", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145006261275797`*^9, 3.61450065104106*^9}, 
   3.614580707581608*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<This takes \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dxfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dxfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dyfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dyfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dxxfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dxxfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dyyfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dyyfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dxyfval", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{"dxyfninterp", "[", 
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
            "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< seconds to run!\>\""}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614494096647558*^9, 3.6144941530582533`*^9}, {
   3.614494216552705*^9, 3.614494248459633*^9}, {3.614494527655267*^9, 
   3.614494551254593*^9}, {3.614494810605715*^9, 3.614494815150736*^9}, {
   3.61449491846887*^9, 3.614494931619648*^9}, {3.614494973004328*^9, 
   3.6144950167935953`*^9}, {3.614495098260392*^9, 3.614495098468608*^9}, {
   3.614495160830015*^9, 3.614495195481889*^9}, {3.614497056200307*^9, 
   3.614497076775544*^9}, {3.6144984966667213`*^9, 3.614498511232622*^9}, {
   3.614500053625019*^9, 3.614500107285192*^9}, {3.6145002747399817`*^9, 
   3.614500279042839*^9}, {3.6145005259529247`*^9, 3.6145005727343807`*^9}, {
   3.6145006098995934`*^9, 3.614500613074885*^9}, {3.6145006567586393`*^9, 
   3.6145006660837393`*^9}, {3.614578002884861*^9, 3.6145780284196253`*^9}, 
   3.614580707584566*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
New functions required for discretization harmonic Einstein equations\
\>", "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.6145932836165457`*^9}, {
  3.6145933349515257`*^9, 3.614593341043892*^9}, {3.614593392209838*^9, 
  3.6145933952341623`*^9}, {3.614594143010592*^9, 3.6145941609222097`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Trepl", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "->", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<T\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Arepl", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "->", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<A\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Brepl", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "->", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<B\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Frepl", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fval", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "->", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<F\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Srepl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fval", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], "->", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<S\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"fval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614509622754085*^9, 3.614509698333911*^9}, {
   3.6145098454922657`*^9, 3.614509875838499*^9}, {3.614509993405115*^9, 
   3.614510099093751*^9}, 3.6145160382702723`*^9, 3.614516074483683*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tval", "=", 
    RowBox[{"fval", "/.", "Trepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Aval", "=", 
    RowBox[{"fval", "/.", "Arepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bval", "=", 
    RowBox[{"fval", "/.", "Brepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fval", "=", 
    RowBox[{"fval", "/.", "Frepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sval", "=", 
   RowBox[{"fval", "/.", "Srepl"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614510234567411*^9, 3.614510271942471*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dxTval", "=", 
    RowBox[{"dxfval", "/.", "Trepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxAval", "=", 
    RowBox[{"dxfval", "/.", "Arepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxBval", "=", 
    RowBox[{"dxfval", "/.", "Brepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxFval", "=", 
    RowBox[{"dxfval", "/.", "Frepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxSval", "=", 
   RowBox[{"dxfval", "/.", "Srepl"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614510130178131*^9, 3.6145101693925667`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dyTval", "=", 
    RowBox[{"dyfval", "/.", "Trepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyAval", "=", 
    RowBox[{"dyfval", "/.", "Arepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyBval", "=", 
    RowBox[{"dyfval", "/.", "Brepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyFval", "=", 
    RowBox[{"dyfval", "/.", "Frepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dySval", "=", 
   RowBox[{"dyfval", "/.", "Srepl"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614510182065446*^9, 3.614510189910441*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dxxTval", "=", 
    RowBox[{"dxxfval", "/.", "Trepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxxAval", "=", 
    RowBox[{"dxxfval", "/.", "Arepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxxBval", "=", 
    RowBox[{"dxxfval", "/.", "Brepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxxFval", "=", 
    RowBox[{"dxxfval", "/.", "Frepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxxSval", "=", 
   RowBox[{"dxxfval", "/.", "Srepl"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.61451019239212*^9, 3.614510200801923*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dyyTval", "=", 
    RowBox[{"dyyfval", "/.", "Trepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyyAval", "=", 
    RowBox[{"dyyfval", "/.", "Arepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyyBval", "=", 
    RowBox[{"dyyfval", "/.", "Brepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyyFval", "=", 
    RowBox[{"dyyfval", "/.", "Frepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyySval", "=", 
   RowBox[{"dyyfval", "/.", "Srepl"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614510202385755*^9, 3.614510215375812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dxyTval", "=", 
    RowBox[{"dxyfval", "/.", "Trepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxyAval", "=", 
    RowBox[{"dxyfval", "/.", "Arepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxyBval", "=", 
    RowBox[{"dxyfval", "/.", "Brepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxyFval", "=", 
    RowBox[{"dxyfval", "/.", "Frepl"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxySval", "=", 
   RowBox[{"dxyfval", "/.", "Srepl"}]}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614510217474165*^9, 3.6145102248397217`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"processT", "[", "ii_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "->", 
       RowBox[{"Tval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
       RowBox[{"dxTval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"dyTval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dxxTval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dyyTval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}], 
       "\[Rule]", 
       RowBox[{"dxyTval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"processA", "[", "ii_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"Aval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
       RowBox[{"dxAval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"dyAval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dxxAval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dyyAval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}], 
       "\[Rule]", 
       RowBox[{"dxyAval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"processB", "[", "ii_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"B", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"Bval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
       RowBox[{"dxBval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"dyBval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dxxBval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dyyBval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}], 
       "\[Rule]", 
       RowBox[{"dxyBval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"processF", "[", "ii_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"Fval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
       RowBox[{"dxFval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{"dyFval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dxxFval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
       RowBox[{"dyyFval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}], 
       "\[Rule]", 
       RowBox[{"dxyFval", "[", 
        RowBox[{"[", 
         RowBox[{"interior", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"processS", "[", "ii_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
      RowBox[{"Sval", "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
      RowBox[{"dxSval", "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
      RowBox[{"dySval", "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
      RowBox[{"dxxSval", "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
      RowBox[{"dyySval", "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y"}], "]"}], 
      "\[Rule]", 
      RowBox[{"dxySval", "[", 
       RowBox[{"[", 
        RowBox[{"interior", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{{3.614593609804944*^9, 3.614593859603733*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bcrepl", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<T\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"boundary", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeboundary"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<A\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"boundary", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeboundary"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<B\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"boundary", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeboundary"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<F\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"boundary", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeboundary"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<S\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"boundary", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeboundary"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145142219837418`*^9, 3.614514276483529*^9}, 
   3.6145161695407047`*^9, 3.614519081360128*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Discretize harmonic Einstein equations; set Q=1; create ",
 StyleBox["compiled",
  FontWeight->"Bold"],
 " function \[OpenCurlyQuote]eqfn\[CloseCurlyQuote] to evaluate the equations."
}], "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.6145932836165457`*^9}, {
   3.6145933349515257`*^9, 3.614593341043892*^9}, {3.614593392209838*^9, 
   3.6145933952341623`*^9}, 3.614594143010592*^9, {3.614594173833461*^9, 
   3.6145941762654943`*^9}, {3.614594217143306*^9, 3.6145942359168987`*^9}, {
   3.614594336317912*^9, 3.6145943367011957`*^9}, {3.614594520899947*^9, 
   3.614594522425743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Q", "[", "y_", "]"}], "=", "1"}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.61459339900336*^9, 3.6145934024821577`*^9}}],

Cell["\<\
Creating the equations at the interior grid points can take a mintue at \
NX=NY=8, or longer at higher resolution...\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614593953969911*^9, 3.61459397709235*^9}, {
  3.614594053044016*^9, 3.6145940858803053`*^9}, {3.614595785879574*^9, 
  3.6145957872075167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<This took \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"equations", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"EinList", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}], "//.", 
                RowBox[{"processT", "[", "ii", "]"}]}], "//.", 
               RowBox[{"processA", "[", "ii", "]"}]}], "//.", 
              RowBox[{"processB", "[", "ii", "]"}]}], "//.", 
             RowBox[{"processF", "[", "ii", "]"}]}], "//.", 
            RowBox[{"processS", "[", "ii", "]"}]}], "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"xval", "[", 
               RowBox[{"[", 
                RowBox[{"interior", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"yval", "[", 
               RowBox[{"[", 
                RowBox[{"interior", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< seconds\>\""}], "]"}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614593512017146*^9, 3.614593512903466*^9}, {
  3.614593575265771*^9, 3.614593583593704*^9}, {3.614593868758278*^9, 
  3.6145938918691883`*^9}, {3.614593928735358*^9, 3.614593950060408*^9}}],

Cell["Need lists of arguments for compiled function;", "Text",
 Editable->False,
 CellChangeTimes->{{3.614593953969911*^9, 3.61459397709235*^9}, {
  3.614594053044016*^9, 3.6145940858803053`*^9}, {3.614594250166045*^9, 
  3.6145942545404453`*^9}, {3.61459430291787*^9, 3.61459430676532*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varlist", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<T\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", 
            RowBox[{"interior", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<A\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", 
            RowBox[{"interior", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<B\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", 
            RowBox[{"interior", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<F\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", 
            RowBox[{"interior", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<S\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"fval", "[", 
           RowBox[{"[", 
            RowBox[{"interior", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614511478572686*^9, 3.6145115613234987`*^9}, {
   3.614511613761094*^9, 3.614511613863398*^9}, {3.614516455293507*^9, 
   3.614516456474341*^9}, 3.6145943011578074`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"arglist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"varlist", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", "_Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "varlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqfn", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "arglist", "]"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"equations", "/.", "bcrepl"}], "]"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{
  3.6145943479329987`*^9, {3.614595145358122*^9, 3.614595164988865*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluate it for T=B=F=1, A=F=0", "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.6145932836165457`*^9}, {
   3.6145933349515257`*^9, 3.614593341043892*^9}, {3.614593392209838*^9, 
   3.6145933952341623`*^9}, 3.614594143010592*^9, {3.614594173833461*^9, 
   3.6145941762654943`*^9}, {3.614594217143306*^9, 3.6145942359168987`*^9}, {
   3.614594336317912*^9, 3.6145943367011957`*^9}, {3.614594372604888*^9, 
   3.6145943817882013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"interiorrepl", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<T\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"interior", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<A\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"interior", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<B\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"interior", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<F\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"interior", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<S\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"fval", "[", 
            RowBox[{"[", 
             RowBox[{"interior", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614512605537135*^9, 3.614512668868123*^9}, {
   3.6145140916935577`*^9, 3.6145140923178453`*^9}, {3.6145141672968683`*^9, 
   3.614514167763968*^9}, 3.614514208975872*^9, {3.614514297770171*^9, 
   3.61451435096504*^9}, 3.614516188865876*^9, 3.6145190826800337`*^9}],

Cell["Show that T = B = F = 1, A = F = 0 is indeed a solution", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145944130674677`*^9, 3.6145944257550087`*^9}}],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"eqfn", "@@", 
   RowBox[{"(", 
    RowBox[{"varlist", "/.", "interiorrepl"}], ")"}]}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614594393909321*^9, 3.6145944043832397`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 3 - solve for a non-trivial Q", "Subtitle",
 Editable->False,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ/TT4wbLDqS8d4+SWLAfTTNvaUopfOhou+wamfXiL
6/93vXSMuJXQAKLPVc48tm/iS8e7F+aD6TlHv9u1cL1y9CzlupZx4qXjtjTG
6+HSrxy9IxLBdMW5s0JXkl85rjlRKQyiD+8MP3Kp6JVj28N6MO112OMmiDZq
nwWmg474cVwG0vNux4Hpfb8tU0G0wNy4NBB9TlK0BkSHn/ME04s6nb2vAOm5
/DFg2mVZZgpTySvH23cng2mFwj1zQfS877bzQLSX3dxAuXevHB86fQXTObbZ
xW5AmsGtoARE/7pysBpE6+aw1YHo5rgHp91B6uzTzoDoK9Wzr4No0eQ5YPrl
lYv+nkB6Uvp3MG2y5kEmiN44fW8WiAYAy2TAlA==
  "]],

Cell["We assume here that the code above has been run.", "Text",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.6145932836165457`*^9}, {
   3.6145933349515257`*^9, 3.614593341043892*^9}, {3.614593392209838*^9, 
   3.6145933952341623`*^9}, 3.614594143010592*^9, {3.614594173833461*^9, 
   3.6145941762654943`*^9}, {3.614594217143306*^9, 3.6145942359168987`*^9}, {
   3.614594336317912*^9, 3.6145943367011957`*^9}, {3.614594496796069*^9, 
   3.614594504898326*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Discretize harmonic Einstein equations; set Q=1+0.2 Sin[y]; create ",
 StyleBox["compiled",
  FontWeight->"Bold"],
 " function \[OpenCurlyQuote]eqfn\[CloseCurlyQuote] to evaluate the equations."
}], "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.614593295861124*^9}, {
  3.614594164457634*^9, 3.6145941668979177`*^9}, {3.61459452738727*^9, 
  3.614594552825165*^9}, {3.614596382970037*^9, 3.614596385246714*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Q", "[", "y_", "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{"0.5", " ", 
     RowBox[{"Cos", "[", "y", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.61459339900336*^9, 3.6145934024821577`*^9}, {
   3.6145945320203342`*^9, 3.6145945371384897`*^9}, {3.614594708915113*^9, 
   3.614594709150339*^9}, {3.6145947604281483`*^9, 3.614594760513485*^9}, 
   3.6145955329734163`*^9, {3.614596054509553*^9, 3.614596075936186*^9}, {
   3.614596377499123*^9, 3.614596377880279*^9}, {3.6145979111879787`*^9, 
   3.614597911481009*^9}, {3.614598508738718*^9, 3.6145985087938023`*^9}}],

Cell["\<\
Creating the equations at the interior grid points can take a minute at \
NX=NY=8, or longer at higher resolution...\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.614593953969911*^9, 3.61459397709235*^9}, {
  3.614594053044016*^9, 3.6145940858803053`*^9}, {3.6145957564792624`*^9, 
  3.6145957681976757`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<This took \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"equations", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"EinList", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}], "//.", 
                RowBox[{"processT", "[", "ii", "]"}]}], "//.", 
               RowBox[{"processA", "[", "ii", "]"}]}], "//.", 
              RowBox[{"processB", "[", "ii", "]"}]}], "//.", 
             RowBox[{"processF", "[", "ii", "]"}]}], "//.", 
            RowBox[{"processS", "[", "ii", "]"}]}], "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"xval", "[", 
               RowBox[{"[", 
                RowBox[{"interior", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"yval", "[", 
               RowBox[{"[", 
                RowBox[{"interior", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< seconds\>\""}], "]"}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614593512017146*^9, 3.614593512903466*^9}, {
  3.614593575265771*^9, 3.614593583593704*^9}, {3.614593868758278*^9, 
  3.6145938918691883`*^9}, {3.614593928735358*^9, 3.614593950060408*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqfn", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "arglist", "]"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"equations", "/.", "bcrepl"}], "]"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{
  3.6145943479329987`*^9, {3.614594727486422*^9, 3.6145947280789213`*^9}, 
   3.614595187612946*^9}],

Cell["\<\
Now we see that T = B = S = 1, A = F = 0 is no longer a solution since the \
following is not a zero list;\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145946011319113`*^9, 3.614594621014449*^9}, {
  3.614595640260919*^9, 3.614595647250761*^9}}],

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"eqfn", "@@", 
   RowBox[{"(", 
    RowBox[{"varlist", "/.", "interiorrepl"}], ")"}]}], "]"}]], "Input",
 Editable->False]
}, Open  ]],

Cell[CellGroupData[{

Cell["Use FindRoot to find a solution;", "Subsubtitle",
 Editable->False,
 CellChangeTimes->{{3.614593274944542*^9, 3.614593295861124*^9}, {
  3.614594164457634*^9, 3.6145941668979177`*^9}, {3.61459452738727*^9, 
  3.614594552825165*^9}, {3.6145946300004377`*^9, 3.614594645240554*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varandguess", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"varlist", ",", 
        RowBox[{"varlist", "/.", "interiorrepl"}]}], "]"}], ",", 
      RowBox[{"Length", "[", "varlist", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 Editable->False],

Cell[BoxData[
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Starting norm = \>\"", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{"eqfn", "@@", 
      RowBox[{"(", 
       RowBox[{"varlist", "/.", "interiorrepl"}], ")"}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145946630825577`*^9, 3.614594666031604*^9}}],

Cell["\<\
This will take a while to run ... (around a minute for each step (at NX=NY=8) \
and longer for higher resolution)\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.61459559629705*^9, 3.614595613105488*^9}, {
  3.6145958005933113`*^9, 3.614595828968748*^9}}],

Cell[BoxData[
 RowBox[{"Timing", "[", "\n", 
  RowBox[{
   RowBox[{"solution", "=", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{"eqfn", "@@", "varlist"}], ",", "varandguess", ",", 
      RowBox[{"StepMonitor", "\[RuleDelayed]", 
       RowBox[{"(", "\n", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<norm = \>\"", ",", 
           RowBox[{"Norm", "[", 
            RowBox[{"eqfn", "@@", "varlist"}], "]"}]}], "]"}], ";"}], "\n", 
        ")"}]}]}], "]"}]}], ";"}], "\n", "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145946460757236`*^9, 3.614594673623909*^9}, {
   3.614594800763143*^9, 3.614594810672441*^9}, {3.614594928955797*^9, 
   3.614594936802738*^9}, {3.614596131240685*^9, 3.614596139439226*^9}, 
   3.614596346870429*^9}],

Cell["And we can plot the metric functions T,A,B,F,S...", "Text",
 Editable->False,
 CellChangeTimes->{{3.61459559629705*^9, 3.614595613105488*^9}, {
  3.6145958005933113`*^9, 3.6145958510085382`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Tval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "bcrepl"}], "/.", 
        "solution"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<T\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145146028283577`*^9, 3.614514614818027*^9}, {
  3.614595698069713*^9, 3.61459571219624*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Aval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "bcrepl"}], "/.", 
        "solution"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<A\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614514643952257*^9, 3.614514644226438*^9}, {
  3.614599260924439*^9, 3.614599262925386*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Bval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "bcrepl"}], "/.", 
        "solution"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<B\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614514646375032*^9, 3.614514646762228*^9}, {
  3.614599278054482*^9, 3.6145992802864847`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Fval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "bcrepl"}], "/.", 
        "solution"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<F\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614514648144827*^9, 3.614514648630911*^9}, {
  3.614599284900823*^9, 3.6145992868101177`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Sval", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "/.", "bcrepl"}], "/.", 
        "solution"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "size"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<S\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614514650089451*^9, 3.614514650385511*^9}, {
  3.614599289954957*^9, 3.6145992929652443`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Problem 4 - examine ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", ".", "\[Xi]"}], TraditionalForm]]]
}], "Subtitle",
 Editable->False,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/TT4wbLDqS8d4+SWLAfTTNvaUopfOhou+wamfXiL
6/93vXSMuJXQAKLPVc48tm/iS8e7F+aD6TlHv9u1cL1y9CzlupZx4qXjtjTG
6+HSrxy9IxLBdMW5s0JXkl85rjlRKQyiD+8MP3Kp6JVj28N6MO112OMmiDZq
nwWmg474cVwG0vNux4Hpfb8tU0G0wNy4NBB9TlK0BkSHn/ME04s6nb2vAOm5
/DFg2mVZZgpTySvH23cng2mFwj1zQfS877bzQLSX3dxAuXevHB86fQXTObbZ
xW5AmsGtoARE/7pysBpE6+aw1YHo5rgHp91B6uzTzoDoK9Wzr4No0eQ5YPrl
lYv+nkB6Uvp3MG2y5kEmiN44fW8WiLa7d7wNRMcpvG0H0QAkiMm0
  "]],

Cell["Firstly we must discretize the function xisqr;", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145964325359898`*^9, 3.614596444416749*^9}, 
   3.614596504457769*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<This took \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xisqr", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Xi]sqr", "//.", 
                RowBox[{"processT", "[", "ii", "]"}]}], "//.", 
               RowBox[{"processA", "[", "ii", "]"}]}], "//.", 
              RowBox[{"processB", "[", "ii", "]"}]}], "//.", 
             RowBox[{"processF", "[", "ii", "]"}]}], "//.", 
            RowBox[{"processS", "[", "ii", "]"}]}], "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"xval", "[", 
               RowBox[{"[", 
                RowBox[{"interior", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"yval", "[", 
               RowBox[{"[", 
                RowBox[{"interior", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}]}], 
       ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< seconds\>\""}], "]"}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.614596451002924*^9, 3.6145964910175447`*^9}, {
   3.614596892234618*^9, 3.614596898209216*^9}, 3.614597852354121*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xisqrfn", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "arglist", "]"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"xisqr", "/.", "bcrepl"}], "]"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145964939050694`*^9, 3.6145964991644917`*^9}, {
  3.6145969236844788`*^9, 3.6145969242761374`*^9}}],

Cell["\<\
Now use the StepMonitor method of FindRoot to plot the xisqr function;\
\>", "Text",
 Editable->False,
 CellChangeTimes->{{3.6145964325359898`*^9, 3.614596444416749*^9}, 
   3.614596504457769*^9, {3.614596985651888*^9, 3.614597012786463*^9}}],

Cell[BoxData[
 RowBox[{"Timing", "[", "\n", 
  RowBox[{
   RowBox[{"solution", "=", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{"eqfn", "@@", "varlist"}], ",", "varandguess", ",", 
      RowBox[{"StepMonitor", "\[RuleDelayed]", 
       RowBox[{"(", "\n", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<norm = \>\"", ",", 
           RowBox[{"Norm", "[", 
            RowBox[{"eqfn", "@@", "varlist"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xisqrvalues", "=", 
          RowBox[{"xisqrfn", "@@", "varlist"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"ListPlot3D", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"interior", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "1", ",", "1"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"interior", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "1", ",", "2"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"xisqrvalues", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}]}], "}"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "sizeinterior"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}], ";"}], 
        "\n", ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
  "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6145946460757236`*^9, 3.614594673623909*^9}, {
   3.614594800763143*^9, 3.614594810672441*^9}, {3.614594928955797*^9, 
   3.614594936802738*^9}, {3.614596131240685*^9, 3.614596139439226*^9}, 
   3.614596346870429*^9, {3.614596582462721*^9, 3.6145966622346363`*^9}, {
   3.6145967690170383`*^9, 3.614596783404912*^9}, {3.614597116609578*^9, 
   3.614597121452017*^9}, {3.614597898598811*^9, 3.614597900902823*^9}}]
}, Open  ]]
},
WindowSize->{740, 867},
WindowMargins->{{-353, Automatic}, {876, Automatic}},
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "PastelColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "calcgeom"->{
  Cell[37960, 1030, 306, 9, 90, "Input",
   CellTags->"calcgeom"],
  Cell[38269, 1041, 293, 10, 90, "Input",
   CellTags->"calcgeom"],
  Cell[38565, 1053, 264, 9, 73, "Input",
   CellTags->"calcgeom"],
  Cell[38832, 1064, 264, 9, 73, "Input",
   CellTags->"calcgeom"],
  Cell[39099, 1075, 3551, 100, 166, "Input",
   CellTags->"calcgeom"],
  Cell[42920, 1185, 5599, 153, 328, "Input",
   CellTags->"calcgeom"],
  Cell[48522, 1340, 1615, 48, 141, "Input",
   CellTags->"calcgeom"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"calcgeom", 133704, 3771}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 559, 15, 134, "Subtitle"],
Cell[1141, 39, 432, 7, 29, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1610, 51, 1082, 17, 38, "Subtitle"],
Cell[2695, 70, 210, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[2930, 77, 144, 3, 23, "Subsubtitle"],
Cell[3077, 82, 113, 3, 38, "Input"],
Cell[CellGroupData[{
Cell[3215, 89, 297, 9, 73, "Input"],
Cell[3515, 100, 186, 5, 38, "Output"],
Cell[3704, 107, 586, 16, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4327, 128, 284, 10, 73, "Input"],
Cell[4614, 140, 71, 1, 38, "Output"],
Cell[4688, 143, 72, 1, 38, "Output"]
}, Open  ]],
Cell[4775, 147, 425, 14, 56, "Input"],
Cell[5203, 163, 55, 1, 38, "Input"],
Cell[CellGroupData[{
Cell[5283, 168, 257, 8, 73, "Input"],
Cell[5543, 178, 160, 4, 38, "Output"],
Cell[5706, 184, 70, 1, 38, "Output"]
}, Open  ]],
Cell[5791, 188, 2020, 62, 192, "Input"],
Cell[7814, 252, 44, 1, 38, "Input"],
Cell[7861, 255, 841, 25, 90, "Input"],
Cell[8705, 282, 1026, 31, 107, "Input"],
Cell[9734, 315, 245, 9, 119, "Text"],
Cell[9982, 326, 4015, 95, 481, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14034, 426, 111, 3, 23, "Subsubtitle"],
Cell[14148, 431, 128, 4, 29, "Text"],
Cell[14279, 437, 6139, 139, 923, "Input"],
Cell[20421, 578, 68, 1, 29, "Text"],
Cell[20492, 581, 3727, 84, 668, "Input"],
Cell[24222, 667, 824, 18, 260, "Input"],
Cell[25049, 687, 4051, 89, 719, "Input"],
Cell[29103, 778, 117, 3, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29257, 786, 52, 1, 23, "Subsubtitle"],
Cell[CellGroupData[{
Cell[29334, 791, 5149, 117, 402, "Input"],
Cell[34486, 910, 3156, 103, 161, "Output"],
Cell[37645, 1015, 140, 3, 38, "Output"],
Cell[37788, 1020, 70, 1, 38, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37907, 1027, 50, 1, 23, "Subsubtitle"],
Cell[37960, 1030, 306, 9, 90, "Input",
 CellTags->"calcgeom"],
Cell[38269, 1041, 293, 10, 90, "Input",
 CellTags->"calcgeom"],
Cell[38565, 1053, 264, 9, 73, "Input",
 CellTags->"calcgeom"],
Cell[38832, 1064, 264, 9, 73, "Input",
 CellTags->"calcgeom"],
Cell[39099, 1075, 3551, 100, 166, "Input",
 CellTags->"calcgeom"],
Cell[42653, 1177, 264, 6, 38, "Input"],
Cell[42920, 1185, 5599, 153, 328, "Input",
 CellTags->"calcgeom"],
Cell[48522, 1340, 1615, 48, 141, "Input",
 CellTags->"calcgeom"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50174, 1393, 134, 2, 23, "Subsubtitle"],
Cell[50311, 1397, 973, 32, 175, "Input"],
Cell[51287, 1431, 146, 2, 29, "Text"],
Cell[51436, 1435, 216, 5, 38, "Input"],
Cell[51655, 1442, 298, 6, 38, "Input"],
Cell[51956, 1450, 223, 4, 29, "Text"],
Cell[52182, 1456, 453, 13, 38, "Input"],
Cell[52638, 1471, 254, 4, 29, "Text"],
Cell[52895, 1477, 407, 11, 38, "Input"],
Cell[53305, 1490, 241, 4, 29, "Text"],
Cell[53549, 1496, 246, 6, 38, "Input"],
Cell[53798, 1504, 217, 4, 29, "Text"],
Cell[54018, 1510, 598, 19, 58, "Input"],
Cell[54619, 1531, 240, 4, 29, "Text"],
Cell[54862, 1537, 410, 11, 38, "Input"],
Cell[55275, 1550, 230, 4, 29, "Text"],
Cell[55508, 1556, 417, 12, 38, "Input"],
Cell[55928, 1570, 290, 7, 29, "Text"],
Cell[56221, 1579, 688, 21, 56, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56958, 1606, 478, 10, 22, "Subtitle"],
Cell[57439, 1618, 163, 4, 38, "Input"],
Cell[57605, 1624, 873, 30, 175, "Input"],
Cell[58481, 1656, 258, 7, 38, "Input"],
Cell[58742, 1665, 298, 9, 38, "Input"],
Cell[59043, 1676, 210, 5, 38, "Input"],
Cell[59256, 1683, 235, 6, 38, "Input"],
Cell[59494, 1691, 1734, 46, 225, "Text"],
Cell[61231, 1739, 1347, 43, 210, "Input"],
Cell[62581, 1784, 175, 4, 38, "Input"],
Cell[62759, 1790, 203, 5, 38, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62999, 1800, 1171, 18, 22, "Subtitle"],
Cell[64173, 1820, 1061, 16, 65, "Text"],
Cell[65237, 1838, 739, 16, 107, "Input"],
Cell[CellGroupData[{
Cell[66001, 1858, 206, 3, 23, "Subsubtitle"],
Cell[66210, 1863, 4561, 111, 344, "Input"],
Cell[70774, 1976, 511, 13, 37, "Input"],
Cell[71288, 1991, 509, 13, 37, "Input"],
Cell[71800, 2006, 286, 7, 37, "Input"],
Cell[72089, 2015, 193, 5, 37, "Input"],
Cell[72285, 2022, 437, 11, 68, "Input"],
Cell[72725, 2035, 639, 19, 37, "Input"],
Cell[73367, 2056, 1269, 35, 53, "Input"],
Cell[74639, 2093, 842, 16, 37, "Input"],
Cell[75484, 2111, 1633, 55, 158, "Input"],
Cell[77120, 2168, 1239, 37, 188, "Input"],
Cell[78362, 2207, 4810, 106, 398, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[83209, 2318, 336, 6, 23, "Subsubtitle"],
Cell[83548, 2326, 2839, 83, 158, "Input"],
Cell[86390, 2411, 764, 25, 158, "Input"],
Cell[87157, 2438, 786, 25, 158, "Input"],
Cell[87946, 2465, 784, 25, 158, "Input"],
Cell[88733, 2492, 793, 25, 170, "Input"],
Cell[89529, 2519, 794, 25, 170, "Input"],
Cell[90326, 2546, 796, 25, 170, "Input"],
Cell[91125, 2573, 10613, 321, 470, "Input"],
Cell[101741, 2896, 2763, 76, 215, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[104541, 2977, 634, 12, 23, "Subsubtitle"],
Cell[105178, 2991, 182, 5, 38, "Input"],
Cell[105363, 2998, 325, 7, 47, "Text"],
Cell[105691, 3007, 1960, 46, 192, "Input"],
Cell[107654, 3055, 291, 4, 26, "Text"],
Cell[107948, 3061, 2657, 73, 215, "Input"],
Cell[110608, 3136, 386, 13, 49, "Input"],
Cell[110997, 3151, 364, 10, 49, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111398, 3166, 469, 7, 22, "Subsubtitle"],
Cell[111870, 3175, 2940, 78, 215, "Input"],
Cell[114813, 3255, 159, 2, 26, "Text"],
Cell[114975, 3259, 237, 6, 49, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115261, 3271, 525, 10, 21, "Subtitle"],
Cell[115789, 3283, 478, 7, 26, "Text"],
Cell[CellGroupData[{
Cell[116292, 3294, 460, 9, 22, "Subsubtitle"],
Cell[116755, 3305, 624, 12, 49, "Input"],
Cell[117382, 3319, 327, 7, 26, "Text"],
Cell[117712, 3328, 1960, 46, 185, "Input"],
Cell[119675, 3376, 392, 11, 49, "Input"],
Cell[120070, 3389, 265, 6, 26, "Text"],
Cell[120338, 3397, 169, 5, 49, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120544, 3407, 286, 4, 22, "Subsubtitle"],
Cell[120833, 3413, 358, 11, 65, "Input"],
Cell[121194, 3426, 409, 10, 80, "Input"],
Cell[121606, 3438, 271, 6, 26, "Text"],
Cell[121880, 3446, 788, 19, 110, "Input"],
Cell[122671, 3467, 201, 3, 26, "Text"],
Cell[122875, 3472, 992, 27, 80, "Input"],
Cell[123870, 3501, 991, 27, 80, "Input"],
Cell[124864, 3530, 993, 27, 80, "Input"],
Cell[125860, 3559, 993, 27, 80, "Input"],
Cell[126856, 3588, 993, 27, 80, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127898, 3621, 617, 15, 21, "Subtitle"],
Cell[128518, 3638, 174, 3, 26, "Text"],
Cell[128695, 3643, 1721, 41, 170, "Input"],
Cell[130419, 3686, 393, 10, 49, "Input"],
Cell[130815, 3698, 252, 5, 26, "Text"],
Cell[131070, 3705, 2240, 51, 185, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
