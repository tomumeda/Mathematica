(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96502,       2797]
NotebookOptionsPosition[     91714,       2665]
NotebookOutlinePosition[     92074,       2681]
CellTagsIndexPosition[     92031,       2678]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "Local`QFTToolKit2`"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56864327369387*^9, 3.5686433185337973`*^9}, {
   3.636124223447123*^9, 3.6361242241696672`*^9}, {3.640430449322165*^9, 
   3.640430454418408*^9}, {3.6464973100744457`*^9, 3.646497314447693*^9}, {
   3.6694279608619347`*^9, 3.6694280040414133`*^9}, 3.670117817981682*^9, {
   3.671366579055991*^9, 3.6713666038803663`*^9}, {3.689772928097857*^9, 
   3.689772930433343*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"729cb6f5-a033-44b7-846b-6eccc1103410"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<TensorCalculus5`Tensorial`\>\"", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.702470457818418*^9, 3.702470460290997*^9}, 
   3.7024718130026617`*^9},ExpressionUUID->"6363d270-4533-45f0-9596-\
7b11abbab9e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varnames", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeclareBaseIndices", "[", "varnames", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DeclareIndexFlavor", "[", 
  RowBox[{"{", 
   RowBox[{"red", ",", "Red"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labs", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Delta]", ",", "g", ",", "\[CapitalGamma]"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"DefineTensor", "[", 
  RowBox[{
  "x", ",", "e", ",", "g", ",", "\[Delta]", ",", "R", ",", "G", ",", "L", ",",
    "\[CapitalGamma]"}], "]"}]}], "Input",
 CellID->339455762,ExpressionUUID->"93d54133-9b52-40fc-a4c5-a2211fcda1c8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"k", ",", "Constant"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diagmetric", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", 
           RowBox[{"k", " ", 
            SuperscriptBox["r", "2"]}]}]], ",", 
         RowBox[{
          SuperscriptBox["r", "2"], 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "}"}]}]}], 
        "}"}]}]}], "}"}], "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"cmetric", "=", 
    RowBox[{"DiagonalMatrix", "[", "diagmetric", "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"%", "//", 
    RowBox[{"CoordinatesToTensors", "[", 
     RowBox[{"varnames", ",", "x"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SetTensorValueRules", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "@", 
         RowBox[{"dd", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}], ",", 
        RowBox[{"g", "@", 
         RowBox[{"uu", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"metric", ",", 
        RowBox[{"Inverse", "[", "metric", "]"}]}], "}"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellID->346974339,ExpressionUUID->"f4b0debc-303d-4f81-85e9-f2c8a64fd46e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], 
       RowBox[{"1", "-", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}]}]], "0", "0"},
     {"0", "0", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]}], "0"},
     {"0", "0", "0", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702471890240918*^9},ExpressionUUID->"a7e0d8c1-4ceb-4bf1-8cd2-\
c9d767a2196c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"down\[CapitalGamma]", ",", "up\[CapitalGamma]"}], "}"}], "=", 
   RowBox[{"CalculateChristoffels", "[", "labs", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SetTensorValueRules", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[CapitalGamma]", "@", 
         RowBox[{"ddd", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", 
        RowBox[{"\[CapitalGamma]", "@", 
         RowBox[{"udd", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"down\[CapitalGamma]", ",", "up\[CapitalGamma]"}], "}"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectedTensorRules", "[", 
    RowBox[{
     RowBox[{"\[CapitalGamma]", "@", 
      RowBox[{"udd", "[", 
       RowBox[{"_", ",", "j_", ",", "k_"}], "]"}]}], "/;", 
     RowBox[{"OrderedQ", "[", 
      RowBox[{"{", 
       RowBox[{"j", ",", "k"}], "}"}], "]"}]}], "]"}], "//", 
   RowBox[{"UseCoordinates", "[", 
    RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "TableForm"}]}], "Input",
 CellID->395153889,ExpressionUUID->"b9c7962c-dcd9-47fb-959d-ce3168f6be5f"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], "r", "r"}], 
         RowBox[{"t", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`t, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`r}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], 
        RowBox[{"1", "-", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], "\[Theta]", "\[Theta]"}], 
         RowBox[{"t", 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`t, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Theta], $CellContext`\
\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], "\[Phi]", "\[Phi]"}], 
         RowBox[{"t", 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`t, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Phi], $CellContext`\
\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r", "t"}], 
         RowBox[{"r", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`r, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`t}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], 
        RowBox[{"a", "[", "t", "]"}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "r", "r"}], 
         RowBox[{"r", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`r, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`r}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", " ", "r"}], 
        RowBox[{"1", "-", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "\[Theta]", "\[Theta]"}], 
         RowBox[{"r", 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`r, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Theta], $CellContext`\
\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"k", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "\[Phi]", "\[Phi]"}], 
         RowBox[{"r", 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`r, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Phi], $CellContext`\
\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"k", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], "t", "\[Theta]"}], 
         RowBox[{"\[Theta]", 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`\[Theta], TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`t, \
$CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], 
        RowBox[{"a", "[", "t", "]"}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], "r", "\[Theta]"}], 
         RowBox[{"\[Theta]", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`\[Theta], TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, \
$CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox["1", "r"]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], "\[Phi]", "\[Phi]"}], 
         RowBox[{"\[Theta]", 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`\[Theta], TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Phi], $CellContext`\
\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], "t", "\[Phi]"}], 
         RowBox[{"\[Phi]", 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`\[Phi], TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`t, $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], 
        RowBox[{"a", "[", "t", "]"}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], "r", "\[Phi]"}], 
         RowBox[{"\[Phi]", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`\[Phi], TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox["1", "r"]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[CapitalGamma]", 
         RowBox[{
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], "\[Theta]", "\[Phi]"}], 
         RowBox[{"\[Phi]", 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`\[CapitalGamma], \
{$CellContext`\[Phi], TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Theta], $CellContext`\
\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.70247206391035*^9},ExpressionUUID->"9d42d80f-ccc7-44d0-b303-eeecf79a7e7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"riemannd", "=", 
   RowBox[{"CalculateRiemannd", "[", "labs", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{"R", "@", 
    RowBox[{"dddd", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], "]"}]}],
    ",", "riemannd"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"R", "@", 
        RowBox[{"dddd", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[And]", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"c", ",", "d"}], "}"}], "]"}], "\[And]", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->166546326,ExpressionUUID->"d2036097-e4a0-4d4a-a834-9e3b10c5731b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"t", "\[Theta]", "t", "\[Theta]"}], 
         StyleBox[
          RowBox[{"t", "\[Theta]", "t", "\[Theta]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`t, $CellContext`\
\[Theta], $CellContext`t, $CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"t", "\[Phi]", "t", "\[Phi]"}], 
         StyleBox[
          RowBox[{"t", "\[Phi]", "t", "\[Phi]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`t, $CellContext`\
\[Phi], $CellContext`t, $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"r", "t", "r", "t"}], 
         StyleBox[
          RowBox[{"r", "t", "r", "t"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`r, $CellContext`t, \
$CellContext`r, $CellContext`t}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"r", "\[Theta]", "r", "\[Theta]"}], 
         StyleBox[
          RowBox[{"r", "\[Theta]", "r", "\[Theta]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`r, $CellContext`\
\[Theta], $CellContext`r, $CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"k", "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["a", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"k", " ", 
           SuperscriptBox["r", "2"]}]}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"r", "\[Phi]", "r", "\[Phi]"}], 
         StyleBox[
          RowBox[{"r", "\[Phi]", "r", "\[Phi]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`r, $CellContext`\
\[Phi], $CellContext`r, $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"k", "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["a", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"k", " ", 
           SuperscriptBox["r", "2"]}]}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"\[Theta]", "\[Phi]", "\[Theta]", "\[Phi]"}], 
         StyleBox[
          RowBox[{"\[Theta]", "\[Phi]", "\[Theta]", "\[Phi]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`\[Theta], \
$CellContext`\[Phi], $CellContext`\[Theta], $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        SuperscriptBox["r", "4"], " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7025511387658567`*^9},ExpressionUUID->"2069cf9a-43bc-4867-aaf9-\
d0a0c13eaeaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetRicciContraction", "[", "4", "]"}]], "Input",
 CellID->138414600,ExpressionUUID->"0bf25a4a-bc74-49a8-886d-e4bc2b0ca5d3"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.7025511614536343`*^9},ExpressionUUID->"11f864da-d689-409b-85a9-\
cd8824c2c5c7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "riemann", ",", "ricci4", ",", "scalarcurvature", ",", "einstein"}], 
    "}"}], "=", 
   RowBox[{"CalculateRRRG", "[", 
    RowBox[{"g", ",", "riemannd", ",", "Identity", ",", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellID->501132207,ExpressionUUID->"d2ae07c7-8101-410f-94ed-38a1b95acc1e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.702471727362049*^9, 
  3.702471758594308*^9}},ExpressionUUID->"cb3825eb-30f7-4f52-9189-\
22d9ec3e05da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetRicciContraction", "[", "3", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "riemann", ",", "ricci", ",", "scalarcurvature", ",", "einstein"}], "}"}],
    "=", 
   RowBox[{"CalculateRRRG", "[", 
    RowBox[{"g", ",", "riemannd", ",", "Identity", ",", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellID->259324421,ExpressionUUID->"c8d14be2-6ab4-474d-9330-b86b6b264a66"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{
  3.702551184614636*^9},ExpressionUUID->"fd04d1f8-2431-428b-9e71-\
4f0573a4d4cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ricci4", "\[Equal]", 
   RowBox[{"-", "ricci"}]}], "//", "Simplify"}]], "Input",ExpressionUUID->\
"6257f08f-ad72-424e-8e80-7813b9697ab6"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7025511958349457`*^9},ExpressionUUID->"19f919ad-ca10-4ca5-b86f-\
53b6dfbc807e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{"R", "@", 
    RowBox[{"uddd", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Sigma]", ",", "\[Rho]"}], "]"}]}],
    ",", "riemann"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"R", "@", 
        RowBox[{"uddd", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}]}], "/;", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}], "]"}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->524883454,ExpressionUUID->"6ef598b7-b1bd-44df-9e58-4e2b9c7662d8"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], "r", "r", "t"}], 
         RowBox[{"t", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`t, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`r, \
$CellContext`t}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], 
        RowBox[{"1", "-", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], "\[Theta]", "t", "\[Theta]"}], 
         RowBox[{"t", 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`t, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Theta], \
$CellContext`t, $CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], "\[Phi]", "t", "\[Phi]"}], 
         RowBox[{"t", 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`t, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Phi], $CellContext`t, \
$CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "t", "r", "t"}], 
         RowBox[{"r", 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`r, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`t, $CellContext`r, \
$CellContext`t}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], 
        RowBox[{"a", "[", "t", "]"}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "\[Theta]", "r", "\[Theta]"}], 
         RowBox[{"r", 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`r, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Theta], \
$CellContext`r, $CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], "\[Phi]", "r", "\[Phi]"}], 
         RowBox[{"r", 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`r, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Phi], $CellContext`r, \
$CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], "t", "t", "\[Theta]"}], 
         RowBox[{"\[Theta]", 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`\
\[Theta], TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`t, $CellContext`t, \
$CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], "r", "r", "\[Theta]"}], 
         RowBox[{"\[Theta]", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`\
\[Theta], TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`r, \
$CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], 
        RowBox[{"1", "-", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], "\[Phi]", "\[Theta]", "\[Phi]"}], 
         RowBox[{"\[Theta]", 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`\
\[Theta], TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Phi], $CellContext`\
\[Theta], $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], "t", "t", "\[Phi]"}], 
         RowBox[{"\[Phi]", 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["t",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`\[Phi],
           TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`t, $CellContext`t, \
$CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], "r", "r", "\[Phi]"}], 
         RowBox[{"\[Phi]", 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["r",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`\[Phi],
           TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`r, $CellContext`r, \
$CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], 
        RowBox[{"1", "-", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False], "\[Theta]", "\[Theta]", "\[Phi]"}], 
         RowBox[{"\[Phi]", 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Theta]",
           StripOnInput->False,
           ShowContents->False], 
          StyleBox["\[Phi]",
           StripOnInput->False,
           ShowContents->False]}]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {$CellContext`\[Phi],
           TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {
         TensorCalculus5`Tensorial`Void, $CellContext`\[Theta], $CellContext`\
\[Theta], $CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7025512049503813`*^9},ExpressionUUID->"6ba4a8fd-b55d-47ea-9426-\
b66bcb88ee55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{"R", "@", 
    RowBox[{"dd", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], ",", "ricci"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"R", "@", 
        RowBox[{"dd", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->116766668,ExpressionUUID->"ca85dc23-6374-4c2f-a07e-76eb81c26913"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"t", "t"}], 
         StyleBox[
          RowBox[{"t", "t"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`t, $CellContext`t}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"r", "r"}], 
         StyleBox[
          RowBox[{"r", "r"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`r, $CellContext`r}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "k"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], 
        RowBox[{"1", "-", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"\[Theta]", "\[Theta]"}], 
         StyleBox[
          RowBox[{"\[Theta]", "\[Theta]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`\[Theta], \
$CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"k", "+", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["a", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
          "+", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         RowBox[{"\[Phi]", "\[Phi]"}], 
         StyleBox[
          RowBox[{"\[Phi]", "\[Phi]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`\[Phi], \
$CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"k", "+", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["a", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
          "+", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7025512199756193`*^9},ExpressionUUID->"490328f5-dcbe-4f9f-b604-\
11ec7fb275ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalarcurvature", "//", 
  RowBox[{"UseCoordinates", "[", "varnames", "]"}]}]], "Input",
 CellID->630896927,ExpressionUUID->"d34a2ff0-e27c-4406-8bdf-2c33164a4f21"],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{"k", "+", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "2"]]], "Output",
 CellChangeTimes->{
  3.7025512292778597`*^9},ExpressionUUID->"add8d286-b184-4009-847e-\
3c5b19f8a476"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{"G", "@", 
    RowBox[{"dd", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], ",", "einstein"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"G", "@", 
        RowBox[{"dd", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "]"}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->413731651,ExpressionUUID->"b3305484-1860-44f2-add1-47b4bd8bb287"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         RowBox[{"t", "t"}], 
         StyleBox[
          RowBox[{"t", "t"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`t, $CellContext`t}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"k", "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         RowBox[{"r", "r"}], 
         StyleBox[
          RowBox[{"r", "r"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`r, $CellContext`r}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
         RowBox[{"2", " ", 
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         RowBox[{"\[Theta]", "\[Theta]"}], 
         StyleBox[
          RowBox[{"\[Theta]", "\[Theta]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`\[Theta], \
$CellContext`\[Theta]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         RowBox[{"\[Phi]", "\[Phi]"}], 
         StyleBox[
          RowBox[{"\[Phi]", "\[Phi]"}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void}, {$CellContext`\[Phi], \
$CellContext`\[Phi]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702551243787608*^9},ExpressionUUID->"cb6ea2d0-3d81-4079-b0f3-\
87369869b49a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"OrthonormalTransformation", "[", 
   RowBox[{"cmetric", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"r", ">", "0"}], "\[And]", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ">", "0"}], "\[And]", 
        RowBox[{"0", "<", "\[Theta]", "<", "\[Pi]"}]}]}], "]"}], "&"}]}], 
   "]"}], ";"}], "\n", 
 RowBox[{"Lmatrix", "=", 
  RowBox[{"%", "//", "PowerExpand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", 
   RowBox[{"CoordinatesToTensors", "[", 
    RowBox[{"varnames", ",", "x"}], "]"}]}], ";"}], "\n", 
 RowBox[{"SetTensorValues", "[", 
  RowBox[{
   RowBox[{"L", "@", 
    RowBox[{"ud", "[", 
     RowBox[{"a", ",", 
      RowBox[{"red", "@", "\[Alpha]"}]}], "]"}]}], ",", "%"}], 
  "]"}]}], "Input",
 CellID->416290612,ExpressionUUID->"36502106-337a-4602-8544-8c6edcdeb958"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      SqrtBox[
       RowBox[{"1", "-", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      RowBox[{"a", "[", "t", "]"}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["1", 
      RowBox[{"r", " ", 
       RowBox[{"a", "[", "t", "]"}]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"Csc", "[", "\[Theta]", "]"}], 
      RowBox[{"r", " ", 
       RowBox[{"a", "[", "t", "]"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702551256561405*^9},ExpressionUUID->"81df2203-5c56-480c-b47a-\
1633ef9d947c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "@", 
   RowBox[{"d", "[", 
    RowBox[{"red", "@", "\[Alpha]"}], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"L", "@", 
    RowBox[{"ud", "[", 
     RowBox[{"a", ",", 
      RowBox[{"red", "@", "\[Alpha]"}]}], "]"}]}], 
   RowBox[{"e", "@", 
    RowBox[{"d", "[", "a", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", 
    RowBox[{"ToArrayValues", "[", "]"}]}], "//", "PowerExpand"}], "//", 
  RowBox[{"UseCoordinates", "[", "varnames", "]"}]}]}], "Input",
 CellID->22564133,ExpressionUUID->"d6e26a83-a9d2-41b5-bec9-3514ea714524"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   SubsuperscriptBox["e", 
    StyleBox["\[Alpha]",
     StripOnInput->False,
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     StyleBox["\[Alpha]",
      StripOnInput->False,
      FontColor->RGBColor[1, 0, 0]],
     StripOnInput->False,
     ShowContents->False]],
   TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
    TensorCalculus5`Tensorial`Void}, {
     $CellContext`red[$CellContext`\[Alpha]]}],
   BaseStyle->{AutoMultiplicationSymbol -> False},
   Editable->False], "\[Equal]", 
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["e", "a", 
     StyleBox["a",
      StripOnInput->False,
      ShowContents->False]],
    TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
     TensorCalculus5`Tensorial`Void}, {$CellContext`a}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False], " ", 
   InterpretationBox[
    SubsuperscriptBox["L", 
     RowBox[{
      StyleBox["a",
       ShowContents->False], 
      StyleBox["\[Alpha]",
       FontColor->RGBColor[1, 0, 0]]}], 
     RowBox[{"a", 
      StyleBox[
       StyleBox["\[Alpha]",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       StripOnInput->False,
       ShowContents->False]}]],
    TensorCalculus5`Tensorial`Tensor[$CellContext`L, {$CellContext`a, 
      TensorCalculus5`Tensorial`Void}, {TensorCalculus5`Tensorial`Void, 
      $CellContext`red[$CellContext`\[Alpha]]}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False]}]}]], "Output",
 CellChangeTimes->{
  3.7025512728681917`*^9},ExpressionUUID->"02be2885-083a-42e2-b041-\
c4fbf16b6647"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["e", 
      StyleBox["t",
       StripOnInput->False,
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[
       StyleBox["t",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       StripOnInput->False,
       ShowContents->False]],
     TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
      TensorCalculus5`Tensorial`Void}, {
       $CellContext`red[$CellContext`t]}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Equal]", 
    InterpretationBox[
     SubsuperscriptBox["e", "t", 
      StyleBox["t",
       StripOnInput->False,
       ShowContents->False]],
     TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
      TensorCalculus5`Tensorial`Void}, {$CellContext`t}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], ",", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["e", 
      StyleBox["r",
       StripOnInput->False,
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[
       StyleBox["r",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       StripOnInput->False,
       ShowContents->False]],
     TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
      TensorCalculus5`Tensorial`Void}, {
       $CellContext`red[$CellContext`r]}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Equal]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}]}]], " ", 
      InterpretationBox[
       SubsuperscriptBox["e", "r", 
        StyleBox["r",
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus5`Tensorial`Void}, {$CellContext`r}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], 
     RowBox[{"a", "[", "t", "]"}]]}], ",", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["e", 
      StyleBox["\[Theta]",
       StripOnInput->False,
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[
       StyleBox["\[Theta]",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       StripOnInput->False,
       ShowContents->False]],
     TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
      TensorCalculus5`Tensorial`Void}, {
       $CellContext`red[$CellContext`\[Theta]]}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Equal]", 
    FractionBox[
     InterpretationBox[
      SubsuperscriptBox["e", "\[Theta]", 
       StyleBox["\[Theta]",
        StripOnInput->False,
        ShowContents->False]],
      TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
       TensorCalculus5`Tensorial`Void}, {$CellContext`\[Theta]}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], 
     RowBox[{"r", " ", 
      RowBox[{"a", "[", "t", "]"}]}]]}], ",", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["e", 
      StyleBox["\[Phi]",
       StripOnInput->False,
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[
       StyleBox["\[Phi]",
        StripOnInput->False,
        FontColor->RGBColor[1, 0, 0]],
       StripOnInput->False,
       ShowContents->False]],
     TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
      TensorCalculus5`Tensorial`Void}, {
       $CellContext`red[$CellContext`\[Phi]]}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
      InterpretationBox[
       SubsuperscriptBox["e", "\[Phi]", 
        StyleBox["\[Phi]",
         StripOnInput->False,
         ShowContents->False]],
       TensorCalculus5`Tensorial`Tensor[$CellContext`e, {
        TensorCalculus5`Tensorial`Void}, {$CellContext`\[Phi]}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], 
     RowBox[{"r", " ", 
      RowBox[{"a", "[", "t", "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702551272901187*^9},ExpressionUUID->"1928bc34-0b04-4b0a-a105-\
6fcf01d7135a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"criemannd", "=", 
   RowBox[{"riemannd", "//", 
    RowBox[{"UseCoordinates", "[", "varnames", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Lmatrix", ".", "Lmatrix", ".", "criemannd", ".", "Lmatrix", ".", 
   "Lmatrix"}], ";"}], "\n", 
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"R", "@", 
     RowBox[{"dddd", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], 
      "]"}]}], "//", 
    RowBox[{"ToFlavor", "[", "red", "]"}]}], ",", "%"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"R", "@", 
        RowBox[{"dddd", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "a", "]"}], "===", "red"}], "\[And]", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[And]", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"c", ",", "d"}], "}"}], "]"}], "\[And]", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->576473925,ExpressionUUID->"54dca2d3-4afb-433e-81d1-9a0ee9999688"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"t", "\[Theta]", "t", "\[Theta]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`\[Theta]], 
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`\[Theta]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"t", "\[Phi]", "t", "\[Phi]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`\[Phi]], 
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`\[Phi]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"r", "t", "r", "t"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`t]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"r", "\[Theta]", "r", "\[Theta]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`\[Theta]], 
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`\[Theta]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"r", "\[Phi]", "r", "\[Phi]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`\[Phi]], 
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`\[Phi]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"\[Theta]", "\[Phi]", "\[Theta]", "\[Phi]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
          TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`\[Theta]], 
          $CellContext`red[$CellContext`\[Phi]], 
          $CellContext`red[$CellContext`\[Theta]], 
          $CellContext`red[$CellContext`\[Phi]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"k", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702551288324812*^9},ExpressionUUID->"215e24de-143c-4feb-accb-\
6fcb12d0569d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"onricci", "=", 
   RowBox[{
    RowBox[{"Lmatrix", ".", "ricci", ".", "Lmatrix"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"R", "@", 
     RowBox[{"dd", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "//", 
    RowBox[{"ToFlavor", "[", "red", "]"}]}], ",", "onricci"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"R", "@", 
        RowBox[{"dd", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[And]", 
        RowBox[{
         RowBox[{"Head", "[", "a", "]"}], "===", "red"}]}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->147091704,ExpressionUUID->"6165a43f-5c99-4cb9-9a84-f4bcdb078bd0"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"t", "t"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`t]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], 
         RowBox[{"a", "[", "t", "]"}]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"r", "r"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`r]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "k"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"\[Theta]", "\[Theta]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`\[Theta]], 
          $CellContext`red[$CellContext`\[Theta]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"k", "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["a", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["R", 
         StyleBox[
          RowBox[{"\[Phi]", "\[Phi]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`R, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`\[Phi]], 
          $CellContext`red[$CellContext`\[Phi]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"k", "+", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["a", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702551300291649*^9},ExpressionUUID->"0ff347ca-2884-45ea-8d59-\
30e12e2309ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"oneinstein", "=", 
   RowBox[{
    RowBox[{"Lmatrix", ".", "einstein", ".", "Lmatrix"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetTensorValueRules", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"G", "@", 
     RowBox[{"dd", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "//", 
    RowBox[{"ToFlavor", "[", "red", "]"}]}], ",", "oneinstein"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SelectedTensorRules", "[", 
      RowBox[{
       RowBox[{"G", "@", 
        RowBox[{"dd", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[And]", 
        RowBox[{
         RowBox[{"Head", "[", "a", "]"}], "===", "red"}]}]}], "]"}], "//", 
     RowBox[{"UseCoordinates", "[", 
      RowBox[{"varnames", ",", "x"}], "]"}]}], "//", "Simplify"}], ")"}], "//",
   "TableForm"}]}], "Input",
 CellID->158849644,ExpressionUUID->"a9588219-d0ed-41a6-937b-6aaff0078d68"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         StyleBox[
          RowBox[{"t", "t"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["t",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`t], 
          $CellContext`red[$CellContext`t]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       FractionBox[
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"k", "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         StyleBox[
          RowBox[{"r", "r"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["r",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`r], 
          $CellContext`red[$CellContext`r]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         StyleBox[
          RowBox[{"\[Theta]", "\[Theta]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Theta]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`\[Theta]], 
          $CellContext`red[$CellContext`\[Theta]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["G", 
         StyleBox[
          RowBox[{"\[Phi]", "\[Phi]"}],
          StripOnInput->False,
          FontColor->RGBColor[1, 0, 0]], 
         StyleBox[
          RowBox[{
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox["\[Phi]",
            StripOnInput->False,
            FontColor->RGBColor[1, 0, 0]]}],
          StripOnInput->False,
          ShowContents->False]],
        TensorCalculus5`Tensorial`Tensor[$CellContext`G, {
         TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void}, {
          $CellContext`red[$CellContext`\[Phi]], 
          $CellContext`red[$CellContext`\[Phi]]}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"k", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7025513272698107`*^9},ExpressionUUID->"2120c200-92b7-4bc3-bf48-\
dfc4599876a0"]
}, Open  ]]
},
WindowSize->{808, 655},
WindowMargins->{{-386, Automatic}, {Automatic, -1080}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 572, 10, 48, "Input", "ExpressionUUID" -> \
"729cb6f5-a033-44b7-846b-6eccc1103410",
 InitializationCell->True],
Cell[1133, 32, 281, 6, 54, "Input", "ExpressionUUID" -> \
"6363d270-4533-45f0-9596-7b11abbab9e5"],
Cell[1417, 40, 781, 20, 117, "Input", "ExpressionUUID" -> \
"93d54133-9b52-40fc-a4c5-a2211fcda1c8",
 CellID->339455762],
Cell[CellGroupData[{
Cell[2223, 64, 1811, 57, 157, "Input", "ExpressionUUID" -> \
"f4b0debc-303d-4f81-85e9-f2c8a64fd46e",
 CellID->346974339],
Cell[4037, 123, 1279, 39, 101, "Output", "ExpressionUUID" -> \
"a7e0d8c1-4ceb-4bf1-8cd2-c9d767a2196c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5353, 167, 1365, 38, 117, "Input", "ExpressionUUID" -> \
"b9c7962c-dcd9-47fb-959d-ce3168f6be5f",
 CellID->395153889],
Cell[6721, 207, 13065, 363, 355, "Output", "ExpressionUUID" -> \
"9d42d80f-ccc7-44d0-b303-eeecf79a7e7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19823, 575, 1333, 37, 117, "Input", "ExpressionUUID" -> \
"d2036097-e4a0-4d4a-a834-9e3b10c5731b",
 CellID->166546326],
Cell[21159, 614, 7110, 187, 183, "Output", "ExpressionUUID" -> \
"2069cf9a-43bc-4867-aaf9-d0a0c13eaeaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28306, 806, 147, 2, 32, "Input", "ExpressionUUID" -> \
"0bf25a4a-bc74-49a8-886d-e4bc2b0ca5d3",
 CellID->138414600],
Cell[28456, 810, 132, 3, 32, "Output", "ExpressionUUID" -> \
"11f864da-d689-409b-85a9-cd8824c2c5c7"]
}, Open  ]],
Cell[28603, 816, 486, 14, 54, "Input", "ExpressionUUID" -> \
"d2ae07c7-8101-410f-94ed-38a1b95acc1e",
 CellID->501132207],
Cell[29092, 832, 152, 3, 32, "Input", "ExpressionUUID" -> \
"cb3825eb-30f7-4f52-9189-22d9ec3e05da"],
Cell[CellGroupData[{
Cell[29269, 839, 542, 15, 75, "Input", "ExpressionUUID" -> \
"c8d14be2-6ab4-474d-9330-b86b6b264a66",
 CellID->259324421],
Cell[29814, 856, 130, 3, 32, "Output", "ExpressionUUID" -> \
"fd04d1f8-2431-428b-9e71-4f0573a4d4cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29981, 864, 172, 4, 32, "Input", "ExpressionUUID" -> \
"6257f08f-ad72-424e-8e80-7813b9697ab6"],
Cell[30156, 870, 135, 3, 32, "Output", "ExpressionUUID" -> \
"19f919ad-ca10-4ca5-b86f-53b6dfbc807e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30328, 878, 821, 22, 75, "Input", "ExpressionUUID" -> \
"6ef598b7-b1bd-44df-9e58-4e2b9c7662d8",
 CellID->524883454],
Cell[31152, 902, 15042, 418, 339, "Output", "ExpressionUUID" -> \
"6ba4a8fd-b55d-47ea-9426-b66bcb88ee55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46231, 1325, 760, 22, 75, "Input", "ExpressionUUID" -> \
"ca85dc23-6374-4c2f-a07e-76eb81c26913",
 CellID->116766668],
Cell[46994, 1349, 4749, 136, 123, "Output", "ExpressionUUID" -> \
"490328f5-dcbe-4f9f-b604-11ec7fb275ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51780, 1490, 187, 3, 32, "Input", "ExpressionUUID" -> \
"d34a2ff0-e27c-4406-8bdf-2c33164a4f21",
 CellID->630896927],
Cell[51970, 1495, 582, 18, 57, "Output", "ExpressionUUID" -> \
"add8d286-b184-4009-847e-3c5b19f8a476"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52589, 1518, 763, 22, 75, "Input", "ExpressionUUID" -> \
"b3305484-1860-44f2-add1-47b4bd8bb287",
 CellID->413731651],
Cell[53355, 1542, 4667, 132, 129, "Output", "ExpressionUUID" -> \
"cb6ea2d0-3d81-4079-b0f3-87369869b49a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58059, 1679, 1008, 29, 96, "Input", "ExpressionUUID" -> \
"36502106-337a-4602-8544-8c6edcdeb958",
 CellID->416290612],
Cell[59070, 1710, 840, 26, 59, "Output", "ExpressionUUID" -> \
"81df2203-5c56-480c-b47a-1633ef9d947c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59947, 1741, 602, 17, 54, "Input", "ExpressionUUID" -> \
"d6e26a83-a9d2-41b5-bec9-3514ea714524",
 CellID->22564133],
Cell[60552, 1760, 1635, 49, 34, "Output", "ExpressionUUID" -> \
"02be2885-083a-42e2-b041-c4fbf16b6647"],
Cell[62190, 1811, 4189, 124, 59, "Output", "ExpressionUUID" -> \
"1928bc34-0b04-4b0a-a105-6fcf01d7135a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66416, 1940, 1600, 45, 138, "Input", "ExpressionUUID" -> \
"54dca2d3-4afb-433e-81d1-9a0ee9999688",
 CellID->576473925],
Cell[68019, 1987, 9543, 259, 201, "Output", "ExpressionUUID" -> \
"215e24de-143c-4feb-accb-6fcb12d0569d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77599, 2251, 1096, 32, 96, "Input", "ExpressionUUID" -> \
"6165a43f-5c99-4cb9-9a84-f4bcdb078bd0",
 CellID->147091704],
Cell[78698, 2285, 5945, 171, 149, "Output", "ExpressionUUID" -> \
"0ff347ca-2884-45ea-8d59-30e12e2309ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84680, 2461, 1107, 32, 96, "Input", "ExpressionUUID" -> \
"a9588219-d0ed-41a6-937b-6aaff0078d68",
 CellID->158849644],
Cell[85790, 2495, 5908, 167, 149, "Output", "ExpressionUUID" -> \
"2120c200-92b7-4bc3-bf48-dfc4599876a0"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

