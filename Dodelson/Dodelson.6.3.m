(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Subsubtitle:: *)
(**)


SetDirectory[$HomeDirectory~~"/Mathematica/Dodelson"]
Get["Definition/LegendreFunctions"]
LegendreFunctions
Get["Definition/IntegrateSumFunctions"]
IntegrateSumFunctions


(* ::Text:: *)
(*Show that the initial conditions for the velocities and dipoles of matter and radiation are as given in Eq.6.16.*)


<<Dodelson`DodelsonDefine`
<<Dodelson`CommonParameters`
RecombinationSubs
equalitySubs
ayetaSubs
EnergyDenSubs
DefEqn4100t4107


(* ::Text:: *)
(*Evaluate (4.100-4.107) at very early times, k\[Eta]<<1, where optical depth is large, \[Tau]'[\[Eta]]=-Subscript[n, e] Subscript[\[Sigma], T]a>>1 .  Under these assumptions we can neglect all terms except the one multiplied by \[Tau]'.*)


(* ::Input:: *)
(*Print["(4.100): ",e4100,"*)
(*keep only \[Tau]' terms:*)
(*", tmp= D[e4100,\[Tau]'[\[Eta]]],"*)
(*Expand coefficient of \[Tau]' in Legendre polynomials and integrate over LegendreP[1,\[Mu]]*)
(*",tmp=tmp/.subSeries[\[CapitalTheta],\[Eta]];"*)
(*";tmp=\!\( *)
(*\*SubsuperscriptBox[\(\[Integral]\), \(-1\), \(1\)]Map[#\ LegendreP[1, \[Mu]] &, tmp] \[DifferentialD]\[Mu]\);"*)
(*";tmp=tmp//ExpandAll//DistIntegral;"*)
(*",tmp=tmp//SumIntsFront//ReleaseHold,"*)
(*",save1=tmp/.subP1//Simplify*)
(*];*)


(* ::Text:: *)
(*Similarly keeping only \[Tau]' coefficients in (4.106)*)


(* ::Input:: *)
(*Print["(4.106): ",*)
(*tmp=e4106,"*)
(*keep only \[Tau]' terms:  ",*)
(*tmp= Map[# R&,D[tmp,\[Tau]'[\[Eta]]]] //Simplify*)
(*];*)


(* ::Text:: *)
(*If \[CapitalPhi][\[Eta]] is eliminated from (4.103) and (4.105) we get an equation that implies that v=Subscript[v, b] and \[Delta]=Subscript[\[Delta], b] , since k is arbitrary.*)


(* ::Input:: *)
(*Print[*)
(*"(4.103): ",e4103,*)
(*"*)
(*(4.105): ",e4105,"  =>  ",*)
(*save2=Eliminate[{e4103,e4105},\[CapitalPhi]'[\[Eta]]][[1]],"  =>  v=\!\(\*SubscriptBox[\"v\", \"b\"]\)*)
(*"];*)


(* ::Input:: *)
(*tmp=\!\( *)
(*\*SubsuperscriptBox[\(\[Integral]\), \(-1\), \(1\)]e4107 \[DifferentialD]\[Mu]\);*)
(*tmp=tmp/.subSeries[\[ScriptCapitalN],\[Eta]]/.subSeries[\[CapitalPsi],\[Eta]]/.subSeriesp[\[ScriptCapitalN],\[Eta]]/.subSeriesp[\[CapitalPsi],\[Eta]]/.subSeriesp[\[CapitalPhi],\[Eta]]//DistIntegral//SumIntsFrontHold;*)
(*tmp=tmp//SimplifyIntegrand*)
(*tmp=tmp/.subP1Hold/.subP0Hold*)
(*tmp/.a_'[b_]->a[b]/\[Eta]//Simplify*)
(*save3=Map[# \[Eta]&,%/.k->0]*)


(* ::Input:: *)
(*tmp=e4104*)
(*%/.v'[\[Eta]]->v'[a]a'[t]a[\[Eta]]*)
(*%/.a'[\[Eta]]->a'[t]a[\[Eta]]*)
(*%/.v'[a]->v[\[Eta]]/a[\[Eta]]  (* assume linearity with scale factor*)*)
(*%/.a'[t]->a H*)
(*Solve[%,v[\[Eta]]][[1,1]]*)
(*save4=Map[# \[ImaginaryI]/3&,%]*)


(* ::Text:: *)
(*So we have the following relationships which satisfy Eqn.6.16.*)


(* ::Input:: *)
(*save1*)
(*save2*)
(*save3*)
(*save4*)


(* ::Input:: *)
(*ResetDirectory[]*)
