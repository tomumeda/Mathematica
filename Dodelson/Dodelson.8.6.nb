(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     49409,        858]*)
(*NotebookOutlinePosition[     50107,        882]*)
(*  CellTagsIndexPosition[     50063,        878]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["Dodelson 8.6", "Subtitle",
  TextAlignment->Center,
  TextJustification->0,
  CellChangeTimes -> {{3.402528639236699*^9, 3.4025286450015097`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
  "Exercise 6.  Obtain a semianalytic solution for ",
  Cell[BoxData[
      \(TraditionalForm\`\[CapitalTheta]\_0 + \[CapitalPsi]\)]],
  " and ",
  Cell[BoxData[
      \(TraditionalForm\`\[CapitalTheta]\_1\)]],
  "  at recombination."
}], "Subsection",
  CellChangeTimes -> {{3.402528653021901*^9, 3.402528758203246*^9}, \
{3.4025293900291557`*^9, 3.402529395337187*^9}}],

Cell[BoxData[{\(Clear[R, c, Ha, \[Eta], r, 
      y]\), "\[IndentingNewLine]", \(Print["\<Preliminaries -> \>"]\), "\
\[IndentingNewLine]", 
    RowBox[{\(\(z\_*\) = 1000;\), "  "}], "\[IndentingNewLine]", \(\(a\_*\) = 
      1/\((1 + \(z\_*\))\); \ \  (*\ 
      a\ at\ recombination\ *) \[IndentingNewLine]\[Rho]\_\[Gamma][
        a_]\  := \(\(\(\ \)\(C\)\)\/h\^2\) \(\((1\/a)\)\^4\) \[Rho]\_cr\), "\
\[IndentingNewLine]", \(\[Rho]\_b[a_]\  := \ \(\[CapitalOmega]\_b\) 
        a\^\(-3\)\ \[Rho]\_cr\), "\[IndentingNewLine]", \(\[Rho]\_cr = 
        3  H\_0\^2/\((8  Pi\ G)\);\), "\[IndentingNewLine]", \(subaeq = 
        Solve[\[Rho]\_\[Gamma][a\_eq]\ /\[Rho]\_b[a\_eq] == 1, 
          a\_eq];\), "\[IndentingNewLine]", \(subC = 
        Solve[\[Rho]\_\[Gamma][a\_eq]\ /\[Rho]\_b[a\_eq] == 1, 
          C];\), "\[IndentingNewLine]", \(k\_eq = \@\(\(2\ \
\(\[CapitalOmega]\_b\) H\_0\^2\)\/a\_eq\);\), "\[IndentingNewLine]", \
\(subHkeq = {H\_0 -> \@\(\(\(keq\^2\)\(\ \)\(aeq\)\(\ \)\)\/\(2\ \
\[CapitalOmega]\_b\)\), a\_eq -> aeq, 
        k -> kkeq\ keq}\), "\[IndentingNewLine]", \(Print["\<Transform \
equations with 'eq' point as reference\>", \[IndentingNewLine]subaeq, "\<  \
\>", subC]\), "\[IndentingNewLine]", 
    RowBox[{
      StyleBox[\(R[a_]\),
        "Text"], ":=", 
      StyleBox[" ",
        "Text"], \(\(3\ \[Rho]\_b[a]\)\/\(4\ \[Rho]\_\[Gamma][
              a]\)\)}], "\[IndentingNewLine]", \(R\_eq = 3/4\ \ ;  (*\ 
      Definition\  = \ 
        R[a\_eq]\ *) \[IndentingNewLine] (*\ \ r\_s[\[Eta]_] := \
\[Integral]\_0\%\[Eta] c\_s[
              x] \[DifferentialD]x\ \ *) \[IndentingNewLine]c\_s[
        a_] := \@\(\(1/R\_eq\)\/\(3\ \((1/R\_eq\  + \ R[a]/R\_eq)\)\)\)\), "\
\[IndentingNewLine]", \(cc\_s[a_] := 
      c\_s[a] /. 
        subC\), "\[IndentingNewLine]", \(Print[\*"\"\<\!\(c\_s\)[a] = \>\"", 
        cc\_s[a]];\), "\[IndentingNewLine]", \(Print["\<Find \
\[Eta][a]\>"];\), "\[IndentingNewLine]", \(Ha[
        a_] := \((\(\(8\ \[Pi]\ G\)\/3\) \((\ \[Rho]\_b[a] + \
\[Rho]\_\[Gamma][a])\))\)\^\(1/2\)\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"eta", "=", 
        RowBox[{"Integrate", "[", 
          
          RowBox[{\(1\/\(\(x\^\(\(2\)\(\ \)\)\) Ha[x]\)\), ",", \({x, 0, a}\),
             ",", 
            RowBox[{"Assumptions", "->", 
              RowBox[{
                FormBox[\(Re[\(C\ G\ \[Rho]\_cr\)\/h\^2] > 0\),
                  "TraditionalForm"], "\[And]", 
                
                FormBox[\(Re[
                      C\/\(a\ h\^2\ \[CapitalOmega]\_b\)] \[GreaterEqual] 0\),
                  
                  "TraditionalForm"]}]}]}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(eta = \(eta /. a\[Conjugate]  -> a\) /. 
            subC // PowerExpand;\), "\[IndentingNewLine]", \(etay = \(eta /. 
            a\_eq -> aeq\) /. 
          a -> y\ aeq;\), "\[IndentingNewLine]", \(Print["\<\[Eta][a] = \>", 
        eta, "\<
\[Eta][y] = \>", etay];\), "\[IndentingNewLine]", \(tmp = 
        D[eta /. a\_eq -> aeq, a] // 
          PowerExpand;\), "\[IndentingNewLine]", \(detadax = 
        tmp[\([\)\(1\)\(]\)] /. 
          a -> x;\), "\[IndentingNewLine]", \(integrand = \(cc\_s[
                x]\ detadax /. a\_eq -> aeq\) /. 
          x -> y\ aeq;\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rs", "=", 
        RowBox[{"Integrate", "[", 
          RowBox[{"integrand", ",", \({y, 0, ya}\), ",", 
            RowBox[{"Assumptions", "->", 
              FormBox[\(Re[ya] \[GreaterEqual] 0\),
                "TraditionalForm"]}]}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(rsy = \(rs /. ya -> y // PowerExpand\) // 
          Simplify;\), "\[IndentingNewLine]", \
\(Print[\*"\"\<\!\(r\_s\)[y=a/\!\(a\_eq\)] = \>\"", 
      rsy]\), "\[IndentingNewLine]", \(rsy = 
        rsy /. subHkeq // 
          PowerExpand;\), "\[IndentingNewLine]", \
\(Print[\*"\"\<\!\(r\_s\)[y=a/\!\(a\_eq\)] = \>\"", 
      rsy]\), "\[IndentingNewLine]", \(rsx = 
        rsy /. y -> x;\), "\[IndentingNewLine]", }], "Input",
  CellChangeTimes -> {{3.402968029297305*^9, 3.402968047060363*^9}, \
{3.402968078594977*^9, 3.402968080892099*^9}, {3.402969035386168*^9, \
3.4029690512345343`*^9}, {3.402969731432308*^9, 3.402969768093877*^9}, \
{3.4029700131128597`*^9, 3.4029701286261797`*^9}, {3.402970171134487*^9, \
3.402970183928268*^9}, {3.402970217951338*^9, 3.4029702665732603`*^9}, \
{3.403006441935701*^9, 3.4030064769471407`*^9}, {3.40300852369948*^9, \
3.403008524671431*^9}, {3.4030161594855747`*^9, 3.403016238569023*^9}, \
3.403029616435936*^9, {3.403097871830662*^9, 3.4030980009147778`*^9}, \
3.403098052920123*^9, {3.403098229166061*^9, 3.403098249195633*^9}, \
{3.40309854962879*^9, 3.403098562385439*^9}, {3.403099197759903*^9, \
3.4030992172394876`*^9}, {3.403099264624381*^9, 3.4030992670625973`*^9}, \
{3.4030993029588747`*^9, 3.403099333184013*^9}, {3.40309936860889*^9, \
3.403099374932907*^9}, 3.403099408167686*^9, {3.403103095994142*^9, \
3.4031031684663982`*^9}}],

Cell[BoxData[{
    \(Clear[T, c, r, 
      R, \[CapitalPhi], \[CapitalPsi]]\), "\[IndentingNewLine]", 
    \(\[Eta][z_] := 
      etay[\([\)\(1\)\(]\)] /. y -> z; \), "\[IndentingNewLine]", 
    \(detaday = \(detadax /. x -> x\ aeq\) /. subHkeq // 
        PowerExpand; \), "\[IndentingNewLine]", 
    \(Sin[k \((rsy - rsx)\)] /. subHkeq // 
      PowerExpand; \), "\[IndentingNewLine]", 
    \(% // TrigToExp; \), "\[IndentingNewLine]", 
    \(sinterm = %[\([\)\(1\)\(]\)] // 
        FullSimplify; \), "\[IndentingNewLine]", 
    \(integrand824[k_, x_] := 
      k\ aeq\ \((\[CapitalPhi][k, x] - \[CapitalPsi][k, x])\) 
          sinterm\ detaday\  /. keq -> k/kkeq\), "\[IndentingNewLine]", 
    \(integrand824[kkeq, x]; \), "\[IndentingNewLine]", 
    \(eqn824[kkeq_, 
        y_] := \((\[CapitalTheta]\_0[0] + \[CapitalPhi][0])\) 
          Cos[keq\ kkeq\ rsy] + \(1\/\@3\) \(\[Integral]\_0\%y integrand824[
                kkeq, x]\ \[DifferentialD]x\)\), "\[IndentingNewLine]", 
    \(Print[\*"\"\<Eqn 824 in terms of \!\(k\/k\_eq\)=kkeq and \
\!\(a\/a\_eq\)={y,x} => \>\"", \[IndentingNewLine]eqn824[kkeq, 
        y]]\)}], "Input",
  CellDingbat->"\[DottedSquare]",
  CellChangeTimes -> {{3.402528763200732*^9, 3.402528769991412*^9}, \
{3.402528876739986*^9, 3.402529107072914*^9}, {3.402529140274191*^9, \
3.4025293241672173`*^9}, {3.402621808592819*^9, 3.402621951105256*^9}, \
{3.40262198684234*^9, 3.402622100739129*^9}, 3.402622211491249*^9, \
{3.4026225011899652`*^9, 3.40262252386333*^9}, {3.402622570954912*^9, \
3.402622839359087*^9}, {3.4026229314037333`*^9, 3.402622932282771*^9}, \
{3.402623015180378*^9, 3.402623186849554*^9}, {3.402623226099853*^9, \
3.402623232610919*^9}, {3.402623277330641*^9, 3.402623600618582*^9}, \
{3.4026236756599216`*^9, 3.402623688518423*^9}, {3.402623817642438*^9, \
3.402623827702593*^9}, {3.4026238977464314`*^9, 3.402624093215014*^9}, \
{3.402625357253566*^9, 3.4026255518408422`*^9}, {3.402625589372918*^9, \
3.4026255985124397`*^9}, {3.4026256476593437`*^9, 3.402625662767047*^9}, \
{3.4026257455168533`*^9, 3.402625899031448*^9}, 3.402656831029436*^9, \
{3.402659573134914*^9, 3.402659574896806*^9}, 3.402690850409452*^9, \
{3.4028585819015217`*^9, 3.4028586048367977`*^9}, {3.4028586570373907`*^9, \
3.4028587742056913`*^9}, {3.4028588111514397`*^9, 3.402858845395257*^9}, \
{3.402859988067623*^9, 3.4028599919413977`*^9}, 3.4028600867199574`*^9, \
{3.402860360653166*^9, 3.402860435661737*^9}, {3.402860564787163*^9, \
3.402860565340899*^9}, {3.4028606109153976`*^9, 3.4028606988616*^9}, \
{3.402860849745064*^9, 3.4028608842482147`*^9}, 3.402881964908531*^9, \
{3.402924560501296*^9, 3.402924563605465*^9}, 3.402924612851985*^9, \
3.402924654080158*^9, {3.402968956022805*^9, 3.402968993166883*^9}, \
{3.402969132525024*^9, 3.402969136303515*^9}, 3.402969173616342*^9, \
{3.402969306545293*^9, 3.402969308916185*^9}, {3.402970847235425*^9, \
3.402970983580715*^9}, {3.402971019936439*^9, 3.4029710304108133`*^9}, \
{3.402971221890442*^9, 3.4029712420276203`*^9}, {3.4029714268730373`*^9, \
3.402971487812521*^9}, {3.4029715964361486`*^9, 3.402971623603024*^9}, \
{3.403006490679843*^9, 3.403006522891176*^9}, {3.403006564678607*^9, \
3.403006578958898*^9}, {3.4030085680649548`*^9, 3.403008646225754*^9}, \
{3.403008676295245*^9, 3.403008681231986*^9}, {3.403008713714548*^9, \
3.4030087213464317`*^9}, {3.403008787542184*^9, 3.403008794606398*^9}, \
{3.403008835675002*^9, 3.403008883988284*^9}, {3.4030089572633657`*^9, \
3.403008973783063*^9}, {3.4030090345756807`*^9, 3.4030090363095837`*^9}, \
{3.403011565924679*^9, 3.40301162608622*^9}, {3.4030139144721527`*^9, \
3.403013939775319*^9}, {3.403032882534685*^9, 3.40303288348384*^9}, \
3.403032981374934*^9, 3.403097765034959*^9, {3.4030981208862543`*^9, \
3.403098170570052*^9}, {3.403098639997027*^9, 3.403098695945208*^9}, \
{3.403098749955078*^9, 3.403098756053461*^9}, 3.403098853338793*^9, \
{3.403098884673191*^9, 3.4030988990362263`*^9}, {3.403098954542899*^9, \
3.4030989605449038`*^9}, {3.403098997061414*^9, 3.4030989981026573`*^9}, \
{3.4030990356319723`*^9, 3.403099046567874*^9}, {3.403099506557383*^9, \
3.403099537021133*^9}, {3.403099614680118*^9, 3.40309966105573*^9}, \
3.403099709419215*^9, 3.403099760357193*^9, {3.403099830462154*^9, \
3.403099881545586*^9}, {3.403100734483959*^9, 3.4031007974789333`*^9}, \
{3.403100855021102*^9, 3.40310097621346*^9}, {3.403101058443831*^9, \
3.403101101526002*^9}, {3.403101161641831*^9, 3.4031013483589487`*^9}, \
{3.403101425009815*^9, 3.403101486970601*^9}}],

Cell[BoxData[
    \(\(\( (*\ 
      kkeq\  = \ 
        k/keq\ *) \)\(\[IndentingNewLine]\)\(\(\[CapitalPhi][kkeq_, 
          y_] := \[CapitalPhi]bar[kkeq, 
            y] \((\((1 - 
                    T[kkeq])\) \[ExponentialE]\^\(\(- .11\) \((y\ \
kkeq)\)\^1.6\) + T[kkeq])\)\)\[IndentingNewLine]\(\[CapitalPsi][kkeq_, 
          y_] := \[CapitalPsi]bar[kkeq, 
            y] \((\((1 - 
                    T[kkeq])\) \[ExponentialE]\^\(\(- .097\) \((\ y\ \
kkeq)\)\^1.6\) + T[kkeq])\)\)\[IndentingNewLine]\(T[
          x_] := \(Log[
                1 +  .171\ x]\/\( .171\ x\)\) \((1 +  .284\ x + \((1.18\ x)\)\
\^2 + \(( .399\ x)\)\^3 + \(( .49\ x)\)\^4)\)\^\(- .25\)\)\[IndentingNewLine]\
\(\[CapitalPhi]bar[kkeq_, 
          y_] := \(3\/4\) \(\((1\/kkeq)\)\^2\) \(\(y + 
                1\)\/y\^2\) \[CapitalDelta]\_T[
            y]\)\[IndentingNewLine]\(\[CapitalPsi]bar[kkeq_, 
          y_] := \(-\(3\/4\)\) \(\((1\/kkeq)\)\^2\) \(\(y + 
                1\)\/y\^2\) \((\[CapitalDelta]\_T[
                y] +  .65\ N2[y]/\((1 + y)\))\)\)\[IndentingNewLine]\(N2[
          y_] := \(-0.1\) \(\(20\ y\  + 19\)\/\(3\ y\  + 4\)\) \(y\^2\/\(y + 
                  1\)\) \[CapitalPhi]ls[y] - \(8\/3\) 
            y\/\(3\ y\  + 4\) + \(8\/9\) 
            Log[3\ y/4 + 1]\)\[IndentingNewLine]\(\[CapitalDelta]\_T[
          y_] := \((1.16 - \( .48\ y\)\/\(y + 1\))\) \[CapitalPhi]ls[y] 
          y\^2\/\(y + 1\)\)\[IndentingNewLine]\(\[CapitalPhi]ls[
          y_] := \(\[CapitalPhi][0]\/10\) \(1\/y\^3\) \((16 \@\( 1 + y\) + 
              9\ y\^3 + 2\ y\^2 - 8\ y - 16)\)\)\[IndentingNewLine]\(intg = 
        integrand824[kkeq, x] // FullSimplify\)\)\)\)], "Input",
  CellDingbat->"\[DottedSquare]",
  CellChangeTimes -> {{3.402528763200732*^9, 3.402528769991412*^9}, \
{3.402528876739986*^9, 3.402529107072914*^9}, {3.402529140274191*^9, \
3.4025293241672173`*^9}, {3.402621808592819*^9, 3.402621951105256*^9}, \
{3.40262198684234*^9, 3.402622100739129*^9}, 3.402622211491249*^9, \
{3.4026225011899652`*^9, 3.40262252386333*^9}, {3.402622570954912*^9, \
3.402622839359087*^9}, {3.4026229314037333`*^9, 3.402622932282771*^9}, \
{3.402623015180378*^9, 3.402623186849554*^9}, {3.402623226099853*^9, \
3.402623232610919*^9}, {3.402623277330641*^9, 3.402623600618582*^9}, \
{3.4026236756599216`*^9, 3.402623688518423*^9}, {3.402623817642438*^9, \
3.402623827702593*^9}, {3.4026238977464314`*^9, 3.402624093215014*^9}, \
{3.402625357253566*^9, 3.4026255518408422`*^9}, {3.402625589372918*^9, \
3.4026255985124397`*^9}, {3.4026256476593437`*^9, 3.402625662767047*^9}, \
{3.4026257455168533`*^9, 3.402625899031448*^9}, 3.402656831029436*^9, \
{3.402659573134914*^9, 3.402659574896806*^9}, 3.402690850409452*^9, \
{3.4028585819015217`*^9, 3.4028586048367977`*^9}, {3.4028586570373907`*^9, \
3.4028587742056913`*^9}, {3.4028588111514397`*^9, 3.402858845395257*^9}, \
{3.402859988067623*^9, 3.4028599919413977`*^9}, 3.4028600867199574`*^9, \
{3.402860360653166*^9, 3.402860435661737*^9}, {3.402860564787163*^9, \
3.402860565340899*^9}, {3.4028606109153976`*^9, 3.4028606988616*^9}, \
{3.402860849745064*^9, 3.4028608842482147`*^9}, 3.402881964908531*^9, \
{3.402924560501296*^9, 3.402924563605465*^9}, 3.402924612851985*^9, \
3.402924654080158*^9, {3.402968956022805*^9, 3.402968959304105*^9}, \
3.40296962243436*^9, {3.4030062922832317`*^9, 3.403006299960495*^9}, \
3.403008512507835*^9, {3.403009088282189*^9, 3.40300908972344*^9}, \
{3.403013967282075*^9, 3.403013975037302*^9}, {3.403014462200683*^9, \
3.403014503688313*^9}, {3.403014577531453*^9, 3.4030147580921917`*^9}, \
{3.4030148901021852`*^9, 3.4030148909739447`*^9}, {3.40301496436714*^9, \
3.4030149742774677`*^9}, {3.4030151833715363`*^9, 3.403015192846518*^9}, \
{3.403015394742399*^9, 3.403015406139882*^9}, {3.4030156536849117`*^9, \
3.403015654638637*^9}, {3.4030298776174726`*^9, 3.403029879791397*^9}}],

Cell[BoxData[
    \(\(\(tmp = 
      kkeq\^\(\(2\)\(\ \)\)\ intg\)\(\[IndentingNewLine]\)\)\)], "Input",
  CellChangeTimes -> {{3.403015335733528*^9, 3.403015364159565*^9}, \
{3.40301541196914*^9, 3.4030154138259163`*^9}, {3.403015451202883*^9, \
3.403015492775352*^9}, {3.4030155542161627`*^9, 3.403015568530682*^9}, \
{3.4030158365219307`*^9, 3.403015861097946*^9}, 3.403016002154405*^9, \
{3.4030170453794394`*^9, 3.403017046821711*^9}, {3.403030110840678*^9, \
3.4030301969861507`*^9}, {3.4030302751007977`*^9, 3.4030303172969103`*^9}, \
{3.403030412426705*^9, 3.403030449509184*^9}, {3.403030514247861*^9, \
3.40303053834123*^9}, {3.403030589706258*^9, 3.403030604057934*^9}, \
{3.403030818730997*^9, 3.403030992261491*^9}, {3.403031053309876*^9, \
3.40303105475352*^9}, {3.403031100430995*^9, 3.403031109789711*^9}, \
{3.403031203685216*^9, 3.403031206588841*^9}, {3.403031274669901*^9, \
3.4030313113414087`*^9}, 3.403031387215745*^9, {3.403031463110043*^9, \
3.403031480165659*^9}, {3.4030315408196793`*^9, 3.4030315415154743`*^9}, \
{3.4030316403170223`*^9, 3.403031641857836*^9}, {3.403031877614511*^9, \
3.403031906783493*^9}, {3.403031971253604*^9, 3.403031972044976*^9}, \
{3.4030321261280947`*^9, 3.403032140741263*^9}, 3.403101790578289*^9, \
{3.403101828046302*^9, 3.403101837317054*^9}, 3.403101868237575*^9, \
{3.4031019378527403`*^9, 3.403101964129141*^9}}],

Cell[BoxData[
    \(\(\(Tot[\[Eta]] == \((\[CapitalTheta]\_0[0] + \[CapitalPhi][0])\) 
        Cos[k\ r\_s[\[Eta]]]\)\(\[IndentingNewLine]\)\(\[IndentingNewLine]\)\)\
\)], "Input",
  CellDingbat->"\[DottedSquare]",
  CellChangeTimes -> {{3.402528763200732*^9, 3.402528769991412*^9}, \
{3.402528876739986*^9, 3.402529107072914*^9}, {3.402529140274191*^9, \
3.4025293241672173`*^9}, {3.402621808592819*^9, 3.402621951105256*^9}, \
{3.40262198684234*^9, 3.402622100739129*^9}, 3.402622211491249*^9, \
{3.4026225011899652`*^9, 3.40262252386333*^9}, {3.402622570954912*^9, \
3.402622839359087*^9}, {3.4026229314037333`*^9, 3.402622932282771*^9}, \
{3.402623015180378*^9, 3.402623186849554*^9}, {3.402623226099853*^9, \
3.402623232610919*^9}, {3.402623277330641*^9, 3.402623600618582*^9}, \
{3.4026236756599216`*^9, 3.402623688518423*^9}, {3.402623817642438*^9, \
3.402623827702593*^9}, {3.4026238977464314`*^9, 3.402624093215014*^9}, \
{3.402625357253566*^9, 3.4026255518408422`*^9}, {3.402625589372918*^9, \
3.4026255985124397`*^9}, {3.4026256476593437`*^9, 3.402625662767047*^9}, \
{3.4026257455168533`*^9, 3.402625899031448*^9}, 3.402656831029436*^9, \
{3.402659573134914*^9, 3.402659574896806*^9}, 3.402690850409452*^9, \
{3.4028585819015217`*^9, 3.4028586048367977`*^9}, {3.4028586570373907`*^9, \
3.4028587742056913`*^9}, {3.4028588111514397`*^9, 3.402858845395257*^9}, \
{3.402859988067623*^9, 3.4028599919413977`*^9}, 3.4028600867199574`*^9, \
{3.402860360653166*^9, 3.402860435661737*^9}, {3.402860564787163*^9, \
3.402860565340899*^9}, {3.4028606109153976`*^9, 3.4028606988616*^9}, \
{3.402860849745064*^9, 3.4028608842482147`*^9}, 3.402881964908531*^9, \
{3.402924560501296*^9, 3.402924563605465*^9}, 3.402924612851985*^9, \
{3.402924654080158*^9, 3.4029246956229877`*^9}, {3.4029247449470463`*^9, \
3.402924788254239*^9}, {3.40292528328401*^9, 3.402925396290659*^9}, \
{3.402925434168976*^9, 3.402925442286031*^9}, {3.4029255611507387`*^9, \
3.402925676408085*^9}, 3.402925795286046*^9, 3.402925885279419*^9, \
{3.402926357567655*^9, 3.402926389942663*^9}, {3.402926420163005*^9, \
3.402926442638412*^9}, {3.4029264742899323`*^9, 3.402926475145275*^9}, \
{3.402926506014407*^9, 3.402926507588168*^9}, {3.4029265612655067`*^9, \
3.4029266127683487`*^9}, {3.402926643631295*^9, 3.402926676161256*^9}, \
{3.4029267359965553`*^9, 3.40292680340917*^9}, {3.402927039019863*^9, \
3.402927056791356*^9}, {3.40292712491088*^9, 3.402927222828692*^9}, \
{3.402927285932279*^9, 3.4029272890990763`*^9}, {3.402927354124608*^9, \
3.402927376611232*^9}, {3.402927425823884*^9, 3.402927448474523*^9}, \
{3.402927499737555*^9, 3.4029275415081053`*^9}, {3.402927638944849*^9, \
3.402927698909766*^9}, 3.402927731364039*^9, {3.4029277652040586`*^9, \
3.402927798206766*^9}, {3.4029278666555643`*^9, 3.402927902956266*^9}, \
{3.4029279436597958`*^9, 3.402928011022293*^9}, {3.4029280924543324`*^9, \
3.402928132538167*^9}, {3.4029281708672037`*^9, 3.402928277557502*^9}, \
3.402939313621489*^9, {3.402939374203149*^9, 3.402939463409541*^9}, \
3.402939497739749*^9, {3.4029395549104967`*^9, 3.402939617526572*^9}, \
{3.402939651721217*^9, 3.402939661251954*^9}, {3.402939699899939*^9, \
3.402939711392365*^9}, {3.402939770867341*^9, 3.402939795253726*^9}, \
3.402940069592189*^9, {3.4029401098193407`*^9, 3.4029401132422647`*^9}, \
{3.4029402533904667`*^9, 3.402940275444601*^9}, {3.402940334443142*^9, \
3.4029403349505653`*^9}, 3.40294056881034*^9, {3.402954130994913*^9, \
3.402954133170292*^9}, {3.402954167646261*^9, 3.402954224281032*^9}, \
{3.402954358282527*^9, 3.402954496836565*^9}, {3.402954582649517*^9, \
3.402954592967485*^9}, {3.4029546572034883`*^9, 3.4029546894167557`*^9}, \
{3.402954797084873*^9, 3.402954845375906*^9}, {3.402954910654017*^9, \
3.4029549355383863`*^9}, 3.402954974778314*^9, {3.402955025211741*^9, \
3.4029550358771353`*^9}, {3.4029550749514923`*^9, 3.40295514550569*^9}, \
3.402955200258863*^9, {3.4029552409160852`*^9, 3.4029552732130527`*^9}, \
{3.402955358719923*^9, 3.4029553596850977`*^9}, {3.4029554428503847`*^9, \
3.402955450175696*^9}, {3.402955561165202*^9, 3.4029555876525087`*^9}, \
{3.402955633285512*^9, 3.402955651042549*^9}, {3.402955689564459*^9, \
3.402955701518312*^9}, 3.402955761804147*^9, {3.402955832490151*^9, \
3.402955833730842*^9}, {3.4029558799933*^9, 3.402955907477643*^9}, \
{3.40295596481698*^9, 3.4029560465743093`*^9}, 3.402956194717684*^9, \
{3.402956226650167*^9, 3.4029562477655087`*^9}, {3.402956335728763*^9, \
3.402956457175352*^9}, {3.40295649137248*^9, 3.4029564977604628`*^9}, \
{3.402956529213937*^9, 3.402956569345632*^9}, {3.402956613692194*^9, \
3.40295668400473*^9}, {3.402956729573758*^9, 3.402956733009601*^9}, \
{3.4029568330644712`*^9, 3.402956834732232*^9}, {3.402956903079379*^9, \
3.402956909904358*^9}, {3.4029574369029083`*^9, 3.402957465002613*^9}, \
3.402957535889347*^9, {3.4029576040691223`*^9, 3.402957625430697*^9}, \
3.402957662162283*^9, {3.402957752147142*^9, 3.402957833421975*^9}, \
{3.40295788284544*^9, 3.402957943922961*^9}, {3.402958027948524*^9, \
3.402958036535075*^9}, {3.402958146924613*^9, 3.4029582227740297`*^9}, \
{3.4029582750744953`*^9, 3.402958277758235*^9}, {3.4029583220880823`*^9, \
3.402958340402184*^9}, {3.4029583723763647`*^9, 3.402958426823472*^9}, \
{3.402958484275207*^9, 3.402958543159446*^9}, {3.402958705508895*^9, \
3.402958740880624*^9}, {3.4029588463978252`*^9, 3.402958857627985*^9}, \
{3.4029589020732183`*^9, 3.4029589432644787`*^9}, 3.402964185802144*^9, \
{3.402964234437045*^9, 3.40296423609081*^9}, {3.402964346582466*^9, \
3.402964431355316*^9}, {3.4029644616261997`*^9, 3.402964470071596*^9}, \
3.4029645990700617`*^9, {3.402964675678281*^9, 3.4029647775319366`*^9}, \
{3.402965048639193*^9, 3.402965071436761*^9}, {3.40296510820718*^9, \
3.40296543484969*^9}, {3.402965541162106*^9, 3.402965550101199*^9}, \
3.4029655848938627`*^9, {3.402965615214594*^9, 3.40296561734083*^9}, \
{3.402965658617943*^9, 3.40296567673001*^9}, {3.402965740015984*^9, \
3.402965751405924*^9}, {3.402966380844717*^9, 3.402966417378624*^9}, \
3.402966459385623*^9, {3.402966567954094*^9, 3.40296656848759*^9}, \
3.402966643849184*^9, {3.402966721837392*^9, 3.402966799633491*^9}, \
3.402966843293983*^9, {3.4029669280021343`*^9, 3.402967026303998*^9}, \
3.402967056819257*^9, 3.402967232786489*^9, {3.402967388078203*^9, \
3.402967413840144*^9}, {3.402967474694724*^9, 3.402967478169169*^9}, \
{3.403055785249317*^9, 3.403055836641405*^9}, 3.403055914170857*^9, \
{3.403055957922439*^9, 3.403056002640381*^9}, {3.403056065532976*^9, \
3.403056213669289*^9}, 3.403056257142734*^9, {3.403056290742291*^9, \
3.403056291988791*^9}, {3.403056327724978*^9, 3.403056353362925*^9}, \
{3.4031022482495127`*^9, 3.4031022591965446`*^9}}],

Cell[BoxData[{
    \(y = a/a\_eq /. subaeq\), "\[IndentingNewLine]", 
    \(Clear[y]\), "\[IndentingNewLine]", 
    \(\[CapitalPsi][kkeq, y]/\[CapitalPhi][0]\), "\[IndentingNewLine]", 
    \(Limit[\[CapitalPhi][ .1, y]/\[CapitalPhi][0], 
      y -> 0]\), "\[IndentingNewLine]", 
    \(Limit[\[CapitalPsi][ .1, y]/\[CapitalPhi][0], 
      y -> 0]\[IndentingNewLine]\), "\[IndentingNewLine]", 
    \(Plot[{kkeq\^\(3/2\)\ \[CapitalPhi][kkeq, 1]/\[CapitalPhi][
              0]}, {kkeq,  .01, 10}]\), "\[IndentingNewLine]", 
    \(Plot[{\[CapitalPhi][1, y]/\[CapitalPhi][0]}, {y,  .001, 
        10}]\), "\[IndentingNewLine]", 
    \(ContourPlot[{\(kkeq\^\(\(3\)\(/\)\(2\)\(\ \)\)\) \[CapitalPhi][kkeq, 
              y]/\[CapitalPhi][0]}, {kkeq,  .01, 10}, {y,  .001, 
        10}]\)}], "Input",
  CellChangeTimes -> {{3.403057231102841*^9, 3.403057238301935*^9}, \
{3.403057436908733*^9, 3.40305743780056*^9}, {3.403057470836084*^9, \
3.403057478090987*^9}, {3.403057594280199*^9, 3.403057649226696*^9}, \
{3.403057694932819*^9, 3.4030577653826*^9}, {3.403093948668229*^9, \
3.403094018429433*^9}, {3.403094136395158*^9, 3.403094150713683*^9}, \
{3.403094326616827*^9, 3.4030943524336853`*^9}, {3.403094443720665*^9, \
3.403094488414666*^9}, {3.403094662177898*^9, 3.403094673765828*^9}, \
{3.403094738230981*^9, 3.403094853610428*^9}, {3.403095051854887*^9, \
3.4030950998253307`*^9}, {3.403095830089201*^9, 3.4030958646133947`*^9}, \
{3.4030959449668703`*^9, 3.403095949459309*^9}, {3.403095984169381*^9, \
3.403095989366568*^9}, {3.403096046329542*^9, 3.403096050486206*^9}, \
{3.4030961312428226`*^9, 3.403096135652093*^9}, {3.403096199400976*^9, \
3.403096203507745*^9}, 3.403096953060923*^9, {3.403097033664057*^9, \
3.403097052949914*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dodelson 8.6", "Subtitle",
  TextAlignment->Center,
  TextJustification->0,
  CellChangeTimes -> {{3.402528639236699*^9, 3.4025286450015097`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
  "Exercise 6.  Obtain a semianalytic solution for ",
  Cell[BoxData[
      \(TraditionalForm\`\[CapitalTheta]\_0 + \[CapitalPsi]\)]],
  " and ",
  Cell[BoxData[
      \(TraditionalForm\`\[CapitalTheta]\_1\)]],
  "  at recombination."
}], "Subsection",
  CellChangeTimes -> {{3.402528653021901*^9, 3.402528758203246*^9}, \
{3.4025293900291557`*^9, 3.402529395337187*^9}}],

Cell[BoxData[{\(Clear[R, c, Ha, \[Eta], r, 
      y]\), "\[IndentingNewLine]", \(Print["\<Preliminaries -> \>"]\), "\
\[IndentingNewLine]", 
    RowBox[{\(\(z\_*\) = 1000;\), "  "}], "\[IndentingNewLine]", \(\(a\_*\) = 
      1/\((1 + \(z\_*\))\); \ \  (*\ 
      a\ at\ recombination\ *) \[IndentingNewLine]\[Rho]\_\[Gamma][
        a_]\  := \(\(\(\ \)\(C\)\)\/h\^2\) \(\((1\/a)\)\^4\) \[Rho]\_cr\), "\
\[IndentingNewLine]", \(\[Rho]\_b[a_]\  := \ \(\[CapitalOmega]\_b\) 
        a\^\(-3\)\ \[Rho]\_cr\), "\[IndentingNewLine]", \(\[Rho]\_cr = 
        3  H\_0\^2/\((8  Pi\ G)\);\), "\[IndentingNewLine]", \(subaeq = 
        Solve[\[Rho]\_\[Gamma][a\_eq]\ /\[Rho]\_b[a\_eq] == 1, 
          a\_eq];\), "\[IndentingNewLine]", \(subC = 
        Solve[\[Rho]\_\[Gamma][a\_eq]\ /\[Rho]\_b[a\_eq] == 1, 
          C];\), "\[IndentingNewLine]", \(k\_eq = \@\(\(2\ \
\(\[CapitalOmega]\_b\) H\_0\^2\)\/a\_eq\);\), "\[IndentingNewLine]", \
\(subHkeq = {H\_0 -> \@\(\(\(keq\^2\)\(\ \)\(aeq\)\(\ \)\)\/\(2\ \
\[CapitalOmega]\_b\)\), a\_eq -> aeq, 
        k -> kkeq\ keq}\), "\[IndentingNewLine]", \(Print["\<Transform \
equations with 'eq' point as reference\>", \[IndentingNewLine]subaeq, "\<  \
\>", subC]\), "\[IndentingNewLine]", 
    RowBox[{
      StyleBox[\(R[a_]\),
        "Text"], ":=", 
      StyleBox[" ",
        "Text"], \(\(3\ \[Rho]\_b[a]\)\/\(4\ \[Rho]\_\[Gamma][
              a]\)\)}], "\[IndentingNewLine]", \(R\_eq = 3/4\ \ ;  (*\ 
      Definition\  = \ 
        R[a\_eq]\ *) \[IndentingNewLine] (*\ \ r\_s[\[Eta]_] := \
\[Integral]\_0\%\[Eta] c\_s[
              x] \[DifferentialD]x\ \ *) \[IndentingNewLine]c\_s[
        a_] := \@\(\(1/R\_eq\)\/\(3\ \((1/R\_eq\  + \ R[a]/R\_eq)\)\)\)\), "\
\[IndentingNewLine]", \(cc\_s[a_] := 
      c\_s[a] /. 
        subC\), "\[IndentingNewLine]", \(Print[\*"\"\<\!\(c\_s\)[a] = \>\"", 
        cc\_s[a]];\), "\[IndentingNewLine]", \(Print["\<Find \
\[Eta][a]\>"];\), "\[IndentingNewLine]", \(Ha[
        a_] := \((\(\(8\ \[Pi]\ G\)\/3\) \((\ \[Rho]\_b[a] + \
\[Rho]\_\[Gamma][a])\))\)\^\(1/2\)\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"eta", "=", 
        RowBox[{"Integrate", "[", 
          
          RowBox[{\(1\/\(\(x\^\(\(2\)\(\ \)\)\) Ha[x]\)\), ",", \({x, 0, a}\),
             ",", 
            RowBox[{"Assumptions", "->", 
              RowBox[{
                FormBox[\(Re[\(C\ G\ \[Rho]\_cr\)\/h\^2] > 0\),
                  "TraditionalForm"], "\[And]", 
                
                FormBox[\(Re[
                      C\/\(a\ h\^2\ \[CapitalOmega]\_b\)] \[GreaterEqual] 0\),
                  
                  "TraditionalForm"]}]}]}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(eta = \(eta /. a\[Conjugate]  -> a\) /. 
            subC // PowerExpand;\), "\[IndentingNewLine]", \(etay = \(eta /. 
            a\_eq -> aeq\) /. 
          a -> y\ aeq;\), "\[IndentingNewLine]", \(Print["\<\[Eta][a] = \>", 
        eta, "\<
\[Eta][y] = \>", etay];\), "\[IndentingNewLine]", \(tmp = 
        D[eta /. a\_eq -> aeq, a] // 
          PowerExpand;\), "\[IndentingNewLine]", \(detadax = 
        tmp[\([1]\)] /. 
          a -> x;\), "\[IndentingNewLine]", \(integrand = \(cc\_s[
                x]\ detadax /. a\_eq -> aeq\) /. 
          x -> y\ aeq;\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"rs", "=", 
        RowBox[{"Integrate", "[", 
          RowBox[{"integrand", ",", \({y, 0, ya}\), ",", 
            RowBox[{"Assumptions", "->", 
              FormBox[\(Re[ya] \[GreaterEqual] 0\),
                "TraditionalForm"]}]}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(rsy = \(rs /. ya -> y // PowerExpand\) // 
          Simplify;\), "\[IndentingNewLine]", \
\(Print[\*"\"\<\!\(r\_s\)[y=a/\!\(a\_eq\)] = \>\"", 
      rsy]\), "\[IndentingNewLine]", \(rsy = 
        rsy /. subHkeq // 
          PowerExpand;\), "\[IndentingNewLine]", \
\(Print[\*"\"\<\!\(r\_s\)[y=a/\!\(a\_eq\)] = \>\"", 
      rsy]\), "\[IndentingNewLine]", \(rsx = 
        rsy /. y -> x;\), "\[IndentingNewLine]", "Null"}], "Input",
  CellChangeTimes -> {{3.402968029297305*^9, 3.402968047060363*^9}, \
{3.402968078594977*^9, 3.402968080892099*^9}, {3.402969035386168*^9, \
3.4029690512345343`*^9}, {3.402969731432308*^9, 3.402969768093877*^9}, \
{3.4029700131128597`*^9, 3.4029701286261797`*^9}, {3.402970171134487*^9, \
3.402970183928268*^9}, {3.402970217951338*^9, 3.4029702665732603`*^9}, \
{3.403006441935701*^9, 3.4030064769471407`*^9}, {3.40300852369948*^9, \
3.403008524671431*^9}, {3.4030161594855747`*^9, 3.403016238569023*^9}, \
3.403029616435936*^9, {3.403097871830662*^9, 3.4030980009147778`*^9}, \
3.403098052920123*^9, {3.403098229166061*^9, 3.403098249195633*^9}, \
{3.40309854962879*^9, 3.403098562385439*^9}, {3.403099197759903*^9, \
3.4030992172394876`*^9}, {3.403099264624381*^9, 3.4030992670625973`*^9}, \
{3.4030993029588747`*^9, 3.403099333184013*^9}, {3.40309936860889*^9, \
3.403099374932907*^9}, 3.403099408167686*^9, {3.403103095994142*^9, \
3.4031031684663982`*^9}}],

Cell[BoxData[{
    \(Clear[T, c, r, 
      R, \[CapitalPhi], \[CapitalPsi]]\), "\[IndentingNewLine]", 
    \(\(\[Eta][z_] := etay[\([1]\)] /. y -> z;\)\), "\[IndentingNewLine]", 
    \(\(detaday = \(detadax /. x -> x\ aeq\) /. subHkeq // 
          PowerExpand;\)\), "\[IndentingNewLine]", 
    \(\(Sin[k \((rsy - rsx)\)] /. subHkeq // 
        PowerExpand;\)\), "\[IndentingNewLine]", 
    \(\(% // TrigToExp;\)\), "\[IndentingNewLine]", 
    \(\(sinterm = %[\([1]\)] // FullSimplify;\)\), "\[IndentingNewLine]", 
    \(integrand824[k_, x_] := 
      k\ aeq\ \((\[CapitalPhi][k, x] - \[CapitalPsi][k, x])\) 
          sinterm\ detaday\  /. keq -> k/kkeq\), "\[IndentingNewLine]", 
    \(\(integrand824[kkeq, x];\)\), "\[IndentingNewLine]", 
    \(eqn824[kkeq_, 
        y_] := \((\[CapitalTheta]\_0[0] + \[CapitalPhi][0])\) 
          Cos[keq\ kkeq\ rsy] + \(1\/\@3\) \(\[Integral]\_0\%y integrand824[
                kkeq, x]\ \[DifferentialD]x\)\), "\[IndentingNewLine]", 
    \(Print[\*"\"\<Eqn 824 in terms of \!\(k\/k\_eq\)=kkeq and \
\!\(a\/a\_eq\)={y,x} => \>\"", \[IndentingNewLine]eqn824[kkeq, 
        y]]\)}], "Input",
  CellDingbat->"\[DottedSquare]",
  CellChangeTimes -> {{3.402528763200732*^9, 3.402528769991412*^9}, \
{3.402528876739986*^9, 3.402529107072914*^9}, {3.402529140274191*^9, \
3.4025293241672173`*^9}, {3.402621808592819*^9, 3.402621951105256*^9}, \
{3.40262198684234*^9, 3.402622100739129*^9}, 3.402622211491249*^9, \
{3.4026225011899652`*^9, 3.40262252386333*^9}, {3.402622570954912*^9, \
3.402622839359087*^9}, {3.4026229314037333`*^9, 3.402622932282771*^9}, \
{3.402623015180378*^9, 3.402623186849554*^9}, {3.402623226099853*^9, \
3.402623232610919*^9}, {3.402623277330641*^9, 3.402623600618582*^9}, \
{3.4026236756599216`*^9, 3.402623688518423*^9}, {3.402623817642438*^9, \
3.402623827702593*^9}, {3.4026238977464314`*^9, 3.402624093215014*^9}, \
{3.402625357253566*^9, 3.4026255518408422`*^9}, {3.402625589372918*^9, \
3.4026255985124397`*^9}, {3.4026256476593437`*^9, 3.402625662767047*^9}, \
{3.4026257455168533`*^9, 3.402625899031448*^9}, 3.402656831029436*^9, \
{3.402659573134914*^9, 3.402659574896806*^9}, 3.402690850409452*^9, \
{3.4028585819015217`*^9, 3.4028586048367977`*^9}, {3.4028586570373907`*^9, \
3.4028587742056913`*^9}, {3.4028588111514397`*^9, 3.402858845395257*^9}, \
{3.402859988067623*^9, 3.4028599919413977`*^9}, 3.4028600867199574`*^9, \
{3.402860360653166*^9, 3.402860435661737*^9}, {3.402860564787163*^9, \
3.402860565340899*^9}, {3.4028606109153976`*^9, 3.4028606988616*^9}, \
{3.402860849745064*^9, 3.4028608842482147`*^9}, 3.402881964908531*^9, \
{3.402924560501296*^9, 3.402924563605465*^9}, 3.402924612851985*^9, \
3.402924654080158*^9, {3.402968956022805*^9, 3.402968993166883*^9}, \
{3.402969132525024*^9, 3.402969136303515*^9}, 3.402969173616342*^9, \
{3.402969306545293*^9, 3.402969308916185*^9}, {3.402970847235425*^9, \
3.402970983580715*^9}, {3.402971019936439*^9, 3.4029710304108133`*^9}, \
{3.402971221890442*^9, 3.4029712420276203`*^9}, {3.4029714268730373`*^9, \
3.402971487812521*^9}, {3.4029715964361486`*^9, 3.402971623603024*^9}, \
{3.403006490679843*^9, 3.403006522891176*^9}, {3.403006564678607*^9, \
3.403006578958898*^9}, {3.4030085680649548`*^9, 3.403008646225754*^9}, \
{3.403008676295245*^9, 3.403008681231986*^9}, {3.403008713714548*^9, \
3.4030087213464317`*^9}, {3.403008787542184*^9, 3.403008794606398*^9}, \
{3.403008835675002*^9, 3.403008883988284*^9}, {3.4030089572633657`*^9, \
3.403008973783063*^9}, {3.4030090345756807`*^9, 3.4030090363095837`*^9}, \
{3.403011565924679*^9, 3.40301162608622*^9}, {3.4030139144721527`*^9, \
3.403013939775319*^9}, {3.403032882534685*^9, 3.40303288348384*^9}, \
3.403032981374934*^9, 3.403097765034959*^9, {3.4030981208862543`*^9, \
3.403098170570052*^9}, {3.403098639997027*^9, 3.403098695945208*^9}, \
{3.403098749955078*^9, 3.403098756053461*^9}, 3.403098853338793*^9, \
{3.403098884673191*^9, 3.4030988990362263`*^9}, {3.403098954542899*^9, \
3.4030989605449038`*^9}, {3.403098997061414*^9, 3.4030989981026573`*^9}, \
{3.4030990356319723`*^9, 3.403099046567874*^9}, {3.403099506557383*^9, \
3.403099537021133*^9}, {3.403099614680118*^9, 3.40309966105573*^9}, \
3.403099709419215*^9, 3.403099760357193*^9, {3.403099830462154*^9, \
3.403099881545586*^9}, {3.403100734483959*^9, 3.4031007974789333`*^9}, \
{3.403100855021102*^9, 3.40310097621346*^9}, {3.403101058443831*^9, \
3.403101101526002*^9}, {3.403101161641831*^9, 3.4031013483589487`*^9}, \
{3.403101425009815*^9, 3.403101486970601*^9}}],

Cell[BoxData[
    \(\(\( (*\ 
      kkeq\  = \ k/keq\ *) \)\(\[IndentingNewLine]\)\(\[CapitalPhi][kkeq_, 
        y_] := \[CapitalPhi]bar[kkeq, 
          y] \((\((1 - 
                  T[kkeq])\) \[ExponentialE]\^\(\(- .11\) \((y\ \
kkeq)\)\^1.6\) + T[kkeq])\)\[IndentingNewLine]
    \[CapitalPsi][kkeq_, 
        y_] := \[CapitalPsi]bar[kkeq, 
          y] \((\((1 - 
                  T[kkeq])\) \[ExponentialE]\^\(\(- .097\) \((\ y\ \
kkeq)\)\^1.6\) + T[kkeq])\)\[IndentingNewLine]
    T[x_] := \(Log[
              1 +  .171\ x]\/\( .171\ x\)\) \((1 +  .284\ x + \((1.18\ \
x)\)\^2 + \(( .399\ x)\)\^3 + \(( .49\ x)\)\^4)\)\^\(- .25\)\
\[IndentingNewLine]
    \[CapitalPhi]bar[kkeq_, 
        y_] := \(3\/4\) \(\((1\/kkeq)\)\^2\) \(\(y + 
              1\)\/y\^2\) \[CapitalDelta]\_T[y]\[IndentingNewLine]
    \[CapitalPsi]bar[kkeq_, 
        y_] := \(-\(3\/4\)\) \(\((1\/kkeq)\)\^2\) \(\(y + 
              1\)\/y\^2\) \((\[CapitalDelta]\_T[
              y] +  .65\ N2[y]/\((1 + y)\))\)\[IndentingNewLine]
    N2[y_] := \(-0.1\) \(\(20\ y\  + 19\)\/\(3\ y\  + 4\)\) \(y\^2\/\(y + 
                1\)\) \[CapitalPhi]ls[y] - \(8\/3\) 
          y\/\(3\ y\  + 4\) + \(8\/9\) Log[3\ y/4 + 1]\[IndentingNewLine]
    \[CapitalDelta]\_T[
        y_] := \((1.16 - \( .48\ y\)\/\(y + 1\))\) \[CapitalPhi]ls[y] 
        y\^2\/\(y + 1\)\[IndentingNewLine]
    \[CapitalPhi]ls[
        y_] := \(\[CapitalPhi][0]\/10\) \(1\/y\^3\) \((16 \@\( 1 + y\) + 
            9\ y\^3 + 2\ y\^2 - 8\ y - 16)\)\[IndentingNewLine]
    intg = integrand824[kkeq, x] // FullSimplify\)\)\)], "Input",
  CellDingbat->"\[DottedSquare]",
  CellChangeTimes -> {{3.402528763200732*^9, 3.402528769991412*^9}, \
{3.402528876739986*^9, 3.402529107072914*^9}, {3.402529140274191*^9, \
3.4025293241672173`*^9}, {3.402621808592819*^9, 3.402621951105256*^9}, \
{3.40262198684234*^9, 3.402622100739129*^9}, 3.402622211491249*^9, \
{3.4026225011899652`*^9, 3.40262252386333*^9}, {3.402622570954912*^9, \
3.402622839359087*^9}, {3.4026229314037333`*^9, 3.402622932282771*^9}, \
{3.402623015180378*^9, 3.402623186849554*^9}, {3.402623226099853*^9, \
3.402623232610919*^9}, {3.402623277330641*^9, 3.402623600618582*^9}, \
{3.4026236756599216`*^9, 3.402623688518423*^9}, {3.402623817642438*^9, \
3.402623827702593*^9}, {3.4026238977464314`*^9, 3.402624093215014*^9}, \
{3.402625357253566*^9, 3.4026255518408422`*^9}, {3.402625589372918*^9, \
3.4026255985124397`*^9}, {3.4026256476593437`*^9, 3.402625662767047*^9}, \
{3.4026257455168533`*^9, 3.402625899031448*^9}, 3.402656831029436*^9, \
{3.402659573134914*^9, 3.402659574896806*^9}, 3.402690850409452*^9, \
{3.4028585819015217`*^9, 3.4028586048367977`*^9}, {3.4028586570373907`*^9, \
3.4028587742056913`*^9}, {3.4028588111514397`*^9, 3.402858845395257*^9}, \
{3.402859988067623*^9, 3.4028599919413977`*^9}, 3.4028600867199574`*^9, \
{3.402860360653166*^9, 3.402860435661737*^9}, {3.402860564787163*^9, \
3.402860565340899*^9}, {3.4028606109153976`*^9, 3.4028606988616*^9}, \
{3.402860849745064*^9, 3.4028608842482147`*^9}, 3.402881964908531*^9, \
{3.402924560501296*^9, 3.402924563605465*^9}, 3.402924612851985*^9, \
3.402924654080158*^9, {3.402968956022805*^9, 3.402968959304105*^9}, \
3.40296962243436*^9, {3.4030062922832317`*^9, 3.403006299960495*^9}, \
3.403008512507835*^9, {3.403009088282189*^9, 3.40300908972344*^9}, \
{3.403013967282075*^9, 3.403013975037302*^9}, {3.403014462200683*^9, \
3.403014503688313*^9}, {3.403014577531453*^9, 3.4030147580921917`*^9}, \
{3.4030148901021852`*^9, 3.4030148909739447`*^9}, {3.40301496436714*^9, \
3.4030149742774677`*^9}, {3.4030151833715363`*^9, 3.403015192846518*^9}, \
{3.403015394742399*^9, 3.403015406139882*^9}, {3.4030156536849117`*^9, \
3.403015654638637*^9}, {3.4030298776174726`*^9, 3.403029879791397*^9}}],

Cell[BoxData[
    \(\(\(tmp = kkeq\^\(\(2\)\(\ \)\)\ intg\)\(\[IndentingNewLine]\)
    \)\)], "Input",
  CellChangeTimes -> {{3.403015335733528*^9, 3.403015364159565*^9}, \
{3.40301541196914*^9, 3.4030154138259163`*^9}, {3.403015451202883*^9, \
3.403015492775352*^9}, {3.4030155542161627`*^9, 3.403015568530682*^9}, \
{3.4030158365219307`*^9, 3.403015861097946*^9}, 3.403016002154405*^9, \
{3.4030170453794394`*^9, 3.403017046821711*^9}, {3.403030110840678*^9, \
3.4030301969861507`*^9}, {3.4030302751007977`*^9, 3.4030303172969103`*^9}, \
{3.403030412426705*^9, 3.403030449509184*^9}, {3.403030514247861*^9, \
3.40303053834123*^9}, {3.403030589706258*^9, 3.403030604057934*^9}, \
{3.403030818730997*^9, 3.403030992261491*^9}, {3.403031053309876*^9, \
3.40303105475352*^9}, {3.403031100430995*^9, 3.403031109789711*^9}, \
{3.403031203685216*^9, 3.403031206588841*^9}, {3.403031274669901*^9, \
3.4030313113414087`*^9}, 3.403031387215745*^9, {3.403031463110043*^9, \
3.403031480165659*^9}, {3.4030315408196793`*^9, 3.4030315415154743`*^9}, \
{3.4030316403170223`*^9, 3.403031641857836*^9}, {3.403031877614511*^9, \
3.403031906783493*^9}, {3.403031971253604*^9, 3.403031972044976*^9}, \
{3.4030321261280947`*^9, 3.403032140741263*^9}, 3.403101790578289*^9, \
{3.403101828046302*^9, 3.403101837317054*^9}, 3.403101868237575*^9, \
{3.4031019378527403`*^9, 3.403101964129141*^9}}],

Cell[BoxData[
    \(\(\(Tot[\[Eta]] == \((\[CapitalTheta]\_0[0] + \[CapitalPhi][0])\) 
        Cos[k\ r\_s[\[Eta]]]\)\(\[IndentingNewLine]\)\(\[IndentingNewLine]\)
    \)\)], "Input",
  CellDingbat->"\[DottedSquare]",
  CellChangeTimes -> {{3.402528763200732*^9, 3.402528769991412*^9}, \
{3.402528876739986*^9, 3.402529107072914*^9}, {3.402529140274191*^9, \
3.4025293241672173`*^9}, {3.402621808592819*^9, 3.402621951105256*^9}, \
{3.40262198684234*^9, 3.402622100739129*^9}, 3.402622211491249*^9, \
{3.4026225011899652`*^9, 3.40262252386333*^9}, {3.402622570954912*^9, \
3.402622839359087*^9}, {3.4026229314037333`*^9, 3.402622932282771*^9}, \
{3.402623015180378*^9, 3.402623186849554*^9}, {3.402623226099853*^9, \
3.402623232610919*^9}, {3.402623277330641*^9, 3.402623600618582*^9}, \
{3.4026236756599216`*^9, 3.402623688518423*^9}, {3.402623817642438*^9, \
3.402623827702593*^9}, {3.4026238977464314`*^9, 3.402624093215014*^9}, \
{3.402625357253566*^9, 3.4026255518408422`*^9}, {3.402625589372918*^9, \
3.4026255985124397`*^9}, {3.4026256476593437`*^9, 3.402625662767047*^9}, \
{3.4026257455168533`*^9, 3.402625899031448*^9}, 3.402656831029436*^9, \
{3.402659573134914*^9, 3.402659574896806*^9}, 3.402690850409452*^9, \
{3.4028585819015217`*^9, 3.4028586048367977`*^9}, {3.4028586570373907`*^9, \
3.4028587742056913`*^9}, {3.4028588111514397`*^9, 3.402858845395257*^9}, \
{3.402859988067623*^9, 3.4028599919413977`*^9}, 3.4028600867199574`*^9, \
{3.402860360653166*^9, 3.402860435661737*^9}, {3.402860564787163*^9, \
3.402860565340899*^9}, {3.4028606109153976`*^9, 3.4028606988616*^9}, \
{3.402860849745064*^9, 3.4028608842482147`*^9}, 3.402881964908531*^9, \
{3.402924560501296*^9, 3.402924563605465*^9}, 3.402924612851985*^9, \
{3.402924654080158*^9, 3.4029246956229877`*^9}, {3.4029247449470463`*^9, \
3.402924788254239*^9}, {3.40292528328401*^9, 3.402925396290659*^9}, \
{3.402925434168976*^9, 3.402925442286031*^9}, {3.4029255611507387`*^9, \
3.402925676408085*^9}, 3.402925795286046*^9, 3.402925885279419*^9, \
{3.402926357567655*^9, 3.402926389942663*^9}, {3.402926420163005*^9, \
3.402926442638412*^9}, {3.4029264742899323`*^9, 3.402926475145275*^9}, \
{3.402926506014407*^9, 3.402926507588168*^9}, {3.4029265612655067`*^9, \
3.4029266127683487`*^9}, {3.402926643631295*^9, 3.402926676161256*^9}, \
{3.4029267359965553`*^9, 3.40292680340917*^9}, {3.402927039019863*^9, \
3.402927056791356*^9}, {3.40292712491088*^9, 3.402927222828692*^9}, \
{3.402927285932279*^9, 3.4029272890990763`*^9}, {3.402927354124608*^9, \
3.402927376611232*^9}, {3.402927425823884*^9, 3.402927448474523*^9}, \
{3.402927499737555*^9, 3.4029275415081053`*^9}, {3.402927638944849*^9, \
3.402927698909766*^9}, 3.402927731364039*^9, {3.4029277652040586`*^9, \
3.402927798206766*^9}, {3.4029278666555643`*^9, 3.402927902956266*^9}, \
{3.4029279436597958`*^9, 3.402928011022293*^9}, {3.4029280924543324`*^9, \
3.402928132538167*^9}, {3.4029281708672037`*^9, 3.402928277557502*^9}, \
3.402939313621489*^9, {3.402939374203149*^9, 3.402939463409541*^9}, \
3.402939497739749*^9, {3.4029395549104967`*^9, 3.402939617526572*^9}, \
{3.402939651721217*^9, 3.402939661251954*^9}, {3.402939699899939*^9, \
3.402939711392365*^9}, {3.402939770867341*^9, 3.402939795253726*^9}, \
3.402940069592189*^9, {3.4029401098193407`*^9, 3.4029401132422647`*^9}, \
{3.4029402533904667`*^9, 3.402940275444601*^9}, {3.402940334443142*^9, \
3.4029403349505653`*^9}, 3.40294056881034*^9, {3.402954130994913*^9, \
3.402954133170292*^9}, {3.402954167646261*^9, 3.402954224281032*^9}, \
{3.402954358282527*^9, 3.402954496836565*^9}, {3.402954582649517*^9, \
3.402954592967485*^9}, {3.4029546572034883`*^9, 3.4029546894167557`*^9}, \
{3.402954797084873*^9, 3.402954845375906*^9}, {3.402954910654017*^9, \
3.4029549355383863`*^9}, 3.402954974778314*^9, {3.402955025211741*^9, \
3.4029550358771353`*^9}, {3.4029550749514923`*^9, 3.40295514550569*^9}, \
3.402955200258863*^9, {3.4029552409160852`*^9, 3.4029552732130527`*^9}, \
{3.402955358719923*^9, 3.4029553596850977`*^9}, {3.4029554428503847`*^9, \
3.402955450175696*^9}, {3.402955561165202*^9, 3.4029555876525087`*^9}, \
{3.402955633285512*^9, 3.402955651042549*^9}, {3.402955689564459*^9, \
3.402955701518312*^9}, 3.402955761804147*^9, {3.402955832490151*^9, \
3.402955833730842*^9}, {3.4029558799933*^9, 3.402955907477643*^9}, \
{3.40295596481698*^9, 3.4029560465743093`*^9}, 3.402956194717684*^9, \
{3.402956226650167*^9, 3.4029562477655087`*^9}, {3.402956335728763*^9, \
3.402956457175352*^9}, {3.40295649137248*^9, 3.4029564977604628`*^9}, \
{3.402956529213937*^9, 3.402956569345632*^9}, {3.402956613692194*^9, \
3.40295668400473*^9}, {3.402956729573758*^9, 3.402956733009601*^9}, \
{3.4029568330644712`*^9, 3.402956834732232*^9}, {3.402956903079379*^9, \
3.402956909904358*^9}, {3.4029574369029083`*^9, 3.402957465002613*^9}, \
3.402957535889347*^9, {3.4029576040691223`*^9, 3.402957625430697*^9}, \
3.402957662162283*^9, {3.402957752147142*^9, 3.402957833421975*^9}, \
{3.40295788284544*^9, 3.402957943922961*^9}, {3.402958027948524*^9, \
3.402958036535075*^9}, {3.402958146924613*^9, 3.4029582227740297`*^9}, \
{3.4029582750744953`*^9, 3.402958277758235*^9}, {3.4029583220880823`*^9, \
3.402958340402184*^9}, {3.4029583723763647`*^9, 3.402958426823472*^9}, \
{3.402958484275207*^9, 3.402958543159446*^9}, {3.402958705508895*^9, \
3.402958740880624*^9}, {3.4029588463978252`*^9, 3.402958857627985*^9}, \
{3.4029589020732183`*^9, 3.4029589432644787`*^9}, 3.402964185802144*^9, \
{3.402964234437045*^9, 3.40296423609081*^9}, {3.402964346582466*^9, \
3.402964431355316*^9}, {3.4029644616261997`*^9, 3.402964470071596*^9}, \
3.4029645990700617`*^9, {3.402964675678281*^9, 3.4029647775319366`*^9}, \
{3.402965048639193*^9, 3.402965071436761*^9}, {3.40296510820718*^9, \
3.40296543484969*^9}, {3.402965541162106*^9, 3.402965550101199*^9}, \
3.4029655848938627`*^9, {3.402965615214594*^9, 3.40296561734083*^9}, \
{3.402965658617943*^9, 3.40296567673001*^9}, {3.402965740015984*^9, \
3.402965751405924*^9}, {3.402966380844717*^9, 3.402966417378624*^9}, \
3.402966459385623*^9, {3.402966567954094*^9, 3.40296656848759*^9}, \
3.402966643849184*^9, {3.402966721837392*^9, 3.402966799633491*^9}, \
3.402966843293983*^9, {3.4029669280021343`*^9, 3.402967026303998*^9}, \
3.402967056819257*^9, 3.402967232786489*^9, {3.402967388078203*^9, \
3.402967413840144*^9}, {3.402967474694724*^9, 3.402967478169169*^9}, \
{3.403055785249317*^9, 3.403055836641405*^9}, 3.403055914170857*^9, \
{3.403055957922439*^9, 3.403056002640381*^9}, {3.403056065532976*^9, \
3.403056213669289*^9}, 3.403056257142734*^9, {3.403056290742291*^9, \
3.403056291988791*^9}, {3.403056327724978*^9, 3.403056353362925*^9}, \
{3.4031022482495127`*^9, 3.4031022591965446`*^9}}],

Cell[BoxData[{
    \(y = a/a\_eq /. subaeq\), "\[IndentingNewLine]", 
    \(Clear[y]\), "\[IndentingNewLine]", 
    \(\[CapitalPsi][kkeq, y]/\[CapitalPhi][0]\), "\[IndentingNewLine]", 
    \(Limit[\[CapitalPhi][ .1, y]/\[CapitalPhi][0], 
      y -> 0]\), "\[IndentingNewLine]", 
    \(\(\(Limit[\[CapitalPsi][ .1, y]/\[CapitalPhi][0], 
      y -> 0]\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(Plot[{kkeq\^\(3/2\)\ \[CapitalPhi][kkeq, 1]/\[CapitalPhi][
              0]}, {kkeq,  .01, 10}]\), "\[IndentingNewLine]", 
    \(Plot[{\[CapitalPhi][1, y]/\[CapitalPhi][0]}, {y,  .001, 
        10}]\), "\[IndentingNewLine]", 
    \(ContourPlot[{\(kkeq\^\(\(3/2\)\(\ \)\)\) \[CapitalPhi][kkeq, 
              y]/\[CapitalPhi][0]}, {kkeq,  .01, 10}, {y,  .001, 
        10}]\)}], "Input",
  CellChangeTimes -> {{3.403057231102841*^9, 3.403057238301935*^9}, \
{3.403057436908733*^9, 3.40305743780056*^9}, {3.403057470836084*^9, \
3.403057478090987*^9}, {3.403057594280199*^9, 3.403057649226696*^9}, \
{3.403057694932819*^9, 3.4030577653826*^9}, {3.403093948668229*^9, \
3.403094018429433*^9}, {3.403094136395158*^9, 3.403094150713683*^9}, \
{3.403094326616827*^9, 3.4030943524336853`*^9}, {3.403094443720665*^9, \
3.403094488414666*^9}, {3.403094662177898*^9, 3.403094673765828*^9}, \
{3.403094738230981*^9, 3.403094853610428*^9}, {3.403095051854887*^9, \
3.4030950998253307`*^9}, {3.403095830089201*^9, 3.4030958646133947`*^9}, \
{3.4030959449668703`*^9, 3.403095949459309*^9}, {3.403095984169381*^9, \
3.403095989366568*^9}, {3.403096046329542*^9, 3.403096050486206*^9}, \
{3.4030961312428226`*^9, 3.403096135652093*^9}, {3.403096199400976*^9, \
3.403096203507745*^9}, 3.403096953060923*^9, {3.403097033664057*^9, \
3.403097052949914*^9}}]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"5.2 for Macintosh",
ScreenRectangle->{{4, 1280}, {0, 1002}},
WindowToolbars->{},
WindowSize->{640, 656},
WindowMargins->{{Automatic, 89}, {Automatic, 0}},
StyleDefinitions -> "TensorialStyle.nb"
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 152, 3, 46, "Subtitle"],

Cell[CellGroupData[{
Cell[1953, 60, 387, 10, 66, "Subsection"],
Cell[2343, 72, 4983, 94, 840, "Input"],
Cell[7329, 168, 4535, 70, 291, "Input"],
Cell[11867, 240, 3874, 61, 398, "Input"],
Cell[15744, 303, 1376, 20, 61, "Input"],
Cell[17123, 325, 6734, 95, 75, "Input"],
Cell[23860, 422, 1744, 28, 192, "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[25653, 456, 152, 3, 70, "Subtitle"],

Cell[CellGroupData[{
Cell[25830, 463, 387, 10, 70, "Subsection"],
Cell[26220, 475, 4981, 94, 70, "Input"],
Cell[31204, 571, 4525, 68, 70, "Input"],
Cell[35732, 641, 3776, 63, 70, "Input"],
Cell[39511, 706, 1374, 20, 70, "Input"],
Cell[40888, 728, 6737, 95, 70, "Input"],
Cell[47628, 825, 1753, 29, 70, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

