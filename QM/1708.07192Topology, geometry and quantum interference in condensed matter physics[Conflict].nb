(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    371988,       9431]
NotebookOptionsPosition[    365338,       9305]
NotebookOutlinePosition[    365704,       9321]
CellTagsIndexPosition[    365661,       9318]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", 
  "Local`QFTToolKit2`"}], "\[IndentingNewLine]", "tuItalics"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56864327369387*^9, 3.5686433185337973`*^9}, {
   3.636124223447123*^9, 3.6361242241696672`*^9}, {3.640430449322165*^9, 
   3.640430454418408*^9}, {3.6464973100744457`*^9, 3.646497314447693*^9}, {
   3.6694279608619347`*^9, 3.6694280040414133`*^9}, 3.670117817981682*^9, {
   3.671366579055991*^9, 3.6713666038803663`*^9}, {3.689772928097857*^9, 
   3.689772930433343*^9}, {3.732388727865262*^9, 3.732388755781152*^9}, {
   3.777221915099526*^9, 3.777221934544393*^9}, {3.791814820726375*^9, 
   3.791814847130887*^9}},ExpressionUUID->"5fbe7f1f-bb50-45f0-a196-\
f918e4732957"],

Cell[BoxData["\<\"Thu 19 Mar 2020 20:54:28\"\>"], "Output",
 CellChangeTimes->{
  3.792848371697976*^9, {3.793191930852014*^9, 3.793191932071959*^9}, {
   3.793302762580155*^9, 3.793302763564426*^9}, {3.793371065766358*^9, 
   3.793371066912333*^9}, {3.793549489788581*^9, 3.793549490814068*^9}, {
   3.7936652679173098`*^9, 
   3.793665268594879*^9}},ExpressionUUID->"a8420a03-6bf3-431e-a75c-\
ba549ca09e4a"]
}, Open  ]],

Cell["\<\
1708.07192Topology, geometry and quantum interference in condensed matter \
physics.pdf --by A. Abanov\
\>", "Section",
 CellChangeTimes->{{3.792510851061994*^9, 3.792510867809889*^9}, {
  3.792681457995576*^9, 
  3.792681459289113*^9}},ExpressionUUID->"0ac4dab0-4cd0-4d9b-a985-\
bd0415c877ed"],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.792510638910294*^9, 
  3.792510643218574*^9}},ExpressionUUID->"72d21847-5b16-4c32-9725-\
b73476101bef"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
  "URL", "[", 
   "\"\<https://link.springer.com/content/pdf/10.1007%2FJHEP05%282017%29091.\
pdf\>\"", "]"}]], "Input",
  CellChangeTimes->{{3.792510584582066*^9, 3.792510588924198*^9}},
  ExpressionUUID->"d78e84a8-f02c-40d8-8095-cc830483cdd7"],
 "\n",
 Cell[BoxData[
  RowBox[{"URL", "[", 
   TemplateBox[{
    "\"https://link.springer.com/content/pdf/10.1007%2FJHEP05%282017%29091.\
pdf\""},
    "URLArgument"], "]"}]], "Input",
  CellChangeTimes->{3.792510946726161*^9},ExpressionUUID->
  "4a335aa8-2783-4b57-a2af-fd3abeb709a7"]
}], "InlineFormula",
 CellChangeTimes->{{3.792510931642033*^9, 3.7925109598688393`*^9}, {
  3.792511132473298*^9, 3.7925111709979258`*^9}, {3.7925112048321466`*^9, 
  3.792511209558259*^9}},ExpressionUUID->"466d7187-6c67-45bb-9daf-\
32627d6d30b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1 Introductory remarks", "Section",
 CellChangeTimes->{{3.792511231261397*^9, 
  3.79251124288555*^9}},ExpressionUUID->"d6dd88c9-bc1d-48d0-bc63-\
b79b0a93b3f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"CG", "[", "\"\<with continuous symmetry G\>\"", "]"}], "]"}],
        "\[Rule]", 
       RowBox[{
        RowBox[{"SO", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"U", "[", "1", "]"}]}]}], ",", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"H", ",", "G"}], "]"}], "[", 
        RowBox[{
        "CG", "[", 
         "\"\<symmetry braking into subgroups of H [coset space]\>\"", "]"}], 
        "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"SU", "[", "2", "]"}], ",", 
          RowBox[{"U", "[", "1", "]"}]}], "]"}], "\[Rule]", 
        SuperscriptBox["S", "2"]}]}]}], "\n", "}"}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\n"}]], "Code",
 CellChangeTimes->{{3.792511903832543*^9, 3.792512022683538*^9}, {
  3.792512068659267*^9, 3.7925122186473083`*^9}, {3.792531000591074*^9, 
  3.792531032199637*^9}, {3.792591929519951*^9, 
  3.792591947179325*^9}},ExpressionUUID->"15c8e8a3-b541-4ed5-a9d2-\
c0cc7d54962d"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"H", "[", 
       StyleBox["\<\"with continuous symmetry G\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"SO", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"U", "[", "1", "]"}]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"H", ",", "G"}], "]"}], "[", 
       StyleBox["\<\"symmetry braking into subgroups of H [coset space]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"SU", "[", "2", "]"}], ",", 
         RowBox[{"U", "[", "1", "]"}]}], "]"}], "\[Rule]", 
       SuperscriptBox["S", "2"]}]}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.7925119328381147`*^9, 3.79251199901621*^9, 3.7925120752526703`*^9, {
   3.792512119581585*^9, 3.792512207936412*^9}, {3.792531013761195*^9, 
   3.7925310332115507`*^9}, {3.792591938058207*^9, 3.792591947906411*^9}, 
   3.792681363639369*^9, {3.7928482143468733`*^9, 3.792848217905076*^9}, 
   3.792848332636182*^9, 3.792848372561384*^9, 3.792848760019713*^9, {
   3.793191931353426*^9, 3.793191932410499*^9}, {3.7933027630600233`*^9, 
   3.793302763899877*^9}, {3.793371066409362*^9, 3.793371067342946*^9}, {
   3.7935494903756742`*^9, 3.793549491117621*^9}, {3.7936652682845793`*^9, 
   3.793665268850458*^9}},ExpressionUUID->"426a4630-be3d-409d-aeb8-\
e655f7a19cc2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2 Motivating example: a particle on a ring", "Section",
 CellChangeTimes->{{3.7926226224238787`*^9, 
  3.792622632616851*^9}},ExpressionUUID->"7e555e1f-5a96-4217-bb6b-\
7f805621b557"],

Cell[CellGroupData[{

Cell["2.1 Classical particle on a ring", "Subsection",
 CellChangeTimes->{{3.792638303382678*^9, 
  3.792638313710559*^9}},ExpressionUUID->"f7c569ef-76f9-4d72-8d27-\
f76ea5d95d90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "2", "]"}], "=", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", "\[Phi]", "]"}], "->", 
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{"\[Phi]", ",", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "]"}], ",", "t"}], 
         "]"}]}], ",", "\[LineSeparator]", 
       RowBox[{"$l", "=", 
        RowBox[{"L", "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "/", "2"}], " ", 
           SuperscriptBox[
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "t"}], "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"CG", "[", "\"\<constant\>\"", "]"}], "]"}], " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"\[Phi]", ",", "t"}], "]"}]}]}]}]}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"M", " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"\[Phi]", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "t"}], "}"}]}], "]"}]}], "\[Rule]", "0"}], 
         "}"}], "[", 
        RowBox[{"CG", "[", "\"\<EOM\>\"", "]"}], "]"}], ",", "\n", 
       RowBox[{"$p", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$", "=", 
            RowBox[{"p", "\[Rule]", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"L", ",", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "]"}]}]}], ",", "\n", 
           RowBox[{
            RowBox[{"$", "/.", 
             RowBox[{"tuRule", "[", "$l", "]"}]}], "//", 
            RowBox[{"tuDerivativeExpand", "[", 
             RowBox[{"{", 
              RowBox[{"A", ",", "M"}], "}"}], "]"}]}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<conjugate momentum\>\"", "]"}], "]"}]}], ",",
        "\n", "\n", 
       RowBox[{"$h", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$h", "=", 
            RowBox[{"H", "\[Rule]", 
             RowBox[{
              RowBox[{"p", " ", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "-", "L"}]}]}], ",", 
           "\n", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"$h", "/.", "$l"}], ",", "$p"}], "}"}], "//", 
                RowBox[{"tuRuleSelect", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"H", ",", "p"}], "}"}], ",", 
                  RowBox[{"{", "A", "}"}]}], "]"}]}], "//", 
               RowBox[{
                RowBox[{"tuEliminate", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"tuDPartial", "[", 
                    RowBox[{"\[Phi]", ",", "t"}], "]"}], "}"}]}], "]"}], 
                "&"}]}], "\n", "//", 
              RowBox[{"tuRuleSolveF", "[", "H", "]"}]}], "//", "tuRule1"}], "//",
             "Factor"}]}], "\n", "}"}], "[", 
         RowBox[{"CG", "[", "\"\<Hamiltonian\>\"", "]"}], "]"}]}]}], "\n", 
      "\n", "}"}], "[", 
     RowBox[{"CG", "[", "\"\<particle on a ring\>\"", "]"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ColumnForms", "[", 
      RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}], "//", 
  "PR"}], "\n"}], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.792622653348363*^9, 3.792622893299519*^9}, {
   3.7926229386473703`*^9, 3.792622965808762*^9}, {3.7926349744987803`*^9, 
   3.792635051632505*^9}, {3.792635324096233*^9, 3.79263562191166*^9}, {
   3.79263575719176*^9, 3.792635758004767*^9}, {3.792637399901596*^9, 
   3.7926374045255327`*^9}, {3.7926374358584023`*^9, 3.792637436227084*^9}, {
   3.7926374685049343`*^9, 3.79263776712211*^9}, {3.792638031231385*^9, 
   3.792638101942367*^9}, {3.7926382153814583`*^9, 3.792638228559104*^9}, {
   3.79264069228929*^9, 3.792640692431559*^9}, {3.79277621476149*^9, 
   3.792776215491026*^9}, {3.792776294748028*^9, 3.792776318951663*^9}, 
   3.7928463774972973`*^9, {3.792848819646143*^9, 3.792848854228611*^9}, {
   3.7928488843803*^9, 3.7928491681283216`*^9}, {3.7928492512088346`*^9, 
   3.7928492521213627`*^9}, {3.7928499925071573`*^9, 
   3.7928500639078093`*^9}, {3.792850150756222*^9, 
   3.792850201059517*^9}},ExpressionUUID->"518a0ad7-d6d4-4b64-baf6-\
255975dc9e48"],

Cell[BoxData[
 RowBox[{
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
       TemplateBox[{RowBox[{"L", "[", 
           RowBox[{"\[Phi]", ",", 
             InterpretationBox[
              RowBox[{
                SubscriptBox[
                 UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "\[Phi]", 
                "]"}], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], SyntaxForm -> 
              Automatic, Editable -> False]}], "]"}],"t"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]},
     {
      RowBox[{"L", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          StyleBox["\<\"constant\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}], " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", "M", " ", 
         SuperscriptBox[
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic], "2"]}]}]}]},
     {
      RowBox[{
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"M", " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                RowBox[{"{", 
                 RowBox[{"t", ",", "t"}], "}"}]], "[", "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], {$CellContext`t, \
$CellContext`t}],
              Editable->False,
              SyntaxForm->Automatic]}], "\[Rule]", "0"}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "[", 
       StyleBox["\<\"EOM\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]},
     {
      RowBox[{
       TagBox[GridBox[{
          {
           RowBox[{"p", "\[Rule]", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 "\[Phi]", "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]], "[", "L", "]"}],
             $CellContext`tuDDown["\[PartialD]"][$CellContext`L, 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]],
             Editable->False,
             SyntaxForm->Automatic]}]},
          {
           RowBox[{"p", "\[Rule]", 
            RowBox[{"A", "+", 
             RowBox[{"M", " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "[", 
       StyleBox["\<\"conjugate momentum\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]},
     {
      RowBox[{
       TagBox[GridBox[{
          {
           RowBox[{"H", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "L"}], "+", 
             RowBox[{"p", " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}]}]},
          {
           RowBox[{"H", "\[Rule]", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"A", "-", "p"}], ")"}], "2"], 
             RowBox[{"2", " ", "M"}]]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "[", 
       StyleBox["\<\"Hamiltonian\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]}
    },
    AutoDelete->False,
    FrameStyle->Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]],
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "[", 
  StyleBox["\<\"particle on a ring\"\>",
   StripOnInput->False,
   LineColor->RGBColor[0, 
     Rational[2, 3], 0],
   FrontFaceColor->RGBColor[0, 
     Rational[2, 3], 0],
   BackFaceColor->RGBColor[0, 
     Rational[2, 3], 0],
   GraphicsColor->RGBColor[0, 
     Rational[2, 3], 0],
   FontFamily->"Helvetica",
   FontColor->RGBColor[0, 
     Rational[2, 3], 0]], "]"}]], "Print",
 CellChangeTimes->{{3.792849065863381*^9, 3.7928491691664867`*^9}, 
   3.7928492537738113`*^9, {3.792850012805869*^9, 3.79285006460527*^9}, {
   3.7928501542557173`*^9, 3.792850181120081*^9}, 3.7931919325236607`*^9, 
   3.7933027641454067`*^9, 3.7933710676304398`*^9, 3.793549491321813*^9, 
   3.793665269004939*^9},ExpressionUUID->"0e9d28e9-d80d-497a-8f9d-\
3335530a016b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.2 Quantum particle on a ring", "Subsection",
 CellChangeTimes->{{3.7926383326458397`*^9, 
  3.7926383426298*^9}},ExpressionUUID->"fd6d9595-7898-43a5-a473-76b576704950"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "9", "]"}], "=", 
   RowBox[{"$", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], "//", 
          RowBox[{"tuRuleSelect", "[", 
           RowBox[{"H", ",", 
            RowBox[{"{", "A", "}"}]}], "]"}]}], "//", "tuRule1"}]}], ";", 
       RowBox[{"$", "=", 
        RowBox[{"$", "/.", 
         RowBox[{
          SuperscriptBox["a_", "2"], "\[Rule]", 
          RowBox[{"a", ".", "a"}]}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$p", "=", 
         RowBox[{"p", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"_", ",", "\[Phi]"}], "]"}]}]}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<wave-function representation\>\"", "]"}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$sh", "=", 
         RowBox[{"$", "/.", "$p"}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<Schrodinger eqn\>\"", "]"}], "]"}], ",", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", ".", "\[Psi]"}], "&"}], "/@", "$sh"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "//", 
         RowBox[{"tuBlankOpNest", "[", 
          RowBox[{"{", "A", "}"}], "]"}]}], "//", 
        RowBox[{"expandDC", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "M"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tuDerivativeExpand", "[", 
             RowBox[{"{", "A", "}"}], "]"}], ",", "Simplify"}], "}"}], ",", 
          "3"}], "]"}]}]}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$s", "=", 
         RowBox[{"\[Psi]", "\[Rule]", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}]}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<constraint\>\"", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"$", "/.", "$s"}], "//", 
         RowBox[{"tuDerivativeExpand", "[", 
          RowBox[{"{", "m", "}"}], "]"}]}], "//", 
        RowBox[{"expandDC", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Exp", "[", "_", "]"}], "}"}], ",", 
          RowBox[{"{", "Simplify", "}"}], ",", "3"}], "]"}]}]}], ",", "\n", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "//", 
         RowBox[{"tuRuleSolveF", "[", "H", "]"}]}], "//", "tuRule1"}]}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["iE", "m"], "->", 
         RowBox[{"$", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<eigenvalues\>\"", "]"}], "]"}]}], "\n", 
     "}"}]}]}], ";", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ColumnForms", "[", 
      RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.792640736712393*^9, 3.7926409082171288`*^9}, {
   3.792675512741528*^9, 3.792675555507331*^9}, {3.792675628115872*^9, 
   3.792675855714984*^9}, {3.792675892014975*^9, 3.792675906126772*^9}, 
   3.792675938479754*^9, {3.792675971900134*^9, 3.792676057867989*^9}, {
   3.792676098458235*^9, 3.7926762143147993`*^9}, {3.7926762825334263`*^9, 
   3.792676287027199*^9}, {3.792676325171938*^9, 3.792676364216609*^9}, {
   3.792676406759881*^9, 3.792676423403638*^9}, {3.792676465726581*^9, 
   3.792676620490408*^9}, {3.7926766827805433`*^9, 3.792676683258082*^9}, {
   3.792676713864381*^9, 3.792676792254593*^9}, {3.7926768345589247`*^9, 
   3.7926768564226227`*^9}, {3.792676897089456*^9, 3.792676993931411*^9}, {
   3.792677046782504*^9, 3.792677066049377*^9}, {3.792677180197125*^9, 
   3.7926771937290487`*^9}, {3.792677248276114*^9, 3.792677256092717*^9}, {
   3.792677300956726*^9, 3.79267730199124*^9}, {3.792677344065024*^9, 
   3.7926773455291147`*^9}, {3.792677409654325*^9, 3.792677426252754*^9}, {
   3.7926774596060658`*^9, 3.7926775294765453`*^9}, {3.7926775739886293`*^9, 
   3.792677618626484*^9}, {3.7926776521406317`*^9, 3.79267765443431*^9}, {
   3.792677713189817*^9, 3.792677890132401*^9}, {3.792677925237763*^9, 
   3.792677963603133*^9}, {3.792677993760591*^9, 3.7926780068864403`*^9}, {
   3.792678061679742*^9, 3.7926780626976013`*^9}, {3.792678101194291*^9, 
   3.7926781305318193`*^9}, {3.792678163793539*^9, 3.792678225705329*^9}, {
   3.792678256265524*^9, 3.792678290906055*^9}, {3.7926783600487537`*^9, 
   3.792678907712658*^9}, {3.792679021888947*^9, 3.792679025722221*^9}, {
   3.792679076021277*^9, 3.7926790781623983`*^9}, {3.7926791132635307`*^9, 
   3.792679116843286*^9}, {3.792679148795261*^9, 3.7926791938190813`*^9}, {
   3.7926792267044783`*^9, 3.792679243993101*^9}, {3.7926792749057207`*^9, 
   3.792679279133061*^9}, {3.792679391864616*^9, 3.792679441848672*^9}, {
   3.792680025360032*^9, 3.7926800284702673`*^9}, {3.792680266762332*^9, 
   3.792680324525897*^9}, {3.792680374715934*^9, 3.79268041395959*^9}, {
   3.792680449544684*^9, 3.792680451524482*^9}, {3.7926804841166277`*^9, 
   3.792680495331767*^9}, {3.79268060280509*^9, 3.792680610436306*^9}, {
   3.792680651754994*^9, 3.792680665367038*^9}, {3.792680702121255*^9, 
   3.792680717599852*^9}, {3.7926812335934258`*^9, 3.792681254809647*^9}, {
   3.7926813804348993`*^9, 3.792681392402484*^9}, {3.79268152901794*^9, 
   3.792681586764319*^9}, {3.79268162559477*^9, 3.792681641424152*^9}, {
   3.792681718695569*^9, 3.792681974071904*^9}, {3.7926820275292463`*^9, 
   3.792682064184024*^9}, {3.792682095123644*^9, 3.792682106173609*^9}, {
   3.792682238588128*^9, 3.792682264500609*^9}, {3.792682303666005*^9, 
   3.7926824052734947`*^9}, {3.79268244441343*^9, 3.792682557694745*^9}, {
   3.79277473095945*^9, 3.792774791823353*^9}, {3.7927750883854017`*^9, 
   3.792775116108591*^9}, {3.7927758244070463`*^9, 3.79277583013439*^9}, {
   3.792775910549999*^9, 3.792775924257375*^9}, {3.792775964976169*^9, 
   3.792775965842175*^9}, {3.7927759999928493`*^9, 3.792776005199204*^9}, {
   3.7927780657215023`*^9, 3.792778074987549*^9}, {3.792778112468266*^9, 
   3.7927781365736647`*^9}, {3.792778174671022*^9, 3.7927781761350718`*^9}, {
   3.792779426599928*^9, 3.792779443161528*^9}, {3.7927795277601433`*^9, 
   3.792779553484632*^9}, {3.792779587862178*^9, 3.792779700434059*^9}, {
   3.7927807340317907`*^9, 3.79278080967045*^9}, {3.792780968597164*^9, 
   3.792781223371025*^9}, {3.792781266838188*^9, 3.7927812733368196`*^9}, {
   3.792781308771247*^9, 3.792781438900519*^9}, {3.792845035390809*^9, 
   3.792845036876025*^9}, {3.7932782707918386`*^9, 3.793278285986068*^9}, {
   3.793278318260592*^9, 3.793278427838171*^9}, {3.79337079202057*^9, 
   3.7933708357036257`*^9}},ExpressionUUID->"638ac9e5-e8ab-4a41-b8f1-\
08a474072ca3"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"H", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", "-", "p"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"A", "-", "p"}], ")"}]}], 
       RowBox[{"2", " ", "M"}]]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"p", "\[Rule]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"wave-function representation\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"H", "\[Rule]", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[",
                   "_", "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`\[Phi]],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{"A", "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[",
                   "_", "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`\[Phi]],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], ")"}]}], 
            RowBox[{"2", " ", "M"}]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Schrodinger eqn\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      RowBox[{"H", ".", "\[Psi]"}], "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"A", "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"A", "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}]}], 
        RowBox[{"2", " ", "M"}]], ".", "\[Psi]"}]}]},
    {
     RowBox[{
      RowBox[{"H", ".", "\[Psi]"}], "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["A", "2"], " ", "\[Psi]"}], 
        RowBox[{"2", " ", "M"}]], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "A", " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
           "\[Psi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Psi], $CellContext`\[Phi]],
          Editable->False,
          SyntaxForm->Automatic]}], "M"], "-", 
       FractionBox[
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
            "\[Psi]", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Psi], $CellContext`\[Phi]],
           Editable->False,
           SyntaxForm->Automatic], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Psi], $CellContext`\[Phi]], \
$CellContext`\[Phi]],
         Editable->False,
         SyntaxForm->Automatic], 
        RowBox[{"2", " ", "M"}]]}]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"\[Psi]", "\[Rule]", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"constraint\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", "H"}], 
      "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"A", "-", "m"}], ")"}], "2"]}], 
       RowBox[{"2", " ", "M"}]]}]},
    {
     RowBox[{"H", "\[Rule]", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"A", "-", "m"}], ")"}], "2"], 
       RowBox[{"2", " ", "M"}]]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox[
            StyleBox["\<\"E\"\>",
             StripOnInput->False,
             FontSlant->Italic], "m"], "\[Rule]", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"A", "-", "m"}], ")"}], "2"], 
            RowBox[{"2", " ", "M"}]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"eigenvalues\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.792678612098445*^9, 3.792678908731303*^9}, 
   3.792679034399434*^9, 3.79267907914561*^9, 3.792679117859549*^9, {
   3.792679178572047*^9, 3.7926791948526363`*^9}, {3.792679230603655*^9, 
   3.79267925257929*^9}, 3.792679443612548*^9, 3.792680031060803*^9, {
   3.792680282530601*^9, 3.7926803255713797`*^9}, 3.792680415503718*^9, 
   3.7926804522802477`*^9, {3.7926804873055067`*^9, 3.7926804962434883`*^9}, 
   3.792680612859869*^9, 3.792680666303316*^9, {3.7926812209387207`*^9, 
   3.7926812560446377`*^9}, 3.792681294192573*^9, 3.7926813308452053`*^9, {
   3.7926813728518257`*^9, 3.792681393312276*^9}, {3.792681508554336*^9, 
   3.792681588289776*^9}, {3.7926816331660023`*^9, 3.792681642262185*^9}, {
   3.792681710383875*^9, 3.7926817314381523`*^9}, {3.792681780732823*^9, 
   3.79268190070035*^9}, {3.792681957585935*^9, 3.792681975150288*^9}, {
   3.792682048765265*^9, 3.792682066861162*^9}, 3.792682107617632*^9, {
   3.792682249418907*^9, 3.792682265373616*^9}, {3.792682316648684*^9, 
   3.792682397171249*^9}, {3.7926824509849367`*^9, 3.792682460025659*^9}, {
   3.7926825037686462`*^9, 3.7926825585161333`*^9}, {3.792774734374942*^9, 
   3.792774740240891*^9}, {3.792774788045422*^9, 3.792774792974914*^9}, {
   3.792775091596541*^9, 3.792775117816214*^9}, 3.792775831981934*^9, 
   3.792775873976309*^9, 3.792775925298471*^9, 3.792776006480908*^9, 
   3.792776224912763*^9, 3.7927763654258003`*^9, {3.7927780561621113`*^9, 
   3.792778080490822*^9}, {3.7927781232534933`*^9, 3.792778137472651*^9}, 
   3.792778176832871*^9, {3.7927794317141*^9, 3.7927794450958014`*^9}, 
   3.7927795551540194`*^9, {3.7927795925126953`*^9, 3.7927796738095837`*^9}, 
   3.79278000576516*^9, 3.792780411726185*^9, 3.792780757664486*^9, 
   3.792780811121397*^9, {3.792781034958642*^9, 3.792781046971627*^9}, {
   3.792781087290017*^9, 3.792781161879081*^9}, {3.7927812105022306`*^9, 
   3.792781227624587*^9}, 3.792781274723878*^9, {3.792781328633453*^9, 
   3.792781369106762*^9}, {3.792781421260899*^9, 3.792781446149083*^9}, 
   3.792782272233037*^9, 3.792845037754464*^9, {3.79284821726381*^9, 
   3.7928482197639513`*^9}, 3.792848334261656*^9, 3.792848374111714*^9, 
   3.792850221571134*^9, {3.793191931510206*^9, 3.793191932940984*^9}, 
   3.793278274709715*^9, 3.7932783551824293`*^9, {3.793278390567924*^9, 
   3.7932783971598473`*^9}, 3.793278430891199*^9, 3.793302764561454*^9, 
   3.7933028833727713`*^9, 3.793370793561021*^9, 3.793370840640498*^9, 
   3.793371068143433*^9, 3.7935494916017513`*^9, 
   3.793665269166321*^9},ExpressionUUID->"772192f5-591f-4850-966a-\
a69cf412b035"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2.3 Quantum particle on a ring: path integral and Wick\[CloseCurlyQuote]s \
rotation\
\>", "Subsection",
 CellChangeTimes->{{3.7928447801374493`*^9, 
  3.792844806304893*^9}},ExpressionUUID->"55d85157-d3d1-4a02-a04d-\
23bc7a63194c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "13", "]"}], "=", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$z", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Z", "\[Rule]", 
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"S", "[", "\[Phi]", "]"}]}], "]"}], ",", "\[Phi]"}], 
              "]"}]}], "}"}], "[", 
           RowBox[{"CG", "[", "\"\<path integral\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$sl", "=", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], "//", 
            RowBox[{"tuRuleSelect", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"S", "[", "_", "]"}], ",", "L"}], "}"}], "]"}]}]}]}], 
         "}"}], "//", "Flatten"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[Theta]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "\[Phi]", "]"}], "[", 
            RowBox[{"CG", "[", "\"\<difference in path\>\"", "]"}], "]"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}]}], "]"}], "\[IndentingNewLine]", 
        "}"}], "[", 
       RowBox[{
       "CG", "[", "\"\<contribution to path integral by topological term\>\"",
         "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$w", "=", 
         RowBox[{"t", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Tau]"}]}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<Wick's rotation\>\"", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$s", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"$sl", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", "$w"}], "//", 
           RowBox[{"tuDerivativeExpand", "[", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"$sl", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"L", "[", "__", "]"}], "\[Rule]", "L"}]}], "/.", 
              "$s"}], "/.", "$w"}], "//", 
            RowBox[{"tuIntegralSimplify", "[", 
             RowBox[{"{", 
              RowBox[{"A", ",", "\[Phi]"}], "}"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"$", "/.", 
              RowBox[{
               RowBox[{"xIntegral", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
               RowBox[{"I", " ", 
                RowBox[{"xSum", "[", 
                 RowBox[{
                  RowBox[{"xIntegral", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "I"}], " ", "a"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", 
                    SubscriptBox["\[Beta]", "i"], ",", 
                    SubscriptBox["\[Beta]", 
                    RowBox[{"i", "+", "1"}]]}], "}"}]}], "]"}], ",", "i"}], 
                 "]"}]}]}]}], "//.", 
             RowBox[{"tuOpDistribute", "[", "xIntegral", "]"}]}], "/.", 
            RowBox[{
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"__", " ", 
                RowBox[{"tuDPartial", "[", 
                 RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}]}], ",", "_"}], 
              "]"}], "\[Rule]", "0"}]}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"tuRuleSelect", "[", "Z", "]"}], "[", "$z", "]"}], "//", 
           "First"}], "//", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "/.", "$"}], "/.", 
             RowBox[{
              RowBox[{"xIntegral", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{"xSum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", "\[Theta]", " ", "Q"}], "]"}], 
                 RowBox[{"xIntegral", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", "/.", 
                    RowBox[{
                    RowBox[{"xSum", "[", 
                    RowBox[{"aa_", ",", "_"}], "]"}], "\[Rule]", "aa"}]}], "/.", 
                    RowBox[{
                    SubscriptBox["\[Beta]", "i"], "\[Rule]", "0"}]}], "/.", 
                    RowBox[{
                    SubscriptBox["\[Beta]", 
                    RowBox[{"i", "+", "1"}]], "\[Rule]", "\[Beta]"}]}], "/.", 
                    
                    RowBox[{"\[Phi]", "\[Rule]", 
                    SubscriptBox["\[Phi]", "i"]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "i"], ",", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "i"], "[", "0", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "i"], "[", "0", "]"}], "+", 
                    RowBox[{"2", "\[Pi]", " ", "Q"}]}]}], "}"}]}], "]"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Q", ",", 
                  RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}],
                "]"}]}]}], "&"}], ")"}]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "}"}], "[", 
       RowBox[{
       "CG", "[", 
        "\"\<Wick rotated with periodic BC, \[Phi][0]\[Rule]\[Phi][\[Beta]]\>\
\"", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ColumnForms", "[", 
      RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", "$", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7928448688156767`*^9, 3.7928449395817013`*^9}, {
   3.792846016960906*^9, 3.79284601939047*^9}, {3.7928461116900597`*^9, 
   3.79284613363479*^9}, {3.792846491285181*^9, 3.7928467714725733`*^9}, {
   3.792846829277137*^9, 3.792846862101101*^9}, {3.7928468965752707`*^9, 
   3.7928469381832314`*^9}, {3.792846971660611*^9, 3.792847302050386*^9}, {
   3.792847403500516*^9, 3.7928474183554983`*^9}, {3.792847537033218*^9, 
   3.7928475405038*^9}, {3.792847585893881*^9, 3.792847600755414*^9}, {
   3.792858430213038*^9, 3.792858444509042*^9}, {3.792858476971834*^9, 
   3.792858480996944*^9}, {3.7928586272236223`*^9, 3.792858776163476*^9}, {
   3.792858847178898*^9, 3.792858898380032*^9}, {3.792858975085453*^9, 
   3.79285898820792*^9}, {3.792859039520266*^9, 3.792859219330141*^9}, {
   3.792859256807251*^9, 3.792859334945156*^9}, {3.792859411005618*^9, 
   3.7928594617882423`*^9}, {3.7928595713874683`*^9, 3.792859594975659*^9}, {
   3.792860114471314*^9, 3.79286013979982*^9}, {3.7928602523592577`*^9, 
   3.7928602627808123`*^9}, 3.792860298740962*^9, {3.792860520474607*^9, 
   3.79286064565497*^9}, {3.7928607379393597`*^9, 3.792860742279106*^9}, {
   3.7928608465498133`*^9, 3.792860888915585*^9}, {3.792861104222562*^9, 
   3.792861104998969*^9}, {3.792864182042304*^9, 
   3.792864186619698*^9}},ExpressionUUID->"0810582f-884c-415f-825d-\
cc1b941d0849"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Z", "\[Rule]", 
            TemplateBox[{SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"S", "[", "\[Phi]", "]"}]}]],"\[Phi]"},
             "InactiveIntegrate",
             DisplayFunction->(RowBox[{
                StyleBox["\[Integral]", "Inactive"], 
                RowBox[{#, 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
             InterpretationFunction->(RowBox[{
                RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                RowBox[{#, ",", #2}], "]"}]& )]}], "}"}], "[", 
          StyleBox["\<\"path integral\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}]},
        {
         RowBox[{
          RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
          TemplateBox[{RowBox[{"L", "[", 
              RowBox[{"\[Phi]", ",", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                   "\[Phi]", "]"}], 
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                 SyntaxForm -> Automatic, Editable -> False]}], "]"}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         RowBox[{"L", "\[Rule]", 
          RowBox[{
           RowBox[{"A", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", "M", " ", 
            SuperscriptBox[
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "2"]}]}]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Theta]", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "\[Phi]", "]"}], "[", 
              StyleBox["\<\"difference in path\"\>",
               StripOnInput->False,
               LineColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FrontFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               BackFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               GraphicsColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FontFamily->"Helvetica",
               FontColor->RGBColor[0, 
                 Rational[2, 3], 0]], "]"}]}], 
            RowBox[{"2", " ", "\[Pi]"}]]]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"contribution to path integral by topological term\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"t", "\[Rule]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Wick's rotation\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"L", "\[Rule]", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "A", " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
              Editable->False,
              SyntaxForm->Automatic]}], "-", 
            RowBox[{
             FractionBox["1", "2"], " ", "M", " ", 
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"]}]}]}]},
         {
          RowBox[{
           RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {"i"}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              TemplateBox[{RowBox[{
                  RowBox[{"-", "\[ImaginaryI]"}], " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False]}], "-", 
                    RowBox[{
                    FractionBox["1", "2"], " ", "M", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
                    ")"}]}],RowBox[{"(", 
                  RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}], ")"}],
                SubscriptBox["\[Beta]", "i"],SubscriptBox["\[Beta]", 
                 RowBox[{"1", "+", "i"}]]},
               "InactiveIntegrate",
               DisplayFunction->(RowBox[{
                  SubsuperscriptBox[
                   StyleBox["\[Integral]", "Inactive"], #3, #4], 
                  RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
               InterpretationFunction->(RowBox[{
                  RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                  RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
              "]"}],
             $CellContext`xSum[
              Inactive[Integrate][
              Complex[0, -1] (
                Complex[0, 1] $CellContext`A $CellContext`tuDDown[
                  "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
                Rational[-1, 2] $CellContext`M $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`\[Phi], \
$CellContext`\[Tau]]^2), {Complex[0, -1] $CellContext`\[Tau], 
                Subscript[$CellContext`\[Beta], $CellContext`i], 
                
                Subscript[$CellContext`\[Beta], 
                 1 + $CellContext`i]}], $CellContext`i],
             Editable->False,
             SyntaxForm->Automatic]}]}]},
         {
          RowBox[{"Z", "\[Rule]", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {
                  RowBox[{"{", 
                   RowBox[{"Q", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                   "}"}]}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}]], " ", 
              TemplateBox[{SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                   TemplateBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    SubscriptBox["\[Phi]", "i"], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]], SyntaxForm -> Automatic, Editable -> False]}], "-", 
                    RowBox[{
                    FractionBox["1", "2"], " ", "M", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    SubscriptBox["\[Phi]", "i"], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]], SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
                    ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}], ")"}], 
                    "0", "\[Beta]"}, "InactiveIntegrate", 
                    DisplayFunction -> (RowBox[{
                    SubsuperscriptBox[
                    StyleBox["\[Integral]", "Inactive"], #3, #4], 
                    RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ), 
                    InterpretationFunction -> (RowBox[{
                    RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                    RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]],
                SubscriptBox["\[Phi]", "i"],RowBox[{
                  SubscriptBox["\[Phi]", "i"], "[", "0", "]"}],RowBox[{
                  RowBox[{"2", " ", "\[Pi]", " ", "Q"}], "+", 
                  RowBox[{
                    SubscriptBox["\[Phi]", "i"], "[", "0", "]"}]}]},
               "InactiveIntegrate",
               DisplayFunction->(RowBox[{
                  SubsuperscriptBox[
                   StyleBox["\[Integral]", "Inactive"], #3, #4], 
                  RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
               InterpretationFunction->(RowBox[{
                  RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                  RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], 
             "]"}],
            $CellContext`xSum[
            E^(Complex[0, 1] $CellContext`Q $CellContext`\[Theta]) 
             Inactive[Integrate][
              E^(-Inactive[Integrate][
                 Complex[0, -1] (
                   Complex[0, 1] $CellContext`A $CellContext`tuDDown[
                    "\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]] + 
                   Rational[-1, 2] $CellContext`M $CellContext`tuDDown[
                    "\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]]^2), {
                  Complex[0, -1] $CellContext`\[Tau], 
                   0, $CellContext`\[Beta]}]), {
                Subscript[$CellContext`\[Phi], $CellContext`i], 
                Subscript[$CellContext`\[Phi], $CellContext`i][0], 
                2 Pi $CellContext`Q + 
                Subscript[$CellContext`\[Phi], $CellContext`i][
                 0]}], {$CellContext`Q, 
              DirectedInfinity[-1], 
              DirectedInfinity[1]}],
            Editable->False,
            SyntaxForm->Automatic]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Wick rotated with periodic BC, \[Phi][0]\[Rule]\[Phi][\
\[Beta]]\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.792844940445327*^9, 3.792846020214435*^9, 3.7928461351363153`*^9, 
   3.792846388962336*^9, 3.7928464933791103`*^9, 3.792846622394085*^9, {
   3.792846661044697*^9, 3.7928467087522087`*^9}, 3.792846772507401*^9, {
   3.792846857110037*^9, 3.792846862817367*^9}, 3.7928469015634747`*^9, 
   3.792846938917939*^9, 3.792846988448704*^9, {3.792847025273451*^9, 
   3.792847048125695*^9}, {3.792847129207212*^9, 3.792847245768235*^9}, {
   3.792847281106868*^9, 3.792847303111993*^9}, {3.792847404379027*^9, 
   3.792847419063765*^9}, 3.7928475411988297`*^9, 3.792847601629148*^9, 
   3.792847844038248*^9, {3.7928478967393837`*^9, 3.7928479117211943`*^9}, 
   3.792848220280035*^9, 3.792848334514862*^9, 3.7928483744600143`*^9, 
   3.7928502295034447`*^9, {3.792858425103994*^9, 3.792858445180253*^9}, 
   3.792858482879735*^9, {3.792858686869432*^9, 3.792858709865138*^9}, {
   3.792858778036427*^9, 3.7928587972009773`*^9}, {3.7928588498654957`*^9, 
   3.792858899447852*^9}, 3.7928589906540003`*^9, 3.792859056261087*^9, {
   3.792859101791834*^9, 3.792859111993132*^9}, 3.7928591571785107`*^9, 
   3.7928592218480377`*^9, {3.792859437003747*^9, 3.7928594711315823`*^9}, 
   3.792859596158847*^9, {3.7928601243142767`*^9, 3.7928601414824123`*^9}, 
   3.792860263918972*^9, {3.7928605607723007`*^9, 3.7928606468155518`*^9}, 
   3.792860743629675*^9, 3.792860890149952*^9, 3.792864187467679*^9, 
   3.793191933183263*^9, 3.793302764792659*^9, 3.7933710132745333`*^9, 
   3.793371068393177*^9, 3.793549491841618*^9, 
   3.793665269303602*^9},ExpressionUUID->"77bf399d-46cd-4fed-832e-\
f13d8688eb3d"]
}, Open  ]],

Cell["2.4 Quantum doublet", "Subsubsection",
 CellChangeTimes->{{3.792861433743373*^9, 
  3.792861448764206*^9}},ExpressionUUID->"a6a27bad-5ce2-449a-8885-\
76aa00e99293"],

Cell[CellGroupData[{

Cell["2.5 Full derivative term and topology", "Subsubsection",
 CellChangeTimes->{{3.7928615046316032`*^9, 3.792861513273095*^9}, {
  3.7929276039703703`*^9, 
  3.792927630580327*^9}},ExpressionUUID->"14573c17-dbf0-4e74-bdc1-\
4a1c595a0ffb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "20", "]"}], "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q", "\[Rule]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "\[Pi]"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Tau]", ",", "0", ",", "\[Beta]"}], "}"}]}], "]"}]}], 
        "}"}], "[", 
       RowBox[{"CG", "[", "\"\<winding number\>\"", "]"}], "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7929276350338163`*^9, 
  3.792927771846121*^9}},ExpressionUUID->"f405734f-e899-4ab8-ac08-\
e1294930b0ae"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q", "\[Rule]", 
        TemplateBox[{FractionBox[
           InterpretationBox[
            RowBox[{
              SubscriptBox[
               UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
              "\[Phi]", "]"}], 
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
            SyntaxForm -> Automatic, Editable -> False], 
           RowBox[{"2", " ", "\[Pi]"}]],"\[Tau]","0","\[Beta]"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            SubsuperscriptBox[
             StyleBox["\[Integral]", "Inactive"], #3, #4], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", 
              RowBox[{"{", 
                RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], "}"}], 
      "[", 
      StyleBox["\<\"winding number\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{3.792927701750692*^9, 3.792927896622038*^9, 
  3.793191933313759*^9, 3.793302764986146*^9, 3.793371025352992*^9, 
  3.793371068580842*^9, 3.7935494919721947`*^9, 
  3.793665269443774*^9},ExpressionUUID->"687b0b23-52bb-464f-8e24-\
bdb2f2b61dcb"]
}, Open  ]]
}, Open  ]],

Cell["2.6 Topological terms and quantum interference", "Subsubsection",
 CellChangeTimes->{{3.7928618805414343`*^9, 
  3.792861894044752*^9}},ExpressionUUID->"6405ae2e-a2cc-44b6-9bec-\
abfb98636916"],

Cell["2.7 General definition of topological terms", "Subsubsection",
 CellChangeTimes->{{3.792863378777732*^9, 
  3.7928633906822987`*^9}},ExpressionUUID->"ee2e0258-092b-498c-a6dd-\
0718c7fa6f0c"],

Cell["2.8 Theta terms and their effects on the quantum problem", \
"Subsubsection",
 CellChangeTimes->{{3.7928636772312737`*^9, 
  3.7928636930926456`*^9}},ExpressionUUID->"560b51ae-d720-40bb-acab-\
5bbe965a1398"],

Cell[CellGroupData[{

Cell["2.9 Exercises", "Subsubsection",
 CellChangeTimes->{{3.792863978514326*^9, 
  3.792863984250963*^9}},ExpressionUUID->"555164ed-fd16-48e9-ba05-\
bfa36d8d4b0c"],

Cell["Exercise 1: Particle on a ring, path integral", "Text",
 CellChangeTimes->{{3.79286399183819*^9, 
  3.7928640086073513`*^9}},ExpressionUUID->"2c522b4a-f377-4ad4-a323-\
1879c50064ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<Decompose partitian function \>\"", ",", 
    RowBox[{
     RowBox[{"$0", "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Z", "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"xIntegral", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", " ", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], "2"], "/", 
                    "2"}]}], "-", 
                   RowBox[{"I", " ", "\[Theta]", " ", 
                    RowBox[{
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Tau]", ",", "0", ",", "\[Beta]"}], "}"}]}], 
                 "]"}]}], "]"}], ",", "\[Phi]"}], "]"}]}], "}"}], "[", 
          RowBox[{
          "CG", "[", "\"\<Euclidean path integral particle on a ring.\>\"", 
           "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Phi]", "\[Rule]", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"\[Pi]", "/", "\[Beta]"}], " ", "Q", " ", "\[Tau]"}], 
             "+", 
             RowBox[{"xSum", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Phi]", "l"], 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", "2", 
                  RowBox[{"\[Pi]", "/", "\[Beta]"}], " ", "l", " ", 
                  "\[Tau]"}], "]"}]}], ",", "l"}], "]"}]}]}], "}"}], "[", 
          RowBox[{"CG", "[", "\"\<decomposition\>\"", "]"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "\"\<as sum over topological sectors.\>\"", 
    ",", "\[IndentingNewLine]", "line", ",", "NL", ",", "\"\<POFF\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$z", ",", "$s"}], "}"}], "=", 
       RowBox[{"$0", "//", 
        RowBox[{"tuRuleSelect", "[", 
         RowBox[{"{", 
          RowBox[{"Z", ",", "\[Phi]"}], "}"}], "]"}]}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{
     RowBox[{"$", "=", "$z"}], ";", "\[IndentingNewLine]", "Yield"}], ",", 
    RowBox[{"$tmp", "=", 
     RowBox[{"$", "=", 
      RowBox[{"$z", "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{"a", "/.", "$s"}], ",", "b"}], "]"}]}]}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"ii", ":", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"_", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "\[Beta]"}], "}"}]}], "]"}]}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tuIntegralSwitchVar", "[", 
            RowBox[{"t", "\[Rule]", 
             RowBox[{"\[Tau]", "/", "\[Beta]"}]}], "]"}], "[", "ii", "]"}], "//", 
          RowBox[{"tuDerivativeExpand", "[", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "Q", ",", 
             SubscriptBox["\[Phi]", "l"], ",", "l"}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "//", "Simplify"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//", 
        RowBox[{"tuDerivativeExpand", "[", 
         RowBox[{"{", 
          RowBox[{"l", ",", "Q", ",", "\[Beta]", ",", 
           SubscriptBox["\[Phi]", "l"]}], "}"}], "]"}]}], "//", 
       RowBox[{"tuOpSimplifyF", "[", 
        RowBox[{"xSum", ",", 
         RowBox[{"{", "\[Beta]", "}"}]}], "]"}]}], "//", 
      RowBox[{"tuOpDistributeF", "[", "xIntegral", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//.", 
        RowBox[{
         RowBox[{"ii", ":", 
          RowBox[{"xIntegral", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{"a", "//", 
            RowBox[{"tuOpSimplifyFirst", "[", 
             RowBox[{"xIntegral", ",", 
              RowBox[{"{", 
               RowBox[{"\[Beta]", ",", "m", ",", "\[Theta]", ",", "Q"}], 
               "}"}]}], "]"}]}], ",", "b"}], "]"}]}]}], "//", 
       RowBox[{"tuOpSwitch", "[", 
        RowBox[{"xIntegral", ",", "xSum"}], "]"}]}], "//", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"xIntegral", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "2"], ",", "x_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"xIntegral", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a", ",", "b"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xSum", "[", 
                 RowBox[{"a", ",", "b"}], "]"}], "/.", 
                RowBox[{"l", "\[Rule]", "l2"}]}], ")"}]}], ",", "x"}], 
            "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xSum", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"xSum", "[", 
               RowBox[{"a1_", ",", "b1_"}], "]"}], ")"}]}], ",", "x_"}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"xSum", "[", 
           RowBox[{
            RowBox[{"xSum", "[", 
             RowBox[{
              RowBox[{"xIntegral", "[", 
               RowBox[{
                RowBox[{"a", " ", "a1"}], ",", "x"}], "]"}], ",", "b"}], 
             "]"}], ",", "b1"}], "]"}]}]}], "&"}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", "Activate"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\"\<PON\>\"", ",", "\[IndentingNewLine]", "Yield",
     ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{"$", ",", 
        RowBox[{"l", "\[Element]", "Integers"}]}], "]"}], "//.", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{"0", ",", "_"}], "]"}], "\[Rule]", "0"}]}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<The term \>\"", ",", 
    RowBox[{"$1", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuExtractPositionPattern", "[", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{"_", ",", "_"}], "]"}], ",", "_"}], "]"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "\"\<is non-zero only when \>\"", ",", 
    RowBox[{"$s", "=", 
     RowBox[{"{", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"-", "l2"}]}], "}"}]}], ",", "\[IndentingNewLine]", "Yield", 
    ",", 
    RowBox[{"$1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$1", "/.", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"xSum", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ",", "c_"}], "]"}], ":>", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"tuOpIndependentVar", "[", 
            RowBox[{"Limit", ",", 
             RowBox[{"op$", "[", 
              RowBox[{"a", ",", 
               RowBox[{"l", "\[Rule]", 
                RowBox[{"-", "l2"}]}]}], "]"}]}], "]"}], ",", "b"}], 
          "]"}]}]}], "/.", 
       RowBox[{"l2", "\[Rule]", "l"}]}], "//", 
      RowBox[{"tuOpSimplifyFirst", "[", 
       RowBox[{"xSum", ",", 
        RowBox[{"{", "\[Beta]", "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Imply", ",", 
    RowBox[{"$", "=", 
     RowBox[{"tuReplacePart", "[", 
      RowBox[{"$", ",", "$1"}], "]"}]}], ",", "\[IndentingNewLine]", 
    "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{
       RowBox[{"Inactivate", "[", 
        RowBox[{"#", ",", "Integrate"}], "]"}], "&"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"pp", ":", 
         RowBox[{"Plus", "[", "a__", "]"}]}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"xExp", "[", "b", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "a"}], "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"$", "//", 
       RowBox[{"tuOpSimplifyFirst", "[", 
        RowBox[{"xIntegral", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "Q", ",", "\[Beta]"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{"$", "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"a", ",", 
          SubscriptBox["\[Phi]", "l"]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"tuOpIndependentVar", "[", 
        RowBox[{"tuIntegralSimplify", ",", 
         RowBox[{
          RowBox[{"op$", "[", 
           RowBox[{"{", 
            SubscriptBox["\[Phi]", "l"], "}"}], "]"}], "[", "$", "]"}]}], 
        "]"}], "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "->", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"a", ",", 
          SubscriptBox["\[Phi]", "l"]}], "]"}]}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"xExp", "[", 
        RowBox[{"a_", " ", 
         RowBox[{"xSum", "[", 
          RowBox[{"b_", ",", "l"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"xProduct", "[", 
        RowBox[{
         RowBox[{"xExp", "[", 
          RowBox[{"a", " ", "b"}], "]"}], ",", "l"}], "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuOpSwitch", "[", 
       RowBox[{"xIntegral", ",", "xProduct"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"xExp", "\[Rule]", "Exp"}]}]}], ",", "\[IndentingNewLine]", 
    "\"\<PON\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{
     RowBox[{"$pass1", "=", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "//", "Activate"}], "//", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "/.", 
           RowBox[{"Z", "\[Rule]", 
            RowBox[{"Z", "[", "Q", "]"}]}]}], "&"}], ")"}]}]}]}], ";", 
     RowBox[{"$", "//", "Framed"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<The total partitian function \>\"", ",", 
    RowBox[{"Z", "\[Rule]", 
     RowBox[{"xSum", "[", 
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "Q"}], "]"}]}], ",", 
    "\"\< where the \[CapitalTheta] terms can be written as Cos[Q \[Theta]]'s\
\>\""}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7928640232665033`*^9, 3.792864028082243*^9}, {
   3.792864125653325*^9, 3.792864140907484*^9}, {3.792864191619907*^9, 
   3.792864213223322*^9}, {3.792864272160284*^9, 3.792864301745659*^9}, {
   3.792864333483465*^9, 3.792864437065604*^9}, {3.792864472611266*^9, 
   3.7928645552721977`*^9}, {3.7928645883205214`*^9, 3.792864656517413*^9}, {
   3.792864716749851*^9, 3.792864811231398*^9}, {3.7928648504374743`*^9, 
   3.79286500053411*^9}, {3.79286506203895*^9, 3.7928651071864233`*^9}, {
   3.792865175865189*^9, 3.792865201052622*^9}, {3.792865235929641*^9, 
   3.7928653461093197`*^9}, {3.792865376836637*^9, 3.792865481523526*^9}, {
   3.792865780740796*^9, 3.792865795326586*^9}, {3.792865833238365*^9, 
   3.792865882273162*^9}, {3.7928659734070263`*^9, 3.792865975005217*^9}, {
   3.792866013059223*^9, 3.792866023030346*^9}, {3.792866066245249*^9, 
   3.792866069148395*^9}, {3.792866178367293*^9, 3.792866215096429*^9}, {
   3.792866329211049*^9, 3.7928663404399567`*^9}, {3.7928668862044067`*^9, 
   3.79286698499885*^9}, {3.7928670196563587`*^9, 3.7928670804673567`*^9}, {
   3.7928671952399607`*^9, 3.7928673147046137`*^9}, {3.792867349094222*^9, 
   3.792867383082217*^9}, {3.79286751426374*^9, 3.792867564929267*^9}, {
   3.792867601933879*^9, 3.792867700901638*^9}, {3.792867731111689*^9, 
   3.792867741643729*^9}, {3.792868517890462*^9, 3.792868576643779*^9}, {
   3.792868828574836*^9, 3.792868844525235*^9}, {3.792868888979097*^9, 
   3.792868921397954*^9}, {3.79286895829145*^9, 3.792868966817074*^9}, {
   3.792869958922901*^9, 3.792870257626792*^9}, {3.7928703180317183`*^9, 
   3.7928703554329033`*^9}, 3.792871813546701*^9, 3.792889768750106*^9, {
   3.792926304533503*^9, 3.79292630780123*^9}, {3.7929263413213873`*^9, 
   3.792926341524775*^9}, {3.792926507356316*^9, 3.792926508945733*^9}, {
   3.792927955608796*^9, 3.7929279901953278`*^9}, {3.7929280668453712`*^9, 
   3.7929280913090067`*^9}, {3.7929281535932283`*^9, 3.792928163904434*^9}, {
   3.792928217685351*^9, 3.7929282208779593`*^9}, {3.7929282656270857`*^9, 
   3.7929282756720448`*^9}, {3.7929283154976063`*^9, 3.792928335821348*^9}, {
   3.792928369983296*^9, 3.79292837049506*^9}, {3.792928414103796*^9, 
   3.792928421775229*^9}, 3.792928473461445*^9, {3.792930404821375*^9, 
   3.792930406268182*^9}, {3.7929333383054256`*^9, 3.792933362970615*^9}, {
   3.792933619480941*^9, 3.7929337103102703`*^9}, {3.7929337483569117`*^9, 
   3.792933765992167*^9}, {3.792933829737687*^9, 3.7929338458151913`*^9}, {
   3.792933895113923*^9, 3.792933933843547*^9}, {3.792933995504511*^9, 
   3.7929340452809134`*^9}, {3.792934083458892*^9, 3.792934104312694*^9}, {
   3.792934311084898*^9, 3.7929344296451607`*^9}, {3.792934545149047*^9, 
   3.792934546563513*^9}, {3.792936996941782*^9, 3.7929370254249973`*^9}, {
   3.792937056442855*^9, 3.792937085967534*^9}, {3.7929376763595333`*^9, 
   3.792937688841446*^9}},ExpressionUUID->"bb190453-d07f-4802-8732-\
909c1a7c07ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"Decompose partitian function \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Z", "\[Rule]", 
           TemplateBox[{SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
                TemplateBox[{
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"\[ImaginaryI]", " ", "\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                    RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", "m", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
                    ")"}], "\[Tau]", "0", "\[Beta]"}, "InactiveIntegrate", 
                 DisplayFunction -> (RowBox[{
                    SubsuperscriptBox[
                    StyleBox["\[Integral]", "Inactive"], #3, #4], 
                    RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ), 
                 InterpretationFunction -> (RowBox[{
                    RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                    RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]],
             "\[Phi]"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], "}"}], "[", 
         StyleBox["\<\"Euclidean path integral particle on a ring.\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]", "\[Rule]", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", "\[Pi]", " ", "Q", " ", "\[Tau]"}], "\[Beta]"],
             "+", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {"l"}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]", " ", 
                  "\[Tau]"}], "\[Beta]"]], " ", 
               SubscriptBox["\[Phi]", "l"]}], "]"}],
             $CellContext`xSum[
             E^(Complex[0, 2] $CellContext`l 
                Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau]) 
              Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
             
             Editable->False,
             SyntaxForm->Automatic]}]}], "}"}], "[", 
         StyleBox["\<\"decomposition\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"as sum over topological sectors.\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", "Z"}], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "m", " ", 
            SuperscriptBox["\[Pi]", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}], "+", 
         FractionBox[
          RowBox[{"2", " ", "m", " ", 
           SuperscriptBox["\[Pi]", "2"], " ", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {"l2"}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             InterpretationBox[
              RowBox[{
               UnderscriptBox[
                UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
                TagBox[GridBox[{
                   {"l"}
                  },
                  DefaultBaseStyle->"Column",
                  GridBoxAlignment->{"Columns" -> {{Left}}},
                  
                  GridBoxItemSize->{
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                 "Column"]], "[", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], ")"}],
                   " ", "l", " ", "l2", " ", 
                  SubscriptBox["\[Phi]", "l"], " ", 
                  SubscriptBox["\[Phi]", "l2"]}], 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], "]"}],
              $CellContext`xSum[Complex[0, 
                 Rational[-1, 2]] (-1 + 
                E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
                  Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
               Subscript[$CellContext`\[Phi], $CellContext`l2], \
$CellContext`l],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`xSum[
             $CellContext`xSum[Complex[0, 
                Rational[-1, 2]] (-1 + 
               E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
                 Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
              Subscript[$CellContext`\[Phi], $CellContext`l2], \
$CellContext`l], $CellContext`l2],
            Editable->False,
            SyntaxForm->Automatic]}], "\[Beta]"]}]], ",", "\[Phi]", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"l", "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}]}], "]"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"The term \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2", ",", "3", ",", "5"}], "}"}], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {"l2"}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {"l"}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], ")"}], 
              " ", "l", " ", "l2", " ", 
              SubscriptBox["\[Phi]", "l"], " ", 
              SubscriptBox["\[Phi]", "l2"]}], 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], "]"}],
          $CellContext`xSum[Complex[0, 
             Rational[-1, 2]] (-1 + 
            E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
              Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
           Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`xSum[
         $CellContext`xSum[Complex[0, 
            Rational[-1, 2]] (-1 + 
           E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
             Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
          Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l], \
$CellContext`l2],
        Editable->False,
        SyntaxForm->Automatic]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"is non-zero only when \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"-", "l2"}]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2", ",", "3", ",", "5"}], "}"}], 
       "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {"l"}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           SubsuperscriptBox["\[Phi]", "l", "2"]}], "]"}],
         $CellContext`xSum[$CellContext`l^2 
          Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l],
         Editable->False,
         SyntaxForm->Automatic]}]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[Implies] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", "Z"}], "\[Rule]", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "m", " ", 
            SuperscriptBox["\[Pi]", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}], "-", 
         FractionBox[
          RowBox[{"2", " ", "m", " ", 
           SuperscriptBox["\[Pi]", "2"], " ", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {"l"}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              SuperscriptBox["l", "2"], " ", 
              SubsuperscriptBox["\[Phi]", "l", "2"]}], "]"}],
            $CellContext`xSum[$CellContext`l^2 
             Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l],
            Editable->False,
            SyntaxForm->Automatic]}], "\[Beta]"]}]], ",", "\[Phi]", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"l", "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}]}], "]"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     FrameBox[
      RowBox[{
       RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox["\[Pi]", "2"], " ", 
             SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}]}]], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Product]\"\>", "_"], 
           TagBox[GridBox[{
              {"l"}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          FractionBox[
           RowBox[{
            SqrtBox["\[Beta]"], " ", 
            RowBox[{"Erf", "[", 
             FractionBox[
              RowBox[{
               SqrtBox["2"], " ", "l", " ", 
               SqrtBox["m"], " ", "\[Pi]", " ", 
               SubscriptBox["\[Phi]", "l"]}], 
              SqrtBox["\[Beta]"]], "]"}]}], 
           RowBox[{"2", " ", "l", " ", 
            SqrtBox["m"], " ", 
            SqrtBox[
             RowBox[{"2", " ", "\[Pi]"}]]}]], "]"}],
         $CellContext`xProduct[
         Rational[1, 2] $CellContext`l^(-1) $CellContext`m^
           Rational[-1, 2] (2 Pi)^Rational[-1, 2] $CellContext`\[Beta]^
           Rational[1, 2] 
          Erf[2^Rational[1, 2] $CellContext`l $CellContext`m^Rational[1, 2] 
            Pi $CellContext`\[Beta]^Rational[-1, 2] 
            Subscript[$CellContext`\[Phi], $CellContext`l]], $CellContext`l],
         Editable->False,
         SyntaxForm->Automatic]}]}],
      StripOnInput->False], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"The total partitian function \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"Z", "\[Rule]", 
      InterpretationBox[
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
         TagBox[GridBox[{
            {"Q"}
           },
           DefaultBaseStyle->"Column",
           GridBoxAlignment->{"Columns" -> {{Left}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Column"]], "[", 
        RowBox[{"Z", "[", "Q", "]"}], "]"}],
       $CellContext`xSum[
        $CellContext`Z[$CellContext`Q], $CellContext`Q],
       Editable->False,
       SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
     StyleBox["\<\" where the \[CapitalTheta] terms can be written as Cos[Q \
\[Theta]]'s\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1]}]}]}],
  SequenceForm[
   Style["Decompose partitian function ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      {$CellContext`Z -> 
       Inactive[Integrate][E^(-Inactive[Integrate][Complex[0, 
               Rational[-1, 2]] 
             Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
            Rational[
              1, 2] $CellContext`m $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2, \
{$CellContext`\[Tau], 0, $CellContext`\[Beta]}]), $CellContext`\[Phi]]}[
       Style["Euclidean path integral particle on a ring.", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      {$CellContext`\[Phi] -> 
       2 Pi $CellContext`Q $CellContext`\[Beta]^(-1) $CellContext`\[Tau] + \
$CellContext`xSum[
         E^(Complex[0, 2] $CellContext`l 
            Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau]) 
          Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l]}[
       Style["decomposition", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["as sum over topological sectors.", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`Z -> 
   Integrate[
    E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
      Complex[0, 1] $CellContext`Q $CellContext`\[Theta] + 
      2 $CellContext`m Pi^2 $CellContext`\[Beta]^(-1) $CellContext`xSum[
         $CellContext`xSum[Complex[0, 
            Rational[-1, 2]] (-1 + 
           E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
             Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
          Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l], \
$CellContext`l2]), $CellContext`\[Phi], Assumptions -> 
     Element[$CellContext`l, Integers]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The term ", 
    RGBColor[0.7, 0, 1, 1], Larger], {{2, 1, 2, 3, 5} -> $CellContext`xSum[
      $CellContext`xSum[Complex[0, 
         Rational[-1, 2]] (-1 + 
        E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
          Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
       Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l], \
$CellContext`l2]}, 
   Style["is non-zero only when ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`l -> -$CellContext`l2}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], {{2, 1, 2, 3, 
     5} -> -$CellContext`xSum[$CellContext`l^2 
       Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l]}, 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`Z -> 
   Integrate[
    E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
      Complex[0, 1] $CellContext`Q $CellContext`\[Theta] - 2 $CellContext`m 
      Pi^2 $CellContext`\[Beta]^(-1) $CellContext`xSum[$CellContext`l^2 
        Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l]), \
$CellContext`\[Phi], Assumptions -> Element[$CellContext`l, Integers]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[$CellContext`Z[$CellContext`Q] -> 
    E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
       Complex[0, 
          1] $CellContext`Q $CellContext`\[Theta]) $CellContext`xProduct[
      Rational[1, 2] $CellContext`l^(-1) $CellContext`m^
        Rational[-1, 2] (2 Pi)^Rational[-1, 2] $CellContext`\[Beta]^
        Rational[1, 2] 
       Erf[2^Rational[1, 2] $CellContext`l $CellContext`m^Rational[1, 2] 
         Pi $CellContext`\[Beta]^Rational[-1, 2] 
         Subscript[$CellContext`\[Phi], $CellContext`l]], $CellContext`l]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The total partitian function ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`Z -> $CellContext`xSum[
     $CellContext`Z[$CellContext`Q], $CellContext`Q], 
   Style[" where the \[CapitalTheta] terms can be written as Cos[Q \
\[Theta]]'s", 
    RGBColor[0.7, 0, 1, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.792928193805094*^9, 3.792928223137907*^9}, 
   3.792928278029574*^9, 3.792928338718009*^9, 3.7929283726538763`*^9, 
   3.7929284238300447`*^9, 3.792928475932323*^9, 3.792930409431443*^9, 
   3.792933365830852*^9, {3.79293366757924*^9, 3.792933712923583*^9}, 
   3.792933769221417*^9, 3.792933848327325*^9, 3.7929339371799297`*^9, {
   3.792934088007533*^9, 3.792934109786859*^9}, {3.792934426474389*^9, 
   3.792934432088828*^9}, 3.792934548871026*^9, 3.79293702929428*^9, {
   3.7929370668721523`*^9, 3.792937088217536*^9}, 3.7929376911844673`*^9, 
   3.793191940418468*^9, 3.793302769373171*^9, 3.793371073396695*^9, 
   3.793549498154154*^9, 
   3.7936652722931337`*^9},ExpressionUUID->"a01063eb-f588-42c1-acc1-\
a801502c1a80"]
}, Open  ]],

Cell["Exercise 2: Spin 1/2 from a particle on a ring", "Text",
 CellChangeTimes->{{3.792937577737143*^9, 3.7929375793279333`*^9}, {
  3.792937624231036*^9, 
  3.792937642833475*^9}},ExpressionUUID->"d098bf65-1821-4694-9914-\
5b7f48909d14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<For the case \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$pass1", "/.", 
       RowBox[{
        RowBox[{"xProduct", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"xProduct", "[", 
         RowBox[{
          RowBox[{"Limit", "[", 
           RowBox[{"a", ",", " ", 
            RowBox[{"$s", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "b"}], "]"}]}]}], "/.",
       "$s"}], "//", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Q", "\[Element]", "Integers"}]}], "]"}], "&"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "NL", ",", 
   "\"\<For the case \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", 
       RowBox[{"\[Pi]", "+", 
        RowBox[{"m", "/", "\[Beta]"}]}]}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$pass1", "/.", 
       RowBox[{
        RowBox[{"xProduct", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"xProduct", "[", 
         RowBox[{
          RowBox[{"Limit", "[", 
           RowBox[{"a", ",", " ", 
            RowBox[{"$s", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "b"}], "]"}]}]}], "/.",
       "$s"}], "//", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Q", "\[Element]", "Integers"}]}], "]"}], "&"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
   "CR", "[", "\"\<What is interpretation of (\[Theta]-\[Pi])/m?\>\"", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.79293764709965*^9, 3.792937650687895*^9}, {
   3.792937699738865*^9, 3.792938097520295*^9}, {3.7929382318587627`*^9, 
   3.792938240832377*^9}, {3.7929382909169493`*^9, 3.7929383455698433`*^9}, 
   3.7930186074974623`*^9, {3.793019397692451*^9, 3.793019488784079*^9}, {
   3.7930195301193113`*^9, 3.7930195838129263`*^9}, {3.793019697328292*^9, 
   3.793019707046554*^9}, 3.793019784382093*^9, {3.79301981539219*^9, 
   3.7930198481833057`*^9}, 
   3.793278230463563*^9},ExpressionUUID->"b1beca73-91e5-45ef-8abc-\
1deb8635bf8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"For the case \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "Q"], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Product]\"\>", "_"], 
        TagBox[GridBox[{
           {"l"}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       SubscriptBox["\[Phi]", "l"], "]"}],
      $CellContext`xProduct[
       Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"For the case \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"\[Pi]", "+", 
       FractionBox["m", "\[Beta]"]}]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "Q", " ", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", "+", 
         FractionBox["m", "\[Beta]"]}], ")"}]}]], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Product]\"\>", "_"], 
        TagBox[GridBox[{
           {"l"}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       SubscriptBox["\[Phi]", "l"], "]"}],
      $CellContext`xProduct[
       Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"What is interpretation of (\[Theta]-\[Pi])/m?\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["For the case ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`m -> 
    0, $CellContext`\[Theta] -> Pi}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 
     1]], $CellContext`Z[$CellContext`Q] -> (-1)^$CellContext`Q \
$CellContext`xProduct[
      Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["For the case ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`m -> 
    0, $CellContext`\[Theta] -> Pi + $CellContext`m/$CellContext`\[Beta]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`Z[$CellContext`Q] -> 
   E^(Complex[0, 1] $CellContext`Q (
       Pi + $CellContext`m/$CellContext`\[Beta])) $CellContext`xProduct[
      Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["What is interpretation of (\[Theta]-\[Pi])/m?", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.792937702423444*^9, 3.792937738685218*^9, {3.792937814287793*^9, 
   3.7929378465463867`*^9}, 3.792937883310569*^9, {3.792937945388172*^9, 
   3.79293797489361*^9}, 3.7929380208539886`*^9, {3.792938057097168*^9, 
   3.79293809823097*^9}, 3.792938241636298*^9, {3.792938298393759*^9, 
   3.792938346250799*^9}, 3.7930186085620413`*^9, {3.7930193909179773`*^9, 
   3.793019401675929*^9}, {3.793019436784053*^9, 3.793019489650012*^9}, {
   3.793019566400029*^9, 3.793019584796419*^9}, 3.7930197077483807`*^9, 
   3.793019849340671*^9, 3.793191941310626*^9, 3.793302770084847*^9, 
   3.793371036552951*^9, 3.793371074108951*^9, 3.793549498724903*^9, 
   3.793665272664385*^9},ExpressionUUID->"fa73d836-3041-402b-972c-\
1d38529fef4a"]
}, Open  ]],

Cell["Exercise 3: Metric independence of the topological term", "Text",
 CellChangeTimes->{{3.793020311910426*^9, 
  3.7930203321474857`*^9}},ExpressionUUID->"09a1e7d1-0130-4191-b007-\
6c162d63a6a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"$0", "=", 
           RowBox[{"S", "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"tuDPartial", "[", 
                   RowBox[{"\[Phi]", ",", 
                    SubscriptBox["t", "p"]}], "]"}], "2"], "/", "2"}]}], "-", 
               
               RowBox[{"\[Theta]", " ", 
                RowBox[{
                 RowBox[{"tuDPartial", "[", 
                  RowBox[{"\[Phi]", ",", 
                   SubscriptBox["t", "p"]}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], ",", 
              SubscriptBox["t", "p"]}], "]"}]}]}], ",", 
          RowBox[{
           SubscriptBox["t", "p"], "[", 
           RowBox[{"CG", "[", "\"\<proper time\>\"", "]"}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "[", 
        RowBox[{"CG", "[", "\"\<particle on a ring\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$s", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["t", "p"], "\[Rule]", 
            RowBox[{"f", "[", "t", "]"}]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", "\"\<dd\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "->", 
            SuperscriptBox[
             RowBox[{"tuDPartial", "[", 
              RowBox[{"f", ",", 
               SubscriptBox["t", "p"]}], "]"}], "2"]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", "\"\<uu\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "->", 
            SuperscriptBox[
             RowBox[{"tuDPartial", "[", 
              RowBox[{"f", ",", 
               SubscriptBox["t", "p"]}], "]"}], 
             RowBox[{"-", "2"}]]}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<reparametrization\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$tmp", "=", 
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{"$0", "/.", 
             RowBox[{
              RowBox[{"tuRuleSelect", "[", 
               SubscriptBox["t", "p"], "]"}], "[", "$s", "]"}]}], "/.", 
            RowBox[{"tuDChain", "[", "t", "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"$", "=", 
          RowBox[{
           RowBox[{"$", "/.", 
            RowBox[{
             RowBox[{"tuDPartial", "[", 
              RowBox[{"a_", ",", 
               RowBox[{"b", ":", 
                RowBox[{"f", "[", "t", "]"}]}]}], "]"}], "\[Rule]", 
             RowBox[{"1", "/", 
              RowBox[{"tuDPartial", "[", 
               RowBox[{"b", ",", "a"}], "]"}]}]}]}], "/.", 
           RowBox[{
            RowBox[{"xIntegral", "[", 
             RowBox[{"a_", ",", 
              RowBox[{"f", "[", "t", "]"}]}], "]"}], "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"det", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], "]"}]}], 
              ",", "t"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"$", "=", 
          RowBox[{
           RowBox[{"$", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"tuDPartial", "[", 
               RowBox[{
                RowBox[{"f", "[", "t", "]"}], ",", "t"}], "]"}], "\[Rule]", 
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"T", "[", 
                 RowBox[{"g", ",", "\"\<uu\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}]}], 
             "}"}]}], "//", "ExpandAll"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"CG", "[", 
          RowBox[{"\"\<In this 1-dim case we have: \>\"", ",", 
           RowBox[{"$s", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"det", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], "]"}], "->", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"T", "[", 
                 RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<uu\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}], 
               "\[Rule]", "1"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"$", "=", 
          RowBox[{"$", "//.", "$s"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "CG", "[", 
          "\"\<We can identify the energy-momentum tensor in the variation \>\
\"", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tuDDown", "[", "\[Delta]", "]"}], "[", 
              RowBox[{"#", ",", 
               RowBox[{"T", "[", 
                RowBox[{"g", ",", "\"\<uu\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}], "&"}], "/@",
             "$"}], "//", 
           RowBox[{"tuOpSwitch", "[", 
            RowBox[{
             RowBox[{"tuDDown", "[", "\[Delta]", "]"}], ",", "xIntegral"}], 
            "]"}]}], "//", 
          RowBox[{"tuDerivativeExpand", "[", 
           RowBox[{"{", 
            RowBox[{"m", ",", "\[Theta]", ",", 
             RowBox[{"T", "[", 
              RowBox[{"g", ",", "\"\<dd\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793020334846607*^9, 3.793020689098186*^9}, {
   3.793020750114662*^9, 3.793020894184762*^9}, {3.7930209260897427`*^9, 
   3.793020927323574*^9}, {3.793021241251843*^9, 3.79302124340096*^9}, {
   3.7930217335394506`*^9, 3.793021734612875*^9}, {3.7930220666610613`*^9, 
   3.793022067066424*^9}, {3.793022187470257*^9, 3.793022188146933*^9}, {
   3.79302233808463*^9, 3.793022477165594*^9}, {3.793022520755128*^9, 
   3.7930225244278593`*^9}, 3.79302256347036*^9, {3.793023165716672*^9, 
   3.793023205594109*^9}, {3.793023236372385*^9, 3.793023274415681*^9}, {
   3.793023342438849*^9, 3.793023369720028*^9}, {3.793023479136895*^9, 
   3.793023505926423*^9}, {3.793023573954471*^9, 3.793023594997451*^9}, 
   3.793023658829533*^9, 3.79302370973116*^9, {3.7930237430122757`*^9, 
   3.7930237437577887`*^9}, {3.793023777095771*^9, 3.793023779991288*^9}, {
   3.7930238433381777`*^9, 3.7930238506360273`*^9}, {3.79302400152182*^9, 
   3.793024098517309*^9}, {3.793024145246372*^9, 3.793024531228814*^9}, {
   3.793024591184293*^9, 3.7930247167257566`*^9}, {3.793024785894046*^9, 
   3.793024874035241*^9}, {3.793024905060166*^9, 3.793024905538859*^9}, {
   3.793024939595728*^9, 3.7930249652062693`*^9}, {3.793024999986949*^9, 
   3.7930250120549097`*^9}, {3.793197571367609*^9, 
   3.79319757496856*^9}},ExpressionUUID->"9a9bf8d8-3cbb-498a-bc24-\
7107bccb6953"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"S", "\[Rule]", 
           TemplateBox[{RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", 
                   FractionBox[
                    RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    SubscriptBox["t", "p"]], "[", "\[Phi]", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 
                    Subscript[$CellContext`t, $CellContext`p]], SyntaxForm -> 
                    Automatic, Editable -> False]}], 
                    RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                 RowBox[{
                   FractionBox["1", "2"], " ", "m", " ", 
                   SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    SubscriptBox["t", "p"]], "[", "\[Phi]", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 
                    Subscript[$CellContext`t, $CellContext`p]], SyntaxForm -> 
                    Automatic, Editable -> False], "2"]}]}], ")"}],
             SubscriptBox["t", "p"]},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]},
         {
          RowBox[{
           SubscriptBox["t", "p"], "[", 
           StyleBox["\<\"proper time\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"particle on a ring\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox["t", "p"], "\[Rule]", 
           RowBox[{"f", "[", "t", "]"}]}]},
         {
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["g", 
             RowBox[{"0", "0"}], 
             StyleBox[
              RowBox[{"0", "0"}],
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[Rule]", 
           SuperscriptBox[
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               SubscriptBox["t", "p"]], "[", "f", "]"}],
             $CellContext`tuDDown["\[PartialD]"][$CellContext`f, 
              Subscript[$CellContext`t, $CellContext`p]],
             Editable->False,
             SyntaxForm->Automatic], "2"]}]},
         {
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["g", 
             StyleBox[
              RowBox[{"0", "0"}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"0", "0"}]],
            $CellContext`Tensor[$CellContext`g, {0, 
             0}, {$CellContext`Void, $CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[Rule]", 
           FractionBox["1", 
            SuperscriptBox[
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                SubscriptBox["t", "p"]], "[", "f", "]"}],
              $CellContext`tuDDown["\[PartialD]"][$CellContext`f, 
               Subscript[$CellContext`t, $CellContext`p]],
              Editable->False,
              SyntaxForm->Automatic], "2"]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"reparametrization\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     TagBox[GridBox[{
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    RowBox[{"f", "[", "t", "]"}]], "[", "t", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`t, 
                    $CellContext`f[$CellContext`t]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                RowBox[{
                  FractionBox["1", "2"], " ", "m", " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    RowBox[{"f", "[", "t", "]"}]], "[", "t", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`t, 
                    $CellContext`f[$CellContext`t]], SyntaxForm -> Automatic, 
                    Editable -> False], "2"], " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
              ")"}],RowBox[{"f", "[", "t", "]"}]},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{
              SqrtBox[
               RowBox[{"det", "[", 
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   RowBox[{"0", "0"}], 
                   RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                  $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                  BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}]], 
              " ", 
              RowBox[{"(", 
                RowBox[{
                  FractionBox[
                   RowBox[{"m", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}], 
                   RowBox[{"2", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    RowBox[{"f", "[", "t", "]"}], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`f[$CellContext`t], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]], "-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    RowBox[{"f", "[", "t", "]"}], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`f[$CellContext`t], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}]]}], ")"}]}],
            "t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    SqrtBox[
                    RowBox[{"det", "[", 
                    InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{"0", "0"}], 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}]],
                     " ", 
                    SqrtBox[
                    InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"0", "0"}]], 
                    $CellContext`Tensor[$CellContext`g, {0, 
                    0}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                    False, BaseStyle -> {AutoMultiplicationSymbol -> False}]],
                     " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                RowBox[{
                  FractionBox["1", "2"], " ", "m", " ", 
                  SqrtBox[
                   RowBox[{"det", "[", 
                    InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{"0", "0"}], 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}]],
                   " ", 
                  InterpretationBox[
                   SubsuperscriptBox["g", 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"0", "0"}]], 
                   $CellContext`Tensor[$CellContext`g, {0, 
                    0}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                   False, BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
              ")"}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         StyleBox["\<\"In this 1-dim case we have: \"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]},
        {
         StyleBox[
          TagBox[GridBox[{
             {
              RowBox[{
               SqrtBox[
                RowBox[{"det", "[", 
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   RowBox[{"0", "0"}], 
                   StyleBox[
                    RowBox[{"0", "0"}],
                    StripOnInput->False,
                    ShowContents->False]],
                  $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], "]"}]], "\[Rule]", 
               SqrtBox[
                InterpretationBox[
                 SubsuperscriptBox["g", 
                  RowBox[{"0", "0"}], 
                  StyleBox[
                   RowBox[{"0", "0"}],
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]]}]},
             {
              RowBox[{
               RowBox[{
                SqrtBox[
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   StyleBox[
                    RowBox[{"0", "0"}],
                    StripOnInput->False,
                    ShowContents->False], 
                   RowBox[{"0", "0"}]],
                  $CellContext`Tensor[$CellContext`g, {0, 
                   0}, {$CellContext`Void, $CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]], " ", 
                SqrtBox[
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   RowBox[{"0", "0"}], 
                   StyleBox[
                    RowBox[{"0", "0"}],
                    StripOnInput->False,
                    ShowContents->False]],
                  $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]]}], "\[Rule]", "1"}]}
            },
            AutoDelete->False,
            FrameStyle->Directive[
              RGBColor[0.7, 0, 1, 1], 
              Thickness[Tiny]],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]},
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                RowBox[{
                  FractionBox["1", "2"], " ", "m", " ", 
                  InterpretationBox[
                   SubsuperscriptBox["g", 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"0", "0"}]], 
                   $CellContext`Tensor[$CellContext`g, {0, 
                    0}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                   False, BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  " ", 
                  SqrtBox[
                   InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{"0", "0"}], 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]], " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
              ")"}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         StyleBox["\<\"We can identify the energy-momentum tensor in the \
variation \"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]},
        {
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\[Delta]", "_"], 
             InterpretationBox[
              SubsuperscriptBox["g", 
               StyleBox[
                RowBox[{"0", "0"}],
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"0", "0"}]],
              $CellContext`Tensor[$CellContext`g, {0, 
               0}, {$CellContext`Void, $CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", "S", "]"}],
           $CellContext`tuDDown[$CellContext`\[Delta]][$CellContext`S, 
            $CellContext`Tensor[$CellContext`g, {0, 
             0}, {$CellContext`Void, $CellContext`Void}]],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          TemplateBox[{RowBox[{
              FractionBox["1", "2"], " ", "m", " ", 
              SqrtBox[
               InterpretationBox[
                SubsuperscriptBox["g", 
                 RowBox[{"0", "0"}], 
                 RowBox[{
                   StyleBox[
                   "0", ShowContents -> False, StripOnInput -> False], 
                   StyleBox["0", ShowContents -> False, StripOnInput -> False]
                   }]], 
                $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}]], " ", 
              SuperscriptBox[
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                  "\[Phi]", "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                SyntaxForm -> Automatic, Editable -> False], "2"]}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{
  3.7930204768279543`*^9, {3.793020645538526*^9, 3.7930206901271467`*^9}, {
   3.7930208021589527`*^9, 3.793020844944434*^9}, 3.793020896123951*^9, 
   3.793020928293833*^9, {3.793021231942747*^9, 3.793021244391327*^9}, 
   3.793021737047825*^9, 3.793022068550458*^9, 3.793022190743075*^9, {
   3.7930223750023127`*^9, 3.793022397414214*^9}, 3.793022478337124*^9, 
   3.793022526249387*^9, 3.7930225645556173`*^9, 3.793023167334567*^9, {
   3.793023249579021*^9, 3.7930232756068983`*^9}, {3.793023362421616*^9, 
   3.7930233706324673`*^9}, {3.79302348306811*^9, 3.793023507159237*^9}, 
   3.793023595944274*^9, 3.793023661101315*^9, 3.793023711318296*^9, 
   3.793023744584234*^9, 3.79302378087879*^9, 3.7930238519025507`*^9, 
   3.7930240084019547`*^9, {3.79302414733843*^9, 3.793024167784243*^9}, {
   3.79302435608057*^9, 3.793024388055666*^9}, 3.793024464843834*^9, {
   3.7930245021327553`*^9, 3.793024532025722*^9}, 3.793024645520864*^9, {
   3.79302469372139*^9, 3.793024718363462*^9}, 3.793024805444457*^9, {
   3.793024843326982*^9, 3.793024875095141*^9}, 3.79302491465654*^9, 
   3.793024966420864*^9, 3.793025013461136*^9, 3.793191941504231*^9, 
   3.793197575892209*^9, 3.793302770277215*^9, 3.7933710742896357`*^9, 
   3.7935494988607607`*^9, 
   3.793665272769411*^9},ExpressionUUID->"9d071b1a-1e03-4c0f-9147-\
36f5aaa1704b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Compute integrand of e[19]\>\"", ",", "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$d", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "1"], ",", 
           SubscriptBox["\[CapitalDelta]", "2"]}], "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$ds", "=", 
        RowBox[{
         RowBox[{"d", "/@", "$d"}], "//", 
         RowBox[{"tudExpandvI", "[", "d", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$ds2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"tuRuleOp", "[", "Dot", "]"}], "[", 
           RowBox[{"{", 
            RowBox[{"$ds", ",", "$ds"}], "}"}], "]"}], "//", "Simplify"}]}], 
        ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$ds2", "=", 
           RowBox[{"$ds2", "/.", 
            RowBox[{
             RowBox[{"d", "[", "a_", "]"}], "\[Rule]", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"a", ",", "\[Tau]"}], "]"}]}]}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<The first term\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{"Thread", "/@", 
          RowBox[{"{", 
           RowBox[{"$ds", ",", "$d"}], "}"}]}], "//", "Flatten"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tuEliminate", "[", 
            RowBox[{"$", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "]"}], "/.", 
           "toRule"}], "//", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "#"}], "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "&"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xDot", "[", 
              RowBox[{"$", ",", 
               RowBox[{"$d", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", "Thread"}], "//", 
            RowBox[{"tuOpDistributeF", "[", 
             RowBox[{"dotOps", ",", "Rule"}], "]"}]}], "//", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "/.", "toTimes"}], "&"}], ")"}]}], "//", 
          "tuRuleAdd"}], "//", "Simplify"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$d2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tuRuleOp", "[", "Dot", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"$d", ",", "$d"}], "}"}], "]"}], "//", "Simplify"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"$s2", "=", 
        RowBox[{"$", "/.", "$d2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$s", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"tuRule1", "[", "$ds2", "]"}], "]"}], ",", "$s2"}], "}"}],
          "//.", 
         RowBox[{
          RowBox[{"d", "[", "a_", "]"}], "\[Rule]", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"a", ",", "\[Tau]"}], "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"e", "[", "13", "]"}], "//", 
             RowBox[{"tuRuleSelect", "[", 
              RowBox[{"L", ",", 
               RowBox[{"{", "\[Tau]", "}"}]}], "]"}]}], "//", "First"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"$", "=", 
           RowBox[{"$", "/.", 
            RowBox[{"(", "$s", ")"}]}]}]}], "\[IndentingNewLine]", "}"}], "[", 
        RowBox[{"CG", "[", "\"\<from e[13]\>\"", "]"}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyU8oQwEAx/HHdjBqo+VPaxcXKbtNeVy0JmTJLLLVlBa1tGJLsrTkYBor
LxHaRSxlF6Zw2GVtNmX1KI1Xe1vNZdrWkqxm2LzfO/z61O/bblrQzdUSBCHj
Bjfopa+gOq8KfOQqMKG12sOcFevTFvRJSAq+jNccwzrhiBemzg238L5RFYAh
jToC1XHVA9QeEQysvutZ+Pod5fXpyTRUGPayMCm6KMCOa2UJNg+G/uDbKCO4
45x1rVvgI+N1wLZw1QlXbAMUpKYbDiF95vTAvtahJP+LpzIwpl/NwcjOWB5m
L2NlmGBLgginKXMlhqcnIilMpdfk8KcY7IW03W+E/vLnDDRLJs1wWFmwQDKm
s8GeG+ky37vdDugm45uQlfUXYf3uQQkaO/2/UPrsEkY5u1oUErjomWiCou15
OWQ1+7z/aCLhww==
  "],ExpressionUUID->"8fffeb94-a9a8-4179-b77f-c09c8d6f8802"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Compute integrand of e[19]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        TagBox[GridBox[{
           {
            SubscriptBox["\[CapitalDelta]", "1"]},
           {
            SubscriptBox["\[CapitalDelta]", "2"]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "\[Rule]", 
        TagBox[GridBox[{
           {
            RowBox[{"Cos", "[", "\[Phi]", "]"}]},
           {
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "1"], "]"}]},
           {
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "2"], "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "\[Rule]", 
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", "\[Phi]", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
           {
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"d", "[", "\[Phi]", "]"}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{
              SuperscriptBox[
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                 
                 SubscriptBox["\[CapitalDelta]", "1"], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 
                 Subscript[$CellContext`\[CapitalDelta], 
                  1], $CellContext`\[Tau]],
                Editable->False,
                SyntaxForm->Automatic], "2"], "+", 
              SuperscriptBox[
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                 
                 SubscriptBox["\[CapitalDelta]", "2"], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 
                 Subscript[$CellContext`\[CapitalDelta], 
                  2], $CellContext`\[Tau]],
                Editable->False,
                SyntaxForm->Automatic], "2"]}], "\[Rule]", 
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"The first term\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "1"], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", "\[Phi]", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
          {
           RowBox[{
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "2"], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"d", "[", "\[Phi]", "]"}]}]}]},
          {
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "1"], "\[Rule]", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]},
          {
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "2"], "\[Rule]", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
             SubscriptBox["\[CapitalDelta]", "1"]}], "\[Rule]", 
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "2"], "]"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
             SubscriptBox["\[CapitalDelta]", "2"]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"d", "[", 
              SubscriptBox["\[CapitalDelta]", "1"], "]"}]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]", "1", "2"], "+", 
           SubsuperscriptBox["\[CapitalDelta]", "2", "2"]}], ")"}]}], 
        "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "2"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "1"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[CapitalDelta]", "1", "2"], "+", 
         SubsuperscriptBox["\[CapitalDelta]", "2", "2"]}], "\[Rule]", "1"}]},
      {
       RowBox[{
        RowBox[{"d", "[", "\[Phi]", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "2"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "1"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"]}]}]}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            SuperscriptBox[
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
              Editable->False,
              SyntaxForm->Automatic], "2"], "\[Rule]", 
            RowBox[{
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "1"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 1], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"], "+", 
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "2"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 2], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"]}]}]},
          {
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
             Editable->False,
             SyntaxForm->Automatic], "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox["\[CapitalDelta]", "2"]}], " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "1"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 1], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic]}], "+", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "1"], " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "2"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 2], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic]}]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"L", "\[Rule]", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                 "\[Phi]", "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
                Editable->False,
                SyntaxForm->Automatic]}], "-", 
              RowBox[{
               FractionBox["1", "2"], " ", "M", " ", 
               SuperscriptBox[
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[",
                   "\[Phi]", "]"}],
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
                 Editable->False,
                 SyntaxForm->Automatic], "2"]}]}]}]},
           {
            RowBox[{"L", "\[Rule]", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SubscriptBox["\[CapitalDelta]", "2"]}], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "1"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    1], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic]}], "+", 
                 RowBox[{
                  SubscriptBox["\[CapitalDelta]", "1"], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "2"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    2], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}]}], "-", 
              RowBox[{
               FractionBox["1", "2"], " ", "M", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "1"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    1], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic], "2"], "+", 
                 SuperscriptBox[
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "2"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    2], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic], "2"]}], ")"}]}]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"from e[13]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Compute integrand of e[19]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{Grid[{{
          Subscript[$CellContext`\[CapitalDelta], 1]}, {
          Subscript[$CellContext`\[CapitalDelta], 2]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left] -> Grid[{{
          Cos[$CellContext`\[Phi]]}, {
          Sin[$CellContext`\[Phi]]}}, Dividers -> {{True}, {False}}, 
        FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left]}, {Grid[{{
          $CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 1]]}, {
          $CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 2]]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left] -> 
      Grid[{{-$CellContext`d[$CellContext`\[Phi]] Sin[$CellContext`\[Phi]]}, {
         Cos[$CellContext`\[Phi]] $CellContext`d[$CellContext`\[Phi]]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`tuDDown["\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              1], $CellContext`\[Tau]]^2 + $CellContext`tuDDown["\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              2], $CellContext`\[Tau]]^2 -> $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["The first term", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{$CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 
            1]] -> -$CellContext`d[$CellContext`\[Phi]] 
          Sin[$CellContext`\[Phi]]}, {$CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 2]] -> 
         Cos[$CellContext`\[Phi]] $CellContext`d[$CellContext`\[Phi]]}, {
        Subscript[$CellContext`\[CapitalDelta], 1] -> 
         Cos[$CellContext`\[Phi]]}, {
        Subscript[$CellContext`\[CapitalDelta], 2] -> 
         Sin[$CellContext`\[Phi]]}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`d[$CellContext`\[Phi]] 
          Subscript[$CellContext`\[CapitalDelta], 1] -> $CellContext`d[
           
           Subscript[$CellContext`\[CapitalDelta], 
            2]]}, {$CellContext`d[$CellContext`\[Phi]] 
          Subscript[$CellContext`\[CapitalDelta], 2] -> -$CellContext`d[
            Subscript[$CellContext`\[CapitalDelta], 1]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> 
       Left]}, {$CellContext`d[$CellContext`\[Phi]] (
        Subscript[$CellContext`\[CapitalDelta], 1]^2 + 
        Subscript[$CellContext`\[CapitalDelta], 2]^2) -> $CellContext`d[
          Subscript[$CellContext`\[CapitalDelta], 2]] 
        Subscript[$CellContext`\[CapitalDelta], 1] - $CellContext`d[
         Subscript[$CellContext`\[CapitalDelta], 1]] 
       Subscript[$CellContext`\[CapitalDelta], 2]}, {
     Subscript[$CellContext`\[CapitalDelta], 1]^2 + 
       Subscript[$CellContext`\[CapitalDelta], 2]^2 -> 
      1}, {$CellContext`d[$CellContext`\[Phi]] -> $CellContext`d[
          Subscript[$CellContext`\[CapitalDelta], 2]] 
        Subscript[$CellContext`\[CapitalDelta], 1] - $CellContext`d[
         Subscript[$CellContext`\[CapitalDelta], 1]] 
       Subscript[$CellContext`\[CapitalDelta], 2]}, {
      Grid[{{$CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2 -> \
$CellContext`tuDDown["\[PartialD]"][
             Subscript[$CellContext`\[CapitalDelta], 
              1], $CellContext`\[Tau]]^2 + $CellContext`tuDDown["\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              2], $CellContext`\[Tau]]^2}, {$CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] -> -
           Subscript[$CellContext`\[CapitalDelta], 2] $CellContext`tuDDown[
            "\[PartialD]"][
             Subscript[$CellContext`\[CapitalDelta], 1], $CellContext`\[Tau]] + 
          Subscript[$CellContext`\[CapitalDelta], 1] $CellContext`tuDDown[
            "\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              2], $CellContext`\[Tau]]}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`L -> 
         Complex[0, 1] $CellContext`A $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
          Rational[-1, 2] $CellContext`M $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2}, \
{$CellContext`L -> 
         Complex[0, 1] $CellContext`A (-
             Subscript[$CellContext`\[CapitalDelta], 2] $CellContext`tuDDown[
              "\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                1], $CellContext`\[Tau]] + 
            Subscript[$CellContext`\[CapitalDelta], 1] $CellContext`tuDDown[
              "\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                2], $CellContext`\[Tau]]) + 
          Rational[-1, 
             2] $CellContext`M ($CellContext`tuDDown["\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                1], $CellContext`\[Tau]]^2 + $CellContext`tuDDown[
              "\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                2], $CellContext`\[Tau]]^2)}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["from e[13]", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7936189364397097`*^9, {3.793624020233448*^9, 3.7936240596354637`*^9}, {
   3.793624093184499*^9, 3.793624132616972*^9}, {3.793624217352757*^9, 
   3.79362423490515*^9}, {3.793624286674488*^9, 3.793624321224597*^9}, 
   3.793624365688848*^9, 3.7936243974164333`*^9, {3.793624454776601*^9, 
   3.7936244728485327`*^9}, 3.793624507743206*^9, {3.7936245391499767`*^9, 
   3.793624619092905*^9}, 3.793624673694438*^9, {3.79362471686687*^9, 
   3.793624768788604*^9}, 3.793624808473662*^9, {3.793624854055263*^9, 
   3.7936249176101513`*^9}, 3.793624956642688*^9, 3.793624991881282*^9, 
   3.793625026557749*^9, {3.793625071730568*^9, 3.79362508640307*^9}, 
   3.793625119541843*^9, {3.793625966743469*^9, 3.7936259858699493`*^9}, {
   3.7936260238967133`*^9, 3.7936260948605633`*^9}, {3.793626182934091*^9, 
   3.7936262099771767`*^9}, 3.7936262429958363`*^9, 3.793626333332171*^9, {
   3.793626862544878*^9, 3.793626886956616*^9}, {3.793626925297018*^9, 
   3.79362693944121*^9}, {3.793627135307507*^9, 3.7936271684743023`*^9}, 
   3.793627254517474*^9, 3.793627289469594*^9, 3.793627365982933*^9, {
   3.793627439823988*^9, 3.793627446323493*^9}, {3.7936274799665337`*^9, 
   3.793627545314657*^9}, {3.793627579457203*^9, 3.7936275993040667`*^9}, {
   3.7936278913883533`*^9, 3.7936279127120028`*^9}, 3.7936279733928967`*^9, 
   3.793628012949686*^9, 3.7936280843879147`*^9, {3.7936281718489017`*^9, 
   3.793628224074814*^9}, {3.793629099381665*^9, 3.793629125779709*^9}, 
   3.793629165684299*^9, {3.793629201526821*^9, 3.7936292211156282`*^9}, 
   3.793629324985978*^9, {3.793629400182644*^9, 3.79362941360235*^9}, 
   3.793665272908946*^9},ExpressionUUID->"7f0a35d4-b7b9-4d7d-9cc8-\
2e45dff90160"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3 Path integral for a single spin", "Section",
 CellChangeTimes->{{3.793023979636764*^9, 
  3.793023989422287*^9}},ExpressionUUID->"ca95ee77-9fec-40e5-8a4d-\
00fc31d9f57e"],

Cell[CellGroupData[{

Cell["3.1 Quantum spin", "Subsubsection",
 CellChangeTimes->{{3.7930269826349697`*^9, 
  3.793026987714677*^9}},ExpressionUUID->"a9906281-b35d-4911-860b-\
b2d6d5783480"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$sS0", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"CommutatorM", "[", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"S", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "a_", "}"}]}], "]"}], ",", 
              RowBox[{"T", "[", 
               RowBox[{"S", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "b_", "}"}]}], "]"}]}], "]"}], "\[Rule]", 
            RowBox[{"I", " ", 
             RowBox[{"T", "[", 
              RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], 
             RowBox[{"T", "[", 
              RowBox[{"S", ",", "\"\<u\>\"", ",", 
               RowBox[{"{", "c", "}"}]}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"S", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "a_", "}"}]}], "]"}], 
               RowBox[{"T", "[", 
                RowBox[{"S", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "a_", "}"}]}], "]"}]}], "\[Rule]", 
              RowBox[{"S", 
               RowBox[{"(", 
                RowBox[{"S", "+", "1"}], ")"}]}]}], "}"}], "[", 
            RowBox[{"CG", "[", "\"\<require\>\"", "]"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "[", 
         RowBox[{"CG", "[", "\"\<SU[2] spin algebra\>\"", "]"}], "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$h", "=", 
          RowBox[{"H", "\[Rule]", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"h", ",", "\"\<u\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ".", 
             RowBox[{"T", "[", 
              RowBox[{"S", ",", "\"\<u\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}]}]}]}]}], "}"}], "[", 
        RowBox[{"CG", "[", "\"\<Hamiltonian in magnetic field\>\"", "]"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$h1", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$", "=", 
            RowBox[{
             RowBox[{"tuDPartial", "[", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"S", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "a", "}"}]}], "]"}], ",", "t"}], "]"}], 
             "\[Rule]", 
             RowBox[{"I", " ", 
              RowBox[{"CommutatorM", "[", 
               RowBox[{"H", ",", 
                RowBox[{"T", "[", 
                 RowBox[{"S", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "a", "}"}]}], "]"}]}], "]"}]}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"$", "/.", 
            RowBox[{"tuRule", "[", 
             RowBox[{"{", "$h", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
          "}"}], "[", 
         RowBox[{"CG", "[", "\"\<Hamilton's equation\>\"", "]"}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"$sTv", "=", 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", "_", ",", "_"}], "]"}], "->", 
          OverscriptBox["a", "\[RightVector]"]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$sS", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$", "=", 
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"S", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "a", "}"}]}], "]"}], "\[Rule]", 
                RowBox[{"S", " ", 
                 RowBox[{"T", "[", 
                  RowBox[{"n", ",", "\"\<u\>\"", ",", 
                   RowBox[{"{", "a", "}"}]}], "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"$", "/.", "$sTv"}]}], "\[IndentingNewLine]", "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<u\>\"", ",", 
               RowBox[{"{", "a", "}"}]}], "]"}], 
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "a", "}"}]}], "]"}]}], "\[Rule]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"$n", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                   RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                OverscriptBox["h", "\[RightVector]"], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "h"}], "}"}]}]}], 
              "\[IndentingNewLine]", "}"}], "[", 
             RowBox[{"CG", "[", "\"\<let\>\"", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"$sH", "=", 
            RowBox[{
             RowBox[{"$h", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"a_", ",", "_", ",", "_"}], "]"}], "->", 
                OverscriptBox["a", "\[RightVector]"]}], "}"}]}], "//.", 
             RowBox[{"tuRule", "[", 
              RowBox[{"{", 
               RowBox[{"$sS", ",", "$n"}], "}"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$sL", "=", 
               RowBox[{"L", "\[Rule]", 
                RowBox[{
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"f", ",", "t"}], "]"}], 
                    SubscriptBox["p", "f"]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"f", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Phi]", ",", "\[Theta]"}], "}"}]}], "}"}]}], 
                  "]"}], "-", "H"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"$", "=", 
               RowBox[{"$", "/.", "$sH"}]}]}], "\[IndentingNewLine]", "}"}], 
            "[", 
            RowBox[{"CG", "[", "\"\<\[Placeholder]\>\"", "]"}], "]"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "[", 
         RowBox[{"CG", "[", "\"\<classical limit\>\"", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "5"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793026989932044*^9, 3.793027172442204*^9}, {
   3.7930272091771307`*^9, 3.793027447479591*^9}, {3.793027556151428*^9, 
   3.7930275894021063`*^9}, {3.7930277023050537`*^9, 3.793027706131589*^9}, {
   3.793027747883107*^9, 3.793027812931404*^9}, {3.793028139422806*^9, 
   3.793028322546019*^9}, {3.7930283727496977`*^9, 3.793028374283246*^9}, {
   3.793028417958426*^9, 3.793028464896893*^9}, {3.793028868071404*^9, 
   3.793028869636478*^9}, {3.793028910039669*^9, 3.7930290741269417`*^9}, {
   3.7930350638865957`*^9, 3.7930350641315823`*^9}, {3.793035421388976*^9, 
   3.793035575671844*^9}, {3.793035684413962*^9, 3.79303569063307*^9}, 
   3.7930359371915894`*^9, {3.793036037731545*^9, 3.793036055614702*^9}, {
   3.7930388344669333`*^9, 3.793038837974267*^9}, 3.793039056542193*^9, {
   3.793040496579846*^9, 3.793040502724472*^9}, 3.793041370363179*^9, {
   3.79319413959693*^9, 3.7931941425272913`*^9}, {3.793194198232028*^9, 
   3.793194198730875*^9}, {3.793198091970358*^9, 
   3.793198098319561*^9}},ExpressionUUID->"c4ece8f8-00ae-4fd3-a9f1-\
5d1d5953ebf7"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           InterpretationBox[
            SubscriptBox[
             RowBox[{"[", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["a_",
                 StripOnInput->False,
                 ShowContents->False], "a_"],
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`a, 
                  Blank[]]}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ",", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["b_",
                 StripOnInput->False,
                 ShowContents->False], "b_"],
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`b, 
                  Blank[]]}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}], "-"],
            $CellContext`CommutatorM[
             $CellContext`Tensor[$CellContext`S, {
               Pattern[$CellContext`a, 
                Blank[]]}, {$CellContext`Void}], 
             $CellContext`Tensor[$CellContext`S, {
               Pattern[$CellContext`b, 
                Blank[]]}, {$CellContext`Void}]],
            Editable->False,
            SyntaxForm->Automatic], "\[Rule]", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             SubsuperscriptBox["S", 
              StyleBox["c",
               StripOnInput->False,
               ShowContents->False], "c"],
             $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], " ", 
            InterpretationBox[
             SubsuperscriptBox["\[Epsilon]", 
              StyleBox[
               RowBox[{"a", "b", "c"}],
               StripOnInput->False,
               ShowContents->False], 
              RowBox[{"a", "b", "c"}]],
             $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`b, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}]}]},
         {
          RowBox[{
           TagBox[GridBox[{
              {
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  InterpretationBox[
                   SubsuperscriptBox["S", 
                    StyleBox["a_",
                    StripOnInput->False,
                    ShowContents->False], "a_"],
                   $CellContext`Tensor[$CellContext`S, {
                    Pattern[$CellContext`a, 
                    Blank[]]}, {$CellContext`Void}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], ")"}], "2"], "\[Rule]", 
                RowBox[{"S", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "S"}], ")"}]}]}]}
             },
             AutoDelete->False,
             FrameStyle->Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]],
             GridBoxAlignment->{"Columns" -> {{Left}}},
             GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"], "[", 
           StyleBox["\<\"require\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"SU[2] spin algebra\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"H", "\[Rule]", 
           RowBox[{"-", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["h", 
               StyleBox["i",
                StripOnInput->False,
                ShowContents->False], "i"],
              $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ".", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["i",
                StripOnInput->False,
                ShowContents->False], "i"],
              $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}]}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Hamiltonian in magnetic field\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["a",
                StripOnInput->False,
                ShowContents->False], "a"],
              $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "\[Rule]", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             SubscriptBox[
              RowBox[{"[", "H", ",", 
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["a",
                  StripOnInput->False,
                  ShowContents->False], "a"],
                $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}], "-"],
             $CellContext`CommutatorM[$CellContext`H, 
              $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}]],
             Editable->False,
             SyntaxForm->Automatic]}]}]},
         {
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["a",
                StripOnInput->False,
                ShowContents->False], "a"],
              $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "\[Rule]", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             SubscriptBox[
              RowBox[{"[", 
               RowBox[{"-", 
                RowBox[{
                 InterpretationBox[
                  SubsuperscriptBox["h", 
                   StyleBox["i",
                    StripOnInput->False,
                    ShowContents->False], "i"],
                  $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], ".", 
                 InterpretationBox[
                  SubsuperscriptBox["S", 
                   StyleBox["i",
                    StripOnInput->False,
                    ShowContents->False], "i"],
                  $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]}]}], ",", 
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["a",
                  StripOnInput->False,
                  ShowContents->False], "a"],
                $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}], "-"],
             $CellContext`CommutatorM[-Dot[
                $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
                $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]], 
              $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}]],
             Editable->False,
             SyntaxForm->Automatic]}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Hamilton's equation\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          TagBox[GridBox[{
             {
              RowBox[{
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["a",
                  StripOnInput->False,
                  ShowContents->False], "a"],
                $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "\[Rule]", 
               RowBox[{"S", " ", 
                InterpretationBox[
                 SubsuperscriptBox["n", 
                  StyleBox["a",
                   StripOnInput->False,
                   ShowContents->False], "a"],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]}]}]},
             {
              RowBox[{
               OverscriptBox["S", "\[RightVector]"], "\[Rule]", 
               RowBox[{"S", " ", 
                OverscriptBox["n", "\[RightVector]"]}]}]}
            },
            AutoDelete->False,
            FrameStyle->Directive[
              RGBColor[0.7, 0, 1, 1], 
              Thickness[Tiny]],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"]},
         {
          RowBox[{
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", 
              StyleBox["a",
               StripOnInput->False,
               ShowContents->False], "a"],
             $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], " ", 
            InterpretationBox[
             SubsuperscriptBox["n", "a", 
              StyleBox["a",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`a}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], "\[Rule]", "1"}]},
         {
          RowBox[{
           TagBox[GridBox[{
              {
               RowBox[{
                OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]},
              {
               RowBox[{
                OverscriptBox["h", "\[RightVector]"], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "h"}], "}"}]}]}
             },
             AutoDelete->False,
             FrameStyle->Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]],
             GridBoxAlignment->{"Columns" -> {{Left}}},
             GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"], "[", 
           StyleBox["\<\"let\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]},
         {
          RowBox[{"H", "\[Rule]", 
           RowBox[{
            RowBox[{"-", "h"}], " ", "S", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]},
         {
          RowBox[{
           TagBox[GridBox[{
              {
               RowBox[{"L", "\[Rule]", 
                RowBox[{
                 RowBox[{"-", "H"}], "+", 
                 RowBox[{
                  SubscriptBox["p", "\[Theta]"], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "\[Theta]", "]"}],
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
                   Editable->False,
                   SyntaxForm->Automatic]}], "+", 
                 RowBox[{
                  SubscriptBox["p", "\[Phi]"], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "\[Phi]", "]"}],
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
                   Editable->False,
                   SyntaxForm->Automatic]}]}]}]},
              {
               RowBox[{
                InterpretationBox[
                 SubsuperscriptBox["S", 
                  StyleBox["a",
                   StripOnInput->False,
                   ShowContents->False], "a"],
                 $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "\[Rule]", 
                RowBox[{"S", " ", 
                 InterpretationBox[
                  SubsuperscriptBox["n", 
                   StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False], "a"],
                  $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]}]}]}
             },
             AutoDelete->False,
             FrameStyle->Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]],
             GridBoxAlignment->{"Columns" -> {{Left}}},
             GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"], "[", 
           StyleBox["\<\"\[Placeholder]\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"classical limit\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{
  3.793027091881709*^9, {3.793027167696081*^9, 3.793027173273397*^9}, {
   3.793027252651641*^9, 3.7930272576854973`*^9}, 3.793027346840885*^9, 
   3.793027409271102*^9, 3.79302744836684*^9, {3.7930275616023893`*^9, 
   3.7930275903918552`*^9}, 3.793027707088191*^9, 3.7930278148710423`*^9, 
   3.793028235697625*^9, {3.7930283006794977`*^9, 3.79302832326226*^9}, 
   3.793028375586564*^9, 3.793028468561103*^9, {3.793029004885507*^9, 
   3.793029075021152*^9}, {3.793035517810781*^9, 3.7930355413583717`*^9}, 
   3.793035577530064*^9, 3.7930356922695427`*^9, 3.7930359389324408`*^9, {
   3.793036039596361*^9, 3.793036056554*^9}, 3.793039057710194*^9, 
   3.793040509487817*^9, 3.793041372110592*^9, 3.79319194177177*^9, 
   3.7931941436432743`*^9, 3.793194200250592*^9, 3.793198099419694*^9, 
   3.793302770596874*^9, 3.793371074480794*^9, 3.793549498996983*^9, 
   3.793665273031234*^9},ExpressionUUID->"f56015be-24e3-482d-aebb-\
b9c186bdb930"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
   "\"\<The equation of motion for n: \>\"", ",", "\[IndentingNewLine]", "NL",
     ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$h1", "/.", 
        RowBox[{"S", "\[Rule]", "n"}]}], "//", "tuRule"}], "//", "Last"}]}], 
    ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "/.", 
        RowBox[{
         RowBox[{"dd", ":", 
          RowBox[{"dotOps", "[", "__", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"Sum", "[", 
          RowBox[{"dd", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], "/.", "toTimes"}], "//", 
      RowBox[{"tuCommutatorSimplify", "[", 
       RowBox[{"{", 
        RowBox[{"T", "[", 
         RowBox[{"h", ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "_", "}"}]}], "]"}], "}"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<From the commutation rules:\>\"", 
    ",", 
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"tuRule", "[", "$sS0", "]"}], "/.", 
       RowBox[{"S", "\[Rule]", "n"}]}], "//", "First"}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "//", "Simplify"}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<Using the assignments \>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$ni", "=", 
     RowBox[{
      RowBox[{"Thread", "/@", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tuRule", "[", "$n", "]"}], "/.", 
          RowBox[{
           OverscriptBox["n_", "\[RightVector]"], "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<u\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], ")"}], ")"}]}], "//",
       "tuRule"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$ni"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "3"}], "}"}]}], "]"}], "&"}]}]}], ";", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$", "/.", "$ni"}], "/.", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "a_", ",", "3"}], "}"}]}], "]"}], "\[Rule]", 
        "0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"$", "/.", 
          RowBox[{"a", "\[Rule]", "1"}]}], "/.", 
         RowBox[{
          RowBox[{"tt", ":", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"tuLeviCivitaOrder", "[", "tt", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}], "\[Rule]", 
         "1"}]}], "/.", "$ni"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"$", "/.", 
          RowBox[{"a", "\[Rule]", "2"}]}], "/.", 
         RowBox[{
          RowBox[{"tt", ":", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"tuLeviCivitaOrder", "[", "tt", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}], "\[Rule]", 
         "1"}]}], "/.", "$ni"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{"$1", ",", "$2"}], "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuDerivativeExpand", "[", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"$", "/.", 
         RowBox[{"\[Phi]", "\[Rule]", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "/.", 
        RowBox[{"\[Theta]", "\[Rule]", 
         RowBox[{"\[Theta]", "[", "t", "]"}]}]}], "//", 
       RowBox[{"tuTrigDerivativeExpand", "[", "]"}]}], "//", 
      RowBox[{"tuD2tuDOp", "[", 
       RowBox[{"tuDPartial", ",", 
        RowBox[{"{", "t", "}"}]}], "]"}]}]}], ",", "\"\<PON\>\"", ",", 
    "\[IndentingNewLine]", "Imply", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$sdT", "=", 
      RowBox[{"$s", "=", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{"$", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"tt", ":", 
              RowBox[{"\[Theta]", "|", "\[Phi]"}]}], ")"}], "[", "_", "]"}], 
           "\[Rule]", "tt"}]}], "//", 
         RowBox[{"tuRuleSolveF", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Theta]", ",", "t"}], "]"}], ",", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "}"}], "]"}]}]}]}]}], ";", 
     RowBox[{"$", "//", "Framed"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "NL", ",", "\"\<Then \>\"", ",", 
    RowBox[{"$s", "=", 
     RowBox[{"$sH", "/.", 
      RowBox[{"tuRuleSolve", "[", 
       RowBox[{"$s", ",", "h"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{"$sL1", "=", 
     RowBox[{"$sL", "/.", "$s"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Canonical momentum: \>\"", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      SubscriptBox["p", "\[Phi]"], "\[Rule]", 
      RowBox[{"tuDPartial", "[", 
       RowBox[{"L", ",", 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$sL1"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
    
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuDerivativeExpand", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         SubscriptBox["p", "_"], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "S"}], "}"}], "]"}]}]}], 
    ",", 
    RowBox[{"CR", "[", "\"\<?\>\"", "]"}], ",", "\[IndentingNewLine]", "NL", 
    ",", 
    RowBox[{"CR", "[", 
     RowBox[{"\"\<The text has \>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"$sp", "=", 
       RowBox[{
        SubscriptBox["p", "\[Phi]"], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "S"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", "1"}], ")"}]}]}]}], 
      ",", "\[IndentingNewLine]", 
      "\"\< which makes sense since the \[Phi]-momentum goes to 0 when h and \
S are parallel.\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.793038881506805*^9, 3.793038883635253*^9}, {
   3.793038923393532*^9, 3.7930389259708023`*^9}, {3.793038967303171*^9, 
   3.793038999093047*^9}, {3.793039039047679*^9, 3.7930390397910633`*^9}, {
   3.7930391308798*^9, 3.793039213635722*^9}, {3.793039909934147*^9, 
   3.793040049027012*^9}, {3.793040185978876*^9, 3.793040219029538*^9}, {
   3.7930402588385897`*^9, 3.793040295998598*^9}, {3.793040331922764*^9, 
   3.793040382202098*^9}, {3.793040451345029*^9, 3.793040474850829*^9}, {
   3.7930409717888613`*^9, 3.793041177813869*^9}, {3.7930412113252974`*^9, 
   3.793041337083878*^9}, {3.79304137700653*^9, 3.793041437687454*^9}, {
   3.7930414913318253`*^9, 3.7930414922181787`*^9}, {3.793041547855331*^9, 
   3.7930416343952227`*^9}, {3.793041692992392*^9, 3.793041829968203*^9}, {
   3.7931025928283453`*^9, 3.793102626933539*^9}, {3.7931066589356527`*^9, 
   3.7931067374340553`*^9}, {3.793106804780405*^9, 3.7931068189656267`*^9}, {
   3.793106865860045*^9, 3.7931069363565187`*^9}, {3.793107156601646*^9, 
   3.793107295508687*^9}, {3.793107328239477*^9, 3.79310737294405*^9}, 
   3.793107434495613*^9, 3.7931074880407133`*^9, {3.793107636467752*^9, 
   3.793107674335766*^9}, {3.7931370650911913`*^9, 3.7931371189031973`*^9}, {
   3.793137162289133*^9, 3.7931371898951187`*^9}, {3.7931510661598577`*^9, 
   3.793151281578938*^9}, {3.793153214772176*^9, 3.7931536139912786`*^9}, {
   3.7931938802694683`*^9, 3.793193881139694*^9}, {3.793194081378317*^9, 
   3.793194114926972*^9}, {3.793194148558715*^9, 3.793194462453665*^9}, {
   3.793194510796114*^9, 3.793194534609685*^9}, {3.7931973501703863`*^9, 
   3.7931973608632708`*^9}, 3.793198672050503*^9, {3.793200397491912*^9, 
   3.793200401789357*^9}, {3.793371186544889*^9, 3.793371187555563*^9}, {
   3.793371821395033*^9, 3.793371880331053*^9}, {3.7933719182003183`*^9, 
   3.793371996140501*^9}, {3.793372029301499*^9, 3.793372031471314*^9}, {
   3.7933729640589523`*^9, 
   3.7933729701619387`*^9}},ExpressionUUID->"72a50735-bf2a-4a6d-9e50-\
4b682ec2dcd0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The equation of motion for n: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["a",
         StripOnInput->False,
         ShowContents->False], "a"],
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubscriptBox[
       RowBox[{"[", 
        RowBox[{"-", 
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["h", 
            StyleBox["i",
             StripOnInput->False,
             ShowContents->False], "i"],
           $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ".", 
          InterpretationBox[
           SubsuperscriptBox["n", 
            StyleBox["i",
             StripOnInput->False,
             ShowContents->False], "i"],
           $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}]}], ",", 
        InterpretationBox[
         SubsuperscriptBox["n", 
          StyleBox["a",
           StripOnInput->False,
           ShowContents->False], "a"],
         $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}], "-"],
      $CellContext`CommutatorM[-Dot[
         $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}]], 
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["a",
         StripOnInput->False,
         ShowContents->False], "a"],
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          SubscriptBox[
           RowBox[{"[", 
            InterpretationBox[
             SubsuperscriptBox["n", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False], "1"],
             $CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ",", 
            InterpretationBox[
             SubsuperscriptBox["n", 
              StyleBox["a",
               StripOnInput->False,
               ShowContents->False], "a"],
             $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "]"}], "-"],
          $CellContext`CommutatorM[
           $CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]],
          Editable->False,
          SyntaxForm->Automatic]}], " ", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "-", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          RowBox[{"[", 
           InterpretationBox[
            SubsuperscriptBox["n", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False], "2"],
            $CellContext`Tensor[$CellContext`n, {2}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", 
           InterpretationBox[
            SubsuperscriptBox["n", 
             StyleBox["a",
              StripOnInput->False,
              ShowContents->False], "a"],
            $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}], "-"],
         $CellContext`CommutatorM[
          $CellContext`Tensor[$CellContext`n, {2}, {$CellContext`Void}], 
          $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "-", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          RowBox[{"[", 
           InterpretationBox[
            SubsuperscriptBox["n", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`n, {3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", 
           InterpretationBox[
            SubsuperscriptBox["n", 
             StyleBox["a",
              StripOnInput->False,
              ShowContents->False], "a"],
            $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}], "-"],
         $CellContext`CommutatorM[
          $CellContext`Tensor[$CellContext`n, {3}, {$CellContext`Void}], 
          $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}], ")"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"From the commutation rules:\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubscriptBox[
      RowBox[{"[", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["a_",
          StripOnInput->False,
          ShowContents->False], "a_"],
        $CellContext`Tensor[$CellContext`n, {
          Pattern[$CellContext`a, 
           Blank[]]}, {$CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], ",", 
       InterpretationBox[
        SubsuperscriptBox["n", 
         StyleBox["b_",
          StripOnInput->False,
          ShowContents->False], "b_"],
        $CellContext`Tensor[$CellContext`n, {
          Pattern[$CellContext`b, 
           Blank[]]}, {$CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "]"}], "-"],
     $CellContext`CommutatorM[
      $CellContext`Tensor[$CellContext`n, {
        Pattern[$CellContext`a, 
         Blank[]]}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`n, {
        Pattern[$CellContext`b, 
         Blank[]]}, {$CellContext`Void}]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubsuperscriptBox["n", 
       StyleBox["c",
        StripOnInput->False,
        ShowContents->False], "c"],
      $CellContext`Tensor[$CellContext`n, {$CellContext`c}, \
{$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"a", "b", "c"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"a", "b", "c"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`b, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["a",
         StripOnInput->False,
         ShowContents->False], "a"],
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["n", 
       StyleBox["c",
        StripOnInput->False,
        ShowContents->False], "c"],
      $CellContext`Tensor[$CellContext`n, {$CellContext`c}, \
{$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Epsilon]", 
          StyleBox[
           RowBox[{"1", "a", "c"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"1", "a", "c"}]],
         $CellContext`Tensor[$CellContext`\[Epsilon], {
          1, $CellContext`a, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Epsilon]", 
          StyleBox[
           RowBox[{"2", "a", "c"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"2", "a", "c"}]],
         $CellContext`Tensor[$CellContext`\[Epsilon], {
          2, $CellContext`a, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Epsilon]", 
          StyleBox[
           RowBox[{"3", "a", "c"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"3", "a", "c"}]],
         $CellContext`Tensor[$CellContext`\[Epsilon], {
          3, $CellContext`a, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}], ")"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Using the assignments \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       $CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       $CellContext`Tensor[$CellContext`n, {2}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       $CellContext`Tensor[$CellContext`n, {3}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "h"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["a",
         StripOnInput->False,
         ShowContents->False], "a"],
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"h", " ", 
     InterpretationBox[
      SubsuperscriptBox["n", 
       StyleBox["c",
        StripOnInput->False,
        ShowContents->False], "c"],
      $CellContext`Tensor[$CellContext`n, {$CellContext`c}, \
{$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"3", "a", "c"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"3", "a", "c"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {
       3, $CellContext`a, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
         Cos[$CellContext`\[Phi]] Sin[$CellContext`\[Theta]], $CellContext`t],
         
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "h"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
      {
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
         Sin[$CellContext`\[Theta]] Sin[$CellContext`\[Phi]], $CellContext`t],
         
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{"h", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", "0"}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", "h"}]}], "}"}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Then \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"H", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "S"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", "]"}],
      $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"L", "\[Rule]", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "\[Theta]"], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "+", 
     RowBox[{"S", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "+", 
     RowBox[{
      SubscriptBox["p", "\[Phi]"], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Canonical momentum: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "\[Phi]"], "\[Rule]", 
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]], "[", "L", "]"}],
     $CellContext`tuDDown["\[PartialD]"][$CellContext`L, 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "\[Phi]"], "\[Rule]", 
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "\[Theta]"], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], "+", 
       RowBox[{"S", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], "+", 
       RowBox[{
        SubscriptBox["p", "\[Phi]"], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}]}], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
     Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + \
$CellContext`S 
       Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
      Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "\[Phi]"], "\[Rule]", 
    RowBox[{
     RowBox[{"S", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
     SubscriptBox["p", "\[Phi]"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"?\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The text has \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     SubscriptBox["p", "\[Phi]"], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "S"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" which makes sense since the \[Phi]-momentum goes to 0 when \
h and S are parallel.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["The equation of motion for n: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`tuDDown["\[PartialD]"][
     $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t] -> 
   Complex[0, 1] $CellContext`CommutatorM[-Dot[
        $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}]], 
      $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`tuDDown["\[PartialD]"][
     $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t] -> 
   Complex[0, 1] (-$CellContext`CommutatorM[
        $CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]] $CellContext`Tensor[$CellContext`h, {
        1}, {$CellContext`Void}] - $CellContext`CommutatorM[
       $CellContext`Tensor[$CellContext`n, {2}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]] $CellContext`Tensor[$CellContext`h, {
       2}, {$CellContext`Void}] - $CellContext`CommutatorM[
       $CellContext`Tensor[$CellContext`n, {3}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}]] $CellContext`Tensor[$CellContext`h, {
       3}, {$CellContext`Void}]), 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["From the commutation rules:", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`CommutatorM[
     $CellContext`Tensor[$CellContext`n, {
       Pattern[$CellContext`a, 
        Blank[]]}, {$CellContext`Void}], 
     $CellContext`Tensor[$CellContext`n, {
       Pattern[$CellContext`b, 
        Blank[]]}, {$CellContext`Void}]] -> 
   Complex[0, 
      1] $CellContext`Tensor[$CellContext`n, {$CellContext`c}, \
{$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`a, $CellContext`b, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`tuDDown["\[PartialD]"][
     $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t] -> $CellContext`Tensor[$CellContext`n, \
{$CellContext`c}, {$CellContext`Void}] ($CellContext`Tensor[$CellContext`h, {
        1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{1, $CellContext`a, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}] + $CellContext`Tensor[$CellContext`h, {
        2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{2, $CellContext`a, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}] + $CellContext`Tensor[$CellContext`h, {
        3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{3, $CellContext`a, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}]), 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Using the assignments ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], {$CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}] -> 
    Cos[$CellContext`\[Phi]] 
     Sin[$CellContext`\[Theta]], $CellContext`Tensor[$CellContext`n, {
      2}, {$CellContext`Void}] -> 
    Sin[$CellContext`\[Theta]] 
     Sin[$CellContext`\[Phi]], $CellContext`Tensor[$CellContext`n, {
      3}, {$CellContext`Void}] -> 
    Cos[$CellContext`\[Theta]], $CellContext`Tensor[$CellContext`h, {
      1}, {$CellContext`Void}] -> 
    0, $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}] -> 
    0, $CellContext`Tensor[$CellContext`h, {
      3}, {$CellContext`Void}] -> $CellContext`h}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`tuDDown["\[PartialD]"][
     $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}], $CellContext`t] -> $CellContext`h \
$CellContext`Tensor[$CellContext`n, {$CellContext`c}, {$CellContext`Void}] \
$CellContext`Tensor[$CellContext`\[Epsilon], {
      3, $CellContext`a, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{$CellContext`tuDDown["\[PartialD]"][
       Cos[$CellContext`\[Phi]] 
        Sin[$CellContext`\[Theta]], $CellContext`t] -> -$CellContext`h 
       Sin[$CellContext`\[Theta]] 
       Sin[$CellContext`\[Phi]]}, {$CellContext`tuDDown["\[PartialD]"][
       Sin[$CellContext`\[Theta]] 
        Sin[$CellContext`\[Phi]], $CellContext`t] -> $CellContext`h 
       Cos[$CellContext`\[Phi]] Sin[$CellContext`\[Theta]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[{$CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] -> 
     0, $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] -> $CellContext`h}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Then ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`H -> -$CellContext`S 
    Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`L -> 
   Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + $CellContext`S 
     Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
    Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Canonical momentum: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`p, $CellContext`\[Phi]] -> $CellContext`tuDDown[
    "\[PartialD]"][$CellContext`L, 
     $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`p, $CellContext`\[Phi]] -> $CellContext`tuDDown[
    "\[PartialD]"][
    Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + $CellContext`S 
      Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
     Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
     $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`p, $CellContext`\[Phi]] -> $CellContext`S 
     Cos[$CellContext`\[Theta]] + 
    Subscript[$CellContext`p, $CellContext`\[Phi]], 
   Style["?", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The text has ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[Subscript[$CellContext`p, $CellContext`\[Phi]] -> -$CellContext`S \
(-1 + Cos[$CellContext`\[Theta]]), 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[" which makes sense since the \[Phi]-momentum goes to 0 when h and S \
are parallel.", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.793153238133757*^9, 3.793153262188943*^9}, {
   3.793153311259194*^9, 3.793153357211944*^9}, {3.793153392991209*^9, 
   3.793153430767518*^9}, 3.7931535005389223`*^9, {3.793153530862769*^9, 
   3.793153614898871*^9}, 3.793191941969021*^9, 3.793193882063422*^9, 
   3.7931941158129*^9, 3.793194150560186*^9, 3.793194181403202*^9, {
   3.793194215261969*^9, 3.793194227726082*^9}, 3.793194291959839*^9, {
   3.793194336540184*^9, 3.793194353582114*^9}, {3.793194384907564*^9, 
   3.793194401330777*^9}, {3.793194434053425*^9, 3.793194463261832*^9}, {
   3.793194516428122*^9, 3.793194535562891*^9}, {3.793197356313039*^9, 
   3.7931973616936703`*^9}, 3.793200402721714*^9, 3.793302771050103*^9, 
   3.793371074925479*^9, 3.793371188715522*^9, 3.793371881246224*^9, 
   3.793371996981988*^9, 3.7933720330347843`*^9, 3.793372971193502*^9, 
   3.79354949917498*^9, 
   3.793665273197319*^9},ExpressionUUID->"35d92b72-59c1-49e9-b62c-\
bffa8e6d66af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Spin action from \>\"", ",", 
   RowBox[{
   "URL", "[", 
    "\"\<https://iopscience.iop.org/book/978-1-64327-374-7/chapter/bk978-1-\
64327-374-7ch1\>\"", "]"}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Spin. Path integral form\>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"BraKet", "[", 
         RowBox[{
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", "t", "]"}], ",", 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", 
           SubscriptBox["t", "0"], "]"}]}], "]"}], "\[Rule]", 
        RowBox[{"Limit", "[", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{"xProduct", "[", 
             RowBox[{
              RowBox[{"BraKet", "[", 
               RowBox[{
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], "[", 
                 SubscriptBox["t", 
                  RowBox[{"i", "+", "1"}]], "]"}], ",", 
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], "[", 
                 SubscriptBox["t", "i"], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "iN"}], "}"}]}], "]"}], ",", 
            RowBox[{
             OverscriptBox["n", "\[RightVector]"], "[", 
             SubscriptBox["t", "i"], "]"}]}], "]"}], ",", 
          RowBox[{"iN", "\[Rule]", "\[Infinity]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$z", "=", 
          RowBox[{"z", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", "\[Phi]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "/", "2"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "/", "2"}], "]"}], "}"}]}], "}"}]}]}], 
         "}"}], "[", "\[IndentingNewLine]", 
        RowBox[{"CR", "[", "\"\<Sin,Cos switched from e[1.20]\>\"", "]"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$", "=", 
          RowBox[{
           RowBox[{"ct", "[", "z", "]"}], ".", "z"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"$", "/.", "$z"}], "//", 
              RowBox[{
               RowBox[{"Refine", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\[Phi]", ",", "\[Theta]"}], "}"}], "\[Element]", 
                  "Reals"}]}], "]"}], "&"}]}], "//", "Simplify"}], "//", 
            "Flatten"}], ")"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"$", "=", "$z"}], ";", "\[IndentingNewLine]", 
          RowBox[{"$s", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "/@", "$"}], "//", 
             RowBox[{"tudExpand", "[", "d", "]"}]}], "//", "Simplify"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"$", "=", 
             RowBox[{
              RowBox[{"ct", "[", "z", "]"}], ".", 
              RowBox[{"d", "[", "z", "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"$", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"$", "/.", "$s"}], "/.", "$z"}], "//", 
               RowBox[{
                RowBox[{"Refine", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Phi]", ",", "\[Theta]"}], "}"}], "\[Element]", 
                   "Reals"}]}], "]"}], "&"}]}], "//", "Simplify"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"$", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"$", "//", "TrigReduce"}], "//", 
                RowBox[{
                 RowBox[{"Collect", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"d", "[", "\[Phi]", "]"}]}], "]"}], "&"}]}], "//", 
               "Flatten"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"$", "[", 
              RowBox[{
              "CR", "[", 
               "\"\<Curiously we had to switch the definition of e[1.20] to \
get e[1.28]\>\"", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], "[", 
          RowBox[{"CG", "[", "\"\<Compute e[1.28]\>\"", "]"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQvW570LVFzm8c9zjYPwbR02b4vAPRHibZjIuBdOzb
RlYQbbHERxZE77Nl1gLRd7lEwLRB2RRzEF3UGhMAovPMJmgtBdLfAsSNQbSE
rZgFiPZ6ZAmmH2yojwHRLT6emSD61I6ZuSB6Wc+jEhB9wKG8DqyuTaUZRB9e
vf4KiDYT3XkVRBd6Zb4A0U/cN38G0R6ia36CaEvT83/A9jqlcS0D0gHbXnGD
6L6YnwIgmi2jQQZE7ypyVADRDWUBYLqkvHHzWiD9+LLBNhCtlbg7egOQbjrp
HgOiu57ENB0A0hm/lreCaK3tHqtB9AT2Q+tA9MxdejtA9JFvTTvB9ILMvSD6
i9o3MD1FtfU4iPZS5rsOolsUYx+D6NSj78D0RYUjb0D0g9LSdyAaADggzpc=

  "],ExpressionUUID->"7cc40990-9ecd-4763-a6e9-37824902e917"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Spin action from \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"URL", "[", 
    TemplateBox[{
     "\"https://iopscience.iop.org/book/978-1-64327-374-7/chapter/bk978-1-\
64327-374-7ch1\""},
     "URLArgument"], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Spin. Path integral form\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftAngleBracket]",
           FontWeight->Bold], 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", "t", "]"}], 
          StyleBox["|",
           FontWeight->Bold], 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", 
           SubscriptBox["t", "0"], "]"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         BraKet[
          OverVector[$CellContext`n][$CellContext`t], 
          OverVector[$CellContext`n][
           Subscript[$CellContext`t, 0]]],
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{
         UnderscriptBox["\[Limit]", 
          RowBox[{
           StyleBox["\<\"N\"\>",
            StripOnInput->False,
            FontSlant->Italic], "\[Rule]", "\[Infinity]"}]], 
         TemplateBox[{InterpretationBox[
            RowBox[{
              UnderscriptBox[
               UnderscriptBox["\"\[Product]\"", "_"], 
               TagBox[
                GridBox[{{
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    StyleBox["\"N\"", Italic, StripOnInput -> False]}], 
                    "}"}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                 DefaultBaseStyle -> "Column", 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                "Column"]], "[", 
              InterpretationBox[
               RowBox[{
                 StyleBox["\[LeftAngleBracket]", Bold], 
                 RowBox[{
                   OverscriptBox["n", "\[RightVector]"], "[", 
                   SubscriptBox["t", 
                    RowBox[{"1", "+", "i"}]], "]"}], 
                 StyleBox["|", Bold], 
                 RowBox[{
                   OverscriptBox["n", "\[RightVector]"], "[", 
                   SubscriptBox["t", "i"], "]"}], 
                 StyleBox["\[RightAngleBracket]", Bold]}], 
               BraKet[
                OverVector[$CellContext`n][
                 Subscript[$CellContext`t, 1 + $CellContext`i]], 
                OverVector[$CellContext`n][
                 Subscript[$CellContext`t, $CellContext`i]]], SyntaxForm -> 
               Automatic, Editable -> False], "]"}], 
            $CellContext`xProduct[
             BraKet[
              OverVector[$CellContext`n][
               Subscript[$CellContext`t, 1 + $CellContext`i]], 
              OverVector[$CellContext`n][
               Subscript[$CellContext`t, $CellContext`i]]], {$CellContext`i, 
              0, 
              Style["N", Italic]}], SyntaxForm -> Automatic, Editable -> 
            False],RowBox[{
             OverscriptBox["n", "\[RightVector]"], "[", 
             SubscriptBox["t", "i"], "]"}]},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"z", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                 RowBox[{"Sin", "[", 
                  FractionBox["\[Theta]", "2"], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Cos", "[", 
                 FractionBox["\[Theta]", "2"], "]"}], "}"}]}], "}"}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"Sin,Cos switched from e[1.20]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[1, 0, 0],
         FrontFaceColor->RGBColor[1, 0, 0],
         BackFaceColor->RGBColor[1, 0, 0],
         GraphicsColor->RGBColor[1, 0, 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[1, 0, 0]], "]"}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{
             InterpretationBox[
              SuperscriptBox["z", "\[Dagger]"],
              ConjugateTranspose[$CellContext`z],
              Editable->False,
              SyntaxForm->Automatic], ".", "z"}], "\[Rule]", 
            TagBox[GridBox[{
               {"1"}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"d", "[", "z", "]"}], "\[Rule]", 
            TagBox[GridBox[{
               {
                RowBox[{"{", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    FractionBox["\[Theta]", "2"], "]"}], " ", 
                    RowBox[{"d", "[", "\[Theta]", "]"}]}], "-", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    FractionBox["\[Theta]", "2"], "]"}]}]}], ")"}]}], "}"}]},
               {
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["1", "2"]}], " ", 
                  RowBox[{"d", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"Sin", "[", 
                   FractionBox["\[Theta]", "2"], "]"}]}], "}"}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"]}]},
          {
           RowBox[{
            TagBox[GridBox[{
               {
                RowBox[{
                 InterpretationBox[
                  SuperscriptBox["z", "\[Dagger]"],
                  ConjugateTranspose[$CellContext`z],
                  Editable->False,
                  SyntaxForm->Automatic], ".", 
                 RowBox[{"d", "[", "z", "]"}]}]},
               {
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", 
                   RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", 
                    FractionBox["\[Theta]", "2"], "]"}], "2"]}], "}"}], "}"}]},
               {
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}], " ", 
                   RowBox[{"d", "[", "\[Phi]", "]"}]}], "}"}], "[", 
                 
                 StyleBox["\<\"Curiously we had to switch the definition of \
e[1.20] to get e[1.28]\"\>",
                  StripOnInput->False,
                  LineColor->RGBColor[1, 0, 0],
                  FrontFaceColor->RGBColor[1, 0, 0],
                  BackFaceColor->RGBColor[1, 0, 0],
                  GraphicsColor->RGBColor[1, 0, 0],
                  FontFamily->"Helvetica",
                  FontColor->RGBColor[1, 0, 0]], "]"}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"], "[", 
            StyleBox["\<\"Compute e[1.28]\"\>",
             StripOnInput->False,
             LineColor->RGBColor[0, 
               Rational[2, 3], 0],
             FrontFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             BackFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             GraphicsColor->RGBColor[0, 
               Rational[2, 3], 0],
             FontFamily->"Helvetica",
             FontColor->RGBColor[0, 
               Rational[2, 3], 0]], "]"}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Spin action from ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   URL["https://iopscience.iop.org/book/978-1-64327-374-7/chapter/bk978-1-\
64327-374-7ch1"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Spin. Path integral form", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{BraKet[
        OverVector[$CellContext`n][$CellContext`t], 
        OverVector[$CellContext`n][
         Subscript[$CellContext`t, 0]]] -> Limit[
        Inactive[Integrate][
         $CellContext`xProduct[
          BraKet[
           OverVector[$CellContext`n][
            Subscript[$CellContext`t, 1 + $CellContext`i]], 
           OverVector[$CellContext`n][
            Subscript[$CellContext`t, $CellContext`i]]], {$CellContext`i, 0, 
           Style["N", Italic]}], 
         OverVector[$CellContext`n][
          Subscript[$CellContext`t, $CellContext`i]]], Style["N", Italic] -> 
        DirectedInfinity[1]]}, {
      Grid[{{$CellContext`z -> {{
           E^(Complex[0, -1] $CellContext`\[Phi]) 
            Sin[Rational[1, 2] $CellContext`\[Theta]]}, {
            Cos[Rational[1, 2] $CellContext`\[Theta]]}}}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["Sin,Cos switched from e[1.20]", 
        RGBColor[1, 0, 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{Dot[
           ConjugateTranspose[$CellContext`z], $CellContext`z] -> 
         Grid[{{1}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]], Alignment -> Left]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`d[$CellContext`z] -> 
         Grid[{{{Rational[1, 2] 
              E^(Complex[0, -1] $CellContext`\[Phi]) (
               Cos[Rational[
                   1, 2] $CellContext`\[Theta]] $CellContext`d[$CellContext`\
\[Theta]] + Complex[0, -2] $CellContext`d[$CellContext`\[Phi]] 
                Sin[Rational[1, 2] $CellContext`\[Theta]])}}, {{
             Rational[-1, 2] $CellContext`d[$CellContext`\[Theta]] 
              Sin[Rational[1, 2] $CellContext`\[Theta]]}}}, 
           Dividers -> {{True}, {False}}, FrameStyle -> Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]], Alignment -> Left]}, {
         Grid[{{
            Dot[
             ConjugateTranspose[$CellContext`z], 
             $CellContext`d[$CellContext`z]]}, {{{
             Complex[0, -1] $CellContext`d[$CellContext`\[Phi]] 
              Sin[Rational[1, 2] $CellContext`\[Theta]]^2}}}, {
            {Complex[0, 
               Rational[1, 2]] (-1 + 
              Cos[$CellContext`\[Theta]]) $CellContext`d[$CellContext`\[Phi]]}[
             Style[
             "Curiously we had to switch the definition of e[1.20] to get \
e[1.28]", 
              RGBColor[1, 0, 0], FontFamily -> "Helvetica"]]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["Compute e[1.28]", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7935576907152843`*^9, 3.7935577399693947`*^9}, {
   3.793557964995118*^9, 3.7935579893353167`*^9}, {3.793558047592709*^9, 
   3.793558148010065*^9}, {3.79356196618561*^9, 3.793562010753379*^9}, 
   3.7935620507749577`*^9, {3.7935623986117487`*^9, 3.7935624431056356`*^9}, {
   3.7935624831226997`*^9, 3.7935625366320066`*^9}, 3.793562620320806*^9, 
   3.793562651338695*^9, {3.793563521763571*^9, 3.7935635524816628`*^9}, {
   3.7935636016867933`*^9, 3.7935636233590097`*^9}, 3.793563744309536*^9, {
   3.793563802240584*^9, 3.793563876989853*^9}, 3.79356390741708*^9, {
   3.79357942233113*^9, 3.79357944276364*^9}, 3.7935848672399673`*^9, {
   3.793618268237339*^9, 3.7936182951629257`*^9}, 3.7936183706094112`*^9, 
   3.793618416726776*^9, {3.793618576978299*^9, 3.793618618037361*^9}, 
   3.793618809188877*^9, 
   3.793665273344886*^9},ExpressionUUID->"1dfb5f74-fa24-4e1d-b213-\
8dea501fdf74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<Equation (28): With \>\"", ",", 
    RowBox[{
     RowBox[{"$s", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$h", ",", "$sL", ",", 
          RowBox[{"$sdT", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "$sS"}], "}"}], "//", 
        "tuRule"}], "//", 
       RowBox[{"tuAddPatternVariable", "[", "a", "]"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
    ",", "\[IndentingNewLine]", "NL", ",", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"xIntegral", "[", 
       RowBox[{"L", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "Yield"}], ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//.", "$s"}], "//", 
       RowBox[{"expandDot", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "S", "}"}]}], "]"}]}], "//", 
      RowBox[{"tuOpDistributeF", "[", "xIntegral", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{
     RowBox[{"e", "[", "28", "]"}], "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"$", "/.", "$sp"}], ")"}]}], "//.", 
        RowBox[{"tuOpSimplify", "[", 
         RowBox[{"xIntegral", ",", 
          RowBox[{"{", "S", "}"}]}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{"a_", " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"\[Phi]", ",", "t"}], "]"}]}], ",", "t"}], "]"}], "->", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"a", ",", "\[Phi]"}], "]"}]}]}]}]}], ",", 
    RowBox[{"CR", "[", "\"\<e[28]\>\"", "]"}]}], "\[IndentingNewLine]", "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.793200228212694*^9, 3.7932002492073717`*^9}, {
  3.7932002989279737`*^9, 3.793200323055098*^9}, {3.793200353373674*^9, 
  3.793200367307981*^9}, {3.7932004065497007`*^9, 3.793200530490245*^9}, {
  3.793200560975665*^9, 3.793200678972797*^9}, {3.793200850156625*^9, 
  3.793200850810915*^9}, {3.793371194843691*^9, 3.7933711989369087`*^9}, {
  3.793372046441161*^9, 3.793372051448288*^9}, {3.7933721094168367`*^9, 
  3.793372204466638*^9}, {3.79337402689887*^9, 
  3.793374123871456*^9}},ExpressionUUID->"0d37fe3e-0973-4132-be13-\
d417b0ee67ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["\<\"Equation (28): With \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     TagBox[GridBox[{
        {
         RowBox[{"H", "\[Rule]", 
          RowBox[{"-", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["h", 
              StyleBox["i",
               StripOnInput->False,
               ShowContents->False], "i"],
             $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ".", 
            InterpretationBox[
             SubsuperscriptBox["S", 
              StyleBox["i",
               StripOnInput->False,
               ShowContents->False], "i"],
             $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}]}]}]},
        {
         RowBox[{"L", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "H"}], "+", 
           RowBox[{
            SubscriptBox["p", "\[Theta]"], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
              "\[Theta]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}], "+", 
           RowBox[{
            SubscriptBox["p", "\[Phi]"], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}]}]}]},
        {
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
            "\[Theta]", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", "0"}]},
        {
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["S", 
            StyleBox["a_",
             StripOnInput->False,
             ShowContents->False], "a_"],
           $CellContext`Tensor[$CellContext`S, {
             Pattern[$CellContext`a, 
              Blank[]]}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], "\[Rule]", 
          RowBox[{"S", " ", 
           InterpretationBox[
            SubsuperscriptBox["n", 
             StyleBox["a",
              StripOnInput->False,
              ShowContents->False], "a"],
            $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}]}]},
        {
         RowBox[{
          OverscriptBox["S", "\[RightVector]"], "\[Rule]", 
          RowBox[{"S", " ", 
           OverscriptBox["n", "\[RightVector]"]}]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     TemplateBox[{RowBox[{"S", " ", 
         RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             RowBox[{
               StyleBox["i", ShowContents -> False, StripOnInput -> False]}], 
             
             RowBox[{"i"}]], 
            $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
            BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
           InterpretationBox[
            SubsuperscriptBox["n", 
             RowBox[{
               StyleBox["i", ShowContents -> False, StripOnInput -> False]}], 
             
             RowBox[{"i"}]], 
            $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
            BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}],"t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    RowBox[{
     TemplateBox[{RowBox[{
         SubscriptBox["p", "\[Phi]"], " ", 
         InterpretationBox[
          RowBox[{
            SubscriptBox[
             UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "\[Phi]", 
            "]"}], 
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], SyntaxForm -> 
          Automatic, Editable -> False]}],"t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"S", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}]}]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "S"}], " ", 
     TemplateBox[{RowBox[{"(", 
         RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}],"\[Phi]"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
    RowBox[{"S", " ", 
     TemplateBox[{RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", 
           RowBox[{
             StyleBox["i", ShowContents -> False, StripOnInput -> False]}], 
           RowBox[{"i"}]], 
          $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
          BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
         InterpretationBox[
          SubsuperscriptBox["n", 
           RowBox[{
             StyleBox["i", ShowContents -> False, StripOnInput -> False]}], 
           RowBox[{"i"}]], 
          $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
          BaseStyle -> {AutoMultiplicationSymbol -> False}]}],"t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"e[28]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[1, 0, 0]]}]}]}],
  SequenceForm[
   Style["Equation (28): With ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`H -> -Dot[
         $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]]}, {$CellContext`L -> -$CellContext`H + 
       Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + 
       Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]}, \
{$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Theta], $CellContext`t] -> 
      0}, {$CellContext`Tensor[$CellContext`S, {
         Pattern[$CellContext`a, 
          
          Blank[]]}, {$CellContext`Void}] -> $CellContext`S \
$CellContext`Tensor[$CellContext`n, {$CellContext`a}, {$CellContext`Void}]}, {
     OverVector[$CellContext`S] -> $CellContext`S 
       OverVector[$CellContext`n]}}, Dividers -> {{True}, {False}}, 
    FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Inactive[Integrate][$CellContext`S Dot[
       $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}]], $CellContext`t] + 
   Inactive[Integrate][
    Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], $CellContext`t], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`S[
     OverVector[$CellContext`n]] -> -$CellContext`S 
     Inactive[Integrate][-1 + 
       Cos[$CellContext`\[Theta]], $CellContext`\[Phi]] + $CellContext`S 
     Inactive[Integrate][
       Dot[
        $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}]], $CellContext`t], 
   Style["e[28]", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.793372205617803*^9, 3.7933740540762873`*^9, 
  3.793374125155984*^9, 3.793549499282528*^9, 
  3.793665273514092*^9},ExpressionUUID->"b6dd50ec-cd70-4304-8765-\
ed21287bcf6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Check e[31] middle term integrand: \>\"", ",", 
   RowBox[{"$0", "=", 
    RowBox[{"$", "=", 
     RowBox[{"tuDPartial", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], " ", 
        RowBox[{"n", ".", " ", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"\[Delta]", "[", "n", "]"}], ",", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"n", ",", "\[Nu]"}], "]"}]}], "]"}]}]}], ",", "\[Mu]"}], 
      "]"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "//", 
      RowBox[{"tuDerivativeExpand", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", "[", 
          RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"productOps", "|", "Cross"}]}], "]"}]}], "//", 
     RowBox[{"expandDot", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "Expand", "}"}], ",", "2"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"n", ".", 
        RowBox[{"Cross", "[", 
         RowBox[{"a_", ",", " ", 
          RowBox[{"b", ":", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{
             RowBox[{"tuDPartial", "[", 
              RowBox[{"_", ",", "\[Nu]"}], "]"}], ",", "\[Mu]"}], "]"}]}]}], 
         "]"}]}], 
       RowBox[{"tt", ":", 
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}]}]}], "\[Rule]", 
      RowBox[{"n", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"a", ",", 
         RowBox[{"b", " ", "tt"}]}], "]"}]}]}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"tuDPartial", "[", 
        RowBox[{
         RowBox[{"tuDPartial", "[", 
          RowBox[{"_", ",", "\[Nu]"}], "]"}], ",", "\[Mu]"}], "]"}], " ", 
       RowBox[{"T", "[", 
        RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}]}], "\[Rule]", 
      "0"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{"_", ",", "0"}], "]"}], "\[Rule]", "0"}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"tuDPartial", "[", 
        RowBox[{"n", ",", "_"}], "]"}], ".", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"\[Delta]", "[", "n", "]"}], ",", 
         RowBox[{"tuDPartial", "[", 
          RowBox[{"n", ",", "_"}], "]"}]}], "]"}]}], "\[Rule]", "0"}]}]}], 
   ",", 
   RowBox[{"CG", "[", "\"\<OK this is the first term integrand\>\"", "]"}], 
   ",", "\[IndentingNewLine]", "line", ",", "NL", ",", "$0"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.7933766620191107`*^9, {3.793376733417062*^9, 3.7933768728005753`*^9}, {
   3.793376937576325*^9, 3.793377001947197*^9}, {3.793377056665902*^9, 
   3.7933771744384403`*^9}, {3.793377207806261*^9, 3.79337749278196*^9}, {
   3.79337753102171*^9, 3.7933776249068336`*^9}, {3.79337769144458*^9, 
   3.7933776920091333`*^9}, {3.793378516276984*^9, 3.793378581611998*^9}, {
   3.793378641508472*^9, 3.793378869068611*^9}, {3.7933789803119917`*^9, 
   3.793379090215981*^9}, {3.7933791448974752`*^9, 3.79337921240482*^9}, {
   3.793379258512025*^9, 3.793379299844121*^9}, {3.793379412020884*^9, 
   3.793379444102447*^9}, {3.793379475919458*^9, 3.793379608669528*^9}, {
   3.7933796456042833`*^9, 3.793379669626746*^9}, {3.793399928636552*^9, 
   3.7934002697298326`*^9}, {3.793412676859647*^9, 3.793412870163414*^9}, {
   3.793412901991091*^9, 3.793412914348597*^9}, {3.7934129467802362`*^9, 
   3.793413185811674*^9}, 3.793413228788808*^9, {3.793451122475994*^9, 
   3.793451134218835*^9}, {3.7934567715397663`*^9, 3.79345681104965*^9}, {
   3.7934568549509773`*^9, 3.793456948100855*^9}, 3.793457103035688*^9, {
   3.7934571379486217`*^9, 3.793457223648181*^9}, {3.7934573140162287`*^9, 
   3.793457450953678*^9}, {3.793457657051298*^9, 3.793457689075663*^9}, {
   3.793457992987034*^9, 3.793458051974914*^9}, {3.793458104040688*^9, 
   3.793458113622734*^9}, {3.793458713767599*^9, 3.79345874385709*^9}, {
   3.793550223211225*^9, 
   3.793550238016239*^9}},ExpressionUUID->"8e0e9a19-a0ea-4717-b709-\
9827c0d50c58"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Check e[31] middle term integrand: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     SubscriptBox[
      UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
     RowBox[{
      RowBox[{"n", ".", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
         Editable->False,
         SyntaxForm->Automatic]}]}], " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        StyleBox[
         RowBox[{"\[Mu]", "\[Nu]"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"\[Mu]", "\[Nu]"}]],
       $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "]"}],
    $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
       Cross[
        $CellContext`\[Delta][$CellContext`n], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], $CellContext`\
\[Mu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"n", " ", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
      RowBox[{"(", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["\[Epsilon]", 
          StyleBox[
           RowBox[{"\[Mu]", "\[Nu]"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"\[Mu]", "\[Nu]"}]],
         $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
           Editable->False,
           SyntaxForm->Automatic], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], $CellContext`\
\[Mu]],
         Editable->False,
         SyntaxForm->Automatic]}], ")"}]}]}], "+", 
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"n", " ", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", "0"}]}], "+", 
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"n", ".", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
        RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
       Editable->False,
       SyntaxForm->Automatic], "\[Cross]", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
       Editable->False,
       SyntaxForm->Automatic]}]}], " ", 
    InterpretationBox[
     SubsuperscriptBox["\[Epsilon]", 
      StyleBox[
       RowBox[{"\[Mu]", "\[Nu]"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"\[Mu]", "\[Nu]"}]],
     $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], "\[InvisibleSpace]", 
   StyleBox["\<\"OK this is the first term integrand\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     SubscriptBox[
      UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
     RowBox[{
      RowBox[{"n", ".", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
         Editable->False,
         SyntaxForm->Automatic]}]}], " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        StyleBox[
         RowBox[{"\[Mu]", "\[Nu]"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"\[Mu]", "\[Nu]"}]],
       $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "]"}],
    $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
       Cross[
        $CellContext`\[Delta][$CellContext`n], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]],
    Editable->False,
    SyntaxForm->Automatic]}],
  SequenceForm[
   Style["Check e[31] middle term integrand: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Dot[$CellContext`n, 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], \
$CellContext`\[Mu]]]] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}] + Dot[$CellContext`n, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] + Dot[
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`n Cross[
      $CellContext`\[Delta][$CellContext`n], \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], \
$CellContext`\[Mu]]] + Dot[$CellContext`n, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] + Dot[
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`n Cross[
      $CellContext`\[Delta][$CellContext`n], 0] + Dot[$CellContext`n, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] + Dot[
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Dot[$CellContext`n, 
     Cross[
      $CellContext`tuDDown["\[PartialD]"][
       $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["OK this is the first term integrand", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.793456807145392*^9, 3.793456816368299*^9}, {
   3.793456859753367*^9, 3.793456899515141*^9}, 3.793456949170929*^9, 
   3.793457104115967*^9, 3.793457138897252*^9, 3.793457224746043*^9, 
   3.793457419746716*^9, 3.793457451865065*^9, 3.793457689993679*^9, {
   3.793458034353345*^9, 3.793458052910675*^9}, 3.7934581147780037`*^9, {
   3.793458733545124*^9, 3.79345874483118*^9}, 3.793549499430964*^9, 
   3.7935502391370993`*^9, 
   3.793665273642805*^9},ExpressionUUID->"fea6933e-249d-41e5-aa54-\
c6054735a12f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.2 Fermionic model", "Subsubsection",
 CellChangeTimes->{{3.793550521896845*^9, 3.7935505261582413`*^9}, {
  3.793552479493525*^9, 
  3.793552481157394*^9}},ExpressionUUID->"7189448f-d136-4291-9e6c-\
10bf117fa4a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "34", "]"}], "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "\[Rule]", 
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ct", "[", "\[Psi]", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"I", " ", 
              RowBox[{"tuDPartial", "[", 
               RowBox[{"_", ",", "t"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"CG", "[", "\"\<coupling\>\"", "]"}], "]"}], " ", 
              RowBox[{
               OverscriptBox["n", "\[RightVector]"], ".", 
               OverscriptBox["\[Sigma]", "\[RightVector]"]}]}]}], ")"}], ".", 
           "\[Psi]"}], ",", "t"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", "[", 
              RowBox[{"\[Psi]", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"T", "[", 
               RowBox[{"\[Psi]", ",", "\"\<d\>\"", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], "}"}], "}"}]}], "}"}]}], 
         "}"}], "[", 
        RowBox[{"CG", "[", "\"\<spinor\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], ".", 
            OverscriptBox["n", "\[RightVector]"]}], "\[Rule]", "1"}]}], "}"}],
         "[", 
        RowBox[{"CG", "[", "\"\<bosonic field\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["S", "iE"], "\[Rule]", 
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ct", "[", "\[Psi]", "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tuDPartial", "[", 
                RowBox[{"_", ",", "t"}], "]"}], "-", 
               RowBox[{"m", " ", 
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], ".", 
                 OverscriptBox["\[Sigma]", "\[RightVector]"]}]}]}], ")"}], 
             ".", "\[Psi]"}], ",", "t"}], "]"}]}], "}"}], "[", 
        RowBox[{"CG", "[", "\"\<Wick rotated\>\"", "]"}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7935505303656816`*^9, 3.793550533446355*^9}, {
  3.793550770937454*^9, 3.793550893236362*^9}, {3.793550928274156*^9, 
  3.793551053645763*^9}, {3.7935511563031473`*^9, 3.793551190638111*^9}, {
  3.793551355149445*^9, 3.793551438848568*^9}, {3.7935514890063963`*^9, 
  3.793551500741671*^9}, {3.793551661007389*^9, 3.793551746990696*^9}, {
  3.793552429972137*^9, 3.793552431921056*^9}, {3.7935524857674437`*^9, 
  3.7935525138785753`*^9}},ExpressionUUID->"71b0aea1-7001-4a57-980e-\
bab740d9857d"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"S", "\[Rule]", 
      TemplateBox[{RowBox[{
          InterpretationBox[
           SuperscriptBox["\[Psi]", "\[Dagger]"], 
           ConjugateTranspose[$CellContext`\[Psi]], SyntaxForm -> Automatic, 
           Editable -> False], ".", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{
                RowBox[{
                  OverscriptBox["n", "\[RightVector]"], ".", 
                  OverscriptBox["\[Sigma]", "\[RightVector]"]}], " ", 
                RowBox[{"m", "[", 
                  StyleBox["\"coupling\"", 
                   RGBColor[0, 
                    Rational[2, 3], 0], FontFamily -> "Helvetica", 
                   StripOnInput -> False], "]"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "_", 
                   "]"}], 
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t], SyntaxForm -> Automatic, Editable -> 
                 False]}]}], ")"}], ".", "\[Psi]"}],"t"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"\[Psi]", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              InterpretationBox[
               SubsuperscriptBox["\[Psi]", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`\[Psi], {$CellContext`Void}, {
                1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               InterpretationBox[
                SubsuperscriptBox["\[Psi]", "2", 
                 StyleBox["2",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`\[Psi], {$CellContext`Void}, \
{2}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "}"}], "}"}]}], "}"}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"spinor\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "}"}]}]},
         {
          RowBox[{
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], ".", 
            OverscriptBox["n", "\[RightVector]"]}], "\[Rule]", "1"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"bosonic field\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox["S", 
            StyleBox["\<\"E\"\>",
             StripOnInput->False,
             FontSlant->Italic]], "\[Rule]", 
           TemplateBox[{RowBox[{
               InterpretationBox[
                SuperscriptBox["\[Psi]", "\[Dagger]"], 
                ConjugateTranspose[$CellContext`\[Psi]], SyntaxForm -> 
                Automatic, Editable -> False], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    RowBox[{"-", "m"}], " ", 
                    RowBox[{
                    OverscriptBox["n", "\[RightVector]"], ".", 
                    OverscriptBox["\[Sigma]", "\[RightVector]"]}]}], "+", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "_", 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}], ".", "\[Psi]"}],"t"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Wick rotated\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{
  3.793551193701138*^9, {3.79355143440724*^9, 3.793551439333414*^9}, 
   3.793551505658304*^9, {3.7935516986358767`*^9, 3.793551748553092*^9}, 
   3.7935524337566833`*^9, 3.7935525146300373`*^9, 
   3.7936652737298183`*^9},ExpressionUUID->"cdf944fd-0488-400d-851c-\
b0c8bc053bcc"]
}, Open  ]],

Cell["Effective action by chiral rotation trick", "Text",
 CellChangeTimes->{{3.7935520055302267`*^9, 
  3.793552016888139*^9}},ExpressionUUID->"a26c980c-5b9a-4098-9951-\
8fe074881df0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "36", "]"}], "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Z", "\[Rule]", 
           RowBox[{"xIntegral", "[", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               SubscriptBox["S", "eff"]}], "]"}], ",", "n"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["S", "eff"], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 SubscriptBox["S", "iE"]}], "]"}], ",", "\[Psi]", ",", 
               RowBox[{"OverBar", "[", "\[Psi]", "]"}]}], "]"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["S", "eff"], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             RowBox[{"Det", "[", "iD", "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$s", "=", 
           RowBox[{"iD", "->", 
            RowBox[{
             RowBox[{"tuDPartial", "[", 
              RowBox[{"_", ",", "t"}], "]"}], "-", 
             RowBox[{"m", " ", 
              RowBox[{
               OverscriptBox["n", "\[RightVector]"], ".", 
               OverscriptBox["\[Sigma]", "\[RightVector]"]}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$su", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ct", "[", "U", "]"}], ".", 
                  OverscriptBox["n", "\[RightVector]"], ".", 
                  OverscriptBox["\[Sigma]", "\[RightVector]"], ".", "U"}], "->", 
                 RowBox[{"T", "[", 
                  RowBox[{"u", ",", "\"\<d\>\"", ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}]}], ",", 
                RowBox[{
                 OverscriptBox["a", "^"], "->", 
                 RowBox[{
                  RowBox[{"ct", "[", "U", "]"}], ".", 
                  RowBox[{"(", 
                   RowBox[{"I", " ", 
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"_", ",", "t"}], "]"}]}], ")"}], ".", "U"}]}]}], 
               "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$su1", "=", 
               RowBox[{"tuRuleSolve", "[", 
                RowBox[{
                 RowBox[{"$su", "//", 
                  RowBox[{"expandDot", "[", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ct", "[", "U", "]"}], ".", 
                   RowBox[{"(", 
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"_", ",", "t"}], "]"}], ")"}], ".", "U"}], 
                  "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"$", "=", 
               RowBox[{
                OverscriptBox["iD", "~"], "->", 
                RowBox[{
                 RowBox[{"ct", "[", "U", "]"}], ".", "iD", ".", "U"}]}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"$", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "/.", "$s"}]}], ";", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"$", "=", 
                 RowBox[{"$", "//", 
                  RowBox[{"expandDot", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$su", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "$su1"}], "}"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}]}], "}"}], "[", 
               RowBox[{
               "CR", "[", 
                "\"\<missing \!\(\*SubscriptBox[\(\[PartialD]\), \(t\)]\) \
from e[38]\>\"", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "}"}], "[", 
           RowBox[{"CG", "[", "\"\<chiral rotation\>\"", "]"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "[", 
        RowBox[{"CG", "[", "\"\<\[Placeholder]\>\"", "]"}], "]"}], "}"}]}]}], 
    ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "6"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793552018639544*^9, 3.793552324616243*^9}, {
   3.793552372980875*^9, 3.793552384890018*^9}, {3.793552503141828*^9, 
   3.793552508493784*^9}, {3.793553198836808*^9, 3.793553359526146*^9}, {
   3.793553390309462*^9, 3.7935533905972433`*^9}, {3.793553511088605*^9, 
   3.793553585867518*^9}, {3.793553634178632*^9, 3.793553910821775*^9}, 
   3.793553980655903*^9, {3.7936653028348227`*^9, 3.79366530699327*^9}, {
   3.79379722749327*^9, 
   3.793797292810246*^9}},ExpressionUUID->"6dcdcb7b-77b3-4600-b901-\
7285be1db96d"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"Z", "\[Rule]", 
           TemplateBox[{SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
                SubscriptBox["S", "eff"]}]],"n"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]},
         {
          RowBox[{
           SubscriptBox["S", "eff"], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             TemplateBox[{SuperscriptBox["\[ExponentialE]", 
                RowBox[{"-", 
                  SubscriptBox["S", 
                   StyleBox["\"E\"", Italic, StripOnInput -> False]]}]],
               "\[Psi]",OverscriptBox["\[Psi]", "_"]},
              "InactiveIntegrate",
              DisplayFunction->(RowBox[{
                 StyleBox["\[Integral]", "Inactive"], 
                 RowBox[{
                   StyleBox["\[Integral]", "Inactive"], 
                   RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #3}], 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
              InterpretationFunction->(RowBox[{
                 RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                 RowBox[{#, ",", #2, ",", #3}], "]"}]& )], "]"}]}]}]},
         {
          RowBox[{
           SubscriptBox["S", "eff"], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             RowBox[{"Det", "[", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "]"}], "]"}]}]}]},
         {
          RowBox[{
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "m"}], " ", 
             RowBox[{
              OverscriptBox["n", "\[RightVector]"], ".", 
              OverscriptBox["\[Sigma]", "\[RightVector]"]}]}], "+", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
              "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}]}]},
         {
          RowBox[{
           TagBox[GridBox[{
              {
               TagBox[GridBox[{
                  {
                   RowBox[{
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    OverscriptBox["n", "\[RightVector]"], ".", 
                    OverscriptBox["\[Sigma]", "\[RightVector]"], ".", "U"}], 
                    "\[Rule]", 
                    InterpretationBox[
                    SubsuperscriptBox["u", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`u, {$CellContext`Void}, {
                    3}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False]}]},
                  {
                   RowBox[{
                    OverscriptBox["a", "^"], "\[Rule]", 
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], ")"}], ".", "U"}]}]}
                 },
                 AutoDelete->False,
                 FrameStyle->Directive[
                   RGBColor[0.7, 0, 1, 1], 
                   Thickness[Tiny]],
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Grid"]},
              {
               RowBox[{
                OverscriptBox[
                 StyleBox["\<\"D\"\>",
                  StripOnInput->False,
                  FontSlant->Italic], "~"], "\[Rule]", 
                RowBox[{
                 InterpretationBox[
                  SuperscriptBox["U", "\[Dagger]"],
                  ConjugateTranspose[$CellContext`U],
                  Editable->False,
                  SyntaxForm->Automatic], ".", 
                 StyleBox["\<\"D\"\>",
                  StripOnInput->False,
                  FontSlant->Italic], ".", "U"}]}]},
              {
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  OverscriptBox[
                   StyleBox["\<\"D\"\>",
                    StripOnInput->False,
                    FontSlant->Italic], "~"], "\[Rule]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    OverscriptBox["a", "^"]}], "-", 
                   RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["u", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`u, {$CellContext`Void}, {
                    3}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False]}]}]}], "}"}], "[", 
                
                StyleBox["\<\"missing \
\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \\(t\\)]\\) from e[38]\"\>",
                 StripOnInput->False,
                 LineColor->RGBColor[1, 0, 0],
                 FrontFaceColor->RGBColor[1, 0, 0],
                 BackFaceColor->RGBColor[1, 0, 0],
                 GraphicsColor->RGBColor[1, 0, 0],
                 FontFamily->"Helvetica",
                 FontColor->RGBColor[1, 0, 0]], "]"}]}
             },
             AutoDelete->False,
             FrameStyle->Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]],
             GridBoxAlignment->{"Columns" -> {{Left}}},
             GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"], "[", 
           StyleBox["\<\"chiral rotation\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"\[Placeholder]\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{{3.793553755311864*^9, 3.79355378733103*^9}, 
   3.793553845398055*^9, 3.793553877970126*^9, 3.793553911527676*^9, 
   3.793665273827992*^9, 3.793665309141838*^9, {3.79379728523288*^9, 
   3.793797293515348*^9}},ExpressionUUID->"bc9fbd80-fdc0-4a2b-a39a-\
fbe1a0bc3184"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 655},
WindowMargins->{{4, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"tuTensorialStyle.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 728, 12, 57, "Input",ExpressionUUID->"5fbe7f1f-bb50-45f0-a196-f918e4732957",
 InitializationCell->True],
Cell[1311, 36, 409, 7, 25, "Output",ExpressionUUID->"a8420a03-6bf3-431e-a75c-ba549ca09e4a"]
}, Open  ]],
Cell[1735, 46, 304, 7, 79, "Section",ExpressionUUID->"0ac4dab0-4cd0-4d9b-a985-bd0415c877ed"],
Cell[CellGroupData[{
Cell[2064, 57, 155, 3, 32, "Section",ExpressionUUID->"72d21847-5b16-4c32-9725-b73476101bef"],
Cell[2222, 62, 821, 21, 44, "InlineFormula",ExpressionUUID->"466d7187-6c67-45bb-9daf-32627d6d30b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3080, 88, 166, 3, 52, "Section",ExpressionUUID->"d6dd88c9-bc1d-48d0-bc63-b79b0a93b3f3"],
Cell[CellGroupData[{
Cell[3271, 95, 1275, 37, 103, "Code",ExpressionUUID->"15c8e8a3-b541-4ed5-a9d2-c0cc7d54962d"],
Cell[4549, 134, 2443, 64, 46, "Output",ExpressionUUID->"426a4630-be3d-409d-aeb8-e655f7a19cc2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7041, 204, 189, 3, 52, "Section",ExpressionUUID->"7e555e1f-5a96-4217-bb6b-7f805621b557"],
Cell[CellGroupData[{
Cell[7255, 211, 180, 3, 47, "Subsection",ExpressionUUID->"f7c569ef-76f9-4d72-8d27-f76ea5d95d90"],
Cell[CellGroupData[{
Cell[7460, 218, 4671, 117, 252, "Input",ExpressionUUID->"518a0ad7-d6d4-4b64-baf6-255975dc9e48",
 InitializationCell->False],
Cell[12134, 337, 8480, 237, 194, "Print",ExpressionUUID->"0e9d28e9-d80d-497a-8f9d-3335530a016b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20663, 580, 176, 2, 47, "Subsection",ExpressionUUID->"fd6d9595-7898-43a5-a473-76b576704950"],
Cell[CellGroupData[{
Cell[20864, 586, 7092, 147, 251, "Input",ExpressionUUID->"638ac9e5-e8ab-4a41-b8f1-08a474072ca3"],
Cell[27959, 735, 11762, 309, 258, "Output",ExpressionUUID->"772192f5-591f-4850-966a-a69cf412b035"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39770, 1050, 242, 6, 47, "Subsection",ExpressionUUID->"55d85157-d3d1-4a02-a04d-23bc7a63194c"],
Cell[CellGroupData[{
Cell[40037, 1060, 7667, 185, 314, "Input",ExpressionUUID->"0810582f-884c-415f-825d-cc1b941d0849"],
Cell[47707, 1247, 18260, 433, 234, "Output",ExpressionUUID->"77bf399d-46cd-4fed-832e-f13d8688eb3d"]
}, Open  ]],
Cell[65982, 1683, 170, 3, 42, "Subsubsection",ExpressionUUID->"a6a27bad-5ce2-449a-8885-76aa00e99293"],
Cell[CellGroupData[{
Cell[66177, 1690, 241, 4, 28, "Subsubsection",ExpressionUUID->"14573c17-dbf0-4e74-bdc1-4a1c595a0ffb"],
Cell[CellGroupData[{
Cell[66443, 1698, 1068, 30, 106, "Input",ExpressionUUID->"f405734f-e899-4ab8-ac08-e1294930b0ae"],
Cell[67514, 1730, 2074, 55, 54, "Print",ExpressionUUID->"687b0b23-52bb-464f-8e24-bdb2f2b61dcb"]
}, Open  ]]
}, Open  ]],
Cell[69615, 1789, 199, 3, 42, "Subsubsection",ExpressionUUID->"6405ae2e-a2cc-44b6-9bec-abfb98636916"],
Cell[69817, 1794, 196, 3, 28, "Subsubsection",ExpressionUUID->"ee2e0258-092b-498c-a6dd-0718c7fa6f0c"],
Cell[70016, 1799, 213, 4, 28, "Subsubsection",ExpressionUUID->"560b51ae-d720-40bb-acab-5bbe965a1398"],
Cell[CellGroupData[{
Cell[70254, 1807, 164, 3, 28, "Subsubsection",ExpressionUUID->"555164ed-fd16-48e9-ba05-bfa36d8d4b0c"],
Cell[70421, 1812, 188, 3, 29, "Text",ExpressionUUID->"2c522b4a-f377-4ad4-a323-1879c50064ee"],
Cell[CellGroupData[{
Cell[70634, 1819, 15199, 371, 825, "Input",ExpressionUUID->"bb190453-d07f-4802-8732-909c1a7c07ca"],
Cell[85836, 2192, 29089, 720, 558, "Print",ExpressionUUID->"a01063eb-f588-42c1-acc1-a801502c1a80"]
}, Open  ]],
Cell[114940, 2915, 239, 4, 29, "Text",ExpressionUUID->"d098bf65-1821-4694-9914-5b7f48909d14"],
Cell[CellGroupData[{
Cell[115204, 2923, 2555, 67, 170, "Input",ExpressionUUID->"b1beca73-91e5-45ef-8abc-1deb8635bf8d"],
Cell[117762, 2992, 6645, 186, 178, "Print",ExpressionUUID->"fa73d836-3041-402b-972c-1d38529fef4a"]
}, Open  ]],
Cell[124422, 3181, 199, 3, 29, "Text",ExpressionUUID->"09a1e7d1-0130-4191-b007-6c162d63a6a3"],
Cell[CellGroupData[{
Cell[124646, 3188, 8560, 203, 394, "Input",ExpressionUUID->"9a9bf8d8-3cbb-498a-bc24-7107bccb6953"],
Cell[133209, 3393, 27084, 635, 488, "Print",ExpressionUUID->"9d071b1a-1e03-4c0f-9147-36f5aaa1704b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160330, 4033, 5162, 137, 361, "Input",ExpressionUUID->"8fffeb94-a9a8-4179-b77f-c09c8d6f8802"],
Cell[165495, 4172, 26049, 641, 392, "Print",ExpressionUUID->"7f0a35d4-b7b9-4d7d-9cc8-2e45dff90160"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[191617, 4821, 178, 3, 52, "Section",ExpressionUUID->"ca95ee77-9fec-40e5-8a4d-00fc31d9f57e"],
Cell[CellGroupData[{
Cell[191820, 4828, 169, 3, 42, "Subsubsection",ExpressionUUID->"a9906281-b35d-4911-860b-b2d6d5783480"],
Cell[CellGroupData[{
Cell[192014, 4835, 8414, 199, 416, "Input",ExpressionUUID->"c4ece8f8-00ae-4fd3-a9f1-5d1d5953ebf7"],
Cell[200431, 5036, 20722, 534, 298, "Print",ExpressionUUID->"f56015be-24e3-482d-aebb-b9c186bdb930"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221190, 5575, 9524, 233, 512, "Input",ExpressionUUID->"72a50735-bf2a-4a6d-9e50-4b682ec2dcd0"],
Cell[230717, 5810, 41741, 1112, 410, "Print",ExpressionUUID->"35d92b72-59c1-49e9-b62c-bffa8e6d66af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[272495, 6927, 5669, 144, 363, "Input",ExpressionUUID->"7cc40990-9ecd-4763-a6e9-37824902e917"],
Cell[278167, 7073, 16734, 413, 313, "Print",ExpressionUUID->"1dfb5f74-fa24-4e1d-b213-8dea501fdf74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294938, 7491, 2537, 66, 155, "Input",ExpressionUUID->"0d37fe3e-0973-4132-be13-d417b0ee67ad"],
Cell[297478, 7559, 11943, 308, 220, "Print",ExpressionUUID->"b6dd50ec-cd70-4304-8765-ed21287bcf6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309458, 7872, 4784, 113, 203, "Input",ExpressionUUID->"8e0e9a19-a0ea-4717-b709-9827c0d50c58"],
Cell[314245, 7987, 23700, 606, 184, "Print",ExpressionUUID->"fea6933e-249d-41e5-aa54-c6054735a12f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[337994, 8599, 221, 4, 42, "Subsubsection",ExpressionUUID->"7189448f-d136-4291-9e6c-10bf117fa4a7"],
Cell[CellGroupData[{
Cell[338240, 8607, 3689, 93, 173, "Input",ExpressionUUID->"71b0aea1-7001-4a57-980e-bab740d9857d"],
Cell[341932, 8702, 8559, 224, 132, "Print",ExpressionUUID->"cdf944fd-0488-400d-851c-b0c8bc053bcc"]
}, Open  ]],
Cell[350506, 8929, 185, 3, 29, "Text",ExpressionUUID->"a26c980c-5b9a-4098-9951-8fe074881df0"],
Cell[CellGroupData[{
Cell[350716, 8936, 5264, 128, 281, "Input",ExpressionUUID->"6dcdcb7b-77b3-4600-b901-7285be1db96d"],
Cell[355983, 9066, 9315, 234, 192, "Print",ExpressionUUID->"bc9fbd80-fdc0-4a2b-a39a-fbe1a0bc3184"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

