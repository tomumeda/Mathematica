(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1544385,      37838]
NotebookOptionsPosition[   1529888,      37588]
NotebookOutlinePosition[   1530255,      37604]
CellTagsIndexPosition[   1530212,      37601]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", 
  "Local`QFTToolKit2`"}], "\[IndentingNewLine]", "tuItalics"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56864327369387*^9, 3.5686433185337973`*^9}, {
   3.636124223447123*^9, 3.6361242241696672`*^9}, {3.640430449322165*^9, 
   3.640430454418408*^9}, {3.6464973100744457`*^9, 3.646497314447693*^9}, {
   3.6694279608619347`*^9, 3.6694280040414133`*^9}, 3.670117817981682*^9, {
   3.671366579055991*^9, 3.6713666038803663`*^9}, {3.689772928097857*^9, 
   3.689772930433343*^9}, {3.732388727865262*^9, 3.732388755781152*^9}, {
   3.777221915099526*^9, 3.777221934544393*^9}, {3.791814820726375*^9, 
   3.791814847130887*^9}},ExpressionUUID->"5fbe7f1f-bb50-45f0-a196-\
f918e4732957"],

Cell[BoxData["\<\"Thu 4 Jun 2020 06:57:21\"\>"], "Output",
 CellChangeTimes->{
  3.800188536941786*^9, {3.800188893835444*^9, 3.800188894394703*^9}, 
   3.800267841446081*^9},ExpressionUUID->"5e97429d-8dca-47f8-9c3f-\
3e699e9a1d50"]
}, Open  ]],

Cell["\<\
1708.07192Topology, geometry and quantum interference in condensed matter \
physics.pdf --by A. Abanov\
\>", "Section",
 CellChangeTimes->{{3.792510851061994*^9, 3.792510867809889*^9}, {
  3.792681457995576*^9, 
  3.792681459289113*^9}},ExpressionUUID->"0ac4dab0-4cd0-4d9b-a985-\
bd0415c877ed"],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.792510638910294*^9, 
  3.792510643218574*^9}},ExpressionUUID->"72d21847-5b16-4c32-9725-\
b73476101bef"],

Cell[TextData[Cell[BoxData[
 RowBox[{"URL", "[", 
  TemplateBox[{
   "\"https://link.springer.com/content/pdf/10.1007%2FJHEP05%282017%29091.pdf\
\""},
   "URLArgument"], "]"}]], "Input",
 CellChangeTimes->{
  3.792510946726161*^9},ExpressionUUID->"4a335aa8-2783-4b57-a2af-\
fd3abeb709a7"]], "InlineFormula",
 CellChangeTimes->{{3.792510931642033*^9, 3.7925109598688393`*^9}, {
  3.792511132473298*^9, 3.7925111709979258`*^9}, {3.7925112048321466`*^9, 
  3.792511209558259*^9}, {3.8002677402374353`*^9, 3.800267749110984*^9}, {
  3.800267784249021*^9, 
  3.800267831973608*^9}},ExpressionUUID->"466d7187-6c67-45bb-9daf-\
32627d6d30b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1 Introductory remarks", "Section",
 CellChangeTimes->{{3.792511231261397*^9, 
  3.79251124288555*^9}},ExpressionUUID->"d6dd88c9-bc1d-48d0-bc63-\
b79b0a93b3f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"CG", "[", "\"\<with continuous symmetry G\>\"", "]"}], "]"}],
        "\[Rule]", 
       RowBox[{
        RowBox[{"SO", "[", "2", "]"}], "\[Rule]", 
        RowBox[{"U", "[", "1", "]"}]}]}], ",", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"H", ",", "G"}], "]"}], "[", 
        RowBox[{
        "CG", "[", 
         "\"\<symmetry braking into subgroups of H [coset space]\>\"", "]"}], 
        "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"SU", "[", "2", "]"}], ",", 
          RowBox[{"U", "[", "1", "]"}]}], "]"}], "\[Rule]", 
        SuperscriptBox["S", "2"]}]}]}], "\n", "}"}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\n"}]], "Code",
 CellChangeTimes->{{3.792511903832543*^9, 3.792512022683538*^9}, {
  3.792512068659267*^9, 3.7925122186473083`*^9}, {3.792531000591074*^9, 
  3.792531032199637*^9}, {3.792591929519951*^9, 
  3.792591947179325*^9}},ExpressionUUID->"15c8e8a3-b541-4ed5-a9d2-\
c0cc7d54962d"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"H", "[", 
       StyleBox["\<\"with continuous symmetry G\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"SO", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"U", "[", "1", "]"}]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"H", ",", "G"}], "]"}], "[", 
       StyleBox["\<\"symmetry braking into subgroups of H [coset space]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"SU", "[", "2", "]"}], ",", 
         RowBox[{"U", "[", "1", "]"}]}], "]"}], "\[Rule]", 
       SuperscriptBox["S", "2"]}]}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.800188537171028*^9, {3.800188894116366*^9, 3.800188894643696*^9}, 
   3.8002678417510777`*^9},ExpressionUUID->"91d0aedc-04dc-43ef-bb85-\
f346fea872b0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2 Motivating example: a particle on a ring", "Section",
 CellChangeTimes->{{3.7926226224238787`*^9, 
  3.792622632616851*^9}},ExpressionUUID->"7e555e1f-5a96-4217-bb6b-\
7f805621b557"],

Cell[CellGroupData[{

Cell["2.1 Classical particle on a ring", "Subsection",
 CellChangeTimes->{{3.792638303382678*^9, 
  3.792638313710559*^9}},ExpressionUUID->"f7c569ef-76f9-4d72-8d27-\
f76ea5d95d90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "2", "]"}], "=", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"S", "[", "\[Phi]", "]"}], "->", 
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{"L", "[", 
           RowBox[{"\[Phi]", ",", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "]"}], ",", "t"}], 
         "]"}]}], ",", "\[LineSeparator]", 
       RowBox[{"$l", "=", 
        RowBox[{"L", "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "/", "2"}], " ", 
           SuperscriptBox[
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "t"}], "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"CG", "[", "\"\<constant\>\"", "]"}], "]"}], " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"\[Phi]", ",", "t"}], "]"}]}]}]}]}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"M", " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"\[Phi]", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "t"}], "}"}]}], "]"}]}], "\[Rule]", "0"}], 
         "}"}], "[", 
        RowBox[{"CG", "[", "\"\<EOM\>\"", "]"}], "]"}], ",", "\n", 
       RowBox[{"$p", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$", "=", 
            RowBox[{"p", "\[Rule]", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"L", ",", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "]"}]}]}], ",", "\n", 
           RowBox[{
            RowBox[{"$", "/.", 
             RowBox[{"tuRule", "[", "$l", "]"}]}], "//", 
            RowBox[{"tuDerivativeExpand", "[", 
             RowBox[{"{", 
              RowBox[{"A", ",", "M"}], "}"}], "]"}]}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<conjugate momentum\>\"", "]"}], "]"}]}], ",",
        "\n", "\n", 
       RowBox[{"$h", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"$h", "=", 
            RowBox[{"H", "\[Rule]", 
             RowBox[{
              RowBox[{"p", " ", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "-", "L"}]}]}], ",", 
           "\n", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"$h", "/.", "$l"}], ",", "$p"}], "}"}], "//", 
                RowBox[{"tuRuleSelect", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"H", ",", "p"}], "}"}], ",", 
                  RowBox[{"{", "A", "}"}]}], "]"}]}], "//", 
               RowBox[{
                RowBox[{"tuEliminate", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"tuDPartial", "[", 
                    RowBox[{"\[Phi]", ",", "t"}], "]"}], "}"}]}], "]"}], 
                "&"}]}], "\n", "//", 
              RowBox[{"tuRuleSolveF", "[", "H", "]"}]}], "//", "tuRule1"}], "//",
             "Factor"}]}], "\n", "}"}], "[", 
         RowBox[{"CG", "[", "\"\<Hamiltonian\>\"", "]"}], "]"}]}]}], "\n", 
      "\n", "}"}], "[", 
     RowBox[{"CG", "[", "\"\<particle on a ring\>\"", "]"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ColumnForms", "[", 
      RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}], "//", 
  "PR"}], "\n"}], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.792622653348363*^9, 3.792622893299519*^9}, {
   3.7926229386473703`*^9, 3.792622965808762*^9}, {3.7926349744987803`*^9, 
   3.792635051632505*^9}, {3.792635324096233*^9, 3.79263562191166*^9}, {
   3.79263575719176*^9, 3.792635758004767*^9}, {3.792637399901596*^9, 
   3.7926374045255327`*^9}, {3.7926374358584023`*^9, 3.792637436227084*^9}, {
   3.7926374685049343`*^9, 3.79263776712211*^9}, {3.792638031231385*^9, 
   3.792638101942367*^9}, {3.7926382153814583`*^9, 3.792638228559104*^9}, {
   3.79264069228929*^9, 3.792640692431559*^9}, {3.79277621476149*^9, 
   3.792776215491026*^9}, {3.792776294748028*^9, 3.792776318951663*^9}, 
   3.7928463774972973`*^9, {3.792848819646143*^9, 3.792848854228611*^9}, {
   3.7928488843803*^9, 3.7928491681283216`*^9}, {3.7928492512088346`*^9, 
   3.7928492521213627`*^9}, {3.7928499925071573`*^9, 
   3.7928500639078093`*^9}, {3.792850150756222*^9, 
   3.792850201059517*^9}},ExpressionUUID->"518a0ad7-d6d4-4b64-baf6-\
255975dc9e48"],

Cell[BoxData[
 RowBox[{
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
       TemplateBox[{RowBox[{"L", "[", 
           RowBox[{"\[Phi]", ",", 
             InterpretationBox[
              RowBox[{
                SubscriptBox[
                 UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "\[Phi]", 
                "]"}], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], SyntaxForm -> 
              Automatic, Editable -> False]}], "]"}],"t"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}]},
     {
      RowBox[{"L", "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          StyleBox["\<\"constant\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}], " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", "M", " ", 
         SuperscriptBox[
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic], "2"]}]}]}]},
     {
      RowBox[{
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"M", " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                RowBox[{"{", 
                 RowBox[{"t", ",", "t"}], "}"}]], "[", "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], {$CellContext`t, \
$CellContext`t}],
              Editable->False,
              SyntaxForm->Automatic]}], "\[Rule]", "0"}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "[", 
       StyleBox["\<\"EOM\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]},
     {
      RowBox[{
       TagBox[GridBox[{
          {
           RowBox[{"p", "\[Rule]", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 "\[Phi]", "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]], "[", "L", "]"}],
             $CellContext`tuDDown["\[PartialD]"][$CellContext`L, 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]],
             Editable->False,
             SyntaxForm->Automatic]}]},
          {
           RowBox[{"p", "\[Rule]", 
            RowBox[{"A", "+", 
             RowBox[{"M", " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "[", 
       StyleBox["\<\"conjugate momentum\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]},
     {
      RowBox[{
       TagBox[GridBox[{
          {
           RowBox[{"H", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "L"}], "+", 
             RowBox[{"p", " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}]}]},
          {
           RowBox[{"H", "\[Rule]", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"A", "-", "p"}], ")"}], "2"], 
             RowBox[{"2", " ", "M"}]]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "[", 
       StyleBox["\<\"Hamiltonian\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]}
    },
    AutoDelete->False,
    FrameStyle->Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]],
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "[", 
  StyleBox["\<\"particle on a ring\"\>",
   StripOnInput->False,
   LineColor->RGBColor[0, 
     Rational[2, 3], 0],
   FrontFaceColor->RGBColor[0, 
     Rational[2, 3], 0],
   BackFaceColor->RGBColor[0, 
     Rational[2, 3], 0],
   GraphicsColor->RGBColor[0, 
     Rational[2, 3], 0],
   FontFamily->"Helvetica",
   FontColor->RGBColor[0, 
     Rational[2, 3], 0]], "]"}]], "Print",
 CellChangeTimes->{3.800188537352704*^9, 3.800188894807173*^9, 
  3.800267841925015*^9},ExpressionUUID->"2ebb2354-5489-46a2-8509-\
33821bd3060b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.2 Quantum particle on a ring", "Subsection",
 CellChangeTimes->{{3.7926383326458397`*^9, 
  3.7926383426298*^9}},ExpressionUUID->"fd6d9595-7898-43a5-a473-76b576704950"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "9", "]"}], "=", 
   RowBox[{"$", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], "//", 
          RowBox[{"tuRuleSelect", "[", 
           RowBox[{"H", ",", 
            RowBox[{"{", "A", "}"}]}], "]"}]}], "//", "tuRule1"}]}], ";", 
       RowBox[{"$", "=", 
        RowBox[{"$", "/.", 
         RowBox[{
          SuperscriptBox["a_", "2"], "\[Rule]", 
          RowBox[{"a", ".", "a"}]}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$p", "=", 
         RowBox[{"p", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"_", ",", "\[Phi]"}], "]"}]}]}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<wave-function representation\>\"", "]"}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$sh", "=", 
         RowBox[{"$", "/.", "$p"}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<Schrodinger eqn\>\"", "]"}], "]"}], ",", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", ".", "\[Psi]"}], "&"}], "/@", "$sh"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "//", 
         RowBox[{"tuBlankOpNest", "[", 
          RowBox[{"{", "A", "}"}], "]"}]}], "//", 
        RowBox[{"expandDC", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "M"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tuDerivativeExpand", "[", 
             RowBox[{"{", "A", "}"}], "]"}], ",", "Simplify"}], "}"}], ",", 
          "3"}], "]"}]}]}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$s", "=", 
         RowBox[{"\[Psi]", "\[Rule]", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}]}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<constraint\>\"", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"$", "/.", "$s"}], "//", 
         RowBox[{"tuDerivativeExpand", "[", 
          RowBox[{"{", "m", "}"}], "]"}]}], "//", 
        RowBox[{"expandDC", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Exp", "[", "_", "]"}], "}"}], ",", 
          RowBox[{"{", "Simplify", "}"}], ",", "3"}], "]"}]}]}], ",", "\n", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "//", 
         RowBox[{"tuRuleSolveF", "[", "H", "]"}]}], "//", "tuRule1"}]}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["iE", "m"], "->", 
         RowBox[{"$", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<eigenvalues\>\"", "]"}], "]"}]}], "\n", 
     "}"}]}]}], ";", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ColumnForms", "[", 
      RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.792640736712393*^9, 3.7926409082171288`*^9}, {
   3.792675512741528*^9, 3.792675555507331*^9}, {3.792675628115872*^9, 
   3.792675855714984*^9}, {3.792675892014975*^9, 3.792675906126772*^9}, 
   3.792675938479754*^9, {3.792675971900134*^9, 3.792676057867989*^9}, {
   3.792676098458235*^9, 3.7926762143147993`*^9}, {3.7926762825334263`*^9, 
   3.792676287027199*^9}, {3.792676325171938*^9, 3.792676364216609*^9}, {
   3.792676406759881*^9, 3.792676423403638*^9}, {3.792676465726581*^9, 
   3.792676620490408*^9}, {3.7926766827805433`*^9, 3.792676683258082*^9}, {
   3.792676713864381*^9, 3.792676792254593*^9}, {3.7926768345589247`*^9, 
   3.7926768564226227`*^9}, {3.792676897089456*^9, 3.792676993931411*^9}, {
   3.792677046782504*^9, 3.792677066049377*^9}, {3.792677180197125*^9, 
   3.7926771937290487`*^9}, {3.792677248276114*^9, 3.792677256092717*^9}, {
   3.792677300956726*^9, 3.79267730199124*^9}, {3.792677344065024*^9, 
   3.7926773455291147`*^9}, {3.792677409654325*^9, 3.792677426252754*^9}, {
   3.7926774596060658`*^9, 3.7926775294765453`*^9}, {3.7926775739886293`*^9, 
   3.792677618626484*^9}, {3.7926776521406317`*^9, 3.79267765443431*^9}, {
   3.792677713189817*^9, 3.792677890132401*^9}, {3.792677925237763*^9, 
   3.792677963603133*^9}, {3.792677993760591*^9, 3.7926780068864403`*^9}, {
   3.792678061679742*^9, 3.7926780626976013`*^9}, {3.792678101194291*^9, 
   3.7926781305318193`*^9}, {3.792678163793539*^9, 3.792678225705329*^9}, {
   3.792678256265524*^9, 3.792678290906055*^9}, {3.7926783600487537`*^9, 
   3.792678907712658*^9}, {3.792679021888947*^9, 3.792679025722221*^9}, {
   3.792679076021277*^9, 3.7926790781623983`*^9}, {3.7926791132635307`*^9, 
   3.792679116843286*^9}, {3.792679148795261*^9, 3.7926791938190813`*^9}, {
   3.7926792267044783`*^9, 3.792679243993101*^9}, {3.7926792749057207`*^9, 
   3.792679279133061*^9}, {3.792679391864616*^9, 3.792679441848672*^9}, {
   3.792680025360032*^9, 3.7926800284702673`*^9}, {3.792680266762332*^9, 
   3.792680324525897*^9}, {3.792680374715934*^9, 3.79268041395959*^9}, {
   3.792680449544684*^9, 3.792680451524482*^9}, {3.7926804841166277`*^9, 
   3.792680495331767*^9}, {3.79268060280509*^9, 3.792680610436306*^9}, {
   3.792680651754994*^9, 3.792680665367038*^9}, {3.792680702121255*^9, 
   3.792680717599852*^9}, {3.7926812335934258`*^9, 3.792681254809647*^9}, {
   3.7926813804348993`*^9, 3.792681392402484*^9}, {3.79268152901794*^9, 
   3.792681586764319*^9}, {3.79268162559477*^9, 3.792681641424152*^9}, {
   3.792681718695569*^9, 3.792681974071904*^9}, {3.7926820275292463`*^9, 
   3.792682064184024*^9}, {3.792682095123644*^9, 3.792682106173609*^9}, {
   3.792682238588128*^9, 3.792682264500609*^9}, {3.792682303666005*^9, 
   3.7926824052734947`*^9}, {3.79268244441343*^9, 3.792682557694745*^9}, {
   3.79277473095945*^9, 3.792774791823353*^9}, {3.7927750883854017`*^9, 
   3.792775116108591*^9}, {3.7927758244070463`*^9, 3.79277583013439*^9}, {
   3.792775910549999*^9, 3.792775924257375*^9}, {3.792775964976169*^9, 
   3.792775965842175*^9}, {3.7927759999928493`*^9, 3.792776005199204*^9}, {
   3.7927780657215023`*^9, 3.792778074987549*^9}, {3.792778112468266*^9, 
   3.7927781365736647`*^9}, {3.792778174671022*^9, 3.7927781761350718`*^9}, {
   3.792779426599928*^9, 3.792779443161528*^9}, {3.7927795277601433`*^9, 
   3.792779553484632*^9}, {3.792779587862178*^9, 3.792779700434059*^9}, {
   3.7927807340317907`*^9, 3.79278080967045*^9}, {3.792780968597164*^9, 
   3.792781223371025*^9}, {3.792781266838188*^9, 3.7927812733368196`*^9}, {
   3.792781308771247*^9, 3.792781438900519*^9}, {3.792845035390809*^9, 
   3.792845036876025*^9}, {3.7932782707918386`*^9, 3.793278285986068*^9}, {
   3.793278318260592*^9, 3.793278427838171*^9}, {3.79337079202057*^9, 
   3.7933708357036257`*^9}},ExpressionUUID->"638ac9e5-e8ab-4a41-b8f1-\
08a474072ca3"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"H", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", "-", "p"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"A", "-", "p"}], ")"}]}], 
       RowBox[{"2", " ", "M"}]]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"p", "\[Rule]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"wave-function representation\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"H", "\[Rule]", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[",
                   "_", "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`\[Phi]],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{"A", "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[",
                   "_", "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`\[Phi]],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], ")"}]}], 
            RowBox[{"2", " ", "M"}]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Schrodinger eqn\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      RowBox[{"H", ".", "\[Psi]"}], "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"A", "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"A", "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}]}], 
        RowBox[{"2", " ", "M"}]], ".", "\[Psi]"}]}]},
    {
     RowBox[{
      RowBox[{"H", ".", "\[Psi]"}], "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["A", "2"], " ", "\[Psi]"}], 
        RowBox[{"2", " ", "M"}]], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "A", " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
           "\[Psi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Psi], $CellContext`\[Phi]],
          Editable->False,
          SyntaxForm->Automatic]}], "M"], "-", 
       FractionBox[
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
            "\[Psi]", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Psi], $CellContext`\[Phi]],
           Editable->False,
           SyntaxForm->Automatic], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Psi], $CellContext`\[Phi]], \
$CellContext`\[Phi]],
         Editable->False,
         SyntaxForm->Automatic], 
        RowBox[{"2", " ", "M"}]]}]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"\[Psi]", "\[Rule]", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"constraint\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", "H"}], 
      "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"A", "-", "m"}], ")"}], "2"]}], 
       RowBox[{"2", " ", "M"}]]}]},
    {
     RowBox[{"H", "\[Rule]", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"A", "-", "m"}], ")"}], "2"], 
       RowBox[{"2", " ", "M"}]]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox[
            StyleBox["\<\"E\"\>",
             StripOnInput->False,
             FontSlant->Italic], "m"], "\[Rule]", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"A", "-", "m"}], ")"}], "2"], 
            RowBox[{"2", " ", "M"}]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"eigenvalues\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.8001885374828167`*^9, 3.800188894951893*^9, 
  3.800267842058928*^9},ExpressionUUID->"163b688b-ecca-4d89-93c5-\
08db77b4f7f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2.3 Quantum particle on a ring: path integral and Wick\[CloseCurlyQuote]s \
rotation\
\>", "Subsection",
 CellChangeTimes->{{3.7928447801374493`*^9, 
  3.792844806304893*^9}},ExpressionUUID->"55d85157-d3d1-4a02-a04d-\
23bc7a63194c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "13", "]"}], "=", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$z", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Z", "\[Rule]", 
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"S", "[", "\[Phi]", "]"}]}], "]"}], ",", "\[Phi]"}], 
              "]"}]}], "}"}], "[", 
           RowBox[{"CG", "[", "\"\<path integral\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$sl", "=", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], "//", 
            RowBox[{"tuRuleSelect", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"S", "[", "_", "]"}], ",", "L"}], "}"}], "]"}]}]}]}], 
         "}"}], "//", "Flatten"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[Theta]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]", "[", "\[Phi]", "]"}], "[", 
            RowBox[{"CG", "[", "\"\<difference in path\>\"", "]"}], "]"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}]}], "]"}], "\[IndentingNewLine]", 
        "}"}], "[", 
       RowBox[{
       "CG", "[", "\"\<contribution to path integral by topological term\>\"",
         "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$w", "=", 
         RowBox[{"t", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Tau]"}]}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<Wick's rotation\>\"", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$s", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"$sl", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/.", "$w"}], "//", 
           RowBox[{"tuDerivativeExpand", "[", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"$sl", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"L", "[", "__", "]"}], "\[Rule]", "L"}]}], "/.", 
              "$s"}], "/.", "$w"}], "//", 
            RowBox[{"tuIntegralSimplify", "[", 
             RowBox[{"{", 
              RowBox[{"A", ",", "\[Phi]"}], "}"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"$", "/.", 
              RowBox[{
               RowBox[{"xIntegral", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
               RowBox[{"I", " ", 
                RowBox[{"xSum", "[", 
                 RowBox[{
                  RowBox[{"xIntegral", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "I"}], " ", "a"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", 
                    SubscriptBox["\[Beta]", "i"], ",", 
                    SubscriptBox["\[Beta]", 
                    RowBox[{"i", "+", "1"}]]}], "}"}]}], "]"}], ",", "i"}], 
                 "]"}]}]}]}], "//.", 
             RowBox[{"tuOpDistribute", "[", "xIntegral", "]"}]}], "/.", 
            RowBox[{
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"__", " ", 
                RowBox[{"tuDPartial", "[", 
                 RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}]}], ",", "_"}], 
              "]"}], "\[Rule]", "0"}]}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"tuRuleSelect", "[", "Z", "]"}], "[", "$z", "]"}], "//", 
           "First"}], "//", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "/.", "$"}], "/.", 
             RowBox[{
              RowBox[{"xIntegral", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{"xSum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", "\[Theta]", " ", "Q"}], "]"}], 
                 RowBox[{"xIntegral", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", "/.", 
                    RowBox[{
                    RowBox[{"xSum", "[", 
                    RowBox[{"aa_", ",", "_"}], "]"}], "\[Rule]", "aa"}]}], "/.", 
                    RowBox[{
                    SubscriptBox["\[Beta]", "i"], "\[Rule]", "0"}]}], "/.", 
                    RowBox[{
                    SubscriptBox["\[Beta]", 
                    RowBox[{"i", "+", "1"}]], "\[Rule]", "\[Beta]"}]}], "/.", 
                    
                    RowBox[{"\[Phi]", "\[Rule]", 
                    SubscriptBox["\[Phi]", "i"]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "i"], ",", 
                    RowBox[{
                    SubscriptBox["\[Phi]", "i"], "[", "0", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Phi]", "i"], "[", "0", "]"}], "+", 
                    RowBox[{"2", "\[Pi]", " ", "Q"}]}]}], "}"}]}], "]"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Q", ",", 
                  RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}],
                "]"}]}]}], "&"}], ")"}]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "}"}], "[", 
       RowBox[{
       "CG", "[", 
        "\"\<Wick rotated with periodic BC, \[Phi][0]\[Rule]\[Phi][\[Beta]]\>\
\"", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ColumnForms", "[", 
      RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", "$", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7928448688156767`*^9, 3.7928449395817013`*^9}, {
   3.792846016960906*^9, 3.79284601939047*^9}, {3.7928461116900597`*^9, 
   3.79284613363479*^9}, {3.792846491285181*^9, 3.7928467714725733`*^9}, {
   3.792846829277137*^9, 3.792846862101101*^9}, {3.7928468965752707`*^9, 
   3.7928469381832314`*^9}, {3.792846971660611*^9, 3.792847302050386*^9}, {
   3.792847403500516*^9, 3.7928474183554983`*^9}, {3.792847537033218*^9, 
   3.7928475405038*^9}, {3.792847585893881*^9, 3.792847600755414*^9}, {
   3.792858430213038*^9, 3.792858444509042*^9}, {3.792858476971834*^9, 
   3.792858480996944*^9}, {3.7928586272236223`*^9, 3.792858776163476*^9}, {
   3.792858847178898*^9, 3.792858898380032*^9}, {3.792858975085453*^9, 
   3.79285898820792*^9}, {3.792859039520266*^9, 3.792859219330141*^9}, {
   3.792859256807251*^9, 3.792859334945156*^9}, {3.792859411005618*^9, 
   3.7928594617882423`*^9}, {3.7928595713874683`*^9, 3.792859594975659*^9}, {
   3.792860114471314*^9, 3.79286013979982*^9}, {3.7928602523592577`*^9, 
   3.7928602627808123`*^9}, 3.792860298740962*^9, {3.792860520474607*^9, 
   3.79286064565497*^9}, {3.7928607379393597`*^9, 3.792860742279106*^9}, {
   3.7928608465498133`*^9, 3.792860888915585*^9}, {3.792861104222562*^9, 
   3.792861104998969*^9}, {3.792864182042304*^9, 
   3.792864186619698*^9}},ExpressionUUID->"0810582f-884c-415f-825d-\
cc1b941d0849"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Z", "\[Rule]", 
            TemplateBox[{SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", 
                 RowBox[{"S", "[", "\[Phi]", "]"}]}]],"\[Phi]"},
             "InactiveIntegrate",
             DisplayFunction->(RowBox[{
                StyleBox["\[Integral]", "Inactive"], 
                RowBox[{#, 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
             InterpretationFunction->(RowBox[{
                RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                RowBox[{#, ",", #2}], "]"}]& )]}], "}"}], "[", 
          StyleBox["\<\"path integral\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}]},
        {
         RowBox[{
          RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
          TemplateBox[{RowBox[{"L", "[", 
              RowBox[{"\[Phi]", ",", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                   "\[Phi]", "]"}], 
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                 SyntaxForm -> Automatic, Editable -> False]}], "]"}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         RowBox[{"L", "\[Rule]", 
          RowBox[{
           RowBox[{"A", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", "M", " ", 
            SuperscriptBox[
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "2"]}]}]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Theta]", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", "\[Phi]", "]"}], "[", 
              StyleBox["\<\"difference in path\"\>",
               StripOnInput->False,
               LineColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FrontFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               BackFaceColor->RGBColor[0, 
                 Rational[2, 3], 0],
               GraphicsColor->RGBColor[0, 
                 Rational[2, 3], 0],
               FontFamily->"Helvetica",
               FontColor->RGBColor[0, 
                 Rational[2, 3], 0]], "]"}]}], 
            RowBox[{"2", " ", "\[Pi]"}]]]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"contribution to path integral by topological term\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"t", "\[Rule]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Wick's rotation\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"L", "\[Rule]", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "A", " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
              Editable->False,
              SyntaxForm->Automatic]}], "-", 
            RowBox[{
             FractionBox["1", "2"], " ", "M", " ", 
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"]}]}]}]},
         {
          RowBox[{
           RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
           RowBox[{"\[ImaginaryI]", " ", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {"i"}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              TemplateBox[{RowBox[{
                  RowBox[{"-", "\[ImaginaryI]"}], " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False]}], "-", 
                    RowBox[{
                    FractionBox["1", "2"], " ", "M", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
                    ")"}]}],RowBox[{"(", 
                  RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}], ")"}],
                SubscriptBox["\[Beta]", "i"],SubscriptBox["\[Beta]", 
                 RowBox[{"1", "+", "i"}]]},
               "InactiveIntegrate",
               DisplayFunction->(RowBox[{
                  SubsuperscriptBox[
                   StyleBox["\[Integral]", "Inactive"], #3, #4], 
                  RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
               InterpretationFunction->(RowBox[{
                  RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                  RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
              "]"}],
             $CellContext`xSum[
              Inactive[Integrate][
              Complex[0, -1] (
                Complex[0, 1] $CellContext`A $CellContext`tuDDown[
                  "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
                Rational[-1, 2] $CellContext`M $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`\[Phi], \
$CellContext`\[Tau]]^2), {Complex[0, -1] $CellContext`\[Tau], 
                Subscript[$CellContext`\[Beta], $CellContext`i], 
                
                Subscript[$CellContext`\[Beta], 
                 1 + $CellContext`i]}], $CellContext`i],
             Editable->False,
             SyntaxForm->Automatic]}]}]},
         {
          RowBox[{"Z", "\[Rule]", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {
                  RowBox[{"{", 
                   RowBox[{"Q", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                   "}"}]}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}]], " ", 
              TemplateBox[{SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                   TemplateBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    SubscriptBox["\[Phi]", "i"], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]], SyntaxForm -> Automatic, Editable -> False]}], "-", 
                    RowBox[{
                    FractionBox["1", "2"], " ", "M", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    SubscriptBox["\[Phi]", "i"], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]], SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
                    ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}], ")"}], 
                    "0", "\[Beta]"}, "InactiveIntegrate", 
                    DisplayFunction -> (RowBox[{
                    SubsuperscriptBox[
                    StyleBox["\[Integral]", "Inactive"], #3, #4], 
                    RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ), 
                    InterpretationFunction -> (RowBox[{
                    RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                    RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]],
                SubscriptBox["\[Phi]", "i"],RowBox[{
                  SubscriptBox["\[Phi]", "i"], "[", "0", "]"}],RowBox[{
                  RowBox[{"2", " ", "\[Pi]", " ", "Q"}], "+", 
                  RowBox[{
                    SubscriptBox["\[Phi]", "i"], "[", "0", "]"}]}]},
               "InactiveIntegrate",
               DisplayFunction->(RowBox[{
                  SubsuperscriptBox[
                   StyleBox["\[Integral]", "Inactive"], #3, #4], 
                  RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
               InterpretationFunction->(RowBox[{
                  RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                  RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], 
             "]"}],
            $CellContext`xSum[
            E^(Complex[0, 1] $CellContext`Q $CellContext`\[Theta]) 
             Inactive[Integrate][
              E^(-Inactive[Integrate][
                 Complex[0, -1] (
                   Complex[0, 1] $CellContext`A $CellContext`tuDDown[
                    "\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]] + 
                   Rational[-1, 2] $CellContext`M $CellContext`tuDDown[
                    "\[PartialD]"][
                    
                    Subscript[$CellContext`\[Phi], $CellContext`i], \
$CellContext`\[Tau]]^2), {
                  Complex[0, -1] $CellContext`\[Tau], 
                   0, $CellContext`\[Beta]}]), {
                Subscript[$CellContext`\[Phi], $CellContext`i], 
                Subscript[$CellContext`\[Phi], $CellContext`i][0], 
                2 Pi $CellContext`Q + 
                Subscript[$CellContext`\[Phi], $CellContext`i][
                 0]}], {$CellContext`Q, 
              DirectedInfinity[-1], 
              DirectedInfinity[1]}],
            Editable->False,
            SyntaxForm->Automatic]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Wick rotated with periodic BC, \[Phi][0]\[Rule]\[Phi][\
\[Beta]]\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.800188537589061*^9, 3.800188895064001*^9, 
  3.80026784215958*^9},ExpressionUUID->"40d92aef-92f2-486b-8b31-a2fb40535486"]
}, Open  ]],

Cell["2.4 Quantum doublet", "Subsubsection",
 CellChangeTimes->{{3.792861433743373*^9, 
  3.792861448764206*^9}},ExpressionUUID->"a6a27bad-5ce2-449a-8885-\
76aa00e99293"],

Cell[CellGroupData[{

Cell["2.5 Full derivative term and topology", "Subsubsection",
 CellChangeTimes->{{3.7928615046316032`*^9, 3.792861513273095*^9}, {
  3.7929276039703703`*^9, 
  3.792927630580327*^9}},ExpressionUUID->"14573c17-dbf0-4e74-bdc1-\
4a1c595a0ffb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "20", "]"}], "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q", "\[Rule]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "\[Pi]"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Tau]", ",", "0", ",", "\[Beta]"}], "}"}]}], "]"}]}], 
        "}"}], "[", 
       RowBox[{"CG", "[", "\"\<winding number\>\"", "]"}], "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7929276350338163`*^9, 
  3.792927771846121*^9}},ExpressionUUID->"f405734f-e899-4ab8-ac08-\
e1294930b0ae"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q", "\[Rule]", 
        TemplateBox[{FractionBox[
           InterpretationBox[
            RowBox[{
              SubscriptBox[
               UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
              "\[Phi]", "]"}], 
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
            SyntaxForm -> Automatic, Editable -> False], 
           RowBox[{"2", " ", "\[Pi]"}]],"\[Tau]","0","\[Beta]"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            SubsuperscriptBox[
             StyleBox["\[Integral]", "Inactive"], #3, #4], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", 
              RowBox[{"{", 
                RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], "}"}], 
      "[", 
      StyleBox["\<\"winding number\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{3.800188537685452*^9, 3.800188895147126*^9, 
  3.800267842242774*^9},ExpressionUUID->"a3a81949-a45c-4680-aaac-\
8b8478e75e54"]
}, Open  ]]
}, Open  ]],

Cell["2.6 Topological terms and quantum interference", "Subsubsection",
 CellChangeTimes->{{3.7928618805414343`*^9, 
  3.792861894044752*^9}},ExpressionUUID->"6405ae2e-a2cc-44b6-9bec-\
abfb98636916"],

Cell["2.7 General definition of topological terms", "Subsubsection",
 CellChangeTimes->{{3.792863378777732*^9, 
  3.7928633906822987`*^9}},ExpressionUUID->"ee2e0258-092b-498c-a6dd-\
0718c7fa6f0c"],

Cell["2.8 Theta terms and their effects on the quantum problem", \
"Subsubsection",
 CellChangeTimes->{{3.7928636772312737`*^9, 
  3.7928636930926456`*^9}},ExpressionUUID->"560b51ae-d720-40bb-acab-\
5bbe965a1398"],

Cell[CellGroupData[{

Cell["2.9 Exercises", "Subsubsection",
 CellChangeTimes->{{3.792863978514326*^9, 
  3.792863984250963*^9}},ExpressionUUID->"555164ed-fd16-48e9-ba05-\
bfa36d8d4b0c"],

Cell["Exercise 1: Particle on a ring, path integral", "Text",
 CellChangeTimes->{{3.79286399183819*^9, 3.7928640086073513`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2c522b4a-f377-4ad4-a323-1879c50064ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
   "\"\<\[FilledCircle] Exercise 1: Particle on a ring, path integral\>\"", 
    ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Decompose partitian function \>\"", ",", 
    RowBox[{
     RowBox[{"$0", "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Z", "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"xIntegral", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", " ", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], "2"], "/", 
                    "2"}]}], "-", 
                   RowBox[{"I", " ", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"CG", "[", "\"\<topological term\>\"", "]"}], 
                    "]"}], " ", 
                    RowBox[{
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Tau]", ",", "0", ",", "\[Beta]"}], "}"}]}], 
                 "]"}]}], "]"}], ",", "\[Phi]"}], "]"}]}], "}"}], "[", 
          RowBox[{
          "CG", "[", 
           "\"\<Euclidean path integral for particle on a ring.\>\"", "]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Phi]", "\[Rule]", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"\[Pi]", "/", "\[Beta]"}], " ", 
              RowBox[{"Q", "[", 
               RowBox[{
               "CG", "[", "\"\<winding number, \[DoubleStruckCapitalZ]\>\"", 
                "]"}], "]"}], " ", "\[Tau]"}], "+", 
             RowBox[{"xSum", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Phi]", "l"], 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", "2", 
                  RowBox[{"\[Pi]", "/", "\[Beta]"}], " ", "l", " ", 
                  "\[Tau]"}], "]"}]}], ",", "l"}], "]"}]}]}], "}"}], "[", 
          RowBox[{"CG", "[", "\"\<l-decomposition\>\"", "]"}], "]"}], ","}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "\"\<as sum over topological sectors.\>\"", 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "line", ",", "NL", ",",
     "\[IndentingNewLine]", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$z", ",", "$s"}], "}"}], "=", 
       RowBox[{"$0", "//", 
        RowBox[{"tuRuleSelect", "[", 
         RowBox[{"{", 
          RowBox[{"Z", ",", "\[Phi]"}], "}"}], "]"}]}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{
     RowBox[{"$", "=", "$z"}], ";", "\[IndentingNewLine]", "Yield"}], ",", 
    RowBox[{"$", "=", 
     RowBox[{"$z", "/.", 
      RowBox[{
       RowBox[{"xIntegral", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
       RowBox[{"xIntegral", "[", 
        RowBox[{
         RowBox[{"a", "/.", "$s"}], ",", "b"}], "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"ii", ":", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"_", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0", ",", "\[Beta]"}], "}"}]}], "]"}]}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"tuIntegralSwitchVar", "[", 
           RowBox[{"t", "\[Rule]", 
            RowBox[{"\[Tau]", "/", "\[Beta]"}]}], "]"}], "[", "ii", "]"}], "//",
          "Simplify"}], ")"}]}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//", 
        RowBox[{"tuDerivativeExpand", "[", 
         RowBox[{"{", 
          RowBox[{"l", ",", "Q", ",", "\[Beta]", ",", 
           SubscriptBox["\[Phi]", "l"]}], "}"}], "]"}]}], "//", 
       RowBox[{"tuOpSimplifyF", "[", 
        RowBox[{"xSum", ",", 
         RowBox[{"{", "\[Beta]", "}"}]}], "]"}]}], "//", 
      RowBox[{"tuOpDistributeF", "[", "xIntegral", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//.", 
        RowBox[{
         RowBox[{"ii", ":", 
          RowBox[{"xIntegral", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{"a", "//", 
            RowBox[{"tuOpSimplifyFirst", "[", 
             RowBox[{"xIntegral", ",", 
              RowBox[{"{", 
               RowBox[{"\[Beta]", ",", "m", ",", "\[Theta]", ",", "Q"}], 
               "}"}]}], "]"}]}], ",", "b"}], "]"}]}]}], "//", 
       RowBox[{"tuOpSwitch", "[", 
        RowBox[{"xIntegral", ",", "xSum"}], "]"}]}], "//", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"xIntegral", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "2"], ",", "x_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"xIntegral", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a", ",", "b"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xSum", "[", 
                 RowBox[{"a", ",", "b"}], "]"}], "/.", 
                RowBox[{"l", "\[Rule]", "l2"}]}], ")"}]}], ",", "x"}], 
            "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xSum", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"xSum", "[", 
               RowBox[{"a1_", ",", "b1_"}], "]"}], ")"}]}], ",", "x_"}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"xSum", "[", 
           RowBox[{
            RowBox[{"xSum", "[", 
             RowBox[{
              RowBox[{"xIntegral", "[", 
               RowBox[{
                RowBox[{"a", " ", "a1"}], ",", "x"}], "]"}], ",", "b"}], 
             "]"}], ",", "b1"}], "]"}]}]}], "&"}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", "Activate"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\"\<PON\>\"", ",", "\[IndentingNewLine]", "Yield",
     ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{"$", ",", 
        RowBox[{"l", "\[Element]", "Integers"}]}], "]"}], "//.", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{"0", ",", "_"}], "]"}], "\[Rule]", "0"}]}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<The term \>\"", ",", 
    RowBox[{"$1", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuExtractPositionPattern", "[", 
       RowBox[{"xSum", "[", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{"_", ",", "_"}], "]"}], ",", "_"}], "]"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "\"\<is non-zero only when \>\"", ",", 
    RowBox[{"$s", "=", 
     RowBox[{"{", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"-", "l2"}]}], "}"}]}], ",", "\[IndentingNewLine]", "Yield", 
    ",", 
    RowBox[{"$1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$1", "/.", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"xSum", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ",", "c_"}], "]"}], ":>", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"tuOpIndependentVar", "[", 
            RowBox[{"Limit", ",", 
             RowBox[{"op$", "[", 
              RowBox[{"a", ",", 
               RowBox[{"l", "\[Rule]", 
                RowBox[{"-", "l2"}]}]}], "]"}]}], "]"}], ",", "b"}], 
          "]"}]}]}], "/.", 
       RowBox[{"l2", "\[Rule]", "l"}]}], "//", 
      RowBox[{"tuOpSimplifyFirst", "[", 
       RowBox[{"xSum", ",", 
        RowBox[{"{", "\[Beta]", "}"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Imply", ",", 
    RowBox[{"$2", "=", 
     RowBox[{"$", "=", 
      RowBox[{"tuReplacePart", "[", 
       RowBox[{"$", ",", "$1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{
       RowBox[{"Inactivate", "[", 
        RowBox[{"#", ",", "Integrate"}], "]"}], "&"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"pp", ":", 
         RowBox[{"Plus", "[", "a__", "]"}]}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"xExp", "[", "b", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "a"}], "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"$", "//", 
       RowBox[{"tuOpSimplifyFirst", "[", 
        RowBox[{"xIntegral", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "Q", ",", "\[Beta]"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{"$", "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"a", ",", 
          SubscriptBox["\[Phi]", "l"]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"tuOpIndependentVar", "[", 
        RowBox[{"tuIntegralSimplify", ",", 
         RowBox[{
          RowBox[{"op$", "[", 
           RowBox[{"{", 
            SubscriptBox["\[Phi]", "l"], "}"}], "]"}], "[", "$", "]"}]}], 
        "]"}], "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "->", 
        RowBox[{"xIntegral", "[", 
         RowBox[{"a", ",", 
          SubscriptBox["\[Phi]", "l"]}], "]"}]}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"xExp", "[", 
        RowBox[{"a_", " ", 
         RowBox[{"xSum", "[", 
          RowBox[{"b_", ",", "l"}], "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"xProduct", "[", 
        RowBox[{
         RowBox[{"xExp", "[", 
          RowBox[{"a", " ", "b"}], "]"}], ",", "l"}], "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuOpSwitch", "[", 
       RowBox[{"xIntegral", ",", "xProduct"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"xExp", "\[Rule]", "Exp"}]}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\"\<PONdd\>\"", ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{
     RowBox[{"$pass1", "=", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "//", "Activate"}], "//", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "/.", 
           RowBox[{"Z", "\[Rule]", 
            RowBox[{"Z", "[", "Q", "]"}]}]}], "&"}], ")"}]}]}]}], ";", 
     RowBox[{"$", "//", "Framed"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<The total partitian function \>\"", ",", 
    RowBox[{"Z", "\[Rule]", 
     RowBox[{"xSum", "[", 
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "Q"}], "]"}]}], ",", 
    "\"\< where the \[CapitalTheta] terms can be written as Cos[Q \[Theta]]'s\
\>\""}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7928640232665033`*^9, 3.792864028082243*^9}, {
   3.792864125653325*^9, 3.792864140907484*^9}, {3.792864191619907*^9, 
   3.792864213223322*^9}, {3.792864272160284*^9, 3.792864301745659*^9}, {
   3.792864333483465*^9, 3.792864437065604*^9}, {3.792864472611266*^9, 
   3.7928645552721977`*^9}, {3.7928645883205214`*^9, 3.792864656517413*^9}, {
   3.792864716749851*^9, 3.792864811231398*^9}, {3.7928648504374743`*^9, 
   3.79286500053411*^9}, {3.79286506203895*^9, 3.7928651071864233`*^9}, {
   3.792865175865189*^9, 3.792865201052622*^9}, {3.792865235929641*^9, 
   3.7928653461093197`*^9}, {3.792865376836637*^9, 3.792865481523526*^9}, {
   3.792865780740796*^9, 3.792865795326586*^9}, {3.792865833238365*^9, 
   3.792865882273162*^9}, {3.7928659734070263`*^9, 3.792865975005217*^9}, {
   3.792866013059223*^9, 3.792866023030346*^9}, {3.792866066245249*^9, 
   3.792866069148395*^9}, {3.792866178367293*^9, 3.792866215096429*^9}, {
   3.792866329211049*^9, 3.7928663404399567`*^9}, {3.7928668862044067`*^9, 
   3.79286698499885*^9}, {3.7928670196563587`*^9, 3.7928670804673567`*^9}, {
   3.7928671952399607`*^9, 3.7928673147046137`*^9}, {3.792867349094222*^9, 
   3.792867383082217*^9}, {3.79286751426374*^9, 3.792867564929267*^9}, {
   3.792867601933879*^9, 3.792867700901638*^9}, {3.792867731111689*^9, 
   3.792867741643729*^9}, {3.792868517890462*^9, 3.792868576643779*^9}, {
   3.792868828574836*^9, 3.792868844525235*^9}, {3.792868888979097*^9, 
   3.792868921397954*^9}, {3.79286895829145*^9, 3.792868966817074*^9}, {
   3.792869958922901*^9, 3.792870257626792*^9}, {3.7928703180317183`*^9, 
   3.7928703554329033`*^9}, 3.792871813546701*^9, 3.792889768750106*^9, {
   3.792926304533503*^9, 3.79292630780123*^9}, {3.7929263413213873`*^9, 
   3.792926341524775*^9}, {3.792926507356316*^9, 3.792926508945733*^9}, {
   3.792927955608796*^9, 3.7929279901953278`*^9}, {3.7929280668453712`*^9, 
   3.7929280913090067`*^9}, {3.7929281535932283`*^9, 3.792928163904434*^9}, {
   3.792928217685351*^9, 3.7929282208779593`*^9}, {3.7929282656270857`*^9, 
   3.7929282756720448`*^9}, {3.7929283154976063`*^9, 3.792928335821348*^9}, {
   3.792928369983296*^9, 3.79292837049506*^9}, {3.792928414103796*^9, 
   3.792928421775229*^9}, 3.792928473461445*^9, {3.792930404821375*^9, 
   3.792930406268182*^9}, {3.7929333383054256`*^9, 3.792933362970615*^9}, {
   3.792933619480941*^9, 3.7929337103102703`*^9}, {3.7929337483569117`*^9, 
   3.792933765992167*^9}, {3.792933829737687*^9, 3.7929338458151913`*^9}, {
   3.792933895113923*^9, 3.792933933843547*^9}, {3.792933995504511*^9, 
   3.7929340452809134`*^9}, {3.792934083458892*^9, 3.792934104312694*^9}, {
   3.792934311084898*^9, 3.7929344296451607`*^9}, {3.792934545149047*^9, 
   3.792934546563513*^9}, {3.792936996941782*^9, 3.7929370254249973`*^9}, {
   3.792937056442855*^9, 3.792937085967534*^9}, {3.7929376763595333`*^9, 
   3.792937688841446*^9}, {3.800267981865715*^9, 3.8002680178020687`*^9}, {
   3.800268110117873*^9, 3.800268175983878*^9}, {3.800272055167983*^9, 
   3.8002720941906223`*^9}, {3.800272154503175*^9, 3.800272165355184*^9}, {
   3.8002722043340387`*^9, 3.800272205062715*^9}, {3.800272252533046*^9, 
   3.800272252708578*^9}, 3.800272294893321*^9, {3.800272335868238*^9, 
   3.8002723678647738`*^9}, {3.800272428882372*^9, 3.800272450103487*^9}, {
   3.800273710915286*^9, 3.8002737119013367`*^9}, 3.8002738967885113`*^9, {
   3.800274314423748*^9, 
   3.800274343886526*^9}},ExpressionUUID->"bb190453-d07f-4802-8732-\
909c1a7c07ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"\[FilledCircle] Exercise 1: Particle on a ring, path \
integral\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Decompose partitian function \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Z", "\[Rule]", 
           TemplateBox[{SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
                TemplateBox[{
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"\[Theta]", "[", 
                    StyleBox["\"topological term\"", 
                    RGBColor[0, 
                    Rational[2, 3], 0], FontFamily -> "Helvetica", 
                    StripOnInput -> False], "]"}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                    RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", "m", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
                    ")"}], "\[Tau]", "0", "\[Beta]"}, "InactiveIntegrate", 
                 DisplayFunction -> (RowBox[{
                    SubsuperscriptBox[
                    StyleBox["\[Integral]", "Inactive"], #3, #4], 
                    RowBox[{#, 
                    RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ), 
                 InterpretationFunction -> (RowBox[{
                    RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                    RowBox[{#, ",", 
                    RowBox[{"{", 
                    RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]],
             "\[Phi]"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], "}"}], "[", 
         StyleBox["\<\"Euclidean path integral for particle on a ring.\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]", "\[Rule]", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", "\[Pi]", " ", "\[Tau]", " ", 
              RowBox[{"Q", "[", 
               StyleBox["\<\"winding number, \[DoubleStruckCapitalZ]\"\>",
                StripOnInput->False,
                LineColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FrontFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                BackFaceColor->RGBColor[0, 
                  Rational[2, 3], 0],
                GraphicsColor->RGBColor[0, 
                  Rational[2, 3], 0],
                FontFamily->"Helvetica",
                FontColor->RGBColor[0, 
                  Rational[2, 3], 0]], "]"}]}], "\[Beta]"], "+", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox[
               UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
               TagBox[GridBox[{
                  {"l"}
                 },
                 DefaultBaseStyle->"Column",
                 GridBoxAlignment->{"Columns" -> {{Left}}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                "Column"]], "[", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]", " ", 
                  "\[Tau]"}], "\[Beta]"]], " ", 
               SubscriptBox["\[Phi]", "l"]}], "]"}],
             $CellContext`xSum[
             E^(Complex[0, 2] $CellContext`l 
                Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau]) 
              Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
             
             Editable->False,
             SyntaxForm->Automatic]}]}], "}"}], "[", 
         StyleBox["\<\"l-decomposition\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]},
       {""}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"as sum over topological sectors.\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", "Z"}], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "m", " ", 
            SuperscriptBox["\[Pi]", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}], "+", 
         FractionBox[
          RowBox[{"2", " ", "m", " ", 
           SuperscriptBox["\[Pi]", "2"], " ", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {"l2"}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             InterpretationBox[
              RowBox[{
               UnderscriptBox[
                UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
                TagBox[GridBox[{
                   {"l"}
                  },
                  DefaultBaseStyle->"Column",
                  GridBoxAlignment->{"Columns" -> {{Left}}},
                  
                  GridBoxItemSize->{
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                 "Column"]], "[", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], ")"}],
                   " ", "l", " ", "l2", " ", 
                  SubscriptBox["\[Phi]", "l"], " ", 
                  SubscriptBox["\[Phi]", "l2"]}], 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], "]"}],
              $CellContext`xSum[Complex[0, 
                 Rational[-1, 2]] (-1 + 
                E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
                  Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
               Subscript[$CellContext`\[Phi], $CellContext`l2], \
$CellContext`l],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`xSum[
             $CellContext`xSum[Complex[0, 
                Rational[-1, 2]] (-1 + 
               E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
                 Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
              Subscript[$CellContext`\[Phi], $CellContext`l2], \
$CellContext`l], $CellContext`l2],
            Editable->False,
            SyntaxForm->Automatic]}], "\[Beta]"]}]], ",", "\[Phi]", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"l", "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}]}], "]"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"The term \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2", ",", "3", ",", "5"}], "}"}], 
       "\[Rule]", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox[
          UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
          TagBox[GridBox[{
             {"l2"}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Column"]], "[", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox[
            UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
            TagBox[GridBox[{
               {"l"}
              },
              DefaultBaseStyle->"Column",
              GridBoxAlignment->{"Columns" -> {{Left}}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Column"]], "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], ")"}], 
              " ", "l", " ", "l2", " ", 
              SubscriptBox["\[Phi]", "l"], " ", 
              SubscriptBox["\[Phi]", "l2"]}], 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"l", "+", "l2"}], ")"}], " ", "\[Pi]"}]]}], "]"}],
          $CellContext`xSum[Complex[0, 
             Rational[-1, 2]] (-1 + 
            E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
              Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
           Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`xSum[
         $CellContext`xSum[Complex[0, 
            Rational[-1, 2]] (-1 + 
           E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
             Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
          Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l], \
$CellContext`l2],
        Editable->False,
        SyntaxForm->Automatic]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"is non-zero only when \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{"l", "\[Rule]", 
       RowBox[{"-", "l2"}]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2", ",", "3", ",", "5"}], "}"}], 
       "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
           TagBox[GridBox[{
              {"l"}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           SubsuperscriptBox["\[Phi]", "l", "2"]}], "]"}],
         $CellContext`xSum[$CellContext`l^2 
          Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l],
         Editable->False,
         SyntaxForm->Automatic]}]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[Implies] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", "Z"}], "\[Rule]", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "m", " ", 
            SuperscriptBox["\[Pi]", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}], "-", 
         FractionBox[
          RowBox[{"2", " ", "m", " ", 
           SuperscriptBox["\[Pi]", "2"], " ", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {"l"}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              SuperscriptBox["l", "2"], " ", 
              SubsuperscriptBox["\[Phi]", "l", "2"]}], "]"}],
            $CellContext`xSum[$CellContext`l^2 
             Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l],
            Editable->False,
            SyntaxForm->Automatic]}], "\[Beta]"]}]], ",", "\[Phi]", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"l", "\[Element]", 
         TemplateBox[{},
          "Integers"]}]}]}], "]"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n.......\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     FrameBox[
      RowBox[{
       RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox["\[Pi]", "2"], " ", 
             SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}]}]], " ", 
        InterpretationBox[
         RowBox[{
          UnderscriptBox[
           UnderscriptBox["\<\"\[Product]\"\>", "_"], 
           TagBox[GridBox[{
              {"l"}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"]], "[", 
          FractionBox[
           RowBox[{
            SqrtBox["\[Beta]"], " ", 
            RowBox[{"Erf", "[", 
             FractionBox[
              RowBox[{
               SqrtBox["2"], " ", "l", " ", 
               SqrtBox["m"], " ", "\[Pi]", " ", 
               SubscriptBox["\[Phi]", "l"]}], 
              SqrtBox["\[Beta]"]], "]"}]}], 
           RowBox[{"2", " ", "l", " ", 
            SqrtBox["m"], " ", 
            SqrtBox[
             RowBox[{"2", " ", "\[Pi]"}]]}]], "]"}],
         $CellContext`xProduct[
         Rational[1, 2] $CellContext`l^(-1) $CellContext`m^
           Rational[-1, 2] (2 Pi)^Rational[-1, 2] $CellContext`\[Beta]^
           Rational[1, 2] 
          Erf[2^Rational[1, 2] $CellContext`l $CellContext`m^Rational[1, 2] 
            Pi $CellContext`\[Beta]^Rational[-1, 2] 
            Subscript[$CellContext`\[Phi], $CellContext`l]], $CellContext`l],
         Editable->False,
         SyntaxForm->Automatic]}]}],
      StripOnInput->False], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"The total partitian function \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"Z", "\[Rule]", 
      InterpretationBox[
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
         TagBox[GridBox[{
            {"Q"}
           },
           DefaultBaseStyle->"Column",
           GridBoxAlignment->{"Columns" -> {{Left}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Column"]], "[", 
        RowBox[{"Z", "[", "Q", "]"}], "]"}],
       $CellContext`xSum[
        $CellContext`Z[$CellContext`Q], $CellContext`Q],
       Editable->False,
       SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
     StyleBox["\<\" where the \[CapitalTheta] terms can be written as Cos[Q \
\[Theta]]'s\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1]}]}]}],
  SequenceForm[
   Style["\[FilledCircle] Exercise 1: Particle on a ring, path integral", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Decompose partitian function ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      {$CellContext`Z -> 
       Inactive[Integrate][E^(-Inactive[Integrate][Complex[0, 
               Rational[-1, 2]] Pi^(-1) $CellContext`\[Theta][
               Style["topological term", 
                RGBColor[0, 
                 Rational[2, 3], 0], FontFamily -> 
                "Helvetica"]] $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
            Rational[
              1, 2] $CellContext`m $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2, \
{$CellContext`\[Tau], 0, $CellContext`\[Beta]}]), $CellContext`\[Phi]]}[
       Style["Euclidean path integral for particle on a ring.", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      {$CellContext`\[Phi] -> 
       2 Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau] $CellContext`Q[
           Style["winding number, \[DoubleStruckCapitalZ]", 
            RGBColor[0, 
             Rational[2, 3], 0], FontFamily -> 
            "Helvetica"]] + $CellContext`xSum[
         E^(Complex[0, 2] $CellContext`l 
            Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau]) 
          Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l]}[
       Style["l-decomposition", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {Null}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["as sum over topological sectors.", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`Z -> 
   Integrate[
    E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
      Complex[0, 1] $CellContext`Q $CellContext`\[Theta] + 
      2 $CellContext`m Pi^2 $CellContext`\[Beta]^(-1) $CellContext`xSum[
         $CellContext`xSum[Complex[0, 
            Rational[-1, 2]] (-1 + 
           E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
             Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
          Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l], \
$CellContext`l2]), $CellContext`\[Phi], Assumptions -> 
     Element[$CellContext`l, Integers]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The term ", 
    RGBColor[0.7, 0, 1, 1], Larger], {{2, 1, 2, 3, 5} -> $CellContext`xSum[
      $CellContext`xSum[Complex[0, 
         Rational[-1, 2]] (-1 + 
        E^(Complex[0, 2] ($CellContext`l + $CellContext`l2) 
          Pi)) $CellContext`l $CellContext`l2 ($CellContext`l + \
$CellContext`l2)^(-1) Pi^(-1) Subscript[$CellContext`\[Phi], $CellContext`l] 
       Subscript[$CellContext`\[Phi], $CellContext`l2], $CellContext`l], \
$CellContext`l2]}, 
   Style["is non-zero only when ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`l -> -$CellContext`l2}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], {{2, 1, 2, 3, 
     5} -> -$CellContext`xSum[$CellContext`l^2 
       Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l]}, 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`Z -> 
   Integrate[
    E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
      Complex[0, 1] $CellContext`Q $CellContext`\[Theta] - 2 $CellContext`m 
      Pi^2 $CellContext`\[Beta]^(-1) $CellContext`xSum[$CellContext`l^2 
        Subscript[$CellContext`\[Phi], $CellContext`l]^2, $CellContext`l]), \
$CellContext`\[Phi], Assumptions -> Element[$CellContext`l, Integers]], 
   Style["\n.......", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[$CellContext`Z[$CellContext`Q] -> 
    E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
       Complex[0, 
          1] $CellContext`Q $CellContext`\[Theta]) $CellContext`xProduct[
      Rational[1, 2] $CellContext`l^(-1) $CellContext`m^
        Rational[-1, 2] (2 Pi)^Rational[-1, 2] $CellContext`\[Beta]^
        Rational[1, 2] 
       Erf[2^Rational[1, 2] $CellContext`l $CellContext`m^Rational[1, 2] 
         Pi $CellContext`\[Beta]^Rational[-1, 2] 
         Subscript[$CellContext`\[Phi], $CellContext`l]], $CellContext`l]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The total partitian function ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`Z -> $CellContext`xSum[
     $CellContext`Z[$CellContext`Q], $CellContext`Q], 
   Style[" where the \[CapitalTheta] terms can be written as Cos[Q \
\[Theta]]'s", 
    RGBColor[0.7, 0, 1, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8002721683756247`*^9, {3.80027224147068*^9, 3.800272255625533*^9}, 
   3.800272297833983*^9, 3.800272439463949*^9, 3.800273715772994*^9, 
   3.800273899509541*^9, {3.800274328554344*^9, 
   3.8002743463431673`*^9}},ExpressionUUID->"c4cd1c3c-c62e-44be-8d73-\
f5430591e6cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<The Hamiltonian inferred from the partition function: \>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"e", "[", "13", "]"}], "//", 
      RowBox[{"tuRuleSelect", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Z", ",", 
          RowBox[{"S", "[", "\[Phi]", "]"}]}], "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "xSum", "}"}]}], "]"}]}]}], ";", 
    RowBox[{"$", "[", 
     RowBox[{"CG", "[", "\"\<general Z expression\>\"", "]"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Current expression \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$0", "//", 
      RowBox[{"tuRuleSelect", "[", "Z", "]"}]}], "//", "First"}]}], ",", 
   "\[IndentingNewLine]", "imply", ",", 
   RowBox[{"$l", "=", 
    RowBox[{"L", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"$", "//", "tuExtractIntegrand"}], "//", "Last"}], ")"}]}]}], 
   ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Apply Hamiltonian expressions \>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"H", "\[Rule]", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}]}], "-", "L"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "\[Rule]", 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"L", ",", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "imply", ",", 
   RowBox[{
    RowBox[{"$pass", "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"$s", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tuRuleSelect", "[", "p", "]"}], "[", 
             RowBox[{"{", "$", "}"}], "]"}], "//.", 
            RowBox[{
             RowBox[{"tuRuleSelect", "[", 
              RowBox[{"{", "L", "}"}], "]"}], "[", 
             RowBox[{"{", 
              RowBox[{"$", ",", "$l"}], "}"}], "]"}]}], "//", 
           RowBox[{"tuDerivativeExpand", "[", 
            RowBox[{"{", 
             RowBox[{"m", ",", "\[Theta]"}], "}"}], "]"}]}], "//", 
          "First"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tuRuleSelect", "[", "H", "]"}], "[", 
             RowBox[{"{", "$", "}"}], "]"}], "//.", 
            RowBox[{
             RowBox[{"tuRuleSelect", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "L"}], "}"}], "]"}], "[", 
             RowBox[{"{", 
              RowBox[{"$", ",", "$l"}], "}"}], "]"}]}], "//", 
           RowBox[{"tuDerivativeExpand", "[", 
            RowBox[{"{", 
             RowBox[{"m", ",", "\[Theta]"}], "}"}], "]"}]}], "//", 
          "First"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"$s", "=", 
         RowBox[{
          RowBox[{"$s", "//", 
           RowBox[{"tuRuleSolveF", "[", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"_", ",", "\[Tau]"}], "]"}], "]"}]}], "//", "First"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"$", "/.", "$s"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<POFF\>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"(", 
      RowBox[{"$0", "//", 
       RowBox[{"tuRuleSelect", "[", "\[Phi]", "]"}]}], ")"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//", 
     RowBox[{"tuDerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{"l", ",", "Q", ",", 
        SubscriptBox["\[Phi]", "l"], ",", "\[Beta]"}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "Factor"}], "//", 
     RowBox[{"tuSumSimplify", "[", 
      RowBox[{"{", "\[Beta]", "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   "\"\<PONdd\>\"", ",", "\[IndentingNewLine]", "Yield", ",", "$", ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The equation of motion from \>\"", 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$s", "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"CommutatorM", "[", 
          RowBox[{"H", ",", "p"}], "]"}], "\[Rule]", 
         RowBox[{"tuDPartial", "[", 
          RowBox[{"p", ",", "\[Tau]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CommutatorM", "[", 
          RowBox[{"H", ",", "\[Phi]"}], "]"}], "\[Rule]", 
         RowBox[{"tuDPartial", "[", 
          RowBox[{"\[Phi]", ",", "\[Tau]"}], "]"}]}]}], "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
   ",", "\[IndentingNewLine]", "and", ",", 
   RowBox[{"$s1", "=", 
    RowBox[{
     RowBox[{"CommutatorM", "[", 
      RowBox[{"p", ",", "\[Phi]"}], "]"}], "\[Rule]", 
     RowBox[{"-", "I"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"tuRuleSelect", "[", 
           RowBox[{"H", ",", 
            RowBox[{"{", "p", "}"}]}], "]"}], "[", "$pass", "]"}], "/.", 
         RowBox[{
          SuperscriptBox["a_", "2"], "\[Rule]", 
          RowBox[{"a", " ", ".", " ", "a"}]}]}], ")"}]}], "//", 
      RowBox[{"expandDC", "[", 
       RowBox[{
        RowBox[{"{", "$s1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tuCommutatorSimplify", "[", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Theta]", 
              RowBox[{"_", ":", "1"}]], ",", "m", ",", 
             RowBox[{"1", "/", "m"}]}], "}"}], "]"}], ",", "Simplify"}], 
         "}"}]}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "imply", ",", 
   RowBox[{"p", "[", 
    RowBox[{"CG", "[", "\"\<constant\>\"", "]"}], "]"}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[FilledCircle] In \[Phi]-representation \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"I", " ", 
      RowBox[{"tuDPartial", "[", 
       RowBox[{"_", ",", "\[Phi]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$s1", "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"tuRuleSelect", "[", 
          RowBox[{"H", ",", 
           RowBox[{"{", "p", "}"}]}], "]"}], "[", "$pass", "]"}], "/.", 
        "$s"}], "//", "Simplify"}], "//", "tuRule1"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<Stationary Schrodinger equation \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"H", "\[CenterDot]", 
        RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "\[Rule]", 
       RowBox[{"iE", " ", "\[CenterDot]", 
        RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"\[Phi]", "+", 
           RowBox[{"2", "\[Pi]"}]}], "]"}], "\[Rule]", 
         RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "}"}], "[", 
       RowBox[{"CG", "[", "\"\<periodic BC\>\"", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "a_", "]"}], "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", 
         RowBox[{"n", "[", 
          RowBox[{"CG", "[", "\"\<\[DoubleStruckCapitalZ]\>\"", "]"}], "]"}], 
         " ", "a"}], "]"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", "Yield", 
   ",", 
   RowBox[{"$1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", "$s1"}], "/.", 
     RowBox[{
      SuperscriptBox["a_", "2"], "\[Rule]", 
      RowBox[{"a", " ", ".", " ", "a"}]}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{
    RowBox[{"$1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"$1", "//", 
               RowBox[{"tuBlankOpNest", "[", "]"}]}], "//", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "/.", 
                 RowBox[{"(", 
                  RowBox[{"$", "//", 
                   RowBox[{"tuRuleSelect", "[", 
                    RowBox[{
                    RowBox[{"\[Psi]", "[", "_", "]"}], ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ")"}]}], "&"}], 
               ")"}]}], "//", 
             RowBox[{"tuDerivativeExpand", "[", 
              RowBox[{"{", 
               RowBox[{"m", ",", "n", ",", "\[Theta]"}], "}"}], "]"}]}], "//", 
            RowBox[{"expandDot", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "n", ",", "\[Theta]", ",", "iE"}], "}"}], 
              ",", 
              RowBox[{"{", "Simplify", "}"}]}], "]"}]}], "//", 
           "tuRuleRHS0factor"}], "//", "Flatten"}], "//", "Last"}], "//", 
        RowBox[{"tuRuleSolveF", "[", "iE", "]"}]}], "//", "Last"}], "//", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{"iE", "\[Rule]", 
          RowBox[{"iE", "[", "n", "]"}]}]}], "&"}], ")"}]}]}], ";", 
    RowBox[{"$1", "//", "Framed"}]}], ",", 
   RowBox[{"CG", "[", "\"\<spectrum\>\"", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.800272556114271*^9, 3.8002725570162*^9}, {
   3.80027305929729*^9, 3.8002730594400473`*^9}, {3.800273093775132*^9, 
   3.800273094382852*^9}, {3.800273200951399*^9, 3.80027331144753*^9}, {
   3.8002733985719757`*^9, 3.8002735539820023`*^9}, {3.800273674263001*^9, 
   3.800273685084188*^9}, {3.8002737203394747`*^9, 3.8002737205848503`*^9}, {
   3.8002738186063757`*^9, 3.800273828991405*^9}, {3.800274630918676*^9, 
   3.80027472333424*^9}, {3.800275129179201*^9, 3.800275188155387*^9}, {
   3.800275225726973*^9, 3.800275282898719*^9}, {3.800275454570264*^9, 
   3.8002754858487873`*^9}, {3.80027553670332*^9, 3.80027574325887*^9}, {
   3.800275781503283*^9, 3.8002758894227448`*^9}, {3.800275921747672*^9, 
   3.80027592310788*^9}, {3.80027597537782*^9, 3.8002760240786858`*^9}, {
   3.800276099293366*^9, 3.800276100645289*^9}, {3.800276527581325*^9, 
   3.800276540082313*^9}, {3.800276692331287*^9, 3.800276705448359*^9}, {
   3.80027682003751*^9, 3.800276831199464*^9}, {3.8002778292845793`*^9, 
   3.8002778411450157`*^9}, {3.800277924129479*^9, 3.800277948858325*^9}, 
   3.800278108747632*^9, {3.800279332598127*^9, 3.800279360973407*^9}, {
   3.80027947591101*^9, 3.8002794776844053`*^9}, {3.800279517675152*^9, 
   3.800279789825935*^9}, {3.800280977737295*^9, 3.8002810259364147`*^9}, {
   3.800444888880863*^9, 3.800444891430955*^9}, {3.8004449331700697`*^9, 
   3.800444936328865*^9}, {3.800445548625793*^9, 3.80044560789077*^9}, {
   3.8004456410267982`*^9, 3.800445733447754*^9}, {3.800445764541724*^9, 
   3.800445779774959*^9}, {3.8004458744027157`*^9, 3.800445944443844*^9}, 
   3.800446025754282*^9, {3.800447535682645*^9, 3.800447536988099*^9}, {
   3.8004475841891108`*^9, 3.800447631333356*^9}, {3.8004482327697897`*^9, 
   3.800448234357139*^9}, {3.800448438365961*^9, 3.800448445443254*^9}, {
   3.800448482559928*^9, 3.8004485142358227`*^9}, {3.800448974659418*^9, 
   3.800448974802951*^9}, {3.8004490108664427`*^9, 3.8004491632704973`*^9}, {
   3.8004493428295717`*^9, 3.800449458982781*^9}, {3.800455290842366*^9, 
   3.800455487001511*^9}, {3.800456813944031*^9, 3.800456814815226*^9}, {
   3.800456977479889*^9, 3.8004569827653503`*^9}, {3.800457190914209*^9, 
   3.8004571911578817`*^9}, {3.800457296850553*^9, 3.800457319447547*^9}, {
   3.800457373754364*^9, 3.80045738622425*^9}, {3.800457981556498*^9, 
   3.8004580220419397`*^9}, {3.80045806496768*^9, 3.800458068765267*^9}, {
   3.800458100081378*^9, 3.800458121660557*^9}, {3.800458177520063*^9, 
   3.8004581998429337`*^9}, {3.8004582303948383`*^9, 3.80045829433228*^9}, {
   3.800458342446138*^9, 3.800458410038577*^9}, {3.80045844912601*^9, 
   3.800458605887538*^9}, {3.8004586506369677`*^9, 3.80045867948428*^9}, {
   3.800458710507964*^9, 3.80045871757823*^9}, {3.8004587629038677`*^9, 
   3.80045877586931*^9}, {3.800458814449576*^9, 3.80045891762394*^9}, {
   3.800458950314687*^9, 3.80045897288983*^9}, {3.8004590557921867`*^9, 
   3.800459089017662*^9}, {3.800459126286508*^9, 3.8004592504150553`*^9}, {
   3.800459288962324*^9, 3.8004593059511623`*^9}, {3.800459337439273*^9, 
   3.8004596838700733`*^9}, {3.800459751514784*^9, 3.800459782236683*^9}, {
   3.80062998277037*^9, 3.800629984354167*^9}, {3.800630075210861*^9, 
   3.8006300765196457`*^9}, {3.800630115572693*^9, 3.800630121494088*^9}, {
   3.800630159118816*^9, 3.8006301750849037`*^9}, {3.800630396128989*^9, 
   3.8006304069562063`*^9}},ExpressionUUID->"25ef077c-7ff3-4e1f-a767-\
faeda182611c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"The Hamiltonian inferred from the partition function: \"\>",
     
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Z", "\[Rule]", 
        TemplateBox[{SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"S", "[", "\[Phi]", "]"}]}]],"\[Phi]"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
       RowBox[{
        RowBox[{"S", "[", "\[Phi]", "]"}], "\[Rule]", 
        TemplateBox[{RowBox[{"L", "[", 
            RowBox[{"\[Phi]", ",", 
              InterpretationBox[
               RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "\[Phi]",
                  "]"}], 
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
               SyntaxForm -> Automatic, Editable -> False]}], "]"}],"t"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}]}], "}"}], "[", 
     StyleBox["\<\"general Z expression\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], "]"}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Current expression \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", "Z"}], "\[Rule]", 
   RowBox[{
    TemplateBox[{SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               RowBox[{"-", 
                 FractionBox[
                  RowBox[{"\[ImaginaryI]", " ", "\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                  RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
               RowBox[{
                 FractionBox["1", "2"], " ", "m", " ", 
                 SuperscriptBox[
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Tau]"], "[", 
                    "\[Phi]", "]"}], 
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]], 
                   SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
             ")"}], "\[Tau]", "0", "\[Beta]"}, "InactiveIntegrate", 
          DisplayFunction -> (RowBox[{
             SubsuperscriptBox[
              StyleBox["\[Integral]", "Inactive"], #3, #4], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ), 
          InterpretationFunction -> (RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", 
               RowBox[{"{", 
                 RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}]],
      "\[Phi]"},
     "InactiveIntegrate",
     DisplayFunction->(RowBox[{
        StyleBox["\[Integral]", "Inactive"], 
        RowBox[{#, 
          RowBox[{
            StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
     InterpretationFunction->(RowBox[{
        RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
    StyleBox["\<\" \[Implies] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"L", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Theta]", " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
           "\[Phi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
          Editable->False,
          SyntaxForm->Automatic]}], 
        RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "m", " ", 
       SuperscriptBox[
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
          "\[Phi]", "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
         Editable->False,
         SyntaxForm->Automatic], "2"]}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Apply Hamiltonian expressions \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{"H", "\[Rule]", 
         RowBox[{
          RowBox[{"-", "L"}], "+", 
          RowBox[{"p", " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
             "\[Phi]", "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
            Editable->False,
            SyntaxForm->Automatic]}]}]}]},
       {
        RowBox[{"p", "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
             Editable->False,
             SyntaxForm->Automatic]], "[", "L", "]"}],
          $CellContext`tuDDown["\[PartialD]"][$CellContext`L, 
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]],
          Editable->False,
          SyntaxForm->Automatic]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\" \[Implies] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{"p", "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], 
            RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
          RowBox[{"m", " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
             "\[Phi]", "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
            Editable->False,
            SyntaxForm->Automatic]}]}]}]},
       {
        RowBox[{"H", "\[Rule]", 
         RowBox[{
          FractionBox["1", "2"], " ", "m", " ", 
          SuperscriptBox[
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
             "\[Phi]", "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
            Editable->False,
            SyntaxForm->Automatic], "2"]}]}]},
       {
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
           "\[Phi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", 
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", "p", " ", "\[Pi]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]}], 
          RowBox[{"2", " ", "m", " ", "\[Pi]"}]]}]},
       {
        RowBox[{"H", "\[Rule]", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "p", " ", "\[Pi]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]}], ")"}], "2"], 
          RowBox[{"8", " ", "m", " ", 
           SuperscriptBox["\[Pi]", "2"]}]]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n.......\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontFamily->"Helvetica",
     FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"H", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", "m", " ", 
       SuperscriptBox["\[Pi]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Q", "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           InterpretationBox[
            RowBox[{
             UnderscriptBox[
              UnderscriptBox["\<\"\[Sum]\"\>", "_"], 
              TagBox[GridBox[{
                 {"l"}
                },
                DefaultBaseStyle->"Column",
                GridBoxAlignment->{"Columns" -> {{Left}}},
                
                GridBoxItemSize->{
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
               "Column"]], "[", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{
                "2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]", " ", 
                 "\[Tau]"}], "\[Beta]"]], " ", "l", " ", 
              SubscriptBox["\[Phi]", "l"]}], "]"}],
            $CellContext`xSum[
            E^(Complex[0, 2] $CellContext`l 
               Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau]) \
$CellContext`l Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
            Editable->False,
            SyntaxForm->Automatic]}]}], ")"}], "2"]}], 
      SuperscriptBox["\[Beta]", "2"]]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"The equation of motion from \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           RowBox[{"[", "H", ",", "p", "]"}], "-"],
          $CellContext`CommutatorM[$CellContext`H, $CellContext`p],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", "p", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`p, $CellContext`\[Tau]],
          Editable->False,
          SyntaxForm->Automatic]}]},
       {
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           RowBox[{"[", "H", ",", "\[Phi]", "]"}], "-"],
          $CellContext`CommutatorM[$CellContext`H, $CellContext`\[Phi]],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
           "\[Phi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
          Editable->False,
          SyntaxForm->Automatic]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\" and \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     InterpretationBox[
      SubscriptBox[
       RowBox[{"[", "p", ",", "\[Phi]", "]"}], "-"],
      $CellContext`CommutatorM[$CellContext`p, $CellContext`\[Phi]],
      Editable->False,
      SyntaxForm->Automatic], "\[Rule]", 
     RowBox[{"-", "\[ImaginaryI]"}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{"0", "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", "p", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`p, $CellContext`\[Tau]],
          Editable->False,
          SyntaxForm->Automatic]}]},
       {
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "p", " ", 
            "\[Pi]"}], "+", "\[Theta]"}], 
          RowBox[{"2", " ", "m", " ", "\[Pi]"}]], "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
           "\[Phi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
          Editable->False,
          SyntaxForm->Automatic]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\" \[Implies] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"p", "[", 
     StyleBox["\<\"constant\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], "]"}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\[FilledCircle] In \[Phi]-representation \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", "_", 
        "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        Blank[], $CellContext`\[Phi]],
       Editable->False,
       SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"H", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Theta]", "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", "_",
              "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`\[Phi]],
            Editable->False,
            SyntaxForm->Automatic]}]}], ")"}], "2"], 
       RowBox[{"8", " ", "m", " ", 
        SuperscriptBox["\[Pi]", "2"]}]]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Stationary Schrodinger equation \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"H", "\[CenterDot]", 
        RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "\[Rule]", 
       RowBox[{
        StyleBox["\<\"E\"\>",
         StripOnInput->False,
         FontSlant->Italic], "\[CenterDot]", 
        RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Pi]"}], "+", "\[Phi]"}], "]"}], "\[Rule]", 
         RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "}"}], "[", 
       StyleBox["\<\"periodic BC\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "a_", "]"}], "\[Rule]", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", 
         RowBox[{"n", "[", 
          StyleBox["\<\"\[DoubleStruckCapitalZ]\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], "]"}]}]]}]}], "}"}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"2", " ", "\[Pi]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"2", " ", "\[Pi]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", 
              "_", "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Phi]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}]}], 
        RowBox[{"8", " ", "m", " ", 
         SuperscriptBox["\[Pi]", "2"]}]]}], "\[CenterDot]", 
      RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "\[Rule]", 
     RowBox[{
      StyleBox["\<\"E\"\>",
       StripOnInput->False,
       FontSlant->Italic], "\[CenterDot]", 
      RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    FrameBox[
     RowBox[{
      RowBox[{
       StyleBox["\<\"E\"\>",
        StripOnInput->False,
        FontSlant->Italic], "[", "n", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["\[Pi]", "2"]}], "-", 
        RowBox[{
        "2", " ", "\[ImaginaryI]", " ", "n", " ", "\[Pi]", " ", "\[Theta]"}], 
        "-", 
        SuperscriptBox["\[Theta]", "2"]}], 
       RowBox[{"8", " ", "m", " ", 
        SuperscriptBox["\[Pi]", "2"]}]]}],
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\"spectrum\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0, 
       Rational[2, 3], 0],
     FrontFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     BackFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     GraphicsColor->RGBColor[0, 
       Rational[2, 3], 0],
     FontFamily->"Helvetica",
     FontColor->RGBColor[0, 
       Rational[2, 3], 0]]}]}],
  SequenceForm[
   Style["The Hamiltonian inferred from the partition function: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   {$CellContext`Z -> 
    Inactive[Integrate][
     E^(Complex[
        0, 1] $CellContext`S[$CellContext`\[Phi]]), $CellContext`\[Phi]], \
$CellContext`S[$CellContext`\[Phi]] -> Inactive[Integrate][
      $CellContext`L[$CellContext`\[Phi], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]], $CellContext`t]}[
   
    Style["general Z expression", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Current expression ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`Z -> 
   Inactive[Integrate][E^(-Inactive[Integrate][Complex[0, 
           Rational[-1, 2]] 
         Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
        Rational[
          1, 2] $CellContext`m $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2, \
{$CellContext`\[Tau], 0, $CellContext`\[Beta]}]), $CellContext`\[Phi]], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`L -> Complex[0, 
       Rational[-1, 2]] 
     Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
    Rational[1, 2] $CellContext`m $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Apply Hamiltonian expressions ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`H -> -$CellContext`L + $CellContext`p \
$CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]}, \
{$CellContext`p -> $CellContext`tuDDown["\[PartialD]"][$CellContext`L, 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{$CellContext`p -> Complex[0, 
          Rational[-1, 2]] 
        Pi^(-1) $CellContext`\[Theta] + $CellContext`m $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]}, \
{$CellContext`H -> 
      Rational[1, 2] $CellContext`m $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2}, \
{$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] -> 
      Rational[1, 2] $CellContext`m^(-1) 
       Pi^(-1) (2 $CellContext`p Pi + 
        Complex[0, 1] $CellContext`\[Theta])}, {$CellContext`H -> 
      Rational[1, 8] $CellContext`m^(-1) 
       Pi^(-2) (2 $CellContext`p Pi + 
         Complex[0, 1] $CellContext`\[Theta])^2}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n.......", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`H -> 
   2 $CellContext`m 
    Pi^2 $CellContext`\[Beta]^(-2) ($CellContext`Q + 
      Complex[0, 1] $CellContext`xSum[
        E^(Complex[0, 2] $CellContext`l 
           Pi $CellContext`\[Beta]^(-1) $CellContext`\[Tau]) $CellContext`l 
         Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l])^2, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The equation of motion from ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`CommutatorM[$CellContext`H, $CellContext`p] -> \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`p, $CellContext`\[Tau]]}, \
{$CellContext`CommutatorM[$CellContext`H, $CellContext`\[Phi]] -> \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style[" and ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], $CellContext`CommutatorM[$CellContext`p, $CellContext`\[Phi]] -> 
   Complex[0, -1], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{
     0 -> $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`p, $CellContext`\[Tau]]}, {
     Rational[1, 2] $CellContext`m^(-1) 
       Pi^(-1) (
        Complex[0, -2] $CellContext`p 
         Pi + $CellContext`\[Theta]) -> $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   $CellContext`p[
    Style["constant", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[FilledCircle] In \[Phi]-representation ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`p -> 
   Complex[0, 1] $CellContext`tuDDown["\[PartialD]"][
      Blank[], $CellContext`\[Phi]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`H -> 
   Rational[-1, 8] $CellContext`m^(-1) 
    Pi^(-2) ($CellContext`\[Theta] + 
      2 Pi $CellContext`tuDDown["\[PartialD]"][
         Blank[], $CellContext`\[Phi]])^2, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Stationary Schrodinger equation ", 
    RGBColor[0.7, 0, 1, 1], Larger], {CenterDot[$CellContext`H, 
      $CellContext`\[Psi][$CellContext`\[Phi]]] -> CenterDot[
      Style["E", Italic], 
      $CellContext`\[Psi][$CellContext`\[Phi]]], 
    {$CellContext`\[Psi][
      2 Pi + $CellContext`\[Phi]] -> $CellContext`\[Psi][$CellContext`\[Phi]]}[
     Style["periodic BC", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]], $CellContext`\[Psi][
      Pattern[$CellContext`a, 
       Blank[]]] -> E^(Complex[0, 1] $CellContext`a $CellContext`n[
        Style["\[DoubleStruckCapitalZ]", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]])}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   CenterDot[
    Rational[-1, 8] $CellContext`m^(-1) Pi^(-2) 
     Dot[$CellContext`\[Theta] + 2 Pi $CellContext`tuDDown["\[PartialD]"][
          Blank[], $CellContext`\[Phi]], $CellContext`\[Theta] + 
       2 Pi $CellContext`tuDDown["\[PartialD]"][
          Blank[], $CellContext`\[Phi]]], 
     $CellContext`\[Psi][$CellContext`\[Phi]]] -> CenterDot[
     Style["E", Italic], 
     $CellContext`\[Psi][$CellContext`\[Phi]]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[
   Style["E", Italic][$CellContext`n] -> 
    Rational[1, 8] $CellContext`m^(-1) 
     Pi^(-2) (4 $CellContext`n^2 Pi^2 + 
      Complex[0, -2] $CellContext`n 
       Pi $CellContext`\[Theta] - $CellContext`\[Theta]^2)], 
   Style["spectrum", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8002747119636993`*^9, 3.800274723942692*^9}, {
   3.800275135014668*^9, 3.800275188851153*^9}, {3.800275245134542*^9, 
   3.800275284177479*^9}, {3.80027552753321*^9, 3.8002755534951067`*^9}, {
   3.800275602222863*^9, 3.800275744303153*^9}, {3.800275786005864*^9, 
   3.800275890549361*^9}, 3.8002759240430393`*^9, {3.800275984051309*^9, 
   3.8002760247852583`*^9}, 3.800276102169929*^9, {3.8002765290989437`*^9, 
   3.800276540909215*^9}, {3.8002766896209507`*^9, 3.8002767063876762`*^9}, 
   3.800276831956149*^9, 3.8002778419258833`*^9, 3.800277960955101*^9, 
   3.8002781100528297`*^9, {3.800279334605755*^9, 3.800279362692316*^9}, 
   3.800279518808241*^9, {3.800279550611495*^9, 3.8002795579814672`*^9}, {
   3.800279590727515*^9, 3.800279643849834*^9}, {3.8002797122380857`*^9, 
   3.800279721134872*^9}, {3.800279752205954*^9, 3.8002797596718063`*^9}, 
   3.8002797908032207`*^9, {3.8002810197495937`*^9, 3.800281026829994*^9}, 
   3.800444898242593*^9, 3.8004449380956097`*^9, 3.800445554650239*^9, 
   3.800445609057732*^9, {3.800445680872176*^9, 3.80044574499291*^9}, 
   3.800445780566926*^9, {3.800445907673067*^9, 3.8004459455861797`*^9}, 
   3.800446031278706*^9, 3.800447538725586*^9, {3.800447611660598*^9, 
   3.800447633945607*^9}, 3.80044823549326*^9, 3.800448446619589*^9, 
   3.8004485154148912`*^9, 3.800448975540283*^9, 3.8004490365561113`*^9, {
   3.800449085250128*^9, 3.800449164366631*^9}, {3.8004494012082043`*^9, 
   3.8004494600619373`*^9}, {3.800455404606226*^9, 3.800455433240987*^9}, {
   3.800455471960973*^9, 3.8004554879315042`*^9}, 3.800456984220199*^9, 
   3.800457387154194*^9, {3.800458009181016*^9, 3.800458022955509*^9}, 
   3.800458069716906*^9, 3.800458122972726*^9, {3.800458187679693*^9, 
   3.8004582010259457`*^9}, {3.8004582716131487`*^9, 
   3.8004582957096453`*^9}, {3.80045836512962*^9, 3.8004584112612762`*^9}, {
   3.800458506542036*^9, 3.800458518073757*^9}, {3.800458570644618*^9, 
   3.800458581837555*^9}, 3.8004586808405333`*^9, 3.80045877846839*^9, 
   3.800458823577379*^9, {3.800458862993312*^9, 3.800458876096874*^9}, 
   3.800458976694446*^9, 3.8004590590111017`*^9, 3.800459090050975*^9, {
   3.8004591361637077`*^9, 3.800459190071268*^9}, 3.800459221500635*^9, 
   3.800459252131418*^9, {3.800459290615446*^9, 3.800459307378196*^9}, 
   3.800459342286137*^9, {3.800459377283288*^9, 3.800459420988741*^9}, {
   3.8004594680398207`*^9, 3.800459606827074*^9}, {3.800459645747775*^9, 
   3.800459684796567*^9}, 3.800459752913957*^9, 3.8004597835697517`*^9, 
   3.800629987026347*^9, 3.800630084805969*^9, 3.800630126060424*^9, 
   3.80063017660177*^9, 
   3.8006304080908413`*^9},ExpressionUUID->"9316f33d-fe97-4e9b-9b0f-\
22447c6fbf56"]
}, Open  ]],

Cell["Exercise 2: Spin 1/2 from a particle on a ring", "Text",
 CellChangeTimes->{{3.792937577737143*^9, 3.7929375793279333`*^9}, {
  3.792937624231036*^9, 
  3.792937642833475*^9}},ExpressionUUID->"d098bf65-1821-4694-9914-\
5b7f48909d14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Calculate the partition function \>\"", ",", "$pass1", ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<\[Bullet] For the case \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$pass1", "/.", 
       RowBox[{
        RowBox[{"xProduct", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"xProduct", "[", 
         RowBox[{
          RowBox[{"Limit", "[", 
           RowBox[{"a", ",", " ", 
            RowBox[{"$s", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "b"}], "]"}]}]}], "/.",
       "$s"}], "//", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Q", "\[Element]", "Integers"}]}], "]"}], "&"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[Bullet] For the case \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Rule]", 
       RowBox[{"\[Pi]", "+", 
        RowBox[{"m", "/", "\[Beta]"}]}]}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$pass1", "/.", 
       RowBox[{
        RowBox[{"xProduct", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"xProduct", "[", 
         RowBox[{
          RowBox[{"Limit", "[", 
           RowBox[{"a", ",", " ", 
            RowBox[{"$s", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "b"}], "]"}]}]}], "/.",
       "$s"}], "//", 
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Q", "\[Element]", "Integers"}]}], "]"}], "&"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
   "CR", "[", "\"\<What is interpretation of (\[Theta]-\[Pi])/m?\>\"", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.79293764709965*^9, 3.792937650687895*^9}, {
   3.792937699738865*^9, 3.792938097520295*^9}, {3.7929382318587627`*^9, 
   3.792938240832377*^9}, {3.7929382909169493`*^9, 3.7929383455698433`*^9}, 
   3.7930186074974623`*^9, {3.793019397692451*^9, 3.793019488784079*^9}, {
   3.7930195301193113`*^9, 3.7930195838129263`*^9}, {3.793019697328292*^9, 
   3.793019707046554*^9}, 3.793019784382093*^9, {3.79301981539219*^9, 
   3.7930198481833057`*^9}, 3.793278230463563*^9, {3.800464506464903*^9, 
   3.800464540087475*^9}, {3.800630480564803*^9, 
   3.8006304937622766`*^9}},ExpressionUUID->"b1beca73-91e5-45ef-8abc-\
1deb8635bf8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Calculate the partition function \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "m", " ", 
          SuperscriptBox["\[Pi]", "2"], " ", 
          SuperscriptBox["Q", "2"]}], "\[Beta]"]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "Q", " ", "\[Theta]"}]}]], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Product]\"\>", "_"], 
        TagBox[GridBox[{
           {"l"}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       FractionBox[
        RowBox[{
         SqrtBox["\[Beta]"], " ", 
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{
            SqrtBox["2"], " ", "l", " ", 
            SqrtBox["m"], " ", "\[Pi]", " ", 
            SubscriptBox["\[Phi]", "l"]}], 
           SqrtBox["\[Beta]"]], "]"}]}], 
        RowBox[{"2", " ", "l", " ", 
         SqrtBox["m"], " ", 
         SqrtBox[
          RowBox[{"2", " ", "\[Pi]"}]]}]], "]"}],
      $CellContext`xProduct[
      Rational[1, 2] $CellContext`l^(-1) $CellContext`m^
        Rational[-1, 2] (2 Pi)^Rational[-1, 2] $CellContext`\[Beta]^
        Rational[1, 2] 
       Erf[2^Rational[1, 2] $CellContext`l $CellContext`m^Rational[1, 2] 
         Pi $CellContext`\[Beta]^Rational[-1, 2] 
         Subscript[$CellContext`\[Phi], $CellContext`l]], $CellContext`l],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] For the case \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", "\[Pi]"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "Q"], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Product]\"\>", "_"], 
        TagBox[GridBox[{
           {"l"}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       SubscriptBox["\[Phi]", "l"], "]"}],
      $CellContext`xProduct[
       Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] For the case \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"\[Pi]", "+", 
       FractionBox["m", "\[Beta]"]}]}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Z", "[", "Q", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "Q", " ", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", "+", 
         FractionBox["m", "\[Beta]"]}], ")"}]}]], " ", 
     InterpretationBox[
      RowBox[{
       UnderscriptBox[
        UnderscriptBox["\<\"\[Product]\"\>", "_"], 
        TagBox[GridBox[{
           {"l"}
          },
          DefaultBaseStyle->"Column",
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Column"]], "[", 
       SubscriptBox["\[Phi]", "l"], "]"}],
      $CellContext`xProduct[
       Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"What is interpretation of (\[Theta]-\[Pi])/m?\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["Calculate the partition function ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`Z[$CellContext`Q] -> 
   E^((-2) $CellContext`m Pi^2 $CellContext`Q^2/$CellContext`\[Beta] + 
      Complex[0, 
         1] $CellContext`Q $CellContext`\[Theta]) $CellContext`xProduct[
     Rational[1, 2] $CellContext`l^(-1) $CellContext`m^Rational[-1, 2] (2 Pi)^
       Rational[-1, 2] $CellContext`\[Beta]^Rational[1, 2] 
      Erf[2^Rational[1, 2] $CellContext`l $CellContext`m^Rational[1, 2] 
        Pi $CellContext`\[Beta]^Rational[-1, 2] 
        Subscript[$CellContext`\[Phi], $CellContext`l]], $CellContext`l], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] For the case ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`m -> 
    0, $CellContext`\[Theta] -> Pi}, 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 
     1]], $CellContext`Z[$CellContext`Q] -> (-1)^$CellContext`Q \
$CellContext`xProduct[
      Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] For the case ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`m -> 
    0, $CellContext`\[Theta] -> Pi + $CellContext`m/$CellContext`\[Beta]}, 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`Z[$CellContext`Q] -> 
   E^(Complex[0, 1] $CellContext`Q (
       Pi + $CellContext`m/$CellContext`\[Beta])) $CellContext`xProduct[
      Subscript[$CellContext`\[Phi], $CellContext`l], $CellContext`l], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["What is interpretation of (\[Theta]-\[Pi])/m?", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188540533762*^9, 3.8001888991693277`*^9, 
  3.800267844445628*^9, 3.800464485579589*^9, 3.800464540885685*^9, 
  3.800630494724204*^9},ExpressionUUID->"47e1ad5c-e301-4686-9b1d-\
b7535ee0794f"]
}, Open  ]],

Cell["Exercise 3: Metric independence of the topological term", "Text",
 CellChangeTimes->{{3.793020311910426*^9, 
  3.7930203321474857`*^9}},ExpressionUUID->"09a1e7d1-0130-4191-b007-\
6c162d63a6a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"$0", "=", 
           RowBox[{"S", "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"tuDPartial", "[", 
                   RowBox[{"\[Phi]", ",", 
                    SubscriptBox["t", "p"]}], "]"}], "2"], "/", "2"}]}], "-", 
               
               RowBox[{"\[Theta]", " ", 
                RowBox[{
                 RowBox[{"tuDPartial", "[", 
                  RowBox[{"\[Phi]", ",", 
                   SubscriptBox["t", "p"]}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], ",", 
              SubscriptBox["t", "p"]}], "]"}]}]}], ",", 
          RowBox[{
           SubscriptBox["t", "p"], "[", 
           RowBox[{"CG", "[", "\"\<proper time\>\"", "]"}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "[", 
        RowBox[{"CG", "[", "\"\<particle on a ring\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$s", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["t", "p"], "\[Rule]", 
            RowBox[{"f", "[", "t", "]"}]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", "\"\<dd\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "->", 
            SuperscriptBox[
             RowBox[{"tuDPartial", "[", 
              RowBox[{"f", ",", 
               SubscriptBox["t", "p"]}], "]"}], "2"]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", "\"\<uu\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "->", 
            SuperscriptBox[
             RowBox[{"tuDPartial", "[", 
              RowBox[{"f", ",", 
               SubscriptBox["t", "p"]}], "]"}], 
             RowBox[{"-", "2"}]]}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<reparametrization\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$tmp", "=", 
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{"$0", "/.", 
             RowBox[{
              RowBox[{"tuRuleSelect", "[", 
               SubscriptBox["t", "p"], "]"}], "[", "$s", "]"}]}], "/.", 
            RowBox[{"tuDChain", "[", "t", "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"$", "=", 
          RowBox[{
           RowBox[{"$", "/.", 
            RowBox[{
             RowBox[{"tuDPartial", "[", 
              RowBox[{"a_", ",", 
               RowBox[{"b", ":", 
                RowBox[{"f", "[", "t", "]"}]}]}], "]"}], "\[Rule]", 
             RowBox[{"1", "/", 
              RowBox[{"tuDPartial", "[", 
               RowBox[{"b", ",", "a"}], "]"}]}]}]}], "/.", 
           RowBox[{
            RowBox[{"xIntegral", "[", 
             RowBox[{"a_", ",", 
              RowBox[{"f", "[", "t", "]"}]}], "]"}], "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{"a", " ", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"det", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], "]"}]}], 
              ",", "t"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"$", "=", 
          RowBox[{
           RowBox[{"$", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"tuDPartial", "[", 
               RowBox[{
                RowBox[{"f", "[", "t", "]"}], ",", "t"}], "]"}], "\[Rule]", 
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"T", "[", 
                 RowBox[{"g", ",", "\"\<uu\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}]}], 
             "}"}]}], "//", "ExpandAll"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"CG", "[", 
          RowBox[{"\"\<In this 1-dim case we have: \>\"", ",", 
           RowBox[{"$s", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"det", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], "]"}], "->", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"T", "[", 
                 RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<uu\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"g", ",", "\"\<dd\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}]}], 
               "\[Rule]", "1"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"$0", "=", 
          RowBox[{"$", "=", 
           RowBox[{"$", "//.", "$s"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "CG", "[", 
          "\"\<We can identify the energy-momentum tensor in the variation \>\
\"", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tuDDown", "[", "\[Delta]", "]"}], "[", 
              RowBox[{"#", ",", 
               RowBox[{"T", "[", 
                RowBox[{"g", ",", "\"\<uu\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}], "&"}], "/@",
             "$"}], "//", 
           RowBox[{"tuOpSwitch", "[", 
            RowBox[{
             RowBox[{"tuDDown", "[", "\[Delta]", "]"}], ",", "xIntegral"}], 
            "]"}]}], "//", 
          RowBox[{"tuDerivativeExpand", "[", 
           RowBox[{"{", 
            RowBox[{"m", ",", "\[Theta]", ",", 
             RowBox[{"T", "[", 
              RowBox[{"g", ",", "\"\<dd\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793020334846607*^9, 3.793020689098186*^9}, {
   3.793020750114662*^9, 3.793020894184762*^9}, {3.7930209260897427`*^9, 
   3.793020927323574*^9}, {3.793021241251843*^9, 3.79302124340096*^9}, {
   3.7930217335394506`*^9, 3.793021734612875*^9}, {3.7930220666610613`*^9, 
   3.793022067066424*^9}, {3.793022187470257*^9, 3.793022188146933*^9}, {
   3.79302233808463*^9, 3.793022477165594*^9}, {3.793022520755128*^9, 
   3.7930225244278593`*^9}, 3.79302256347036*^9, {3.793023165716672*^9, 
   3.793023205594109*^9}, {3.793023236372385*^9, 3.793023274415681*^9}, {
   3.793023342438849*^9, 3.793023369720028*^9}, {3.793023479136895*^9, 
   3.793023505926423*^9}, {3.793023573954471*^9, 3.793023594997451*^9}, 
   3.793023658829533*^9, 3.79302370973116*^9, {3.7930237430122757`*^9, 
   3.7930237437577887`*^9}, {3.793023777095771*^9, 3.793023779991288*^9}, {
   3.7930238433381777`*^9, 3.7930238506360273`*^9}, {3.79302400152182*^9, 
   3.793024098517309*^9}, {3.793024145246372*^9, 3.793024531228814*^9}, {
   3.793024591184293*^9, 3.7930247167257566`*^9}, {3.793024785894046*^9, 
   3.793024874035241*^9}, {3.793024905060166*^9, 3.793024905538859*^9}, {
   3.793024939595728*^9, 3.7930249652062693`*^9}, {3.793024999986949*^9, 
   3.7930250120549097`*^9}, {3.793197571367609*^9, 3.79319757496856*^9}, {
   3.800634521271378*^9, 
   3.800634522275666*^9}},ExpressionUUID->"9a9bf8d8-3cbb-498a-bc24-\
7107bccb6953"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"S", "\[Rule]", 
           TemplateBox[{RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", 
                   FractionBox[
                    RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    SubscriptBox["t", "p"]], "[", "\[Phi]", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 
                    Subscript[$CellContext`t, $CellContext`p]], SyntaxForm -> 
                    Automatic, Editable -> False]}], 
                    RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                 RowBox[{
                   FractionBox["1", "2"], " ", "m", " ", 
                   SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    SubscriptBox["t", "p"]], "[", "\[Phi]", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 
                    Subscript[$CellContext`t, $CellContext`p]], SyntaxForm -> 
                    Automatic, Editable -> False], "2"]}]}], ")"}],
             SubscriptBox["t", "p"]},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]},
         {
          RowBox[{
           SubscriptBox["t", "p"], "[", 
           StyleBox["\<\"proper time\"\>",
            StripOnInput->False,
            LineColor->RGBColor[0, 
              Rational[2, 3], 0],
            FrontFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            BackFaceColor->RGBColor[0, 
              Rational[2, 3], 0],
            GraphicsColor->RGBColor[0, 
              Rational[2, 3], 0],
            FontFamily->"Helvetica",
            FontColor->RGBColor[0, 
              Rational[2, 3], 0]], "]"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"particle on a ring\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox["t", "p"], "\[Rule]", 
           RowBox[{"f", "[", "t", "]"}]}]},
         {
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["g", 
             RowBox[{"0", "0"}], 
             StyleBox[
              RowBox[{"0", "0"}],
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[Rule]", 
           SuperscriptBox[
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
               SubscriptBox["t", "p"]], "[", "f", "]"}],
             $CellContext`tuDDown["\[PartialD]"][$CellContext`f, 
              Subscript[$CellContext`t, $CellContext`p]],
             Editable->False,
             SyntaxForm->Automatic], "2"]}]},
         {
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["g", 
             StyleBox[
              RowBox[{"0", "0"}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"0", "0"}]],
            $CellContext`Tensor[$CellContext`g, {0, 
             0}, {$CellContext`Void, $CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[Rule]", 
           FractionBox["1", 
            SuperscriptBox[
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                SubscriptBox["t", "p"]], "[", "f", "]"}],
              $CellContext`tuDDown["\[PartialD]"][$CellContext`f, 
               Subscript[$CellContext`t, $CellContext`p]],
              Editable->False,
              SyntaxForm->Automatic], "2"]]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"reparametrization\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     TagBox[GridBox[{
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    RowBox[{"f", "[", "t", "]"}]], "[", "t", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`t, 
                    $CellContext`f[$CellContext`t]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                RowBox[{
                  FractionBox["1", "2"], " ", "m", " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], 
                    RowBox[{"f", "[", "t", "]"}]], "[", "t", "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`t, 
                    $CellContext`f[$CellContext`t]], SyntaxForm -> Automatic, 
                    Editable -> False], "2"], " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
              ")"}],RowBox[{"f", "[", "t", "]"}]},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{
              SqrtBox[
               RowBox[{"det", "[", 
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   RowBox[{"0", "0"}], 
                   RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                  $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                  BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}]], 
              " ", 
              RowBox[{"(", 
                RowBox[{
                  FractionBox[
                   RowBox[{"m", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}], 
                   RowBox[{"2", " ", 
                    SuperscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    RowBox[{"f", "[", "t", "]"}], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`f[$CellContext`t], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]], "-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    RowBox[{"f", "[", "t", "]"}], "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`f[$CellContext`t], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}]]}], ")"}]}],
            "t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    SqrtBox[
                    RowBox[{"det", "[", 
                    InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{"0", "0"}], 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}]],
                     " ", 
                    SqrtBox[
                    InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"0", "0"}]], 
                    $CellContext`Tensor[$CellContext`g, {0, 
                    0}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                    False, BaseStyle -> {AutoMultiplicationSymbol -> False}]],
                     " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                RowBox[{
                  FractionBox["1", "2"], " ", "m", " ", 
                  SqrtBox[
                   RowBox[{"det", "[", 
                    InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{"0", "0"}], 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}]],
                   " ", 
                  InterpretationBox[
                   SubsuperscriptBox["g", 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"0", "0"}]], 
                   $CellContext`Tensor[$CellContext`g, {0, 
                    0}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                   False, BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
              ")"}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         StyleBox["\<\"In this 1-dim case we have: \"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]},
        {
         StyleBox[
          TagBox[GridBox[{
             {
              RowBox[{
               SqrtBox[
                RowBox[{"det", "[", 
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   RowBox[{"0", "0"}], 
                   StyleBox[
                    RowBox[{"0", "0"}],
                    StripOnInput->False,
                    ShowContents->False]],
                  $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], "]"}]], "\[Rule]", 
               SqrtBox[
                InterpretationBox[
                 SubsuperscriptBox["g", 
                  RowBox[{"0", "0"}], 
                  StyleBox[
                   RowBox[{"0", "0"}],
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False]]}]},
             {
              RowBox[{
               RowBox[{
                SqrtBox[
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   StyleBox[
                    RowBox[{"0", "0"}],
                    StripOnInput->False,
                    ShowContents->False], 
                   RowBox[{"0", "0"}]],
                  $CellContext`Tensor[$CellContext`g, {0, 
                   0}, {$CellContext`Void, $CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]], " ", 
                SqrtBox[
                 InterpretationBox[
                  SubsuperscriptBox["g", 
                   RowBox[{"0", "0"}], 
                   StyleBox[
                    RowBox[{"0", "0"}],
                    StripOnInput->False,
                    ShowContents->False]],
                  $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]]}], "\[Rule]", "1"}]}
            },
            AutoDelete->False,
            FrameStyle->Directive[
              RGBColor[0.7, 0, 1, 1], 
              Thickness[Tiny]],
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           "Grid"],
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]},
        {
         RowBox[{"S", "\[Rule]", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[Theta]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False]}], 
                   RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
                RowBox[{
                  FractionBox["1", "2"], " ", "m", " ", 
                  InterpretationBox[
                   SubsuperscriptBox["g", 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"0", "0"}]], 
                   $CellContext`Tensor[$CellContext`g, {0, 
                    0}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                   False, BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  " ", 
                  SqrtBox[
                   InterpretationBox[
                    SubsuperscriptBox["g", 
                    RowBox[{"0", "0"}], 
                    RowBox[{
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "0", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]], " ", 
                  SuperscriptBox[
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                    "\[Phi]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                    SyntaxForm -> Automatic, Editable -> False], "2"]}]}], 
              ")"}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]},
        {
         StyleBox["\<\"We can identify the energy-momentum tensor in the \
variation \"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]]},
        {
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\[Delta]", "_"], 
             InterpretationBox[
              SubsuperscriptBox["g", 
               StyleBox[
                RowBox[{"0", "0"}],
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"0", "0"}]],
              $CellContext`Tensor[$CellContext`g, {0, 
               0}, {$CellContext`Void, $CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]], "[", "S", "]"}],
           $CellContext`tuDDown[$CellContext`\[Delta]][$CellContext`S, 
            $CellContext`Tensor[$CellContext`g, {0, 
             0}, {$CellContext`Void, $CellContext`Void}]],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          TemplateBox[{RowBox[{
              FractionBox["1", "2"], " ", "m", " ", 
              SqrtBox[
               InterpretationBox[
                SubsuperscriptBox["g", 
                 RowBox[{"0", "0"}], 
                 RowBox[{
                   StyleBox[
                   "0", ShowContents -> False, StripOnInput -> False], 
                   StyleBox["0", ShowContents -> False, StripOnInput -> False]
                   }]], 
                $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}], Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}]], " ", 
              SuperscriptBox[
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
                  "\[Phi]", "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
                SyntaxForm -> Automatic, Editable -> False], "2"]}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{3.8001885406233253`*^9, 3.80018889926996*^9, 
  3.800267844529023*^9, 3.800631397660413*^9, 3.800634344676814*^9, 
  3.800634523776917*^9},ExpressionUUID->"a3fe551a-a935-49dc-ab17-\
b83a33c9acb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<From the definition of the stress-energy tensor: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"$t", "=", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"T", ",", "\"\<uu\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"tuDPartial", "[", 
        RowBox[{"\[ScriptCapitalL]", ",", 
         RowBox[{"tuDPartial", "[", 
          RowBox[{"\[Phi]", ",", "\[Mu]"}], "]"}]}], "]"}], 
       RowBox[{"tuDPartialu", "[", 
        RowBox[{"\[Phi]", ",", "\[Nu]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"g", ",", "\"\<uu\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], 
       "\[ScriptCapitalL]"}]}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<The Lagrangian for this case \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$0", "//", "tuExtractIntegrand"}]}], ";", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", "\[ScriptCapitalL]"}], ";", "$"}], 
   ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Assigning indices for the 1-d case  \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"t", "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Mu]", "|", "\[Nu]"}], "\[Rule]", "0"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", 
   RowBox[{"$l", "=", 
    RowBox[{"$", "/.", "$s"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$t", "/.", "$l"}], "/.", "$s"}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//", 
     RowBox[{"tuDerivativeExpand", "[", 
      RowBox[{"{", 
       RowBox[{"m", ",", "\[Theta]", ",", 
        RowBox[{"T", "[", 
         RowBox[{"g", ",", "\"\<dd\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"T", "[", 
         RowBox[{"g", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Since \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tuDPartialu", "[", 
        RowBox[{"\[Phi]", ",", "0"}], "]"}], "->", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"g", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"\[Phi]", ",", "0"}], "]"}]}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"T", "[", 
         RowBox[{"g", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "2"], "\[Rule]", "1"}]}], 
     "}"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//.", "$s"}]}], ",", 
   RowBox[{
   "CG", "[", 
    "\"\<which is equal to the expression found from the variation of the \
action above.\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.800634527730659*^9, 3.8006345683002167`*^9}, {
   3.800634666891314*^9, 3.800634822150964*^9}, {3.800634866261427*^9, 
   3.800635015193061*^9}, {3.800635167185361*^9, 3.800635401985058*^9}, {
   3.800635493237949*^9, 3.800635656810225*^9}, {3.80063569409968*^9, 
   3.800635769446994*^9}, {3.800635803670562*^9, 3.800635826543844*^9}, {
   3.800635914621974*^9, 3.800635926851882*^9}, {3.800635987257945*^9, 
   3.800636068021532*^9}, {3.800636212086904*^9, 3.800636215087068*^9}, {
   3.800636276180545*^9, 3.800636304956668*^9}, 3.8006363500273046`*^9, {
   3.80063681569121*^9, 3.80063694462605*^9}, {3.800637005416391*^9, 
   3.800637035705564*^9}, {3.8007005815097837`*^9, 3.800700606272319*^9}, {
   3.800700638158861*^9, 3.800700639574397*^9}, {3.800700697431363*^9, 
   3.800700703158018*^9}, {3.800700754578714*^9, 3.800700759986623*^9}, 
   3.800700980675414*^9, {3.800708673515958*^9, 3.800708706463544*^9}, {
   3.800708744330099*^9, 3.800708745934636*^9}, {3.800708790585281*^9, 
   3.800708790949204*^9}, {3.800708902949512*^9, 3.800709134804104*^9}, {
   3.80070917820435*^9, 3.800709246569427*^9}, {3.800709405275302*^9, 
   3.800709422236331*^9}, {3.800710090942513*^9, 3.800710227676855*^9}, {
   3.800710268086335*^9, 
   3.800710310068973*^9}},ExpressionUUID->"8d0830d0-6691-41ff-b1d6-\
11d849245960"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"From the definition of the stress-energy tensor: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["T", 
      StyleBox[
       RowBox[{"\[Mu]", "\[Nu]"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"\[Mu]", "\[Nu]"}]],
     $CellContext`Tensor[$CellContext`T, {$CellContext`\[Mu], $CellContext`\
\[Nu]}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ScriptCapitalL]"}], " ", 
      InterpretationBox[
       SubsuperscriptBox["g", 
        StyleBox[
         RowBox[{"\[Mu]", "\[Nu]"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"\[Mu]", "\[Nu]"}]],
       $CellContext`Tensor[$CellContext`g, {$CellContext`\[Mu], $CellContext`\
\[Nu]}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "+", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
           "\[Phi]", "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Mu]],
          Editable->False,
          SyntaxForm->Automatic]], "[", "\[ScriptCapitalL]", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`\[ScriptCapitalL], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Mu]]],
       Editable->False,
       SyntaxForm->Automatic], " ", 
      InterpretationBox[
       RowBox[{
        TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"\[Nu]"},
         "Superscript"], "[", "\[Phi]", "]"}],
       $CellContext`tuDUp[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Nu]],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The Lagrangian for this case \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"\[ScriptCapitalL]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Theta]", " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], 
       RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "m", " ", 
      InterpretationBox[
       SubsuperscriptBox["g", 
        StyleBox[
         RowBox[{"0", "0"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"0", "0"}]],
       $CellContext`Tensor[$CellContext`g, {0, 
        0}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      SqrtBox[
       InterpretationBox[
        SubsuperscriptBox["g", 
         RowBox[{"0", "0"}], 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False]],
        $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]], " ", 
      SuperscriptBox[
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], "2"]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Assigning indices for the 1-d case  \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Mu]", "|", "\[Nu]"}], "\[Rule]", "0"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"\[ScriptCapitalL]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Theta]", " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
         Editable->False,
         SyntaxForm->Automatic]}], 
       RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "m", " ", 
      InterpretationBox[
       SubsuperscriptBox["g", 
        StyleBox[
         RowBox[{"0", "0"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"0", "0"}]],
       $CellContext`Tensor[$CellContext`g, {0, 
        0}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      SqrtBox[
       InterpretationBox[
        SubsuperscriptBox["g", 
         RowBox[{"0", "0"}], 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False]],
        $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]], " ", 
      SuperscriptBox[
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
        Editable->False,
        SyntaxForm->Automatic], "2"]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["T", 
      StyleBox[
       RowBox[{"0", "0"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"0", "0"}]],
     $CellContext`Tensor[$CellContext`T, {0, 
      0}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       InterpretationBox[
        SubsuperscriptBox["g", 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"0", "0"}]],
        $CellContext`Tensor[$CellContext`g, {0, 
         0}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[Theta]", " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]",
              "]"}],
            $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
            Editable->False,
            SyntaxForm->Automatic]}], 
          RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", "m", " ", 
         InterpretationBox[
          SubsuperscriptBox["g", 
           StyleBox[
            RowBox[{"0", "0"}],
            StripOnInput->False,
            ShowContents->False], 
           RowBox[{"0", "0"}]],
          $CellContext`Tensor[$CellContext`g, {0, 
           0}, {$CellContext`Void, $CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         SqrtBox[
          InterpretationBox[
           SubsuperscriptBox["g", 
            RowBox[{"0", "0"}], 
            StyleBox[
             RowBox[{"0", "0"}],
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]], " ", 
         SuperscriptBox[
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
            "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
           Editable->False,
           SyntaxForm->Automatic], "2"]}]}], ")"}]}], "+", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
          Editable->False,
          SyntaxForm->Automatic]], "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Theta]", " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
             Editable->False,
             SyntaxForm->Automatic]}], 
           RowBox[{"2", " ", "\[Pi]"}]]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", "m", " ", 
          InterpretationBox[
           SubsuperscriptBox["g", 
            StyleBox[
             RowBox[{"0", "0"}],
             StripOnInput->False,
             ShowContents->False], 
            RowBox[{"0", "0"}]],
           $CellContext`Tensor[$CellContext`g, {0, 
            0}, {$CellContext`Void, $CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          SqrtBox[
           InterpretationBox[
            SubsuperscriptBox["g", 
             RowBox[{"0", "0"}], 
             StyleBox[
              RowBox[{"0", "0"}],
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]], " ", 
          SuperscriptBox[
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]",
              "]"}],
            $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
            Editable->False,
            SyntaxForm->Automatic], "2"]}]}], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
       Rational[-1, 2] 
         Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], 0] + 
        Rational[
          1, 2] $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
           0}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
            0, 0}]^Rational[1, 2] $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], 0]^2, 
        $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0]],
       Editable->False,
       SyntaxForm->Automatic], " ", 
      InterpretationBox[
       RowBox[{
        TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"0"},
         "Superscript"], "[", "\[Phi]", "]"}],
       $CellContext`tuDUp["\[PartialD]"][$CellContext`\[Phi], 0],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["T", 
      StyleBox[
       RowBox[{"0", "0"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"0", "0"}]],
     $CellContext`Tensor[$CellContext`T, {0, 
      0}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Theta]", " ", 
       InterpretationBox[
        SubsuperscriptBox["g", 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"0", "0"}]],
        $CellContext`Tensor[$CellContext`g, {0, 
         0}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], " ", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
        Editable->False,
        SyntaxForm->Automatic]}], 
      RowBox[{"2", " ", "\[Pi]"}]], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "m", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        InterpretationBox[
         SubsuperscriptBox["g", 
          StyleBox[
           RowBox[{"0", "0"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"0", "0"}]],
         $CellContext`Tensor[$CellContext`g, {0, 
          0}, {$CellContext`Void, $CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], ")"}], "2"], " ", 
      SqrtBox[
       InterpretationBox[
        SubsuperscriptBox["g", 
         RowBox[{"0", "0"}], 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False]],
        $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]], " ", 
      SuperscriptBox[
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
        Editable->False,
        SyntaxForm->Automatic], "2"]}], "-", 
     FractionBox[
      RowBox[{"\[Theta]", " ", 
       InterpretationBox[
        RowBox[{
         TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"0"},
          "Superscript"], "[", "\[Phi]", "]"}],
        $CellContext`tuDUp["\[PartialD]"][$CellContext`\[Phi], 0],
        Editable->False,
        SyntaxForm->Automatic]}], 
      RowBox[{"2", " ", "\[Pi]"}]], "+", 
     RowBox[{"m", " ", 
      InterpretationBox[
       SubsuperscriptBox["g", 
        StyleBox[
         RowBox[{"0", "0"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"0", "0"}]],
       $CellContext`Tensor[$CellContext`g, {0, 
        0}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      SqrtBox[
       InterpretationBox[
        SubsuperscriptBox["g", 
         RowBox[{"0", "0"}], 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False]],
        $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
       Editable->False,
       SyntaxForm->Automatic], " ", 
      InterpretationBox[
       RowBox[{
        TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"0"},
         "Superscript"], "[", "\[Phi]", "]"}],
       $CellContext`tuDUp["\[PartialD]"][$CellContext`\[Phi], 0],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Since \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"0"},
         "Superscript"], "[", "\[Phi]", "]"}],
       $CellContext`tuDUp["\[PartialD]"][$CellContext`\[Phi], 0],
       Editable->False,
       SyntaxForm->Automatic], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["g", 
         StyleBox[
          RowBox[{"0", "0"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"0", "0"}]],
        $CellContext`Tensor[$CellContext`g, {0, 
         0}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], " ", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
        Editable->False,
        SyntaxForm->Automatic]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        InterpretationBox[
         SubsuperscriptBox["g", 
          StyleBox[
           RowBox[{"0", "0"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"0", "0"}]],
         $CellContext`Tensor[$CellContext`g, {0, 
          0}, {$CellContext`Void, $CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], ")"}], "2"], "\[Rule]", "1"}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["T", 
      StyleBox[
       RowBox[{"0", "0"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"0", "0"}]],
     $CellContext`Tensor[$CellContext`T, {0, 
      0}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", "m", " ", 
     SqrtBox[
      InterpretationBox[
       SubsuperscriptBox["g", 
        RowBox[{"0", "0"}], 
        StyleBox[
         RowBox[{"0", "0"}],
         StripOnInput->False,
         ShowContents->False]],
       $CellContext`Tensor[$CellContext`g, {$CellContext`Void, \
$CellContext`Void}, {0, 0}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "0"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], 0],
       Editable->False,
       SyntaxForm->Automatic], "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"which is equal to the expression found from the variation of \
the action above.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]]}],
  SequenceForm[
   Style["From the definition of the stress-energy tensor: ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], $CellContext`Tensor[$CellContext`T, {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] -> \
-$CellContext`\[ScriptCapitalL] $CellContext`Tensor[$CellContext`g, \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}] + $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[ScriptCapitalL], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Mu]]] \
$CellContext`tuDUp["\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Nu]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The Lagrangian for this case ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`\[ScriptCapitalL] -> 
   Rational[-1, 2] 
     Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
    Rational[1, 2] $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
        0, 0}]^Rational[1, 2] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]^2, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Assigning indices for the 1-d case  ", 
    RGBColor[0.7, 0, 1, 1], Larger], {$CellContext`t -> 0, 
    Alternatives[$CellContext`\[Mu], $CellContext`\[Nu]] -> 0}, 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`\[ScriptCapitalL] -> 
   Rational[-1, 2] 
     Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], 0] + 
    Rational[1, 2] $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
        0, 0}]^Rational[1, 2] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], 0]^2, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], $CellContext`Tensor[$CellContext`T, {0, 
     0}, {$CellContext`Void, $CellContext`Void}] -> \
-$CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}] (
      Rational[-1, 2] 
       Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], 0] + 
      Rational[1, 2] $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
         0}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
          0, 0}]^Rational[1, 2] $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], 0]^2) + $CellContext`tuDDown[
      "\[PartialD]"][
      Rational[-1, 2] 
        Pi^(-1) $CellContext`\[Theta] $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], 0] + 
       Rational[
         1, 2] $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
          0}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
           0, 0}]^Rational[1, 2] $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], 0]^2, 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], 0]] $CellContext`tuDUp[
      "\[PartialD]"][$CellContext`\[Phi], 0], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], $CellContext`Tensor[$CellContext`T, {0, 
     0}, {$CellContext`Void, $CellContext`Void}] -> 
   Rational[1, 2] 
     Pi^(-1) $CellContext`\[Theta] $CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], 0] + 
    Rational[-1, 
       2] $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
        0}, {$CellContext`Void, $CellContext`Void}]^2 \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
        0, 0}]^Rational[1, 2] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], 0]^2 + 
    Rational[-1, 2] 
     Pi^(-1) $CellContext`\[Theta] $CellContext`tuDUp[
      "\[PartialD]"][$CellContext`\[Phi], 
       0] + $CellContext`m $CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`Tensor[$CellContext`g, {$CellContext`Void, $CellContext`Void}, {
        0, 0}]^Rational[1, 2] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], 0] $CellContext`tuDUp[
      "\[PartialD]"][$CellContext`\[Phi], 0], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Since ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], {$CellContext`tuDUp[
     "\[PartialD]"][$CellContext`\[Phi], 
      0] -> $CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], 
       0], $CellContext`Tensor[$CellContext`g, {0, 
       0}, {$CellContext`Void, $CellContext`Void}]^2 -> 1}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], $CellContext`Tensor[$CellContext`T, {0, 
     0}, {$CellContext`Void, $CellContext`Void}] -> 
   Rational[1, 
      2] $CellContext`m $CellContext`Tensor[$CellContext`g, \
{$CellContext`Void, $CellContext`Void}, {0, 0}]^
     Rational[1, 2] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], 0]^2, 
   Style["which is equal to the expression found from the variation of the \
action above.", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8006353128998947`*^9, {3.80063537199928*^9, 3.8006354027978497`*^9}, {
   3.800635509162867*^9, 3.800635538333086*^9}, {3.800635577081834*^9, 
   3.800635604170546*^9}, 3.800635658264011*^9, 3.800635696401527*^9, {
   3.800635745354189*^9, 3.800635770371999*^9}, {3.8006358181145983`*^9, 
   3.800635827451021*^9}, 3.800635931849901*^9, {3.800635988665781*^9, 
   3.800636011924712*^9}, {3.800636042471478*^9, 3.80063606886059*^9}, 
   3.80063621589511*^9, {3.800636279672254*^9, 3.800636305894677*^9}, 
   3.800636350952344*^9, 3.80063686811799*^9, {3.8006369152872066`*^9, 
   3.800636945349852*^9}, {3.8006370077596416`*^9, 3.800637036611372*^9}, {
   3.800700588416806*^9, 3.800700607556885*^9}, 3.8007006408213663`*^9, 
   3.8007007044941463`*^9, 3.800700761056588*^9, 3.800700981926462*^9, 
   3.8007086744642477`*^9, 3.8007087084292583`*^9, 3.800708746870496*^9, 
   3.8007087918810673`*^9, {3.800708913336214*^9, 3.8007089252280903`*^9}, {
   3.800708991342548*^9, 3.800709002118546*^9}, 3.800709089020157*^9, {
   3.8007091197387857`*^9, 3.800709138730639*^9}, 3.800709416673218*^9, {
   3.800710073007592*^9, 3.800710091743639*^9}, 3.800710121941743*^9, {
   3.8007101594129467`*^9, 3.800710208417054*^9}, 
   3.800710311441844*^9},ExpressionUUID->"cb71b5ca-05cd-4422-9a07-\
a5df15e24469"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Compute integrand of e[19]\>\"", ",", "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$d", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "1"], ",", 
           SubscriptBox["\[CapitalDelta]", "2"]}], "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$ds", "=", 
        RowBox[{
         RowBox[{"d", "/@", "$d"}], "//", 
         RowBox[{"tudExpandvI", "[", "d", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$ds2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"tuRuleOp", "[", "Dot", "]"}], "[", 
           RowBox[{"{", 
            RowBox[{"$ds", ",", "$ds"}], "}"}], "]"}], "//", "Simplify"}]}], 
        ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$ds2", "=", 
           RowBox[{"$ds2", "/.", 
            RowBox[{
             RowBox[{"d", "[", "a_", "]"}], "\[Rule]", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"a", ",", "\[Tau]"}], "]"}]}]}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<The first term\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{"Thread", "/@", 
          RowBox[{"{", 
           RowBox[{"$ds", ",", "$d"}], "}"}]}], "//", "Flatten"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tuEliminate", "[", 
            RowBox[{"$", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "]"}], "/.", 
           "toRule"}], "//", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "#"}], "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "&"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xDot", "[", 
              RowBox[{"$", ",", 
               RowBox[{"$d", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", "Thread"}], "//", 
            RowBox[{"tuOpDistributeF", "[", 
             RowBox[{"dotOps", ",", "Rule"}], "]"}]}], "//", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "/.", "toTimes"}], "&"}], ")"}]}], "//", 
          "tuRuleAdd"}], "//", "Simplify"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$d2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tuRuleOp", "[", "Dot", "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"$d", ",", "$d"}], "}"}], "]"}], "//", "Simplify"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"$s2", "=", 
        RowBox[{"$", "/.", "$d2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$s", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"tuRule1", "[", "$ds2", "]"}], "]"}], ",", "$s2"}], "}"}],
          "//.", 
         RowBox[{
          RowBox[{"d", "[", "a_", "]"}], "\[Rule]", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"a", ",", "\[Tau]"}], "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"e", "[", "13", "]"}], "//", 
             RowBox[{"tuRuleSelect", "[", 
              RowBox[{"L", ",", 
               RowBox[{"{", "\[Tau]", "}"}]}], "]"}]}], "//", "First"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"$", "=", 
           RowBox[{"$", "/.", 
            RowBox[{"(", "$s", ")"}]}]}]}], "\[IndentingNewLine]", "}"}], "[", 
        RowBox[{"CG", "[", "\"\<from e[13]\>\"", "]"}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyU8oQwEAx/HHdjBqo+VPaxcXKbtNeVy0JmTJLLLVlBa1tGJLsrTkYBor
LxHaRSxlF6Zw2GVtNmX1KI1Xe1vNZdrWkqxm2LzfO/z61O/bblrQzdUSBCHj
Bjfopa+gOq8KfOQqMKG12sOcFevTFvRJSAq+jNccwzrhiBemzg238L5RFYAh
jToC1XHVA9QeEQysvutZ+Pod5fXpyTRUGPayMCm6KMCOa2UJNg+G/uDbKCO4
45x1rVvgI+N1wLZw1QlXbAMUpKYbDiF95vTAvtahJP+LpzIwpl/NwcjOWB5m
L2NlmGBLgginKXMlhqcnIilMpdfk8KcY7IW03W+E/vLnDDRLJs1wWFmwQDKm
s8GeG+ky37vdDugm45uQlfUXYf3uQQkaO/2/UPrsEkY5u1oUErjomWiCou15
OWQ1+7z/aCLhww==
  "],ExpressionUUID->"8fffeb94-a9a8-4179-b77f-c09c8d6f8802"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Compute integrand of e[19]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        TagBox[GridBox[{
           {
            SubscriptBox["\[CapitalDelta]", "1"]},
           {
            SubscriptBox["\[CapitalDelta]", "2"]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "\[Rule]", 
        TagBox[GridBox[{
           {
            RowBox[{"Cos", "[", "\[Phi]", "]"}]},
           {
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "1"], "]"}]},
           {
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "2"], "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "\[Rule]", 
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", "\[Phi]", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
           {
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"d", "[", "\[Phi]", "]"}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{
              SuperscriptBox[
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                 
                 SubscriptBox["\[CapitalDelta]", "1"], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 
                 Subscript[$CellContext`\[CapitalDelta], 
                  1], $CellContext`\[Tau]],
                Editable->False,
                SyntaxForm->Automatic], "2"], "+", 
              SuperscriptBox[
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                 
                 SubscriptBox["\[CapitalDelta]", "2"], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 
                 Subscript[$CellContext`\[CapitalDelta], 
                  2], $CellContext`\[Tau]],
                Editable->False,
                SyntaxForm->Automatic], "2"]}], "\[Rule]", 
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                "\[Phi]", "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"The first term\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "1"], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", "\[Phi]", "]"}]}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
          {
           RowBox[{
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "2"], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"d", "[", "\[Phi]", "]"}]}]}]},
          {
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "1"], "\[Rule]", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]},
          {
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "2"], "\[Rule]", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
             SubscriptBox["\[CapitalDelta]", "1"]}], "\[Rule]", 
            RowBox[{"d", "[", 
             SubscriptBox["\[CapitalDelta]", "2"], "]"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
             SubscriptBox["\[CapitalDelta]", "2"]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"d", "[", 
              SubscriptBox["\[CapitalDelta]", "1"], "]"}]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]", "1", "2"], "+", 
           SubsuperscriptBox["\[CapitalDelta]", "2", "2"]}], ")"}]}], 
        "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "2"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "1"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"]}]}]}]},
      {
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[CapitalDelta]", "1", "2"], "+", 
         SubsuperscriptBox["\[CapitalDelta]", "2", "2"]}], "\[Rule]", "1"}]},
      {
       RowBox[{
        RowBox[{"d", "[", "\[Phi]", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "2"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         RowBox[{
          RowBox[{"d", "[", 
           SubscriptBox["\[CapitalDelta]", "1"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"]}]}]}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            SuperscriptBox[
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
              Editable->False,
              SyntaxForm->Automatic], "2"], "\[Rule]", 
            RowBox[{
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "1"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 1], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"], "+", 
             SuperscriptBox[
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "2"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 2], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic], "2"]}]}]},
          {
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
              "\[Phi]", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
             Editable->False,
             SyntaxForm->Automatic], "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox["\[CapitalDelta]", "2"]}], " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "1"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 1], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic]}], "+", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "1"], " ", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                SubscriptBox["\[CapitalDelta]", "2"], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                
                Subscript[$CellContext`\[CapitalDelta], 
                 2], $CellContext`\[Tau]],
               Editable->False,
               SyntaxForm->Automatic]}]}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"L", "\[Rule]", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", 
                 "\[Phi]", "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
                Editable->False,
                SyntaxForm->Automatic]}], "-", 
              RowBox[{
               FractionBox["1", "2"], " ", "M", " ", 
               SuperscriptBox[
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[",
                   "\[Phi]", "]"}],
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]],
                 Editable->False,
                 SyntaxForm->Automatic], "2"]}]}]}]},
           {
            RowBox[{"L", "\[Rule]", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SubscriptBox["\[CapitalDelta]", "2"]}], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "1"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    1], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic]}], "+", 
                 RowBox[{
                  SubscriptBox["\[CapitalDelta]", "1"], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "2"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    2], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}]}], "-", 
              RowBox[{
               FractionBox["1", "2"], " ", "M", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "1"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    1], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic], "2"], "+", 
                 SuperscriptBox[
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                    "[", 
                    SubscriptBox["\[CapitalDelta]", "2"], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    
                    Subscript[$CellContext`\[CapitalDelta], 
                    2], $CellContext`\[Tau]],
                   Editable->False,
                   SyntaxForm->Automatic], "2"]}], ")"}]}]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"from e[13]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Compute integrand of e[19]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{Grid[{{
          Subscript[$CellContext`\[CapitalDelta], 1]}, {
          Subscript[$CellContext`\[CapitalDelta], 2]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left] -> Grid[{{
          Cos[$CellContext`\[Phi]]}, {
          Sin[$CellContext`\[Phi]]}}, Dividers -> {{True}, {False}}, 
        FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left]}, {Grid[{{
          $CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 1]]}, {
          $CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 2]]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left] -> 
      Grid[{{-$CellContext`d[$CellContext`\[Phi]] Sin[$CellContext`\[Phi]]}, {
         Cos[$CellContext`\[Phi]] $CellContext`d[$CellContext`\[Phi]]}}, 
        Dividers -> {{True}, {False}}, FrameStyle -> Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`tuDDown["\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              1], $CellContext`\[Tau]]^2 + $CellContext`tuDDown["\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              2], $CellContext`\[Tau]]^2 -> $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["The first term", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{$CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 
            1]] -> -$CellContext`d[$CellContext`\[Phi]] 
          Sin[$CellContext`\[Phi]]}, {$CellContext`d[
           Subscript[$CellContext`\[CapitalDelta], 2]] -> 
         Cos[$CellContext`\[Phi]] $CellContext`d[$CellContext`\[Phi]]}, {
        Subscript[$CellContext`\[CapitalDelta], 1] -> 
         Cos[$CellContext`\[Phi]]}, {
        Subscript[$CellContext`\[CapitalDelta], 2] -> 
         Sin[$CellContext`\[Phi]]}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`d[$CellContext`\[Phi]] 
          Subscript[$CellContext`\[CapitalDelta], 1] -> $CellContext`d[
           
           Subscript[$CellContext`\[CapitalDelta], 
            2]]}, {$CellContext`d[$CellContext`\[Phi]] 
          Subscript[$CellContext`\[CapitalDelta], 2] -> -$CellContext`d[
            Subscript[$CellContext`\[CapitalDelta], 1]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> 
       Left]}, {$CellContext`d[$CellContext`\[Phi]] (
        Subscript[$CellContext`\[CapitalDelta], 1]^2 + 
        Subscript[$CellContext`\[CapitalDelta], 2]^2) -> $CellContext`d[
          Subscript[$CellContext`\[CapitalDelta], 2]] 
        Subscript[$CellContext`\[CapitalDelta], 1] - $CellContext`d[
         Subscript[$CellContext`\[CapitalDelta], 1]] 
       Subscript[$CellContext`\[CapitalDelta], 2]}, {
     Subscript[$CellContext`\[CapitalDelta], 1]^2 + 
       Subscript[$CellContext`\[CapitalDelta], 2]^2 -> 
      1}, {$CellContext`d[$CellContext`\[Phi]] -> $CellContext`d[
          Subscript[$CellContext`\[CapitalDelta], 2]] 
        Subscript[$CellContext`\[CapitalDelta], 1] - $CellContext`d[
         Subscript[$CellContext`\[CapitalDelta], 1]] 
       Subscript[$CellContext`\[CapitalDelta], 2]}, {
      Grid[{{$CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2 -> \
$CellContext`tuDDown["\[PartialD]"][
             Subscript[$CellContext`\[CapitalDelta], 
              1], $CellContext`\[Tau]]^2 + $CellContext`tuDDown["\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              2], $CellContext`\[Tau]]^2}, {$CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] -> -
           Subscript[$CellContext`\[CapitalDelta], 2] $CellContext`tuDDown[
            "\[PartialD]"][
             Subscript[$CellContext`\[CapitalDelta], 1], $CellContext`\[Tau]] + 
          Subscript[$CellContext`\[CapitalDelta], 1] $CellContext`tuDDown[
            "\[PartialD]"][
             
             Subscript[$CellContext`\[CapitalDelta], 
              2], $CellContext`\[Tau]]}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`L -> 
         Complex[0, 1] $CellContext`A $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]] + 
          Rational[-1, 2] $CellContext`M $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Tau]]^2}, \
{$CellContext`L -> 
         Complex[0, 1] $CellContext`A (-
             Subscript[$CellContext`\[CapitalDelta], 2] $CellContext`tuDDown[
              "\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                1], $CellContext`\[Tau]] + 
            Subscript[$CellContext`\[CapitalDelta], 1] $CellContext`tuDDown[
              "\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                2], $CellContext`\[Tau]]) + 
          Rational[-1, 
             2] $CellContext`M ($CellContext`tuDDown["\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                1], $CellContext`\[Tau]]^2 + $CellContext`tuDDown[
              "\[PartialD]"][
               
               Subscript[$CellContext`\[CapitalDelta], 
                2], $CellContext`\[Tau]]^2)}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["from e[13]", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885407893047`*^9, 3.800188899411113*^9, 
  3.80026784465069*^9, 
  3.80063515068508*^9},ExpressionUUID->"0ce925aa-d563-4c28-bfe9-d7c51deaec17"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3 Path integral for a single spin", "Section",
 CellChangeTimes->{{3.793023979636764*^9, 
  3.793023989422287*^9}},ExpressionUUID->"ca95ee77-9fec-40e5-8a4d-\
00fc31d9f57e"],

Cell[CellGroupData[{

Cell["3.1 Quantum spin", "Subsubsection",
 CellChangeTimes->{{3.7930269826349697`*^9, 
  3.793026987714677*^9}},ExpressionUUID->"a9906281-b35d-4911-860b-\
b2d6d5783480"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<3.1 Quantum spin\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "[", "22", "]"}], "=", 
         RowBox[{"$sS0", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"CommutatorM", "[", 
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"S", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "a_", "}"}]}], "]"}], ",", 
                RowBox[{"T", "[", 
                 RowBox[{"S", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "b_", "}"}]}], "]"}]}], "]"}], "\[Rule]", 
              RowBox[{"I", " ", 
               RowBox[{"T", "[", 
                RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], 
               RowBox[{"T", "[", 
                RowBox[{"S", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "c", "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"S", ",", "\"\<u\>\"", ",", 
                   RowBox[{"{", "a_", "}"}]}], "]"}], 
                 RowBox[{"T", "[", 
                  RowBox[{"S", ",", "\"\<u\>\"", ",", 
                   RowBox[{"{", "a_", "}"}]}], "]"}]}], "\[Rule]", 
                RowBox[{"S", 
                 RowBox[{"(", 
                  RowBox[{"S", "+", "1"}], ")"}]}]}], "}"}], "[", 
              RowBox[{"CG", "[", "\"\<require\>\"", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c"}], "}"}], "\[Rule]", 
              RowBox[{"x", "|", "y", "|", "z"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"S", "\[Element]", 
              RowBox[{"\[DoubleStruckCapitalZ]", "/", "2"}]}]}], 
            "\[IndentingNewLine]", "}"}], "[", 
           RowBox[{
           "CG", "[", "\"\<SU[2] quantum spin algebra e[22]\>\"", "]"}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$h", "=", 
           RowBox[{"H", "\[Rule]", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"h", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "i", "}"}]}], "]"}], ".", 
              RowBox[{"T", "[", 
               RowBox[{"S", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "i", "}"}]}], "]"}]}]}]}]}], "}"}], "[", 
         RowBox[{
         "CG", "[", "\"\<Hamiltonian: spin in magnetic field\>\"", "]"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"e", "[", "25", "]"}], "=", 
         RowBox[{"$h1", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$", "=", 
              RowBox[{
               RowBox[{"tuDPartial", "[", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"S", ",", "\"\<u\>\"", ",", 
                   RowBox[{"{", "a_", "}"}]}], "]"}], ",", "t"}], "]"}], 
               "\[Rule]", 
               RowBox[{"I", " ", 
                RowBox[{"CommutatorM", "[", 
                 RowBox[{"H", ",", 
                  RowBox[{"T", "[", 
                   RowBox[{"S", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "a", "}"}]}], "]"}]}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"$", "=", 
              RowBox[{"$", "/.", 
               RowBox[{"tuRule", "[", 
                RowBox[{"{", "$h", "}"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$", "=", 
               RowBox[{"$", "//", 
                RowBox[{"expandDot", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"T", "[", 
                    RowBox[{"h", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "_", "}"}]}], "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Simplify", ",", 
                    RowBox[{"tuCommutatorSimplify", "[", 
                    RowBox[{"{", 
                    RowBox[{"T", "[", 
                    RowBox[{"h", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "_", "}"}]}], "]"}], "}"}], "]"}]}], "}"}], 
                  ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"$", "=", 
               RowBox[{"$", "/.", 
                RowBox[{"tuRule", "[", "$sS0", "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"$", "=", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{
                 RowBox[{"Cross", "[", 
                  RowBox[{"S", ",", "h"}], "]"}], ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "k", "}"}]}], "]"}], "\[Rule]", 
               RowBox[{"S", " ", 
                RowBox[{"T", "[", 
                 RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "]"}], 
                RowBox[{"T", "[", 
                 RowBox[{"n", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "i", "}"}]}], "]"}], 
                RowBox[{"T", "[", 
                 RowBox[{"h", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "j", "}"}]}], "]"}]}]}]}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "[", 
           RowBox[{
           "CG", "[", 
            "\"\<e[25] Hamilton's equation(Careful to follow the commutation \
relationship above)\>\"", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"$sTv", "=", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"a_", ",", "_", ",", "_"}], "]"}], "->", 
           OverscriptBox["a", "\[RightVector]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"e", "[", "26", "]"}], "=", 
             RowBox[{"$sS", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"$", "=", 
                 RowBox[{
                  RowBox[{"T", "[", 
                   RowBox[{"S", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "a_", "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"S", " ", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"n", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "a", "}"}]}], "]"}], "[", 
                    RowBox[{"CG", "[", "\"\<classical unit vector\>\"", "]"}],
                     "]"}]}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"$", "/.", "$sTv"}], "//", "tuRule1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"T", "[", 
                   RowBox[{"n", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "a", "}"}]}], "]"}], 
                  RowBox[{"T", "[", 
                   RowBox[{"n", ",", "\"\<d\>\"", ",", 
                    RowBox[{"{", "a", "}"}]}], "]"}]}], "\[Rule]", "1"}]}], 
               "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"$n", "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"n", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 OverscriptBox["h", "\[RightVector]"], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "h"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"h", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "}"}], "[", 
              RowBox[{"CG", "[", "\"\<let\>\"", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"$n", "=", 
              RowBox[{"tuRule", "[", "$n", "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"$sH", "=", 
              RowBox[{
               RowBox[{"$h", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Tensor", "[", 
                   RowBox[{"a_", ",", "_", ",", "_"}], "]"}], "->", 
                  OverscriptBox["a", "\[RightVector]"]}], "}"}]}], "//.", 
               RowBox[{"tuRule", "[", 
                RowBox[{"{", 
                 RowBox[{"$sS", ",", "$n"}], "}"}], "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$sL", "=", 
                RowBox[{"L", "\[Rule]", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"f", ",", "t"}], "]"}], 
                    SubscriptBox["p", "f"]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"f", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Phi]", ",", "\[Theta]"}], "}"}]}], "}"}]}], 
                   "]"}], "-", "H"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"$", "=", 
                RowBox[{"$", "/.", "$sH"}]}]}], "\[IndentingNewLine]", "}"}], 
             "[", 
             RowBox[{"CG", "[", "\"\<\[Placeholder]\>\"", "]"}], "]"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "[", 
          RowBox[{"CG", "[", "\"\<classical limit\>\"", "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "5"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793026989932044*^9, 3.793027172442204*^9}, {
   3.7930272091771307`*^9, 3.793027447479591*^9}, {3.793027556151428*^9, 
   3.7930275894021063`*^9}, {3.7930277023050537`*^9, 3.793027706131589*^9}, {
   3.793027747883107*^9, 3.793027812931404*^9}, {3.793028139422806*^9, 
   3.793028322546019*^9}, {3.7930283727496977`*^9, 3.793028374283246*^9}, {
   3.793028417958426*^9, 3.793028464896893*^9}, {3.793028868071404*^9, 
   3.793028869636478*^9}, {3.793028910039669*^9, 3.7930290741269417`*^9}, {
   3.7930350638865957`*^9, 3.7930350641315823`*^9}, {3.793035421388976*^9, 
   3.793035575671844*^9}, {3.793035684413962*^9, 3.79303569063307*^9}, 
   3.7930359371915894`*^9, {3.793036037731545*^9, 3.793036055614702*^9}, {
   3.7930388344669333`*^9, 3.793038837974267*^9}, 3.793039056542193*^9, {
   3.793040496579846*^9, 3.793040502724472*^9}, 3.793041370363179*^9, {
   3.79319413959693*^9, 3.7931941425272913`*^9}, {3.793194198232028*^9, 
   3.793194198730875*^9}, {3.793198091970358*^9, 3.793198098319561*^9}, {
   3.7951843414994307`*^9, 3.795184342935459*^9}, {3.795184537380117*^9, 
   3.795184547235237*^9}, {3.7951849950572033`*^9, 3.795185059932013*^9}, {
   3.795185094876821*^9, 3.795185127914165*^9}, {3.795185212608672*^9, 
   3.795185218519846*^9}, {3.7951852542762613`*^9, 3.7951852830492*^9}, {
   3.795195693687777*^9, 3.7951957254832573`*^9}, {3.795197187500807*^9, 
   3.795197252378254*^9}, {3.795199389307198*^9, 3.795199462050942*^9}, {
   3.795199508034143*^9, 3.795199510173123*^9}, {3.7952037380002337`*^9, 
   3.795203757880355*^9}, {3.7962172825083838`*^9, 3.79621729292463*^9}, {
   3.796217713397929*^9, 3.7962177545460863`*^9}, {3.796217791683036*^9, 
   3.796217799122819*^9}, {3.796217841138631*^9, 3.7962178829690447`*^9}, 
   3.79621794312427*^9, {3.796218062142365*^9, 3.796218137756373*^9}, {
   3.796218183497117*^9, 3.796218190495761*^9}, {3.796218331138198*^9, 
   3.796218334712413*^9}, {3.796218379249487*^9, 3.79621843604414*^9}, {
   3.7962185230739737`*^9, 
   3.796218575463203*^9}},ExpressionUUID->"c4ece8f8-00ae-4fd3-a9f1-\
5d1d5953ebf7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"3.1 Quantum spin\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             InterpretationBox[
              SubscriptBox[
               RowBox[{"[", 
                InterpretationBox[
                 SubsuperscriptBox["S", 
                  StyleBox["a_",
                   StripOnInput->False,
                   ShowContents->False], "a_"],
                 $CellContext`Tensor[$CellContext`S, {
                   Pattern[$CellContext`a, 
                    Blank[]]}, {$CellContext`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], ",", 
                InterpretationBox[
                 SubsuperscriptBox["S", 
                  StyleBox["b_",
                   StripOnInput->False,
                   ShowContents->False], "b_"],
                 $CellContext`Tensor[$CellContext`S, {
                   Pattern[$CellContext`b, 
                    Blank[]]}, {$CellContext`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}], "-"],
              $CellContext`CommutatorM[
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`a, 
                  Blank[]]}, {$CellContext`Void}], 
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`b, 
                  Blank[]]}, {$CellContext`Void}]],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             RowBox[{"\[ImaginaryI]", " ", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["c",
                 StripOnInput->False,
                 ShowContents->False], "c"],
               $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Epsilon]", 
                StyleBox[
                 RowBox[{"a", "b", "c"}],
                 StripOnInput->False,
                 ShowContents->False], 
                RowBox[{"a", "b", "c"}]],
               $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`b, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}]}]},
           {
            RowBox[{
             TagBox[GridBox[{
                {
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["S", 
                    StyleBox["a_",
                    StripOnInput->False,
                    ShowContents->False], "a_"],
                    $CellContext`Tensor[$CellContext`S, {
                    Pattern[$CellContext`a, 
                    Blank[]]}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], ")"}], "2"], "\[Rule]", 
                  RowBox[{"S", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "S"}], ")"}]}]}]}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "[", 
             StyleBox["\<\"require\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]},
           {
            RowBox[{
             TagBox[GridBox[{
                {"a"},
                {"b"},
                {"c"}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "\[Rule]", 
             RowBox[{"x", "|", "y", "|", "z"}]}]},
           {
            RowBox[{"S", "\[Element]", 
             FractionBox["\[DoubleStruckCapitalZ]", "2"]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"SU[2] quantum spin algebra e[22]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"H", "\[Rule]", 
             RowBox[{"-", 
              RowBox[{
               InterpretationBox[
                SubsuperscriptBox["h", 
                 StyleBox["i",
                  StripOnInput->False,
                  ShowContents->False], "i"],
                $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], ".", 
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["i",
                  StripOnInput->False,
                  ShowContents->False], "i"],
                $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]}]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"Hamiltonian: spin in magnetic field\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["a_",
                  StripOnInput->False,
                  ShowContents->False], "a_"],
                $CellContext`Tensor[$CellContext`S, {
                  Pattern[$CellContext`a, 
                   Blank[]]}, {$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`a, 
                  Blank[]]}, {$CellContext`Void}], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             RowBox[{"\[ImaginaryI]", " ", 
              InterpretationBox[
               SubscriptBox[
                RowBox[{"[", "H", ",", 
                 InterpretationBox[
                  SubsuperscriptBox["S", 
                   StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False], "a"],
                  $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], "]"}], "-"],
               $CellContext`CommutatorM[$CellContext`H, 
                $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}]],
               Editable->False,
               SyntaxForm->Automatic]}]}]},
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["a_",
                  StripOnInput->False,
                  ShowContents->False], "a_"],
                $CellContext`Tensor[$CellContext`S, {
                  Pattern[$CellContext`a, 
                   Blank[]]}, {$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`a, 
                  Blank[]]}, {$CellContext`Void}], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             RowBox[{"\[ImaginaryI]", " ", 
              InterpretationBox[
               SubscriptBox[
                RowBox[{"[", 
                 RowBox[{"-", 
                  RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["h", 
                    StyleBox["i",
                    StripOnInput->False,
                    ShowContents->False], "i"],
                    $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], ".", 
                   InterpretationBox[
                    SubsuperscriptBox["S", 
                    StyleBox["i",
                    StripOnInput->False,
                    ShowContents->False], "i"],
                    $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False]}]}], ",", 
                 InterpretationBox[
                  SubsuperscriptBox["S", 
                   StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False], "a"],
                  $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], "]"}], "-"],
               $CellContext`CommutatorM[-Dot[
                  $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
                  $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]], 
                $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}]],
               Editable->False,
               SyntaxForm->Automatic]}]}]},
           {
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
               InterpretationBox[
                SubsuperscriptBox["S", 
                 StyleBox["a_",
                  StripOnInput->False,
                  ShowContents->False], "a_"],
                $CellContext`Tensor[$CellContext`S, {
                  Pattern[$CellContext`a, 
                   Blank[]]}, {$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`S, {
                 Pattern[$CellContext`a, 
                  Blank[]]}, {$CellContext`Void}], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "\[Rule]", 
             RowBox[{
              RowBox[{"-", 
               InterpretationBox[
                SubsuperscriptBox["h", 
                 StyleBox["i",
                  StripOnInput->False,
                  ShowContents->False], "i"],
                $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]}], " ", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["c",
                 StripOnInput->False,
                 ShowContents->False], "c"],
               $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Epsilon]", 
                StyleBox[
                 RowBox[{"a", "i", "c"}],
                 StripOnInput->False,
                 ShowContents->False], 
                RowBox[{"a", "i", "c"}]],
               $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`i, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}]}]},
           {
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox[
               RowBox[{"S", "\[Cross]", "h"}], 
               StyleBox["k",
                StripOnInput->False,
                ShowContents->False], "k"],
              $CellContext`Tensor[
               
               Cross[$CellContext`S, $CellContext`h], {$CellContext`k}, \
{$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "\[Rule]", 
             RowBox[{"S", " ", 
              InterpretationBox[
               SubsuperscriptBox["h", 
                StyleBox["j",
                 StripOnInput->False,
                 ShowContents->False], "j"],
               $CellContext`Tensor[$CellContext`h, {$CellContext`j}, \
{$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                StyleBox["i",
                 StripOnInput->False,
                 ShowContents->False], "i"],
               $CellContext`Tensor[$CellContext`n, {$CellContext`i}, \
{$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Epsilon]", 
                StyleBox[
                 RowBox[{"i", "j", "k"}],
                 StripOnInput->False,
                 ShowContents->False], 
                RowBox[{"i", "j", "k"}]],
               $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`i, \
$CellContext`j, $CellContext`k}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"e[25] Hamilton's equation(Careful to follow the \
commutation relationship above)\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            TagBox[GridBox[{
               {
                RowBox[{
                 InterpretationBox[
                  SubsuperscriptBox["S", 
                   StyleBox["a_",
                    StripOnInput->False,
                    ShowContents->False], "a_"],
                  $CellContext`Tensor[$CellContext`S, {
                    Pattern[$CellContext`a, 
                    Blank[]]}, {$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], "\[Rule]", 
                 RowBox[{"S", " ", 
                  RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False], "a"],
                    $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "[", 
                   StyleBox["\<\"classical unit vector\"\>",
                    StripOnInput->False,
                    LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    FontFamily->"Helvetica",
                    FontColor->RGBColor[0, 
                    Rational[2, 3], 0]], "]"}]}]}]},
               {
                RowBox[{
                 OverscriptBox["S", "\[RightVector]"], "\[Rule]", 
                 RowBox[{"S", " ", 
                  OverscriptBox["n", "\[RightVector]"]}]}]},
               {
                RowBox[{
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False], "a"],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], " ", 
                  InterpretationBox[
                   SubsuperscriptBox["n", "a", 
                    StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`a}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False]}], "\[Rule]", "1"}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"]},
           {
            RowBox[{
             TagBox[GridBox[{
                {
                 RowBox[{
                  OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]},
                {
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False], "1"],
                    $CellContext`Tensor[$CellContext`n, {
                    1}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "\[Rule]", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False], "2"],
                    $CellContext`Tensor[$CellContext`n, {
                    2}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "\[Rule]", 
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False], "3"],
                    $CellContext`Tensor[$CellContext`n, {
                    3}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "\[Rule]", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]},
                {
                 RowBox[{
                  OverscriptBox["h", "\[RightVector]"], "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "h"}], "}"}]}]},
                {
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False], "1"],
                    $CellContext`Tensor[$CellContext`h, {
                    1}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "\[Rule]", "0"}], ",", 
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False], "2"],
                    $CellContext`Tensor[$CellContext`h, {
                    2}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "\[Rule]", "0"}], ",", 
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False], "3"],
                    $CellContext`Tensor[$CellContext`h, {
                    3}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "\[Rule]", "1"}]}], "}"}]}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "[", 
             StyleBox["\<\"let\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]},
           {
            RowBox[{"H", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "h"}], " ", "S", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]},
           {
            RowBox[{
             TagBox[GridBox[{
                {
                 RowBox[{"L", "\[Rule]", 
                  RowBox[{
                   RowBox[{"-", "H"}], "+", 
                   RowBox[{
                    SubscriptBox["p", "\[Theta]"], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "\[Theta]", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], "+", 
                   RowBox[{
                    SubscriptBox["p", "\[Phi]"], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "\[Phi]", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}]}]},
                {
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["S", 
                    StyleBox["a_",
                    StripOnInput->False,
                    ShowContents->False], "a_"],
                   $CellContext`Tensor[$CellContext`S, {
                    Pattern[$CellContext`a, 
                    Blank[]]}, {$CellContext`Void}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "\[Rule]", 
                  RowBox[{"S", " ", 
                   RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    StyleBox["a",
                    StripOnInput->False,
                    ShowContents->False], "a"],
                    $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "[", 
                    StyleBox["\<\"classical unit vector\"\>",
                    StripOnInput->False,
                    LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                    FontFamily->"Helvetica",
                    FontColor->RGBColor[0, 
                    Rational[2, 3], 0]], "]"}]}]}]}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "[", 
             StyleBox["\<\"\[Placeholder]\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"classical limit\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["3.1 Quantum spin", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{$CellContext`CommutatorM[
           $CellContext`Tensor[$CellContext`S, {
             Pattern[$CellContext`a, 
              Blank[]]}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {
             Pattern[$CellContext`b, 
              Blank[]]}, {$CellContext`Void}]] -> 
         Complex[0, 
            1] $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`a, $CellContext`b, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}]}, {
         Grid[{{$CellContext`Tensor[$CellContext`S, {
                Pattern[$CellContext`a, 
                 Blank[]]}, {$CellContext`Void}]^2 -> $CellContext`S (
              1 + $CellContext`S)}}, Dividers -> {{True}, {False}}, 
          FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["require", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
        Grid[{{$CellContext`a}, {$CellContext`b}, {$CellContext`c}}, 
           Dividers -> {{True}, {False}}, FrameStyle -> Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]], Alignment -> Left] -> 
         Alternatives[$CellContext`x, $CellContext`y, $CellContext`z]}, {
         Element[$CellContext`S, 
          Rational[1, 2] $CellContext`\[DoubleStruckCapitalZ]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["SU[2] quantum spin algebra e[22]", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{$CellContext`H -> -Dot[
            $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
            $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
       Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["Hamiltonian: spin in magnetic field", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`S, {
             Pattern[$CellContext`a, 
              Blank[]]}, {$CellContext`Void}], $CellContext`t] -> 
         Complex[0, 1] $CellContext`CommutatorM[$CellContext`H, 
            $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}]]}, {$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`S, {
             Pattern[$CellContext`a, 
              Blank[]]}, {$CellContext`Void}], $CellContext`t] -> 
         Complex[0, 1] $CellContext`CommutatorM[-Dot[
              $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
              $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]], 
            $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}]]}, {$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`S, {
             Pattern[$CellContext`a, 
              
              Blank[]]}, {$CellContext`Void}], $CellContext`t] -> \
-$CellContext`Tensor[$CellContext`h, {$CellContext`i}, {$CellContext`Void}] \
$CellContext`Tensor[$CellContext`S, {$CellContext`c}, {$CellContext`Void}] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, $CellContext`i, \
$CellContext`c}, {$CellContext`Void, $CellContext`Void, $CellContext`Void}]}, \
{$CellContext`Tensor[
           
           Cross[$CellContext`S, $CellContext`h], {$CellContext`k}, \
{$CellContext`Void}] -> $CellContext`S $CellContext`Tensor[$CellContext`h, \
{$CellContext`j}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`n, \
{$CellContext`i}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\
\[Epsilon], {$CellContext`i, $CellContext`j, $CellContext`k}, \
{$CellContext`Void, $CellContext`Void, $CellContext`Void}]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style[
       "e[25] Hamilton's equation(Careful to follow the commutation \
relationship above)", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{
         Grid[{{$CellContext`Tensor[$CellContext`S, {
               Pattern[$CellContext`a, 
                
                Blank[]]}, {$CellContext`Void}] -> $CellContext`S \
$CellContext`Tensor[$CellContext`n, {$CellContext`a}, {$CellContext`Void}][
               Style["classical unit vector", 
                RGBColor[0, 
                 Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
           OverVector[$CellContext`S] -> $CellContext`S 
             OverVector[$CellContext`n]}, \
{$CellContext`Tensor[$CellContext`n, {$CellContext`a}, {$CellContext`Void}] \
$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {$CellContext`a}] -> 
            1}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left]}, {
         Grid[{{
           OverVector[$CellContext`n] -> {
             Cos[$CellContext`\[Phi]] Sin[$CellContext`\[Theta]], 
              Sin[$CellContext`\[Theta]] Sin[$CellContext`\[Phi]], 
              
              Cos[$CellContext`\[Theta]]}}, \
{{$CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}] -> 
             Cos[$CellContext`\[Phi]] 
              Sin[$CellContext`\[Theta]], $CellContext`Tensor[$CellContext`n, \
{2}, {$CellContext`Void}] -> 
             Sin[$CellContext`\[Theta]] 
              Sin[$CellContext`\[Phi]], $CellContext`Tensor[$CellContext`n, {
               3}, {$CellContext`Void}] -> Cos[$CellContext`\[Theta]]}}, {
           OverVector[$CellContext`h] -> {
             0, 0, $CellContext`h}}, {{$CellContext`Tensor[$CellContext`h, {
               1}, {$CellContext`Void}] -> 
             0, $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}] -> 
             0, $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}] -> 
             1}}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["let", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> 
           "Helvetica"]]}, {$CellContext`H -> -$CellContext`h $CellContext`S 
          Cos[$CellContext`\[Theta]]}, {
         Grid[{{$CellContext`L -> -$CellContext`H + 
             Subscript[$CellContext`p, $CellContext`\[Theta]] \
$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + 
             Subscript[$CellContext`p, $CellContext`\[Phi]] \
$CellContext`tuDDown[
               "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]}, \
{$CellContext`Tensor[$CellContext`S, {
               Pattern[$CellContext`a, 
                
                Blank[]]}, {$CellContext`Void}] -> $CellContext`S \
$CellContext`Tensor[$CellContext`n, {$CellContext`a}, {$CellContext`Void}][
               Style["classical unit vector", 
                RGBColor[0, 
                 Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["\[Placeholder]", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["classical limit", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188540894417*^9, 3.800188899529622*^9, 
  3.800267844751769*^9},ExpressionUUID->"b32db11f-81bf-4d2e-8543-\
41b39b9404d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<The equation of motion for n with \>\"", ",", 
    RowBox[{"$s", "=", 
     RowBox[{"S", "\[Rule]", "n"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$h1", "//", "tuRule"}], "//", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", 
          RowBox[{"-", "2"}]}], "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
     "Yield"}], ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$s"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] The assignments \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"$ni", "=", 
     RowBox[{
      RowBox[{"Thread", "/@", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tuRule", "[", "$n", "]"}], "/.", 
          RowBox[{
           OverscriptBox["n_", "\[RightVector]"], "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<u\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], ")"}], ")"}]}], "//",
       "tuRule"}]}], ",", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Yield",
     ",", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"$", "/.", "$ni"}]}], ";", "\[IndentingNewLine]", "Yield"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$tmp", "=", 
      RowBox[{"$", "/.", 
       RowBox[{
        RowBox[{"tt", ":", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"tuLeviCivitaNumeric", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "[", 
         "tt", "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$", "/.", "$ni"}], "//", "tuPatternRemove"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"$", "/.", 
          RowBox[{"a", "\[Rule]", "1"}]}], "/.", 
         RowBox[{
          RowBox[{"tt", ":", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"tuLeviCivitaOrder", "[", "tt", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}], "\[Rule]", 
         "1"}]}], "/.", "$ni"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"$", "/.", 
          RowBox[{"a", "\[Rule]", "2"}]}], "/.", 
         RowBox[{
          RowBox[{"tt", ":", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"tuLeviCivitaOrder", "[", "tt", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}], "\[Rule]", 
         "1"}]}], "/.", "$ni"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{"$1", ",", "$2"}], "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuDerivativeExpand", "[", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"$", "/.", 
         RowBox[{"\[Phi]", "\[Rule]", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "/.", 
        RowBox[{"\[Theta]", "\[Rule]", 
         RowBox[{"\[Theta]", "[", "t", "]"}]}]}], "//", 
       RowBox[{"tuTrigDerivativeExpand", "[", "]"}]}], "//", 
      RowBox[{"tuD2tuDOp", "[", 
       RowBox[{"tuDPartial", ",", 
        RowBox[{"{", "t", "}"}]}], "]"}]}]}], ",", "\"\<PON\>\"", ",", 
    "\[IndentingNewLine]", "Imply", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$eom", "=", 
      RowBox[{"$s", "=", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{"$", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"tt", ":", 
              RowBox[{"\[Theta]", "|", "\[Phi]"}]}], ")"}], "[", "_", "]"}], 
           "\[Rule]", "tt"}]}], "//", 
         RowBox[{"tuRuleSolveF", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Theta]", ",", "t"}], "]"}], ",", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "}"}], "]"}]}]}]}]}], ";", 
     RowBox[{"$", "//", "Framed"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "NL", ",", "\"\<Then \>\"", ",", 
    RowBox[{"$s", "=", 
     RowBox[{"$sH", "/.", 
      RowBox[{"tuRuleSolve", "[", 
       RowBox[{"$s", ",", "h"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"$s", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"$s", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       SuperscriptBox[
        RowBox[{"tuDPartial", "[", 
         RowBox[{"\[Phi]", ",", "t"}], "]"}], "2"]}]}], ";", "$s"}], ",", 
    RowBox[{"CR", "[", "\"\<Do we need kinetic term?\>\"", "]"}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$sL1", "=", 
     RowBox[{"$sL", "/.", "$s"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Canonical momentum: \>\"", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      SubscriptBox["p", "\[Phi]"], "\[Rule]", 
      RowBox[{"tuDPartial", "[", 
       RowBox[{"L", ",", 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"\[Phi]", ",", "t"}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$sL1"}]}], ",", "CK", ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuDerivativeExpand", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         SubscriptBox["p", "_"], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "S"}], "}"}], "]"}]}]}], 
    ",", 
    RowBox[{"CR", "[", "\"\<???\>\"", "]"}], ",", "\[IndentingNewLine]", "NL",
     ",", 
    RowBox[{"CR", "[", 
     RowBox[{"\"\<The text has \>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"$sp", "=", 
       RowBox[{
        SubscriptBox["p", "\[Phi]"], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "S"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", "1"}], ")"}]}]}]}], 
      ",", "\[IndentingNewLine]", 
      "\"\< which makes sense since the \[Phi]-momentum goes to 0 when h and \
S are parallel, \[Theta]->0.\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.793038881506805*^9, 3.793038883635253*^9}, {
   3.793038923393532*^9, 3.7930389259708023`*^9}, {3.793038967303171*^9, 
   3.793038999093047*^9}, {3.793039039047679*^9, 3.7930390397910633`*^9}, {
   3.7930391308798*^9, 3.793039213635722*^9}, {3.793039909934147*^9, 
   3.793040049027012*^9}, {3.793040185978876*^9, 3.793040219029538*^9}, {
   3.7930402588385897`*^9, 3.793040295998598*^9}, {3.793040331922764*^9, 
   3.793040382202098*^9}, {3.793040451345029*^9, 3.793040474850829*^9}, {
   3.7930409717888613`*^9, 3.793041177813869*^9}, {3.7930412113252974`*^9, 
   3.793041337083878*^9}, {3.79304137700653*^9, 3.793041437687454*^9}, {
   3.7930414913318253`*^9, 3.7930414922181787`*^9}, {3.793041547855331*^9, 
   3.7930416343952227`*^9}, {3.793041692992392*^9, 3.793041829968203*^9}, {
   3.7931025928283453`*^9, 3.793102626933539*^9}, {3.7931066589356527`*^9, 
   3.7931067374340553`*^9}, {3.793106804780405*^9, 3.7931068189656267`*^9}, {
   3.793106865860045*^9, 3.7931069363565187`*^9}, {3.793107156601646*^9, 
   3.793107295508687*^9}, {3.793107328239477*^9, 3.79310737294405*^9}, 
   3.793107434495613*^9, 3.7931074880407133`*^9, {3.793107636467752*^9, 
   3.793107674335766*^9}, {3.7931370650911913`*^9, 3.7931371189031973`*^9}, {
   3.793137162289133*^9, 3.7931371898951187`*^9}, {3.7931510661598577`*^9, 
   3.793151281578938*^9}, {3.793153214772176*^9, 3.7931536139912786`*^9}, {
   3.7931938802694683`*^9, 3.793193881139694*^9}, {3.793194081378317*^9, 
   3.793194114926972*^9}, {3.793194148558715*^9, 3.793194462453665*^9}, {
   3.793194510796114*^9, 3.793194534609685*^9}, {3.7931973501703863`*^9, 
   3.7931973608632708`*^9}, 3.793198672050503*^9, {3.793200397491912*^9, 
   3.793200401789357*^9}, {3.793371186544889*^9, 3.793371187555563*^9}, {
   3.793371821395033*^9, 3.793371880331053*^9}, {3.7933719182003183`*^9, 
   3.793371996140501*^9}, {3.793372029301499*^9, 3.793372031471314*^9}, {
   3.7933729640589523`*^9, 3.7933729701619387`*^9}, {3.795204140362788*^9, 
   3.795204150384358*^9}, {3.795204181769939*^9, 3.795204241700912*^9}, {
   3.795204648076048*^9, 3.795204703357397*^9}, {3.795204769224683*^9, 
   3.795204779149261*^9}, {3.7952049308024883`*^9, 3.795204932050446*^9}, 
   3.7952053177723503`*^9, {3.795205481506734*^9, 3.7952054912607183`*^9}, {
   3.795206077151824*^9, 3.795206108645714*^9}, {3.7952063193895493`*^9, 
   3.795206418822332*^9}, {3.795206544178561*^9, 3.7952065823097897`*^9}, {
   3.795206989563036*^9, 3.7952070533311367`*^9}, {3.7952071145502453`*^9, 
   3.7952071394547586`*^9}, {3.795219454883792*^9, 3.795219497752364*^9}, {
   3.795219611799658*^9, 3.7952196125824347`*^9}, {3.795262632684277*^9, 
   3.795262659236299*^9}, {3.7952627230052147`*^9, 3.7952627910120163`*^9}, 
   3.795263358300104*^9, {3.795263412782992*^9, 3.795263419251693*^9}, {
   3.795263473974145*^9, 3.795263564487939*^9}, {3.795263603536137*^9, 
   3.795263729542245*^9}, {3.7952639597485847`*^9, 3.7952639602712107`*^9}, {
   3.795264037895652*^9, 3.7952640576047564`*^9}, {3.795264249221463*^9, 
   3.7952642591421623`*^9}, {3.795264545443404*^9, 3.795264545604207*^9}, {
   3.796222412432592*^9, 
   3.796222417305081*^9}},ExpressionUUID->"72a50735-bf2a-4a6d-9e50-\
4b682ec2dcd0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"The equation of motion for n with \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"S", "\[Rule]", "n"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["a_",
         StripOnInput->False,
         ShowContents->False], "a_"],
       $CellContext`Tensor[$CellContext`n, {
         Pattern[$CellContext`a, 
          Blank[]]}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`n, {
        Pattern[$CellContext`a, 
         Blank[]]}, {$CellContext`Void}], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["i",
         StripOnInput->False,
         ShowContents->False], "i"],
       $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["n", 
       StyleBox["c",
        StripOnInput->False,
        ShowContents->False], "c"],
      $CellContext`Tensor[$CellContext`n, {$CellContext`c}, \
{$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"a", "i", "c"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"a", "i", "c"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`i, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] The assignments \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       $CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       $CellContext`Tensor[$CellContext`n, {2}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       $CellContext`Tensor[$CellContext`n, {3}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False], "1"],
       $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False], "2"],
       $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "0"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "h"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["h", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False], "3"],
       $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", "1"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", "0"}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", "h"}]}], "}"}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Then \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"H", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "S"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", "]"}],
      $CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"H", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "S"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "+", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"Do we need kinetic term?\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"L", "\[Rule]", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "\[Theta]"], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "+", 
     RowBox[{"S", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "+", 
     RowBox[{
      SubscriptBox["p", "\[Phi]"], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "-", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Canonical momentum: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "\[Phi]"], "\[Rule]", 
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]], "[", "L", "]"}],
     $CellContext`tuDDown["\[PartialD]"][$CellContext`L, 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "\[Phi]"], "\[Rule]", 
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "\[Theta]"], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], "+", 
       RowBox[{"S", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], "+", 
       RowBox[{
        SubscriptBox["p", "\[Phi]"], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], "-", 
       SuperscriptBox[
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "2"]}], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
     Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + \
$CellContext`S 
       Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
      Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] - \
$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], $CellContext`t]^2, 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\[LongLeftArrow]CHECK\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["p", "\[Phi]"], "\[Rule]", 
    RowBox[{
     RowBox[{"S", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
     SubscriptBox["p", "\[Phi]"], "-", 
     RowBox[{"2", " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]", 
        "]"}],
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"???\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The text has \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     SubscriptBox["p", "\[Phi]"], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "S"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" which makes sense since the \[Phi]-momentum goes to 0 when \
h and S are parallel, \[Theta]->0.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["The equation of motion for n with ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`S -> $CellContext`n, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`tuDDown["\[PartialD]"][
     $CellContext`Tensor[$CellContext`n, {
       Pattern[$CellContext`a, 
        Blank[]]}, {$CellContext`Void}], $CellContext`t] -> \
-$CellContext`Tensor[$CellContext`h, {$CellContext`i}, {$CellContext`Void}] \
$CellContext`Tensor[$CellContext`n, {$CellContext`c}, {$CellContext`Void}] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, $CellContext`i, \
$CellContext`c}, {$CellContext`Void, $CellContext`Void, $CellContext`Void}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] The assignments ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], {$CellContext`Tensor[$CellContext`n, {1}, {$CellContext`Void}] -> 
    Cos[$CellContext`\[Phi]] 
     Sin[$CellContext`\[Theta]], $CellContext`Tensor[$CellContext`n, {
      2}, {$CellContext`Void}] -> 
    Sin[$CellContext`\[Theta]] 
     Sin[$CellContext`\[Phi]], $CellContext`Tensor[$CellContext`n, {
      3}, {$CellContext`Void}] -> 
    Cos[$CellContext`\[Theta]], $CellContext`Tensor[$CellContext`h, {
      1}, {$CellContext`Void}] -> 
    0, $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}] -> 
    0, $CellContext`Tensor[$CellContext`h, {
      3}, {$CellContext`Void}] -> $CellContext`h, \
$CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}] -> 1}, 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[{$CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] -> 
     0, $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] -> $CellContext`h}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Then ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`H -> -$CellContext`S 
    Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], $CellContext`H -> -$CellContext`S 
     Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + \
$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], $CellContext`t]^2, 
   Style["Do we need kinetic term?", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`L -> 
   Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + $CellContext`S 
     Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
    Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] - \
$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], $CellContext`t]^2, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Canonical momentum: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`p, $CellContext`\[Phi]] -> $CellContext`tuDDown[
    "\[PartialD]"][$CellContext`L, 
     $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`p, $CellContext`\[Phi]] -> $CellContext`tuDDown[
    "\[PartialD]"][
    Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + $CellContext`S 
      Cos[$CellContext`\[Theta]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] + 
     Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t] - \
$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Phi], $CellContext`t]^2, 
     $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]], 
   Style["\[LongLeftArrow]CHECK", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`p, $CellContext`\[Phi]] -> $CellContext`S 
     Cos[$CellContext`\[Theta]] + 
    Subscript[$CellContext`p, $CellContext`\[Phi]] - 
    2 $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], 
   Style["???", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The text has ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[Subscript[$CellContext`p, $CellContext`\[Phi]] -> -$CellContext`S \
(-1 + Cos[$CellContext`\[Theta]]), 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[" which makes sense since the \[Phi]-momentum goes to 0 when h and S \
are parallel, \[Theta]->0.", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885409917316`*^9, 3.800188899624113*^9, 
  3.800267844845386*^9},ExpressionUUID->"dbc87301-f2cc-436c-8201-\
0ac250272197"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Spin action from \>\"", ",", 
   RowBox[{
   "URL", "[", 
    "\"\<https://iopscience.iop.org/book/978-1-64327-374-7/chapter/bk978-1-\
64327-374-7ch1\>\"", "]"}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Spin. Path integral form\>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"BraKet", "[", 
         RowBox[{
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", "t", "]"}], ",", 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", 
           SubscriptBox["t", "0"], "]"}]}], "]"}], "\[Rule]", 
        RowBox[{"Limit", "[", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{"xProduct", "[", 
             RowBox[{
              RowBox[{"BraKet", "[", 
               RowBox[{
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], "[", 
                 SubscriptBox["t", 
                  RowBox[{"i", "+", "1"}]], "]"}], ",", 
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], "[", 
                 SubscriptBox["t", "i"], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "iN"}], "}"}]}], "]"}], ",", 
            RowBox[{
             OverscriptBox["n", "\[RightVector]"], "[", 
             SubscriptBox["t", "i"], "]"}]}], "]"}], ",", 
          RowBox[{"iN", "\[Rule]", "\[Infinity]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$z", "=", 
          RowBox[{"z", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", "\[Phi]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "/", "2"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "/", "2"}], "]"}], "}"}]}], "}"}]}]}], 
         "}"}], "[", "\[IndentingNewLine]", 
        RowBox[{"CR", "[", "\"\<Sin,Cos switched from e[1.20]\>\"", "]"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$", "=", 
          RowBox[{
           RowBox[{"ct", "[", "z", "]"}], ".", "z"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"$", "/.", "$z"}], "//", 
              RowBox[{
               RowBox[{"Refine", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\[Phi]", ",", "\[Theta]"}], "}"}], "\[Element]", 
                  "Reals"}]}], "]"}], "&"}]}], "//", "Simplify"}], "//", 
            "Flatten"}], ")"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"$", "=", "$z"}], ";", "\[IndentingNewLine]", 
          RowBox[{"$s", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "/@", "$"}], "//", 
             RowBox[{"tudExpand", "[", "d", "]"}]}], "//", "Simplify"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"$", "=", 
             RowBox[{
              RowBox[{"ct", "[", "z", "]"}], ".", 
              RowBox[{"d", "[", "z", "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"$", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"$", "/.", "$s"}], "/.", "$z"}], "//", 
               RowBox[{
                RowBox[{"Refine", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Phi]", ",", "\[Theta]"}], "}"}], "\[Element]", 
                   "Reals"}]}], "]"}], "&"}]}], "//", "Simplify"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"$", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"$", "//", "TrigReduce"}], "//", 
                RowBox[{
                 RowBox[{"Collect", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"d", "[", "\[Phi]", "]"}]}], "]"}], "&"}]}], "//", 
               "Flatten"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"$", "[", 
              RowBox[{
              "CR", "[", 
               "\"\<Curiously we had to switch the definition of e[1.20] to \
get e[1.28]\>\"", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], "[", 
          RowBox[{"CG", "[", "\"\<Compute e[1.28]\>\"", "]"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQvW570LVFzm8c9zjYPwbR02b4vAPRHibZjIuBdOzb
RlYQbbHERxZE77Nl1gLRd7lEwLRB2RRzEF3UGhMAovPMJmgtBdLfAsSNQbSE
rZgFiPZ6ZAmmH2yojwHRLT6emSD61I6ZuSB6Wc+jEhB9wKG8DqyuTaUZRB9e
vf4KiDYT3XkVRBd6Zb4A0U/cN38G0R6ia36CaEvT83/A9jqlcS0D0gHbXnGD
6L6YnwIgmi2jQQZE7ypyVADRDWUBYLqkvHHzWiD9+LLBNhCtlbg7egOQbjrp
HgOiu57ENB0A0hm/lreCaK3tHqtB9AT2Q+tA9MxdejtA9JFvTTvB9ILMvSD6
i9o3MD1FtfU4iPZS5rsOolsUYx+D6NSj78D0RYUjb0D0g9LSdyAaADggzpc=

  "],ExpressionUUID->"7cc40990-9ecd-4763-a6e9-37824902e917"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Spin action from \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"URL", "[", 
    TemplateBox[{
     "\"https://iopscience.iop.org/book/978-1-64327-374-7/chapter/bk978-1-\
64327-374-7ch1\""},
     "URLArgument"], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Spin. Path integral form\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        InterpretationBox[
         RowBox[{
          StyleBox["\[LeftAngleBracket]",
           FontWeight->Bold], 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", "t", "]"}], 
          StyleBox["|",
           FontWeight->Bold], 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "[", 
           SubscriptBox["t", "0"], "]"}], 
          StyleBox["\[RightAngleBracket]",
           FontWeight->Bold]}],
         BraKet[
          OverVector[$CellContext`n][$CellContext`t], 
          OverVector[$CellContext`n][
           Subscript[$CellContext`t, 0]]],
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{
         UnderscriptBox["\[Limit]", 
          RowBox[{
           StyleBox["\<\"N\"\>",
            StripOnInput->False,
            FontSlant->Italic], "\[Rule]", "\[Infinity]"}]], 
         TemplateBox[{InterpretationBox[
            RowBox[{
              UnderscriptBox[
               UnderscriptBox["\"\[Product]\"", "_"], 
               TagBox[
                GridBox[{{
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    StyleBox["\"N\"", Italic, StripOnInput -> False]}], 
                    "}"}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                 DefaultBaseStyle -> "Column", 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                "Column"]], "[", 
              InterpretationBox[
               RowBox[{
                 StyleBox["\[LeftAngleBracket]", Bold], 
                 RowBox[{
                   OverscriptBox["n", "\[RightVector]"], "[", 
                   SubscriptBox["t", 
                    RowBox[{"1", "+", "i"}]], "]"}], 
                 StyleBox["|", Bold], 
                 RowBox[{
                   OverscriptBox["n", "\[RightVector]"], "[", 
                   SubscriptBox["t", "i"], "]"}], 
                 StyleBox["\[RightAngleBracket]", Bold]}], 
               BraKet[
                OverVector[$CellContext`n][
                 Subscript[$CellContext`t, 1 + $CellContext`i]], 
                OverVector[$CellContext`n][
                 Subscript[$CellContext`t, $CellContext`i]]], SyntaxForm -> 
               Automatic, Editable -> False], "]"}], 
            $CellContext`xProduct[
             BraKet[
              OverVector[$CellContext`n][
               Subscript[$CellContext`t, 1 + $CellContext`i]], 
              OverVector[$CellContext`n][
               Subscript[$CellContext`t, $CellContext`i]]], {$CellContext`i, 
              0, 
              Style["N", Italic]}], SyntaxForm -> Automatic, Editable -> 
            False],RowBox[{
             OverscriptBox["n", "\[RightVector]"], "[", 
             SubscriptBox["t", "i"], "]"}]},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            RowBox[{"z", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                 RowBox[{"Sin", "[", 
                  FractionBox["\[Theta]", "2"], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Cos", "[", 
                 FractionBox["\[Theta]", "2"], "]"}], "}"}]}], "}"}]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"Sin,Cos switched from e[1.20]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[1, 0, 0],
         FrontFaceColor->RGBColor[1, 0, 0],
         BackFaceColor->RGBColor[1, 0, 0],
         GraphicsColor->RGBColor[1, 0, 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[1, 0, 0]], "]"}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{
             InterpretationBox[
              SuperscriptBox["z", "\[Dagger]"],
              ConjugateTranspose[$CellContext`z],
              Editable->False,
              SyntaxForm->Automatic], ".", "z"}], "\[Rule]", 
            TagBox[GridBox[{
               {"1"}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"d", "[", "z", "]"}], "\[Rule]", 
            TagBox[GridBox[{
               {
                RowBox[{"{", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    FractionBox["\[Theta]", "2"], "]"}], " ", 
                    RowBox[{"d", "[", "\[Theta]", "]"}]}], "-", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    FractionBox["\[Theta]", "2"], "]"}]}]}], ")"}]}], "}"}]},
               {
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["1", "2"]}], " ", 
                  RowBox[{"d", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"Sin", "[", 
                   FractionBox["\[Theta]", "2"], "]"}]}], "}"}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"]}]},
          {
           RowBox[{
            TagBox[GridBox[{
               {
                RowBox[{
                 InterpretationBox[
                  SuperscriptBox["z", "\[Dagger]"],
                  ConjugateTranspose[$CellContext`z],
                  Editable->False,
                  SyntaxForm->Automatic], ".", 
                 RowBox[{"d", "[", "z", "]"}]}]},
               {
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", 
                   RowBox[{"d", "[", "\[Phi]", "]"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", 
                    FractionBox["\[Theta]", "2"], "]"}], "2"]}], "}"}], "}"}]},
               {
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}], " ", 
                   RowBox[{"d", "[", "\[Phi]", "]"}]}], "}"}], "[", 
                 
                 StyleBox["\<\"Curiously we had to switch the definition of \
e[1.20] to get e[1.28]\"\>",
                  StripOnInput->False,
                  LineColor->RGBColor[1, 0, 0],
                  FrontFaceColor->RGBColor[1, 0, 0],
                  BackFaceColor->RGBColor[1, 0, 0],
                  GraphicsColor->RGBColor[1, 0, 0],
                  FontFamily->"Helvetica",
                  FontColor->RGBColor[1, 0, 0]], "]"}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"], "[", 
            StyleBox["\<\"Compute e[1.28]\"\>",
             StripOnInput->False,
             LineColor->RGBColor[0, 
               Rational[2, 3], 0],
             FrontFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             BackFaceColor->RGBColor[0, 
               Rational[2, 3], 0],
             GraphicsColor->RGBColor[0, 
               Rational[2, 3], 0],
             FontFamily->"Helvetica",
             FontColor->RGBColor[0, 
               Rational[2, 3], 0]], "]"}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Spin action from ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   URL["https://iopscience.iop.org/book/978-1-64327-374-7/chapter/bk978-1-\
64327-374-7ch1"], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Spin. Path integral form", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{BraKet[
        OverVector[$CellContext`n][$CellContext`t], 
        OverVector[$CellContext`n][
         Subscript[$CellContext`t, 0]]] -> Limit[
        Inactive[Integrate][
         $CellContext`xProduct[
          BraKet[
           OverVector[$CellContext`n][
            Subscript[$CellContext`t, 1 + $CellContext`i]], 
           OverVector[$CellContext`n][
            Subscript[$CellContext`t, $CellContext`i]]], {$CellContext`i, 0, 
           Style["N", Italic]}], 
         OverVector[$CellContext`n][
          Subscript[$CellContext`t, $CellContext`i]]], Style["N", Italic] -> 
        DirectedInfinity[1]]}, {
      Grid[{{$CellContext`z -> {{
           E^(Complex[0, -1] $CellContext`\[Phi]) 
            Sin[Rational[1, 2] $CellContext`\[Theta]]}, {
            Cos[Rational[1, 2] $CellContext`\[Theta]]}}}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["Sin,Cos switched from e[1.20]", 
        RGBColor[1, 0, 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{Dot[
           ConjugateTranspose[$CellContext`z], $CellContext`z] -> 
         Grid[{{1}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]], Alignment -> Left]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{$CellContext`d[$CellContext`z] -> 
         Grid[{{{Rational[1, 2] 
              E^(Complex[0, -1] $CellContext`\[Phi]) (
               Cos[Rational[
                   1, 2] $CellContext`\[Theta]] $CellContext`d[$CellContext`\
\[Theta]] + Complex[0, -2] $CellContext`d[$CellContext`\[Phi]] 
                Sin[Rational[1, 2] $CellContext`\[Theta]])}}, {{
             Rational[-1, 2] $CellContext`d[$CellContext`\[Theta]] 
              Sin[Rational[1, 2] $CellContext`\[Theta]]}}}, 
           Dividers -> {{True}, {False}}, FrameStyle -> Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]], Alignment -> Left]}, {
         Grid[{{
            Dot[
             ConjugateTranspose[$CellContext`z], 
             $CellContext`d[$CellContext`z]]}, {{{
             Complex[0, -1] $CellContext`d[$CellContext`\[Phi]] 
              Sin[Rational[1, 2] $CellContext`\[Theta]]^2}}}, {
            {Complex[0, 
               Rational[1, 2]] (-1 + 
              Cos[$CellContext`\[Theta]]) $CellContext`d[$CellContext`\[Phi]]}[
             Style[
             "Curiously we had to switch the definition of e[1.20] to get \
e[1.28]", 
              RGBColor[1, 0, 0], FontFamily -> "Helvetica"]]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["Compute e[1.28]", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188541123776*^9, 3.800188899912388*^9, 
  3.800267844950635*^9},ExpressionUUID->"83b0d31e-f362-4bf6-ba1a-\
203741393f99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<With \>\"", ",", 
    RowBox[{
     RowBox[{"$s", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$h", ",", "$sL", ",", 
          RowBox[{"$eom", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "$sS"}], "}"}], "//", 
        "tuRule"}], "//", 
       RowBox[{"tuAddPatternVariable", "[", "a", "]"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
    ",", "\[IndentingNewLine]", "NL", ",", "\"\<Compute e[28]: \>\"", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"S", "[", 
       OverscriptBox["n", "\[RightVector]"], "]"}], "->", 
      RowBox[{"xIntegral", "[", 
       RowBox[{"L", ",", "t"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//.", "$s"}], "//", 
       RowBox[{"expandDot", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "S", "}"}]}], "]"}]}], "//", 
      RowBox[{"tuOpDistributeF", "[", "xIntegral", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{
     RowBox[{"e", "[", "28", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"$", "/.", "$sp"}], ")"}], "//.", 
          RowBox[{"tuOpSimplify", "[", 
           RowBox[{"xIntegral", ",", 
            RowBox[{"{", "S", "}"}]}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{"a_", " ", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"\[Phi]", ",", "t"}], "]"}]}], ",", "t"}], "]"}], "->", 
          
          RowBox[{"xIntegral", "[", 
           RowBox[{"a", ",", "\[Phi]"}], "]"}]}]}]}], ",", 
       RowBox[{"CG", "[", 
        RowBox[{"\"\< where the WZ-term appears: \>\"", ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["W", "0"], " ", "4", "\[Pi]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"$", "//", 
             RowBox[{"tuExtractPattern", "[", 
              RowBox[{"_", " ", "S", " ", 
               RowBox[{"xIntegral", "[", 
                RowBox[{"_", ",", "_"}], "]"}]}], "]"}]}], "//", "First"}], 
           ")"}]}]}], "]"}], ",", 
       RowBox[{"CG", "[", "\"\<e[28]\>\"", "]"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793200228212694*^9, 3.7932002492073717`*^9}, {
   3.7932002989279737`*^9, 3.793200323055098*^9}, {3.793200353373674*^9, 
   3.793200367307981*^9}, {3.7932004065497007`*^9, 3.793200530490245*^9}, {
   3.793200560975665*^9, 3.793200678972797*^9}, {3.793200850156625*^9, 
   3.793200850810915*^9}, {3.793371194843691*^9, 3.7933711989369087`*^9}, {
   3.793372046441161*^9, 3.793372051448288*^9}, {3.7933721094168367`*^9, 
   3.793372204466638*^9}, {3.79337402689887*^9, 3.793374123871456*^9}, 
   3.79526335831354*^9, {3.796223158700139*^9, 3.7962232173866262`*^9}, {
   3.796223249668171*^9, 3.796223294343264*^9}, {3.796223688691003*^9, 
   3.796223703469502*^9}, {3.796223737535918*^9, 3.796223886535355*^9}, {
   3.796223946712253*^9, 
   3.7962239842510643`*^9}},ExpressionUUID->"0d37fe3e-0973-4132-be13-\
d417b0ee67ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"With \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{"H", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             StyleBox["i",
              StripOnInput->False,
              ShowContents->False], "i"],
            $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ".", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["i",
              StripOnInput->False,
              ShowContents->False], "i"],
            $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}]}]}]},
       {
        RowBox[{"L", "\[Rule]", 
         RowBox[{
          RowBox[{"-", "H"}], "+", 
          RowBox[{
           SubscriptBox["p", "\[Theta]"], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             "\[Theta]", "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}], "+", 
          RowBox[{
           SubscriptBox["p", "\[Phi]"], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Phi]",
              "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`\[Phi], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}]}]},
       {
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "\[Theta]",
            "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Theta], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", "0"}]},
       {
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox[
            RowBox[{"Pattern", "[", 
             RowBox[{"a_", ",", "_"}], "]"}],
            StripOnInput->False,
            ShowContents->False], 
           RowBox[{"Pattern", "[", 
            RowBox[{"a_", ",", "_"}], "]"}]],
          $CellContext`Tensor[$CellContext`S, {
            Pattern[
             Pattern[$CellContext`a, 
              Blank[]], 
             Blank[]]}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Rule]", 
         RowBox[{"S", " ", 
          InterpretationBox[
           SubsuperscriptBox["n", 
            StyleBox["a",
             StripOnInput->False,
             ShowContents->False], "a"],
           $CellContext`Tensor[$CellContext`n, {$CellContext`a}, \
{$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}]}]},
       {
        RowBox[{
         OverscriptBox["S", "\[RightVector]"], "\[Rule]", 
         RowBox[{"S", " ", 
          OverscriptBox["n", "\[RightVector]"]}]}]},
       {
        RowBox[{
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["n", "a_", 
            StyleBox["a_",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             Pattern[$CellContext`a, 
              Blank[]]}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          InterpretationBox[
           SubsuperscriptBox["n", 
            StyleBox["a_",
             StripOnInput->False,
             ShowContents->False], "a_"],
           $CellContext`Tensor[$CellContext`n, {
             Pattern[$CellContext`a, 
              Blank[]]}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "\[Rule]", "1"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Compute e[28]: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"S", "[", 
     OverscriptBox["n", "\[RightVector]"], "]"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     TemplateBox[{"L","t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"S", "[", 
      OverscriptBox["n", "\[RightVector]"], "]"}]}], "\[Rule]", 
    RowBox[{
     TemplateBox[{RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", 
           RowBox[{
             StyleBox["i", ShowContents -> False, StripOnInput -> False]}], 
           RowBox[{"i"}]], 
          $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
          BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           RowBox[{
             StyleBox["i", ShowContents -> False, StripOnInput -> False]}], 
           RowBox[{"i"}]], 
          $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
          BaseStyle -> {AutoMultiplicationSymbol -> False}]}],"t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "+", 
     RowBox[{
      TemplateBox[{RowBox[{
          SubscriptBox["p", "\[Phi]"], " ", 
          InterpretationBox[
           RowBox[{
             SubscriptBox[
              UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "\[Phi]", 
             "]"}], 
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], SyntaxForm -> 
           Automatic, Editable -> False]}],"t"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[RightArrow] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          OverscriptBox["n", "\[RightVector]"], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "S"}], " ", 
           TemplateBox[{RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}],"\[Phi]"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
          TemplateBox[{RowBox[{
              InterpretationBox[
               SubsuperscriptBox["h", 
                RowBox[{
                  StyleBox[
                  "i", ShowContents -> False, StripOnInput -> False]}], 
                RowBox[{"i"}]], 
               $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                RowBox[{
                  StyleBox[
                  "i", ShowContents -> False, StripOnInput -> False]}], 
                RowBox[{"i"}]], 
               $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}], Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}]}],"t"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}]}], ",", 
        StyleBox["\<\" where the WZ-term appears: \"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], ",", 
        StyleBox[
         RowBox[{
          RowBox[{"4", " ", "\[Pi]", " ", 
           SubscriptBox["W", "0"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", "S"}], " ", 
           TemplateBox[{RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}],"\[Phi]"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]}],
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], ",", 
        StyleBox["\<\"e[28]\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]]}], "}"}]}]}]}]}],
  SequenceForm[
   Style["With ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`H -> -Dot[
         $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]]}, {$CellContext`L -> -$CellContext`H + 
       Subscript[$CellContext`p, $CellContext`\[Theta]] $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`t] + 
       Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Phi], $CellContext`t]}, \
{$CellContext`tuDDown["\[PartialD]"][$CellContext`\[Theta], $CellContext`t] -> 
      0}, {$CellContext`Tensor[$CellContext`S, {
         Pattern[
          Pattern[$CellContext`a, 
           Blank[]], 
          
          Blank[]]}, {$CellContext`Void}] -> $CellContext`S \
$CellContext`Tensor[$CellContext`n, {$CellContext`a}, {$CellContext`Void}]}, {
     OverVector[$CellContext`S] -> $CellContext`S 
       OverVector[$CellContext`n]}, {$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {
          Pattern[$CellContext`a, 
           Blank[]]}] $CellContext`Tensor[$CellContext`n, {
          Pattern[$CellContext`a, 
           Blank[]]}, {$CellContext`Void}] -> 1}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compute e[28]: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`S[
     OverVector[$CellContext`n]] -> 
   Inactive[Integrate][$CellContext`L, $CellContext`t], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`S[
     OverVector[$CellContext`n]] -> Inactive[Integrate][
      Dot[
       $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]], $CellContext`t] + 
    Inactive[Integrate][
     Subscript[$CellContext`p, $CellContext`\[Phi]] $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Phi], $CellContext`t], $CellContext`t], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {$CellContext`S[
      OverVector[$CellContext`n]] -> -$CellContext`S 
      Inactive[Integrate][-1 + 
        Cos[$CellContext`\[Theta]], $CellContext`\[Phi]] + Inactive[Integrate][
       Dot[
        $CellContext`Tensor[$CellContext`h, {$CellContext`i}, \
{$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`S, {$CellContext`i}, \
{$CellContext`Void}]], $CellContext`t], 
    Style[" where the WZ-term appears: ", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"], 
    Style[
    4 Pi Subscript[$CellContext`W, 0] -> -$CellContext`S 
      Inactive[Integrate][-1 + 
        Cos[$CellContext`\[Theta]], $CellContext`\[Phi]], 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"], 
    Style["e[28]", 
     RGBColor[0, 
      Rational[2, 3], 0], FontFamily -> "Helvetica"]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885412531843`*^9, 3.800188900191915*^9, 
  3.800267845079809*^9},ExpressionUUID->"a3d6217f-83b7-4b3d-ba75-\
cbb0b06599dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Check variation of \!\(\*SubscriptBox[\(W\), \(0\)]\) e[30], check \
total derivative integrand: \>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$0", "=", 
    RowBox[{"$", "=", 
     RowBox[{"tuDPartial", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], " ", 
        RowBox[{"n", ".", " ", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"\[Delta]", "[", "n", "]"}], ",", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"n", ",", "\[Nu]"}], "]"}]}], "]"}]}]}], ",", "\[Mu]"}], 
      "]"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "//", 
      RowBox[{"tuDerivativeExpand", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", "[", 
          RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"productOps", "|", "Cross"}]}], "]"}]}], "//", 
     RowBox[{"expandDot", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "Expand", "}"}], ",", "2"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<with \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"n", ".", 
         RowBox[{"Cross", "[", 
          RowBox[{"a_", ",", " ", 
           RowBox[{"b", ":", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{
              RowBox[{"tuDPartial", "[", 
               RowBox[{"_", ",", "\[Nu]"}], "]"}], ",", "\[Mu]"}], "]"}]}]}], 
          "]"}]}], 
        RowBox[{"tt", ":", 
         RowBox[{"T", "[", 
          RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}]}]}], "\[Rule]", 
       RowBox[{"n", " ", 
        RowBox[{"Cross", "[", 
         RowBox[{"a", ",", 
          RowBox[{"b", " ", "tt"}]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"tuDPartial", "[", 
         RowBox[{
          RowBox[{"tuDPartial", "[", 
           RowBox[{"_", ",", "\[Nu]"}], "]"}], ",", "\[Mu]"}], "]"}], " ", 
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}]}], "\[Rule]", 
       "0"}], ",", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{"_", ",", "0"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"tuDPartial", "[", 
           RowBox[{"n", ",", "_"}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"\[Delta]", "[", "n", "]"}], ",", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"n", ",", "_"}], "]"}]}], "]"}]}], "\[Rule]", "0"}], 
        "}"}], "[", 
       RowBox[{"CG", "[", "\"\<vector identity\>\"", "]"}], "]"}]}], "}"}]}], 
   ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//.", 
     RowBox[{"tuRule", "[", "$s", "]"}]}]}], ",", "\[IndentingNewLine]", 
   "line", ",", "NL", ",", 
   RowBox[{"$0", "\[Rule]", "$"}], ",", 
   RowBox[{"CG", "[", "\"\<OK this is the first term integrand\>\"", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.7933766620191107`*^9, {3.793376733417062*^9, 3.7933768728005753`*^9}, {
   3.793376937576325*^9, 3.793377001947197*^9}, {3.793377056665902*^9, 
   3.7933771744384403`*^9}, {3.793377207806261*^9, 3.79337749278196*^9}, {
   3.79337753102171*^9, 3.7933776249068336`*^9}, {3.79337769144458*^9, 
   3.7933776920091333`*^9}, {3.793378516276984*^9, 3.793378581611998*^9}, {
   3.793378641508472*^9, 3.793378869068611*^9}, {3.7933789803119917`*^9, 
   3.793379090215981*^9}, {3.7933791448974752`*^9, 3.79337921240482*^9}, {
   3.793379258512025*^9, 3.793379299844121*^9}, {3.793379412020884*^9, 
   3.793379444102447*^9}, {3.793379475919458*^9, 3.793379608669528*^9}, {
   3.7933796456042833`*^9, 3.793379669626746*^9}, {3.793399928636552*^9, 
   3.7934002697298326`*^9}, {3.793412676859647*^9, 3.793412870163414*^9}, {
   3.793412901991091*^9, 3.793412914348597*^9}, {3.7934129467802362`*^9, 
   3.793413185811674*^9}, 3.793413228788808*^9, {3.793451122475994*^9, 
   3.793451134218835*^9}, {3.7934567715397663`*^9, 3.79345681104965*^9}, {
   3.7934568549509773`*^9, 3.793456948100855*^9}, 3.793457103035688*^9, {
   3.7934571379486217`*^9, 3.793457223648181*^9}, {3.7934573140162287`*^9, 
   3.793457450953678*^9}, {3.793457657051298*^9, 3.793457689075663*^9}, {
   3.793457992987034*^9, 3.793458051974914*^9}, {3.793458104040688*^9, 
   3.793458113622734*^9}, {3.793458713767599*^9, 3.79345874385709*^9}, {
   3.793550223211225*^9, 3.793550238016239*^9}, {3.798724479605495*^9, 
   3.798724527825637*^9}, {3.798724563482524*^9, 3.79872457314505*^9}, {
   3.7987248545028763`*^9, 3.7987248591399403`*^9}, {3.798724919831747*^9, 
   3.7987249329894037`*^9}, {3.798724997502317*^9, 3.798725053822229*^9}, {
   3.798725090551042*^9, 3.798725105447332*^9}, {3.798725298842944*^9, 
   3.798725380546114*^9}, {3.798725426698201*^9, 
   3.798725457078801*^9}},ExpressionUUID->"8e0e9a19-a0ea-4717-b709-\
9827c0d50c58"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Check variation of \\!\\(\\*SubscriptBox[\\(W\\), \
\\(0\\)]\\) e[30], check total derivative integrand: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   InterpretationBox[
    RowBox[{
     SubscriptBox[
      UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
     RowBox[{
      RowBox[{"n", ".", 
       RowBox[{
        RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
         Editable->False,
         SyntaxForm->Automatic]}]}], " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        StyleBox[
         RowBox[{"\[Mu]", "\[Nu]"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"\[Mu]", "\[Nu]"}]],
       $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "]"}],
    $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
       Cross[
        $CellContext`\[Delta][$CellContext`n], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]],
    Editable->False,
    SyntaxForm->Automatic], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], $CellContext`\
\[Mu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}], "+", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
       Editable->False,
       SyntaxForm->Automatic], ".", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"with \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"n", ".", 
        RowBox[{"a_", "\[Cross]", 
         RowBox[{"(", 
          RowBox[{"b", ":", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", 
               "_", "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`\[Nu]],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`\[Nu]], $CellContext`\[Mu]],
            Editable->False,
            SyntaxForm->Automatic]}], ")"}]}]}], " ", 
       RowBox[{"(", 
        RowBox[{"tt", ":", 
         InterpretationBox[
          SubsuperscriptBox["\[Epsilon]", 
           StyleBox[
            RowBox[{"\[Mu]", "\[Nu]"}],
            StripOnInput->False,
            ShowContents->False], 
           RowBox[{"\[Mu]", "\[Nu]"}]],
          $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], ")"}]}], "\[Rule]", 
      RowBox[{"n", " ", 
       RowBox[{"a", "\[Cross]", 
        RowBox[{"(", 
         RowBox[{"b", " ", "tt"}], ")"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], " ", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "_", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Blank[], $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`tuDDown["\[PartialD]"][
          Blank[], $CellContext`\[Nu]], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic]}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"_", "\[Cross]", "0"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "_"], "[", "n", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
           Blank[]],
          Editable->False,
          SyntaxForm->Automatic], ".", 
         RowBox[{
          RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "_"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
            Blank[]],
           Editable->False,
           SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "}"}], "[", 
      StyleBox["\<\"vector identity\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"n", ".", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
        RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
       Editable->False,
       SyntaxForm->Automatic], "\[Cross]", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
       Editable->False,
       SyntaxForm->Automatic]}]}], " ", 
    InterpretationBox[
     SubsuperscriptBox["\[Epsilon]", 
      StyleBox[
       RowBox[{"\[Mu]", "\[Nu]"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"\[Mu]", "\[Nu]"}]],
     $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
      RowBox[{
       RowBox[{"n", ".", 
        RowBox[{
         RowBox[{"\[Delta]", "[", "n", "]"}], "\[Cross]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic]}]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], "]"}],
     $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
        Cross[
         $CellContext`\[Delta][$CellContext`n], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
        Editable->False,
        SyntaxForm->Automatic]}]}], " ", 
     InterpretationBox[
      SubsuperscriptBox["\[Epsilon]", 
       StyleBox[
        RowBox[{"\[Mu]", "\[Nu]"}],
        StripOnInput->False,
        ShowContents->False], 
       RowBox[{"\[Mu]", "\[Nu]"}]],
      $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"OK this is the first term integrand\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]]}],
  SequenceForm[
   Style["Check variation of \!\(\*SubscriptBox[\(W\), \(0\)]\) e[30], check \
total derivative integrand: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   $CellContext`tuDDown["\[PartialD]"][Dot[$CellContext`n, 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Dot[$CellContext`n, 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], \
$CellContext`\[Mu]]]] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}] + Dot[$CellContext`n, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] + Dot[
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
      Cross[
       $CellContext`\[Delta][$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["with ", 
    RGBColor[0.7, 0, 1, 1], Larger], {Dot[$CellContext`n, 
       Cross[
        Pattern[$CellContext`a, 
         Blank[]], 
        Pattern[$CellContext`b, 
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`tuDDown["\[PartialD]"][
           Blank[], $CellContext`\[Nu]], $CellContext`\[Mu]]]]] 
     Pattern[$CellContext`tt, 
       $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}]] -> \
$CellContext`n 
     Cross[$CellContext`a, $CellContext`b $CellContext`tt], \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] \
$CellContext`tuDDown["\[PartialD]"][
       $CellContext`tuDDown["\[PartialD]"][
        Blank[], $CellContext`\[Nu]], $CellContext`\[Mu]] -> 0, Cross[
      Blank[], 0] -> 0, 
    {Dot[
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
        Blank[]], 
       Cross[
        $CellContext`\[Delta][$CellContext`n], 
        $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
         Blank[]]]] -> 0}[
     Style["vector identity", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Dot[$CellContext`n, 
     Cross[
      $CellContext`tuDDown["\[PartialD]"][
       $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\[LongDash]\
\[LongDash]\[LongDash]\[LongDash]\[LongDash]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`tuDDown["\[PartialD]"][
    Dot[$CellContext`n, 
       Cross[
        $CellContext`\[Delta][$CellContext`n], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], $CellContext`\
\[Mu]] -> Dot[$CellContext`n, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`\[Delta][$CellContext`n], $CellContext`\[Mu]], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["OK this is the first term integrand", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885413770723`*^9, 3.8001889005632477`*^9, 
  3.800267845173856*^9},ExpressionUUID->"066a18ab-42d9-4904-8f06-\
70a7725b1904"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.2 Fermionic model", "Subsubsection",
 CellChangeTimes->{{3.793550521896845*^9, 3.7935505261582413`*^9}, {
  3.793552479493525*^9, 
  3.793552481157394*^9}},ExpressionUUID->"7189448f-d136-4291-9e6c-\
10bf117fa4a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "34", "]"}], "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "\[Rule]", 
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ct", "[", "\[Psi]", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"I", " ", 
              RowBox[{"tuDPartial", "[", 
               RowBox[{"_", ",", "t"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"CG", "[", "\"\<coupling\>\"", "]"}], "]"}], " ", 
              RowBox[{
               OverscriptBox["n", "\[RightVector]"], ".", 
               OverscriptBox["\[Sigma]", "\[RightVector]"]}]}]}], ")"}], ".", 
           "\[Psi]"}], ",", "t"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", "[", 
              RowBox[{"\[Psi]", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"T", "[", 
               RowBox[{"\[Psi]", ",", "\"\<d\>\"", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], "}"}], "}"}]}], "}"}]}], 
         "}"}], "[", 
        RowBox[{"CG", "[", "\"\<spinor\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], ".", 
            OverscriptBox["n", "\[RightVector]"]}], "\[Rule]", "1"}]}], "}"}],
         "[", 
        RowBox[{"CG", "[", "\"\<bosonic field\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["S", "iE"], "\[Rule]", 
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ct", "[", "\[Psi]", "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tuDPartial", "[", 
                RowBox[{"_", ",", "t"}], "]"}], "-", 
               RowBox[{"m", " ", 
                RowBox[{
                 OverscriptBox["n", "\[RightVector]"], ".", 
                 OverscriptBox["\[Sigma]", "\[RightVector]"]}]}]}], ")"}], 
             ".", "\[Psi]"}], ",", "t"}], "]"}]}], "}"}], "[", 
        RowBox[{"CG", "[", "\"\<Wick rotated\>\"", "]"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ColumnForms", "[", 
       RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7935505303656816`*^9, 3.793550533446355*^9}, {
  3.793550770937454*^9, 3.793550893236362*^9}, {3.793550928274156*^9, 
  3.793551053645763*^9}, {3.7935511563031473`*^9, 3.793551190638111*^9}, {
  3.793551355149445*^9, 3.793551438848568*^9}, {3.7935514890063963`*^9, 
  3.793551500741671*^9}, {3.793551661007389*^9, 3.793551746990696*^9}, {
  3.793552429972137*^9, 3.793552431921056*^9}, {3.7935524857674437`*^9, 
  3.7935525138785753`*^9}, {3.795264495273753*^9, 
  3.795264498670789*^9}},ExpressionUUID->"71b0aea1-7001-4a57-980e-\
bab740d9857d"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"S", "\[Rule]", 
      TemplateBox[{RowBox[{
          InterpretationBox[
           SuperscriptBox["\[Psi]", "\[Dagger]"], 
           ConjugateTranspose[$CellContext`\[Psi]], SyntaxForm -> Automatic, 
           Editable -> False], ".", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{
                RowBox[{
                  OverscriptBox["n", "\[RightVector]"], ".", 
                  OverscriptBox["\[Sigma]", "\[RightVector]"]}], " ", 
                RowBox[{"m", "[", 
                  StyleBox["\"coupling\"", 
                   RGBColor[0, 
                    Rational[2, 3], 0], FontFamily -> "Helvetica", 
                   StripOnInput -> False], "]"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "_", 
                   "]"}], 
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t], SyntaxForm -> Automatic, Editable -> 
                 False]}]}], ")"}], ".", "\[Psi]"}],"t"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"\[Psi]", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              InterpretationBox[
               SubsuperscriptBox["\[Psi]", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`\[Psi], {$CellContext`Void}, {
                1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               InterpretationBox[
                SubsuperscriptBox["\[Psi]", "2", 
                 StyleBox["2",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`\[Psi], {$CellContext`Void}, \
{2}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "}"}], "}"}]}], "}"}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"spinor\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "}"}]}]},
         {
          RowBox[{
           RowBox[{
            OverscriptBox["n", "\[RightVector]"], ".", 
            OverscriptBox["n", "\[RightVector]"]}], "\[Rule]", "1"}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"bosonic field\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox["S", 
            StyleBox["\<\"E\"\>",
             StripOnInput->False,
             FontSlant->Italic]], "\[Rule]", 
           TemplateBox[{RowBox[{
               InterpretationBox[
                SuperscriptBox["\[Psi]", "\[Dagger]"], 
                ConjugateTranspose[$CellContext`\[Psi]], SyntaxForm -> 
                Automatic, Editable -> False], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    RowBox[{"-", "m"}], " ", 
                    RowBox[{
                    OverscriptBox["n", "\[RightVector]"], ".", 
                    OverscriptBox["\[Sigma]", "\[RightVector]"]}]}], "+", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "_", 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}], ".", "\[Psi]"}],"t"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Wick rotated\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{3.800188541476932*^9, 3.80018890074105*^9, 
  3.800267845243741*^9},ExpressionUUID->"3b0a42a9-6e27-44db-986d-\
02f172a522ee"]
}, Open  ]],

Cell["Effective action by chiral rotation trick", "Text",
 CellChangeTimes->{{3.7935520055302267`*^9, 
  3.793552016888139*^9}},ExpressionUUID->"a26c980c-5b9a-4098-9951-\
8fe074881df0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PR", "[", 
    RowBox[{
    "\"\<Effective action by chiral rotation trick\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "36", "]"}], "=", 
       RowBox[{"$", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Z", "\[Rule]", 
           RowBox[{"xIntegral", "[", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               SubscriptBox["S", "eff"]}], "]"}], ",", "n"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["S", "eff"], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 SubscriptBox["S", "iE"]}], "]"}], ",", "\[Psi]", ",", 
               RowBox[{"OverBar", "[", "\[Psi]", "]"}]}], "]"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["S", "eff"], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             RowBox[{"Det", "[", "iD", "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$s", "=", 
           RowBox[{"iD", "->", 
            RowBox[{
             RowBox[{"tuDPartial", "[", 
              RowBox[{"_", ",", "t"}], "]"}], "-", 
             RowBox[{"m", " ", 
              RowBox[{
               OverscriptBox["n", "\[RightVector]"], ".", 
               OverscriptBox["\[Sigma]", "\[RightVector]"]}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$su", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ct", "[", "U", "]"}], ".", 
                    OverscriptBox["n", "\[RightVector]"], ".", 
                    OverscriptBox["\[Sigma]", "\[RightVector]"], ".", "U"}], "->", 
                   RowBox[{"T", "[", 
                    RowBox[{"u", ",", "\"\<d\>\"", ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}]}], "}"}], "[", 
                 RowBox[{"CG", "[", 
                  RowBox[{"\"\<intro \>\"", ",", 
                   RowBox[{"U", "\[Element]", 
                    RowBox[{"SU", "[", "2", "]"}]}]}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"$su", "=", 
                  RowBox[{"tuRule1", "[", "$su", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    OverscriptBox["a", "^"], "\[Rule]", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"ct", "[", "U", "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"I", " ", 
                    SubscriptBox[
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"_", ",", "t"}], "]"}], 
                    RowBox[{"\[Omega]", "\[NotEqual]", "0"}]]}], ")"}], ".", 
                    "U"}]}], "+", 
                    RowBox[{
                    RowBox[{"ct", "[", "U", "]"}], ".", 
                    RowBox[{"(", " ", 
                    RowBox[{"I", " ", 
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"_", ",", "t"}], "]"}]}], ")"}], ".", "U"}]}]}], 
                   "}"}], "[", 
                  RowBox[{
                  "CG", "[", 
                   "\"\<in anticipation of Fourier transform--ERROR IN TEXT\>\
\"", "]"}], "]"}]}]}], "}"}]}], ",", 
             RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"$su1", "=", 
                RowBox[{"tuRuleSolve", "[", 
                 RowBox[{
                  RowBox[{"$su", "//", 
                   RowBox[{"expandDot", "[", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ct", "[", "U", "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"_", ",", "t"}], "]"}], ")"}], ".", "U"}], 
                   "}"}]}], "]"}]}], "}"}], "[", 
              RowBox[{
              "CG", "[", "\"\<\!\(\*OverscriptBox[\(a\), \(^\)]\) gauge\>\"", 
               "]"}], "]"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"$", "=", 
              RowBox[{
               OverscriptBox["iD", "~"], "->", 
               RowBox[{
                RowBox[{"ct", "[", "U", "]"}], ".", "iD", ".", "U"}]}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"$", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "/.", "$s"}]}], ";", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"$", "=", 
                 RowBox[{"$", "//", 
                  RowBox[{"expandDot", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$su", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "$su1"}], "}"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}]}], "}"}], "[", 
               RowBox[{"CR", "[", "\"\<e[38]\>\"", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["G", "0"], "\[Rule]", 
                 RowBox[{"inv", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ct", "[", "U", "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "I"}], "  ", 
                    SubscriptBox[
                    RowBox[{"tuDPartial", "[", 
                    RowBox[{"_", ",", "t"}], "]"}], 
                    RowBox[{"\[Omega]", "\[NotEqual]", "0"}]]}], ")"}], ".", 
                    "U"}], "-", 
                   RowBox[{"m", " ", 
                    RowBox[{"T", "[", 
                    RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}]}]}], "]"}]}], ",", 
                RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"$", "=", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   OverscriptBox["iD", "~"], "]"}], "\[Rule]", 
                  RowBox[{"Log", "[", 
                   RowBox[{
                    RowBox[{"inv", "[", 
                    SubscriptBox["G", "0"], "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    RowBox[{"I", " ", 
                    OverscriptBox["a", "^"]}], ")"}]}]}], ")"}]}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"$", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                   RowBox[{
                    RowBox[{"Log", "[", "a_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"-", 
                    RowBox[{"Log", "[", 
                    RowBox[{"inv", "[", "a", "]"}], "]"}]}]}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"$", "=", 
                  RowBox[{
                   RowBox[{"$", "/.", 
                    RowBox[{
                    RowBox[{"ii", ":", 
                    RowBox[{"inv", "[", "a__", "]"}]}], "\[RuleDelayed]", 
                    RowBox[{"Distribute", "[", 
                    RowBox[{"ii", ",", "Dot"}], "]"}]}]}], "/.", 
                   RowBox[{
                    RowBox[{"inv", "[", 
                    RowBox[{"inv", "[", "a_", "]"}], "]"}], "\[Rule]", 
                    "a"}]}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"$", "=", 
                 RowBox[{"$", "/.", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["G", "0"], ".", " ", 
                    RowBox[{"aa", ":", 
                    RowBox[{"inv", "[", 
                    RowBox[{"bb", ":", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "b_"}], ")"}]}], "]"}]}]}], 
                   "\[RuleDelayed]", 
                   RowBox[{
                    SubscriptBox["G", "0"], ".", " ", 
                    RowBox[{"Series", "[", 
                    RowBox[{
                    RowBox[{"1", "/", "bb"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "0", ",", "2"}], "}"}]}], 
                    "]"}]}]}]}]}]}], "\[IndentingNewLine]", "}"}], "[", 
              RowBox[{
              "CG", "[", 
               "\"\<e[40] our calculation the \
\!\(\*SubscriptBox[\(\[PartialD]\), \(t\)]\) term is missing, continuing\>\"",
                "]"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "}"}], "[", 
           RowBox[{"CG", "[", "\"\<e[36] chiral rotation\>\"", "]"}], "]"}]}],
          "\[IndentingNewLine]", "}"}]}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ColumnForms", "[", 
          RowBox[{"#1", ",", "8"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.793552018639544*^9, 3.793552324616243*^9}, {
   3.793552372980875*^9, 3.793552384890018*^9}, {3.793552503141828*^9, 
   3.793552508493784*^9}, {3.793553198836808*^9, 3.793553359526146*^9}, {
   3.793553390309462*^9, 3.7935533905972433`*^9}, {3.793553511088605*^9, 
   3.793553585867518*^9}, {3.793553634178632*^9, 3.793553910821775*^9}, 
   3.793553980655903*^9, {3.7936653028348227`*^9, 3.79366530699327*^9}, {
   3.79379722749327*^9, 3.793797292810246*^9}, {3.7938014390876513`*^9, 
   3.793801463656444*^9}, {3.793801694483705*^9, 3.793801786248776*^9}, {
   3.7938018319303217`*^9, 3.793801865913595*^9}, {3.793803730486381*^9, 
   3.793803731558309*^9}, {3.7938037735535593`*^9, 3.793803803073366*^9}, {
   3.7938038604818983`*^9, 3.79380391489404*^9}, {3.793803945726767*^9, 
   3.793803966238665*^9}, {3.793803997421762*^9, 3.793804130444098*^9}, {
   3.7938041639486*^9, 3.793804177835268*^9}, {3.793804281956501*^9, 
   3.793804631058752*^9}, {3.793804668408433*^9, 3.793804684080779*^9}, {
   3.7938047203646803`*^9, 3.793804775657501*^9}, {3.793807096450478*^9, 
   3.793807133915852*^9}, {3.7938077350508013`*^9, 3.793807865443741*^9}, {
   3.7938079045849*^9, 3.793808005320139*^9}, {3.7938132114582872`*^9, 
   3.793813215599736*^9}, {3.793969365577335*^9, 3.7939693884082127`*^9}, {
   3.793969435289707*^9, 3.79396945408185*^9}, {3.7939695007352257`*^9, 
   3.793969544393848*^9}, {3.7939696194482718`*^9, 3.7939696205172787`*^9}, {
   3.793969672045554*^9, 3.793969762379436*^9}, {3.793969793623527*^9, 
   3.793969794772258*^9}, {3.793969835217094*^9, 3.7939698977617893`*^9}, {
   3.79397001062254*^9, 3.793970022180347*^9}, {3.7939701050397882`*^9, 
   3.7939701336897783`*^9}, 3.793970237956258*^9, {3.793970311672668*^9, 
   3.793970318270973*^9}, {3.793970500055188*^9, 3.7939706044984007`*^9}, {
   3.7939713044297333`*^9, 3.7939713186987247`*^9}, {3.793971381787529*^9, 
   3.793971384333652*^9}, {3.793971724911243*^9, 3.79397172604281*^9}, {
   3.793971853797357*^9, 3.7939718563974133`*^9}, {3.793971891528474*^9, 
   3.7939718938849487`*^9}, 3.793972341446134*^9, {3.793975622376128*^9, 
   3.793975639005877*^9}, 3.793976188646887*^9, {3.793976236730195*^9, 
   3.793976244098377*^9}, 3.793976340241497*^9, {3.793976380200575*^9, 
   3.793976391416357*^9}, {3.794060394876951*^9, 3.7940604596302223`*^9}, {
   3.79622456958383*^9, 
   3.7962246226581993`*^9}},ExpressionUUID->"6dcdcb7b-77b3-4600-b901-\
7285be1db96d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Effective action by chiral rotation trick\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{"Z", "\[Rule]", 
        TemplateBox[{SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
             SubscriptBox["S", "eff"]}]],"n"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}]},
      {
       RowBox[{
        SubscriptBox["S", "eff"], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          TemplateBox[{SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
               SubscriptBox["S", 
                StyleBox["\"E\"", Italic, StripOnInput -> False]]}]],"\[Psi]",
            OverscriptBox["\[Psi]", "_"]},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{
                StyleBox["\[Integral]", "Inactive"], 
                RowBox[{#, 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #3}], 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2, ",", #3}], "]"}]& )], "]"}]}]}]},
      {
       RowBox[{
        SubscriptBox["S", "eff"], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"Det", "[", 
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "]"}], "]"}]}]}]},
      {
       RowBox[{
        StyleBox["\<\"D\"\>",
         StripOnInput->False,
         FontSlant->Italic], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "m"}], " ", 
          RowBox[{
           OverscriptBox["n", "\[RightVector]"], ".", 
           OverscriptBox["\[Sigma]", "\[RightVector]"]}]}], "+", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Blank[], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}]}]},
      {
       RowBox[{
        TagBox[GridBox[{
           {
            TagBox[GridBox[{
               {
                RowBox[{
                 TagBox[GridBox[{
                    {
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    OverscriptBox["n", "\[RightVector]"], ".", 
                    OverscriptBox["\[Sigma]", "\[RightVector]"], ".", "U"}], 
                    "\[Rule]", 
                    InterpretationBox[
                    SubsuperscriptBox["u", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`u, {$CellContext`Void}, {
                    3}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False]}]}
                   },
                   AutoDelete->False,
                   FrameStyle->Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]],
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Grid"], "[", 
                 RowBox[{
                  StyleBox["\<\"intro \"\>",
                   StripOnInput->False,
                   LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   FontFamily->"Helvetica",
                   FontColor->RGBColor[0, 
                    Rational[2, 3], 0]], ",", 
                  StyleBox[
                   RowBox[{"U", "\[Element]", 
                    RowBox[{"SU", "[", "2", "]"}]}],
                   StripOnInput->False,
                   LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                   FontFamily->"Helvetica",
                   FontColor->RGBColor[0, 
                    Rational[2, 3], 0]]}], "]"}]},
               {
                RowBox[{
                 TagBox[GridBox[{
                    {
                    RowBox[{
                    OverscriptBox["a", "^"], "\[Rule]", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SubscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], 
                    RowBox[{"\[Omega]", "\[NotEqual]", "0"}]]}], ")"}], ".", 
                    "U"}]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], ")"}], ".", "U"}]}]}]}
                   },
                   AutoDelete->False,
                   FrameStyle->Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]],
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Grid"], "[", 
                 
                 StyleBox["\<\"in anticipation of Fourier transform--ERROR IN \
TEXT\"\>",
                  StripOnInput->False,
                  LineColor->RGBColor[0, 
                    Rational[2, 3], 0],
                  FrontFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                  BackFaceColor->RGBColor[0, 
                    Rational[2, 3], 0],
                  GraphicsColor->RGBColor[0, 
                    Rational[2, 3], 0],
                  FontFamily->"Helvetica",
                  FontColor->RGBColor[0, 
                    Rational[2, 3], 0]], "]"}]}
              },
              AutoDelete->False,
              FrameStyle->Directive[
                RGBColor[0.7, 0, 1, 1], 
                Thickness[Tiny]],
              GridBoxAlignment->{"Columns" -> {{Left}}},
              GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
             "Grid"]},
           {
            RowBox[{
             TagBox[GridBox[{
                {
                 TagBox[GridBox[{
                    {
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], ".", "U"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    SubscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], 
                    RowBox[{"\[Omega]", "\[NotEqual]", "0"}]], ".", "U"}], 
                    "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}]}]}]}
                   },
                   AutoDelete->False,
                   FrameStyle->Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]],
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Grid"]}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "[", 
             
             StyleBox["\<\"\\!\\(\\*OverscriptBox[\\(a\\), \\(^\\)]\\) \
gauge\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]},
           {
            RowBox[{
             OverscriptBox[
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "~"], "\[Rule]", 
             RowBox[{
              InterpretationBox[
               SuperscriptBox["U", "\[Dagger]"],
               ConjugateTranspose[$CellContext`U],
               Editable->False,
               SyntaxForm->Automatic], ".", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], ".", "U"}]}]},
           {
            RowBox[{
             TagBox[GridBox[{
                {
                 RowBox[{
                  OverscriptBox[
                   StyleBox["\<\"D\"\>",
                    StripOnInput->False,
                    FontSlant->Italic], "~"], "\[Rule]", 
                  RowBox[{
                   RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    SubscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], 
                    RowBox[{"\[Omega]", "\[NotEqual]", "0"}]], ".", "U"}], 
                   "-", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}], "-", 
                   RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["u", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`u, {$CellContext`Void}, {
                    3}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False]}]}]}]}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "[", 
             StyleBox["\<\"e[38]\"\>",
              StripOnInput->False,
              LineColor->RGBColor[1, 0, 0],
              FrontFaceColor->RGBColor[1, 0, 0],
              BackFaceColor->RGBColor[1, 0, 0],
              GraphicsColor->RGBColor[1, 0, 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[1, 0, 0]], "]"}]},
           {
            RowBox[{
             TagBox[GridBox[{
                {
                 RowBox[{
                  SubscriptBox["G", "0"], "\[Rule]", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"],
                    ConjugateTranspose[$CellContext`U],
                    Editable->False,
                    SyntaxForm->Automatic], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    SubscriptBox[
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], 
                    RowBox[{"\[Omega]", "\[NotEqual]", "0"}]]}], ")"}], ".", 
                    "U"}], "-", 
                    RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False], "3"],
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False]}]}], ")"}], "\<\"-1\"\>"]}]},
                {
                 RowBox[{
                  RowBox[{"Log", "[", 
                   OverscriptBox[
                    StyleBox["\<\"D\"\>",
                    StripOnInput->False,
                    FontSlant->Italic], "~"], "]"}], "\[Rule]", 
                  RowBox[{"Log", "[", 
                   RowBox[{
                    SubsuperscriptBox["G", "0", "\<\"-1\"\>"], ".", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}], ")"}]}]}], ")"}]}], "]"}]}]},
                {
                 RowBox[{
                  RowBox[{"Log", "[", 
                   OverscriptBox[
                    StyleBox["\<\"D\"\>",
                    StripOnInput->False,
                    FontSlant->Italic], "~"], "]"}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}], ")"}]}]}], 
                    ")"}], "\<\"-1\"\>"]}], "]"}]}]}]},
                {
                 RowBox[{
                  RowBox[{"Log", "[", 
                   OverscriptBox[
                    StyleBox["\<\"D\"\>",
                    StripOnInput->False,
                    FontSlant->Italic], "~"], "]"}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    InterpretationBox[
                    RowBox[{"1", "+", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}], ")"}]}], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}], ")"}]}], ")"}], "2"], "+", 
                    InterpretationBox[
                    SuperscriptBox[
                    RowBox[{"O", "[", 
                    RowBox[{
                    SubscriptBox["G", "0"], ".", 
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    OverscriptBox["a", "^"]}], ")"}]}], "]"}], "3"],
                    SeriesData[
                    Dot[
                    Subscript[$CellContext`G, 0], Complex[0, 1] 
                    OverHat[$CellContext`a]], 0, {}, 0, 3, 1],
                    Editable->False]}],
                    SeriesData[
                    Dot[
                    Subscript[$CellContext`G, 0], Complex[0, 1] 
                    OverHat[$CellContext`a]], 0, {1, 1, 1}, 0, 3, 1],
                    Editable->False], ")"}]}], "]"}]}]}]}
               },
               AutoDelete->False,
               FrameStyle->Directive[
                 RGBColor[0.7, 0, 1, 1], 
                 Thickness[Tiny]],
               GridBoxAlignment->{"Columns" -> {{Left}}},
               GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"], "[", 
             
             StyleBox["\<\"e[40] our calculation the \
\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \\(t\\)]\\) term is missing, \
continuing\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"], "[", 
        StyleBox["\<\"e[36] chiral rotation\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], "]"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Effective action by chiral rotation trick", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`Z -> 
      Inactive[Integrate][
       E^(-Subscript[$CellContext`S, $CellContext`eff]), $CellContext`n]}, {
     Subscript[$CellContext`S, $CellContext`eff] -> -Log[
         Inactive[Integrate][E^(-Subscript[$CellContext`S, 
             Style["E", Italic]]), $CellContext`\[Psi], 
          OverBar[$CellContext`\[Psi]]]]}, {
     Subscript[$CellContext`S, $CellContext`eff] -> -Log[
         Det[
          Style["D", Italic]]]}, {Style["D", Italic] -> -$CellContext`m Dot[
          OverVector[$CellContext`n], 
          OverVector[$CellContext`\[Sigma]]] + $CellContext`tuDDown[
        "\[PartialD]"][
         Blank[], $CellContext`t]}, {
      Grid[{{
         Grid[{{
            Grid[{{Dot[
                 ConjugateTranspose[$CellContext`U], 
                 OverVector[$CellContext`n], 
                 
                 OverVector[$CellContext`\[Sigma]], $CellContext`U] -> \
$CellContext`Tensor[$CellContext`u, {$CellContext`Void}, {3}]}}, 
             Dividers -> {{True}, {False}}, FrameStyle -> Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]], Alignment -> Left][
             Style["intro ", 
              RGBColor[0, 
               Rational[2, 3], 0], FontFamily -> "Helvetica"], 
             Style[
              Element[$CellContext`U, 
               $CellContext`SU[2]], 
              RGBColor[0, 
               Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
            Grid[{{OverHat[$CellContext`a] -> -Dot[
                   ConjugateTranspose[$CellContext`U], Complex[0, 1] Subscript[
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`\[Omega] != 
                    0], $CellContext`U] + Dot[
                  ConjugateTranspose[$CellContext`U], 
                  Complex[0, 1] $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`U]}}, 
             Dividers -> {{True}, {False}}, FrameStyle -> Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]], Alignment -> Left][
             Style["in anticipation of Fourier transform--ERROR IN TEXT", 
              RGBColor[0, 
               Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left]}, {
         Grid[{{
            Grid[{{Dot[
                 ConjugateTranspose[$CellContext`U], 
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t], $CellContext`U] -> Dot[
                  ConjugateTranspose[$CellContext`U], 
                  Subscript[
                   $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`\[Omega] != 
                   0], $CellContext`U] + 
                Complex[0, -1] OverHat[$CellContext`a]}}, 
             Dividers -> {{True}, {False}}, FrameStyle -> Directive[
               RGBColor[0.7, 0, 1, 1], 
               Thickness[Tiny]], Alignment -> Left]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["\!\(\*OverscriptBox[\(a\), \(^\)]\) gauge", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {OverTilde[
           Style["D", Italic]] -> Dot[
           ConjugateTranspose[$CellContext`U], 
           Style["D", Italic], $CellContext`U]}, {
         Grid[{{OverTilde[
              Style["D", Italic]] -> Dot[
               ConjugateTranspose[$CellContext`U], 
               Subscript[
                $CellContext`tuDDown["\[PartialD]"][
                 Blank[], $CellContext`t], $CellContext`\[Omega] != 
                0], $CellContext`U] + 
             Complex[0, -1] 
              OverHat[$CellContext`a] - $CellContext`m \
$CellContext`Tensor[$CellContext`u, {$CellContext`Void}, {3}]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style["e[38]", 
           RGBColor[1, 0, 0], FontFamily -> "Helvetica"]]}, {
         Grid[{{Subscript[$CellContext`G, 0] -> (Dot[
                ConjugateTranspose[$CellContext`U], Complex[0, -1] Subscript[
                  $CellContext`tuDDown["\[PartialD]"][
                   Blank[], $CellContext`t], $CellContext`\[Omega] != 
                  0], $CellContext`U] - $CellContext`m \
$CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}])^"-1"}, {
           Log[
              OverTilde[
               Style["D", Italic]]] -> Log[
              Dot[Subscript[$CellContext`G, 0]^"-1", 1 - Dot[
                Subscript[$CellContext`G, 0], Complex[0, 1] 
                OverHat[$CellContext`a]]]]}, {Log[
              OverTilde[
               Style["D", Italic]]] -> -Log[
               Dot[
                Subscript[$CellContext`G, 0], (1 - Dot[
                  Subscript[$CellContext`G, 0], Complex[0, 1] 
                  OverHat[$CellContext`a]])^"-1"]]}, {Log[
              OverTilde[
               Style["D", Italic]]] -> -Log[
               Dot[
                Subscript[$CellContext`G, 0], 
                SeriesData[
                 Dot[
                  Subscript[$CellContext`G, 0], Complex[0, 1] 
                  OverHat[$CellContext`a]], 0, {1, 1, 1}, 0, 3, 1]]]}}, 
          Dividers -> {{True}, {False}}, FrameStyle -> Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]], Alignment -> Left][
          Style[
          "e[40] our calculation the \!\(\*SubscriptBox[\(\[PartialD]\), \
\(t\)]\) term is missing, continuing", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["e[36] chiral rotation", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885416474752`*^9, 3.8001889009747*^9, 
  3.800267845329795*^9},ExpressionUUID->"161845f0-8d2b-4d00-9421-\
83893a37004f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<Expanding \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{
         SubscriptBox["S", "eff"], ",", 
         RowBox[{"{", "iD", "}"}]}], "]"}], "[", 
       RowBox[{"e", "[", "36", "]"}], "]"}], "//", "tuRule1"}]}], ",", 
    "\[IndentingNewLine]", "yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"iD", "\[Rule]", 
       OverscriptBox["iD", "~"]}]}]}], ",", "\[IndentingNewLine]", "yield", 
    ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Det", "[", "a_", "]"}], "]"}], "\[Rule]", 
       RowBox[{"-", 
        RowBox[{"Tr", "[", 
         RowBox[{"-", 
          RowBox[{"Log", "[", "a", "]"}]}], "]"}]}]}]}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Substituting \>\"", ",", 
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "36", "]"}], "//", 
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{
         RowBox[{"Log", "[", 
          OverscriptBox["iD", "~"], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"inv", "[", "_", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Log", "[", "_", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "//", "tuRule1"}]}], ",", 
    "\[IndentingNewLine]", "Yield", ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "/.", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"a_", " ", ".", " ", "b_"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "a", "]"}], "+", 
        RowBox[{"Log", "[", "b", "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
    "NL", ",", "\"\<Taylor expansion:\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "42", "]"}], "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$", "=", 
          RowBox[{"$", "/.", 
           RowBox[{
            RowBox[{"ll", ":", 
             RowBox[{"Log", "[", 
              RowBox[{"inv", "[", 
               RowBox[{"(", 
                RowBox[{"1", "-", "a_"}], ")"}], "]"}], "]"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"Series", "[", 
             RowBox[{
              RowBox[{"ll", "/.", 
               RowBox[{
                RowBox[{"inv", "[", "b_", "]"}], "\[Rule]", 
                RowBox[{"1", "/", "b"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"$", "/.", 
          RowBox[{
           RowBox[{"tt", ":", 
            RowBox[{"Tr", "[", "_", "]"}]}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"tuOpDistributeF", "[", "Tr", "]"}], "[", 
            RowBox[{"tt", "//", "Normal"}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", 
    RowBox[{"CG", "[", "\"\<e[42]\>\"", "]"}], ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "44", "]"}], "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"e", "[", "42", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "0", "]"}], 
          "\[Rule]", 
          RowBox[{
           RowBox[{"tuTermExtract", "[", 
            RowBox[{"Tr", "[", 
             RowBox[{"Log", "[", "_", "]"}], "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"e", "[", "42", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"e", "[", "42", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "1", "]"}], 
          "\[Rule]", 
          RowBox[{
           RowBox[{"tuTermExtract", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Tr", "[", "_", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log", "[", "_", "]"}], ",", 
               RowBox[{"Power", "[", 
                RowBox[{"_", ",", "_"}], "]"}]}], "}"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"e", "[", "42", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"e", "[", "42", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "2", "]"}], 
          "\[Rule]", 
          RowBox[{
           RowBox[{"tuTermExtract", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Power", "[", 
               RowBox[{"_", ",", "_"}], "]"}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"e", "[", "42", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.793552018639544*^9, 3.793552324616243*^9}, {
   3.793552372980875*^9, 3.793552384890018*^9}, {3.793552503141828*^9, 
   3.793552508493784*^9}, {3.793553198836808*^9, 3.793553359526146*^9}, {
   3.793553390309462*^9, 3.7935533905972433`*^9}, {3.793553511088605*^9, 
   3.793553585867518*^9}, {3.793553634178632*^9, 3.793553910821775*^9}, 
   3.793553980655903*^9, {3.7936653028348227`*^9, 3.79366530699327*^9}, {
   3.79379722749327*^9, 3.793797292810246*^9}, {3.7938014390876513`*^9, 
   3.793801463656444*^9}, {3.793801694483705*^9, 3.793801786248776*^9}, {
   3.7938018319303217`*^9, 3.793801865913595*^9}, {3.793803730486381*^9, 
   3.793803731558309*^9}, {3.7938037735535593`*^9, 3.793803803073366*^9}, {
   3.7938038604818983`*^9, 3.79380391489404*^9}, {3.793803945726767*^9, 
   3.793803966238665*^9}, {3.793803997421762*^9, 3.793804130444098*^9}, {
   3.7938041639486*^9, 3.793804177835268*^9}, {3.793804281956501*^9, 
   3.793804631058752*^9}, {3.793804668408433*^9, 3.793804684080779*^9}, {
   3.7938047203646803`*^9, 3.793804775657501*^9}, {3.793807096450478*^9, 
   3.793807133915852*^9}, {3.7938077350508013`*^9, 3.793807865443741*^9}, {
   3.7938079045849*^9, 3.793808005320139*^9}, {3.7938132114582872`*^9, 
   3.793813215599736*^9}, {3.793969365577335*^9, 3.7939693884082127`*^9}, {
   3.793969435289707*^9, 3.79396945408185*^9}, {3.7939695007352257`*^9, 
   3.793969544393848*^9}, {3.7939696194482718`*^9, 3.7939696205172787`*^9}, {
   3.793969672045554*^9, 3.793969762379436*^9}, {3.793969793623527*^9, 
   3.793969794772258*^9}, {3.793969835217094*^9, 3.7939698977617893`*^9}, {
   3.79397001062254*^9, 3.793970022180347*^9}, {3.7939701050397882`*^9, 
   3.7939701336897783`*^9}, 3.793970237956258*^9, {3.793970311672668*^9, 
   3.793970318270973*^9}, {3.793970500055188*^9, 3.793970674957962*^9}, {
   3.7939707322784653`*^9, 3.793970813193972*^9}, {3.7939708684030533`*^9, 
   3.7939709083841248`*^9}, {3.793970961332638*^9, 3.793971006824699*^9}, {
   3.793971938510819*^9, 3.793971950251156*^9}, {3.793972079958992*^9, 
   3.793972122157496*^9}, {3.793972167681301*^9, 3.793972175281516*^9}, {
   3.79397237986718*^9, 3.7939723900717382`*^9}, {3.79397242509482*^9, 
   3.793972426806464*^9}, {3.793972489135065*^9, 3.793972501188836*^9}, {
   3.793972534108727*^9, 3.7939725648129*^9}, {3.7939726081246634`*^9, 
   3.7939727999982758`*^9}, {3.793972834342433*^9, 3.79397284008602*^9}, {
   3.793972874491922*^9, 3.7939729457196493`*^9}, {3.793972981155128*^9, 
   3.7939730382315893`*^9}, {3.793973099762495*^9, 3.793973182959033*^9}, {
   3.7939738852950974`*^9, 3.793973948280497*^9}, {3.7939739926653*^9, 
   3.793974317675085*^9}, {3.793974358882042*^9, 3.793974449457809*^9}, {
   3.793974550039494*^9, 3.793974566718604*^9}, 3.7939746025152082`*^9, 
   3.793974667285125*^9, {3.793974780451481*^9, 3.793974817770589*^9}, {
   3.793974847963541*^9, 3.793975248245531*^9}, {3.793975388990961*^9, 
   3.7939754021001253`*^9}},ExpressionUUID->"18eb4fec-c071-4751-baf1-\
99348065f649"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Expanding \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["S", "eff"], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"Log", "[", 
      RowBox[{"Det", "[", 
       StyleBox["\<\"D\"\>",
        StripOnInput->False,
        FontSlant->Italic], "]"}], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["S", "eff"], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"Log", "[", 
      RowBox[{"Det", "[", 
       OverscriptBox[
        StyleBox["\<\"D\"\>",
         StripOnInput->False,
         FontSlant->Italic], "~"], "]"}], "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["S", "eff"], "\[Rule]", 
    RowBox[{"Tr", "[", 
     RowBox[{"-", 
      RowBox[{"Log", "[", 
       OverscriptBox[
        StyleBox["\<\"D\"\>",
         StripOnInput->False,
         FontSlant->Italic], "~"], "]"}]}], "]"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Substituting \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Log", "[", 
     OverscriptBox[
      StyleBox["\<\"D\"\>",
       StripOnInput->False,
       FontSlant->Italic], "~"], "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"Log", "[", 
      RowBox[{
       SubscriptBox["G", "0"], ".", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SubscriptBox["G", "0"], ".", 
           RowBox[{"(", 
            RowBox[{"\[ImaginaryI]", " ", 
             OverscriptBox["a", "^"]}], ")"}]}]}], ")"}], "\<\"-1\"\>"]}], 
      "]"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SubscriptBox["S", "eff"], "\[Rule]", 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"Log", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SubscriptBox["G", "0"], ".", 
           RowBox[{"(", 
            RowBox[{"\[ImaginaryI]", " ", 
             OverscriptBox["a", "^"]}], ")"}]}]}], ")"}], "\<\"-1\"\>"], 
       "]"}], "+", 
      RowBox[{"Log", "[", 
       SubscriptBox["G", "0"], "]"}]}], "]"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Taylor expansion:\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        SubscriptBox["S", "eff"], "\[Rule]", 
        RowBox[{"Tr", "[", 
         InterpretationBox[
          RowBox[{
           RowBox[{"Log", "[", 
            SubscriptBox["G", "0"], "]"}], "+", 
           RowBox[{
            SubscriptBox["G", "0"], ".", 
            RowBox[{"(", 
             RowBox[{"\[ImaginaryI]", " ", 
              OverscriptBox["a", "^"]}], ")"}]}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["G", "0"], ".", 
               RowBox[{"(", 
                RowBox[{"\[ImaginaryI]", " ", 
                 OverscriptBox["a", "^"]}], ")"}]}], ")"}], "2"]}], "+", 
           InterpretationBox[
            SuperscriptBox[
             RowBox[{"O", "[", 
              RowBox[{
               SubscriptBox["G", "0"], ".", 
               RowBox[{"(", 
                RowBox[{"\[ImaginaryI]", " ", 
                 OverscriptBox["a", "^"]}], ")"}]}], "]"}], "3"],
            SeriesData[
             Dot[
              Subscript[$CellContext`G, 0], Complex[0, 1] 
              OverHat[$CellContext`a]], 0, {}, 0, 3, 1],
            Editable->False]}],
          SeriesData[
           Dot[
            Subscript[$CellContext`G, 0], Complex[0, 1] 
            OverHat[$CellContext`a]], 0, {
            Log[
             Subscript[$CellContext`G, 0]], 1, 
            Rational[1, 2]}, 0, 3, 1],
          Editable->False], "]"}]}]},
      {
       RowBox[{
        SubscriptBox["S", "eff"], "\[Rule]", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{
           SubscriptBox["G", "0"], ".", 
           RowBox[{"(", 
            RowBox[{"\[ImaginaryI]", " ", 
             OverscriptBox["a", "^"]}], ")"}]}], "]"}], "+", 
         RowBox[{"Tr", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["G", "0"], ".", 
              RowBox[{"(", 
               RowBox[{"\[ImaginaryI]", " ", 
                OverscriptBox["a", "^"]}], ")"}]}], ")"}], "2"]}], "]"}], "+", 
         RowBox[{"Tr", "[", 
          RowBox[{"Log", "[", 
           SubscriptBox["G", "0"], "]"}], "]"}]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"e[42]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SubscriptBox["S", "eff"], "[", "0", "]"}], "\[Rule]", 
        RowBox[{"Tr", "[", 
         RowBox[{"Log", "[", 
          SubscriptBox["G", "0"], "]"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{
         SubscriptBox["S", "eff"], "[", "1", "]"}], "\[Rule]", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["G", "0"], ".", 
          RowBox[{"(", 
           RowBox[{"\[ImaginaryI]", " ", 
            OverscriptBox["a", "^"]}], ")"}]}], "]"}]}]},
      {
       RowBox[{
        RowBox[{
         SubscriptBox["S", "eff"], "[", "2", "]"}], "\[Rule]", 
        RowBox[{"Tr", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["G", "0"], ".", 
             RowBox[{"(", 
              RowBox[{"\[ImaginaryI]", " ", 
               OverscriptBox["a", "^"]}], ")"}]}], ")"}], "2"]}], "]"}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Expanding ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`S, $CellContext`eff] -> -Log[
      Det[
       Style["D", Italic]]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`S, $CellContext`eff] -> -Log[
      Det[
       OverTilde[
        Style["D", Italic]]]], 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff] -> 
   Tr[-Log[
       OverTilde[
        Style["D", Italic]]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Substituting ", 
    RGBColor[0.7, 0, 1, 1], Larger], Log[
     OverTilde[
      Style["D", Italic]]] -> -Log[
      Dot[
       Subscript[$CellContext`G, 0], (1 - Dot[
         Subscript[$CellContext`G, 0], Complex[0, 1] 
         OverHat[$CellContext`a]])^"-1"]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff] -> 
   Tr[Log[(1 - Dot[
         Subscript[$CellContext`G, 0], Complex[0, 1] 
         OverHat[$CellContext`a]])^"-1"] + Log[
       Subscript[$CellContext`G, 0]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Taylor expansion:", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{Subscript[$CellContext`S, $CellContext`eff] -> Tr[
        SeriesData[
         Dot[
          Subscript[$CellContext`G, 0], Complex[0, 1] 
          OverHat[$CellContext`a]], 0, {
          Log[
           Subscript[$CellContext`G, 0]], 1, 
          Rational[1, 2]}, 0, 3, 1]]}, {
     Subscript[$CellContext`S, $CellContext`eff] -> Tr[
         Dot[
          Subscript[$CellContext`G, 0], Complex[0, 1] 
          OverHat[$CellContext`a]]] + Tr[Rational[1, 2] Dot[
            Subscript[$CellContext`G, 0], Complex[0, 1] 
            OverHat[$CellContext`a]]^2] + Tr[
         Log[
          Subscript[$CellContext`G, 0]]]}}, Dividers -> {{True}, {False}}, 
    FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["e[42]", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{Subscript[$CellContext`S, $CellContext`eff][0] -> Tr[
        Log[
         Subscript[$CellContext`G, 0]]]}, {
     Subscript[$CellContext`S, $CellContext`eff][1] -> Tr[
        Dot[
         Subscript[$CellContext`G, 0], Complex[0, 1] 
         OverHat[$CellContext`a]]]}, {
     Subscript[$CellContext`S, $CellContext`eff][2] -> Tr[Rational[1, 2] Dot[
           Subscript[$CellContext`G, 0], Complex[0, 1] 
           OverHat[$CellContext`a]]^2]}}, Dividers -> {{True}, {False}}, 
    FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885418538923`*^9, 3.800188901240149*^9, 
  3.8002678454833317`*^9},ExpressionUUID->"c131f5d6-b4de-4565-8734-\
934e09dc4c47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Evaluate \>\"", ",", 
   RowBox[{"$0", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "44", "]"}], "//", 
      RowBox[{"tuRuleSelect", "[", 
       RowBox[{
        SubscriptBox["S", "eff"], "[", "1", "]"}], "]"}]}], "//", 
     "tuRule1"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Using in Euclidean time \>\"", ",", 
   RowBox[{
    RowBox[{"$s", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$s", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", "\[Rule]", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "\[Tau]"}]}], "}"}], "[", 
           RowBox[{"CG", "[", "\"\<Wick rotation\>\"", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["dt_", 
              RowBox[{"\[Omega]", "\[NotEqual]", "0"}]], "\[Rule]", "dt"}], 
            "}"}], "[", 
           RowBox[{
           "CG", "[", 
            "\"\<remove label, recall \!\(\*OverscriptBox[\(a\), \(^\)]\)[\
\[Omega]\[Rule]0]\>\"", "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"$", "=", 
         RowBox[{
          RowBox[{"e", "[", "36", "]"}], "//", 
          RowBox[{"tuRuleSelect", "[", 
           SubscriptBox["G", "0"], "]"}]}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"$", "//.", 
           RowBox[{"tuRule", "[", "$s", "]"}]}], "//", 
          RowBox[{"tuDerivativeExpand", "[", "]"}]}], "//", "Expand"}]}]}], 
      "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
   ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$0", "/.", 
     RowBox[{
      RowBox[{"tuRuleSelect", "[", 
       SubscriptBox["G", "0"], "]"}], "[", "$s", "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Fourier rep \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     OverscriptBox["a", "^"], "\[Rule]", 
     RowBox[{"xIntegral", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["a", "^"], "\[Omega]"], 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Omega]", " ", "\[Tau]"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}]}]}], ",", "\[Omega]"}], "]"}]}]}], 
   ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "/.", 
      RowBox[{
       RowBox[{"tuDPartial", "[", 
        RowBox[{"_", ",", "\[Tau]"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Omega]"}]}]}], "//", 
     "tuIntegralGather"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<If we take the \!\(\*OverscriptBox[\(a\), \(^\)]\) component \>\"", 
   ",", 
   RowBox[{"$s", "=", 
    RowBox[{"\[Omega]", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", 
     RowBox[{
      RowBox[{"ee", ":", 
       RowBox[{
        RowBox[{"Exp", "[", "e_", "]"}], "b_"}]}], " ", "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"ee", "/.", "$s"}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<Assume \[Omega] is diagonal \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ct", "[", "U", "]"}], ".", "a_", " ", ".", "U"}], "\[Rule]", 
     "a"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", "$s"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<and Tr is over the \[Sigma] matrices\>\"", ",", "\[IndentingNewLine]",
    "Yield", ",", 
   RowBox[{
    RowBox[{"e", "[", "45", "]"}], "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"$", "//", 
         RowBox[{"tuOpSwitch", "[", 
          RowBox[{"Tr", ",", "xIntegral"}], "]"}]}], "//", 
        RowBox[{"expandDot", "[", 
         RowBox[{"{", "}"}], "]"}]}], "//", 
       RowBox[{"tuOpSimplifyF", "[", "Tr", "]"}]}], "//", 
      RowBox[{"tuIntegralSimplify", "[", 
       RowBox[{"{", 
        RowBox[{"Dot", "[", "__", "]"}], "}"}], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
   "CR", "[", "\"\<e[45] How do you handle the inv[] term?\>\"", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfT/HWzDf5Y1jWV0emD7nKiYJogUk1suA6OLTH1RA
9EmmuaogupWzWwdEywUy6YPoCvXltiC67qS4HYgO4znLPBlIX6teqAuipxlK
GIHoA8/WBIJoxX2rT4BoC/+Zl0G0TOeyZ9OA9OSGzd9B9J5S6/8g+uzueI7p
QJqbxz0URB9eNacURK9XnToZRD/n1ZoCos9IMC8G0WoCTEtAtEqe7RoQHbA2
7xiI9nh41PsgkNavTPYF0XWzjoaC6Nm7HSNB9DIPpWoQndd5ogZEn2eRnf4a
SC/6ZTQfRBfESSwG0Vy7P4HpfwwbD4PoSaXV50D0kVmXX74B0j6WUq9BNABL
tKVx
  "],ExpressionUUID->"2f24f1b5-a802-4038-a8e3-8895a7c74634"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"Evaluate \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{
      SubscriptBox["S", "eff"], "[", "1", "]"}], "\[Rule]", 
     RowBox[{"Tr", "[", 
      RowBox[{
       SubscriptBox["G", "0"], ".", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", 
         OverscriptBox["a", "^"]}], ")"}]}], "]"}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Using in Euclidean time \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t", "\[Rule]", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]"}]}], "}"}], "[", 
             StyleBox["\<\"Wick rotation\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]},
           {
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["dt_", 
                RowBox[{"\[Omega]", "\[NotEqual]", "0"}]], "\[Rule]", "dt"}], 
              "}"}], "[", 
             
             StyleBox["\<\"remove label, recall \
\\!\\(\\*OverscriptBox[\\(a\\), \\(^\\)]\\)[\[Omega]\[Rule]0]\"\>",
              StripOnInput->False,
              LineColor->RGBColor[0, 
                Rational[2, 3], 0],
              FrontFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              BackFaceColor->RGBColor[0, 
                Rational[2, 3], 0],
              GraphicsColor->RGBColor[0, 
                Rational[2, 3], 0],
              FontFamily->"Helvetica",
              FontColor->RGBColor[0, 
                Rational[2, 3], 0]], "]"}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]},
       {
        TagBox[GridBox[{
           {
            RowBox[{
             SubscriptBox["G", "0"], "\[Rule]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 InterpretationBox[
                  SuperscriptBox["U", "\[Dagger]"],
                  ConjugateTranspose[$CellContext`U],
                  Editable->False,
                  SyntaxForm->Automatic], ".", 
                 InterpretationBox[
                  RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], 
                   "[", "_", "]"}],
                  $CellContext`tuDDown["\[PartialD]"][
                   Blank[], $CellContext`\[Tau]],
                  Editable->False,
                  SyntaxForm->Automatic], ".", "U"}], "-", 
                RowBox[{"m", " ", 
                 InterpretationBox[
                  SubsuperscriptBox["\[Sigma]", 
                   StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False], "3"],
                  $CellContext`Tensor[$CellContext`\[Sigma], {
                   3}, {$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]}]}], ")"}], "\<\"-1\"\>"]}]}
          },
          AutoDelete->False,
          FrameStyle->Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]],
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
         "Grid"]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{
      SubscriptBox["S", "eff"], "[", "1", "]"}], "\[Rule]", 
     RowBox[{"Tr", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            SuperscriptBox["U", "\[Dagger]"],
            ConjugateTranspose[$CellContext`U],
            Editable->False,
            SyntaxForm->Automatic], ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", "_",
              "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`\[Tau]],
            Editable->False,
            SyntaxForm->Automatic], ".", "U"}], "-", 
          RowBox[{"m", " ", 
           InterpretationBox[
            SubsuperscriptBox["\[Sigma]", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`\[Sigma], {
             3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}]}], ")"}], "\<\"-1\"\>"], ".", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", 
         OverscriptBox["a", "^"]}], ")"}]}], "]"}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Fourier rep \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    OverscriptBox["a", "^"]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     TemplateBox[{FractionBox[
        RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]", " ", 
             "\[Omega]"}]], " ", 
          SubscriptBox[
           OverscriptBox["a", "^"], "\[Omega]"]}], 
        RowBox[{"2", " ", "\[Pi]"}]],"\[Omega]"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{
      SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       TemplateBox[{RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
              RowBox[{
                RowBox[{
                  InterpretationBox[
                   SuperscriptBox["U", "\[Dagger]"], 
                   ConjugateTranspose[$CellContext`U], SyntaxForm -> 
                   Automatic, Editable -> False], ".", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]"}], ")"}], 
                  ".", "U"}], "-", 
                RowBox[{"m", " ", 
                  InterpretationBox[
                   SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                   $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
              ")"}], "\"-1\""], ".", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Tau]", " ", 
                 "\[Omega]"}]], " ", 
              SubscriptBox[
               OverscriptBox["a", "^"], "\[Omega]"]}], 
            RowBox[{"2", " ", "\[Pi]"}]]}],"\[Omega]"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "]"}], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"If we take the \\!\\(\\*OverscriptBox[\\(a\\), \
\\(^\\)]\\) component \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{"\[Omega]", "\[Rule]", "0"}], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[RightArrow] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{
       SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", 
        TemplateBox[{RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
               RowBox[{
                 RowBox[{
                   InterpretationBox[
                    SuperscriptBox["U", "\[Dagger]"], 
                    ConjugateTranspose[$CellContext`U], SyntaxForm -> 
                    Automatic, Editable -> False], ".", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]"}], ")"}], 
                   ".", "U"}], "-", 
                 RowBox[{"m", " ", 
                   InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
               ")"}], "\"-1\""], ".", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                OverscriptBox["a", "^"], "0"]}], 
             RowBox[{"2", " ", "\[Pi]"}]]}],"\[Omega]"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )], "]"}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       StyleBox["\<\"Assume \[Omega] is diagonal \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SuperscriptBox["U", "\[Dagger]"],
          ConjugateTranspose[$CellContext`U],
          Editable->False,
          SyntaxForm->Automatic], ".", 
         RowBox[{"(", "a_", ")"}], ".", "U"}], "\[Rule]", "a"}], 
       "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[RightArrow] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{
        SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         TemplateBox[{RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]"}], "-", 
                  RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
                ")"}], "\"-1\""], ".", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 OverscriptBox["a", "^"], "0"]}], 
              RowBox[{"2", " ", "\[Pi]"}]]}],"\[Omega]"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "]"}], "\[InvisibleSpace]", 
        StyleBox["\<\"\\n\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0.7, 0, 1],
         LineOpacity->1,
         FrontFaceColor->RGBColor[0.7, 0, 1],
         BackFaceColor->RGBColor[0.7, 0, 1],
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         GraphicsColor->RGBColor[0.7, 0, 1],
         Opacity->1,
         FontSize->Larger,
         FontColor->RGBColor[0.7, 0, 1],
         FontOpacity->1], "\[InvisibleSpace]", 
        StyleBox["\<\"and Tr is over the \[Sigma] matrices\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0.7, 0, 1],
         LineOpacity->1,
         FrontFaceColor->RGBColor[0.7, 0, 1],
         BackFaceColor->RGBColor[0.7, 0, 1],
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         GraphicsColor->RGBColor[0.7, 0, 1],
         Opacity->1,
         FontSize->Larger,
         FontColor->RGBColor[0.7, 0, 1],
         FontOpacity->1], "\[InvisibleSpace]", 
        StyleBox["\<\"\\n\[RightArrow] \"\>",
         StripOnInput->False,
         LineColor->RGBColor[0.7, 0, 1],
         LineOpacity->1,
         FrontFaceColor->RGBColor[0.7, 0, 1],
         BackFaceColor->RGBColor[0.7, 0, 1],
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         GraphicsColor->RGBColor[0.7, 0, 1],
         Opacity->1,
         FontSize->Larger,
         FontWeight->Bold,
         FontColor->RGBColor[0.7, 0, 1],
         FontOpacity->1], "\[InvisibleSpace]", 
        RowBox[{
         SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
       RowBox[{
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", 
          TemplateBox[{RowBox[{"Tr", "[", 
              RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]"}], "-", 
                    RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
                   ")"}], "\"-1\""], ".", 
                SubscriptBox[
                 OverscriptBox["a", "^"], "0"]}], "]"}],"\[Omega]"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], 
         RowBox[{"2", " ", "\[Pi]"}]], "\[InvisibleSpace]", 
        StyleBox["\<\"\\n\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0.7, 0, 1],
         LineOpacity->1,
         FrontFaceColor->RGBColor[0.7, 0, 1],
         BackFaceColor->RGBColor[0.7, 0, 1],
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         GraphicsColor->RGBColor[0.7, 0, 1],
         Opacity->1,
         FontSize->Larger,
         FontColor->RGBColor[0.7, 0, 1],
         FontOpacity->1], "\[InvisibleSpace]", 
        StyleBox["\<\"e[45] How do you handle the inv[] term?\"\>",
         StripOnInput->False,
         LineColor->RGBColor[1, 0, 0],
         FrontFaceColor->RGBColor[1, 0, 0],
         BackFaceColor->RGBColor[1, 0, 0],
         GraphicsColor->RGBColor[1, 0, 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[1, 0, 0]]}]}]}]}]}]}],
  SequenceForm[
   Style["Evaluate ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`S, $CellContext`eff][1] -> Tr[
     Dot[
      Subscript[$CellContext`G, 0], Complex[0, 1] OverHat[$CellContext`a]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Using in Euclidean time ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{
         {$CellContext`t -> Complex[0, -1] $CellContext`\[Tau]}[
          Style["Wick rotation", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
         {Subscript[
            Pattern[$CellContext`dt, 
             Blank[]], $CellContext`\[Omega] != 0] -> $CellContext`dt}[
          Style[
          "remove label, recall \!\(\*OverscriptBox[\(a\), \(^\)]\)[\[Omega]\
\[Rule]0]", 
           RGBColor[0, 
            Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {
      Grid[{{Subscript[$CellContext`G, 0] -> (Dot[
             ConjugateTranspose[$CellContext`U], 
             $CellContext`tuDDown["\[PartialD]"][
              
              Blank[], $CellContext`\[Tau]], $CellContext`U] - $CellContext`m \
$CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}])^"-1"}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Tr[
     Dot[(Dot[
         ConjugateTranspose[$CellContext`U], 
         $CellContext`tuDDown["\[PartialD]"][
          
          Blank[], $CellContext`\[Tau]], $CellContext`U] - $CellContext`m \
$CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}])^"-1", 
      Complex[0, 1] OverHat[$CellContext`a]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Fourier rep ", 
    RGBColor[0.7, 0, 1, 1], Larger], OverHat[$CellContext`a] -> 
   Inactive[Integrate][
    Rational[1, 2] 
     E^(Complex[0, -1] $CellContext`\[Tau] $CellContext`\[Omega]) Pi^(-1) 
     Subscript[
       OverHat[$CellContext`a], $CellContext`\[Omega]], \
$CellContext`\[Omega]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Tr[
     Inactive[Integrate][
      Dot[(Dot[
          ConjugateTranspose[$CellContext`U], 
          Complex[0, -1] $CellContext`\[Omega], $CellContext`U] - \
$CellContext`m $CellContext`Tensor[$CellContext`\[Sigma], {
          3}, {$CellContext`Void}])^"-1", Complex[0, 
         Rational[1, 2]] 
       E^(Complex[0, -1] $CellContext`\[Tau] $CellContext`\[Omega]) Pi^(-1) 
       Subscript[
         OverHat[$CellContext`a], $CellContext`\[Omega]]], $CellContext`\
\[Omega]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["If we take the \!\(\*OverscriptBox[\(a\), \(^\)]\) component ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`\[Omega] -> 0, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Tr[
     Inactive[Integrate][
      Dot[(Dot[
          ConjugateTranspose[$CellContext`U], 
          Complex[0, -1] $CellContext`\[Omega], $CellContext`U] - \
$CellContext`m $CellContext`Tensor[$CellContext`\[Sigma], {
          3}, {$CellContext`Void}])^"-1", Complex[0, 
         Rational[1, 2]] Pi^(-1) Subscript[
         OverHat[$CellContext`a], 0]], $CellContext`\[Omega]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Assume \[Omega] is diagonal ", 
    RGBColor[0.7, 0, 1, 1], Larger], Dot[
     ConjugateTranspose[$CellContext`U], 
     Pattern[$CellContext`a, 
      Blank[]], $CellContext`U] -> $CellContext`a, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Tr[
     Inactive[Integrate][
      Dot[(
        Complex[0, -1] $CellContext`\[Omega] - $CellContext`m \
$CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}])^"-1", 
       Complex[0, 
         Rational[1, 2]] Pi^(-1) Subscript[
         OverHat[$CellContext`a], 0]], $CellContext`\[Omega]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["and Tr is over the \[Sigma] matrices", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Complex[0, 
      Rational[1, 2]] Pi^(-1) Inactive[Integrate][
      Tr[
       Dot[(
         Complex[0, -1] $CellContext`\[Omega] - $CellContext`m \
$CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}])^"-1", 
        Subscript[
         OverHat[$CellContext`a], 0]]], $CellContext`\[Omega]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["e[45] How do you handle the inv[] term?", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885420415087`*^9, 3.800188901475079*^9, 
  3.800267845707802*^9},ExpressionUUID->"f4d61c70-b3d6-4dde-b48a-\
f15ea10d6f84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Evaluate: \>\"", ",", 
   RowBox[{"$0", "=", 
    RowBox[{"$", "=", 
     RowBox[{"e", "[", "45", "]"}]}]}], ",", "\[IndentingNewLine]", "NL", 
   ",", "\"\<By Series[] expansion of inv[] term\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$0", "=", 
     RowBox[{"$0", "//", 
      RowBox[{"tuExtractPositionPattern", "[", 
       RowBox[{"inv", "[", "_", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "Yield"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$0", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"inv", "[", "a_", "]"}], "\[Rule]", 
       RowBox[{"1", "/", "a"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$0", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"$", ",", 
         RowBox[{"{", " ", 
          RowBox[{"m", ",", "0", ",", "5"}], "}"}]}], "]"}], "/.", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "2"], "->", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], ".", 
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}]}]}], "//", "Normal"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"tuReplacePart", "[", 
      RowBox[{
       RowBox[{"e", "[", "45", "]"}], ",", "$0"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<Applying Tr[] to the representation \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["a", "^"], "0"], "\[Rule]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{
             SubscriptBox["a", "0"], ",", "\"\<u\>\"", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}], " ", 
           RowBox[{"T", "[", 
            RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", "$s"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//", 
        RowBox[{"expandDot", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", "m", ",", 
            RowBox[{"T", "[", 
             RowBox[{
              SubscriptBox["a", "0"], ",", "\"\<u\>\"", ",", 
              RowBox[{"{", "_", "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", "3"}], "]"}]}], "//", 
       RowBox[{"tuOpDistributeF", "[", "Tr", "]"}]}], "//", 
      RowBox[{"tuOpSimplifyF", "[", 
       RowBox[{"Tr", ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "m", ",", 
          RowBox[{"T", "[", 
           RowBox[{
            SubscriptBox["a", "0"], ",", "\"\<u\>\"", ",", 
            RowBox[{"{", "_", "}"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", 
       RowBox[{
        RowBox[{"Tr", "[", "a_", "]"}], "\[RuleDelayed]", 
        RowBox[{"0", "/;", 
         RowBox[{"(", 
          RowBox[{"tuHasAnyQ", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "1", "}"}]}], "]"}], ",", 
              RowBox[{"T", "[", 
               RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}]}], "]"}], 
          ")"}]}]}]}], "/.", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"ss", ":", 
          RowBox[{"T", "[", 
           RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ")"}], "n_"], 
       "\[RuleDelayed]", 
       RowBox[{"Apply", "[", 
        RowBox[{"Dot", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"ss", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "//.", 
        RowBox[{
         RowBox[{"Tr", "[", "a_", "]"}], "\[RuleDelayed]", 
         RowBox[{"0", "/;", 
          RowBox[{
           RowBox[{"OddQ", "[", 
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "a", "}"}], "]"}], ",", 
              RowBox[{"T", "[", 
               RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}], "]"}], "||", 
           RowBox[{"OddQ", "[", 
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"List", ",", "a"}], "]"}], ",", 
              RowBox[{"T", "[", 
               RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}], "]"}]}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"Tr", "[", "_", "]"}], "\[Rule]", "2"}]}], "//", 
      "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"tuIntegralSimplify", "[", "]"}]}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", 
     RowBox[{
      RowBox[{"xIntegral", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"xIntegral", "[", 
       RowBox[{
        RowBox[{"a", "//", "Expand"}], ",", "b"}], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<The integrand is identified with \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{"Inactive", "[", "Series", "]"}], "[", 
      RowBox[{
       RowBox[{"$int", "=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", "^", "2"}], "+", 
           RowBox[{"m", "^", "2"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0", ",", "4"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{"$s", "->", 
      RowBox[{"(", 
       RowBox[{"$s", "//", "Activate"}], ")"}]}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"Normal", "[", "$s", "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "Series", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", "a"}]}]}], ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "/.", "$s"}], "/.", 
     RowBox[{
      RowBox[{"xIntegral", "[", 
       RowBox[{"a_", ",", "\[Omega]"}], "]"}], "\[Rule]", 
      RowBox[{"xIntegral", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//", "Activate"}], "//", 
      RowBox[{
       RowBox[{"Refine", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"m", "\[Element]", "Reals"}], "&&", 
          RowBox[{"m", ">", "0"}]}]}], "]"}], "&"}]}]}], ";", 
    RowBox[{"$", "//", "Framed"}]}], ",", 
   RowBox[{"CG", "[", "\"\<e[45]\>\"", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xIntegral", "[", 
      RowBox[{"$int", " ", ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}], "//",
      "Activate"}], "//", 
    RowBox[{
     RowBox[{"Refine", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"m", "\[Element]", "Reals"}], "&&", 
        RowBox[{"m", ">", "0"}]}]}], "]"}], "&"}]}], "*)"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFtIkwEAhuEZHa1m2oxasE2LmeUM/rkKKmo4tcLRtKJNhkaYmq7DUIvV
MgRZKQVlJi2NokBpheVME6NiBQpjF0G1iRY1DcOao4woRFZ7d/HxXH1vyuET
hUfmiESi9OjQoTee8+hC2lPCjBMj/X/dOLcorQc/xV/d8z3q2dR1ehyr7S1E
tSXZhDZTWg2qDN9OY8TfaMf2Sxn1+HVToBmTBpa1YLhPcR8XzEpfoLB7fOFU
1ApBvwQlzySJuLa/RoJVB7atQn9tlxSLB6rluGPpXQW+lJ5Mx8pr8g14xxPZ
iJvrFFm4WFq2FZOHVLm407fdgCNDslJ0Xok7js3+vGoMW7rtOM9QcB6PZVgd
qHybchsnjC1dmOl0P8UC89FXKL1si+n7mOvFYe/IJGpl4p+oabTHhaM2uZQq
HA7uj9lWWqdDnzk+D8VVggFvvJ5vxPa+R8V4sVwowcFOoQJd09NWFHVONiXm
hLTXcwKtuGKqpAc/jOm8mOVWy5Ki3vyhVmK2tWM9it+HNZjv6Hi+nF9r0IMP
XasHcfZQ0RuslN17h1vqywKY+i9zFBsOJnzGBxeefMFQd8IiCb1fZh32nlmz
Cxvkv/NRs9KyFyfKs/ehzRiM+fjWuAlHZ/7E/A9nv0bK
  
  "],ExpressionUUID->"115c1bca-e8c9-4aaf-a825-daa9c051af92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"Evaluate: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       TemplateBox[{RowBox[{"Tr", "[", 
           RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]"}], "-", 
                  RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
                ")"}], "\"-1\""], ".", 
             SubscriptBox[
              OverscriptBox["a", "^"], "0"]}], "]"}],"\[Omega]"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], 
      RowBox[{"2", " ", "\[Pi]"}]], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"By Series[] expansion of inv[] term\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{
      SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        TemplateBox[{RowBox[{"Tr", "[", 
            RowBox[{
              RowBox[{"(", 
                RowBox[{
                  FractionBox["\[ImaginaryI]", "\[Omega]"], "-", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
                   SuperscriptBox["\[Omega]", "3"]], "-", 
                  FractionBox[
                   RowBox[{"m", " ", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
                   SuperscriptBox["\[Omega]", "2"]], "+", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["m", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ")"}], 
                    "3"]}], 
                   SuperscriptBox["\[Omega]", "4"]], "+", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["m", "4"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ")"}], 
                    "4"]}], 
                   SuperscriptBox["\[Omega]", "5"]], "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["m", "5"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["\[Sigma]", 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}], 
                    RowBox[{"3"}]], 
                    $CellContext`Tensor[$CellContext`\[Sigma], {
                    3}, {$CellContext`Void}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ")"}], 
                    "5"]}], 
                   SuperscriptBox["\[Omega]", "6"]]}], ")"}], ".", 
              SubscriptBox[
               OverscriptBox["a", "^"], "0"]}], "]"}],"\[Omega]"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], 
       RowBox[{"2", " ", "\[Pi]"}]], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"Applying Tr[] to the representation \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["a", "^"], "0"], "\[Rule]", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["\[Sigma]", 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False], "1"],
           $CellContext`Tensor[$CellContext`\[Sigma], {
            1}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          InterpretationBox[
           SubsuperscriptBox[
            SubscriptBox["a", "0"], 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False], "1"],
           $CellContext`Tensor[
            Subscript[$CellContext`a, 0], {1}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "+", 
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["\[Sigma]", 
            StyleBox["2",
             StripOnInput->False,
             ShowContents->False], "2"],
           $CellContext`Tensor[$CellContext`\[Sigma], {
            2}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          InterpretationBox[
           SubsuperscriptBox[
            SubscriptBox["a", "0"], 
            StyleBox["2",
             StripOnInput->False,
             ShowContents->False], "2"],
           $CellContext`Tensor[
            Subscript[$CellContext`a, 0], {2}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "+", 
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["\[Sigma]", 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False], "3"],
           $CellContext`Tensor[$CellContext`\[Sigma], {
            3}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          InterpretationBox[
           SubsuperscriptBox[
            SubscriptBox["a", "0"], 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False], "3"],
           $CellContext`Tensor[
            Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}]}]}], "}"}], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[RightArrow] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[RightArrow] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{
       SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "m", " ", 
          InterpretationBox[
           SubsuperscriptBox[
            SubscriptBox["a", "0"], 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False], "3"],
           $CellContext`Tensor[
            Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          TemplateBox[{RowBox[{"(", 
              RowBox[{
                FractionBox[
                 SuperscriptBox["m", "4"], 
                 SuperscriptBox["\[Omega]", "6"]], "-", 
                FractionBox[
                 SuperscriptBox["m", "2"], 
                 SuperscriptBox["\[Omega]", "4"]], "+", 
                FractionBox["1", 
                 SuperscriptBox["\[Omega]", "2"]]}], ")"}],"\[Omega]"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2}], "]"}]& )]}], "\[Pi]"]}], 
       "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       StyleBox["\<\"The integrand is identified with \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{
        RowBox[{
         TemplateBox[{"Series"},
          "InactiveHead",
          BaseStyle->"Inactive",
          SyntaxForm->"Symbol",
          Tooltip->"Inactive[Series]"], "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["m", "2"], "+", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", "4"}], "}"}]}], "]"}], "\[Rule]", 
        InterpretationBox[
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["\[Omega]", "2"]], "-", 
          FractionBox[
           SuperscriptBox["m", "2"], 
           SuperscriptBox["\[Omega]", "4"]], "+", 
          FractionBox[
           SuperscriptBox["m", "4"], 
           SuperscriptBox["\[Omega]", "6"]], "+", 
          InterpretationBox[
           SuperscriptBox[
            RowBox[{"O", "[", "m", "]"}], "5"],
           SeriesData[$CellContext`m, 0, {}, 0, 5, 1],
           Editable->False]}],
         SeriesData[$CellContext`m, 
          0, {$CellContext`\[Omega]^(-2), 0, (-1) $CellContext`\[Omega]^(-4), 
           0, $CellContext`\[Omega]^(-6)}, 0, 5, 1],
         Editable->False]}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[RightArrow] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox["m", "4"], 
          SuperscriptBox["\[Omega]", "6"]], "-", 
         FractionBox[
          SuperscriptBox["m", "2"], 
          SuperscriptBox["\[Omega]", "4"]], "+", 
         FractionBox["1", 
          SuperscriptBox["\[Omega]", "2"]]}], "\[Rule]", 
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["\[Omega]", "2"]}]]}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[Implies] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{
        SubscriptBox["S", "eff"], "[", "1", "]"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "m", " ", 
          InterpretationBox[
           SubsuperscriptBox[
            SubscriptBox["a", "0"], 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False], "3"],
           $CellContext`Tensor[
            Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], " ", 
          TemplateBox[{FractionBox["1", 
             RowBox[{
               SuperscriptBox["m", "2"], "+", 
               SuperscriptBox["\[Omega]", "2"]}]],"\[Omega]",
            RowBox[{"-", "\[Infinity]"}],"\[Infinity]"},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              SubsuperscriptBox[
               StyleBox["\[Integral]", "Inactive"], #3, #4], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", 
                RowBox[{"{", 
                  RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], 
         "\[Pi]"]}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[RightArrow] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       FrameBox[
        RowBox[{
         RowBox[{
          SubscriptBox["S", "eff"], "[", "1", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          InterpretationBox[
           SubsuperscriptBox[
            SubscriptBox["a", "0"], 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False], "3"],
           $CellContext`Tensor[
            Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}]}],
        StripOnInput->False], "\[InvisibleSpace]", 
       StyleBox["\<\"e[45]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]]}]}]}]}]}],
  SequenceForm[
   Style["Evaluate: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`S, $CellContext`eff][1] -> Complex[0, 
      Rational[1, 2]] Pi^(-1) Inactive[Integrate][
      Tr[
       Dot[(
         Complex[0, -1] $CellContext`\[Omega] - $CellContext`m \
$CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}])^"-1", 
        Subscript[
         OverHat[$CellContext`a], 0]]], $CellContext`\[Omega]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["By Series[] expansion of inv[] term", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Complex[0, 
      Rational[1, 2]] Pi^(-1) Inactive[Integrate][
      Tr[
       Dot[
       Complex[0, 1]/$CellContext`\[Omega] + 
        Complex[0, -1] $CellContext`m^2 $CellContext`\[Omega]^(-3) Dot[
           $CellContext`Tensor[$CellContext`\[Sigma], {
            3}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`\[Sigma], {
            3}, {$CellContext`Void}]] - $CellContext`m \
$CellContext`\[Omega]^(-2) $CellContext`Tensor[$CellContext`\[Sigma], {
          3}, {$CellContext`Void}] + $CellContext`m^3 \
$CellContext`\[Omega]^(-4) $CellContext`Tensor[$CellContext`\[Sigma], {
            3}, {$CellContext`Void}]^3 + 
        Complex[0, 
           1] $CellContext`m^4 $CellContext`\[Omega]^(-5) \
$CellContext`Tensor[$CellContext`\[Sigma], {
            3}, {$CellContext`Void}]^4 - $CellContext`m^5 $CellContext`\
\[Omega]^(-6) $CellContext`Tensor[$CellContext`\[Sigma], {
           3}, {$CellContext`Void}]^5, 
        Subscript[
         OverHat[$CellContext`a], 0]]], $CellContext`\[Omega]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Applying Tr[] to the representation ", 
    RGBColor[0.7, 0, 1, 1], Larger], {Subscript[
      OverHat[$CellContext`a], 
      0] -> $CellContext`Tensor[$CellContext`\[Sigma], {
        1}, {$CellContext`Void}] $CellContext`Tensor[
        Subscript[$CellContext`a, 0], {
        1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`\[Sigma], \
{2}, {$CellContext`Void}] $CellContext`Tensor[
        Subscript[$CellContext`a, 0], {
        2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`\[Sigma], \
{3}, {$CellContext`Void}] $CellContext`Tensor[
        Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Complex[0, -1] $CellContext`m Pi^(-1) $CellContext`Tensor[
      Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}] 
    Inactive[Integrate][$CellContext`m^4 $CellContext`\[Omega]^(-6) - \
$CellContext`m^2 $CellContext`\[Omega]^(-4) + $CellContext`\[Omega]^(-2), \
$CellContext`\[Omega]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The integrand is identified with ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Inactive[Series][($CellContext`m^2 + $CellContext`\[Omega]^2)^(-1), \
{$CellContext`m, 0, 4}] -> 
   SeriesData[$CellContext`m, 
     0, {$CellContext`\[Omega]^(-2), 0, (-1) $CellContext`\[Omega]^(-4), 
      0, $CellContext`\[Omega]^(-6)}, 0, 5, 1], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 
     1]], $CellContext`m^4 $CellContext`\[Omega]^(-6) - $CellContext`m^2 \
$CellContext`\[Omega]^(-4) + $CellContext`\[Omega]^(-2) -> ($CellContext`m^2 + \
$CellContext`\[Omega]^2)^(-1), 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`eff][1] -> 
   Complex[0, -1] $CellContext`m Pi^(-1) $CellContext`Tensor[
      Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}] 
    Inactive[Integrate][($CellContext`m^2 + $CellContext`\[Omega]^2)^(-1), \
{$CellContext`\[Omega], 
       DirectedInfinity[-1], 
       DirectedInfinity[1]}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[
   Subscript[$CellContext`S, $CellContext`eff][1] -> 
    Complex[0, -1] $CellContext`Tensor[
       Subscript[$CellContext`a, 0], {3}, {$CellContext`Void}]], 
   Style["e[45]", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188543114867*^9, 3.800188903224279*^9, 
  3.800267846664269*^9},ExpressionUUID->"ec6fe08e-8039-476e-9e4c-\
de247fa2821f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
3.3 Derivation of a WZ term from fermionic model without chiral rotation\
\>", "Subsubsection",
 CellChangeTimes->{{3.794060571086694*^9, 
  3.794060594302334*^9}},ExpressionUUID->"46562e8f-9a41-4cc3-bbd1-\
aee4cd3d13f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"e", "[", "56", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Z", "\[Rule]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", "S"}], "]"}], ",", "\[Psi]", ",", 
           OverscriptBox["\[Psi]", "_"], ",", "n"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"S", "\[Rule]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{
            OverscriptBox["\[Psi]", "_"], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"I", " ", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"_", ",", "t"}], "]"}]}], "-", 
              RowBox[{"I", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{"n", ".", "\[Tau]"}], ")"}]}]}], ")"}], ".", 
            "\[Psi]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Psi]", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox["\[Psi]", "i"], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], "}"}], "[", 
         RowBox[{"CG", "[", "\"\<Grassmann spinor\>\"", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Tau]", "[", 
         RowBox[{"CG", "[", "\"\<Pauli matrices on spinor indices\>\"", "]"}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", ".", "n"}], "\[Rule]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", ".", 
         RowBox[{"\[Tau]", "[", 
          RowBox[{"CG", "[", 
           RowBox[{"\"\<coupling to fermionic spin\>\"", ",", 
            RowBox[{
             OverscriptBox["\[Psi]", "_"], ".", "\[Tau]", ".", "\[Psi]"}]}], 
           "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"e", "[", "59", "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Z", "\[Rule]", 
             RowBox[{"xIntegral", "[", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  SubscriptBox["S", "eff"], "[", "n", "]"}]}], "]"}], ",", 
               "n"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["S", "eff"], "[", "n", "]"}], "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"Det", "[", 
                RowBox[{
                 RowBox[{"I", " ", 
                  RowBox[{"tuDPartial", "[", 
                   RowBox[{"_", ",", "t"}], "]"}]}], "-", 
                 RowBox[{"I", " ", "m", " ", 
                  RowBox[{"(", 
                   RowBox[{"n", ".", "\[Tau]"}], ")"}]}]}], "]"}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "}"}], "[", 
          RowBox[{"CG", "[", "\"\<integrate out fermion\>\"", "]"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"e", "[", "59.1", "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"iD", "->", 
             RowBox[{
              RowBox[{"I", " ", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"_", ",", "t"}], "]"}]}], "-", 
              RowBox[{"I", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{"n", ".", "\[Tau]"}], ")"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ct", "[", "iD", "]"}], "\[Rule]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"tuDPartial", "[", 
                RowBox[{"_", ",", "t"}], "]"}]}], "+", 
              RowBox[{"I", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{"\[Tau]", ".", "n"}], ")"}]}]}]}]}], "}"}], "[", 
          RowBox[{"CG", "[", "\"\<define\>\"", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"$", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"tuRuleSelect", "[", 
              RowBox[{
               SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "[", 
             RowBox[{"e", "[", "59", "]"}], "]"}], "//", "First"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$s", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"tuRuleSelect", "[", "iD", "]"}], "[", 
               RowBox[{"e", "[", "59.1", "]"}], "]"}], "//", "First"}], "//", 
             "Reverse"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"$", "=", 
            RowBox[{"$", "/.", "$s"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"$", "=", 
            RowBox[{"$", "/.", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"Det", "[", "a_", "]"}], "]"}], "\[Rule]", 
              RowBox[{"Tr", "[", 
               RowBox[{"Log", "[", "a", "]"}], "]"}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$", "=", 
           RowBox[{"\[Delta]", "/@", "$"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"$", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"$", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "//", 
             RowBox[{"tudExpandvI", "[", "\[Delta]", "]"}]}]}], ";", 
           RowBox[{"$", "=", 
            RowBox[{"$", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Delta]", "[", "iD", "]"}], " ", 
               SuperscriptBox["iD", 
                RowBox[{"-", "1"}]]}], "\[Rule]", 
              RowBox[{
               RowBox[{"\[Delta]", "[", "iD", "]"}], ".", 
               RowBox[{"ct", "[", "iD", "]"}], ".", 
               RowBox[{"inv", "[", 
                RowBox[{"iD", " ", ".", 
                 RowBox[{"ct", "[", "iD", "]"}]}], "]"}]}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$", "=", 
           RowBox[{"$", "/.", 
            RowBox[{"Reverse", "[", 
             RowBox[{"tuRule", "[", 
              RowBox[{"e", "[", "59.1", "]"}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$2", "=", 
            RowBox[{
             RowBox[{"$", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "//", 
               RowBox[{"tudExpandvI", "[", 
                RowBox[{"\[Delta]", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Tau]", ",", "m"}], "}"}]}], "]"}]}], "//", 
              RowBox[{"tuDerivativeExpand", "[", "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"$2", "=", 
            RowBox[{"$2", "//", 
             RowBox[{"tuConjugateTransposeSimplify", "[", 
              RowBox[{
               RowBox[{"{", "t", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"Blank", "[", "]"}]}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"$2", "=", 
            RowBox[{"$2", "//", 
             RowBox[{"expandDot", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "m", "}"}]}], "]"}]}]}], ";", 
           RowBox[{"$", "//", "ColumnSumExp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"$1", "=", 
            RowBox[{"$2", "//", 
             RowBox[{"tuExtractPositionPattern", "[", 
              RowBox[{"inv", "[", "_", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"$1", "=", 
            RowBox[{"$1", "/.", 
             RowBox[{
              RowBox[{"inv", "[", "a_", "]"}], "\[RuleDelayed]", 
              RowBox[{"inv", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "//", 
                  RowBox[{"tuBlankOpNest", "[", "]"}]}], "//", 
                 RowBox[{"tuDerivativeExpand", "[", 
                  RowBox[{"{", "\[Tau]", "}"}], "]"}]}], "//", 
                RowBox[{"expandDot", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"$", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"tuReplacePart", "[", 
               RowBox[{"$2", ",", "$1"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"n", ".", "\[Tau]", ".", "\[Tau]", ".", "n"}], 
               "\[Rule]", "1"}]}], "/.", 
             RowBox[{
              RowBox[{
              "a_", " ", ".", " ", "\[Tau]", ".", "\[Tau]", ".", "b_"}], 
              "\[Rule]", 
              RowBox[{"a", ".", "b"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"e", "[", "60", "]"}], "=", 
            RowBox[{"$", "=", 
             RowBox[{"$", "//.", 
              RowBox[{"tuOpCollectR", "[", "]"}]}]}]}], ";", 
           RowBox[{
            RowBox[{"$", "//", "ColumnSumExp"}], "//", "Framed"}]}], ",", 
          RowBox[{
          "CR", "[", "\"\<e[60] Extra \[PartialD] fractor in inv[]\>\"", 
           "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7940606503758593`*^9, 3.794060752115163*^9}, {
   3.794060784004673*^9, 3.794060972086978*^9}, {3.794061006934475*^9, 
   3.7940611528418093`*^9}, {3.7940612251463223`*^9, 
   3.7940613495729856`*^9}, {3.794061411806312*^9, 3.794061463684513*^9}, {
   3.79406169399693*^9, 3.794061972837825*^9}, {3.794062024796906*^9, 
   3.794062038367394*^9}, {3.7940620880136623`*^9, 3.794062100466667*^9}, {
   3.794062145890032*^9, 3.794062149801189*^9}, {3.794062190528631*^9, 
   3.7940622296016808`*^9}, {3.7940622675826187`*^9, 3.794062340108625*^9}, {
   3.7940623762918463`*^9, 3.7940625186749363`*^9}, {3.794062604680748*^9, 
   3.7940626308054028`*^9}, {3.794062686190117*^9, 3.7940626985475082`*^9}, {
   3.7940627385544577`*^9, 3.7940627933536377`*^9}, {3.794062845432423*^9, 
   3.794062887151335*^9}, 3.7940629340564528`*^9, {3.794062999063305*^9, 
   3.794063221495844*^9}, {3.7940632946801443`*^9, 3.794063300543395*^9}, {
   3.794063423299926*^9, 3.794063437441139*^9}, {3.7940646021996727`*^9, 
   3.794064620175009*^9}, {3.794064759157625*^9, 3.794064801538245*^9}, {
   3.7940648428196497`*^9, 3.794064846173238*^9}, {3.7940648786906652`*^9, 
   3.794064909283595*^9}, {3.7940649538766623`*^9, 3.7940649797486753`*^9}, {
   3.794065051806622*^9, 3.79406505581962*^9}, {3.794066346142815*^9, 
   3.794066477338759*^9}, {3.794066536819312*^9, 3.794066537386524*^9}, {
   3.794066598567732*^9, 3.794066763728425*^9}, {3.794236999238942*^9, 
   3.794237001580406*^9}, {3.794237243630286*^9, 3.794237244791274*^9}, {
   3.7942374077393303`*^9, 3.794237456686795*^9}, {3.794238335510797*^9, 
   3.794238355137663*^9}, {3.794314681639503*^9, 3.7943146823173122`*^9}, {
   3.794314716826232*^9, 3.794314717500394*^9}, {3.794403654530918*^9, 
   3.7944036604008207`*^9}, {3.794403707001096*^9, 3.794403761472911*^9}, {
   3.794403800709549*^9, 3.7944038133454657`*^9}, {3.7944038520388823`*^9, 
   3.794403853388006*^9}, {3.794404026343834*^9, 3.794404026872445*^9}, {
   3.796045236818241*^9, 3.7960452650930843`*^9}, {3.796045304332142*^9, 
   3.796045308125719*^9}},ExpressionUUID->"cb210c9f-7f63-4320-b39f-\
47489312e142"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"Z", "\[Rule]", 
      TemplateBox[{SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "S"}]],"\[Psi]",OverscriptBox["\[Psi]", "_"],"n"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{#, 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #4}], 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #3}], 
                RowBox[{
                  StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2, ",", #3, ",", #4}], "]"}]& )]}]},
    {
     RowBox[{"S", "\[Rule]", 
      TemplateBox[{RowBox[{
          OverscriptBox["\[Psi]", "_"], ".", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
                RowBox[{"n", ".", "\[Tau]"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "_", 
                   "]"}], 
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t], SyntaxForm -> Automatic, Editable -> 
                 False]}]}], ")"}], ".", "\[Psi]"}],TagBox[
         GridBox[{{"t"}, {"0"}, {"T"}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
          GridBoxDividers -> {"Columns" -> {True}, "Rows" -> {False}}, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, FrameStyle -> 
          Directive[
            RGBColor[0.7, 0, 1, 1], 
            Thickness[Tiny]]], "Grid"]},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"\[Psi]", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Psi]", "1"], ",", 
             SubscriptBox["\[Psi]", "2"]}], "}"}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"Grassmann spinor\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{"\[Tau]", "[", 
      StyleBox["\<\"Pauli matrices on spinor indices\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      RowBox[{"n", ".", "n"}], "\[Rule]", "1"}]},
    {
     RowBox[{"n", ".", 
      RowBox[{"\[Tau]", "[", 
       RowBox[{
        StyleBox["\<\"coupling to fermionic spin\"\>",
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]], ",", 
        StyleBox[
         RowBox[{
          OverscriptBox["\[Psi]", "_"], ".", "\[Tau]", ".", "\[Psi]"}],
         StripOnInput->False,
         LineColor->RGBColor[0, 
           Rational[2, 3], 0],
         FrontFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         BackFaceColor->RGBColor[0, 
           Rational[2, 3], 0],
         GraphicsColor->RGBColor[0, 
           Rational[2, 3], 0],
         FontFamily->"Helvetica",
         FontColor->RGBColor[0, 
           Rational[2, 3], 0]]}], "]"}]}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{"Z", "\[Rule]", 
           TemplateBox[{SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
                RowBox[{
                  SubscriptBox["S", "eff"], "[", "n", "]"}]}]],"n"},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               StyleBox["\[Integral]", "Inactive"], 
               RowBox[{#, 
                 RowBox[{
                   StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]},
         {
          RowBox[{
           RowBox[{
            SubscriptBox["S", "eff"], "[", "n", "]"}], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             RowBox[{"Det", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
                RowBox[{"n", ".", "\[Tau]"}]}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], "]"}], "]"}]}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"integrate out fermion\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     RowBox[{
      TagBox[GridBox[{
         {
          RowBox[{
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
             RowBox[{"n", ".", "\[Tau]"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}]}]},
         {
          RowBox[{
           InterpretationBox[
            SuperscriptBox[
             StyleBox["\<\"D\"\>",
              StripOnInput->False,
              FontSlant->Italic], "\[Dagger]"],
            ConjugateTranspose[
             Style["D", Italic]],
            Editable->False,
            SyntaxForm->Automatic], "\[Rule]", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "m", " ", 
             RowBox[{"\[Tau]", ".", "n"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "[", 
      StyleBox["\<\"define\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}]},
    {
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{
           SubscriptBox["S", "eff"], "[", "n", "]"}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"Det", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
               RowBox[{"n", ".", "\[Tau]"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
                 "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 Blank[], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}], "]"}], "]"}]}]}]},
        {
         RowBox[{
          RowBox[{
           SubscriptBox["S", "eff"], "[", "n", "]"}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{"Log", "[", 
             StyleBox["\<\"D\"\>",
              StripOnInput->False,
              FontSlant->Italic], "]"}], "]"}]}]}]},
        {
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           RowBox[{
            SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "\[Rule]", 
          RowBox[{"\[Delta]", "[", 
           RowBox[{"-", 
            RowBox[{"Tr", "[", 
             RowBox[{"Log", "[", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "]"}], "]"}]}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           RowBox[{
            SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "]"}], ".", 
             InterpretationBox[
              SuperscriptBox[
               StyleBox["\<\"D\"\>",
                StripOnInput->False,
                FontSlant->Italic], "\[Dagger]"],
              ConjugateTranspose[
               Style["D", Italic]],
              Editable->False,
              SyntaxForm->Automatic], ".", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                StyleBox["\<\"D\"\>",
                 StripOnInput->False,
                 FontSlant->Italic], ".", 
                InterpretationBox[
                 SuperscriptBox[
                  StyleBox["\<\"D\"\>",
                   StripOnInput->False,
                   FontSlant->Italic], "\[Dagger]"],
                 ConjugateTranspose[
                  Style["D", Italic]],
                 Editable->False,
                 SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"]}], 
            "]"}]}]}]},
        {
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           RowBox[{
            SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
                RowBox[{"n", ".", "\[Tau]"}]}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", "m", " ", 
                RowBox[{"\[Tau]", ".", "n"}]}], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], ")"}], ".", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
                   RowBox[{"n", ".", "\[Tau]"}]}], "+", 
                  RowBox[{"\[ImaginaryI]", " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], ")"}], ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[ImaginaryI]", " ", "m", " ", 
                   RowBox[{"\[Tau]", ".", "n"}]}], "-", 
                  RowBox[{"\[ImaginaryI]", " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], ")"}]}], 
               ")"}], "\<\"-1\"\>"]}], "]"}]}]}]},
        {
         FrameBox[
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", 
              RowBox[{
               RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
               RowBox[{
                StyleBox["\<\"\[Sum]\"\>",
                 StripOnInput->False,
                 LineColor->RGBColor[0.7, 0, 1],
                 LineOpacity->1,
                 FrontFaceColor->RGBColor[0.7, 0, 1],
                 BackFaceColor->RGBColor[0.7, 0, 1],
                 FrontFaceOpacity->1,
                 BackFaceOpacity->1,
                 GraphicsColor->RGBColor[0.7, 0, 1],
                 Opacity->1,
                 FontColor->RGBColor[0.7, 0, 1],
                 FontOpacity->1], "[", 
                TagBox[GridBox[{
                   {
                    RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["m", "2"], " ", "n"}]},
                   {
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}]}
                  },
                  AutoDelete->False,
                  FrameStyle->Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]],
                  GridBoxAlignment->{"Columns" -> {{Left}}},
                  GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
                  
                  GridBoxItemSize->{
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                 "Grid"], "]"}], ".", 
               SuperscriptBox[
                RowBox[{
                 StyleBox["\<\"\[Sum]\"\>",
                  StripOnInput->False,
                  LineColor->RGBColor[0.7, 0, 1],
                  LineOpacity->1,
                  FrontFaceColor->RGBColor[0.7, 0, 1],
                  BackFaceColor->RGBColor[0.7, 0, 1],
                  FrontFaceOpacity->1,
                  BackFaceOpacity->1,
                  GraphicsColor->RGBColor[0.7, 0, 1],
                  Opacity->1,
                  FontColor->RGBColor[0.7, 0, 1],
                  FontOpacity->1], "[", 
                 TagBox[GridBox[{
                    {
                    SuperscriptBox["m", "2"]},
                    {
                    RowBox[{
                    RowBox[{"-", "m"}], " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}]},
                    {
                    RowBox[{
                    RowBox[{"-", "m"}], " ", 
                    RowBox[{"n", ".", "\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}]},
                    {
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}
                   },
                   AutoDelete->False,
                   FrameStyle->Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]],
                   GridBoxAlignment->{"Columns" -> {{Left}}},
                   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
                   
                   GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
                  "Grid"], "]"}], "\<\"-1\"\>"]}]}], "]"}]}]}],
          StripOnInput->False]},
        {
         StyleBox["\<\"e[60] Extra \[PartialD] fractor in inv[]\"\>",
          StripOnInput->False,
          LineColor->RGBColor[1, 0, 0],
          FrontFaceColor->RGBColor[1, 0, 0],
          BackFaceColor->RGBColor[1, 0, 0],
          GraphicsColor->RGBColor[1, 0, 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[1, 0, 0]]}
       },
       AutoDelete->False,
       FrameStyle->Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]],
       GridBoxAlignment->{"Columns" -> {{Left}}},
       GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   AutoDelete->False,
   FrameStyle->Directive[
     RGBColor[0.7, 0, 1, 1], 
     Thickness[Tiny]],
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Print",
 CellChangeTimes->{3.800188543411381*^9, 3.800188903648425*^9, 
  3.800267846964325*^9},ExpressionUUID->"ca12e226-03aa-4bce-a910-\
b251edc06c0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$", "=", 
   RowBox[{"e", "[", "60", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$", "=", 
  RowBox[{
   RowBox[{"$", "//", 
    RowBox[{"tuExtractPattern", "[", 
     RowBox[{"Tr", "[", "_", "]"}], "]"}]}], "//", 
   "First"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$xx", "=", 
   RowBox[{"XX", "[", 
    RowBox[{"mi", " ", 
     RowBox[{"\[Tau]", ".", 
      RowBox[{"tuDPartial", "[", 
       RowBox[{"n", ",", "t"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"Tr", "[", "a_", "]"}], "\[Rule]", "a"}]}], "/.", 
     RowBox[{
      RowBox[{"inv", "[", "a_", "]"}], "\[Rule]", 
      RowBox[{"1", "/", "a"}]}]}], " ", "/.", 
    RowBox[{
     RowBox[{"\[Tau]", ".", 
      RowBox[{"(", " ", 
       RowBox[{"dd", ":", 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"n", ",", "t"}], "]"}]}], ")"}]}], "\[Rule]", 
     RowBox[{"m", " ", "$xx"}]}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"$1", "=", 
  RowBox[{"tuSeries", "[", 
   RowBox[{"$1", ",", 
    RowBox[{"{", 
     RowBox[{"$xx", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", "\[Tau]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"//", "\[IndentingNewLine]", "$1"}], "=", 
   RowBox[{"$1", "//", 
    RowBox[{
     RowBox[{"ii", ":", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactive", "[", "tuRuleApply", "]"}], "[", "r_", "]"}], "[", 
       "exp_", "]"}]}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"tuRuleApply", "[", "r", "]"}], "[", 
      RowBox[{
       RowBox[{"expandDot", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "Simplify", "}"}]}], "]"}], "[", "exp", "]"}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"$1", "//", "First"}], "//", "First"}], "//", "Activate"}], "//", 
      RowBox[{"expandDot", "[", "]"}]}], "//", 
     RowBox[{"tuOpCollect", "[", "]"}]}], "//", "Simplify"}]}], ";", 
  RowBox[{"$1", "//", "ColumnSumExp"}]}], "\[IndentingNewLine]", 
 RowBox[{"$", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"$1", "/.", 
     RowBox[{"mi", "\[Rule]", 
      RowBox[{"1", "/", "m"}]}]}], "/.", 
    RowBox[{
     RowBox[{"XX", "[", "a_", "]"}], "\[Rule]", "a"}]}], "//", 
   RowBox[{"expandDot", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "m", "}"}]}], "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7942370171042757`*^9, 3.7942370202702637`*^9}, {
   3.794237076615817*^9, 3.7942371341773148`*^9}, {3.7942374921146383`*^9, 
   3.7942375296633987`*^9}, {3.794237587541051*^9, 3.794237661800414*^9}, {
   3.794237871704493*^9, 3.794237920559219*^9}, {3.7942382269347343`*^9, 
   3.794238235655102*^9}, 3.79423828181982*^9, {3.794314444403802*^9, 
   3.794314476472975*^9}, {3.794314527061702*^9, 3.7943145667268343`*^9}, 
   3.794314774417362*^9, {3.794314860259882*^9, 3.7943148772585793`*^9}, 
   3.7943149083367023`*^9, 3.794316597291101*^9, {3.79431664951267*^9, 
   3.794316665422806*^9}, {3.794316716289234*^9, 3.7943168904937162`*^9}, {
   3.794316967711788*^9, 3.794317037149547*^9}, {3.7943205917630043`*^9, 
   3.7943206059766493`*^9}, {3.7943206711086693`*^9, 
   3.7943206894591017`*^9}, {3.7943207272711363`*^9, 3.794320774228251*^9}, {
   3.79432083882059*^9, 3.794320839081518*^9}, {3.794320879091406*^9, 
   3.794320879489444*^9}, 3.794321453087598*^9, 3.794321643653676*^9, {
   3.7943217010714293`*^9, 3.7943217100656548`*^9}, {3.794321751662776*^9, 
   3.7943217643660583`*^9}, {3.794321804679228*^9, 3.7943218620078163`*^9}, {
   3.794321896989352*^9, 3.794321930849889*^9}, {3.794321974147707*^9, 
   3.794321991704486*^9}, {3.794322036691441*^9, 3.794322040539955*^9}, {
   3.794404060753957*^9, 3.7944041251130877`*^9}, {3.794404196775875*^9, 
   3.7944042365432777`*^9}, 3.794404292095743*^9, {3.794404330550871*^9, 
   3.7944043662270613`*^9}, {3.794404415662298*^9, 3.7944044211175547`*^9}, {
   3.79440450641415*^9, 3.7944045226031227`*^9}, {3.7944046244420757`*^9, 
   3.794404659712804*^9}, {3.794405059808359*^9, 3.794405089229268*^9}, {
   3.7944051504435663`*^9, 3.794405181114146*^9}, {3.794405261351323*^9, 
   3.794405281909264*^9}, {3.7944053242174892`*^9, 3.794405348362797*^9}, {
   3.794405997696265*^9, 3.794405998261332*^9}, {3.7944061061077967`*^9, 
   3.7944061137209263`*^9}, {3.794406173578904*^9, 3.7944063570416327`*^9}, {
   3.794406535866496*^9, 3.7944065524265127`*^9}, {3.794406587338234*^9, 
   3.794406591185755*^9}, {3.794406686614506*^9, 3.7944067290649633`*^9}, 
   3.794411358806932*^9, {3.794411529185616*^9, 3.794411631917574*^9}, {
   3.794411723914508*^9, 3.79441172883709*^9}, {3.7944118252048407`*^9, 
   3.794411829057588*^9}, {3.794411891633741*^9, 3.794411894661984*^9}, {
   3.7944119397475443`*^9, 3.794411942051499*^9}, {3.794412035010767*^9, 
   3.794412039430737*^9}, {3.7944121139325733`*^9, 3.794412201796814*^9}, {
   3.794412641647649*^9, 3.7944126652753143`*^9}, {3.794412902042078*^9, 
   3.794412904757366*^9}, 3.794413046577187*^9, {3.794413340996162*^9, 
   3.7944133750442657`*^9}, 3.794415320248444*^9, {3.7944154038352737`*^9, 
   3.79441542100891*^9}, {3.7944155119277067`*^9, 3.7944155137411203`*^9}, {
   3.794415554678046*^9, 3.794415555734229*^9}, {3.794415616501326*^9, 
   3.794415643681505*^9}, {3.794415705841971*^9, 3.794415708819907*^9}, {
   3.794415752235539*^9, 3.79441578087115*^9}, {3.794415921072424*^9, 
   3.7944159246318398`*^9}, {3.794416316403623*^9, 3.794416321360767*^9}, 
   3.794416441098735*^9, {3.794416537788877*^9, 3.7944165421342688`*^9}, {
   3.794416675333605*^9, 3.7944167101520643`*^9}, {3.794416920334344*^9, 
   3.79441694690602*^9}, {3.794416982464942*^9, 3.794416983882082*^9}, {
   3.794417043912319*^9, 3.79441709950856*^9}, 3.794417823667659*^9, {
   3.794417891492709*^9, 3.794417969363111*^9}, {3.794418028295364*^9, 
   3.7944180291895227`*^9}, 3.794418132331443*^9, {3.794418852229994*^9, 
   3.794418861703225*^9}, {3.794486341710177*^9, 3.79448639770732*^9}, {
   3.794486541287875*^9, 3.794486577837195*^9}, {3.794486617018836*^9, 
   3.794486623867889*^9}, {3.794499355674477*^9, 3.794499357865139*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"aabb7ebb-6ad9-4248-8229-eb1afab371a3"],

Cell[BoxData[
 RowBox[{"Tr", "[", 
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   RowBox[{
    RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["m", "2"], " ", "n"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "m", " ", 
       RowBox[{"\[Tau]", ".", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          Blank[], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}]}]}], ")"}], ".", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"m", " ", 
        RowBox[{"\[Tau]", ".", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
          
          Editable->False,
          SyntaxForm->Automatic]}]}], "-", 
       RowBox[{"m", " ", 
        RowBox[{"n", ".", "\[Tau]", ".", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Blank[], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}]}], "+", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Blank[], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`tuDDown["\[PartialD]"][
          Blank[], $CellContext`t], $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"]}]}], "]"}]], "Output",
 CellChangeTimes->{3.800188543533551*^9, 3.800188903767017*^9, 
  3.8002678470661087`*^9},ExpressionUUID->"0ff6080c-e220-4e5c-9c99-\
c2cda8e83c4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      TemplateBox[{"tuRuleApply"},
       "InactiveHead",
       BaseStyle->"Inactive",
       SyntaxForm->"Symbol",
       Tooltip->"Inactive[tuRuleApply]"], "[", 
      RowBox[{
       RowBox[{"XX", "[", 
        RowBox[{"mi", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}]}], "]"}], "\[Rule]", "0"}], "]"}], "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["m", "2"], " ", "n"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "m", " ", 
          RowBox[{"\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}]}], ")"}], ".", 
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"m", " ", 
          RowBox[{"n", ".", "\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}], "-", 
         RowBox[{
          SuperscriptBox["m", "2"], " ", 
          RowBox[{"XX", "[", 
           RowBox[{"mi", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "]"}]}], "+", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown["\[PartialD]"][
            Blank[], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}]]}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"XX", "[", 
      RowBox[{"mi", " ", 
       RowBox[{"\[Tau]", ".", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
         $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}]}], "]"}], " ", 
     RowBox[{
      RowBox[{
       TemplateBox[{"tuRuleApply"},
        "InactiveHead",
        BaseStyle->"Inactive",
        SyntaxForm->"Symbol",
        Tooltip->"Inactive[tuRuleApply]"], "[", 
       RowBox[{
        RowBox[{"XX", "[", 
         RowBox[{"mi", " ", 
          RowBox[{"\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}], "]"}], "\[Rule]", "0"}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{
         RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", 
               SuperscriptBox["m", "2"], " ", "n"}], "-", 
              RowBox[{"\[ImaginaryI]", " ", "m", " ", 
               RowBox[{"\[Tau]", ".", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}]}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["m", "2"]}], "-", 
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"n", ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], "+", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], ")"}]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "n", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                    Editable->False,
                    SyntaxForm->Automatic], ".", "\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "m", " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "m", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`m, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                    Editable->False,
                    SyntaxForm->Automatic]}], "-", 
                  RowBox[{
                   RowBox[{"n", ".", "\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "m", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`m, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                    Editable->False,
                    SyntaxForm->Automatic]}], "-", 
                  RowBox[{"2", " ", "m", " ", 
                   RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "m", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][$CellContext`m, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                    Editable->False,
                    SyntaxForm->Automatic]}], "+", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], "]"}],
                   $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`t], 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                   Editable->False,
                   SyntaxForm->Automatic]}], ")"}], "/", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["m", "2"], "-", 
                   RowBox[{"m", " ", 
                    RowBox[{"n", ".", "\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "-", 
                   RowBox[{
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]}], "+", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], ")"}], "2"]}], ")"}]}], ")"}]}],
            "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"0", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], "+", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic], "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t], 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Tau]", ".", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "_", "]"}],
                    $CellContext`tuDDown["\[PartialD]"][
                    Blank[], $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "m", "]"}],
                   $CellContext`tuDDown["\[PartialD]"][$CellContext`m, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "m", " ", "n", " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "m", "]"}],
                   $CellContext`tuDDown["\[PartialD]"][$CellContext`m, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                   Editable->False,
                   SyntaxForm->Automatic]}], "+", 
                 RowBox[{
                  SuperscriptBox["m", "2"], " ", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
                    RowBox[{"XX", "[", 
                    RowBox[{"mi", " ", 
                    RowBox[{"\[Tau]", ".", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t],
                    Editable->False,
                    SyntaxForm->Automatic]}]}], "]"}]], "[", "n", "]"}],
                   $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
                    $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], ")"}]}]}], ")"}], ".", 
            FractionBox["1", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              RowBox[{"m", " ", 
               RowBox[{"n", ".", "\[Tau]", ".", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], "-", 
              RowBox[{
               SuperscriptBox["m", "2"], " ", 
               RowBox[{"XX", "[", 
                RowBox[{"mi", " ", 
                 RowBox[{"\[Tau]", ".", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                    "n", "]"}],
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`n, $CellContext`t],
                   Editable->False,
                   SyntaxForm->Automatic]}]}], "]"}]}], "+", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`tuDDown["\[PartialD]"][
                 Blank[], $CellContext`t], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]]}]}], ")"}]}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
            RowBox[{"XX", "[", 
             RowBox[{"mi", " ", 
              RowBox[{"\[Tau]", ".", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
                 "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}], "]"}]], "[", 
           RowBox[{"\[Delta]", "[", "n", "]"}], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`\[Delta][$CellContext`n], 
           $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
          Editable->False,
          SyntaxForm->Automatic], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["m", "2"], " ", "n"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}]}], ")"}], ".", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", 
            RowBox[{"n", ".", "\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "-", 
           RowBox[{
            SuperscriptBox["m", "2"], " ", 
            RowBox[{"XX", "[", 
             RowBox[{"mi", " ", 
              RowBox[{"\[Tau]", ".", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
                 "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}], "]"}]}], "+", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]]}]}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      TemplateBox[{"tuRuleApply"},
       "InactiveHead",
       BaseStyle->"Inactive",
       SyntaxForm->"Symbol",
       Tooltip->"Inactive[tuRuleApply]"], "[", 
      RowBox[{
       RowBox[{"XX", "[", 
        RowBox[{"mi", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}]}], "]"}], "\[Rule]", "0"}], "]"}], "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["m", "2"], " ", "n"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "m", " ", 
          RowBox[{"\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}]}], ")"}], ".", 
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"m", " ", 
          RowBox[{"n", ".", "\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}], "-", 
         RowBox[{
          SuperscriptBox["m", "2"], " ", 
          RowBox[{"XX", "[", 
           RowBox[{"mi", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "]"}]}], "+", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown["\[PartialD]"][
            Blank[], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}]]}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"XX", "[", 
      RowBox[{"mi", " ", 
       RowBox[{"\[Tau]", ".", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
         $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}]}], "]"}], " ", 
     RowBox[{
      RowBox[{
       TemplateBox[{"tuRuleApply"},
        "InactiveHead",
        BaseStyle->"Inactive",
        SyntaxForm->"Symbol",
        Tooltip->"Inactive[tuRuleApply]"], "[", 
       RowBox[{
        RowBox[{"XX", "[", 
         RowBox[{"mi", " ", 
          RowBox[{"\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}], "]"}], "\[Rule]", "0"}], "]"}], "[", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
         RowBox[{"XX", "[", 
          RowBox[{"mi", " ", 
           RowBox[{"\[Tau]", ".", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
              "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}]}], "]"}]], "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{
          RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "m", " ", 
             RowBox[{"\[Tau]", ".", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
                "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                Blank[], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}]}], ")"}], ".", 
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"m", " ", 
             RowBox[{"n", ".", "\[Tau]", ".", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
                "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                Blank[], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], "-", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"XX", "[", 
              RowBox[{"mi", " ", 
               RowBox[{"\[Tau]", ".", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n",
                   "]"}],
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`n, $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], "]"}]}], "+", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
                "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                Blank[], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t], $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}]]}]}], "]"}],
       $CellContext`tuDDown["\[PartialD]"][Complex[0, -1] Dot[
          $CellContext`\[Delta][$CellContext`n], 
          Complex[0, 1] $CellContext`m^2 $CellContext`n + 
          Complex[0, -1] $CellContext`m Dot[$CellContext`\[Tau], 
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t]], ($CellContext`m^2 - $CellContext`m 
           Dot[$CellContext`n, $CellContext`\[Tau], 
             $CellContext`tuDDown["\[PartialD]"][
              
              Blank[], $CellContext`t]] - $CellContext`m^2 \
$CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`t]]] + \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t], $CellContext`t])^(-1)], 
        $CellContext`XX[$CellContext`mi Dot[$CellContext`\[Tau], 
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`t]]]],
       Editable->False,
       SyntaxForm->Automatic], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.800188543533551*^9, 3.800188903767017*^9, 
  3.800267847090613*^9},ExpressionUUID->"01e64c2e-c94c-49ec-a844-\
8b9b80e9c2ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$", "=", 
  RowBox[{"e", "[", "60", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"$", "//", 
      RowBox[{"tuExtractPattern", "[", 
       RowBox[{"inv", "[", "_", "]"}], "]"}]}], "//", "DeleteDuplicates"}], "//",
     "First"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"$1", "=", 
  RowBox[{"$", "/.", 
   RowBox[{
    RowBox[{"inv", "[", "a_", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["m", "2"], "/", "a"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$1", "=", 
   RowBox[{
    RowBox[{"tuSeries", "[", 
     RowBox[{"$1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", " ", 
         RowBox[{"\[Tau]", ".", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"n", ",", "t"}], "]"}]}]}], ",", "0", ",", "1"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "\[Tau]"}], "}"}]}], "]"}], "//", 
    RowBox[{"expandDot", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tuDPartial", "[", 
        RowBox[{"_", ",", "m"}], "]"}], "\[Rule]", "0"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$1", "//", "ColumnSumExp"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"$", "=", 
  RowBox[{
   RowBox[{"e", "[", "60", "]"}], "/.", 
   RowBox[{
    RowBox[{"inv", "[", "a_", "]"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"$1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      SuperscriptBox["m", "2"]}], 
     ")"}]}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7942370171042757`*^9, 3.7942370202702637`*^9}, {
   3.794237076615817*^9, 3.7942371341773148`*^9}, {3.7942374921146383`*^9, 
   3.7942375296633987`*^9}, {3.794237587541051*^9, 3.794237661800414*^9}, {
   3.794237871704493*^9, 3.794237920559219*^9}, {3.7942382269347343`*^9, 
   3.794238235655102*^9}, 3.79423828181982*^9, {3.794314444403802*^9, 
   3.794314476472975*^9}, {3.794314527061702*^9, 3.7943145667268343`*^9}, 
   3.794314774417362*^9, {3.794314860259882*^9, 3.7943148772585793`*^9}, 
   3.7943149083367023`*^9, 3.794316597291101*^9, {3.79431664951267*^9, 
   3.794316665422806*^9}, {3.794322642754327*^9, 3.7943226428970957`*^9}, {
   3.7943226948382072`*^9, 3.794322704098469*^9}, {3.794323045274186*^9, 
   3.794323066713119*^9}, {3.794323627051325*^9, 3.794323628107759*^9}, {
   3.794323681999794*^9, 3.7943236871591597`*^9}, {3.7943248758350363`*^9, 
   3.7943248999638643`*^9}, {3.794324956385013*^9, 3.794325040483122*^9}, {
   3.7943250909887533`*^9, 3.7943251005532312`*^9}, {3.7943251514595127`*^9, 
   3.794325191770054*^9}, {3.794325254948344*^9, 
   3.794325285091723*^9}},ExpressionUUID->"ab09cbe1-f735-4c42-bdc4-\
c034496a7a77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]", "[", 
   RowBox[{
    SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "\[Rule]", 
  RowBox[{"-", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["m", "2"], " ", "n"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "m", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
           $CellContext`tuDDown["\[PartialD]"][
            Blank[], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}]}]}], ")"}], ".", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["m", "2"], "-", 
         RowBox[{"m", " ", 
          RowBox[{"\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}], "-", 
         RowBox[{"m", " ", 
          RowBox[{"n", ".", "\[Tau]", ".", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]}], "+", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown["\[PartialD]"][
            Blank[], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"]}]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.800188543684383*^9, 3.8001889039339*^9, 
  3.800267847200817*^9},ExpressionUUID->"7f870a23-d6bf-4559-8107-\
7511c4d6a034"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["m", "2"], "-", 
    RowBox[{"m", " ", 
     RowBox[{"\[Tau]", ".", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
       $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}]}], "-", 
    RowBox[{"m", " ", 
     RowBox[{"n", ".", "\[Tau]", ".", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        Blank[], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}]}], "+", 
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        Blank[], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`tuDDown["\[PartialD]"][
       Blank[], $CellContext`t], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"]], "Output",
 CellChangeTimes->{3.800188543684383*^9, 3.8001889039339*^9, 
  3.800267847212834*^9},ExpressionUUID->"e1f95bc9-ce8d-42ac-85e9-\
153d1a0e48d1"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["m", "2"], 
  RowBox[{
   SuperscriptBox["m", "2"], "-", 
   RowBox[{"m", " ", 
    RowBox[{"\[Tau]", ".", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic]}]}], "-", 
   RowBox[{"m", " ", 
    RowBox[{"n", ".", "\[Tau]", ".", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
      $CellContext`tuDDown["\[PartialD]"][
       Blank[], $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic]}]}], "+", 
   InterpretationBox[
    RowBox[{
     SubscriptBox[
      UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
      $CellContext`tuDDown["\[PartialD]"][
       Blank[], $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic], "]"}],
    $CellContext`tuDDown["\[PartialD]"][
     $CellContext`tuDDown["\[PartialD]"][
      Blank[], $CellContext`t], $CellContext`t],
    Editable->False,
    SyntaxForm->Automatic]}]]], "Output",
 CellChangeTimes->{3.800188543684383*^9, 3.8001889039339*^9, 
  3.8002678472217607`*^9},ExpressionUUID->"94d0dd9d-f0ea-48c5-bd4e-\
48c62958cfca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    StyleBox["\<\"\[Sum]\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "[", 
    TagBox[GridBox[{
       {
        RowBox[{"m", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], " ", 
         RowBox[{
          RowBox[{
           TemplateBox[{"tuRuleApply"},
            "InactiveHead",
            BaseStyle->"Inactive",
            SyntaxForm->"Symbol",
            Tooltip->"Inactive[tuRuleApply]"], "[", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"\[Tau]", ".", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
                "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "]"}], "[", "0", 
          "]"}]}]},
       {
        RowBox[{
         RowBox[{
          TemplateBox[{"tuRuleApply"},
           "InactiveHead",
           BaseStyle->"Inactive",
           SyntaxForm->"Symbol",
           Tooltip->"Inactive[tuRuleApply]"], "[", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "]"}], "[", 
         FractionBox[
          SuperscriptBox["m", "2"], 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "-", 
           RowBox[{"m", " ", 
            RowBox[{"n", ".", "\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "+", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "]"}], ",", 
   RowBox[{
    StyleBox["\<\"\[Sum]\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "[", 
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{
          TemplateBox[{"tuRuleApply"},
           "InactiveHead",
           BaseStyle->"Inactive",
           SyntaxForm->"Symbol",
           Tooltip->"Inactive[tuRuleApply]"], "[", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "]"}], "[", 
         FractionBox[
          SuperscriptBox["m", "2"], 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "-", 
           RowBox[{"m", " ", 
            RowBox[{"n", ".", "\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "+", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]], "]"}]},
       {
        RowBox[{"m", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], " ", 
         RowBox[{
          RowBox[{
           TemplateBox[{"tuRuleApply"},
            "InactiveHead",
            BaseStyle->"Inactive",
            SyntaxForm->"Symbol",
            Tooltip->"Inactive[tuRuleApply]"], "[", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"\[Tau]", ".", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
                "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "]"}], "[", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
             RowBox[{"m", " ", 
              RowBox[{"\[Tau]", ".", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
                 "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]], "[", 
            FractionBox[
             SuperscriptBox["m", "2"], 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              RowBox[{"m", " ", 
               RowBox[{"\[Tau]", ".", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n",
                   "]"}],
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`n, $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], "-", 
              RowBox[{"m", " ", 
               RowBox[{"n", ".", "\[Tau]", ".", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}]}], "+", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_",
                   "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`tuDDown["\[PartialD]"][
                 Blank[], $CellContext`t], $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]], "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`m^2/($CellContext`m^2 - $CellContext`m 
            Dot[$CellContext`\[Tau], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t]] - \
$CellContext`m Dot[$CellContext`n, $CellContext`\[Tau], 
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t]] + $CellContext`tuDDown["\[PartialD]"][
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t], $CellContext`t]), $CellContext`m 
            Dot[$CellContext`\[Tau], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t]]],
           Editable->False,
           SyntaxForm->Automatic], "]"}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.800188543684383*^9, 3.8001889039339*^9, 
  3.80026784723386*^9},ExpressionUUID->"3467b46a-2013-4c70-9956-fcf7d573e4c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]", "[", 
   RowBox[{
    SubscriptBox["S", "eff"], "[", "n", "]"}], "]"}], "\[Rule]", 
  RowBox[{"-", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{
      RowBox[{"\[Delta]", "[", "n", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["m", "2"], " ", "n"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "m", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", "]"}],
           $CellContext`tuDDown["\[PartialD]"][
            Blank[], $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}]}]}], ")"}], ".", 
      FractionBox[
       RowBox[{
        RowBox[{"m", " ", 
         RowBox[{"\[Tau]", ".", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], " ", 
         RowBox[{
          RowBox[{
           TemplateBox[{"tuRuleApply"},
            "InactiveHead",
            BaseStyle->"Inactive",
            SyntaxForm->"Symbol",
            Tooltip->"Inactive[tuRuleApply]"], "[", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"\[Tau]", ".", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
                "]"}],
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "]"}], "[", "0", 
          "]"}]}], "+", 
        RowBox[{
         RowBox[{
          TemplateBox[{"tuRuleApply"},
           "InactiveHead",
           BaseStyle->"Inactive",
           SyntaxForm->"Symbol",
           Tooltip->"Inactive[tuRuleApply]"], "[", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "]"}], "[", 
         FractionBox[
          SuperscriptBox["m", "2"], 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", 
            RowBox[{"\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "-", 
           RowBox[{"m", " ", 
            RowBox[{"n", ".", "\[Tau]", ".", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic]}]}], "+", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "_", 
               "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               Blank[], $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`tuDDown["\[PartialD]"][
              Blank[], $CellContext`t], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic]}]], "]"}]}], 
       SuperscriptBox["m", "2"]]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.800188543684383*^9, 3.8001889039339*^9, 
  3.8002678472463827`*^9},ExpressionUUID->"61cb64c9-d3ba-4ade-9fc7-\
c9fd6d674243"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.7 Exercises", "Subsubsection",
 CellChangeTimes->{{3.794239924216989*^9, 
  3.794239929870948*^9}},ExpressionUUID->"731b3ae6-3cf6-40b6-8a78-\
918627feb44e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"CO", "[", 
   RowBox[{
   "\"\<Exercise 4: WZ term in 0+1 \nConsider a three-dimensional unit vector \
field \>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "\[Element]", 
      SuperscriptBox["S", "2"]}], "}"}], ",", 
    "\"\< defined on a two-dimensional disk D.  Define \>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"63", ",", "1"}], "]"}], "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["W", "0"], "\[Rule]", 
            RowBox[{"xIntegral", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"8", "\[Pi]"}], ")"}]}], " ", 
               RowBox[{"T", "[", 
                RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], 
               RowBox[{"n", ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"tuDPartial", "[", 
                   RowBox[{"n", ",", "\[Mu]"}], "]"}], "\[Cross]", 
                  RowBox[{"tuDPartial", "[", 
                   RowBox[{"n", ",", "\[Nu]"}], "]"}]}], ")"}]}]}], ",", 
              RowBox[{"x", "\[Element]", "D"}]}], "]"}]}], "}"}], "[", 
          RowBox[{"CG", "[", "\"\<e[63]\>\"", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["W", "0"], "\[Rule]", 
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{"Tr", "[", 
             RowBox[{
              OverscriptBox["n", "^"], " ", 
              RowBox[{
               RowBox[{"Wedge", "[", 
                RowBox[{
                 RowBox[{"difForm", "[", 
                  OverscriptBox["n", "^"], "]"}], ",", 
                 RowBox[{"difForm", "[", 
                  OverscriptBox["n", "^"], "]"}]}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"16", "\[Pi]", " ", "I"}], ")"}]}]}], "]"}], ",", 
            "D"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          OverscriptBox["n", "^"], "\[Rule]", 
          RowBox[{"n", "\[CenterDot]", "\[Sigma]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "NL", ",", "\[IndentingNewLine]", 
    "\"\<(a) Calculate the variation of \!\(\*SubscriptBox[\(W\), \(0\)]\) \
with respect to n.  Show that the integral becomes the integral over disk D \
of the complete divergence of the exact form.\n(b) Parametrize the boundary \
\[PartialD]D of the disk by parameter t, aply Gauss-Stokes theorem and \
express the result of the variation using only the values of n[t] at the \
boundary.\nWe show that the variation of W depends only on the boundary \
values of n-field. See e[31].\>\""}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7942399402964497`*^9, 3.794240150207424*^9}, {
   3.794240201102532*^9, 3.794240755332007*^9}, 3.794241351504327*^9, {
   3.7943156541441298`*^9, 3.794315664678718*^9}, {3.794315717382111*^9, 
   3.794315739452598*^9}, {3.7944183975557327`*^9, 3.7944184025443783`*^9}, {
   3.794509613469092*^9, 3.794509614208531*^9}, 3.795199789218646*^9, 
   3.798725857792386*^9},ExpressionUUID->"8cb86057-ea22-4f90-b6f7-\
57be2b95cc94"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 4: WZ term in 0+1 \\nConsider a three-dimensional \
unit vector field \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "\[Element]", 
      SuperscriptBox["S", "2"]}], "}"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" defined on a two-dimensional disk D.  Define \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", "0"], "\[Rule]", 
           TemplateBox[{FractionBox[
              RowBox[{
                RowBox[{"n", ".", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", 
                    "n", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
                    SyntaxForm -> Automatic, Editable -> False], "\[Cross]", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", 
                    "n", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], 
                    SyntaxForm -> Automatic, Editable -> False]}]}], " ", 
                InterpretationBox[
                 SubsuperscriptBox["\[Epsilon]", 
                  RowBox[{
                    StyleBox[
                    "\[Mu]", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
                  
                  RowBox[{"\[Mu]", "\[Nu]"}]], 
                 $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\
\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                 False, BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
              RowBox[{"8", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", "D"}]},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               UnderscriptBox[
                StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}], "}"}], "[", 
         StyleBox["\<\"e[63]\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]},
       {
        RowBox[{
         SubscriptBox["W", "0"], "\[Rule]", 
         TemplateBox[{RowBox[{"Tr", "[", 
             RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  OverscriptBox["n", "^"], " ", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    OverscriptBox["n", "^"], "]"}], 
                    $CellContext`difForm[
                    OverHat[$CellContext`n]], SyntaxForm -> Automatic, 
                    Editable -> False], "\[Wedge]", 
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    OverscriptBox["n", "^"], "]"}], 
                    $CellContext`difForm[
                    OverHat[$CellContext`n]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], 
                RowBox[{"16", " ", "\[Pi]"}]]}], "]"}],"D"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]},
       {
        RowBox[{
         OverscriptBox["n", "^"], "\[Rule]", 
         RowBox[{"n", "\[CenterDot]", "\[Sigma]"}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"(a) Calculate the variation of \
\\!\\(\\*SubscriptBox[\\(W\\), \\(0\\)]\\) with respect to n.  Show that the \
integral becomes the integral over disk D of the complete divergence of the \
exact form.\\n(b) Parametrize the boundary \[PartialD]D of the disk by \
parameter t, aply Gauss-Stokes theorem and express the result of the \
variation using only the values of n[t] at the boundary.\\nWe show that the \
variation of W depends only on the boundary values of n-field. See e[31].\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 4: WZ term in 0+1 \nConsider a three-dimensional unit \
vector field ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[{
     Element[
      $CellContext`n[$CellContext`x, $CellContext`y], $CellContext`S^2]}, 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" defined on a two-dimensional disk D.  Define ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{
       {Subscript[$CellContext`W, 0] -> 
        Inactive[Integrate][Rational[1, 8] Pi^(-1) Dot[$CellContext`n, 
            Cross[
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
          Element[$CellContext`x, D]]}[
        Style["e[63]", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Subscript[$CellContext`W, 0] -> Inactive[Integrate][
         Tr[Complex[0, 
            Rational[-1, 16]] Pi^(-1) OverHat[$CellContext`n] Wedge[
            $CellContext`difForm[
             OverHat[$CellContext`n]], 
            $CellContext`difForm[
             OverHat[$CellContext`n]]]], D]}, {
      OverHat[$CellContext`n] -> 
       CenterDot[$CellContext`n, $CellContext`\[Sigma]]}}, 
     Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["(a) Calculate the variation of \!\(\*SubscriptBox[\(W\), \(0\)]\) \
with respect to n.  Show that the integral becomes the integral over disk D \
of the complete divergence of the exact form.\n(b) Parametrize the boundary \
\[PartialD]D of the disk by parameter t, aply Gauss-Stokes theorem and \
express the result of the variation using only the values of n[t] at the \
boundary.\nWe show that the variation of W depends only on the boundary \
values of n-field. See e[31].", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188543834075*^9, 3.800188904101808*^9, 
  3.800267847334399*^9},ExpressionUUID->"735f98a6-6204-4234-975b-\
bace251bfc3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"63", ",", "1"}], "]"}], "//", "tuRule"}], "//", "First"}]}], 
   ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[Bullet] \[Sigma] are basis vectors \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"n", "\[Rule]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"n", ",", "\"\<d\>\"", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}], " ", 
        RowBox[{"T", "[", 
         RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], ",", 
   RowBox[{"(*", 
    RowBox[{
    "\[Sigma]", " ", "are", " ", "unit", " ", "basis", " ", "vectors"}], 
    "*)"}], "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "//", 
      RowBox[{"tuDerivativeExpand", "[", 
       RowBox[{"{", 
        RowBox[{"T", "[", 
         RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "_", "}"}]}], "]"}], "}"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//.", 
       RowBox[{"tuOpDistribute", "[", "Cross", "]"}]}], "//.", 
      RowBox[{"tuOpSimplify", "[", 
       RowBox[{"Cross", ",", 
        RowBox[{"{", 
         RowBox[{"tuDPartial", "[", 
          RowBox[{"_", ",", "_"}], "]"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "NL"}], ",", "\"\<\[Bullet] Use: \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "i_", "}"}]}], "]"}], " ", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "j_", "}"}]}], "]"}]}], "]"}], " ", "\[RuleDelayed]", 
       
       RowBox[{"0", "/;", 
        RowBox[{"i", "\[Equal]", "j"}]}]}], ",", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "i_", "}"}]}], "]"}], " ", ",", " ", 
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "j_", "}"}]}], "]"}]}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j", ",", "k$"}], "}"}]}], "]"}], 
          RowBox[{"T", "[", 
           RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
            RowBox[{"{", "k$", "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k$", ",", "3"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ee", ":", 
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}]}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"tuLeviCivitaNumeric", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "[", 
        "ee", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "//.", "$s"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "//", 
      RowBox[{"expandDot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
              RowBox[{"{", "i_", "}"}]}], "]"}], " ", ".", " ", 
            RowBox[{"T", "[", 
             RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
              RowBox[{"{", "j_", "}"}]}], "]"}]}], " ", "\[RuleDelayed]", 
           RowBox[{"0", "/;", 
            RowBox[{"i", "!=", "j"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
              RowBox[{"{", "i_", "}"}]}], "]"}], " ", ".", " ", 
            RowBox[{"T", "[", 
             RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
              RowBox[{"{", "j_", "}"}]}], "]"}]}], " ", "\[RuleDelayed]", 
           RowBox[{"1", "/;", 
            RowBox[{"i", "==", "j"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tuDPartial", "[", 
           RowBox[{"_", ",", "_"}], "]"}], ",", 
          RowBox[{"T", "[", 
           RowBox[{"n", ",", "\"\<d\>\"", ",", 
            RowBox[{"{", "_", "}"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "/.", 
       RowBox[{
        RowBox[{"ee", ":", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "_"}]}], 
        "\[RuleDelayed]", 
        RowBox[{"Sum", "[", 
         RowBox[{"ee", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "2"}], "}"}]}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"ee", ":", 
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"tuLeviCivitaNumeric", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "[", 
        "ee", "]"}]}]}], "//", "Simplify"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.794315743795295*^9, 3.7943157456016893`*^9}, {
   3.7945082112153187`*^9, 3.794508347777177*^9}, {3.794508385163126*^9, 
   3.7945083901071157`*^9}, {3.79450862228167*^9, 3.7945086226696377`*^9}, {
   3.7945094181400213`*^9, 3.794509436491764*^9}, {3.794509492212734*^9, 
   3.7945095623679457`*^9}, {3.7945096340348797`*^9, 3.794509649197901*^9}, {
   3.794509849398542*^9, 3.794509869800919*^9}, {3.794509902111672*^9, 
   3.794509909529161*^9}, {3.7945101401540413`*^9, 3.794510144067643*^9}, {
   3.794511905594844*^9, 3.794512152729229*^9}, {3.794512186213978*^9, 
   3.794512241476678*^9}, {3.794512272472167*^9, 3.794512289648452*^9}, {
   3.794513811467396*^9, 3.79451382462801*^9}, {3.794513864973423*^9, 
   3.794513901664679*^9}, {3.7945139418842173`*^9, 3.794514099764227*^9}, {
   3.794579090318815*^9, 3.794579092965485*^9}, {3.794579132719449*^9, 
   3.7945792307962837`*^9}, {3.794579270128229*^9, 3.794579301375205*^9}, {
   3.794579339352706*^9, 3.794579410501184*^9}, {3.794579478224753*^9, 
   3.794579479462544*^9}, {3.794579523991391*^9, 3.7945795453415813`*^9}, {
   3.794579594169448*^9, 3.7945796195982313`*^9}, {3.7945797536505547`*^9, 
   3.794579843012789*^9}, {3.794579897116613*^9, 3.7945799845232887`*^9}, {
   3.794580159351102*^9, 3.794580188284088*^9}, {3.794580222785823*^9, 
   3.79458035229103*^9}, {3.794580386422812*^9, 3.794580391859088*^9}, {
   3.794581043881463*^9, 3.794581108527506*^9}, {3.7945814312819633`*^9, 
   3.794581568018373*^9}, {3.794581759680978*^9, 3.794581828943511*^9}, {
   3.794581891959621*^9, 3.794581918743075*^9}, {3.794582696022318*^9, 
   3.7945827115431013`*^9}, 3.7946675269388742`*^9, {3.7950173728173532`*^9, 
   3.7950173749672003`*^9}, {3.795181593365686*^9, 3.79518173141224*^9}, {
   3.795181776039007*^9, 3.795181794372581*^9}, {3.7951818252807207`*^9, 
   3.795181898828463*^9}, 3.7951819482465687`*^9, 
   3.7987258578120604`*^9},ExpressionUUID->"2014b27c-1603-47a9-ae64-\
0ae6295ad294"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SubscriptBox["W", "0"], "\[Rule]", 
   RowBox[{
    RowBox[{
     TemplateBox[{FractionBox[
        RowBox[{
          RowBox[{"n", ".", 
            RowBox[{
              InterpretationBox[
               RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", "n", 
                 "]"}], 
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], SyntaxForm -> 
               Automatic, Editable -> False], "\[Cross]", 
              InterpretationBox[
               RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", "n", 
                 "]"}], 
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], SyntaxForm -> 
               Automatic, Editable -> False]}]}], " ", 
          InterpretationBox[
           SubsuperscriptBox["\[Epsilon]", 
            RowBox[{
              StyleBox["\[Mu]", ShowContents -> False, StripOnInput -> False], 
              StyleBox[
              "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
            RowBox[{"\[Mu]", "\[Nu]"}]], 
           $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], Editable -> 
           False, BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
        RowBox[{"8", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", "D"}]},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         UnderscriptBox[
          StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\[Bullet] \[Sigma] are basis vectors \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"n", "\[Rule]", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Sigma]", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`\[Sigma], {1}, {$CellContext`Void}],
         
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Sigma]", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`\[Sigma], {2}, {$CellContext`Void}],
         
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Sigma]", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`\[Sigma], {3}, {$CellContext`Void}],
         
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}]}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\[Bullet] Use: \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["\[Sigma]", 
           StyleBox["i_",
            StripOnInput->False,
            ShowContents->False], "i_"],
          $CellContext`Tensor[$CellContext`\[Sigma], {
            Pattern[$CellContext`i, 
             Blank[]]}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Cross]", 
         InterpretationBox[
          SubsuperscriptBox["\[Sigma]", 
           StyleBox["j_",
            StripOnInput->False,
            ShowContents->False], "j_"],
          $CellContext`Tensor[$CellContext`\[Sigma], {
            Pattern[$CellContext`j, 
             Blank[]]}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "\[RuleDelayed]", 
        RowBox[{"0", "/;", 
         RowBox[{"i", "\[Equal]", "j"}]}]}], ",", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["\[Sigma]", 
           StyleBox["i_",
            StripOnInput->False,
            ShowContents->False], "i_"],
          $CellContext`Tensor[$CellContext`\[Sigma], {
            Pattern[$CellContext`i, 
             Blank[]]}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Cross]", 
         InterpretationBox[
          SubsuperscriptBox["\[Sigma]", 
           StyleBox["j_",
            StripOnInput->False,
            ShowContents->False], "j_"],
          $CellContext`Tensor[$CellContext`\[Sigma], {
            Pattern[$CellContext`j, 
             Blank[]]}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "\[RuleDelayed]", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", "k$", "3"], 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"\[Epsilon]", ",", "\<\"uuu\"\>", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j", ",", "k$"}], "}"}]}], "]"}], " ", 
          RowBox[{"T", "[", 
           RowBox[{"\[Sigma]", ",", "\<\"u\"\>", ",", 
            RowBox[{"{", "k$", "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"ee", ":", 
         InterpretationBox[
          SubsuperscriptBox["\[Epsilon]", 
           StyleBox[
            RowBox[{"_", "_", "_"}],
            StripOnInput->False,
            ShowContents->False], 
           RowBox[{"_", "_", "_"}]],
          $CellContext`Tensor[$CellContext`\[Epsilon], {
            Blank[], 
            Blank[], 
            
            Blank[]}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"tuLeviCivitaNumeric", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "[", 
         "ee", "]"}]}]}], "}"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     SubscriptBox["W", "0"]}], "\[Rule]", 
    TemplateBox[{FractionBox[
       RowBox[{
         RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", 
             RowBox[{"3"}], 
             RowBox[{
               StyleBox["3", ShowContents -> False, StripOnInput -> False]}]], 
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
            Editable -> False, 
            BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 " ", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
               "+", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}]}], 
             ")"}]}], "+", 
         RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", 
             RowBox[{"2"}], 
             RowBox[{
               StyleBox["2", ShowContents -> False, StripOnInput -> False]}]], 
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
            Editable -> False, 
            BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
               "-", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}]}], 
             ")"}]}], "+", 
         RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", 
             RowBox[{"1"}], 
             RowBox[{
               StyleBox["1", ShowContents -> False, StripOnInput -> False]}]], 
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
            Editable -> False, 
            BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
           RowBox[{"(", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 " ", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
               "+", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`tuDDown["\[PartialD]"][
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}]}], 
             ")"}]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", "D"}]},
     "InactiveIntegrate",
     DisplayFunction->(RowBox[{
        UnderscriptBox[
         StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
     InterpretationFunction->(RowBox[{
        RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}],
  SequenceForm[
  Subscript[$CellContext`W, 0] -> 
   Inactive[Integrate][Rational[1, 8] Pi^(-1) Dot[$CellContext`n, 
       Cross[
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
     Element[$CellContext`x, D]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] \[Sigma] are basis vectors ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], $CellContext`n -> $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] $CellContext`Tensor[$CellContext`\[Sigma], {
       1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] $CellContext`Tensor[$CellContext`\[Sigma], {
       2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] $CellContext`Tensor[$CellContext`\[Sigma], {
       3}, {$CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Use: ", 
    RGBColor[0.7, 0, 1, 1], Larger], {Cross[
      $CellContext`Tensor[$CellContext`\[Sigma], {
        Pattern[$CellContext`i, 
         Blank[]]}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`\[Sigma], {
        Pattern[$CellContext`j, 
         Blank[]]}, {$CellContext`Void}]] :> 
    Condition[0, $CellContext`i == $CellContext`j], Cross[
      $CellContext`Tensor[$CellContext`\[Sigma], {
        Pattern[$CellContext`i, 
         Blank[]]}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`\[Sigma], {
        Pattern[$CellContext`j, 
         Blank[]]}, {$CellContext`Void}]] :> 
    Sum[$CellContext`T[$CellContext`\[Epsilon], 
        "uuu", {$CellContext`i, $CellContext`j, $CellContext`k$}] \
$CellContext`T[$CellContext`\[Sigma], 
        "u", {$CellContext`k$}], {$CellContext`k$, 3}], 
    Pattern[$CellContext`ee, 
      $CellContext`Tensor[$CellContext`\[Epsilon], {
        Blank[], 
        Blank[], 
        Blank[]}, {$CellContext`Void, $CellContext`Void, $CellContext`Void}]] :> \
$CellContext`tuLeviCivitaNumeric[{1, 1, 1, 1}][$CellContext`ee]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`W, 0] -> 
   Inactive[Integrate][
    Rational[1, 4] 
     Pi^(-1) ($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}] (-$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
           2] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
           1] + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
           1] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
           2]) + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}] ($CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
           2] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
           1] - $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
          1] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
          2]) + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}] (-$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
           2] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
           1] + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
           1] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
           2])), 
     Element[$CellContext`x, D]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188543990244*^9, 3.800188904297855*^9, 
  3.800267847447942*^9},ExpressionUUID->"4740f7ff-5134-4aa8-8b06-\
1e38b5a8d577"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<The variation of \>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"63", ",", "1"}], "]"}], "//", "tuRule"}], "//", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", " ", 
      RowBox[{
       RowBox[{"a_", "  ", 
        RowBox[{"ww", ":", 
         RowBox[{"Wedge", "[", "__", "]"}]}]}], "\[Rule]", 
       RowBox[{"a", ".", "ww"}]}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$s", "=", 
     RowBox[{
      OverscriptBox["n", "^"], "\[Rule]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"n", ",", "\"\<d\>\"", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], " ", 
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$0", "=", 
     RowBox[{"$", "=", 
      RowBox[{"$", "/.", "$s"}]}]}], ";", "\[IndentingNewLine]", "NL"}], ",", 
   "\"\<\[Bullet] The variation of Tr[]\>\"", ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{"$t", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"tuExtractPattern", "[", 
       RowBox[{"Tr", "[", "_", "]"}], "]"}], "[", "$", "]"}], "//", 
     "First"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$t", "=", 
     RowBox[{"$t", "//", 
      RowBox[{"tuDifFormWedgeSimplify", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", "[", 
          RowBox[{"\[Sigma]", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "Yield"}], ",", 
   RowBox[{"$t", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"$t", "//.", "tuPauliMatrices"}], "/.", "toDot"}], "//", 
      RowBox[{"expandDot", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Wedge", "[", 
          RowBox[{"_", ",", "_"}], "]"}], "}"}]}], "]"}]}], "//", 
     RowBox[{"tuWedgeSimplify", "[", 
      RowBox[{"{", 
       RowBox[{"T", "[", 
        RowBox[{"n", ",", "\"\<d\>\"", ",", 
         RowBox[{"{", "_", "}"}]}], "]"}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$1", "=", 
    RowBox[{"$0", "/.", 
     RowBox[{
      RowBox[{"Tr", "[", "__", "]"}], "\[Rule]", "$t"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[Bullet] The d[] variation of the Tr[] term \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"$tmp", "=", 
    RowBox[{"$dt", "=", 
     RowBox[{"difForm", "[", "$t", "]"}]}]}], ",", "CK", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$dt", "=", 
    RowBox[{"$dt", "//", 
     RowBox[{"tuDifFormWedgeSimplify", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], ",", 
   RowBox[{"CG", "[", "\"\<an Exact form.\>\"", "]"}], ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"$", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
      RowBox[{"$", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
     RowBox[{
      RowBox[{"Tr", "[", "__", "]"}], "\[Rule]", "$dt"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "66", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"63", ",", "1"}], "]"}], ",", "$1", ",", "$"}], "}"}]}], ";", 
    "\"\<\>\""}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.794667560020565*^9, 3.794667836442361*^9}, {
   3.794667877658547*^9, 3.794667878275627*^9}, {3.7946695942393007`*^9, 
   3.79466967793566*^9}, {3.794669751113965*^9, 3.79466975748904*^9}, {
   3.794669803254156*^9, 3.794669840820888*^9}, {3.7946698881808643`*^9, 
   3.7946699243444843`*^9}, {3.794669956486597*^9, 3.794669976796385*^9}, {
   3.794670040042028*^9, 3.7946701358569727`*^9}, {3.794837839786954*^9, 
   3.7948378419453583`*^9}, {3.794837873764229*^9, 3.794837908095278*^9}, {
   3.79483796997843*^9, 3.794837988186775*^9}, {3.794842805412285*^9, 
   3.7948428228732443`*^9}, {3.79484285587875*^9, 3.7948429540775642`*^9}, {
   3.794842996182817*^9, 3.794843032670981*^9}, {3.794843084081026*^9, 
   3.794843122613434*^9}, {3.794843362835442*^9, 3.794843375586232*^9}, {
   3.79484341768649*^9, 3.794843465055654*^9}, {3.7948435007480516`*^9, 
   3.794843833137084*^9}, {3.7948438828636103`*^9, 3.79484388940522*^9}, {
   3.794843931052517*^9, 3.7948439691372223`*^9}, {3.794844378934355*^9, 
   3.794844547155303*^9}, {3.7948445900751677`*^9, 3.794844634087036*^9}, 
   3.794844668080172*^9, 3.7948447226866827`*^9, {3.7948447541344337`*^9, 
   3.794844782165761*^9}, {3.794844830386917*^9, 3.794844921468728*^9}, {
   3.794846035216683*^9, 3.794846043082048*^9}, {3.7948460884372396`*^9, 
   3.794846130641144*^9}, {3.794846174885201*^9, 3.794846176736361*^9}, {
   3.794847845127296*^9, 3.794847862475363*^9}, {3.794847903035182*^9, 
   3.7948479740891237`*^9}, {3.7948480060825157`*^9, 3.7948480145535307`*^9}, 
   3.794848712096195*^9, {3.794927276398244*^9, 3.794927276990138*^9}, {
   3.794927314873618*^9, 3.79492734280409*^9}, 3.79492737636557*^9, {
   3.7949277760922413`*^9, 3.794927918909418*^9}, 3.794928141669126*^9, {
   3.794928540703659*^9, 3.794928581392083*^9}, {3.794929265751502*^9, 
   3.794929388259165*^9}, {3.7949294231546*^9, 3.7949294921373873`*^9}, {
   3.794929576801093*^9, 3.7949296095754004`*^9}, {3.794953425442284*^9, 
   3.794953463986888*^9}, {3.795009998234414*^9, 3.795010032319412*^9}, {
   3.795010304391511*^9, 3.79501030890331*^9}, {3.795011703847554*^9, 
   3.795011705385023*^9}, {3.795011740336083*^9, 3.795011743221663*^9}, {
   3.795011792072891*^9, 3.795011797717753*^9}, {3.795011847783594*^9, 
   3.795011885934146*^9}, {3.795011970765957*^9, 3.795012013058506*^9}, {
   3.795012079599999*^9, 3.7950120805833282`*^9}, {3.7950121860627527`*^9, 
   3.795012212113098*^9}, {3.795264722287458*^9, 3.795264770145294*^9}, {
   3.798725857825489*^9, 
   3.798725857838776*^9}},ExpressionUUID->"523e4944-b0c3-4d7f-ae6f-\
73046e02308b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"The variation of \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    SubscriptBox["W", "0"]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     TemplateBox[{RowBox[{"Tr", "[", 
         RowBox[{
           RowBox[{"(", 
             RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  OverscriptBox["n", "^"]}], 
                RowBox[{"16", " ", "\[Pi]"}]]}], ")"}], ".", 
           RowBox[{"(", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  OverscriptBox["n", "^"], "]"}], 
                $CellContext`difForm[
                 OverHat[$CellContext`n]], SyntaxForm -> Automatic, Editable -> 
                False], "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  OverscriptBox["n", "^"], "]"}], 
                $CellContext`difForm[
                 OverHat[$CellContext`n]], SyntaxForm -> Automatic, Editable -> 
                False]}], ")"}]}], "]"}],"D"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\[Bullet] The variation of Tr[]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Sigma]", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False], "1"],
               $CellContext`Tensor[$CellContext`\[Sigma], {
                1}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}], "+", 
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Sigma]", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False], "2"],
               $CellContext`Tensor[$CellContext`\[Sigma], {
                2}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}], "+", 
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Sigma]", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False], "3"],
               $CellContext`Tensor[$CellContext`\[Sigma], {
                3}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}]}], ")"}]}], 
          RowBox[{"16", " ", "\[Pi]"}]]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Sigma]", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False], "1"],
              $CellContext`Tensor[$CellContext`\[Sigma], {
               1}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "+", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Sigma]", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False], "2"],
              $CellContext`Tensor[$CellContext`\[Sigma], {
               2}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "+", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Sigma]", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False], "3"],
              $CellContext`Tensor[$CellContext`\[Sigma], {
               3}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}]}], "]"}],
          $CellContext`difForm[$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] $CellContext`Tensor[$CellContext`\[Sigma], {
              1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] $CellContext`Tensor[$CellContext`\[Sigma], {
              2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] $CellContext`Tensor[$CellContext`\[Sigma], {
              3}, {$CellContext`Void}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Sigma]", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False], "1"],
              $CellContext`Tensor[$CellContext`\[Sigma], {
               1}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "+", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Sigma]", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False], "2"],
              $CellContext`Tensor[$CellContext`\[Sigma], {
               2}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "+", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Sigma]", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False], "3"],
              $CellContext`Tensor[$CellContext`\[Sigma], {
               3}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}]}], "]"}],
          $CellContext`difForm[$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] $CellContext`Tensor[$CellContext`\[Sigma], {
              1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] $CellContext`Tensor[$CellContext`\[Sigma], {
              2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] $CellContext`Tensor[$CellContext`\[Sigma], {
              3}, {$CellContext`Void}]],
          Editable->False,
          SyntaxForm->Automatic]}], ")"}]}], "]"}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{
      FractionBox[
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "-", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "+", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]]}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[RightArrow] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     SubscriptBox["W", "0"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      TemplateBox[{RowBox[{"(", 
          RowBox[{
            FractionBox[
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], 
               "\[CenterDot]", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}]], SyntaxForm -> Automatic, Editable -> False], 
                 "\[Wedge]", 
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
             RowBox[{"4", " ", "\[Pi]"}]], "-", 
            FractionBox[
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], 
               "\[CenterDot]", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}]], SyntaxForm -> Automatic, Editable -> False], 
                 "\[Wedge]", 
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
             RowBox[{"4", " ", "\[Pi]"}]], "+", 
            FractionBox[
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], 
               "\[CenterDot]", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}]], SyntaxForm -> Automatic, Editable -> False], 
                 "\[Wedge]", 
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}], ")"}],"D"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"\[Bullet] The d[] variation of the Tr[] term \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      InterpretationBox[
       RowBox[{
        UnderscriptBox["d", "_"], "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[CenterDot]", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`difForm[
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
             Editable->False,
             SyntaxForm->Automatic], "\[Wedge]", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`difForm[
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
             Editable->False,
             SyntaxForm->Automatic]}]}], 
          RowBox[{"4", " ", "\[Pi]"}]], "-", 
         FractionBox[
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[CenterDot]", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`difForm[
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
             Editable->False,
             SyntaxForm->Automatic], "\[Wedge]", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`difForm[
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
             Editable->False,
             SyntaxForm->Automatic]}]}], 
          RowBox[{"4", " ", "\[Pi]"}]], "+", 
         FractionBox[
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "\[CenterDot]", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`difForm[
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
             Editable->False,
             SyntaxForm->Automatic], "\[Wedge]", 
            InterpretationBox[
             RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`difForm[
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
             Editable->False,
             SyntaxForm->Automatic]}]}], 
          RowBox[{"4", " ", "\[Pi]"}]]}], "]"}],
       $CellContext`difForm[Rational[1, 4] Pi^(-1) CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
           Wedge[
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
        Rational[-1, 4] Pi^(-1) CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
           Wedge[
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
        Rational[1, 4] Pi^(-1) CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
           Wedge[
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]]],
       Editable->False,
       SyntaxForm->Automatic], "\[InvisibleSpace]", 
      StyleBox["\<\"\[LongLeftArrow]CHECK\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[RightArrow] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "\[InvisibleSpace]", 
      StyleBox["\<\"an Exact form.\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[Implies] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{"\[Delta]", "[", 
       SubscriptBox["W", "0"], "]"}]}], "\[Rule]", 
     RowBox[{
      TemplateBox[{FractionBox[
         RowBox[{"3", " ", 
           RowBox[{
             InterpretationBox[
              RowBox[{
                UnderscriptBox["d", "_"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", 
                  RowBox[{"1"}], 
                  RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}], Editable -> False, 
                 BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
               SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
             InterpretationBox[
              RowBox[{
                UnderscriptBox["d", "_"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", 
                  RowBox[{"2"}], 
                  RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], Editable -> False, 
                 BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
               SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
             InterpretationBox[
              RowBox[{
                UnderscriptBox["d", "_"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", 
                  RowBox[{"3"}], 
                  RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}], Editable -> False, 
                 BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
               SyntaxForm -> Automatic, Editable -> False]}]}], 
         RowBox[{"4", " ", "\[Pi]"}]],"D"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
      StyleBox["\<\"\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1]}]}]}]}],
  SequenceForm[
   Style["The variation of ", 
    RGBColor[0.7, 0, 1, 1], Larger], Subscript[$CellContext`W, 0] -> 
   Inactive[Integrate][
     Tr[
      Dot[Complex[0, 
         Rational[-1, 16]] Pi^(-1) OverHat[$CellContext`n], 
       Wedge[
        $CellContext`difForm[
         OverHat[$CellContext`n]], 
        $CellContext`difForm[
         OverHat[$CellContext`n]]]]], D], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] The variation of Tr[]", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Tr[
    Dot[Complex[0, 
       Rational[-1, 16]] 
     Pi^(-1) ($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}] $CellContext`Tensor[$CellContext`\[Sigma], {
         1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] $CellContext`Tensor[$CellContext`\[Sigma], {
         2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] $CellContext`Tensor[$CellContext`\[Sigma], {
         3}, {$CellContext`Void}]), 
     Wedge[
      $CellContext`difForm[$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] $CellContext`Tensor[$CellContext`\[Sigma], {
          1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] $CellContext`Tensor[$CellContext`\[Sigma], {
          2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] $CellContext`Tensor[$CellContext`\[Sigma], {
          3}, {$CellContext`Void}]], 
      $CellContext`difForm[$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] $CellContext`Tensor[$CellContext`\[Sigma], {
          1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] $CellContext`Tensor[$CellContext`\[Sigma], {
          
          2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] $CellContext`Tensor[$CellContext`\[Sigma], {
          3}, {$CellContext`Void}]]]]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Rational[1, 4] Pi^(-1) CenterDot[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
      Wedge[
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
   Rational[-1, 4] Pi^(-1) CenterDot[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
      Wedge[
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
   Rational[1, 4] Pi^(-1) CenterDot[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
      Wedge[
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`W, 0] -> 
   Inactive[Integrate][Rational[1, 4] Pi^(-1) CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
     Rational[-1, 4] Pi^(-1) CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
     Rational[1, 4] Pi^(-1) CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]], 
     D], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] The d[] variation of the Tr[] term ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   $CellContext`difForm[Rational[1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
    Rational[-1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
    Rational[1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]]], 
   Style["\[LongLeftArrow]CHECK", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Rational[3, 4] Pi^(-1) Wedge[
     $CellContext`difForm[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
     $CellContext`difForm[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
     $CellContext`difForm[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]], 
   Style["an Exact form.", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`\[Delta][
     Subscript[$CellContext`W, 0]] -> 
   Inactive[Integrate][Rational[3, 4] Pi^(-1) Wedge[
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]], D], 
   Style["", 
    RGBColor[0.7, 0, 1, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188546510515*^9, 3.800188906795377*^9, 
  3.800267849374208*^9},ExpressionUUID->"4cda23b5-ce3e-43fd-ba42-\
72a717536852"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<For \>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "66", "]"}], "//", 
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{
         SubscriptBox["W", "0"], ",", 
         RowBox[{"{", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"_", ",", "_"}], "]"}], "}"}]}], "]"}]}], "//", 
      "First"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{"{", 
      RowBox[{"D", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"CG", "[", 
           RowBox[{"0", "\[LessEqual]", "t", "<", 
            RowBox[{"2", "\[Pi]"}]}], "]"}], "]"}], ",", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"CG", "[", 
           RowBox[{"0", "<", "\[Rho]", "\[LessEqual]", "1"}], "]"}], "]"}]}], 
        "}"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Compute \>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"tuRule1", "[", "$s", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"d", "/@", "$"}]}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$0", "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$", "//", 
        RowBox[{"tuOpSwitch", "[", 
         RowBox[{"d", ",", "xIntegral"}], "]"}]}], "//", 
       RowBox[{"tuOpSimplifyF", "[", "d", "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//", 
       RowBox[{"tuExtractPositionPattern", "[", 
        RowBox[{"d", "[", "_", "]"}], "]"}]}], "//", "Last"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "//", 
      RowBox[{"tudExpandvI", "[", 
       RowBox[{"d", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], ",", "\[Mu]", 
          ",", "\[Nu]"}], "}"}]}], "]"}]}], "//", 
     RowBox[{"tuD2tuDOp", "[", "tuDPartial", "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", "\[IndentingNewLine]", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"d", "[", "n", "]"}], 
      RowBox[{"tuDPartial", "[", 
       RowBox[{
        RowBox[{"tuDPartial", "[", 
         RowBox[{"n", ",", "m_"}], "]"}], ",", "n"}], "]"}]}], "\[Rule]", 
     RowBox[{"tuDPartial", "[", 
      RowBox[{
       RowBox[{"d", "[", "n", "]"}], ",", "m"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Imply", ",", "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{"$", "/.", "$s"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Use \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", "n", "]"}], ".", 
          RowBox[{
           RowBox[{"tuDPartial", "[", 
            RowBox[{"n", ",", "_"}], "]"}], "\[Cross]", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"n", ",", "_"}], "]"}]}]}], "\[Rule]", "0"}], "}"}], "[", 
       
       RowBox[{"CG", "[", "\"\<see comment\>\"", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dd", ":", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"n", ",", "\[Mu]"}], "]"}]}], ")"}], "\[Cross]", "a_"}], 
       "\[Rule]", 
       RowBox[{"-", 
        RowBox[{"a", "\[Cross]", "dd"}]}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dd", ":", 
         RowBox[{
          RowBox[{"tuDPartial", "[", 
           RowBox[{"_", ",", "\[Mu]"}], "]"}], "\[Cross]", "b_"}]}], ")"}], 
       "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"tuIndexSwap", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "[", "dd", "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//.", 
     RowBox[{"tuRule", "[", "$s", "]"}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$1", "=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"$", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Rho]"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Rho]"}], "}"}]}], "}"}]}], "]"}], "//", 
      RowBox[{"expandDot", "[", 
       RowBox[{"{", "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$1", "=", 
     RowBox[{
      RowBox[{"$1", "//", "tuLeviCivitaReduce2"}], "//", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"$1", "/.", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "]"}], "\[Rule]", "1"}]}], "/.", 
      
      RowBox[{
       RowBox[{"aa", ":", 
        RowBox[{"a_", "\[Cross]", 
         RowBox[{"xtuDPartial", "[", 
          RowBox[{"n", ",", "\[Rho]"}], "]"}]}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"Reverse", "[", "aa", "]"}]}]}]}]}], ";", "$"}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Use: \>\"", ",", "\"\<POFF\>\"", 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$s0", "=", 
     RowBox[{"$s", "=", 
      RowBox[{
       RowBox[{"tuDPartial", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"n", ",", "\[Rho]"}], "]"}]}], ",", "t"}], "]"}], "-", 
       RowBox[{"tuDPartial", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"n", ",", "t"}], "]"}]}], ",", "\[Rho]"}], "]"}]}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{"$s", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"$s", "//", 
        RowBox[{"tuDerivativeExpand", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "Cross"}], "]"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{"tuRuleSolve", "[", 
      RowBox[{"$s", ",", 
       RowBox[{"$s", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", "\"\<PON\>\""}],
    ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"$s", "//", "First"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"n", ".", "#"}]}], "&"}], "/@", "#"}], "&"}]}], "//", 
    RowBox[{"expandDot", "[", "]"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<From the tangency condition\>\"", ",", "imply", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"$p", "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//", 
       RowBox[{"tuRuleApply", "[", "$s", "]"}]}], "//", 
      RowBox[{"expandDot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tuDIndexOrder", "[", 
           RowBox[{"{", 
            RowBox[{"\[Rho]", ",", "t"}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"n", ".", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], "\[Rule]", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{
             RowBox[{"n", ".", "a"}], ",", "b"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"tuReplacePart", "[", 
      RowBox[{"$0", ",", 
       RowBox[{"{", "$p", "}"}]}], "]"}], "//", 
     RowBox[{"expandDot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tuDIndexOrder", "[", 
          RowBox[{"{", 
           RowBox[{"\[Rho]", ",", "t"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{"n", ".", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}]}], "\[Rule]", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{
            RowBox[{"n", ".", "a"}], ",", "b"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tuOpDistributeF", "[", "xIntegral", "]"}], ",", 
         RowBox[{"tuIntegralSimplify", "[", "]"}]}], "}"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "31", "]"}], "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"$", "/.", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
          RowBox[{"xIntegral", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "\[Beta]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Rho]", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{"tuDPartial", "[", 
            RowBox[{"a_", ",", "\[Rho]"}], "]"}], ",", "t_", ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]", ",", "0", ",", "1"}], "}"}]}], "]"}], "->", 
         RowBox[{"xIntegral", "[", 
          RowBox[{"a", ",", "t"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{"tuDPartial", "[", 
           RowBox[{"a_", ",", "t"}], "]"}], ",", "t_", ",", "\[Rho]_"}], 
         "]"}], "\[Rule]", "0"}]}]}]}], ";", 
    RowBox[{"$", "//", "Framed"}]}], ",", 
   RowBox[{"CG", "[", "\"\<e[31]\>\"", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.795955620713428*^9, 3.7959558747947273`*^9}, {
   3.79595655203034*^9, 3.795956753913322*^9}, {3.795956910886191*^9, 
   3.795956941189363*^9}, {3.7959571197114067`*^9, 3.795957183102406*^9}, {
   3.7959572520526457`*^9, 3.795957271809376*^9}, {3.795957455036592*^9, 
   3.795957471623184*^9}, {3.795957527524811*^9, 3.795957528098379*^9}, {
   3.795957937312347*^9, 3.795958043208571*^9}, {3.7959582658786097`*^9, 
   3.7959582797217073`*^9}, {3.79595839675744*^9, 3.795958431802479*^9}, 
   3.795958566389937*^9, {3.795958603692526*^9, 3.795958612120226*^9}, {
   3.795958685348775*^9, 3.795958785945757*^9}, {3.795958816564025*^9, 
   3.7959588865517073`*^9}, {3.7959591321474953`*^9, 
   3.7959593515563307`*^9}, {3.7959594120813437`*^9, 3.79595960931777*^9}, {
   3.795959642267919*^9, 3.795959664149218*^9}, {3.795959697993073*^9, 
   3.7959597138109407`*^9}, {3.795959997614052*^9, 3.79596000255326*^9}, {
   3.7959600707521267`*^9, 3.795960117631187*^9}, {3.7959601679658213`*^9, 
   3.7959602081841793`*^9}, {3.7959602866933737`*^9, 
   3.7959603369782124`*^9}, {3.795960401067185*^9, 3.795960487982477*^9}, {
   3.795960678203717*^9, 3.795960685408422*^9}, {3.7959607745292673`*^9, 
   3.795960798591279*^9}, {3.795960908097721*^9, 3.795960921398074*^9}, {
   3.795960952190241*^9, 3.795960956412475*^9}, {3.7959610488754673`*^9, 
   3.7959610822109118`*^9}, 3.795961119769182*^9, 3.795961158208*^9, {
   3.795961247949896*^9, 3.7959612656943283`*^9}, {3.795961318607573*^9, 
   3.7959613208702087`*^9}, {3.79597426018964*^9, 3.795974294983531*^9}, {
   3.795974337976231*^9, 3.795974389161017*^9}, {3.7959744224783487`*^9, 
   3.795974423964167*^9}, {3.795974474933751*^9, 3.7959744783570232`*^9}, 
   3.795974513262343*^9, {3.795974760563547*^9, 3.7959748008685923`*^9}, {
   3.795974858356052*^9, 3.795974918427492*^9}, {3.795974948623087*^9, 
   3.795975059226288*^9}, {3.795975105089229*^9, 3.7959751207728148`*^9}, {
   3.7959751595347843`*^9, 3.7959752302492332`*^9}, {3.795975414881855*^9, 
   3.795975688860333*^9}, {3.795975755407799*^9, 3.795975786327952*^9}, {
   3.795975841164855*^9, 3.795975841771947*^9}, {3.7959759574641953`*^9, 
   3.795976015649393*^9}, {3.795976066533463*^9, 3.795976215591127*^9}, {
   3.795976376067658*^9, 3.7959764063999367`*^9}, {3.7959764430458384`*^9, 
   3.7959765833572206`*^9}, 3.795976656315503*^9, 3.795976705951623*^9, {
   3.795976870980813*^9, 3.795977101431821*^9}, {3.795977136008367*^9, 
   3.795977389401186*^9}, {3.795977420096562*^9, 3.795977451018177*^9}, {
   3.7959774818885508`*^9, 3.795977514028179*^9}, {3.7959775929287767`*^9, 
   3.795977620758391*^9}, {3.795977788102162*^9, 3.79597779448462*^9}, {
   3.795977863050543*^9, 3.795977895432906*^9}, 3.795977935271975*^9, {
   3.79597800178603*^9, 3.795978017492407*^9}, {3.795978048439967*^9, 
   3.7959781809316683`*^9}, {3.795978325774724*^9, 3.7959784194990273`*^9}, {
   3.795978469590283*^9, 3.795978550898348*^9}, {3.7959786114391327`*^9, 
   3.795978793362928*^9}, {3.795978846681102*^9, 3.7959788485173473`*^9}, {
   3.7959792197977*^9, 3.7959792217728577`*^9}, {3.795979344835945*^9, 
   3.795979507294561*^9}, {3.795979570671796*^9, 3.795979613183515*^9}, {
   3.795979672795457*^9, 3.795979677336602*^9}, {3.795979733871442*^9, 
   3.795979905550928*^9}, {3.795979941052958*^9, 3.7959799593968563`*^9}, {
   3.7987276905157843`*^9, 
   3.79872769125494*^9}},ExpressionUUID->"53c7634f-eff2-403e-b892-\
105866dac90d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"For \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{"D", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "[", 
         StyleBox[
          RowBox[{"0", "\[LessEqual]", "t", "<", 
           RowBox[{"2", " ", "\[Pi]"}]}],
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}], ",", 
        RowBox[{"\[Rho]", "[", 
         StyleBox[
          RowBox[{"0", "<", "\[Rho]", "\[LessEqual]", "1"}],
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]}], "}"}]}], "}"}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Compute \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"d", "[", 
     SubscriptBox["W", "0"], "]"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{"d", "[", 
     TemplateBox[{FractionBox[
        RowBox[{
          RowBox[{"n", ".", 
            RowBox[{
              InterpretationBox[
               RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", "n", 
                 "]"}], 
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], SyntaxForm -> 
               Automatic, Editable -> False], "\[Cross]", 
              InterpretationBox[
               RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", "n", 
                 "]"}], 
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], SyntaxForm -> 
               Automatic, Editable -> False]}]}], " ", 
          InterpretationBox[
           SubsuperscriptBox["\[Epsilon]", 
            RowBox[{
              StyleBox["\[Mu]", ShowContents -> False, StripOnInput -> False], 
              StyleBox[
              "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
            RowBox[{"\[Mu]", "\[Nu]"}]], 
           $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], Editable -> 
           False, BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
        RowBox[{"8", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", 
         RowBox[{"{", 
           RowBox[{"t", ",", "\[Rho]"}], "}"}]}]},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         UnderscriptBox[
          StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "]"}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"d", "[", 
      RowBox[{
       RowBox[{"n", ".", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
          Editable->False,
          SyntaxForm->Automatic], "\[Cross]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic]}]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], "]"}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"n", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
            Editable->False,
            SyntaxForm->Automatic], "\[Cross]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "[", "n", "]"}], " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "n"], "[", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", 
                 "n", "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
                Editable->False,
                SyntaxForm->Automatic], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], \
$CellContext`n],
              Editable->False,
              SyntaxForm->Automatic]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "[", "n", "]"}], " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "n"], "[", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
                 "n", "]"}],
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
                Editable->False,
                SyntaxForm->Automatic], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`tuDDown[
               "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], \
$CellContext`n],
              Editable->False,
              SyntaxForm->Automatic]}], ")"}], "\[Cross]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
            Editable->False,
            SyntaxForm->Automatic]}]}], ")"}]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"d", "[", "n", "]"}], ".", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
          Editable->False,
          SyntaxForm->Automatic], "\[Cross]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic]}]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{
      RowBox[{"d", "[", "n", "]"}], " ", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "n"], "[", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "m_"], "[", "n", 
          "]"}],
         $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
          Pattern[$CellContext`m, 
           Blank[]]],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
         Pattern[$CellContext`m, 
          Blank[]]], $CellContext`n],
       Editable->False,
       SyntaxForm->Automatic]}], "\[Rule]", 
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "m"], "[", 
       RowBox[{"d", "[", "n", "]"}], "]"}],
      $CellContext`tuDDown["\[PartialD]"][
       $CellContext`d[$CellContext`n], $CellContext`m],
      Editable->False,
      SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[Implies] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"n", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
            Editable->False,
            SyntaxForm->Automatic], "\[Cross]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", 
             RowBox[{"d", "[", "n", "]"}], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`d[$CellContext`n], $CellContext`\[Nu]],
            Editable->False,
            SyntaxForm->Automatic]}], "+", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
             RowBox[{"d", "[", "n", "]"}], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`d[$CellContext`n], $CellContext`\[Mu]],
            Editable->False,
            SyntaxForm->Automatic], "\[Cross]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
            Editable->False,
            SyntaxForm->Automatic]}]}], ")"}]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"d", "[", "n", "]"}], ".", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
          Editable->False,
          SyntaxForm->Automatic], "\[Cross]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
          Editable->False,
          SyntaxForm->Automatic]}]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"\[Mu]", "\[Nu]"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"\[Mu]", "\[Nu]"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Use \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", "n", "]"}], ".", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "_"], "[", "n", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
             Blank[]],
            Editable->False,
            SyntaxForm->Automatic], "\[Cross]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "_"], "[", "n", 
             "]"}],
            $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
             Blank[]],
            Editable->False,
            SyntaxForm->Automatic]}]}], "\[Rule]", "0"}], "}"}], "[", 
       StyleBox["\<\"see comment\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dd", ":", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
           Editable->False,
           SyntaxForm->Automatic]}], ")"}], "\[Cross]", "a_"}], "\[Rule]", 
       RowBox[{"-", 
        RowBox[{"a", "\[Cross]", "dd"}]}]}], ",", 
      RowBox[{
       RowBox[{"dd", ":", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "_", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Blank[], $CellContext`\[Mu]],
          Editable->False,
          SyntaxForm->Automatic], "\[Cross]", "b_"}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"tuIndexSwap", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "[", "dd", "]"}]}]}]}], 
     "}"}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{
      RowBox[{"n", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", 
            RowBox[{"d", "[", "n", "]"}], "]"}],
           $CellContext`tuDDown["\[PartialD]"][
            $CellContext`d[$CellContext`n], $CellContext`\[Nu]],
           Editable->False,
           SyntaxForm->Automatic], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
           Editable->False,
           SyntaxForm->Automatic]}]}], ")"}]}], " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        StyleBox[
         RowBox[{"\[Mu]", "\[Nu]"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"\[Mu]", "\[Nu]"}]],
       $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"n", ".", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             RowBox[{"d", "[", "n", "]"}], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`d[$CellContext`n], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "\[Cross]", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "n",
              "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic]}]}]}], "+", 
        RowBox[{"n", ".", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
            RowBox[{"d", "[", "n", "]"}], "]"}],
           $CellContext`tuDDown["\[PartialD]"][
            $CellContext`d[$CellContext`n], $CellContext`\[Rho]],
           Editable->False,
           SyntaxForm->Automatic], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}]}]}], ")"}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Use: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"n", ".", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
         RowBox[{"d", "[", "n", "]"}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`d[$CellContext`n], $CellContext`\[Rho]],
        Editable->False,
        SyntaxForm->Automatic], "\[Cross]", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
        $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"n", ".", 
        RowBox[{
         RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
             "]"}],
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`t], \
$CellContext`\[Rho]],
          Editable->False,
          SyntaxForm->Automatic]}]}]}], "+", 
      RowBox[{"n", ".", 
       RowBox[{
        RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "n", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]],
           Editable->False,
           SyntaxForm->Automatic], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}]}], "+", 
      RowBox[{"n", ".", 
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          RowBox[{"d", "[", "n", "]"}], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`d[$CellContext`n], $CellContext`t],
         Editable->False,
         SyntaxForm->Automatic], "\[Cross]", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "n", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]],
         Editable->False,
         SyntaxForm->Automatic]}]}], "+", 
      RowBox[{"n", ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
         RowBox[{
          RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         Cross[
          $CellContext`d[$CellContext`n], 
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`t]], \
$CellContext`\[Rho]],
        Editable->False,
        SyntaxForm->Automatic]}], "-", 
      RowBox[{"n", ".", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
         RowBox[{
          RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "n", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]],
           Editable->False,
           SyntaxForm->Automatic]}], "]"}],
        $CellContext`tuDDown["\[PartialD]"][
         Cross[
          $CellContext`d[$CellContext`n], 
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]], \
$CellContext`t],
        Editable->False,
        SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"From the tangency condition\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\" \[Implies] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
          RowBox[{"n", ".", 
           RowBox[{
            RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
              "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`t],
             Editable->False,
             SyntaxForm->Automatic]}]}], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          Dot[$CellContext`n, 
           Cross[
            $CellContext`d[$CellContext`n], 
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`t]]], $CellContext`\
\[Rho]],
         Editable->False,
         SyntaxForm->Automatic], "-", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
          RowBox[{"n", ".", 
           RowBox[{
            RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              "n", "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic]}]}], "]"}],
         $CellContext`tuDDown["\[PartialD]"][
          Dot[$CellContext`n, 
           Cross[
            $CellContext`d[$CellContext`n], 
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]]], \
$CellContext`t],
         Editable->False,
         SyntaxForm->Automatic]}], ")"}]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"d", "[", 
      SubscriptBox["W", "0"], "]"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       TemplateBox[{InterpretationBox[
          RowBox[{
            SubscriptBox[
             UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
            RowBox[{"n", ".", 
              RowBox[{
                RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "n", 
                   "]"}], 
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`n, $CellContext`t], SyntaxForm -> 
                 Automatic, Editable -> False]}]}], "]"}], 
          $CellContext`tuDDown["\[PartialD]"][
           Dot[$CellContext`n, 
            Cross[
             $CellContext`d[$CellContext`n], 
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`t]]], $CellContext`\
\[Rho]], SyntaxForm -> Automatic, Editable -> False],
         RowBox[{"x", "\[Element]", 
           RowBox[{"{", 
             RowBox[{"t", ",", "\[Rho]"}], "}"}]}]},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           UnderscriptBox[
            StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       RowBox[{"4", " ", "\[Pi]"}]], "-", 
      FractionBox[
       TemplateBox[{InterpretationBox[
          RowBox[{
            SubscriptBox[
             UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", 
            RowBox[{"n", ".", 
              RowBox[{
                RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
                InterpretationBox[
                 RowBox[{
                   SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                   "n", "]"}], 
                 $CellContext`tuDDown[
                 "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]], 
                 SyntaxForm -> Automatic, Editable -> False]}]}], "]"}], 
          $CellContext`tuDDown["\[PartialD]"][
           Dot[$CellContext`n, 
            Cross[
             $CellContext`d[$CellContext`n], 
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]]], \
$CellContext`t], SyntaxForm -> Automatic, Editable -> False],
         RowBox[{"x", "\[Element]", 
           RowBox[{"{", 
             RowBox[{"t", ",", "\[Rho]"}], "}"}]}]},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           UnderscriptBox[
            StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )], 
       RowBox[{"4", " ", "\[Pi]"}]]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    FrameBox[
     RowBox[{
      RowBox[{"d", "[", 
       SubscriptBox["W", "0"], "]"}], "\[Rule]", 
      FractionBox[
       TemplateBox[{RowBox[{"n", ".", 
           RowBox[{
             RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
             InterpretationBox[
              RowBox[{
                SubscriptBox[
                 UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "n", 
                "]"}], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t], SyntaxForm -> 
              Automatic, Editable -> False]}]}],"t","0","\[Beta]"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           SubsuperscriptBox[
            StyleBox["\[Integral]", "Inactive"], #3, #4], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", 
             RowBox[{"{", 
               RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
       RowBox[{"4", " ", "\[Pi]"}]]}],
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\"e[31]\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0, 
       Rational[2, 3], 0],
     FrontFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     BackFaceColor->RGBColor[0, 
       Rational[2, 3], 0],
     GraphicsColor->RGBColor[0, 
       Rational[2, 3], 0],
     FontFamily->"Helvetica",
     FontColor->RGBColor[0, 
       Rational[2, 3], 0]]}]}],
  SequenceForm[
   Style["For ", 
    RGBColor[0.7, 0, 1, 1], Larger], {D -> {
      $CellContext`t[
       Style[
        Inequality[0, LessEqual, $CellContext`t, Less, 2 Pi], 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
      $CellContext`\[Rho][
       Style[
        Inequality[0, Less, $CellContext`\[Rho], LessEqual, 1], 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compute ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`d[
     Subscript[$CellContext`W, 0]] -> $CellContext`d[
     Inactive[Integrate][Rational[1, 8] Pi^(-1) Dot[$CellContext`n, 
        Cross[
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
      Element[$CellContext`x, {$CellContext`t, $CellContext`\[Rho]}]]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1, 3} -> $CellContext`d[Dot[$CellContext`n, 
       Cross[
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1, 3} -> Dot[$CellContext`n, Cross[
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], \
$CellContext`d[$CellContext`n] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], \
$CellContext`n]] + 
       Cross[$CellContext`d[$CellContext`n] $CellContext`tuDDown[
          "\[PartialD]"][
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], \
$CellContext`n], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] + Dot[
       $CellContext`d[$CellContext`n], 
       Cross[
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[
    0.7, 0, 1, 1]], $CellContext`d[$CellContext`n] $CellContext`tuDDown[
     "\[PartialD]"][
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
       Pattern[$CellContext`m, 
        Blank[]]], $CellContext`n] -> $CellContext`tuDDown["\[PartialD]"][
     $CellContext`d[$CellContext`n], $CellContext`m], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1, 3} -> Dot[$CellContext`n, Cross[
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`d[$CellContext`n], $CellContext`\[Nu]]] + Cross[
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`d[$CellContext`n], $CellContext`\[Mu]], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}] + Dot[
       $CellContext`d[$CellContext`n], 
       Cross[
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Use ", 
    RGBColor[0.7, 0, 1, 1], Larger], {
    {Dot[
       $CellContext`d[$CellContext`n], 
       Cross[
        $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
         Blank[]], 
        $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 
         Blank[]]]] -> 0}[
     Style["see comment", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]], Cross[
      Pattern[$CellContext`dd, 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]]], 
      Pattern[$CellContext`a, 
       Blank[]]] -> -Cross[$CellContext`a, $CellContext`dd], 
    Pattern[$CellContext`dd, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        Blank[], $CellContext`\[Mu]], 
       Pattern[$CellContext`b, 
        Blank[]]]] :> -$CellContext`tuIndexSwap[$CellContext`\[Mu], \
$CellContext`\[Nu]][$CellContext`dd]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1, 3} -> Dot[$CellContext`n, (-2) Cross[
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`d[$CellContext`n], $CellContext`\[Nu]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1, 3} -> 2 (-Dot[$CellContext`n, 
        Cross[
         $CellContext`tuDDown["\[PartialD]"][
          $CellContext`d[$CellContext`n], $CellContext`t], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]]] + 
     Dot[$CellContext`n, 
       Cross[
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`d[$CellContext`n], $CellContext`\[Rho]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`t]]]), 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Use: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Dot[$CellContext`n, 
     Cross[
      $CellContext`tuDDown["\[PartialD]"][
       $CellContext`d[$CellContext`n], $CellContext`\[Rho]], 
      $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`n, $CellContext`t]]] -> -Dot[$CellContext`n, 
       Cross[
        $CellContext`d[$CellContext`n], 
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`t], \
$CellContext`\[Rho]]]] + Dot[$CellContext`n, 
      Cross[
       $CellContext`d[$CellContext`n], 
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]], \
$CellContext`t]]] + Dot[$CellContext`n, 
      Cross[
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`d[$CellContext`n], $CellContext`t], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]]] + 
    Dot[$CellContext`n, 
      $CellContext`tuDDown["\[PartialD]"][
       Cross[
        $CellContext`d[$CellContext`n], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`t]], \
$CellContext`\[Rho]]] - Dot[$CellContext`n, 
     $CellContext`tuDDown["\[PartialD]"][
      Cross[
       $CellContext`d[$CellContext`n], 
       $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]], $CellContext`t]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["From the tangency condition", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style[" \[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1, 3} -> 
   2 ($CellContext`tuDDown["\[PartialD]"][
       Dot[$CellContext`n, 
        Cross[
         $CellContext`d[$CellContext`n], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`t]]], \
$CellContext`\[Rho]] - $CellContext`tuDDown["\[PartialD]"][
      Dot[$CellContext`n, 
       Cross[
        $CellContext`d[$CellContext`n], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]]], \
$CellContext`t]), 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`d[
     Subscript[$CellContext`W, 0]] -> 
   Rational[1, 4] Pi^(-1) Inactive[Integrate][
       $CellContext`tuDDown["\[PartialD]"][
        Dot[$CellContext`n, 
         Cross[
          $CellContext`d[$CellContext`n], 
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`t]]], $CellContext`\
\[Rho]], 
       Element[$CellContext`x, {$CellContext`t, $CellContext`\[Rho]}]] + 
    Rational[-1, 4] Pi^(-1) Inactive[Integrate][
       $CellContext`tuDDown["\[PartialD]"][
        Dot[$CellContext`n, 
         Cross[
          $CellContext`d[$CellContext`n], 
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Rho]]]], \
$CellContext`t], 
       Element[$CellContext`x, {$CellContext`t, $CellContext`\[Rho]}]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[$CellContext`d[
      Subscript[$CellContext`W, 0]] -> 
    Rational[1, 4] Pi^(-1) Inactive[Integrate][
       Dot[$CellContext`n, 
        Cross[
         $CellContext`d[$CellContext`n], 
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`n, $CellContext`t]]], {$CellContext`t, 
        0, $CellContext`\[Beta]}]], 
   Style["e[31]", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188546951561*^9, 3.80018890722348*^9, 
  3.800267849792658*^9},ExpressionUUID->"8c1ceb2b-4e6b-4c34-884c-\
faef6775ff06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"CO", "[", 
   RowBox[{
   "\"\<Exercise 5: WZ term in 0+1, definition\nAssume that we are given the \
time evolution of n[t]\[Element]\!\(\*SuperscriptBox[\(S\), \(2\)]\).  We \
also assume that time can be compactified, i.e. n[t\[Rule]\[Beta]]\[Rule]n[t\
\[Rule]0].  Consider the two-dimensional disk D which boundary \[PartialD]D \
is parametrized by time t\[Element][0,\[Beta]].  The WZ term is defined \
by\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e", "[", "67", "]"}], "=", 
     RowBox[{
      SubscriptBox["S", "WZ"], "\[Rule]", 
      RowBox[{"I", " ", "4", "\[Pi]", " ", "S", " ", 
       RowBox[{
        SubscriptBox["W", "0"], "[", "n", "]"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    "\"\<, where S is some constant, \!\(\*SubscriptBox[\(W\), \(0\)]\) is \
given by e[66], and n[x,y] is some arbitrary smooth extension of n[t] to an \
interior of D.\nLet us \
\!\(\*StyleBox[\"show\",FontWeight->\"Bold\",FontColor->RGBColor[0.6, 0.4, \
0.2]]\) that the WZ term is well defined and (almost) does not depend on the \
extension of n[t] to the interior of D.\nConsider two different extensions \!\
\(\*SuperscriptBox[\(n\), \((1)\)]\)[x,y] and \!\(\*SuperscriptBox[\(n\), \
\((2)\)]\)[x,y] of the same n[t] and corresponding values \
\!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \((1)\)]\) and \
\!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \((2)\)]\) of the functional \
\!\(\*SubscriptBox[\(W\), \(0\)]\).  \
\!\(\*StyleBox[\"Show\",FontWeight->\"Bold\",FontColor->RGBColor[0.6, 0.4, \
0.2]]\) that difference \!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \
\((1)\)]\)-\!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \((2)\)]\) is an \
integer number--the degree Q of mapping \!\(\*SuperscriptBox[\(S\), \(2\)]\)\
\[LongRightArrow]\!\(\*SuperscriptBox[\(S\), \(2\)]\). The second \
\!\(\*SuperscriptBox[\(S\), \(2\)]\) here is a target space of n.  How did \
the first \!\(\*SuperscriptBox[\(S\), \(2\)]\) appear?\nWe see that \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\)[n[t]] ]is a multi-valued functional which \
depends on the extension of n to the disk D.  However, the weight in \
partition function is given by Exp[-\!\(\*SubscriptBox[\(S\), \(WZ\)]\)] and \
can be make single-valued functional if the coupling constant S is \
'quantized'.  Namely if 2S\[Element]\[DoubleStruckCapitalZ] [S is half \
integer] and Exp[-\!\(\*SubscriptBox[\(S\), \(WS\)]\)] is a well-defined \
single-valued functional.\>\""}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7942399402964497`*^9, 3.794240150207424*^9}, {
   3.794240201102532*^9, 3.794240755332007*^9}, 3.794241351504327*^9, {
   3.7943156541441298`*^9, 3.794315664678718*^9}, {3.794315717382111*^9, 
   3.794315739452598*^9}, {3.7944183975557327`*^9, 3.7944184025443783`*^9}, {
   3.794509613469092*^9, 3.794509614208531*^9}, {3.794929999058572*^9, 
   3.7949303221541777`*^9}, {3.794930357060975*^9, 3.794930380281633*^9}, {
   3.79493041047946*^9, 3.7949308540107403`*^9}, 3.795010871387545*^9, 
   3.7950881044611673`*^9, {3.795271938815732*^9, 3.7952719417739353`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2561f7d8-d921-4daf-a413-8a56a7f74a5d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 5: WZ term in 0+1, definition\\nAssume that we are \
given the time evolution of n[t]\[Element]\\!\\(\\*SuperscriptBox[\\(S\\), \
\\(2\\)]\\).  We also assume that time can be compactified, i.e. n[t\[Rule]\
\[Beta]]\[Rule]n[t\[Rule]0].  Consider the two-dimensional disk D which \
boundary \[PartialD]D is parametrized by time t\[Element][0,\[Beta]].  The WZ \
term is defined by\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     SubscriptBox["S", "WZ"], "\[Rule]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "S", " ", 
      RowBox[{
       SubscriptBox["W", "0"], "[", "n", "]"}]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\", where S is some constant, \\!\\(\\*SubscriptBox[\\(W\\), \
\\(0\\)]\\) is given by e[66], and n[x,y] is some arbitrary smooth extension \
of n[t] to an interior of D.\\nLet us \
\\!\\(\\*StyleBox[\\\"show\\\",FontWeight->\\\"Bold\\\",FontColor->RGBColor[0.\
6, 0.4, 0.2]]\\) that the WZ term is well defined and (almost) does not \
depend on the extension of n[t] to the interior of D.\\nConsider two \
different extensions \\!\\(\\*SuperscriptBox[\\(n\\), \\((1)\\)]\\)[x,y] and \
\\!\\(\\*SuperscriptBox[\\(n\\), \\((2)\\)]\\)[x,y] of the same n[t] and \
corresponding values \\!\\(\\*SuperscriptBox[SubscriptBox[\\(W\\), \\(0\\)], \
\\((1)\\)]\\) and \\!\\(\\*SuperscriptBox[SubscriptBox[\\(W\\), \\(0\\)], \
\\((2)\\)]\\) of the functional \\!\\(\\*SubscriptBox[\\(W\\), \\(0\\)]\\).  \
\\!\\(\\*StyleBox[\\\"Show\\\",FontWeight->\\\"Bold\\\",FontColor->RGBColor[0.\
6, 0.4, 0.2]]\\) that difference \
\\!\\(\\*SuperscriptBox[SubscriptBox[\\(W\\), \\(0\\)], \
\\((1)\\)]\\)-\\!\\(\\*SuperscriptBox[SubscriptBox[\\(W\\), \\(0\\)], \
\\((2)\\)]\\) is an integer number--the degree Q of mapping \
\\!\\(\\*SuperscriptBox[\\(S\\), \
\\(2\\)]\\)\[LongRightArrow]\\!\\(\\*SuperscriptBox[\\(S\\), \\(2\\)]\\). The \
second \\!\\(\\*SuperscriptBox[\\(S\\), \\(2\\)]\\) here is a target space of \
n.  How did the first \\!\\(\\*SuperscriptBox[\\(S\\), \\(2\\)]\\) \
appear?\\nWe see that \\!\\(\\*SubscriptBox[\\(S\\), \\(WZ\\)]\\)[n[t]] ]is a \
multi-valued functional which depends on the extension of n to the disk D.  \
However, the weight in partition function is given by \
Exp[-\\!\\(\\*SubscriptBox[\\(S\\), \\(WZ\\)]\\)] and can be make \
single-valued functional if the coupling constant S is 'quantized'.  Namely \
if 2S\[Element]\[DoubleStruckCapitalZ] [S is half integer] and \
Exp[-\\!\\(\\*SubscriptBox[\\(S\\), \\(WS\\)]\\)] is a well-defined \
single-valued functional.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 5: WZ term in 0+1, definition\nAssume that we are given \
the time evolution of n[t]\[Element]\!\(\*SuperscriptBox[\(S\), \(2\)]\).  We \
also assume that time can be compactified, i.e. n[t\[Rule]\[Beta]]\[Rule]n[t\
\[Rule]0].  Consider the two-dimensional disk D which boundary \[PartialD]D \
is parametrized by time t\[Element][0,\[Beta]].  The WZ term is defined by", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Subscript[$CellContext`S, $CellContext`WZ] -> 
    Complex[0, 4] Pi $CellContext`S 
     Subscript[$CellContext`W, 0][$CellContext`n], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[", where S is some constant, \!\(\*SubscriptBox[\(W\), \(0\)]\) is \
given by e[66], and n[x,y] is some arbitrary smooth extension of n[t] to an \
interior of D.\nLet us \
\!\(\*StyleBox[\"show\",FontWeight->\"Bold\",FontColor->RGBColor[0.6, 0.4, \
0.2]]\) that the WZ term is well defined and (almost) does not depend on the \
extension of n[t] to the interior of D.\nConsider two different extensions \!\
\(\*SuperscriptBox[\(n\), \((1)\)]\)[x,y] and \!\(\*SuperscriptBox[\(n\), \
\((2)\)]\)[x,y] of the same n[t] and corresponding values \
\!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \((1)\)]\) and \
\!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \((2)\)]\) of the functional \
\!\(\*SubscriptBox[\(W\), \(0\)]\).  \
\!\(\*StyleBox[\"Show\",FontWeight->\"Bold\",FontColor->RGBColor[0.6, 0.4, \
0.2]]\) that difference \!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \
\((1)\)]\)-\!\(\*SuperscriptBox[SubscriptBox[\(W\), \(0\)], \((2)\)]\) is an \
integer number--the degree Q of mapping \!\(\*SuperscriptBox[\(S\), \(2\)]\)\
\[LongRightArrow]\!\(\*SuperscriptBox[\(S\), \(2\)]\). The second \
\!\(\*SuperscriptBox[\(S\), \(2\)]\) here is a target space of n.  How did \
the first \!\(\*SuperscriptBox[\(S\), \(2\)]\) appear?\nWe see that \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\)[n[t]] ]is a multi-valued functional which \
depends on the extension of n to the disk D.  However, the weight in \
partition function is given by Exp[-\!\(\*SubscriptBox[\(S\), \(WZ\)]\)] and \
can be make single-valued functional if the coupling constant S is \
'quantized'.  Namely if 2S\[Element]\[DoubleStruckCapitalZ] [S is half \
integer] and Exp[-\!\(\*SubscriptBox[\(S\), \(WS\)]\)] is a well-defined \
single-valued functional.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188547090684*^9, 3.800188907368431*^9, 
  3.800267849919479*^9},ExpressionUUID->"c0b832d9-137c-4ee2-9c7d-\
6dae82db1999"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PR", "[", 
  RowBox[{"\"\<from e[66]: \>\"", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"e", "[", "66", "]"}], "//", "tuRule"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$0", "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//", 
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{
         SubscriptBox["W", "0"], ",", 
         RowBox[{"{", 
          RowBox[{"T", "[", 
           RowBox[{"n", ",", "\"\<d\>\"", ",", 
            RowBox[{"{", "_", "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "//", "tuRule1"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The integrand \>\"", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$", "//", "tuExtractIntegrand"}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<let \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"n", ",", "\"\<d\>\"", ",", 
        RowBox[{"{", "i_", "}"}]}], "]"}], "->", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"n", ",", "\"\<d\>\"", ",", 
         RowBox[{"{", "i", "}"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"t", "[", 
         RowBox[{"CG", "[", "\"\<\[Element][0,\[Beta]]\>\"", "]"}], "]"}], 
        ",", 
        RowBox[{"r", "[", 
         RowBox[{"CG", "[", 
          RowBox[{"\"\<radial parameterization\>\"", ",", 
           RowBox[{
            RowBox[{"r", "[", "t", "]"}], "\[Rule]", 
            RowBox[{"r", "[", 
             RowBox[{"t", "+", "\[Beta]"}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$tmp", "=", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{"tuRule", "[", "$s", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//", 
       RowBox[{"tuDifFormWedgeSimplify", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"n", ",", "\"\<d\>\"", ",", 
             RowBox[{"{", "_", "}"}]}], "]"}], "[", 
           RowBox[{"_", ",", "_"}], "]"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "//", 
      RowBox[{"tuD2tuDOp", "[", "tuDPartial", "]"}]}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", 
   RowBox[{
    RowBox[{"$pass", "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"$", "//", 
         RowBox[{"tuWedgeSimplify", "[", 
          RowBox[{"{", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"_", ",", "_"}], "]"}], "}"}], "]"}]}], "//", 
        RowBox[{"tuOpSimplifyF", "[", 
         RowBox[{"dotOps", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tuDPartial", "[", 
             RowBox[{"_", ",", "_"}], "]"}], ",", 
            RowBox[{
             RowBox[{"XT", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "_", "}"}]}], "]"}], "[", 
             RowBox[{"_", ",", "_"}], "]"}]}], "}"}]}], "]"}]}], "//", 
       "Simplify"}]}]}], ";", 
    RowBox[{"$", "//", "ColumnSumExp"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\n", 
 RowBox[{"PR", "[", 
  RowBox[{
  "\"\<Identify the integrand with terms in Stokes Theorem \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"$pass", "//", 
           RowBox[{"tuExtractPattern", "[", 
            RowBox[{"_", "\[CenterDot]", 
             RowBox[{"Wedge", "[", "__", "]"}]}], "]"}]}], "//", "Sort"}], 
         ")"}], "[", 
        RowBox[{"CG", "[", "\"\<dA projected in i-th direction\>\"", "]"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"$pass", "//", 
           RowBox[{"tuExtractPattern", "[", 
            RowBox[{"a_", "+", "b_"}], "]"}]}], "//", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", ";;", "3"}]}], "]"}], "&"}]}], ")"}], "[", 
        RowBox[{"CG", "[", "\"\<\[Del]\[Cross]n terms\>\"", "]"}], "]"}]}], 
      "}"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{
    RowBox[{"$0", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"xIntegral", "[", 
      RowBox[{
       RowBox[{"\"\<\[Del]\[Cross]n\>\"", "\[CenterDot]", "A"}], ",", "D"}], 
      "]"}], "\[Rule]", 
     RowBox[{"xIntegral", "[", 
      RowBox[{
       RowBox[{"n", "\[CenterDot]", 
        RowBox[{"l", "[", 
         RowBox[{"CG", "[", "\"\<A vector parallel to boundary\>\"", "]"}], 
         "]"}]}], ",", "\"\<\[PartialD]D\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", ",", "NL", ",", 
   RowBox[{"CR", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"n", ",", "\"\<d\>\"", ",", 
         RowBox[{"{", "i", "}"}]}], "]"}], "[", 
       RowBox[{"r", ",", "\[Theta]", ",", "t"}], "]"}], "}"}], ",", 
     "\"\< may be more accurate since originally \>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"n", ",", "\"\<d\>\"", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}], "\[Element]", 
        SuperscriptBox["S", "2"]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"n", ",", "\"\<d\>\"", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], "[", 
         RowBox[{"x", ",", "y"}], "]"}], "->", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"n", ",", "\"\<d\>\"", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7950092991334457`*^9, 3.795009302746464*^9}, {
   3.795010321942575*^9, 3.795010324277294*^9}, {3.795010386706019*^9, 
   3.795010389412328*^9}, {3.795010511084256*^9, 3.7950105353586693`*^9}, {
   3.795012100799055*^9, 3.795012103632512*^9}, {3.795012266522167*^9, 
   3.795012386739876*^9}, {3.795012426317997*^9, 3.79501243978794*^9}, {
   3.7950125873012943`*^9, 3.795012590738378*^9}, {3.7950127075993767`*^9, 
   3.7950127964502687`*^9}, {3.7950128546403627`*^9, 3.795012947874899*^9}, {
   3.795013032222143*^9, 3.7950131557168207`*^9}, {3.795013196378558*^9, 
   3.795013200863628*^9}, {3.795013304525525*^9, 3.795013310768165*^9}, {
   3.795013922097588*^9, 3.7950139503401814`*^9}, {3.795013998099002*^9, 
   3.795014003319644*^9}, {3.79501404142775*^9, 3.7950140883041077`*^9}, {
   3.7950888066470947`*^9, 3.7950888077302513`*^9}, {3.79508885720586*^9, 
   3.7950888939900503`*^9}, {3.7950889298345013`*^9, 3.795088977668003*^9}, {
   3.795089033953109*^9, 3.7950890551438828`*^9}, {3.79508910194086*^9, 
   3.795089128260098*^9}, {3.795089175040214*^9, 3.795089176901149*^9}, {
   3.795089214436925*^9, 3.795089222548799*^9}, 3.7950902721712847`*^9, 
   3.795090315513536*^9, 3.7950927844226294`*^9, {3.795092909331321*^9, 
   3.79509298113249*^9}, 3.795093848071327*^9, {3.795094585698511*^9, 
   3.795094590346155*^9}, 3.795094654425791*^9, 3.795095470522314*^9, {
   3.7950955044841013`*^9, 3.7950955109919777`*^9}, {3.7958863876669083`*^9, 
   3.79588639550276*^9}, 
   3.796042747781983*^9},ExpressionUUID->"10d85454-025a-4fa3-ae03-\
916788b6f56e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"from e[66]: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{
         SubscriptBox["W", "0"], "\[Rule]", 
         TemplateBox[{FractionBox[
            RowBox[{
              RowBox[{"n", ".", 
                RowBox[{
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", 
                    "n", "]"}], 
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
                   SyntaxForm -> Automatic, Editable -> False], "\[Cross]", 
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", 
                    "n", "]"}], 
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], 
                   SyntaxForm -> Automatic, Editable -> False]}]}], " ", 
              InterpretationBox[
               SubsuperscriptBox["\[Epsilon]", 
                RowBox[{
                  StyleBox[
                  "\[Mu]", ShowContents -> False, StripOnInput -> False], 
                  StyleBox[
                  "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
                RowBox[{"\[Mu]", "\[Nu]"}]], 
               $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\
\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], Editable -> 
               False, BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
            RowBox[{"8", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", "D"}]},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             UnderscriptBox[
              StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]},
       {
        RowBox[{
         SubscriptBox["W", "0"], "\[Rule]", 
         TemplateBox[{RowBox[{"Tr", "[", 
             RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                  OverscriptBox["n", "^"], " ", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    OverscriptBox["n", "^"], "]"}], 
                    $CellContext`difForm[
                    OverHat[$CellContext`n]], SyntaxForm -> Automatic, 
                    Editable -> False], "\[Wedge]", 
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    OverscriptBox["n", "^"], "]"}], 
                    $CellContext`difForm[
                    OverHat[$CellContext`n]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], 
                RowBox[{"16", " ", "\[Pi]"}]]}], "]"}],"D"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]},
       {
        RowBox[{
         OverscriptBox["n", "^"], "\[Rule]", 
         RowBox[{"n", "\[CenterDot]", "\[Sigma]"}]}]},
       {
        RowBox[{
         SubscriptBox["W", "0"], "\[Rule]", 
         TemplateBox[{RowBox[{"(", 
             RowBox[{
               FractionBox[
                RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  "\[CenterDot]", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`difForm[
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}]], SyntaxForm -> Automatic, Editable -> False], 
                    "\[Wedge]", 
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`difForm[
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
                RowBox[{"4", " ", "\[Pi]"}]], "-", 
               FractionBox[
                RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  "\[CenterDot]", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`difForm[
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}]], SyntaxForm -> Automatic, Editable -> False], 
                    "\[Wedge]", 
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`difForm[
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
                RowBox[{"4", " ", "\[Pi]"}]], "+", 
               FractionBox[
                RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                  "\[CenterDot]", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`difForm[
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}]], SyntaxForm -> Automatic, Editable -> False], 
                    "\[Wedge]", 
                    InterpretationBox[
                    RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                    
                    $CellContext`difForm[
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
                RowBox[{"4", " ", "\[Pi]"}]]}], ")"}],"D"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]},
       {
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          SubscriptBox["W", "0"], "]"}], "\[Rule]", 
         TemplateBox[{FractionBox[
            RowBox[{"3", " ", 
              RowBox[{
                InterpretationBox[
                 RowBox[{
                   UnderscriptBox["d", "_"], "[", 
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                   "]"}], 
                 $CellContext`difForm[
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}]], SyntaxForm -> Automatic, Editable -> False], 
                "\[Wedge]", 
                InterpretationBox[
                 RowBox[{
                   UnderscriptBox["d", "_"], "[", 
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                   "]"}], 
                 $CellContext`difForm[
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}]], SyntaxForm -> Automatic, Editable -> False], 
                "\[Wedge]", 
                InterpretationBox[
                 RowBox[{
                   UnderscriptBox["d", "_"], "[", 
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                   "]"}], 
                 $CellContext`difForm[
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
            RowBox[{"4", " ", "\[Pi]"}]],"D"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    SubscriptBox["W", "0"]}], "\[Rule]", 
   RowBox[{
    TemplateBox[{RowBox[{"(", 
        RowBox[{
          FractionBox[
           RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", 
               RowBox[{"1"}], 
               RowBox[{
                 StyleBox[
                 "1", ShowContents -> False, StripOnInput -> False]}]], 
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
              Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}], 
             "\[CenterDot]", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}]], SyntaxForm -> Automatic, Editable -> False], 
               "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
           RowBox[{"4", " ", "\[Pi]"}]], "-", 
          FractionBox[
           RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", 
               RowBox[{"2"}], 
               RowBox[{
                 StyleBox[
                 "2", ShowContents -> False, StripOnInput -> False]}]], 
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
              Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}], 
             "\[CenterDot]", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}]], SyntaxForm -> Automatic, Editable -> False], 
               "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
           RowBox[{"4", " ", "\[Pi]"}]], "+", 
          FractionBox[
           RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", 
               RowBox[{"3"}], 
               RowBox[{
                 StyleBox[
                 "3", ShowContents -> False, StripOnInput -> False]}]], 
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
              Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}], 
             "\[CenterDot]", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}]], SyntaxForm -> Automatic, Editable -> False], 
               "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
           RowBox[{"4", " ", "\[Pi]"}]]}], ")"}],"D"},
     "InactiveIntegrate",
     DisplayFunction->(RowBox[{
        StyleBox["\[Integral]", "Inactive"], 
        RowBox[{#, 
          RowBox[{
            StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
     InterpretationFunction->(RowBox[{
        RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"The integrand \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "-", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "+", 
      FractionBox[
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"let \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", "i_", 
        StyleBox["i_",
         StripOnInput->False,
         ShowContents->False]],
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         Pattern[$CellContext`i, 
          Blank[]]}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        SubsuperscriptBox["n", "i", 
         StyleBox["i",
          StripOnInput->False,
          ShowContents->False]],
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], "[", 
       RowBox[{
        RowBox[{"t", "[", 
         StyleBox["\<\"\[Element][0,\[Beta]]\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}], ",", 
        RowBox[{"r", "[", 
         RowBox[{
          StyleBox["\<\"radial parameterization\"\>",
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]], ",", 
          StyleBox[
           RowBox[{
            RowBox[{"r", "[", "t", "]"}], "\[Rule]", 
            RowBox[{"r", "[", 
             RowBox[{"t", "+", "\[Beta]"}], "]"}]}],
           StripOnInput->False,
           LineColor->RGBColor[0, 
             Rational[2, 3], 0],
           FrontFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           BackFaceColor->RGBColor[0, 
             Rational[2, 3], 0],
           GraphicsColor->RGBColor[0, 
             Rational[2, 3], 0],
           FontFamily->"Helvetica",
           FontColor->RGBColor[0, 
             Rational[2, 3], 0]]}], "]"}]}], "]"}]}], "}"}], 
    "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", "2", 
              StyleBox["2",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "[", 
            RowBox[{"t", ",", "r"}], "]"}], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}][$CellContext`t, $CellContext`r]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", "3", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "[", 
            RowBox[{"t", ",", "r"}], "]"}], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}][$CellContext`t, $CellContext`r]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", "1", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "[", 
            RowBox[{"t", ",", "r"}], "]"}], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}][$CellContext`t, $CellContext`r]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", "3", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "[", 
            RowBox[{"t", ",", "r"}], "]"}], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}][$CellContext`t, $CellContext`r]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "[", 
         RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", "1", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "[", 
            RowBox[{"t", ",", "r"}], "]"}], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}][$CellContext`t, $CellContext`r]],
          Editable->False,
          SyntaxForm->Automatic], "\[Wedge]", 
         InterpretationBox[
          RowBox[{
           UnderscriptBox["d", "_"], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["n", "2", 
              StyleBox["2",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "[", 
            RowBox[{"t", ",", "r"}], "]"}], "]"}],
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}][$CellContext`t, $CellContext`r]],
          Editable->False,
          SyntaxForm->Automatic]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]]}]}], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[RightArrow] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       StyleBox["\<\"\[Sum]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "[", 
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "[", 
              RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                UnderscriptBox["d", "_"], "[", "r", "]"}],
               $CellContext`difForm[$CellContext`r],
               Editable->False,
               SyntaxForm->Automatic], "\[Wedge]", 
              InterpretationBox[
               RowBox[{
                UnderscriptBox["d", "_"], "[", "t", "]"}],
               $CellContext`difForm[$CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                  RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "[", 
                   RowBox[{"t", ",", "r"}], "]"}], "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}][$CellContext`t, $CellContext`r], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic]}], "+", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}], ")"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "[", 
              RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                UnderscriptBox["d", "_"], "[", "r", "]"}],
               $CellContext`difForm[$CellContext`r],
               Editable->False,
               SyntaxForm->Automatic], "\[Wedge]", 
              InterpretationBox[
               RowBox[{
                UnderscriptBox["d", "_"], "[", "t", "]"}],
               $CellContext`difForm[$CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic]}], "-", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}], ")"}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "[", 
              RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                UnderscriptBox["d", "_"], "[", "r", "]"}],
               $CellContext`difForm[$CellContext`r],
               Editable->False,
               SyntaxForm->Automatic], "\[Wedge]", 
              InterpretationBox[
               RowBox[{
                UnderscriptBox["d", "_"], "[", "t", "]"}],
               $CellContext`difForm[$CellContext`t],
               Editable->False,
               SyntaxForm->Automatic]}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                  RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "[", 
                   RowBox[{"t", ",", "r"}], "]"}], "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}][$CellContext`t, $CellContext`r], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic]}], "+", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}], ")"}]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "]"}], 
      RowBox[{"4", " ", "\[Pi]"}]]}]}]}],
  SequenceForm[
   Style["from e[66]: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
     Subscript[$CellContext`W, 0] -> 
      Inactive[Integrate][Rational[1, 8] Pi^(-1) Dot[$CellContext`n, 
          Cross[
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
        Element[$CellContext`x, D]]}, {
     Subscript[$CellContext`W, 0] -> Inactive[Integrate][
        Tr[Complex[0, 
           Rational[-1, 16]] Pi^(-1) OverHat[$CellContext`n] Wedge[
           $CellContext`difForm[
            OverHat[$CellContext`n]], 
           $CellContext`difForm[
            OverHat[$CellContext`n]]]], D]}, {
     OverHat[$CellContext`n] -> 
      CenterDot[$CellContext`n, $CellContext`\[Sigma]]}, {
     Subscript[$CellContext`W, 0] -> 
      Inactive[Integrate][Rational[1, 4] Pi^(-1) CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
           Wedge[
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
        Rational[-1, 4] Pi^(-1) CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
           Wedge[
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
        Rational[1, 4] Pi^(-1) CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
           Wedge[
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]],
         D]}, {$CellContext`\[Delta][
        Subscript[$CellContext`W, 0]] -> 
      Inactive[Integrate][Rational[3, 4] Pi^(-1) Wedge[
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]], 
        D]}}, Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`W, 0] -> 
   Inactive[Integrate][Rational[1, 4] Pi^(-1) CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
     Rational[-1, 4] Pi^(-1) CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
     Rational[1, 4] Pi^(-1) CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]], 
     D], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The integrand ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1} -> Rational[1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
    Rational[-1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]] + 
    Rational[1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["let ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], {$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
       Pattern[$CellContext`i, 
        Blank[]]}] -> $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {$CellContext`i}][
      $CellContext`t[
       Style["\[Element][0,\[Beta]]", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
      $CellContext`r[
       Style["radial parameterization", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"], 
       Style[$CellContext`r[$CellContext`t] -> $CellContext`r[$CellContext`t + \
$CellContext`\[Beta]], 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1} -> Rational[1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        1}][$CellContext`t, $CellContext`r], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}][$CellContext`t, $CellContext`r]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}][$CellContext`t, $CellContext`r]]]] + 
    Rational[-1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}][$CellContext`t, $CellContext`r], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}][$CellContext`t, $CellContext`r]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}][$CellContext`t, $CellContext`r]]]] + 
    Rational[1, 4] Pi^(-1) CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}][$CellContext`t, $CellContext`r], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}][$CellContext`t, $CellContext`r]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}][$CellContext`t, $CellContext`r]]]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 1} -> 
   Rational[1, 4] Pi^(-1) Style["\[Sum]", 
      RGBColor[0.7, 0, 1, 1]][
      Grid[{{CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}][$CellContext`t, $CellContext`r], 
           Wedge[
            $CellContext`difForm[$CellContext`r], 
            $CellContext`difForm[$CellContext`t]]] (-$CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}][$CellContext`t, $CellContext`r], $CellContext`t] \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}][$CellContext`t, $CellContext`r], $CellContext`r] + \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}][$CellContext`t, $CellContext`r], $CellContext`r] \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}][$CellContext`t, $CellContext`r], $CellContext`t])}, {
        CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}][$CellContext`t, $CellContext`r], 
           Wedge[
            $CellContext`difForm[$CellContext`r], 
            $CellContext`difForm[$CellContext`t]]] ($CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}][$CellContext`t, $CellContext`r], $CellContext`t] \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}][$CellContext`t, $CellContext`r], $CellContext`r] - \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}][$CellContext`t, $CellContext`r], $CellContext`r] \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}][$CellContext`t, $CellContext`r], $CellContext`t])}, {
        CenterDot[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}][$CellContext`t, $CellContext`r], 
           Wedge[
            $CellContext`difForm[$CellContext`r], 
            $CellContext`difForm[$CellContext`t]]] (-$CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}][$CellContext`t, $CellContext`r], $CellContext`t] \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}][$CellContext`t, $CellContext`r], $CellContext`r] + \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}][$CellContext`t, $CellContext`r], $CellContext`r] \
$CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}][$CellContext`t, $CellContext`r], $CellContext`t])}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188547712984*^9, 3.800188907993342*^9, 
  3.8002678505758677`*^9},ExpressionUUID->"d5cee5e3-e366-4f78-99b1-\
6ae57c863896"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"Identify the integrand with terms in Stokes Theorem \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{
         TagBox[GridBox[{
            {
             RowBox[{
              RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", "1", 
                 StyleBox["1",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "[", 
               RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 UnderscriptBox["d", "_"], "[", "r", "]"}],
                $CellContext`difForm[$CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                 UnderscriptBox["d", "_"], "[", "t", "]"}],
                $CellContext`difForm[$CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]},
            {
             RowBox[{
              RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", "2", 
                 StyleBox["2",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "[", 
               RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 UnderscriptBox["d", "_"], "[", "r", "]"}],
                $CellContext`difForm[$CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                 UnderscriptBox["d", "_"], "[", "t", "]"}],
                $CellContext`difForm[$CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]},
            {
             RowBox[{
              RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", "3", 
                 StyleBox["3",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "[", 
               RowBox[{"t", ",", "r"}], "]"}], "\[CenterDot]", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 UnderscriptBox["d", "_"], "[", "r", "]"}],
                $CellContext`difForm[$CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                 UnderscriptBox["d", "_"], "[", "t", "]"}],
                $CellContext`difForm[$CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]}
           },
           AutoDelete->False,
           FrameStyle->Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"], "[", 
         StyleBox["\<\"dA projected in i-th direction\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]},
       {
        RowBox[{
         TagBox[GridBox[{
            {
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                  RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "[", 
                   RowBox[{"t", ",", "r"}], "]"}], "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}][$CellContext`t, $CellContext`r], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic]}], "+", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]},
            {
             RowBox[{
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic]}], "-", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "1", 
                    StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                  RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                    BaseStyle->{AutoMultiplicationSymbol -> False},
                    Editable->False], "[", 
                   RowBox[{"t", ",", "r"}], "]"}], "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}][$CellContext`t, $CellContext`r], $CellContext`t],
                 Editable->False,
                 SyntaxForm->Automatic]}], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic]}], "+", 
              RowBox[{
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "r"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "2", 
                    StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}][$CellContext`t, $CellContext`r], $CellContext`r],
                Editable->False,
                SyntaxForm->Automatic], " ", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
                 RowBox[{
                  InterpretationBox[
                   SubsuperscriptBox["n", "3", 
                    StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False]],
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}],
                   BaseStyle->{AutoMultiplicationSymbol -> False},
                   Editable->False], "[", 
                  RowBox[{"t", ",", "r"}], "]"}], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}][$CellContext`t, $CellContext`r], $CellContext`t],
                Editable->False,
                SyntaxForm->Automatic]}]}]}
           },
           AutoDelete->False,
           FrameStyle->Directive[
             RGBColor[0.7, 0, 1, 1], 
             Thickness[Tiny]],
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
          "Grid"], "[", 
         StyleBox["\<\"\[Del]\[Cross]n terms\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\[Implies] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontWeight->Bold,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    SubscriptBox["W", "0"]}], "\[Rule]", 
   RowBox[{
    TemplateBox[{RowBox[{"\"\[Del]\[Cross]n\"", "\[CenterDot]", "A"}],"D"},
     "InactiveIntegrate",
     DisplayFunction->(RowBox[{
        StyleBox["\[Integral]", "Inactive"], 
        RowBox[{#, 
          RowBox[{
            StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
     InterpretationFunction->(RowBox[{
        RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
        RowBox[{#, ",", #2}], "]"}]& )], "\[Rule]", 
    RowBox[{
     TemplateBox[{RowBox[{"n", "\[CenterDot]", 
         RowBox[{"l", "[", 
           StyleBox["\"A vector parallel to boundary\"", 
            RGBColor[0, 
             Rational[2, 3], 0], FontFamily -> "Helvetica", StripOnInput -> 
            False], "]"}]}],"\"\[PartialD]D\""},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "i", 
          StyleBox["i",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "[", 
        RowBox[{"r", ",", "\[Theta]", ",", "t"}], "]"}], "}"}],
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
     StyleBox["\<\" may be more accurate since originally \"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "i", 
           StyleBox["i",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Element]", 
         SuperscriptBox["S", "2"]}], ",", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["n", "i", 
            StyleBox["i",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], "[", 
          RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["n", "i", 
            StyleBox["i",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "}"}],
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[1, 0, 0]]}]}]}],
  SequenceForm[
   Style["Identify the integrand with terms in Stokes Theorem ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
      Grid[{{
         CenterDot[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}][$CellContext`t, $CellContext`r], 
          Wedge[
           $CellContext`difForm[$CellContext`r], 
           $CellContext`difForm[$CellContext`t]]]}, {
         CenterDot[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}][$CellContext`t, $CellContext`r], 
          Wedge[
           $CellContext`difForm[$CellContext`r], 
           $CellContext`difForm[$CellContext`t]]]}, {
         CenterDot[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}][$CellContext`t, $CellContext`r], 
          Wedge[
           $CellContext`difForm[$CellContext`r], 
           $CellContext`difForm[$CellContext`t]]]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["dA projected in i-th direction", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
      Grid[{{-$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}][$CellContext`t, $CellContext`r], $CellContext`t] \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}][$CellContext`t, $CellContext`r], $CellContext`r] + \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}][$CellContext`t, $CellContext`r], $CellContext`r] \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}][$CellContext`t, $CellContext`r], $CellContext`t]}, \
{$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}][$CellContext`t, $CellContext`r], $CellContext`t] \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}][$CellContext`t, $CellContext`r], $CellContext`r] - \
$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}][$CellContext`t, $CellContext`r], $CellContext`r] \
$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}][$CellContext`t, $CellContext`r], $CellContext`t]}, \
{-$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}][$CellContext`t, $CellContext`r], $CellContext`t] \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}][$CellContext`t, $CellContext`r], $CellContext`r] + \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}][$CellContext`t, $CellContext`r], $CellContext`r] \
$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}][$CellContext`t, $CellContext`r], $CellContext`t]}}, 
       Dividers -> {{True}, {False}}, FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left][
       Style["\[Del]\[Cross]n terms", 
        RGBColor[0, 
         Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`W, 0] -> (Inactive[Integrate][
      CenterDot["\[Del]\[Cross]n", $CellContext`A], D] -> 
    Inactive[Integrate][
      CenterDot[$CellContext`n, 
       $CellContext`l[
        Style["A vector parallel to boundary", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]]], "\[PartialD]D"]), 
   
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style[{
     $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}][$CellContext`r, $CellContext`\[Theta], $CellContext`t]}, 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[" may be more accurate since originally ", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style[{
     Element[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}], $CellContext`S^2], $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {$CellContext`i}][$CellContext`x, $CellContext`y] -> \
$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, \
{$CellContext`i}][$CellContext`r, $CellContext`\[Theta]]}, 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188547712984*^9, 3.800188907993342*^9, 
  3.800267850616048*^9},ExpressionUUID->"cde582eb-1c25-4d53-a142-\
79a04224ddd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"CO", "[", 
    RowBox[{
    "\"\<Exercise 6: W in 0+1, spin precession.\nLet us consider the \
quantum-mechanical action of the unit vector n[t] with the (Euclidean) action\
\>\"", ",", 
     RowBox[{
      RowBox[{"e", "[", "68", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["S", "h"], "\[Rule]", 
         RowBox[{
          RowBox[{
           SubscriptBox["S", "WZ"], "[", 
           RowBox[{"n", "[", "t", "]"}], "]"}], "-", 
          RowBox[{"S", " ", 
           RowBox[{"xIntegral", "[", 
            RowBox[{
             RowBox[{"h", "\[CenterDot]", 
              RowBox[{"n", "[", "t", "]"}]}], ",", "t"}], "]"}]}]}]}], ",", 
        " ", 
        RowBox[{
         SubscriptBox["S", "WZ"], "[", 
         RowBox[{"CG", "[", "\"\<e[67]\>\"", "]"}], "]"}], ",", 
        RowBox[{"h", "[", 
         RowBox[{
         "CG", "[", 
          "\"\<some constant 3-component vector(magnetic field)\>\"", "]"}], 
         "]"}]}], "}"}]}], ",", 
     "\"\<. \n\!\(\*StyleBox[\"Find\",FontSize->14]\) the classical equation \
of motion of n[t] from the variational principle \>\"", ",", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       SubscriptBox["S", "h"], "]"}], "->", "0"}], ",", 
     "\"\<. Remember that one has a constraint \>\"", ",", 
     RowBox[{
      RowBox[{"n", ".", "n"}], "\[Rule]", "1"}], ",", 
     "\"\< which can be taken into account using Lagrange multiplier trick. \n\
The obtained expression is the equation of spin precession and \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\) is a proper, explicitly SU[2] invariant \
action for the free spin S.\>\""}], "]"}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.795097373512871*^9, 3.795097601477211*^9}, {
  3.795097636670701*^9, 3.795097857057806*^9}, {3.795097901394328*^9, 
  3.795097904153102*^9}, {3.7950980314776583`*^9, 3.795098047687986*^9}, {
  3.795271816836389*^9, 3.795271821477571*^9}, {3.796047563605721*^9, 
  3.796047564780993*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"07c4076d-015b-4cbc-b67d-4f63db8f7bf0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 6: W in 0+1, spin precession.\\nLet us consider the \
quantum-mechanical action of the unit vector n[t] with the (Euclidean) action\
\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["S", "h"], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "S"}], " ", 
         TemplateBox[{RowBox[{"h", "\[CenterDot]", 
             RowBox[{"n", "[", "t", "]"}]}],"t"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
        RowBox[{
         SubscriptBox["S", "WZ"], "[", 
         RowBox[{"n", "[", "t", "]"}], "]"}]}]}], ",", 
      RowBox[{
       SubscriptBox["S", "WZ"], "[", 
       StyleBox["\<\"e[67]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], ",", 
      RowBox[{"h", "[", 
       StyleBox["\<\"some constant 3-component vector(magnetic field)\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]}], "}"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\". \\n\\!\\(\\*StyleBox[\\\"Find\\\",FontSize->14]\\) the \
classical equation of motion of n[t] from the variational principle \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      SubscriptBox["S", "h"], "]"}], "\[Rule]", "0"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\". Remember that one has a constraint \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"n", ".", "n"}], "\[Rule]", "1"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" which can be taken into account using Lagrange multiplier \
trick. \\nThe obtained expression is the equation of spin precession and \
\\!\\(\\*SubscriptBox[\\(S\\), \\(WZ\\)]\\) is a proper, explicitly SU[2] \
invariant action for the free spin S.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 6: W in 0+1, spin precession.\nLet us consider the \
quantum-mechanical action of the unit vector n[t] with the (Euclidean) \
action", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[{
    Subscript[$CellContext`S, $CellContext`h] -> -$CellContext`S 
       Inactive[Integrate][
         CenterDot[$CellContext`h, 
          $CellContext`n[$CellContext`t]], $CellContext`t] + 
      Subscript[$CellContext`S, $CellContext`WZ][
        $CellContext`n[$CellContext`t]], 
     Subscript[$CellContext`S, $CellContext`WZ][
      Style["e[67]", 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
     $CellContext`h[
      Style["some constant 3-component vector(magnetic field)", 
       RGBColor[0, 
        Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[". \n\!\(\*StyleBox[\"Find\",FontSize->14]\) the classical equation \
of motion of n[t] from the variational principle ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[$CellContext`\[Delta][
      Subscript[$CellContext`S, $CellContext`h]] -> 0, 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[". Remember that one has a constraint ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Dot[$CellContext`n, $CellContext`n] -> 1, 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" which can be taken into account using Lagrange multiplier trick. \n\
The obtained expression is the equation of spin precession and \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\) is a proper, explicitly SU[2] invariant \
action for the free spin S.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188547877256*^9, 3.800188908200594*^9, 
  3.800267850724588*^9},ExpressionUUID->"3e094b54-5631-45fa-b0dd-\
c6742f2d4cae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PR", "[", 
    RowBox[{"\"\<From e[68] \>\"", ",", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", "68", "]"}], "//", 
        RowBox[{"tuRuleSelect", "[", 
         RowBox[{
          SubscriptBox["S", "_"], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "//", "tuRule1"}]}], ",", 
     "\[IndentingNewLine]", "and", ",", 
     RowBox[{
      RowBox[{"$s", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"e", "[", "67", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"tuRuleSelect", "[", 
             SubscriptBox["W", "0"], "]"}], "[", 
            RowBox[{"e", "[", "66", "]"}], "]"}], "//", "First"}]}], "}"}], "/.", 
        RowBox[{
         RowBox[{
          SubscriptBox["W", "0"], "[", "_", "]"}], "\[Rule]", 
         SubscriptBox["W", "0"]}]}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ColumnForms", "[", 
          RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
     ",", "\[IndentingNewLine]", "Yield", ",", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"68", ",", "1"}], "]"}], "=", 
      RowBox[{"$0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"$", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["S", "WZ"], "[", "_", "]"}], "->", 
               SubscriptBox["S", "WZ"]}], ",", 
              RowBox[{
               RowBox[{"n", "[", "t", "]"}], "\[Rule]", "n"}]}], "}"}]}], "/.",
            "$s"}], "/.", "$s"}], "/.", "toDot"}], "//", 
        RowBox[{"tuIntegralSimplify", "[", 
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"n", "[", "t", "]"}], ",", "n", ",", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], "}"}], 
         "]"}]}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "Yield", ",", 
     RowBox[{"$s", "=", 
      RowBox[{"$0", "//", 
       RowBox[{"tuExtractPositionPattern", "[", 
        RowBox[{"a_", " ", 
         RowBox[{"T", "[", 
          RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}]}], "]"}]}]}], ",",
      "\[IndentingNewLine]", "Yield", ",", 
     RowBox[{
      RowBox[{"$s", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"$s", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "2"}], "}"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"tt", ":", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{"tuLeviCivitaNumeric", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "[", 
         "tt", "]"}]}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
      "NL", ",", "\"\<Use: \>\"", ",", 
     RowBox[{"$sx", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"dn1_", ",", "dn2_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dn1", "/.", 
            RowBox[{"n", "->", 
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dn2", "/.", 
            RowBox[{"n", "->", 
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "j", "}"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"T", "[", 
           RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"h", " ", ".", " ", "n"}], " ", "\[Rule]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"h", ",", "\"\<u\>\"", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}], 
            RowBox[{"T", "[", 
             RowBox[{"n", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], " ", "}"}]}], ",", 
     "\[IndentingNewLine]", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", 
     "Yield", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"$s", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"$s", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", 
           RowBox[{"tuRule", "[", "$sx", "]"}]}], "//", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "&"}]}], "//", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{
             RowBox[{"tt", ":", 
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], ":>", 
             RowBox[{
              RowBox[{"tuLeviCivitaNumeric", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], 
              "[", "tt", "]"}]}]}], "&"}], ")"}]}], "//", "Simplify"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"$s", "//", "ColumnSumExp"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "Yield", ",", 
     RowBox[{"$", "=", 
      RowBox[{"tuReplacePart", "[", 
       RowBox[{"$0", ",", "$s"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "Yield", ",", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"$", "/.", 
        RowBox[{
         RowBox[{"h", " ", ".", " ", "n"}], "\[Rule]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"h", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}], 
            RowBox[{"T", "[", 
             RowBox[{"n", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}], "//", 
       RowBox[{"tuIntegralSimplify", "[", 
        RowBox[{"{", 
         RowBox[{"h", ",", 
          RowBox[{"n", "[", "t", "]"}], ",", "n", ",", 
          RowBox[{"Tensor", "[", 
           RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], "}"}], 
        "]"}]}]}], ",", "\[IndentingNewLine]", "\"\<PON\>\"", ",", 
     "\[IndentingNewLine]", "Yield", ",", 
     RowBox[{"$", "//", 
      RowBox[{"ColumnSumExpN", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "NL", ",", 
     "\"\<For variation add constrain via Lagrange multiplier and extend \
integration variables to {\[Rho][radius],t[angle]}: \>\"", ",", 
     "\[IndentingNewLine]", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", 
     "Yield", ",", 
     RowBox[{"$pass", "=", 
      RowBox[{"$", "=", 
       RowBox[{
        RowBox[{"$", "/.", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"x", "\[Element]", "D"}]}], "]"}], "->", 
          RowBox[{"xIntegral", "[", 
           RowBox[{"a", " ", ",", "\[Rho]", ",", "t"}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"xIntegral", "[", 
          RowBox[{"a_", ",", "t"}], "]"}], "->", 
         RowBox[{"xIntegral", "[", 
          RowBox[{"a", ",", "\[Rho]", ",", "t"}], "]"}]}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"PR", "[", 
  RowBox[{"\"\<For transform: \>\"", ",", 
   RowBox[{"$trans", "=", 
    RowBox[{"$", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Rule]", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "}"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<The Jacobian \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$jacob", "=", 
     RowBox[{"$", "=", 
      RowBox[{"tuJacobian", "[", 
       RowBox[{"$", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Rho]"}], "}"}]}], "]"}]}]}], ";", 
    RowBox[{"$", "//", "MatrixForms"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"$jacob", "=", 
    RowBox[{"tuRule", "[", "$jacob", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"$", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "Simplify"}], ";", 
    "\[IndentingNewLine]", "NL"}], ",", 
   "\"\<Transform integrals to {\[Rho][radius],t[azmuthal angle]}\[Element]\!\
\(\*StyleBox[\\\"D\\\",FontSlant->\\\"Italic\\\"]\) coordinate system \>\"", 
   ",", "\[IndentingNewLine]", 
   RowBox[{"$", "=", 
    RowBox[{"$pass", "//", 
     RowBox[{"tuExtractPositionPattern", "[", 
      RowBox[{"xIntegral", "[", "__", "]"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<Identify 1\[Rule]x, 2\[Rule]y and use: \>\"", ",", 
   RowBox[{
    RowBox[{"$s", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"xIntegral", "[", 
         RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
        RowBox[{"xIntegral", "[", 
         RowBox[{
          RowBox[{"a", "  ", 
           RowBox[{"Det", "[", 
            RowBox[{"First", "[", 
             RowBox[{"$jacob", "=", 
              RowBox[{
               RowBox[{"tuJacobian", "[", 
                RowBox[{"$trans", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Theta]", ",", "\[Rho]"}], "}"}]}], "]"}], "//", 
               "tuRule"}]}], "]"}], "]"}]}], ",", "b"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tuDPartial", "[", 
         RowBox[{"a_", ",", "1"}], "]"}], "->", 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"a", ",", "x"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tuDPartial", "[", 
         RowBox[{"a_", ",", "2"}], "]"}], "->", 
        RowBox[{"tuDPartial", "[", 
         RowBox[{"a", ",", "y"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", 
      RowBox[{"expandDot", "[", 
       RowBox[{
        RowBox[{"{", "$s", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "Simplify", "}"}], ",", "1"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"$", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"dd", ":", 
           RowBox[{"tuDPartial", "[", 
            RowBox[{"_", ",", 
             RowBox[{"x", "|", "y"}]}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{"dd", "/.", 
            RowBox[{"tuDChain", "[", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Rho]"}], "}"}], "]"}]}], ")"}]}]}], 
        "/.", 
        RowBox[{"$jacob", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "/.", "toTimes"}], "//", 
      RowBox[{"expandDot", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "\[Rho]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Simplify", ",", "Expand"}], "}"}]}], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", "\"\<\[Bullet] Then \>\"", ",", 
   RowBox[{"$", "=", 
    RowBox[{"$pass", "=", 
     RowBox[{
      RowBox[{"tuReplacePart", "[", 
       RowBox[{"$pass", ",", "$"}], "]"}], "/.", "tuIntegralGatherR"}]}]}], 
   ",", "\[IndentingNewLine]", "NL", ",", "\"\<Add Lagrange multiplier \>\"", 
   ",", 
   RowBox[{
    RowBox[{"e", "[", "68.1", "]"}], "=", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"xIntegral", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"xIntegral", "[", 
        RowBox[{
         RowBox[{"a", "-", 
          RowBox[{"\[Lambda]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"n", ",", "\"\<d\>\"", ",", 
                  RowBox[{"{", "i", "}"}]}], "]"}], 
                RowBox[{"T", "[", 
                 RowBox[{"n", ",", "\"\<d\>\"", ",", 
                  RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "-", "1"}], 
            ")"}]}]}], ",", "b"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.795271833815237*^9, 3.795271845135729*^9}, {
   3.7952718941668787`*^9, 3.795271897417884*^9}, {3.795271951022715*^9, 
   3.795271956283325*^9}, {3.795272542597762*^9, 3.795272669675153*^9}, {
   3.7952727832060833`*^9, 3.795272805384322*^9}, {3.7952728456248426`*^9, 
   3.795272891297185*^9}, {3.7952730292437696`*^9, 3.7952732134207697`*^9}, {
   3.795273250826207*^9, 3.795273310597725*^9}, {3.795273408891399*^9, 
   3.7952734185974293`*^9}, {3.795273455543539*^9, 3.7952736749330597`*^9}, {
   3.795273988169343*^9, 3.79527413754492*^9}, {3.7952741802624483`*^9, 
   3.7952742783752728`*^9}, {3.795274319335616*^9, 3.7952743465816298`*^9}, {
   3.7952743840371113`*^9, 3.7952744087978*^9}, {3.795274458480419*^9, 
   3.795274507126638*^9}, {3.79527482492909*^9, 3.795274992405335*^9}, {
   3.795275027973042*^9, 3.7952750687059727`*^9}, {3.795276266230801*^9, 
   3.79527637485472*^9}, {3.7952764126706753`*^9, 3.795276413423378*^9}, {
   3.795276490130562*^9, 3.795276534380603*^9}, {3.795276590812821*^9, 
   3.795276610639689*^9}, {3.7952766779538803`*^9, 3.7952767204416018`*^9}, {
   3.795279062963059*^9, 3.7952790850566072`*^9}, {3.795279129224904*^9, 
   3.7952791479652452`*^9}, {3.79527921099862*^9, 3.795279227098147*^9}, {
   3.795279263252799*^9, 3.795279264450191*^9}, {3.795279492604371*^9, 
   3.795279510542851*^9}, {3.795280556377139*^9, 3.795280584277605*^9}, {
   3.795280646703506*^9, 3.795280651023418*^9}, {3.795280693397839*^9, 
   3.795280697358007*^9}, {3.795280780366446*^9, 3.7952808794943323`*^9}, {
   3.795280918301058*^9, 3.795280919363986*^9}, {3.7952809816014633`*^9, 
   3.7952809953280478`*^9}, 3.79528107977772*^9, {3.795281148838002*^9, 
   3.795281149578197*^9}, {3.7952811851814337`*^9, 3.7952812324873543`*^9}, {
   3.795281265627041*^9, 3.795281283007506*^9}, {3.795282147258662*^9, 
   3.795282149214519*^9}, {3.795884327748057*^9, 3.795884330939329*^9}, {
   3.795884394379773*^9, 3.795884445343629*^9}, {3.795884490449554*^9, 
   3.795884519583705*^9}, {3.796047499358523*^9, 3.796047508938797*^9}, 
   3.796047544337031*^9, {3.796234978008175*^9, 3.7962349842872*^9}, {
   3.796235418627102*^9, 3.796235421073367*^9}, {3.79623545355681*^9, 
   3.7962354562905703`*^9}, {3.796235494234179*^9, 3.796235537785769*^9}, {
   3.796235771281962*^9, 3.79623577263702*^9}, {3.796235933523164*^9, 
   3.796236084010798*^9}, {3.796236122124488*^9, 3.796236142682746*^9}, 
   3.7962361899201612`*^9, {3.7962362340726137`*^9, 3.79623625336224*^9}, {
   3.7962363464059687`*^9, 3.796236346972258*^9}, {3.796236391093851*^9, 
   3.796236392016485*^9}, {3.7962369710036983`*^9, 3.7962369983255444`*^9}, {
   3.7962371714486017`*^9, 3.79623717304513*^9}, 3.7962376104152803`*^9, {
   3.7962376468314123`*^9, 3.796237654640979*^9}, {3.796237797813325*^9, 
   3.796237880185836*^9}, {3.796237966646059*^9, 3.796238003850209*^9}, {
   3.796238708030534*^9, 3.79623874413048*^9}, {3.796238795031102*^9, 
   3.796238856563519*^9}, {3.796238946854642*^9, 3.796238952210841*^9}, {
   3.796239016474807*^9, 3.796239043250251*^9}, 3.7962390926706676`*^9, {
   3.7962391389999*^9, 3.7962392220250874`*^9}, {3.796239256019005*^9, 
   3.796239343563876*^9}, {3.796239373934588*^9, 3.796239377539289*^9}, {
   3.796239457733783*^9, 3.796239466021521*^9}, {3.7962395157270813`*^9, 
   3.796239601042329*^9}, {3.796239665695126*^9, 3.7962396988297863`*^9}, {
   3.79624003872322*^9, 3.796240061819676*^9}, {3.796303893853547*^9, 
   3.79630389816468*^9}, {3.796303963742964*^9, 3.7963039939551363`*^9}, {
   3.796304162801518*^9, 3.796304232886446*^9}, {3.7963042660534973`*^9, 
   3.796304267523881*^9}, {3.796412872290506*^9, 3.796412874485608*^9}, {
   3.796412928861157*^9, 3.796412929425687*^9}, 3.79641320644654*^9, {
   3.796467964213997*^9, 3.796467982872622*^9}, {3.796468959862329*^9, 
   3.796469050856433*^9}, {3.796469086967152*^9, 3.796469150807159*^9}, {
   3.7964692080928783`*^9, 3.796469255393507*^9}, {3.796469335915628*^9, 
   3.796469339840515*^9}, {3.796470038677044*^9, 3.796470039259601*^9}, {
   3.796470161816781*^9, 3.796470191037591*^9}, {3.796470237171167*^9, 
   3.796470252479109*^9}, {3.79647412021524*^9, 3.79647415596519*^9}, {
   3.796479457683255*^9, 3.7964794582226353`*^9}, {3.796651403720433*^9, 
   3.7966514335629387`*^9}, {3.798476202977005*^9, 3.798476215285239*^9}, {
   3.798476249445396*^9, 3.798476255069594*^9}, {3.798476321114874*^9, 
   3.798476323783514*^9}},ExpressionUUID->"f5217d92-3bb2-41fc-b27d-\
9131100e897b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"From e[68] \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    SubscriptBox["S", "h"]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "S"}], " ", 
      TemplateBox[{RowBox[{"h", "\[CenterDot]", 
          RowBox[{"n", "[", "t", "]"}]}],"t"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["S", "WZ"], "[", 
       RowBox[{"n", "[", "t", "]"}], "]"}], "\[InvisibleSpace]", 
      StyleBox["\<\" and \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      TagBox[GridBox[{
         {
          RowBox[{
           SubscriptBox["S", "WZ"], "\[Rule]", 
           RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Pi]", " ", "S", " ", 
            SubscriptBox["W", "0"]}]}]},
         {
          RowBox[{
           SubscriptBox["W", "0"], "\[Rule]", 
           TemplateBox[{FractionBox[
              RowBox[{
                RowBox[{"n", ".", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", 
                    "n", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
                    SyntaxForm -> Automatic, Editable -> False], "\[Cross]", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", 
                    "n", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], 
                    SyntaxForm -> Automatic, Editable -> False]}]}], " ", 
                InterpretationBox[
                 SubsuperscriptBox["\[Epsilon]", 
                  RowBox[{
                    StyleBox[
                    "\[Mu]", ShowContents -> False, StripOnInput -> False], 
                    StyleBox[
                    "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
                  
                  RowBox[{"\[Mu]", "\[Nu]"}]], 
                 $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\
\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], Editable -> 
                 False, BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
              RowBox[{"8", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", "D"}]},
            "InactiveIntegrate",
            DisplayFunction->(RowBox[{
               UnderscriptBox[
                StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
            InterpretationFunction->(RowBox[{
               RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
               RowBox[{#, ",", #2}], "]"}]& )]}]}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          RGBColor[0.7, 0, 1, 1], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\[RightArrow] \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontWeight->Bold,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      SubscriptBox["S", "h"]}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "S"}], " ", 
       TemplateBox[{RowBox[{"h", ".", "n"}],"t"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", 
       TemplateBox[{RowBox[{
           RowBox[{"n", ".", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", "n",
                   "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
                SyntaxForm -> Automatic, Editable -> False], "\[Cross]", 
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", "n",
                   "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], 
                SyntaxForm -> Automatic, Editable -> False]}]}], " ", 
           InterpretationBox[
            SubsuperscriptBox["\[Epsilon]", 
             RowBox[{
               StyleBox[
               "\[Mu]", ShowContents -> False, StripOnInput -> False], 
               StyleBox[
               "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
             RowBox[{"\[Mu]", "\[Nu]"}]], 
            $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], Editable -> 
            False, BaseStyle -> {AutoMultiplicationSymbol -> False}]}],
         RowBox[{"x", "\[Element]", "D"}]},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           UnderscriptBox[
            StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[RightArrow] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2", ",", "3", ",", "1"}], "}"}], "\[Rule]", 
         RowBox[{
          RowBox[{"n", ".", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", "n",
               "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]],
             Editable->False,
             SyntaxForm->Automatic], "\[Cross]", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", "n",
               "]"}],
             $CellContext`tuDDown[
             "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]],
             Editable->False,
             SyntaxForm->Automatic]}]}], " ", 
          InterpretationBox[
           SubsuperscriptBox["\[Epsilon]", 
            StyleBox[
             RowBox[{"\[Mu]", "\[Nu]"}],
             StripOnInput->False,
             ShowContents->False], 
            RowBox[{"\[Mu]", "\[Nu]"}]],
           $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}]}], "}"}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[RightArrow] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{
        RowBox[{"n", ".", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "1"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 1],
           Editable->False,
           SyntaxForm->Automatic], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "2"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 2],
           Editable->False,
           SyntaxForm->Automatic]}]}], "-", 
        RowBox[{"n", ".", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "2"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 2],
           Editable->False,
           SyntaxForm->Automatic], "\[Cross]", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "1"], "[", "n", "]"}],
           $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 1],
           Editable->False,
           SyntaxForm->Automatic]}]}]}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       StyleBox["\<\"Use: \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dn1_", "\[Cross]", "dn2_"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dn1", "/.", "\[VeryThinSpace]", 
             RowBox[{"n", "\[Rule]", 
              RowBox[{"T", "[", 
               RowBox[{"n", ",", "\<\"d\"\>", ",", 
                RowBox[{"{", "i", "}"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"dn2", "/.", "\[VeryThinSpace]", 
             RowBox[{"n", "\[Rule]", 
              RowBox[{"T", "[", 
               RowBox[{"n", ",", "\<\"d\"\>", ",", 
                RowBox[{"{", "j", "}"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"T", "[", 
            RowBox[{"\[Epsilon]", ",", "\<\"uuu\"\>", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"h", ".", "n"}], "\[Rule]", 
          RowBox[{
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["h", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False], "1"],
             $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], " ", 
            InterpretationBox[
             SubsuperscriptBox["n", "1", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], "+", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["h", 
              StyleBox["2",
               StripOnInput->False,
               ShowContents->False], "2"],
             $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], " ", 
            InterpretationBox[
             SubsuperscriptBox["n", "2", 
              StyleBox["2",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], "+", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["h", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False], "3"],
             $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], " ", 
            InterpretationBox[
             SubsuperscriptBox["n", "3", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}]}]}]}], "}"}], "\[InvisibleSpace]", 
       StyleBox["\<\"\\n\[RightArrow] \"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontSize->Larger,
        FontWeight->Bold,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "\[InvisibleSpace]", 
       SubscriptBox["S", "h"]}]}], "\[Rule]", 
     RowBox[{
      RowBox[{
       StyleBox["\<\"\[Sum]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0.7, 0, 1],
        LineOpacity->1,
        FrontFaceColor->RGBColor[0.7, 0, 1],
        BackFaceColor->RGBColor[0.7, 0, 1],
        FrontFaceOpacity->1,
        BackFaceOpacity->1,
        GraphicsColor->RGBColor[0.7, 0, 1],
        Opacity->1,
        FontColor->RGBColor[0.7, 0, 1],
        FontOpacity->1], "[", 
       TagBox[GridBox[{
          {
           RowBox[{
            FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", 
            TemplateBox[{RowBox[{
                StyleBox["\"\[Sum]\"", 
                 RGBColor[0.7, 0, 1, 1], StripOnInput -> False], "[", 
                TagBox[
                 GridBox[{{
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}, {
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}, {
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}]}, {
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox["3", ShowContents -> False, StripOnInput -> 
                    False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}, {
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}]}, {
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                    " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                    ")"}]}]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  AutoDelete -> False, 
                  GridBoxDividers -> {"Columns" -> {True}, "Rows" -> {False}},
                   GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                  FrameStyle -> Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]]], "Grid"], "]"}],
              RowBox[{"x", "\[Element]", "D"}]},
             "InactiveIntegrate",
             DisplayFunction->(RowBox[{
                UnderscriptBox[
                 StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
             InterpretationFunction->(RowBox[{
                RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                RowBox[{#, ",", #2}], "]"}]& )]}]},
          {
           RowBox[{
            RowBox[{"-", "S"}], " ", 
            TemplateBox[{RowBox[{
                StyleBox["\"\[Sum]\"", 
                 RGBColor[0.7, 0, 1, 1], StripOnInput -> False], "[", 
                TagBox[
                 GridBox[{{
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}, {
                    RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> 
                  False, GridBoxDividers -> {
                   "Columns" -> {True}, "Rows" -> {False}}, 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                  FrameStyle -> Directive[
                    RGBColor[0.7, 0, 1, 1], 
                    Thickness[Tiny]]], "Grid"], "]"}],"t"},
             "InactiveIntegrate",
             DisplayFunction->(RowBox[{
                StyleBox["\[Integral]", "Inactive"], 
                RowBox[{#, 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
             InterpretationFunction->(RowBox[{
                RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
                RowBox[{#, ",", #2}], "]"}]& )]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"], "]"}], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"For variation add constrain via Lagrange multiplier and \
extend integration variables to {\[Rho][radius],t[angle]}: \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1]}]}]}]}],
  SequenceForm[
   Style["From e[68] ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`S, $CellContext`h] -> -$CellContext`S 
     Inactive[Integrate][
       CenterDot[$CellContext`h, 
        $CellContext`n[$CellContext`t]], $CellContext`t] + 
    Subscript[$CellContext`S, $CellContext`WZ][
      $CellContext`n[$CellContext`t]], 
   Style[" and ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{
     Subscript[$CellContext`S, $CellContext`WZ] -> 
      Complex[0, 4] Pi $CellContext`S Subscript[$CellContext`W, 0]}, {
     Subscript[$CellContext`W, 0] -> 
      Inactive[Integrate][Rational[1, 8] Pi^(-1) Dot[$CellContext`n, 
          Cross[
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
        Element[$CellContext`x, D]]}}, Dividers -> {{True}, {False}}, 
    FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Subscript[$CellContext`S, $CellContext`h] -> -$CellContext`S 
     Inactive[Integrate][
       Dot[$CellContext`h, $CellContext`n], $CellContext`t] + Complex[0, 
       Rational[1, 2]] $CellContext`S 
     Inactive[Integrate][Dot[$CellContext`n, 
         Cross[
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
       Element[$CellContext`x, D]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {{2, 2, 3, 1} -> Dot[$CellContext`n, 
       Cross[
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]]]] \
$CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Dot[$CellContext`n, 
     Cross[
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 1], 
      $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 2]]] - 
   Dot[$CellContext`n, 
    Cross[
     $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 2], 
     $CellContext`tuDDown["\[PartialD]"][$CellContext`n, 1]]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Use: ", 
    RGBColor[0.7, 0, 1, 1], Larger], {Cross[
      Pattern[$CellContext`dn1, 
       Blank[]], 
      Pattern[$CellContext`dn2, 
       Blank[]]] :> 
    ReplaceAll[$CellContext`dn1, $CellContext`n -> \
$CellContext`T[$CellContext`n, "d", {$CellContext`i}]] 
     ReplaceAll[$CellContext`dn2, $CellContext`n -> \
$CellContext`T[$CellContext`n, 
         "d", {$CellContext`j}]] $CellContext`T[$CellContext`\[Epsilon], 
       "uuu", {$CellContext`i, $CellContext`j, $CellContext`k}], 
    Dot[$CellContext`h, $CellContext`n] -> \
$CellContext`Tensor[$CellContext`h, {
        1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] + $CellContext`Tensor[$CellContext`h, {
        2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] + $CellContext`Tensor[$CellContext`h, {
        3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}]}, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], Subscript[$CellContext`S, $CellContext`h] -> 
   Style["\[Sum]", 
     RGBColor[0.7, 0, 1, 1]][
     Grid[{{Complex[0, 
          Rational[1, 2]] $CellContext`S Inactive[Integrate][
          Style["\[Sum]", 
           RGBColor[0.7, 0, 1, 1]][
           Grid[{{-Dot[
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 1}], $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}], 2] $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}], 1]]}, {
              Dot[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                1}], $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}], 1] $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], 2]]}, {-Dot[
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 1}], -$CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}], 2] $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   3}], 1]]}, {
              Dot[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                1}], -$CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}], 1] $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}], 2]]}, {
              Dot[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                2}], -$CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}], 2] $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], 1]]}, {-Dot[
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 2}], -$CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}], 1] $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}], 2]]}, {-Dot[
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 2}], $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}], 2] $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   3}], 1]]}, {
              Dot[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                2}], $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], 1] $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}], 2]]}, {
              Dot[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                3}], $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}], 2] $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}], 1]]}, {
              Dot[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                3}], -$CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], 2] $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}], 1]]}, {-Dot[
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 3}], $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}], 1] $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   3}], 2]]}, {-Dot[
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 3}], -$CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}], 1] $CellContext`tuDDown["\[PartialD]"][
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   3}], 2]]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
            Directive[
              RGBColor[0.7, 0, 1, 1], 
              Thickness[Tiny]], Alignment -> Left]], 
          Element[$CellContext`x, D]]}, {-$CellContext`S Inactive[Integrate][
          Style["\[Sum]", 
           RGBColor[0.7, 0, 1, 1]][
           
           Grid[{{$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                1}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                1}]}, {$CellContext`Tensor[$CellContext`h, {$CellContext`Void}
                , {
                2}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                2}]}, {$CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {
                3}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                3}]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
            Directive[
              RGBColor[0.7, 0, 1, 1], 
              Thickness[Tiny]], Alignment -> Left]], $CellContext`t]}}, 
      Dividers -> {{True}, {False}}, FrameStyle -> Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]], Alignment -> Left]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["For variation add constrain via Lagrange multiplier and extend \
integration variables to {\[Rho][radius],t[angle]}: ", 
    RGBColor[0.7, 0, 1, 1], Larger]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188548179226*^9, 3.800188908530979*^9, 
  3.8002678510099993`*^9},ExpressionUUID->"913396c5-52fd-49f9-abd5-\
fae1557fd9a8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"For transform: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"\[Rho]", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
      RowBox[{"y", "\[Rule]", 
       RowBox[{"\[Rho]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "}"}], 
    "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"The Jacobian \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"\[Rho]", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]},
           {
            RowBox[{
             RowBox[{"-", "\[Rho]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], "[", 
       StyleBox["\<\"Jacobian[var1/var2]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
            "x", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{"\[Rho]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
            "y", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`y, $CellContext`\[Theta]],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "x", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`x, $CellContext`\[Rho]],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{
           RowBox[{"-", "\[Rho]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "y", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`y, $CellContext`\[Rho]],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}], "[", 
       StyleBox["\<\"Rules[\[PartialD][var1,var2]]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], ",", 
      RowBox[{
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            FractionBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rho]"], 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Rho]"]}]},
           {
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], "[", 
       StyleBox["\<\"Jacobian[var2/var1]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", 
            "\[Theta]", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Theta], $CellContext`x],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          FractionBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rho]"]}], ",", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Rho]", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Rho], $CellContext`x],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Rho]"]}]}], ",", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", 
            "\[Theta]", "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Theta], $CellContext`y],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Rho]", 
            "]"}],
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Rho], $CellContext`y],
           Editable->False,
           SyntaxForm->Automatic], "\[Rule]", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}], "[", 
       StyleBox["\<\"Rules[\[PartialD][var1,var2]]\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 
          Rational[2, 3], 0],
        FrontFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        BackFaceColor->RGBColor[0, 
          Rational[2, 3], 0],
        GraphicsColor->RGBColor[0, 
          Rational[2, 3], 0],
        FontFamily->"Helvetica",
        FontColor->RGBColor[0, 
          Rational[2, 3], 0]], "]"}]}], "}"}], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", "x", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"\[Rho]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", "y", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`y, $CellContext`\[Theta]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "x", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`x, $CellContext`\[Rho]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "\[Rho]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", "y", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`y, $CellContext`\[Rho]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Theta]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`x],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       FractionBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rho]"]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Rho]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Rho], $CellContext`x],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Rho]"]}]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Theta]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`y],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Rho]", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Rho], $CellContext`y],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}], "\[InvisibleSpace]", 
    
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Transform integrals to {\[Rho][radius],t[azmuthal angle]}\
\[Element]\\!\\(\\*StyleBox[\\\"D\\\",FontSlant->\\\"Italic\\\"]\\) \
coordinate system \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "3"}], "}"}], "\[Rule]", 
       TemplateBox[{RowBox[{"(", 
           RowBox[{
             RowBox[{"-", 
               RowBox[{
                 InterpretationBox[
                  SubsuperscriptBox["n", 
                   RowBox[{"1"}], 
                   RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   1}], Editable -> False, 
                  BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
                 RowBox[{"(", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                   ")"}]}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "-", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                   " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                   " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                   " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "-", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                    
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                   " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "-", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 2], SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                   " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "-", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], 1], SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}], "-", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], ".", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "1"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], 1], SyntaxForm -> Automatic, Editable -> False]}], 
                   " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "2"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], 2], SyntaxForm -> Automatic, Editable -> False]}], 
                 ")"}]}]}], ")"}],"\[Rho]","t"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #3}], 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2, ",", #3}], "]"}]& )]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "3"}], "}"}], "\[Rule]", 
       TemplateBox[{RowBox[{"(", 
           RowBox[{
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["h", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["h", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["h", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], ")"}],
         "\[Rho]","t"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #3}], 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2, ",", #3}], "]"}]& )]}]}], "}"}], 
    "\[InvisibleSpace]", 
    StyleBox["\<\"\\n\"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    StyleBox["\<\"Identify 1\[Rule]x, 2\[Rule]y and use: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    TagBox[GridBox[{
       {
        RowBox[{
         TemplateBox[{"a_","b__"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )], "\[RuleDelayed]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"First", "[", 
              RowBox[{"$jacob", "=", 
               RowBox[{"tuRule", "[", 
                RowBox[{"tuJacobian", "[", 
                 RowBox[{"$trans", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Theta]", ",", "\[Rho]"}], "}"}]}], "]"}], 
                "]"}]}], "]"}], "]"}]}], ",", "b"}], "]"}]}]},
       {
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "1"], "[", "a_", "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Pattern[$CellContext`a, 
            Blank[]], 1],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "a", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][$CellContext`a, $CellContext`x],
          
          Editable->False,
          SyntaxForm->Automatic]}]},
       {
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "2"], "[", "a_", "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           Pattern[$CellContext`a, 
            Blank[]], 2],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "a", 
           "]"}],
          $CellContext`tuDDown["\[PartialD]"][$CellContext`a, $CellContext`y],
          
          Editable->False,
          SyntaxForm->Automatic]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"], "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     TemplateBox[{RowBox[{
         RowBox[{"Det", "[", 
           RowBox[{
             InterpretationBox[
              RowBox[{
                SubscriptBox[
                 UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                "x", "]"}], 
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]], 
              SyntaxForm -> Automatic, Editable -> False], "\[Rule]", 
             RowBox[{"\[Rho]", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "y"], "[", 
                  "\[Theta]", "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Theta], $CellContext`y], 
                SyntaxForm -> Automatic, Editable -> False], " ", 
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "x"], "[", 
                  "\[Rho]", "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Rho], $CellContext`x], 
                SyntaxForm -> Automatic, Editable -> False]}], "-", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "x"], "[", 
                  "\[Theta]", "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Theta], $CellContext`x], 
                SyntaxForm -> Automatic, Editable -> False], " ", 
               InterpretationBox[
                RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\"\[PartialD]\"", "_"], "y"], "[", 
                  "\[Rho]", "]"}], 
                $CellContext`tuDDown[
                "\[PartialD]"][$CellContext`\[Rho], $CellContext`y], 
                SyntaxForm -> Automatic, Editable -> False]}]}], ")"}], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"3"}], 
                 RowBox[{
                   StyleBox[
                   "3", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], "-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"2"}], 
                 RowBox[{
                   StyleBox[
                   "2", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "-", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "-", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], ")"}]}], "+", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], "-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}]}], "+", 
                   RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}]}]}], ")"}]}]}], ")"}]}],
       "\[Rho]","t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #3}], 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2, ",", #3}], "]"}]& )], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"\[Bullet] Then \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     SubscriptBox["S", "h"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      TemplateBox[{RowBox[{"(", 
          RowBox[{
            RowBox[{
              RowBox[{"-", "S"}], " ", 
              RowBox[{"(", 
                RowBox[{
                  RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}], "+", 
                  
                  RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}], "+", 
                  
                  RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
                ")"}]}], "+", 
            RowBox[{
              FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", 
              RowBox[{"Det", "[", 
                RowBox[{
                  InterpretationBox[
                   RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    "x", "]"}], 
                   $CellContext`tuDDown[
                   "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]], 
                   SyntaxForm -> Automatic, Editable -> False], "\[Rule]", 
                  RowBox[{"\[Rho]", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], " ", 
              RowBox[{"(", 
                RowBox[{
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "y"], "[", 
                    "\[Theta]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Theta], $CellContext`y], 
                    SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "x"], "[", 
                    "\[Rho]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Rho], $CellContext`x], 
                    SyntaxForm -> Automatic, Editable -> False]}], "-", 
                  RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "x"], "[", 
                    "\[Theta]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Theta], $CellContext`x], 
                    SyntaxForm -> Automatic, Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "y"], "[", 
                    "\[Rho]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Rho], $CellContext`y], 
                    SyntaxForm -> Automatic, Editable -> False]}]}], ")"}], 
              " ", 
              RowBox[{"(", 
                RowBox[{
                  RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], "-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], ")"}]}], "+", 
                  RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "-", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "-", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], ")"}]}], "+", 
                  RowBox[{
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], "-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}],"\[Rho]","t"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #3}], 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2, ",", #3}], "]"}]& )], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"Add Lagrange multiplier \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      SubscriptBox["S", "h"]}], "\[Rule]", 
     TemplateBox[{RowBox[{"(", 
         RowBox[{
           RowBox[{
             RowBox[{"-", "S"}], " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}], "+", 
                 
                 RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}], "+", 
                 
                 RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["h", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}]}]}], 
               ")"}]}], "-", 
           RowBox[{"\[Lambda]", " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ")"}], 
                  "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ")"}], 
                  "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], ")"}], 
                  "2"]}], ")"}]}], "+", 
           RowBox[{
             FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", 
             RowBox[{"Det", "[", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    "x", "]"}], 
                  $CellContext`tuDDown[
                  "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]], 
                  SyntaxForm -> Automatic, Editable -> False], "\[Rule]", 
                 RowBox[{"\[Rho]", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "y"], "[", 
                    "\[Theta]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Theta], $CellContext`y], 
                    SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "x"], "[", 
                    "\[Rho]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Rho], $CellContext`x], 
                    SyntaxForm -> Automatic, Editable -> False]}], "-", 
                 RowBox[{
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "x"], "[", 
                    "\[Theta]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Theta], $CellContext`x], 
                    SyntaxForm -> Automatic, Editable -> False], " ", 
                   InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "y"], "[", 
                    "\[Rho]", "]"}], 
                    $CellContext`tuDDown[
                    "\[PartialD]"][$CellContext`\[Rho], $CellContext`y], 
                    SyntaxForm -> Automatic, Editable -> False]}]}], ")"}], 
             " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], "-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], ")"}]}], "+", 
                 RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "-", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "-", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}]}], ")"}]}], "+", 
                 RowBox[{
                   InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], "-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}]}], "+", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Theta]"], "[", 
                    
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], $CellContext`\[Theta]], SyntaxForm -> Automatic, 
                    Editable -> False], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], "+", 
                    InterpretationBox[
                    RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Rho]"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                    $CellContext`tuDDown["\[PartialD]"][
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], $CellContext`\[Rho]], SyntaxForm -> Automatic, 
                    Editable -> False]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}],"\[Rho]","t"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #3}], 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2, ",", #3}], "]"}]& )]}]}]}],
  SequenceForm[
   Style["For transform: ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], {$CellContext`x -> $CellContext`\[Rho] 
     Sin[$CellContext`\[Theta]], $CellContext`y -> $CellContext`\[Rho] 
     Cos[$CellContext`\[Theta]]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The Jacobian ", 
    RGBColor[0.7, 0, 1, 1], Larger], {
    MatrixForm[{{$CellContext`\[Rho] Cos[$CellContext`\[Theta]], 
       Sin[$CellContext`\[Theta]]}, {-$CellContext`\[Rho] 
       Sin[$CellContext`\[Theta]], 
       Cos[$CellContext`\[Theta]]}}][
     Style["Jacobian[var1/var2]", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
    {$CellContext`tuDDown[
      "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> $CellContext`\
\[Rho] Cos[$CellContext`\[Theta]], $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`y, $CellContext`\[Theta]] -> 
     Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`x, $CellContext`\[Rho]] -> -$CellContext`\
\[Rho] Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`y, $CellContext`\[Rho]] -> 
     Cos[$CellContext`\[Theta]]}[
     Style["Rules[\[PartialD][var1,var2]]", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
    MatrixForm[{{$CellContext`\[Rho]^(-1) 
       Cos[$CellContext`\[Theta]], -$CellContext`\[Rho]^(-1) 
       Sin[$CellContext`\[Theta]]}, {
       Sin[$CellContext`\[Theta]], 
       Cos[$CellContext`\[Theta]]}}][
     Style["Jacobian[var2/var1]", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
    {$CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] -> $CellContext`\
\[Rho]^(-1) Cos[$CellContext`\[Theta]], $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] -> -$CellContext`\
\[Rho]^(-1) Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] -> 
     Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Rho], $CellContext`y] -> 
     Cos[$CellContext`\[Theta]]}[
     Style["Rules[\[PartialD][var1,var2]]", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> 
      "Helvetica"]]}, {$CellContext`tuDDown[
     "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> $CellContext`\
\[Rho] Cos[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`y, $CellContext`\[Theta]] -> 
    Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`x, $CellContext`\[Rho]] -> -$CellContext`\
\[Rho] Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`y, $CellContext`\[Rho]] -> 
    Cos[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] -> $CellContext`\
\[Rho]^(-1) Cos[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] -> -$CellContext`\
\[Rho]^(-1) Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] -> 
    Sin[$CellContext`\[Theta]], $CellContext`tuDDown[
     "\[PartialD]"][$CellContext`\[Rho], $CellContext`y] -> 
    Cos[$CellContext`\[Theta]]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Transform integrals to {\[Rho][radius],t[azmuthal angle]}\[Element]\
\!\(\*StyleBox[\"D\",FontSlant->\"Italic\"]\) coordinate system ", 
    RGBColor[0.7, 0, 1, 1], Larger], {{2, 1, 3} -> Inactive[Integrate][-Dot[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}], $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
           2] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 1]] + 
      Dot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}], $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
          1] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 2]] - 
      Dot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        1}], -$CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
         2] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 1]] + 
      Dot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}], -$CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
          1] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 2]] + 
      Dot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}], -$CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
          2] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 1]] - 
      Dot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}], -$CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
         1] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 2]] - 
      Dot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}], $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
         2] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 1]] + 
      Dot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}], $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
          1] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 2]] + 
      Dot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}], $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
          2] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 1]] + 
      Dot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}], -$CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
          2] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 1]] - 
      Dot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}], $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
         1] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 2]] - 
      Dot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}], -$CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
         1] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
         2]], $CellContext`\[Rho], $CellContext`t], {2, 2, 3} -> 
    Inactive[Integrate][$CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {
         1}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
         2}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
         3}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}], $CellContext`\[Rho], $CellContext`t]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Identify 1\[Rule]x, 2\[Rule]y and use: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{Inactive[Integrate][
        Pattern[$CellContext`a, 
         Blank[]], 
        Pattern[$CellContext`b, 
         BlankSequence[]]] :> $CellContext`xIntegral[$CellContext`a Det[
          First[$CellContext`$jacob = $CellContext`tuRule[
             $CellContext`tuJacobian[$CellContext`$trans, {$CellContext`x, \
$CellContext`y}, {$CellContext`\[Theta], $CellContext`\[Rho]}]]]], \
$CellContext`b]}, {$CellContext`tuDDown["\[PartialD]"][
        Pattern[$CellContext`a, 
         Blank[]], 1] -> $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`a, $CellContext`x]}, {$CellContext`tuDDown[
       "\[PartialD]"][
        Pattern[$CellContext`a, 
         Blank[]], 2] -> $CellContext`tuDDown[
       "\[PartialD]"][$CellContext`a, $CellContext`y]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], {2, 1, 3} -> 
   Inactive[Integrate][
    Det[$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> \
$CellContext`\[Rho] Cos[$CellContext`\[Theta]]] ($CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] \
$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] - \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Rho], $CellContext`y]) \
($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}] (-$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]] + $CellContext`tuDDown[
          "\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]] + ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]]) $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] ($CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]] - $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]] - $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] ($CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Rho]] ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]]) + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Theta]] (-$CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Rho]] + $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Rho]]))), $CellContext`\[Rho], \
$CellContext`t], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Then ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`S, $CellContext`h] -> 
   Inactive[Integrate][-$CellContext`S ($CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {
          1}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
          2}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
          3}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]) + 
     Complex[0, 
        Rational[1, 2]] $CellContext`S 
      Det[$CellContext`tuDDown[
         "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> \
$CellContext`\[Rho] Cos[$CellContext`\[Theta]]] ($CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] \
$CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] - \
$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] \
$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Rho], $CellContext`y]) \
($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}] (-$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]] + $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]] + ($CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`\[Theta]] - $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Theta]]) $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Rho]] ($CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Theta]] - $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]]) + $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Theta]] (-$CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Rho]]))), $CellContext`\[Rho], \
$CellContext`t], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Add Lagrange multiplier ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Subscript[$CellContext`S, $CellContext`h] -> 
   Inactive[Integrate][-$CellContext`S ($CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {
          1}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
          2}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
          3}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}]) - $CellContext`\[Lambda] (-1 + \
$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}]^2 + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}]^2 + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}]^2) + Complex[0, 
        Rational[1, 2]] $CellContext`S 
      Det[$CellContext`tuDDown[
         "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> \
$CellContext`\[Rho] Cos[$CellContext`\[Theta]]] ($CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] \
$CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] - \
$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] \
$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Rho], $CellContext`y]) \
($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}] (-$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]] + $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]] + ($CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`\[Theta]] - $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Theta]]) $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Rho]] ($CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Theta]] - $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Theta]]) + $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Theta]] (-$CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Rho]]))), $CellContext`\[Rho], \
$CellContext`t]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188548179226*^9, 3.800188908530979*^9, 
  3.800267851371088*^9},ExpressionUUID->"51e9b3a9-5c17-4cc0-94c3-\
7342bed9869f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Compute EOM from e[68.1]:\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$0", "=", 
     RowBox[{"$", "=", 
      RowBox[{"e", "[", "68.1", "]"}]}]}], ";", "\[IndentingNewLine]", 
    "Yield"}], ",", 
   RowBox[{"$1", "=", 
    RowBox[{"$0", "//", "tuExtractIntegrand"}]}], ",", "\[IndentingNewLine]", 
   "NL", ",", "\"\<\[Bullet] Add kinetic terms \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"tuDPartial", "[", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"n", ",", "\"\<d\>\"", ",", 
            RowBox[{"{", "i", "}"}]}], "]"}], ",", "t"}], "]"}], "2"], "/", 
       "2"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], " ", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"$1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", "$s"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$lagran", "=", "$1"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "NL"}], ",", 
   "\"\<\[Bullet] from tuEulerEquation: \>\"", ",", "\[IndentingNewLine]", 
   "\"\<POFF\>\"", ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$2", "=", 
    RowBox[{
     RowBox[{"$1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", 
     RowBox[{"tuLagrangianPrepare", "[", 
      RowBox[{"{", "n", "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", "Yield",
    ",", 
   RowBox[{"$tmp", "=", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", 
      RowBox[{"tuEulerEquation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"n", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ",", "\[Lambda]"}], 
          "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Rho]", ",", "\[Theta]", ",", "t"}], "}"}]}], "]"}]}]}]}], 
   ",", "\[IndentingNewLine]", "\"\<PON\>\"", ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{
    RowBox[{"$pass", "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"$", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "//", "tuRule"}], "//", 
       "Simplify"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<POFF\>\"", ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<\[Bullet] Same from tuEulerLagrangeTensor[]: \>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "//", "tuRule"}], "//", 
      "Simplify"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"tuEulerLagrangeTensor", "[", 
      RowBox[{
       RowBox[{"$2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"n", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ",", "\[Lambda]"}], 
         "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "\[Theta]", ",", "t"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\n", 
 RowBox[{"PR", "[", 
  RowBox[{"\"\<We solve these equations assuming: \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"h", ",", "\"\<d\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1", "|", "2"}], "}"}]}], "]"}], "\[Rule]", "0"}]}], ",", 
   "\[IndentingNewLine]", "yield", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$0", "=", 
     RowBox[{"$", "=", 
      RowBox[{"$pass", "/.", "$s"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "/.", "toEqual"}], "//", 
       RowBox[{"tuArgAdd", "[", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"n", ",", "\"\<d\>\"", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], ",", 
         RowBox[{"{", "t", "}"}]}], "]"}]}], "//", "tuDerivOps2D"}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "NL", ",", "\"\<for variables: \>\"", ",", 
   RowBox[{"$v", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"n", ",", "\"\<d\>\"", ",", 
         RowBox[{"{", "i", "}"}]}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "NL", ",", 
   RowBox[{
   "CR", "[", 
    "\"\<Mathematica cannot solve these equation simultaneously, we do it \
piece meal.\>\"", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$s0", "=", 
     RowBox[{"$s", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"DSolve", "[", 
            RowBox[{
             RowBox[{"$", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"$v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", "t", "}"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"C", "[", "a_", "]"}], "\[Rule]", 
            RowBox[{"C", "[", 
             RowBox[{"a", ",", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DSolve", "[", 
            RowBox[{
             RowBox[{"$", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"$v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", "t", "}"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"C", "[", "a_", "]"}], "\[Rule]", 
            RowBox[{"C", "[", 
             RowBox[{"a", ",", "2"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DSolve", "[", 
            RowBox[{
             RowBox[{"$", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"$v", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"{", "t", "}"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"C", "[", "a_", "]"}], "\[Rule]", 
            RowBox[{"C", "[", 
             RowBox[{"a", ",", "3"}], "]"}]}]}]}], "}"}], "//", 
        RowBox[{"tuArgRemove", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"n", ",", "\"\<d\>\"", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "//", 
       "Flatten"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s0", "]"}]}], 
   ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Eliminate some C[]'s assuming independence of Trig functions: \>\"", 
   ",", "\[IndentingNewLine]", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$1", "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"$0", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", "$s"}], "//", 
       "Expand"}]}]}], ";", 
    RowBox[{"$", "//", "ColumnSumExp"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sin", "[", "_", "]"}], ",", 
           RowBox[{"Cos", "[", "_", "]"}]}], "}"}], ",", "X"}], "]"}], 
       "&"}]}]}], ";", 
    RowBox[{"$", "//", "ColumnSumExp"}], ";", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "//", 
       RowBox[{"tuExtractPattern", "[", 
        RowBox[{"X", "[", "_", "]"}], "]"}]}], "//", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"X", "[", "a_", "]"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", "0"}], ")"}]}]}], "&"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"$s1", "=", 
    RowBox[{"$s", "=", 
     RowBox[{"tuRuleSolve", "[", 
      RowBox[{
       RowBox[{"$", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}], ",", 
       RowBox[{"C", "[", 
        RowBox[{"_", ",", "_"}], "]"}]}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "//", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$s2", "=", 
     RowBox[{"$s", "=", 
      RowBox[{"tuRuleSolve", "[", 
       RowBox[{
        RowBox[{"$", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"C", "[", 
         RowBox[{"_", ",", "_"}], "]"}]}], "]"}]}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "/.", "$s"}], "//", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{"Part", "[", 
      RowBox[{"$", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{"$", "//", 
       RowBox[{"tuExtractPattern", "[", 
        RowBox[{"C", "[", 
         RowBox[{"_", ",", "_"}], "]"}], "]"}]}], "//", 
      "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{"$s", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"$", "/.", "toEqual"}], ",", "$s"}], "]"}], "//", 
      "Flatten"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"$s", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$s", ",", "$s1", ",", "$s2"}], "}"}], "//", "Flatten"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$s", "]"}]}], 
   ",", "\[IndentingNewLine]", "\"\<PON\>\"", ",", "\[IndentingNewLine]", 
   "Imply", ",", 
   RowBox[{
    RowBox[{"$2", "=", 
     RowBox[{"$", "=", 
      RowBox[{"$s0", "/.", "$s"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], ",",
    "\[IndentingNewLine]", "NL", ",", "\"\<\[Bullet] Using \>\"", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{"a_", "^", "2"}], "\[Rule]", " ", 
     RowBox[{
      RowBox[{"cc", "[", "a", "]"}], " ", "a"}]}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"$0", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "/.", "$s"}], "/.", "$"}], "//", 
     RowBox[{"tuConjugateTransposeSimplify", "[", 
      RowBox[{"{", 
       RowBox[{"t", ",", "\[Lambda]", ",", "S", ",", 
        RowBox[{"C", "[", "__", "]"}], ",", 
        RowBox[{"Tensor", "[", "__", "]"}]}], "}"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", "NL", ",", 
   "\"\<This equation should not vary with t \>\"", ",", 
   "\[IndentingNewLine]", "Imply", ",", 
   RowBox[{"$s", "=", 
    RowBox[{
     RowBox[{"C", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
     RowBox[{"C", "[", 
      RowBox[{"1", ",", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", "Yield",
    ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{"$", "/.", "$s"}], "//", "Simplify"}]}], ",", "CK", ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$sc", "=", 
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"tuRuleSolve", "[", 
        RowBox[{"$", ",", 
         RowBox[{"C", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "]"}], "//", "Last"}]}]}], ";", 
    RowBox[{"$", "//", "Framed"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<The EOM: \>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"68", ",", "2"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"$2", "/.", "$s"}], "//", "TrigToExp"}], "//", 
         "Simplify"}]}], ",", "$sc"}], "}"}]}], ";", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}], "//",
      "Framed"}]}], ",", 
   RowBox[{"CG", "[", "\"\<e[68,2]\>\"", "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7952789051152678`*^9, 3.7952790434368563`*^9}, {
   3.795279517498657*^9, 3.7952800960292053`*^9}, {3.7952801477129*^9, 
   3.79528018663445*^9}, {3.7952802347936087`*^9, 3.7952802403774433`*^9}, {
   3.795280420174638*^9, 3.7952804784364634`*^9}, 3.79528070865841*^9, {
   3.79528128913197*^9, 3.795281293424749*^9}, {3.795281344203753*^9, 
   3.7952814189630013`*^9}, {3.795281493643669*^9, 3.795281497773107*^9}, {
   3.7952815441112328`*^9, 3.7952815614776917`*^9}, {3.795281610858432*^9, 
   3.7952816815728273`*^9}, {3.795281726060649*^9, 3.79528176735378*^9}, {
   3.795281825636435*^9, 3.795281862818809*^9}, {3.795281900118504*^9, 
   3.795281940651546*^9}, {3.7952820276445417`*^9, 3.7952820582878036`*^9}, {
   3.795282104206472*^9, 3.795282112168387*^9}, {3.79528222308775*^9, 
   3.795282231413353*^9}, {3.79528233666967*^9, 3.7952823371919394`*^9}, {
   3.795282399646121*^9, 3.795282499520043*^9}, {3.795282532739872*^9, 
   3.795282534930485*^9}, {3.795282667438841*^9, 3.79528269783814*^9}, {
   3.795884239411888*^9, 3.795884273866304*^9}, {3.795884584810811*^9, 
   3.795884644638935*^9}, {3.7958847314289618`*^9, 3.795884768977889*^9}, {
   3.795884944600617*^9, 3.79588500961987*^9}, {3.795885042956974*^9, 
   3.7958850953717327`*^9}, {3.796061484043674*^9, 3.7960614860704327`*^9}, {
   3.796061648234723*^9, 3.796061657224792*^9}, {3.796237354268156*^9, 
   3.7962373573121767`*^9}, {3.7964702730048018`*^9, 
   3.7964703055460453`*^9}, {3.796470351614709*^9, 3.7964703880801497`*^9}, {
   3.79647043086384*^9, 3.796470435319772*^9}, 3.796470522695488*^9, {
   3.796473884824274*^9, 3.79647390183379*^9}, {3.796473964209407*^9, 
   3.796474021186154*^9}, {3.7964742323625927`*^9, 3.796474316039757*^9}, {
   3.796475444402111*^9, 3.7964755851923113`*^9}, {3.796475620617525*^9, 
   3.796475631032325*^9}, {3.7964757061292143`*^9, 3.79647571748636*^9}, {
   3.7964773371016808`*^9, 3.796477363975725*^9}, {3.796651532472417*^9, 
   3.7966515615380173`*^9}, {3.796753413537723*^9, 3.796753424983775*^9}, {
   3.7984769987549458`*^9, 
   3.798477025498851*^9}},ExpressionUUID->"a43d0637-c6e2-43c6-8aa0-\
0c242bdfe7d0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Compute EOM from e[68.1]:\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "S"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         InterpretationBox[
          SubsuperscriptBox["n", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "+", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         InterpretationBox[
          SubsuperscriptBox["n", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}]}], ")"}]}], "-", 
     RowBox[{"\[Lambda]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          InterpretationBox[
           SubsuperscriptBox["n", "1", 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          InterpretationBox[
           SubsuperscriptBox["n", "2", 
            StyleBox["2",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          InterpretationBox[
           SubsuperscriptBox["n", "3", 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ")"}], "2"]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", 
      RowBox[{"Det", "[", 
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", "x", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]],
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Theta]",
            "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Theta], $CellContext`y],
          Editable->False,
          SyntaxForm->Automatic], " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Rho]", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Rho], $CellContext`x],
          Editable->False,
          SyntaxForm->Automatic]}], "-", 
        RowBox[{
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Theta]",
            "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Theta], $CellContext`x],
          Editable->False,
          SyntaxForm->Automatic], " ", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Rho]", 
           "]"}],
          $CellContext`tuDDown[
          "\[PartialD]"][$CellContext`\[Rho], $CellContext`y],
          Editable->False,
          SyntaxForm->Automatic]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
               InterpretationBox[
                SubsuperscriptBox["n", "1", 
                 StyleBox["1",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                1}], $CellContext`\[Rho]],
              Editable->False,
              SyntaxForm->Automatic]}], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               3}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic]}], "+", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               3}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", "1", 
                  StyleBox["1",
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 1}], $CellContext`\[Theta]],
               Editable->False,
               SyntaxForm->Automatic], "-", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", "2", 
                  StyleBox["2",
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 2}], $CellContext`\[Theta]],
               Editable->False,
               SyntaxForm->Automatic]}], ")"}], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               3}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}]}], "+", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               1}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic]}], "-", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               1}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic]}], "+", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               3}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic]}], "-", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "2", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               2}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "3", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               3}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic]}]}], ")"}]}], "+", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               1}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            RowBox[{"(", 
             RowBox[{
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", "2", 
                  StyleBox["2",
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 2}], $CellContext`\[Theta]],
               Editable->False,
               SyntaxForm->Automatic], "-", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", "3", 
                  StyleBox["3",
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 3}], $CellContext`\[Theta]],
               Editable->False,
               SyntaxForm->Automatic]}], ")"}]}], "+", 
           RowBox[{
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               1}], $CellContext`\[Theta]],
             Editable->False,
             SyntaxForm->Automatic], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               InterpretationBox[
                RowBox[{
                 SubscriptBox[
                  UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
                 
                 InterpretationBox[
                  SubsuperscriptBox["n", "2", 
                   StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False]],
                  $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                   2}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], "]"}],
                $CellContext`tuDDown["\[PartialD]"][
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], $CellContext`\[Rho]],
                Editable->False,
                SyntaxForm->Automatic]}], "+", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", "3", 
                  StyleBox["3",
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 3}], $CellContext`\[Rho]],
               Editable->False,
               SyntaxForm->Automatic]}], ")"}]}]}], ")"}]}]}], ")"}]}]}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Add kinetic terms \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}]}], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "S"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["h", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["h", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["h", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}], ")"}]}], "-", 
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         InterpretationBox[
          SubsuperscriptBox["n", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         InterpretationBox[
          SubsuperscriptBox["n", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "S", " ", 
     RowBox[{"Det", "[", 
      RowBox[{
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", "x", 
         "]"}],
        $CellContext`tuDDown[
        "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"\[Rho]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Theta]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`y],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Rho]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Rho], $CellContext`x],
         Editable->False,
         SyntaxForm->Automatic]}], "-", 
       RowBox[{
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "x"], "[", "\[Theta]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Theta], $CellContext`x],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "y"], "[", "\[Rho]", 
          "]"}],
         $CellContext`tuDDown[
         "\[PartialD]"][$CellContext`\[Rho], $CellContext`y],
         Editable->False,
         SyntaxForm->Automatic]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", "1", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False]],
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], "]"}],
             $CellContext`tuDDown["\[PartialD]"][
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
               1}], $CellContext`\[Rho]],
             Editable->False,
             SyntaxForm->Automatic]}], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic]}], "+", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
               
               InterpretationBox[
                SubsuperscriptBox["n", "1", 
                 StyleBox["1",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                1}], $CellContext`\[Theta]],
              Editable->False,
              SyntaxForm->Automatic], "-", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
               
               InterpretationBox[
                SubsuperscriptBox["n", "2", 
                 StyleBox["2",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                2}], $CellContext`\[Theta]],
              Editable->False,
              SyntaxForm->Automatic]}], ")"}], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic]}]}], ")"}]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic]}], "-", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic]}], "+", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic]}], "-", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic]}]}], ")"}]}], "+", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`\[Rho]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           RowBox[{"(", 
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
               
               InterpretationBox[
                SubsuperscriptBox["n", "2", 
                 StyleBox["2",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                2}], $CellContext`\[Theta]],
              Editable->False,
              SyntaxForm->Automatic], "-", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
               
               InterpretationBox[
                SubsuperscriptBox["n", "3", 
                 StyleBox["3",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                3}], $CellContext`\[Theta]],
              Editable->False,
              SyntaxForm->Automatic]}], ")"}]}], "+", 
          RowBox[{
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Theta]"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`\[Theta]],
            Editable->False,
            SyntaxForm->Automatic], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", "2", 
                  StyleBox["2",
                   StripOnInput->False,
                   ShowContents->False]],
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                 2}], $CellContext`\[Rho]],
               Editable->False,
               SyntaxForm->Automatic]}], "+", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Rho]"], "[", 
               InterpretationBox[
                SubsuperscriptBox["n", "3", 
                 StyleBox["3",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
                
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False], "]"}],
              $CellContext`tuDDown["\[PartialD]"][
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                3}], $CellContext`\[Rho]],
              Editable->False,
              SyntaxForm->Automatic]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] from tuEulerEquation: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "S"}], " ", 
          InterpretationBox[
           SubsuperscriptBox["h", "1", 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {1}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         RowBox[{"2", " ", "\[Lambda]", " ", 
          InterpretationBox[
           SubsuperscriptBox["n", "1", 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "1", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              1}], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "\[Rule]", "0"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "S"}], " ", 
          InterpretationBox[
           SubsuperscriptBox["h", "2", 
            StyleBox["2",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {2}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         RowBox[{"2", " ", "\[Lambda]", " ", 
          InterpretationBox[
           SubsuperscriptBox["n", "2", 
            StyleBox["2",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "2", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "\[Rule]", "0"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "S"}], " ", 
          InterpretationBox[
           SubsuperscriptBox["h", "3", 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         RowBox[{"2", " ", "\[Lambda]", " ", 
          InterpretationBox[
           SubsuperscriptBox["n", "3", 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         InterpretationBox[
          RowBox[{
           SubscriptBox[
            UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
             InterpretationBox[
              SubsuperscriptBox["n", "3", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False]],
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              3}], $CellContext`t],
            Editable->False,
            SyntaxForm->Automatic], "]"}],
          $CellContext`tuDDown["\[PartialD]"][
           $CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`t], $CellContext`t],
          Editable->False,
          SyntaxForm->Automatic]}], "\[Rule]", "0"}]},
      {
       RowBox[{
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ")"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ")"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ")"}], "2"]}], "\[Rule]", "0"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
   Style["Compute EOM from e[68.1]:", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {2, 
    1} -> -$CellContext`S ($CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {
         1}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
         2}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
         3}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}]) - $CellContext`\[Lambda] (-1 + \
$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        1}]^2 + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}]^2 + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}]^2) + Complex[0, 
       Rational[1, 2]] $CellContext`S 
     Det[$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> \
$CellContext`\[Rho] Cos[$CellContext`\[Theta]]] ($CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] \
$CellContext`tuDDown[
        "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] - \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Rho], $CellContext`y]) \
($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}] (-$CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]] + $CellContext`tuDDown[
          "\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]] + ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             1}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]]) $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] ($CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]] - $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]] - $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] ($CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Rho]] ($CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Theta]]) + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Theta]] (-$CellContext`tuDDown[
            "\[PartialD]"][
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
              2}], $CellContext`\[Rho]] + $CellContext`tuDDown[
           "\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             3}], $CellContext`\[Rho]]))), 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Add kinetic terms ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Rational[1, 2] $CellContext`tuDDown["\[PartialD]"][
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        1}], $CellContext`t]^2 + 
   Rational[1, 2] $CellContext`tuDDown["\[PartialD]"][
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}], $CellContext`t]^2 + 
   Rational[1, 2] $CellContext`tuDDown["\[PartialD]"][
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}], $CellContext`t]^2, -$CellContext`S \
($CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
        1}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        1}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
        2}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}] + $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
        3}] $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}]) - $CellContext`\[Lambda] (-1 + \
$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
       1}]^2 + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
       2}]^2 + $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
       3}]^2) + Rational[1, 2] $CellContext`tuDDown["\[PartialD]"][
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        1}], $CellContext`t]^2 + 
   Rational[1, 2] $CellContext`tuDDown["\[PartialD]"][
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        2}], $CellContext`t]^2 + 
   Rational[1, 2] $CellContext`tuDDown["\[PartialD]"][
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}], $CellContext`t]^2 + Complex[0, 
      Rational[1, 2]] $CellContext`S 
    Det[$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`x, $CellContext`\[Theta]] -> $CellContext`\
\[Rho] Cos[$CellContext`\[Theta]]] ($CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Theta], $CellContext`y] \
$CellContext`tuDDown[
       "\[PartialD]"][$CellContext`\[Rho], $CellContext`x] - \
$CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Theta], $CellContext`x] \
$CellContext`tuDDown[
      "\[PartialD]"][$CellContext`\[Rho], $CellContext`y]) \
($CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
        3}] (-$CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Theta]] + $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Theta]] + ($CellContext`tuDDown[
          "\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            1}], $CellContext`\[Theta]] - $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Theta]]) $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] ($CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           2}], $CellContext`\[Rho]] $CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Theta]] - $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}], $CellContext`\[Theta]] $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}], $CellContext`\[Rho]]) + $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] ($CellContext`tuDDown["\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}], $CellContext`\[Rho]] ($CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            2}], $CellContext`\[Theta]] - $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           3}], $CellContext`\[Theta]]) + $CellContext`tuDDown[
         "\[PartialD]"][
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
           1}], $CellContext`\[Theta]] (-$CellContext`tuDDown["\[PartialD]"][
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
             2}], $CellContext`\[Rho]] + $CellContext`tuDDown["\[PartialD]"][
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
            3}], $CellContext`\[Rho]]))), 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] from tuEulerEquation: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{-$CellContext`S $CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {1}] - 
       2 $CellContext`\[Lambda] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}] - $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          1}], $CellContext`t], $CellContext`t] -> 
      0}, {-$CellContext`S $CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {2}] - 
       2 $CellContext`\[Lambda] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] - $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          2}], $CellContext`t], $CellContext`t] -> 
      0}, {-$CellContext`S $CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {3}] - 
       2 $CellContext`\[Lambda] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] - $CellContext`tuDDown["\[PartialD]"][
        $CellContext`tuDDown["\[PartialD]"][
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
          3}], $CellContext`t], $CellContext`t] -> 0}, {
     1 - $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}]^2 - $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}]^2 - $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}]^2 -> 0}}, Dividers -> {{True}, {False}}, FrameStyle -> 
    Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885502096777`*^9, 3.800188913519636*^9, 
  3.800267852925325*^9},ExpressionUUID->"74fa1f92-bc28-42d1-95c5-\
be124f1dec7f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"We solve these equations assuming: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["h", 
      RowBox[{"1", "|", "2"}], 
      StyleBox[
       RowBox[{"1", "|", "2"}],
       StripOnInput->False,
       ShowContents->False]],
     $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
       Alternatives[1, 2]}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", "0"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Lambda]", " ", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", "t", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            InterpretationBox[
             SubsuperscriptBox["n", "1", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ")"}], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Lambda]", " ", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", "t", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            InterpretationBox[
             SubsuperscriptBox["n", "2", 
              StyleBox["2",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ")"}], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "S"}], " ", 
          InterpretationBox[
           SubsuperscriptBox["h", "3", 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "-", 
         RowBox[{"2", " ", "\[Lambda]", " ", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", "t", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            InterpretationBox[
             SubsuperscriptBox["n", "3", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ")"}], "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "\[Equal]", "0"}]},
      {
       RowBox[{
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "1", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "2", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", "t", "]"}], "2"]}], "\[Equal]", "0"}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"for variables: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", "1", 
        StyleBox["1",
         StripOnInput->False,
         ShowContents->False]],
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "[", "t", "]"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", "2", 
        StyleBox["2",
         StripOnInput->False,
         ShowContents->False]],
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "[", "t", "]"}], ",", 
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["n", "3", 
        StyleBox["3",
         StripOnInput->False,
         ShowContents->False]],
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], "[", "t", "]"}]}], "}"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Mathematica cannot solve these equation simultaneously, we \
do it piece meal.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"2", ",", "1"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}]}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "2"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}]}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "3"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"2", ",", "3"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}], "-", 
         FractionBox[
          RowBox[{"S", " ", 
           InterpretationBox[
            SubsuperscriptBox["h", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"2", " ", "\[Lambda]"}]]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Eliminate some C[]'s assuming independence of Trig \
functions: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "1", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}]}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "2", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "1"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"2", ",", "2"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}], "]"}]}]}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["n", "3", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False]],
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "\[Rule]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"S", " ", 
           InterpretationBox[
            SubsuperscriptBox["h", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], 
          RowBox[{"2", " ", "\[Lambda]"}]]}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Using \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox["a_", "2"], "\[Rule]", 
    RowBox[{"a", " ", 
     InterpretationBox[
      SuperscriptBox["a", "*"],
      Conjugate[$CellContext`a],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        RowBox[{
         SqrtBox["2"], " ", "t", " ", 
         SqrtBox["\[Lambda]"]}], "]"}], "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"C", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{
         SqrtBox["2"], " ", "t", " ", 
         SqrtBox["\[Lambda]"]}], "]"}], "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["S", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         InterpretationBox[
          SubsuperscriptBox["h", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ")"}], "2"]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Lambda]", "2"]}]]}], "\[Rule]", "0"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"This equation should not vary with t \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[Implies] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"C", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
    RowBox[{"C", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "2"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["S", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         InterpretationBox[
          SubsuperscriptBox["h", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ")"}], "2"]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Lambda]", "2"]}]]}], "\[Rule]", "0"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\[LongLeftArrow]CHECK\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    RowBox[{
     RowBox[{"C", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["S", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           InterpretationBox[
            SubsuperscriptBox["h", "3", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ")"}], "2"]}]}]], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "\[Lambda]"}]]}],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"The EOM: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   FrameBox[
    TagBox[GridBox[{
       {
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Rule]", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}]], " ", 
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "1"}], "]"}]}]}]},
       {
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Rule]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SqrtBox["2"], " ", "t", " ", 
            SqrtBox["\[Lambda]"]}]], " ", 
          RowBox[{"C", "[", 
           RowBox[{"1", ",", "1"}], "]"}]}]}]},
       {
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[Rule]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"S", " ", 
            InterpretationBox[
             SubsuperscriptBox["h", "3", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], 
           RowBox[{"2", " ", "\[Lambda]"}]]}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\"e[68,2]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 
      Rational[2, 3], 0],
    FrontFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    BackFaceColor->RGBColor[0, 
      Rational[2, 3], 0],
    GraphicsColor->RGBColor[0, 
      Rational[2, 3], 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 
      Rational[2, 3], 0]]}],
  SequenceForm[
   Style["We solve these equations assuming: ", 
    RGBColor[0.7, 0, 1, 1], 
    Larger], $CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {
      Alternatives[1, 2]}] -> 0, 
   Style[" \[LongRightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{(-2) $CellContext`\[Lambda] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {1}][$CellContext`t] - Derivative[2][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}]][$CellContext`t] == 
      0}, {(-2) $CellContext`\[Lambda] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}][$CellContext`t] - Derivative[2][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}]][$CellContext`t] == 
      0}, {-$CellContext`S $CellContext`Tensor[$CellContext`h, \
{$CellContext`Void}, {3}] - 
       2 $CellContext`\[Lambda] $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}][$CellContext`t] - Derivative[2][
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}]][$CellContext`t] == 0}, {
     1 - $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         1}][$CellContext`t]^2 - $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {
         2}][$CellContext`t]^2 - $CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}][$CellContext`t]^2 == 0}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["for variables: ", 
    RGBColor[0.7, 0, 1, 1], Larger], {
    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
     1}][$CellContext`t], 
    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
     2}][$CellContext`t], 
    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
     3}][$CellContext`t]}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Mathematica cannot solve these equation simultaneously, we do it \
piece meal.", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Grid[{{$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}] -> 
      C[1, 1] Cos[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]] + 
       C[2, 1] Sin[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[
            1, 2]]}, {$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] -> 
      C[1, 2] Cos[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]] + 
       C[2, 2] Sin[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[
            1, 2]]}, {$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] -> 
      C[1, 3] Cos[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]] + 
       C[2, 3] Sin[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]] + 
       Rational[-1, 
          2] $CellContext`S $CellContext`\[Lambda]^(-1) \
$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Eliminate some C[]'s assuming independence of Trig functions: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Grid[{{$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}] -> 
      C[1, 1] Cos[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]] + 
       Complex[0, -1] C[2, 2] 
        Sin[2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[
            1, 2]]}, {$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {2}] -> 
      Complex[0, 1] C[1, 1] 
        Cos[2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]] + 
       C[2, 2] Sin[
         2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[
            1, 2]]}, {$CellContext`Tensor[$CellContext`n, \
{$CellContext`Void}, {3}] -> 
      Rational[-1, 
         2] $CellContext`S $CellContext`\[Lambda]^(-1) \
$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}]}}, 
    Dividers -> {{True}, {False}}, FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\[Bullet] Using ", 
    RGBColor[0.7, 0, 1, 1], Larger], Pattern[$CellContext`a, 
      Blank[]]^2 -> $CellContext`a Conjugate[$CellContext`a], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   1 - 2 C[1, 1]^2 
    Cos[2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
        Rational[1, 2]]^2 - 2 C[2, 2]^2 
    Sin[2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
        Rational[1, 2]]^2 + 
    Rational[-1, 
       4] $CellContext`S^2 $CellContext`\[Lambda]^(-2) \
$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}]^2 -> 0, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["This equation should not vary with t ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], C[2, 2] -> C[1, 1], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   1 - 2 C[1, 1]^2 + 
    Rational[-1, 
       4] $CellContext`S^2 $CellContext`\[Lambda]^(-2) \
$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}]^2 -> 0, 
   Style["\[LongLeftArrow]CHECK", 
    RGBColor[1, 0, 0], FontFamily -> "Helvetica"], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Framed[
   C[1, 1] -> Rational[1, 2] 
     2^Rational[-1, 2] $CellContext`\[Lambda]^(-1) (
       4 $CellContext`\[Lambda]^2 - $CellContext`S^2 \
$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}]^2)^
      Rational[1, 2]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The EOM: ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Framed[
    Grid[{{$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}] -> 
       E^(Complex[0, -1] 
          2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]) 
        C[1, 1]}, {$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         2}] -> Complex[0, 1] 
        E^(Complex[0, -1] 
          2^Rational[1, 2] $CellContext`t $CellContext`\[Lambda]^
           Rational[1, 2]) 
        C[1, 1]}, {$CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
         3}] -> Rational[-1, 
          2] $CellContext`S $CellContext`\[Lambda]^(-1) \
$CellContext`Tensor[$CellContext`h, {$CellContext`Void}, {3}]}}, 
     Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left]], 
   Style["e[68,2]", 
    RGBColor[0, 
     Rational[2, 3], 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885502096777`*^9, 3.800188913519636*^9, 
  3.80026785304136*^9},ExpressionUUID->"4ecc0ffa-e691-4b6a-aa1c-211686d67950"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"CO", "[", 
   RowBox[{
   "\"\<Exercise 7: WZ in 0+1, quantization\n\
\!\(\*StyleBox[\"Show\",FontSize->14,FontSlant->\"Italic\"]\) that the \
classical equations of motion obtained from \!\(\*SubscriptBox[\(S\), \
\(h\)]\) e[68,2] correspond to Heisenberg equations (in real time)\>\"", ",", 
    
    RowBox[{"$p0", "=", 
     RowBox[{
      RowBox[{"tuDPartial", "[", 
       RowBox[{
        OverscriptBox["S", "^"], ",", "t"}], "]"}], "\[Rule]", 
      RowBox[{"I", " ", 
       RowBox[{"CommutatorM", "[", 
        RowBox[{"H", ",", 
         OverscriptBox["S", "^"]}], "]"}]}]}]}], ",", 
    "\"\< for the quantum spin operator \!\(\*OverscriptBox[\(S\), \(^\)]\), \
\>\"", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "[", "69", "]"}], "=", 
       RowBox[{
        RowBox[{"CommutatorM", "[", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"S", ",", "\"\<u\>\"", ",", 
            RowBox[{"{", "a", "}"}]}], "]"}], ",", 
          RowBox[{"T", "[", 
           RowBox[{"S", ",", "\"\<u\>\"", ",", 
            RowBox[{"{", "b", "}"}]}], "]"}]}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", 
         RowBox[{"T", "[", 
          RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], 
         RowBox[{"T", "[", 
          RowBox[{"S", ",", "\"\<u\>\"", ",", 
           RowBox[{"{", "c", "}"}]}], "]"}]}]}]}], "}"}], "[", 
     RowBox[{"CG", "[", "\"\<e[69]\>\"", "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    "\"\< obtained from the Hamiltonian of a spin in magnetic field, \>\"", 
    ",", 
    RowBox[{"$p2", "=", 
     RowBox[{"H", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{"h", ".", 
        OverscriptBox["S", "^"]}]}]}]}], ",", 
    "\"\<. \n\!\(\*StyleBox[\"Obtain\",FontSize->14,FontSlant->\"Italic\"]\) \
the commutation relations of quantum spin e[69] from the topological part \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\).  Notice that this topological action is \
linear in time derivative and, therefore, does not contribute to the \
Hamiltonian.  Nevertheless, it defines commutation relations between \
components of the spin operator.\>\""}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7952831566071253`*^9, 3.795283158157936*^9}, {
  3.7952832644352407`*^9, 3.7952834218496437`*^9}, {3.795283542488229*^9, 
  3.795283598582397*^9}, {3.79528425319851*^9, 3.795284465295142*^9}, {
  3.7965651685461483`*^9, 3.796565173787038*^9}, {3.7966517031860857`*^9, 
  3.7966517286484003`*^9}, {3.7966518304514933`*^9, 3.7966518330563507`*^9}, {
  3.7984764537831697`*^9, 3.7984764544636307`*^9}, {3.7984768723175087`*^9, 
  3.798476877190043*^9}, {3.7984769432216043`*^9, 3.798476944076442*^9}, {
  3.798559692349345*^9, 3.798559696431666*^9}, {3.798559735872151*^9, 
  3.798559741315814*^9}, {3.798635730087386*^9, 3.79863579478111*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"41ce177f-3566-4b14-92fd-678784d2eb56"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 7: WZ in 0+1, \
quantization\\n\\!\\(\\*StyleBox[\\\"Show\\\",FontSize->14,FontSlant->\\\"\
Italic\\\"]\\) that the classical equations of motion obtained from \
\\!\\(\\*SubscriptBox[\\(S\\), \\(h\\)]\\) e[68,2] correspond to Heisenberg \
equations (in real time)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     InterpretationBox[
      RowBox[{
       SubscriptBox[
        UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
       OverscriptBox["S", "^"], "]"}],
      $CellContext`tuDDown["\[PartialD]"][
       OverHat[$CellContext`S], $CellContext`t],
      Editable->False,
      SyntaxForm->Automatic], "\[Rule]", 
     RowBox[{"\[ImaginaryI]", " ", 
      InterpretationBox[
       SubscriptBox[
        RowBox[{"[", "H", ",", 
         OverscriptBox["S", "^"], "]"}], "-"],
       $CellContext`CommutatorM[$CellContext`H, 
        OverHat[$CellContext`S]],
       Editable->False,
       SyntaxForm->Automatic]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" for the quantum spin operator \
\\!\\(\\*OverscriptBox[\\(S\\), \\(^\\)]\\), \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox[
         RowBox[{"[", 
          InterpretationBox[
           SubsuperscriptBox["S", 
            StyleBox["a",
             StripOnInput->False,
             ShowContents->False], "a"],
           $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ",", 
          InterpretationBox[
           SubsuperscriptBox["S", 
            StyleBox["b",
             StripOnInput->False,
             ShowContents->False], "b"],
           $CellContext`Tensor[$CellContext`S, {$CellContext`b}, \
{$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], "]"}], "-"],
        $CellContext`CommutatorM[
         $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {$CellContext`b}, \
{$CellContext`Void}]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["c",
           StripOnInput->False,
           ShowContents->False], "c"],
         $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], " ", 
        InterpretationBox[
         SubsuperscriptBox["\[Epsilon]", 
          StyleBox[
           RowBox[{"a", "b", "c"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"a", "b", "c"}]],
         $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`b, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}], "}"}], "[", 
     StyleBox["\<\"e[69]\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0, 
        Rational[2, 3], 0],
      FrontFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      BackFaceColor->RGBColor[0, 
        Rational[2, 3], 0],
      GraphicsColor->RGBColor[0, 
        Rational[2, 3], 0],
      FontFamily->"Helvetica",
      FontColor->RGBColor[0, 
        Rational[2, 3], 0]], "]"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" obtained from the Hamiltonian of a spin in magnetic field, \
\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"H", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"h", ".", 
       OverscriptBox["S", "^"]}]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\". \
\\n\\!\\(\\*StyleBox[\\\"Obtain\\\",FontSize->14,FontSlant->\\\"Italic\\\"]\\)\
 the commutation relations of quantum spin e[69] from the topological part \
\\!\\(\\*SubscriptBox[\\(S\\), \\(WZ\\)]\\).  Notice that this topological \
action is linear in time derivative and, therefore, does not contribute to \
the Hamiltonian.  Nevertheless, it defines commutation relations between \
components of the spin operator.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 7: WZ in 0+1, quantization\n\
\!\(\*StyleBox[\"Show\",FontSize->14,FontSlant->\"Italic\"]\) that the \
classical equations of motion obtained from \!\(\*SubscriptBox[\(S\), \
\(h\)]\) e[68,2] correspond to Heisenberg equations (in real time)", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[$CellContext`tuDDown["\[PartialD]"][
      OverHat[$CellContext`S], $CellContext`t] -> 
    Complex[0, 1] $CellContext`CommutatorM[$CellContext`H, 
       OverHat[$CellContext`S]], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" for the quantum spin operator \!\(\*OverscriptBox[\(S\), \(^\)]\), \
", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    {$CellContext`CommutatorM[
       $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {$CellContext`b}, \
{$CellContext`Void}]] -> 
     Complex[0, 
        1] $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`a, $CellContext`b, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}]}[
     Style["e[69]", 
      RGBColor[0, 
       Rational[2, 3], 0], FontFamily -> "Helvetica"]], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" obtained from the Hamiltonian of a spin in magnetic field, ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[$CellContext`H -> -Dot[$CellContext`h, 
       OverHat[$CellContext`S]], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[". \n\!\(\*StyleBox[\"Obtain\",FontSize->14,FontSlant->\"Italic\"]\) \
the commutation relations of quantum spin e[69] from the topological part \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\).  Notice that this topological action is \
linear in time derivative and, therefore, does not contribute to the \
Hamiltonian.  Nevertheless, it defines commutation relations between \
components of the spin operator.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188550496355*^9, 3.8001889140064077`*^9, 
  3.800267853180003*^9},ExpressionUUID->"e53d86fc-74e1-48cd-af1e-\
826dbbcf739c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"\"\<Compute Hamilton's EOM: \>\"", ",", 
   RowBox[{"$", "=", "$p0"}], ",", "\[IndentingNewLine]", "NL", ",", 
   "\"\<Compute EOM with \>\"", ",", 
   RowBox[{
    RowBox[{"$s", "=", 
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{"$p2", ",", 
        RowBox[{
         RowBox[{"e", "[", "69", "]"}], "//", 
         RowBox[{"tuAddPatternVariable", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"$ss", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            OverscriptBox["S", "^"], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"S", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"h", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"h", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"$sh", "=", 
         RowBox[{
          RowBox[{"h", ".", 
           OverscriptBox["S", "^"]}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"h", ".", 
               OverscriptBox["S", "^"]}], "/.", "$ss"}], ")"}], "//", 
            "Flatten"}], ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ColumnForms", "[", 
        RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", 
     RowBox[{"$", "//", "MatrixForms"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "NL", ",", "\"\<Compute Hamilton's EOM: \>\"", ",", 
   
   RowBox[{"$", "=", "$p0"}], ",", "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"$", "/.", 
        RowBox[{
         RowBox[{"tuRuleSelect", "[", 
          RowBox[{"{", "H", "}"}], "]"}], "[", "$s", "]"}]}], "/.", "$sh"}], "/.", 
      RowBox[{
       RowBox[{"tuRuleSelect", "[", 
        OverscriptBox["S", "^"], "]"}], "[", "$s", "]"}]}]}], ";", "$"}], ",",
    "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{
    RowBox[{"$", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"List", "[", 
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], "]"}], ":>", 
      RowBox[{"Plus", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", 
      RowBox[{"tuCommutatorSimplify", "[", 
       RowBox[{"{", 
        RowBox[{"Tensor", "[", 
         RowBox[{"h", ",", "__"}], "]"}], "}"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"$", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", 
      RowBox[{"tuOpDistributeF", "[", 
       RowBox[{"tuDPartial", ",", "List"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "Yield"}], ",", "$", ",", "\[IndentingNewLine]", 
   "Yield", ",", 
   RowBox[{
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$", "//.", 
       RowBox[{"tuOpDistribute", "[", 
        RowBox[{"CommutatorM", ",", "List"}], "]"}]}], "/.", 
      RowBox[{
       RowBox[{"tuRuleSelect", "[", 
        RowBox[{"CommutatorM", "[", "__", "]"}], "]"}], "[", "$s", "]"}]}]}], 
    ";", "\[IndentingNewLine]", "NL"}], ",", 
   "\"\<Let the Magnetic field be only along z-axis: \>\"", ",", 
   RowBox[{"$sh", "=", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"h", ",", "\"\<u\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1", "|", "2"}], "}"}]}], "]"}], "\[Rule]", "0"}]}], ",", 
   "\[IndentingNewLine]", "Yield", ",", 
   RowBox[{"$", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"$", "/.", "$sh"}], "//", "Simplify"}], "//", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{
         RowBox[{"ee", ":", 
          RowBox[{"T", "[", 
           RowBox[{"\[Epsilon]", ",", "\"\<uuu\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}]}], 
         "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"tuLeviCivitaNumeric", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "[", 
          "ee", "]"}]}]}], "&"}], ")"}]}]}], ",", "\[IndentingNewLine]", "NL",
    ",", 
   RowBox[{
   "CB", "[", "\"\<which is the same as the classical EOM.\[HappySmiley]\>\"",
     "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.796651447236343*^9, 3.796651451977714*^9}, {
   3.7966515741552*^9, 3.796651574331163*^9}, {3.796651604714385*^9, 
   3.796651625684573*^9}, {3.7966516580513573`*^9, 3.796651671672002*^9}, {
   3.796651737227264*^9, 3.7966517822854633`*^9}, {3.796651839574238*^9, 
   3.796651889096732*^9}, {3.796652040196327*^9, 3.7966520716659307`*^9}, {
   3.796652572431677*^9, 3.796652750036619*^9}, {3.796652936238299*^9, 
   3.7966529549257183`*^9}, {3.7966530394321213`*^9, 3.796653043823812*^9}, {
   3.796653231171836*^9, 3.79665331854023*^9}, {3.7966533513982077`*^9, 
   3.796653415971518*^9}, {3.79665344943437*^9, 3.796653467146345*^9}, {
   3.796653499380231*^9, 3.7966536025930347`*^9}, {3.796653803668604*^9, 
   3.796653804281671*^9}, {3.79665395603197*^9, 3.7966539990487556`*^9}, {
   3.796654070801346*^9, 3.7966540749790688`*^9}, {3.79665413463122*^9, 
   3.79665415043785*^9}, {3.7966541845412903`*^9, 3.7966542337977333`*^9}, {
   3.796654264465686*^9, 3.796654292065558*^9}, {3.796654565346916*^9, 
   3.796654935484079*^9}, 3.796654978682073*^9, {3.7966550268251877`*^9, 
   3.7966550277447033`*^9}, 3.796655079855102*^9, {3.7966560620888767`*^9, 
   3.7966560842560463`*^9}, 3.796656193346384*^9, {3.796656238194278*^9, 
   3.796656242127885*^9}, {3.79665635175865*^9, 3.7966565644597387`*^9}, {
   3.796656735339817*^9, 3.79665673731861*^9}, {3.796656940805834*^9, 
   3.796656944893703*^9}, {3.7966570319549627`*^9, 3.7966570411436157`*^9}, {
   3.796657081286662*^9, 3.7966571051732492`*^9}, {3.796657204168298*^9, 
   3.79665722099681*^9}, {3.796663350363887*^9, 3.796663384210044*^9}, {
   3.7966697032063313`*^9, 3.7966697183142223`*^9}, {3.796669749210175*^9, 
   3.796669775110034*^9}, {3.7967313183466253`*^9, 3.796731389232705*^9}, {
   3.796731435814245*^9, 3.796731541279662*^9}, {3.796731573756699*^9, 
   3.796731597420393*^9}, {3.796731627874545*^9, 3.79673179532691*^9}, {
   3.796731835102961*^9, 3.7967319013178177`*^9}, {3.7967320180806932`*^9, 
   3.796732056429201*^9}, 3.796732273211708*^9, {3.796732319896908*^9, 
   3.796732333528791*^9}, 3.796732461421186*^9, {3.796732496635253*^9, 
   3.79673252241905*^9}, {3.796732698929345*^9, 3.796732742335248*^9}, {
   3.796733829204885*^9, 3.796733866525958*^9}, {3.796733907203651*^9, 
   3.796733961234234*^9}, {3.7967339919584703`*^9, 3.79673400341269*^9}, {
   3.7967340358188*^9, 3.796734086764042*^9}, {3.7967345534057417`*^9, 
   3.7967345583661423`*^9}, {3.796734610692995*^9, 3.796734642698703*^9}, {
   3.796734679516774*^9, 3.796734690035842*^9}, {3.796734876559654*^9, 
   3.796734950493188*^9}, {3.79673498307058*^9, 3.796735017751032*^9}, {
   3.796735060709593*^9, 3.796735097063693*^9}, {3.796735268786704*^9, 
   3.796735388901432*^9}, {3.796735424433401*^9, 3.796735565746992*^9}, {
   3.796735598312632*^9, 3.7967356515486803`*^9}, {3.796735686657693*^9, 
   3.796735782796191*^9}, {3.7967358726191893`*^9, 3.796735875137*^9}, {
   3.7967359737926273`*^9, 3.796735974801058*^9}, {3.796736051727786*^9, 
   3.7967362159790697`*^9}, 3.796736268245912*^9, {3.796736466214881*^9, 
   3.796736466795684*^9}, {3.796736525099063*^9, 3.796736573246468*^9}, {
   3.796736790436881*^9, 3.796737016474369*^9}, {3.796737067101053*^9, 
   3.796737085525255*^9}, {3.796737125576354*^9, 3.7967371461944304`*^9}, {
   3.7967372554015408`*^9, 3.7967373095207243`*^9}, {3.796737347689248*^9, 
   3.796737354717073*^9}, {3.7967374780374823`*^9, 3.796737483801017*^9}, {
   3.798476502958343*^9, 3.798476517827813*^9}, {3.7984770982814198`*^9, 
   3.7984771221935*^9}, {3.798477546259281*^9, 3.798477546431367*^9}, {
   3.798477581144874*^9, 3.798477585040189*^9}, {3.798477646850301*^9, 
   3.798477650384959*^9}, {3.79854793411438*^9, 3.798547985114518*^9}, {
   3.7985480352726097`*^9, 3.7985480439920177`*^9}, {3.798548098537197*^9, 
   3.7985481346659737`*^9}, {3.798548223445072*^9, 3.798548277986339*^9}, {
   3.7985483319605017`*^9, 3.798548353673108*^9}, {3.798548433792494*^9, 
   3.7985484865400753`*^9}, {3.798548649305285*^9, 3.7985488304400673`*^9}, {
   3.798550329217621*^9, 3.7985503638705587`*^9}, {3.798550413799816*^9, 
   3.798550475092404*^9}, {3.79855050673468*^9, 3.798550604144697*^9}, {
   3.798550644120743*^9, 3.79855068609562*^9}, {3.7985512148224077`*^9, 
   3.7985512339654427`*^9}, {3.798552551556452*^9, 3.798552567114945*^9}, {
   3.7985568751992903`*^9, 3.7985568917676497`*^9}, 3.798556952184578*^9, 
   3.798559735824394*^9},ExpressionUUID->"990dbbf6-d2a4-43ff-81cb-\
471e997ae3cd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Compute Hamilton's EOM: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      OverscriptBox["S", "^"], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      OverHat[$CellContext`S], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubscriptBox[
       RowBox[{"[", "H", ",", 
        OverscriptBox["S", "^"], "]"}], "-"],
      $CellContext`CommutatorM[$CellContext`H, 
       OverHat[$CellContext`S]],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Compute EOM with \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       RowBox[{"H", "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"h", ".", 
          OverscriptBox["S", "^"]}]}]}]},
      {
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          RowBox[{"[", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["a_",
              StripOnInput->False,
              ShowContents->False], "a_"],
            $CellContext`Tensor[$CellContext`S, {
              Pattern[$CellContext`a, 
               Blank[]]}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["b_",
              StripOnInput->False,
              ShowContents->False], "b_"],
            $CellContext`Tensor[$CellContext`S, {
              Pattern[$CellContext`b, 
               Blank[]]}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}], "-"],
         $CellContext`CommutatorM[
          $CellContext`Tensor[$CellContext`S, {
            Pattern[$CellContext`a, 
             Blank[]]}, {$CellContext`Void}], 
          $CellContext`Tensor[$CellContext`S, {
            Pattern[$CellContext`b, 
             Blank[]]}, {$CellContext`Void}]],
         Editable->False,
         SyntaxForm->Automatic], "\[Rule]", 
        RowBox[{"\[ImaginaryI]", " ", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["c",
            StripOnInput->False,
            ShowContents->False], "c"],
          $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         InterpretationBox[
          SubsuperscriptBox["\[Epsilon]", 
           StyleBox[
            RowBox[{"a", "b", "c"}],
            StripOnInput->False,
            ShowContents->False], 
           RowBox[{"a", "b", "c"}]],
          $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`b, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}]}]},
      {
       TagBox[GridBox[{
          {
           RowBox[{
            OverscriptBox["S", "^"], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["1",
                 StripOnInput->False,
                 ShowContents->False], "1"],
               $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ",", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["2",
                 StripOnInput->False,
                 ShowContents->False], "2"],
               $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ",", 
              InterpretationBox[
               SubsuperscriptBox["S", 
                StyleBox["3",
                 StripOnInput->False,
                 ShowContents->False], "3"],
               $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False]}], "}"}]}]},
          {
           RowBox[{"h", "\[Rule]", 
            TagBox[
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {
                 InterpretationBox[
                  SubsuperscriptBox["h", 
                   StyleBox["1",
                    StripOnInput->False,
                    ShowContents->False], "1"],
                  $CellContext`Tensor[$CellContext`h, {
                   1}, {$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], 
                 InterpretationBox[
                  SubsuperscriptBox["h", 
                   StyleBox["2",
                    StripOnInput->False,
                    ShowContents->False], "2"],
                  $CellContext`Tensor[$CellContext`h, {
                   2}, {$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False], 
                 InterpretationBox[
                  SubsuperscriptBox["h", 
                   StyleBox["3",
                    StripOnInput->False,
                    ShowContents->False], "3"],
                  $CellContext`Tensor[$CellContext`h, {
                   3}, {$CellContext`Void}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
             Function[BoxForm`e$, 
              MatrixForm[BoxForm`e$]]]}]}
         },
         AutoDelete->False,
         FrameStyle->Directive[
           RGBColor[0.7, 0, 1, 1], 
           Thickness[Tiny]],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"]},
      {
       RowBox[{
        RowBox[{"h", ".", 
         OverscriptBox["S", "^"]}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False], "1"],
            $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False], "1"],
            $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], "+", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False], "2"],
            $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False], "2"],
            $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], "+", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}]}], "}"}]}]}
     },
     AutoDelete->False,
     FrameStyle->Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]],
     GridBoxAlignment->{"Columns" -> {{Left}}},
     GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Compute Hamilton's EOM: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      OverscriptBox["S", "^"], "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      OverHat[$CellContext`S], $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubscriptBox[
       RowBox[{"[", "H", ",", 
        OverscriptBox["S", "^"], "]"}], "-"],
      $CellContext`CommutatorM[$CellContext`H, 
       OverHat[$CellContext`S]],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], ",", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], ",", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "}"}], "]"}],
     $CellContext`tuDDown["\[PartialD]"][{
       $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {
        3}, {$CellContext`Void}]}, $CellContext`t],
     Editable->False,
     SyntaxForm->Automatic], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     InterpretationBox[
      SubscriptBox[
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            InterpretationBox[
             SubsuperscriptBox["h", 
              StyleBox["1",
               StripOnInput->False,
               ShowContents->False], "1"],
             $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], " ", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False], "1"],
            $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], "-", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False], "2"],
            $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False], "2"],
            $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], "-", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["h", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["S", 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False], "1"],
           $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ",", 
          InterpretationBox[
           SubsuperscriptBox["S", 
            StyleBox["2",
             StripOnInput->False,
             ShowContents->False], "2"],
           $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ",", 
          InterpretationBox[
           SubsuperscriptBox["S", 
            StyleBox["3",
             StripOnInput->False,
             ShowContents->False], "3"],
           $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], "}"}], "]"}], "-"],
      $CellContext`CommutatorM[{-$CellContext`Tensor[$CellContext`h, {
           1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
           1}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
          2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
          2}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
          3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
          3}, {$CellContext`Void}]}, {
        $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}],
      Editable->False,
      SyntaxForm->Automatic]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     SubscriptBox[
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          InterpretationBox[
           SubsuperscriptBox["h", 
            StyleBox["1",
             StripOnInput->False,
             ShowContents->False], "1"],
           $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False]}], " ", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "-", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "-", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["h", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False], "3"],
          $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], " ", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False], "3"],
          $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False], "1"],
          $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ",", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False], "2"],
          $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], ",", 
         InterpretationBox[
          SubsuperscriptBox["S", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False], "3"],
          $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "}"}], "]"}], "-"],
     $CellContext`CommutatorM[-$CellContext`Tensor[$CellContext`h, {
         1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
         1}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
        2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
        2}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
        3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
        3}, {$CellContext`Void}], {
       $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}],
     Editable->False,
     SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`S, {
         1}, {$CellContext`Void}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], ",", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`S, {
         2}, {$CellContext`Void}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], ",", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`S, {
         3}, {$CellContext`Void}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "}"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False], "1"],
              $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False], "2"],
              $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False], "3"],
              $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "}"}], ",", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["1",
              StripOnInput->False,
              ShowContents->False], "1"],
            $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}], "-"],
         $CellContext`CommutatorM[{
           $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}, 
          $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False], "1"],
              $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False], "2"],
              $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False], "3"],
              $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "}"}], ",", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["2",
              StripOnInput->False,
              ShowContents->False], "2"],
            $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}], "-"],
         $CellContext`CommutatorM[{
           $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}, 
          $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox[
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["1",
                StripOnInput->False,
                ShowContents->False], "1"],
              $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["2",
                StripOnInput->False,
                ShowContents->False], "2"],
              $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ",", 
             InterpretationBox[
              SubsuperscriptBox["S", 
               StyleBox["3",
                StripOnInput->False,
                ShowContents->False], "3"],
              $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False]}], "}"}], ",", 
           InterpretationBox[
            SubsuperscriptBox["S", 
             StyleBox["3",
              StripOnInput->False,
              ShowContents->False], "3"],
            $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "]"}], "-"],
         $CellContext`CommutatorM[{
           $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}, 
          $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]],
         Editable->False,
         SyntaxForm->Automatic], " ", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}]}], ")"}]}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"Let the Magnetic field be only along z-axis: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["h", 
      StyleBox[
       RowBox[{"1", "|", "2"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"1", "|", "2"}]],
     $CellContext`Tensor[$CellContext`h, {
       Alternatives[1, 2]}, {$CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], "\[Rule]", "0"}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[RightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontWeight->Bold,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["1",
           StripOnInput->False,
           ShowContents->False], "1"],
         $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`S, {
         1}, {$CellContext`Void}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], ",", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["2",
           StripOnInput->False,
           ShowContents->False], "2"],
         $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`S, {
         2}, {$CellContext`Void}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic], ",", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", 
        InterpretationBox[
         SubsuperscriptBox["S", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        $CellContext`Tensor[$CellContext`S, {
         3}, {$CellContext`Void}], $CellContext`t],
       Editable->False,
       SyntaxForm->Automatic]}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["S", 
         StyleBox["c",
          StripOnInput->False,
          ShowContents->False], "c"],
        $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"1", "3", "c"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"1", "3", "c"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {
         1, 3, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], ",", 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         SubsuperscriptBox["h", 
          StyleBox["3",
           StripOnInput->False,
           ShowContents->False], "3"],
         $CellContext`Tensor[$CellContext`h, {3}, {$CellContext`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], " ", 
       InterpretationBox[
        SubsuperscriptBox["S", 
         StyleBox["c",
          StripOnInput->False,
          ShowContents->False], "c"],
        $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], " ", 
       InterpretationBox[
        SubsuperscriptBox["\[Epsilon]", 
         StyleBox[
          RowBox[{"2", "3", "c"}],
          StripOnInput->False,
          ShowContents->False], 
         RowBox[{"2", "3", "c"}]],
        $CellContext`Tensor[$CellContext`\[Epsilon], {
         2, 3, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False]}], ",", "0"}], "}"}]}], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0.7, 0, 1],
    LineOpacity->1,
    FrontFaceColor->RGBColor[0.7, 0, 1],
    BackFaceColor->RGBColor[0.7, 0, 1],
    FrontFaceOpacity->1,
    BackFaceOpacity->1,
    GraphicsColor->RGBColor[0.7, 0, 1],
    Opacity->1,
    FontSize->Larger,
    FontColor->RGBColor[0.7, 0, 1],
    FontOpacity->1], "\[InvisibleSpace]", 
   StyleBox["\<\"which is the same as the classical EOM.\[HappySmiley]\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontFamily->"Helvetica",
    FontColor->RGBColor[0, 0, 1]]}],
  SequenceForm[
   Style["Compute Hamilton's EOM: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`tuDDown["\[PartialD]"][
     OverHat[$CellContext`S], $CellContext`t] -> 
   Complex[0, 1] $CellContext`CommutatorM[$CellContext`H, 
      OverHat[$CellContext`S]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compute EOM with ", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Grid[{{$CellContext`H -> -Dot[$CellContext`h, 
         OverHat[$CellContext`S]]}, {$CellContext`CommutatorM[
        $CellContext`Tensor[$CellContext`S, {
          Pattern[$CellContext`a, 
           Blank[]]}, {$CellContext`Void}], 
        $CellContext`Tensor[$CellContext`S, {
          Pattern[$CellContext`b, 
           Blank[]]}, {$CellContext`Void}]] -> 
      Complex[0, 
         1] $CellContext`Tensor[$CellContext`S, {$CellContext`c}, \
{$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`a, $CellContext`b, $CellContext`c}, {$CellContext`Void, \
$CellContext`Void, $CellContext`Void}]}, {
      Grid[{{OverHat[$CellContext`S] -> {
           $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
           $CellContext`Tensor[$CellContext`S, {
            3}, {$CellContext`Void}]}}, {$CellContext`h -> MatrixForm[{{
             $CellContext`Tensor[$CellContext`h, {1}, {$CellContext`Void}], 
             $CellContext`Tensor[$CellContext`h, {2}, {$CellContext`Void}], 
             $CellContext`Tensor[$CellContext`h, {
              3}, {$CellContext`Void}]}}]}}, Dividers -> {{True}, {False}}, 
       FrameStyle -> Directive[
         RGBColor[0.7, 0, 1, 1], 
         Thickness[Tiny]], Alignment -> Left]}, {Dot[$CellContext`h, 
        OverHat[$CellContext`S]] -> {$CellContext`Tensor[$CellContext`h, {
           1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
           1}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`h, {
           2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
           2}, {$CellContext`Void}] + $CellContext`Tensor[$CellContext`h, {
           3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
           3}, {$CellContext`Void}]}}}, Dividers -> {{True}, {False}}, 
    FrameStyle -> Directive[
      RGBColor[0.7, 0, 1, 1], 
      Thickness[Tiny]], Alignment -> Left], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Compute Hamilton's EOM: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`tuDDown["\[PartialD]"][
     OverHat[$CellContext`S], $CellContext`t] -> 
   Complex[0, 1] $CellContext`CommutatorM[$CellContext`H, 
      OverHat[$CellContext`S]], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`tuDDown["\[PartialD]"][{
      $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`S, {
       3}, {$CellContext`Void}]}, $CellContext`t] -> 
   Complex[0, 
      1] $CellContext`CommutatorM[{-$CellContext`Tensor[$CellContext`h, {
          1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
          1}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
         2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
         2}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
         3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
         3}, {$CellContext`Void}]}, {
       $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
       $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Complex[0, 
     1] $CellContext`CommutatorM[-$CellContext`Tensor[$CellContext`h, {
        1}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
        1}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
       2}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
       2}, {$CellContext`Void}] - $CellContext`Tensor[$CellContext`h, {
       3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, {
       3}, {$CellContext`Void}], {
      $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}], 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`S, {
       1}, {$CellContext`Void}], $CellContext`t], 
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`S, {
       2}, {$CellContext`Void}], $CellContext`t], 
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`S, {
       3}, {$CellContext`Void}], $CellContext`t]} -> 
   Complex[0, 1] ($CellContext`CommutatorM[{
         $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}, 
        $CellContext`Tensor[$CellContext`S, {
         1}, {$CellContext`Void}]] $CellContext`Tensor[$CellContext`h, {
        1}, {$CellContext`Void}] + $CellContext`CommutatorM[{
         $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}, 
        $CellContext`Tensor[$CellContext`S, {
         2}, {$CellContext`Void}]] $CellContext`Tensor[$CellContext`h, {
        2}, {$CellContext`Void}] + $CellContext`CommutatorM[{
         $CellContext`Tensor[$CellContext`S, {1}, {$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {2}, {$CellContext`Void}], 
         $CellContext`Tensor[$CellContext`S, {3}, {$CellContext`Void}]}, 
        $CellContext`Tensor[$CellContext`S, {
         3}, {$CellContext`Void}]] $CellContext`Tensor[$CellContext`h, {
        3}, {$CellContext`Void}]), 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Let the Magnetic field be only along z-axis: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`Tensor[$CellContext`h, {
      Alternatives[1, 2]}, {$CellContext`Void}] -> 0, 
   Style["\n\[RightArrow] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], {
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`S, {
       1}, {$CellContext`Void}], $CellContext`t], 
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`S, {
       2}, {$CellContext`Void}], $CellContext`t], 
     $CellContext`tuDDown["\[PartialD]"][
      $CellContext`Tensor[$CellContext`S, {
       3}, {$CellContext`Void}], $CellContext`t]} -> \
{-$CellContext`Tensor[$CellContext`h, {
       3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, \
{$CellContext`c}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\
\[Epsilon], {
       1, 3, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}], -$CellContext`Tensor[$CellContext`h, {
       3}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`S, \
{$CellContext`c}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\
\[Epsilon], {
       2, 3, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}], 0}, 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["which is the same as the classical EOM.\[HappySmiley]", 
    RGBColor[0, 0, 1], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188550623475*^9, 3.800188914232923*^9, 
  3.8002678532762127`*^9},ExpressionUUID->"81df8fbb-78b1-4f47-91d7-\
04650d5a9e17"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"e", "[", "69", "]"}], "\[IndentingNewLine]", 
 RowBox[{"e", "[", "66", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"\"\<The variation: \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"$0", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "66", "]"}], "//", "Last"}], "//", 
      RowBox[{"tuIntegralSimplify", "[", "]"}]}]}], ",", 
    "\[IndentingNewLine]", "NL", ",", "\"\<The Wedge can be rewritten: \>\"", 
    ",", "\[IndentingNewLine]", "\"\<POFF\>\"", ",", "\[IndentingNewLine]", 
    "Yield", ",", 
    RowBox[{
     RowBox[{"$1", "=", 
      RowBox[{
       RowBox[{"$0", "//", 
        RowBox[{"tuExtractPattern", "[", 
         RowBox[{"Wedge", "[", "__", "]"}], "]"}]}], "//", "First"}]}], ";", 
     "\[IndentingNewLine]", "Yield"}], ",", 
    RowBox[{"$", "=", 
     RowBox[{
      RowBox[{"$1", "/.", 
       RowBox[{
        RowBox[{"difForm", "[", 
         RowBox[{"nn", ":", 
          RowBox[{"T", "[", 
           RowBox[{"n", ",", "\"\<d\>\"", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "\[Rule]", "nn"}]}], "//", 
      RowBox[{"tuDifFormSimplifydForm", "[", 
       RowBox[{"{", 
        RowBox[{"T", "[", 
         RowBox[{"n", ",", "\"\<d\>\"", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "}"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "\"\<PON\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"$", "=", 
     RowBox[{"$1", "->", 
      RowBox[{"difForm", "[", "$", "]"}]}]}], ",", "\[IndentingNewLine]", 
    "Imply", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$0", "/.", "$"}]}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Apply Gauss's relationship: \>\"", ",", 
    RowBox[{"$", "=", 
     RowBox[{"$", "/.", 
      RowBox[{
       RowBox[{"xIntegral", "[", 
        RowBox[{
         RowBox[{"difForm", "[", "a_", "]"}], ",", "D"}], "]"}], "\[Rule]", 
       RowBox[{"xIntegral", "[", 
        RowBox[{"a", ",", "\"\<\[PartialD]D\>\""}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.798552760869594*^9, 3.798552769591695*^9}, {
   3.798552842689492*^9, 3.798552851454536*^9}, {3.798553022295268*^9, 
   3.798553056312554*^9}, {3.798553117927802*^9, 3.798553122208305*^9}, {
   3.798553159887285*^9, 3.798553165661634*^9}, {3.79855321804587*^9, 
   3.798553225613937*^9}, {3.798598183195804*^9, 3.798598216558984*^9}, {
   3.798598268662146*^9, 3.798598304446409*^9}, {3.798598355845134*^9, 
   3.798598364576832*^9}, 3.7985984502796307`*^9, 3.798720384912957*^9, 
   3.798811846833746*^9, {3.798812383185275*^9, 3.798812566190484*^9}, {
   3.79881260038025*^9, 3.7988127197057743`*^9}, {3.798812872231578*^9, 
   3.7988129103235283`*^9}, {3.79881337299879*^9, 3.798813530452073*^9}, {
   3.798813676193947*^9, 3.798813689856687*^9}, {3.798813729162492*^9, 
   3.7988138086299553`*^9}, {3.7988144965223722`*^9, 3.798814657299486*^9}, {
   3.798823868110915*^9, 
   3.798823874857594*^9}},ExpressionUUID->"d3d32dc3-3979-4842-94eb-\
8c8e10275021"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   SubscriptBox[
    RowBox[{"[", 
     InterpretationBox[
      SubsuperscriptBox["S", 
       StyleBox["a",
        StripOnInput->False,
        ShowContents->False], "a"],
      $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], ",", 
     InterpretationBox[
      SubsuperscriptBox["S", 
       StyleBox["b",
        StripOnInput->False,
        ShowContents->False], "b"],
      $CellContext`Tensor[$CellContext`S, {$CellContext`b}, \
{$CellContext`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], "]"}], "-"],
   $CellContext`CommutatorM[
    $CellContext`Tensor[$CellContext`S, {$CellContext`a}, \
{$CellContext`Void}], 
    $CellContext`Tensor[$CellContext`S, {$CellContext`b}, \
{$CellContext`Void}]],
   Editable->False,
   SyntaxForm->Automatic], "\[Rule]", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    SubsuperscriptBox["S", 
     StyleBox["c",
      StripOnInput->False,
      ShowContents->False], "c"],
    $CellContext`Tensor[$CellContext`S, {$CellContext`c}, {$CellContext`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False], " ", 
   InterpretationBox[
    SubsuperscriptBox["\[Epsilon]", 
     StyleBox[
      RowBox[{"a", "b", "c"}],
      StripOnInput->False,
      ShowContents->False], 
     RowBox[{"a", "b", "c"}]],
    $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`a, \
$CellContext`b, $CellContext`c}, {$CellContext`Void, $CellContext`Void, \
$CellContext`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False]}]}]], "Output",
 CellChangeTimes->{3.800188550727003*^9, 3.8001889143561974`*^9, 
  3.800267853362952*^9},ExpressionUUID->"e5fd2d03-b393-45a3-9377-\
31afd037122d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "0"], "\[Rule]", 
        TemplateBox[{FractionBox[
           RowBox[{
             RowBox[{"n", ".", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Mu]"], "[", 
                    "n", "]"}], 
                  $CellContext`tuDDown[
                  "\[PartialD]"][$CellContext`n, $CellContext`\[Mu]], 
                  SyntaxForm -> Automatic, Editable -> False], "\[Cross]", 
                 InterpretationBox[
                  RowBox[{
                    SubscriptBox[
                    UnderscriptBox["\"\[PartialD]\"", "_"], "\[Nu]"], "[", 
                    "n", "]"}], 
                  $CellContext`tuDDown[
                  "\[PartialD]"][$CellContext`n, $CellContext`\[Nu]], 
                  SyntaxForm -> Automatic, Editable -> False]}]}], " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Epsilon]", 
               RowBox[{
                 StyleBox[
                 "\[Mu]", ShowContents -> False, StripOnInput -> False], 
                 StyleBox[
                 "\[Nu]", ShowContents -> False, StripOnInput -> False]}], 
               RowBox[{"\[Mu]", "\[Nu]"}]], 
              $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}], Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}]}], 
           RowBox[{"8", " ", "\[Pi]"}]],RowBox[{"x", "\[Element]", "D"}]},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            UnderscriptBox[
             StyleBox["\[Integral]", "Inactive"], #2], #}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], "}"}], "[", 
      StyleBox["\<\"e[63]\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0, 
         Rational[2, 3], 0],
       FrontFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       BackFaceColor->RGBColor[0, 
         Rational[2, 3], 0],
       GraphicsColor->RGBColor[0, 
         Rational[2, 3], 0],
       FontFamily->"Helvetica",
       FontColor->RGBColor[0, 
         Rational[2, 3], 0]], "]"}], ",", 
     RowBox[{
      SubscriptBox["W", "0"], "\[Rule]", 
      TemplateBox[{RowBox[{"Tr", "[", 
          RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
               OverscriptBox["n", "^"], " ", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    OverscriptBox["n", "^"], "]"}], 
                  $CellContext`difForm[
                   OverHat[$CellContext`n]], SyntaxForm -> Automatic, 
                  Editable -> False], "\[Wedge]", 
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    OverscriptBox["n", "^"], "]"}], 
                  $CellContext`difForm[
                   OverHat[$CellContext`n]], SyntaxForm -> Automatic, 
                  Editable -> False]}]}], 
             RowBox[{"16", " ", "\[Pi]"}]]}], "]"}],"D"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          StyleBox["\[Integral]", "Inactive"], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
     RowBox[{
      OverscriptBox["n", "^"], "\[Rule]", 
      RowBox[{"n", "\[CenterDot]", "\[Sigma]"}]}]}], "}"}], ",", 
   RowBox[{
    SubscriptBox["W", "0"], "\[Rule]", 
    TemplateBox[{RowBox[{"(", 
        RowBox[{
          FractionBox[
           RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", 
               RowBox[{"1"}], 
               RowBox[{
                 StyleBox[
                 "1", ShowContents -> False, StripOnInput -> False]}]], 
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
              Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}], 
             "\[CenterDot]", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}]], SyntaxForm -> Automatic, Editable -> False], 
               "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
           RowBox[{"4", " ", "\[Pi]"}]], "-", 
          FractionBox[
           RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", 
               RowBox[{"2"}], 
               RowBox[{
                 StyleBox[
                 "2", ShowContents -> False, StripOnInput -> False]}]], 
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
              Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}], 
             "\[CenterDot]", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}]], SyntaxForm -> Automatic, Editable -> False], 
               "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
           RowBox[{"4", " ", "\[Pi]"}]], "+", 
          FractionBox[
           RowBox[{
             InterpretationBox[
              SubsuperscriptBox["n", 
               RowBox[{"3"}], 
               RowBox[{
                 StyleBox[
                 "3", ShowContents -> False, StripOnInput -> False]}]], 
              $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
              Editable -> False, 
              BaseStyle -> {AutoMultiplicationSymbol -> False}], 
             "\[CenterDot]", 
             RowBox[{
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"1"}], 
                    RowBox[{
                    StyleBox[
                    "1", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    1}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  1}]], SyntaxForm -> Automatic, Editable -> False], 
               "\[Wedge]", 
               InterpretationBox[
                RowBox[{
                  UnderscriptBox["d", "_"], "[", 
                  InterpretationBox[
                   SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                   BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
                $CellContext`difForm[
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
           RowBox[{"4", " ", "\[Pi]"}]]}], ")"}],"D"},
     "InactiveIntegrate",
     DisplayFunction->(RowBox[{
        StyleBox["\[Integral]", "Inactive"], 
        RowBox[{#, 
          RowBox[{
            StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
     InterpretationFunction->(RowBox[{
        RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}], ",", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     SubscriptBox["W", "0"], "]"}], "\[Rule]", 
    TemplateBox[{FractionBox[
       RowBox[{"3", " ", 
         RowBox[{
           InterpretationBox[
            RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                RowBox[{"1"}], 
                RowBox[{
                  StyleBox[
                  "1", ShowContents -> False, StripOnInput -> False]}]], 
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
               Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
            SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
           InterpretationBox[
            RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                RowBox[{"2"}], 
                RowBox[{
                  StyleBox[
                  "2", ShowContents -> False, StripOnInput -> False]}]], 
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
               Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
            SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
           InterpretationBox[
            RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                RowBox[{"3"}], 
                RowBox[{
                  StyleBox[
                  "3", ShowContents -> False, StripOnInput -> False]}]], 
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
               Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]], 
            SyntaxForm -> Automatic, Editable -> False]}]}], 
       RowBox[{"4", " ", "\[Pi]"}]],"D"},
     "InactiveIntegrate",
     DisplayFunction->(RowBox[{
        StyleBox["\[Integral]", "Inactive"], 
        RowBox[{#, 
          RowBox[{
            StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
     InterpretationFunction->(RowBox[{
        RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
        RowBox[{#, ",", #2}], "]"}]& )]}]}], "}"}]], "Output",
 CellChangeTimes->{3.800188550727003*^9, 3.8001889143561974`*^9, 
  3.80026785337774*^9},ExpressionUUID->"f6dd130d-5615-4a50-a15e-1d8cc5e5fd16"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    StyleBox["\<\"The variation: \"\>",
     StripOnInput->False,
     LineColor->RGBColor[0.7, 0, 1],
     LineOpacity->1,
     FrontFaceColor->RGBColor[0.7, 0, 1],
     BackFaceColor->RGBColor[0.7, 0, 1],
     FrontFaceOpacity->1,
     BackFaceOpacity->1,
     GraphicsColor->RGBColor[0.7, 0, 1],
     Opacity->1,
     FontSize->Larger,
     FontColor->RGBColor[0.7, 0, 1],
     FontOpacity->1], "\[InvisibleSpace]", 
    RowBox[{"\[Delta]", "[", 
     SubscriptBox["W", "0"], "]"}]}], "\[Rule]", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       TemplateBox[{RowBox[{
           InterpretationBox[
            RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                RowBox[{"1"}], 
                RowBox[{
                  StyleBox[
                  "1", ShowContents -> False, StripOnInput -> False]}]], 
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
               Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
            SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
           InterpretationBox[
            RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                RowBox[{"2"}], 
                RowBox[{
                  StyleBox[
                  "2", ShowContents -> False, StripOnInput -> False]}]], 
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}], 
               Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
            SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
           InterpretationBox[
            RowBox[{
              UnderscriptBox["d", "_"], "[", 
              InterpretationBox[
               SubsuperscriptBox["n", 
                RowBox[{"3"}], 
                RowBox[{
                  StyleBox[
                  "3", ShowContents -> False, StripOnInput -> False]}]], 
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}], 
               Editable -> False, 
               BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
            $CellContext`difForm[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]], 
            SyntaxForm -> Automatic, Editable -> False]}],"D"},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], 
      RowBox[{"4", " ", "\[Pi]"}]], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     StyleBox["\<\"The Wedge can be rewritten: \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        RowBox[{
         UnderscriptBox["d", "_"], "[", 
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}],
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]],
        Editable->False,
        SyntaxForm->Automatic], "\[Wedge]", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox["d", "_"], "[", 
         InterpretationBox[
          SubsuperscriptBox["n", "2", 
           StyleBox["2",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}],
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
        Editable->False,
        SyntaxForm->Automatic], "\[Wedge]", 
       InterpretationBox[
        RowBox[{
         UnderscriptBox["d", "_"], "[", 
         InterpretationBox[
          SubsuperscriptBox["n", "3", 
           StyleBox["3",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "]"}],
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
        Editable->False,
        SyntaxForm->Automatic]}], "\[Rule]", 
      InterpretationBox[
       RowBox[{
        UnderscriptBox["d", "_"], "[", 
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["n", "1", 
           StyleBox["1",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "\[CenterDot]", 
         RowBox[{
          InterpretationBox[
           RowBox[{
            UnderscriptBox["d", "_"], "[", 
            InterpretationBox[
             SubsuperscriptBox["n", "2", 
              StyleBox["2",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "]"}],
           $CellContext`difForm[
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
           Editable->False,
           SyntaxForm->Automatic], "\[Wedge]", 
          InterpretationBox[
           RowBox[{
            UnderscriptBox["d", "_"], "[", 
            InterpretationBox[
             SubsuperscriptBox["n", "3", 
              StyleBox["3",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "]"}],
           $CellContext`difForm[
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
           Editable->False,
           SyntaxForm->Automatic]}]}], "]"}],
       $CellContext`difForm[
        CenterDot[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
         Wedge[
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
          $CellContext`difForm[
           $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]]],
       Editable->False,
       SyntaxForm->Automatic]}], "\[InvisibleSpace]", 
     StyleBox["\<\"\\n\[Implies] \"\>",
      StripOnInput->False,
      LineColor->RGBColor[0.7, 0, 1],
      LineOpacity->1,
      FrontFaceColor->RGBColor[0.7, 0, 1],
      BackFaceColor->RGBColor[0.7, 0, 1],
      FrontFaceOpacity->1,
      BackFaceOpacity->1,
      GraphicsColor->RGBColor[0.7, 0, 1],
      Opacity->1,
      FontSize->Larger,
      FontWeight->Bold,
      FontColor->RGBColor[0.7, 0, 1],
      FontOpacity->1], "\[InvisibleSpace]", 
     RowBox[{"\[Delta]", "[", 
      SubscriptBox["W", "0"], "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", 
        TemplateBox[{InterpretationBox[
           RowBox[{
             UnderscriptBox["d", "_"], "[", 
             RowBox[{
               InterpretationBox[
                SubsuperscriptBox["n", 
                 RowBox[{"1"}], 
                 RowBox[{
                   StyleBox[
                   "1", ShowContents -> False, StripOnInput -> False]}]], 
                $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}],
                 Editable -> False, 
                BaseStyle -> {AutoMultiplicationSymbol -> False}], 
               "\[CenterDot]", 
               RowBox[{
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"2"}], 
                    RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    2}]], SyntaxForm -> Automatic, Editable -> False], 
                 "\[Wedge]", 
                 InterpretationBox[
                  RowBox[{
                    UnderscriptBox["d", "_"], "[", 
                    InterpretationBox[
                    SubsuperscriptBox["n", 
                    RowBox[{"3"}], 
                    RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                    $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}], Editable -> False, 
                    BaseStyle -> {AutoMultiplicationSymbol -> False}], 
                    "]"}], 
                  $CellContext`difForm[
                   $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                    3}]], SyntaxForm -> Automatic, Editable -> False]}]}], 
             "]"}], 
           $CellContext`difForm[
            CenterDot[
             $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
             Wedge[
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                3}]]]]], SyntaxForm -> Automatic, Editable -> False],"D"},
         "InactiveIntegrate",
         DisplayFunction->(RowBox[{
            StyleBox["\[Integral]", "Inactive"], 
            RowBox[{#, 
              RowBox[{
                StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
         InterpretationFunction->(RowBox[{
            RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
            RowBox[{#, ",", #2}], "]"}]& )]}], 
       RowBox[{"4", " ", "\[Pi]"}]], "\[InvisibleSpace]", 
      StyleBox["\<\"\\n\"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      StyleBox["\<\"Apply Gauss's relationship: \"\>",
       StripOnInput->False,
       LineColor->RGBColor[0.7, 0, 1],
       LineOpacity->1,
       FrontFaceColor->RGBColor[0.7, 0, 1],
       BackFaceColor->RGBColor[0.7, 0, 1],
       FrontFaceOpacity->1,
       BackFaceOpacity->1,
       GraphicsColor->RGBColor[0.7, 0, 1],
       Opacity->1,
       FontSize->Larger,
       FontColor->RGBColor[0.7, 0, 1],
       FontOpacity->1], "\[InvisibleSpace]", 
      RowBox[{"\[Delta]", "[", 
       SubscriptBox["W", "0"], "]"}]}], "\[Rule]", 
     FractionBox[
      RowBox[{"3", " ", 
       TemplateBox[{RowBox[{
           InterpretationBox[
            SubsuperscriptBox["n", 
             RowBox[{"1"}], 
             RowBox[{
               StyleBox["1", ShowContents -> False, StripOnInput -> False]}]], 
            $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
            Editable -> False, 
            BaseStyle -> {AutoMultiplicationSymbol -> False}], "\[CenterDot]", 
           RowBox[{
             InterpretationBox[
              RowBox[{
                UnderscriptBox["d", "_"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", 
                  RowBox[{"2"}], 
                  RowBox[{
                    StyleBox[
                    "2", ShowContents -> False, StripOnInput -> False]}]], 
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  2}], Editable -> False, 
                 BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]],
               SyntaxForm -> Automatic, Editable -> False], "\[Wedge]", 
             InterpretationBox[
              RowBox[{
                UnderscriptBox["d", "_"], "[", 
                InterpretationBox[
                 SubsuperscriptBox["n", 
                  RowBox[{"3"}], 
                  RowBox[{
                    StyleBox[
                    "3", ShowContents -> False, StripOnInput -> False]}]], 
                 $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
                  3}], Editable -> False, 
                 BaseStyle -> {AutoMultiplicationSymbol -> False}], "]"}], 
              $CellContext`difForm[
               $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]],
               SyntaxForm -> Automatic, Editable -> False]}]}],
         "\"\[PartialD]D\""},
        "InactiveIntegrate",
        DisplayFunction->(RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
        InterpretationFunction->(RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )]}], 
      RowBox[{"4", " ", "\[Pi]"}]]}]}]}],
  SequenceForm[
   Style["The variation: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`\[Delta][
     Subscript[$CellContext`W, 0]] -> 
   Rational[3, 4] Pi^(-1) Inactive[Integrate][
      Wedge[
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]], D], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["The Wedge can be rewritten: ", 
    RGBColor[0.7, 0, 1, 1], Larger], Wedge[
     $CellContext`difForm[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}]], 
     $CellContext`difForm[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
     $CellContext`difForm[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {
       3}]]] -> $CellContext`difForm[
     CenterDot[
      $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
      Wedge[
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
       $CellContext`difForm[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]]], 
   Style["\n\[Implies] ", Bold, Larger, 
    RGBColor[0.7, 0, 1, 1]], $CellContext`\[Delta][
     Subscript[$CellContext`W, 0]] -> 
   Rational[3, 4] Pi^(-1) Inactive[Integrate][
      $CellContext`difForm[
       CenterDot[
        $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
        Wedge[
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
         $CellContext`difForm[
          $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]]], 
      D], 
   Style["\n", 
    RGBColor[0.7, 0, 1, 1], Larger], 
   Style["Apply Gauss's relationship: ", 
    RGBColor[0.7, 0, 1, 1], Larger], $CellContext`\[Delta][
     Subscript[$CellContext`W, 0]] -> 
   Rational[3, 4] Pi^(-1) Inactive[Integrate][
      CenterDot[
       $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {1}], 
       Wedge[
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {2}]], 
        $CellContext`difForm[
         $CellContext`Tensor[$CellContext`n, {$CellContext`Void}, {3}]]]], 
      "\[PartialD]D"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188550944467*^9, 3.80018891456686*^9, 
  3.800267853535914*^9},ExpressionUUID->"2f8eac8c-2756-498b-a8b4-\
3839e85252b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"CO", "[", 
   RowBox[{
   "\"\<Exercise 8: Reduction of the WZ-term to the theta-term in 0+1.  \n\
\[FilledCircle] Let us assume that the field n[t] is constrained so that it \
takes values on a circle given in spherical coordinates by \>\"", ",", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Theta]", "0"], "\[Rule]", "constant"}]}], ",", 
    "\"\<. \>\"", ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] Find the value of the topological term \!\(\*SubscriptBox[\
\(S\), \(WZ\)]\) on such configurations (notice that this constraint is not \
applicable in the interior of the disk D, only at its physical boundary).\n\
\[Bullet] Show that the obtained topological term is a theta-term in 0+1 \
corresponding to \!\(\*SuperscriptBox[\(S\), \
\(1\)]\)\[LongRightArrow]\!\(\*SuperscriptBox[\(S\), \(1\)]\).\n\[Bullet] \
What is the value of the coefficient in front of that topological term?\n\
\[Bullet] What is the value of corresponding magnetic flux through a ring? \n\
\[Bullet] For S\[Rule]1/2 which reduction (value of \!\(\*SubscriptBox[\(\
\[Theta]\), \(0\)]\)) corresonds to the half of the flux quantum? \nFor \
answer see Sec 3.5.\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.796066340849061*^9, 3.796066633937997*^9}, {
  3.796066698548029*^9, 3.796066726685907*^9}, {3.796066760063244*^9, 
  3.796066871911614*^9}, {3.798721320726618*^9, 3.798721462748764*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5cedd6b6-fcf4-4bf3-9e30-30b28a50b1f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 8: Reduction of the WZ-term to the theta-term in \
0+1.  \\n\[FilledCircle] Let us assume that the field n[t] is constrained so \
that it takes values on a circle given in spherical coordinates by \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Theta]", "0"], "\[Rule]", "constant"}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\". \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] Find the value of the topological term \
\\!\\(\\*SubscriptBox[\\(S\\), \\(WZ\\)]\\) on such configurations (notice \
that this constraint is not applicable in the interior of the disk D, only at \
its physical boundary).\\n\[Bullet] Show that the obtained topological term \
is a theta-term in 0+1 corresponding to \\!\\(\\*SuperscriptBox[\\(S\\), \\(1\
\\)]\\)\[LongRightArrow]\\!\\(\\*SuperscriptBox[\\(S\\), \\(1\\)]\\).\\n\
\[Bullet] What is the value of the coefficient in front of that topological \
term?\\n\[Bullet] What is the value of corresponding magnetic flux through a \
ring? \\n\[Bullet] For S\[Rule]1/2 which reduction (value of \
\\!\\(\\*SubscriptBox[\\(\[Theta]\\), \\(0\\)]\\)) corresonds to the half of \
the flux quantum? \\nFor answer see Sec 3.5.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 8: Reduction of the WZ-term to the theta-term in 0+1.  \n\
\[FilledCircle] Let us assume that the field n[t] is constrained so that it \
takes values on a circle given in spherical coordinates by ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[$CellContext`\[Theta] -> (
     Subscript[$CellContext`\[Theta], 0] -> $CellContext`constant), 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[". ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] Find the value of the topological term \
\!\(\*SubscriptBox[\(S\), \(WZ\)]\) on such configurations (notice that this \
constraint is not applicable in the interior of the disk D, only at its \
physical boundary).\n\[Bullet] Show that the obtained topological term is a \
theta-term in 0+1 corresponding to \!\(\*SuperscriptBox[\(S\), \(1\)]\)\
\[LongRightArrow]\!\(\*SuperscriptBox[\(S\), \(1\)]\).\n\[Bullet] What is the \
value of the coefficient in front of that topological term?\n\[Bullet] What \
is the value of corresponding magnetic flux through a ring? \n\[Bullet] For S\
\[Rule]1/2 which reduction (value of \!\(\*SubscriptBox[\(\[Theta]\), \
\(0\)]\)) corresonds to the half of the flux quantum? \nFor answer see Sec \
3.5.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188551066194*^9, 3.800188914723754*^9, 
  3.800267853661255*^9},ExpressionUUID->"40f7825b-864e-459e-b7d7-\
b3c58badb38f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e", "[", "31", "]"}]], "Input",
 CellChangeTimes->{{3.798724106136114*^9, 3.798724111183509*^9}, {
  3.798725543381192*^9, 3.7987255446818132`*^9}, {3.798727586848915*^9, 
  3.798727588072629*^9}},ExpressionUUID->"9b770217-184e-44b2-815f-\
861a39d19696"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   SubscriptBox["W", "0"], "]"}], "\[Rule]", 
  FractionBox[
   TemplateBox[{RowBox[{"n", ".", 
       RowBox[{
         RowBox[{"d", "[", "n", "]"}], "\[Cross]", 
         InterpretationBox[
          RowBox[{
            SubscriptBox[
             UnderscriptBox["\"\[PartialD]\"", "_"], "t"], "[", "n", "]"}], 
          $CellContext`tuDDown["\[PartialD]"][$CellContext`n, $CellContext`t],
           SyntaxForm -> Automatic, Editable -> False]}]}],"t","0","\[Beta]"},
    
    "InactiveIntegrate",
    DisplayFunction->(RowBox[{
       SubsuperscriptBox[
        StyleBox["\[Integral]", "Inactive"], #3, #4], 
       RowBox[{#, 
         RowBox[{
           StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
    InterpretationFunction->(RowBox[{
       RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
       RowBox[{#, ",", 
         RowBox[{"{", 
           RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], 
   RowBox[{"4", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{3.800188551178338*^9, 3.80018891484039*^9, 
  3.800267853747897*^9},ExpressionUUID->"f1405760-60ce-44f3-a85f-\
7037a36dbb52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"CO", "[", 
   RowBox[{
   "\"\<Exercise 9: WZ in 0+1, derivation from fermions.\nConsider a \
Euclidean action of a fermion coupled to a unit vector \>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["S", "iE"], "\[Rule]", 
         RowBox[{"xIntegral", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ct", "[", "\[Psi]", "]"}], ".", 
            RowBox[{"iD", "[", "\[Psi]", "]"}]}], ",", "\[Tau]"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iD", "\[Rule]", 
          RowBox[{"tuDPartial", "[", 
           RowBox[{"_", ",", "\[Tau]"}], "]"}]}], "=", 
         RowBox[{"m", "  ", 
          RowBox[{"n", "\[CenterDot]", "\[Tau]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "\[Element]", 
         SuperscriptBox["S", "2"]}], ",", 
        RowBox[{"\[Tau]", "[", 
         RowBox[{"CG", "[", "\"\<Pauli matrices\>\"", "]"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    "\[IndentingNewLine]", ",", 
    "\"\< We obtain an effective action for n induced by fermions as \>\"", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SubscriptBox["S", "eff"]}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"xIntegral", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              SubscriptBox["S", "iE"]}], "]"}], ",", "\[Psi]", ",", 
            RowBox[{"ct", "[", "\[Psi]", "]"}]}], "]"}], "\[Rule]", 
          RowBox[{"Det", "[", "iD", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SubscriptBox["S", "eff"]}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"Det", "[", "iD", "]"}], "]"}]}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{"Log", "[", "iD", "]"}], "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", 
    "\"\< We calculate the variation of \!\(\*SubscriptBox[\(S\), \(eff\)]\) \
with respect to n as: \>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "75", "]"}], "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Delta]", "[", 
           SubscriptBox["S", "eff"], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{"\[Delta]", "[", "iD", "]"}], ".", 
              RowBox[{"inv", "[", "iD", "]"}]}], "]"}]}], "\[Rule]", 
           RowBox[{"-", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{"\[Delta]", "[", "iD", "]"}], ".", 
              RowBox[{"ct", "[", "iD", "]"}], ".", 
              RowBox[{"inv", "[", 
               RowBox[{"iD", ".", 
                RowBox[{"ct", "[", "iD", "]"}]}], "]"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ct", "[", "iD", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"_", ",", "\[Tau]"}], "]"}]}], "-", 
           RowBox[{"m", " ", 
            RowBox[{"n", ".", "\[Tau]"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"iD", ".", 
           RowBox[{"ct", "[", "iD", "]"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"tuDPartial", "[", 
              RowBox[{"_", ",", 
               RowBox[{"{", 
                RowBox[{"\[Tau]", ",", "\[Tau]"}], "}"}]}], "]"}]}], "+", 
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"m", " ", 
             RowBox[{
              RowBox[{"tuDPartial", "[", 
               RowBox[{"n", ",", "t"}], "]"}], ".", "\[Tau]"}]}]}], "\[Rule]", 
           RowBox[{
            RowBox[{"inv", "[", 
             SubscriptBox["G", "0"], "]"}], "-", 
            RowBox[{"m", " ", 
             RowBox[{
              RowBox[{"tuDPartial", "[", 
               RowBox[{"n", ",", "t"}], "]"}], ".", "\[Tau]"}]}]}]}]}]}], 
        "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<Expand e[75] in 1/m up to the term of \!\(\*SuperscriptBox[\(m\), \
\(0\)]\) and calculate functional traces.  Show that the term of the order \!\
\(\*SuperscriptBox[\(m\), \(0\)]\) is a variation of the WZ term in 0+1 \
dimensions. Restore \!\(\*SubscriptBox[\(S\), \(eff\)]\) from its variation.  \
What is the coefficient in front of the WZ term?  To what value of spin does \
it correspond? See Sec 3.3.\>\""}], "\[IndentingNewLine]", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79606708424328*^9, 3.79606719587599*^9}, {
  3.796067478915431*^9, 3.796067519065679*^9}, {3.796067553192491*^9, 
  3.796067578491499*^9}, {3.796067719690845*^9, 3.79606772801042*^9}, {
  3.796067799705077*^9, 3.7960678987884274`*^9}, {3.796067929183009*^9, 
  3.796068128859488*^9}, {3.7960681761091633`*^9, 3.796068366722487*^9}, {
  3.7960684152601547`*^9, 3.7960685893720503`*^9}, {3.796068836543442*^9, 
  3.796068903704475*^9}, {3.7960689607860537`*^9, 3.796069091274241*^9}, {
  3.796069345324404*^9, 3.796069397054591*^9}, {3.796069428981385*^9, 
  3.796069432077366*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"f27597cb-16f1-440c-8eb4-60ddc8b499e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 9: WZ in 0+1, derivation from fermions.\\nConsider \
a Euclidean action of a fermion coupled to a unit vector \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         SubscriptBox["S", 
          StyleBox["\<\"E\"\>",
           StripOnInput->False,
           FontSlant->Italic]], "\[Rule]", 
         TemplateBox[{RowBox[{
             InterpretationBox[
              SuperscriptBox["\[Psi]", "\[Dagger]"], 
              ConjugateTranspose[$CellContext`\[Psi]], SyntaxForm -> 
              Automatic, Editable -> False], ".", 
             RowBox[{
               StyleBox["\"D\"", Italic, StripOnInput -> False], "[", 
               "\[Psi]", "]"}]}],"\[Tau]"},
          "InactiveIntegrate",
          DisplayFunction->(RowBox[{
             StyleBox["\[Integral]", "Inactive"], 
             RowBox[{#, 
               RowBox[{
                 StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
          InterpretationFunction->(RowBox[{
             RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
             RowBox[{#, ",", #2}], "]"}]& )]}]},
       {
        RowBox[{"m", " ", 
         RowBox[{"n", "\[CenterDot]", "\[Tau]"}]}]},
       {
        RowBox[{"n", "\[Element]", 
         SuperscriptBox["S", "2"]}]},
       {
        RowBox[{"\[Tau]", "[", 
         StyleBox["\<\"Pauli matrices\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" We obtain an effective action for n induced by fermions as \
\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           SubscriptBox["S", "eff"]}]], "\[Rule]", 
         RowBox[{
          TemplateBox[{SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
               SubscriptBox["S", 
                StyleBox["\"E\"", Italic, StripOnInput -> False]]}]],"\[Psi]",
            InterpretationBox[
             SuperscriptBox["\[Psi]", "\[Dagger]"], 
             ConjugateTranspose[$CellContext`\[Psi]], SyntaxForm -> Automatic,
              Editable -> False]},
           "InactiveIntegrate",
           DisplayFunction->(RowBox[{
              StyleBox["\[Integral]", "Inactive"], 
              RowBox[{
                StyleBox["\[Integral]", "Inactive"], 
                RowBox[{#, 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #3}], 
                  RowBox[{
                    StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]}]& ),
           InterpretationFunction->(RowBox[{
              RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
              RowBox[{#, ",", #2, ",", #3}], "]"}]& )], "\[Rule]", 
          RowBox[{"Det", "[", 
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "]"}]}]}]},
       {
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           SubscriptBox["S", "eff"]}]], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"Det", "[", 
             StyleBox["\<\"D\"\>",
              StripOnInput->False,
              FontSlant->Italic], "]"}], "]"}]}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{"Log", "[", 
             StyleBox["\<\"D\"\>",
              StripOnInput->False,
              FontSlant->Italic], "]"}], "]"}]}]}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" We calculate the variation of \
\\!\\(\\*SubscriptBox[\\(S\\), \\(eff\\)]\\) with respect to n as: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          SubscriptBox["S", "eff"], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "]"}], ".", 
             SuperscriptBox[
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "\<\"-1\"\>"]}], "]"}]}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{"\[Delta]", "[", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "]"}], ".", 
             InterpretationBox[
              SuperscriptBox[
               StyleBox["\<\"D\"\>",
                StripOnInput->False,
                FontSlant->Italic], "\[Dagger]"],
              ConjugateTranspose[
               Style["D", Italic]],
              Editable->False,
              SyntaxForm->Automatic], ".", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                StyleBox["\<\"D\"\>",
                 StripOnInput->False,
                 FontSlant->Italic], ".", 
                InterpretationBox[
                 SuperscriptBox[
                  StyleBox["\<\"D\"\>",
                   StripOnInput->False,
                   FontSlant->Italic], "\[Dagger]"],
                 ConjugateTranspose[
                  Style["D", Italic]],
                 Editable->False,
                 SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"]}], 
            "]"}]}]}]}]},
       {
        RowBox[{
         InterpretationBox[
          SuperscriptBox[
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "\[Dagger]"],
          ConjugateTranspose[
           Style["D", Italic]],
          Editable->False,
          SyntaxForm->Automatic], "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "m"}], " ", 
           RowBox[{"n", ".", "\[Tau]"}]}], "-", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Tau]"], "[", "_", 
            "]"}],
           $CellContext`tuDDown["\[PartialD]"][
            Blank[], $CellContext`\[Tau]],
           Editable->False,
           SyntaxForm->Automatic]}]}]},
       {
        RowBox[{
         RowBox[{
          StyleBox["\<\"D\"\>",
           StripOnInput->False,
           FontSlant->Italic], ".", 
          InterpretationBox[
           SuperscriptBox[
            StyleBox["\<\"D\"\>",
             StripOnInput->False,
             FontSlant->Italic], "\[Dagger]"],
           ConjugateTranspose[
            Style["D", Italic]],
           Editable->False,
           SyntaxForm->Automatic]}], "\[Rule]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", 
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], ".", "\[Tau]"}]}], "-", 
           InterpretationBox[
            RowBox[{
             SubscriptBox[
              UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
              RowBox[{"{", 
               RowBox[{"\[Tau]", ",", "\[Tau]"}], "}"}]], "[", "_", "]"}],
            $CellContext`tuDDown["\[PartialD]"][
             Blank[], {$CellContext`\[Tau], $CellContext`\[Tau]}],
            Editable->False,
            SyntaxForm->Automatic]}], "\[Rule]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "m"}], " ", 
            RowBox[{
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "t"], "[", "n", 
               "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`n, $CellContext`t],
              Editable->False,
              SyntaxForm->Automatic], ".", "\[Tau]"}]}], "+", 
           SubsuperscriptBox["G", "0", "\<\"-1\"\>"]}]}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"Expand e[75] in 1/m up to the term of \
\\!\\(\\*SuperscriptBox[\\(m\\), \\(0\\)]\\) and calculate functional traces. \
 Show that the term of the order \\!\\(\\*SuperscriptBox[\\(m\\), \\(0\\)]\\) \
is a variation of the WZ term in 0+1 dimensions. Restore \
\\!\\(\\*SubscriptBox[\\(S\\), \\(eff\\)]\\) from its variation.  What is the \
coefficient in front of the WZ term?  To what value of spin does it \
correspond? See Sec 3.3.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 9: WZ in 0+1, derivation from fermions.\nConsider a \
Euclidean action of a fermion coupled to a unit vector ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{Subscript[$CellContext`S, 
         Style["E", Italic]] -> Inactive[Integrate][
         Dot[
          ConjugateTranspose[$CellContext`\[Psi]], 
          Style[
          "D", Italic][$CellContext`\[Psi]]], $CellContext`\[Tau]]}, \
{$CellContext`m CenterDot[$CellContext`n, $CellContext`\[Tau]]}, {
       Element[$CellContext`n, $CellContext`S^2]}, {
       $CellContext`\[Tau][
        Style["Pauli matrices", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
     Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" We obtain an effective action for n induced by fermions as ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{
      E^(-Subscript[$CellContext`S, $CellContext`eff]) -> (
        Inactive[Integrate][E^(-Subscript[$CellContext`S, 
             Style["E", Italic]]), $CellContext`\[Psi], 
          ConjugateTranspose[$CellContext`\[Psi]]] -> Det[
          Style["D", Italic]])}, {
      E^(-Subscript[$CellContext`S, $CellContext`eff]) -> (-Log[
           Det[
            Style["D", Italic]]] -> -Tr[
           Log[
            Style["D", Italic]]])}}, Dividers -> {{True}, {False}}, 
     FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" We calculate the variation of \!\(\*SubscriptBox[\(S\), \(eff\)]\) \
with respect to n as: ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{$CellContext`\[Delta][
         Subscript[$CellContext`S, $CellContext`eff]] -> (-Tr[
           Dot[
            $CellContext`\[Delta][
             Style["D", Italic]], Style["D", Italic]^"-1"]] -> -Tr[
           Dot[
            $CellContext`\[Delta][
             Style["D", Italic]], 
            ConjugateTranspose[
             Style["D", Italic]], Dot[
              Style["D", Italic], 
              ConjugateTranspose[
               Style["D", Italic]]]^"-1"]])}, {ConjugateTranspose[
         Style["D", Italic]] -> -$CellContext`m 
         Dot[$CellContext`n, $CellContext`\[Tau]] - $CellContext`tuDDown[
        "\[PartialD]"][
         Blank[], $CellContext`\[Tau]]}, {Dot[
         Style["D", Italic], 
         ConjugateTranspose[
          Style["D", Italic]]] -> ($CellContext`m^2 - $CellContext`m Dot[
           $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`n, $CellContext`t], \
$CellContext`\[Tau]] - $CellContext`tuDDown["\[PartialD]"][
          
          Blank[], {$CellContext`\[Tau], $CellContext`\[Tau]}] -> \
-$CellContext`m Dot[
            $CellContext`tuDDown[
            "\[PartialD]"][$CellContext`n, $CellContext`t], $CellContext`\
\[Tau]] + Subscript[$CellContext`G, 0]^"-1")}}, Dividers -> {{True}, {False}},
      FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["Expand e[75] in 1/m up to the term of \!\(\*SuperscriptBox[\(m\), \
\(0\)]\) and calculate functional traces.  Show that the term of the order \!\
\(\*SuperscriptBox[\(m\), \(0\)]\) is a variation of the WZ term in 0+1 \
dimensions. Restore \!\(\*SubscriptBox[\(S\), \(eff\)]\) from its variation.  \
What is the coefficient in front of the WZ term?  To what value of spin does \
it correspond? See Sec 3.3.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.800188551325519*^9, 3.8001889150367317`*^9, 
  3.800267853890285*^9},ExpressionUUID->"50e36d93-dcf0-4ad5-acde-\
a8dcb1967221"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PR", "[", 
  RowBox[{"CO", "[", 
   RowBox[{
   "\"\<Exercise 10: Fermionic determinant in two dimensions.\nLet us \
consider two-dimensional fermions coupled to a phase field \>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "x", "]"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", 
       RowBox[{"\[Phi]", "+", 
        RowBox[{"2", "\[Pi]"}]}]}]}], "}"}], ",", 
    "\"\<. The Euclidean Lagrangian is given by \>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"e", "[", "77", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalL]", "2"], "\[Rule]", 
          RowBox[{
           OverscriptBox["\[Psi]", "_"], " ", ".", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"I", " ", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tuDPartial", "[", 
                  RowBox[{"_", ",", "\[Mu]"}], "]"}], "-", 
                 RowBox[{"I", " ", 
                  RowBox[{"T", "[", 
                   RowBox[{"A", ",", "\"\<d\>\"", ",", 
                    RowBox[{"{", "\[Mu]", "}"}]}], "]"}]}]}], ")"}]}]}], "+", 
             
             RowBox[{"I", " ", "m", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                   RowBox[{"{", "5", "}"}]}], "]"}], ".", "\[Phi]"}]}], 
               "]"}]}]}], ")"}], ".", "\[Psi]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
            RowBox[{"{", "\[Mu]", "}"}]}], "]"}], "[", 
          RowBox[{"CG", "[", "\"\<Pauli matrices\>\"", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"A", ",", "\"\<d\>\"", ",", 
            RowBox[{"{", "\[Mu]", "}"}]}], "]"}], "[", 
          RowBox[{"CG", "[", "\"\<external gauge field\>\"", "]"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", 
    "\"\<We assume that the bosonic field \[Phi] changes slowly on the scale \
of the mass m.  Then one can integrate out fermionic degrees of freedom and \
obtain an induced effective action for the \[Phi]-field as a functional \
determinant.\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$", "=", 
      RowBox[{
       RowBox[{"e", "[", "78", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["S", "eff"], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"Det", "[", "iD", "]"}], "]"}]}]}], ",", 
         RowBox[{"iD", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"I", " ", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tuDPartial", "[", 
                 RowBox[{"_", ",", "\[Mu]"}], "]"}], "-", 
                RowBox[{"I", " ", 
                 RowBox[{"T", "[", 
                  RowBox[{"A", ",", "\"\<d\>\"", ",", 
                   RowBox[{"{", "\[Mu]", "}"}]}], "]"}]}]}], ")"}]}]}], "+", 
            RowBox[{"I", " ", "m", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                  RowBox[{"{", "5", "}"}]}], "]"}], ".", "\[Phi]"}]}], 
              "]"}]}]}], ")"}]}]}], "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", 
    "\"\<We calculate the effective action using the gradient expansion \
method. Namely, we calculate the variation of e[78] with respect to the \
\[Phi] and A-fields and use\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "80", "]"}], "=", 
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          SubscriptBox["S", "eff"], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Delta]", "[", 
            RowBox[{"Log", "[", 
             RowBox[{"Det", "[", "iD", "]"}], "]"}], "]"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Tr", "[", 
             RowBox[{"\[Delta]", "[", 
              RowBox[{"Log", "[", "iD", "]"}], "]"}], "]"}]}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Tr", "[", 
              RowBox[{
               RowBox[{"\[Delta]", "[", "iD", "]"}], ".", 
               RowBox[{"inv", "[", "D", "]"}]}], "]"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"Tr", "[", 
              RowBox[{
               RowBox[{"\[Delta]", "[", "iD", "]"}], ".", 
               RowBox[{"ct", "[", "iD", "]"}], ".", 
               RowBox[{"inv", "[", 
                RowBox[{"D", ".", 
                 RowBox[{"ct", "[", "iD", "]"}]}], "]"}]}], "]"}]}]}]}]}]}], 
        "}"}]}]}], ";", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ColumnForms", "[", 
         RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] (a) Calculate \>\"", ",", 
    RowBox[{"iD", ".", 
     RowBox[{"ct", "[", "iD", "]"}]}], ",", 
    "\"\< for e[79].  Observe that this object depends only on gradients of \
\[Phi]-field.\>\"", ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] (b) Expand \>\"", ",", 
    RowBox[{"inv", "[", 
     RowBox[{"D", ".", 
      RowBox[{"ct", "[", "iD", "]"}]}], "]"}], ",", 
    "\"\< in those gradients. This will be the expansion in 1/m. (It is \
convenient to introduce notation \>\"", ",", 
    RowBox[{
     RowBox[{"inv", "[", 
      SubscriptBox["G", "0"], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"tuDPartial", "[", 
        RowBox[{"_", ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Mu]"}], "}"}]}], "]"}]}], "+", 
      SuperscriptBox["m", "2"]}]}], ",", "\"\<).\>\"", ",", 
    "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] (c) Calculate functional traces of th terms up to the \
order of \!\(\*SuperscriptBox[\(m\), \(0\)]\). Use the plane wave basis to \
calculate the trace \>\"", ",", 
    RowBox[{
     RowBox[{"Tr", "[", 
      OverscriptBox["X", "^"], "]"}], "->", 
     RowBox[{"xIntegral", "[", 
      RowBox[{
       RowBox[{"xIntegral", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"p", ".", "x"}]}], "]"}], ".", 
           OverscriptBox["X", "^"], ".", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", " ", 
             RowBox[{"p", ".", "x"}]}], "]"}]}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}], "2"]}], ",", 
         SuperscriptBox["p", "2"]}], "]"}], ",", 
       SuperscriptBox["x", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", "NL", 
    ",", "\"\<\[Bullet] (d) Identify the variation of the topological term in \
the obtained expression.  It contains the antisymmetric tensor \>\"", ",", 
    RowBox[{"T", "[", 
     RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], ",", 
    "\"\< and is porportional to \>\"", ",", 
    RowBox[{"Sign", "[", "m", "]"}], ",", "\[IndentingNewLine]", "NL", ",", 
    "\"\<\[Bullet] (e) Remove the variation from the obtained expression and \
find \!\(\*SubscriptBox[\(S\), \(eff\)]\) up to the \
\!\(\*SuperscriptBox[\(m\), \(0\)]\) order.\>\"", ",", "\[IndentingNewLine]", 
    "NL", ",", 
    "\"\<\[Bullet] (f) Which terms of the obtained action are topological? \
Can you write tem in terms of differential forms? \>\""}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.796069478003766*^9, 3.79606951759368*^9}, {
  3.7960929716423597`*^9, 3.79609318215831*^9}, {3.7961221805909653`*^9, 
  3.796122206179007*^9}, {3.796122246200832*^9, 3.796122772850853*^9}, {
  3.796122803810288*^9, 3.796123188339313*^9}, {3.796128253859371*^9, 
  3.7961285731841593`*^9}, {3.79612864920569*^9, 3.7961287937237997`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0c834fe7-e792-4d6f-b670-aca71817583c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 10: Fermionic determinant in two dimensions.\\nLet \
us consider two-dimensional fermions coupled to a phase field \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "x", "]"}], ",", 
      RowBox[{"\[Phi]", "\[Rule]", 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]"}], "+", "\[Phi]"}]}]}], "}"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\". The Euclidean Lagrangian is given by \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         SubscriptBox["\[ScriptCapitalL]", "2"], "\[Rule]", 
         RowBox[{
          OverscriptBox["\[Psi]", "_"], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{
                InterpretationBox[
                 SubsuperscriptBox["\[Gamma]", 
                  StyleBox["5",
                   StripOnInput->False,
                   ShowContents->False], "5"],
                 $CellContext`Tensor[$CellContext`\[Gamma], {
                  5}, {$CellContext`Void}],
                 BaseStyle->{AutoMultiplicationSymbol -> False},
                 Editable->False], ".", "\[Phi]"}]}]], " ", "m"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["\[Gamma]", 
                StyleBox["\[Mu]",
                 StripOnInput->False,
                 ShowContents->False], "\[Mu]"],
               $CellContext`Tensor[$CellContext`\[Gamma], \
{$CellContext`\[Mu]}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], " ", 
                 InterpretationBox[
                  SubsuperscriptBox["A", "\[Mu]", 
                   StyleBox["\[Mu]",
                    StripOnInput->False,
                    ShowContents->False]],
                  $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
                  BaseStyle->{AutoMultiplicationSymbol -> False},
                  Editable->False]}], "+", 
                InterpretationBox[
                 RowBox[{
                  SubscriptBox[
                   UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
                  "_", "]"}],
                 $CellContext`tuDDown["\[PartialD]"][
                  Blank[], $CellContext`\[Mu]],
                 Editable->False,
                 SyntaxForm->Automatic]}], ")"}]}]}]}], ")"}], ".", 
          "\[Psi]"}]}]},
       {
        RowBox[{"\[Mu]", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}]},
       {
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["\[Gamma]", 
           StyleBox["\[Mu]",
            StripOnInput->False,
            ShowContents->False], "\[Mu]"],
          $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "[", 
         StyleBox["\<\"Pauli matrices\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]},
       {
        RowBox[{
         InterpretationBox[
          SubsuperscriptBox["A", "\[Mu]", 
           StyleBox["\[Mu]",
            StripOnInput->False,
            ShowContents->False]],
          $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False], "[", 
         StyleBox["\<\"external gauge field\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 
            Rational[2, 3], 0],
          FrontFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          BackFaceColor->RGBColor[0, 
            Rational[2, 3], 0],
          GraphicsColor->RGBColor[0, 
            Rational[2, 3], 0],
          FontFamily->"Helvetica",
          FontColor->RGBColor[0, 
            Rational[2, 3], 0]], "]"}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"We assume that the bosonic field \[Phi] changes slowly on \
the scale of the mass m.  Then one can integrate out fermionic degrees of \
freedom and obtain an induced effective action for the \[Phi]-field as a \
functional determinant.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         SubscriptBox["S", "eff"], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Log", "[", 
           RowBox[{"Det", "[", 
            StyleBox["\<\"D\"\>",
             StripOnInput->False,
             FontSlant->Italic], "]"}], "]"}]}]}]},
       {
        RowBox[{
         StyleBox["\<\"D\"\>",
          StripOnInput->False,
          FontSlant->Italic], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{
              InterpretationBox[
               SubsuperscriptBox["\[Gamma]", 
                StyleBox["5",
                 StripOnInput->False,
                 ShowContents->False], "5"],
               $CellContext`Tensor[$CellContext`\[Gamma], {
                5}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ".", "\[Phi]"}]}]], " ", "m"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["\[Gamma]", 
              StyleBox["\[Mu]",
               StripOnInput->False,
               ShowContents->False], "\[Mu]"],
             $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", 
               InterpretationBox[
                SubsuperscriptBox["A", "\[Mu]", 
                 StyleBox["\[Mu]",
                  StripOnInput->False,
                  ShowContents->False]],
                $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
                BaseStyle->{AutoMultiplicationSymbol -> False},
                Editable->False]}], "+", 
              InterpretationBox[
               RowBox[{
                SubscriptBox[
                 UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
                "_", "]"}],
               $CellContext`tuDDown["\[PartialD]"][
                Blank[], $CellContext`\[Mu]],
               Editable->False,
               SyntaxForm->Automatic]}], ")"}]}]}]}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"We calculate the effective action using the gradient \
expansion method. Namely, we calculate the variation of e[78] with respect to \
the \[Phi] and A-fields and use\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"\[Delta]", "[", 
          SubscriptBox["S", "eff"], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Delta]", "[", 
            RowBox[{"Log", "[", 
             RowBox[{"Det", "[", 
              StyleBox["\<\"D\"\>",
               StripOnInput->False,
               FontSlant->Italic], "]"}], "]"}], "]"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Tr", "[", 
             RowBox[{"\[Delta]", "[", 
              RowBox[{"Log", "[", 
               StyleBox["\<\"D\"\>",
                StripOnInput->False,
                FontSlant->Italic], "]"}], "]"}], "]"}]}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Tr", "[", 
              RowBox[{
               RowBox[{"\[Delta]", "[", 
                StyleBox["\<\"D\"\>",
                 StripOnInput->False,
                 FontSlant->Italic], "]"}], ".", 
               SuperscriptBox["D", "\<\"-1\"\>"]}], "]"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"Tr", "[", 
              RowBox[{
               RowBox[{"\[Delta]", "[", 
                StyleBox["\<\"D\"\>",
                 StripOnInput->False,
                 FontSlant->Italic], "]"}], ".", 
               InterpretationBox[
                SuperscriptBox[
                 StyleBox["\<\"D\"\>",
                  StripOnInput->False,
                  FontSlant->Italic], "\[Dagger]"],
                ConjugateTranspose[
                 Style["D", Italic]],
                Editable->False,
                SyntaxForm->Automatic], ".", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"D", ".", 
                  InterpretationBox[
                   SuperscriptBox[
                    StyleBox["\<\"D\"\>",
                    StripOnInput->False,
                    FontSlant->Italic], "\[Dagger]"],
                   ConjugateTranspose[
                    Style["D", Italic]],
                   Editable->False,
                   SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"]}], 
              "]"}]}]}]}]}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] (a) Calculate \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     StyleBox["\<\"D\"\>",
      StripOnInput->False,
      FontSlant->Italic], ".", 
     InterpretationBox[
      SuperscriptBox[
       StyleBox["\<\"D\"\>",
        StripOnInput->False,
        FontSlant->Italic], "\[Dagger]"],
      ConjugateTranspose[
       Style["D", Italic]],
      Editable->False,
      SyntaxForm->Automatic]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" for e[79].  Observe that this object depends only on \
gradients of \[Phi]-field.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] (b) Expand \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"D", ".", 
       InterpretationBox[
        SuperscriptBox[
         StyleBox["\<\"D\"\>",
          StripOnInput->False,
          FontSlant->Italic], "\[Dagger]"],
        ConjugateTranspose[
         Style["D", Italic]],
        Editable->False,
        SyntaxForm->Automatic]}], ")"}], "\<\"-1\"\>"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" in those gradients. This will be the expansion in 1/m. (It \
is convenient to introduce notation \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     SubsuperscriptBox["G", "0", "\<\"-1\"\>"], "\[Rule]", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\<\"\[PartialD]\"\>", "_"], 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "\[Mu]"}], "}"}]], "[", "_", "]"}],
       $CellContext`tuDDown["\[PartialD]"][
        Blank[], {$CellContext`\[Mu], $CellContext`\[Mu]}],
       Editable->False,
       SyntaxForm->Automatic]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\").\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] (c) Calculate functional traces of th terms up to \
the order of \\!\\(\\*SuperscriptBox[\\(m\\), \\(0\\)]\\). Use the plane wave \
basis to calculate the trace \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"Tr", "[", 
      OverscriptBox["X", "^"], "]"}], "\[Rule]", 
     TemplateBox[{TemplateBox[{
         FractionBox[
          RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", 
               RowBox[{"p", ".", "x"}]}]], ".", 
            OverscriptBox["X", "^"], ".", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"p", ".", "x"}]}]]}], 
          RowBox[{"4", " ", 
            SuperscriptBox["\[Pi]", "2"]}]], 
         SuperscriptBox["p", "2"]}, "InactiveIntegrate", 
        DisplayFunction -> (RowBox[{
           StyleBox["\[Integral]", "Inactive"], 
           RowBox[{#, 
             RowBox[{
               StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ), 
        InterpretationFunction -> (RowBox[{
           RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
           RowBox[{#, ",", #2}], "]"}]& )],SuperscriptBox["x", "2"]},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         StyleBox["\[Integral]", "Inactive"], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", #2}], "]"}]& )]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] (d) Identify the variation of the topological term \
in the obtained expression.  It contains the antisymmetric tensor \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    InterpretationBox[
     SubsuperscriptBox["\[Epsilon]", 
      StyleBox[
       RowBox[{"\[Mu]", "\[Nu]"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"\[Mu]", "\[Nu]"}]],
     $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" and is porportional to \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"Sign", "[", "m", "]"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] (e) Remove the variation from the obtained \
expression and find \\!\\(\\*SubscriptBox[\\(S\\), \\(eff\\)]\\) up to the \
\\!\\(\\*SuperscriptBox[\\(m\\), \\(0\\)]\\) order.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"\[Bullet] (f) Which terms of the obtained action are \
topological? Can you write tem in terms of differential forms? \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 10: Fermionic determinant in two dimensions.\nLet us \
consider two-dimensional fermions coupled to a phase field ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[{
     $CellContext`\[Phi][$CellContext`x], $CellContext`\[Phi] -> 
     2 Pi + $CellContext`\[Phi]}, 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[". The Euclidean Lagrangian is given by ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{Subscript[$CellContext`\[ScriptCapitalL], 2] -> Dot[
         OverBar[$CellContext`\[Psi]], Complex[0, 1] E^(Complex[0, 1] Dot[
              $CellContext`Tensor[$CellContext`\[Gamma], {
               5}, {$CellContext`Void}], $CellContext`\[Phi]]) $CellContext`m + 
         Complex[0, 1] Dot[
            $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}], 
            Complex[0, -1] $CellContext`Tensor[$CellContext`A, \
{$CellContext`Void}, {$CellContext`\[Mu]}] + $CellContext`tuDDown[
             "\[PartialD]"][
              
              Blank[], $CellContext`\[Mu]]], $CellContext`\[Psi]]}, \
{$CellContext`\[Mu] -> {1, 2}}, {
       $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}][
        Style["Pauli matrices", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]]}, {
       $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}][
        Style["external gauge field", 
         RGBColor[0, 
          Rational[2, 3], 0], FontFamily -> "Helvetica"]]}}, 
     Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["We assume that the bosonic field \[Phi] changes slowly on the scale \
of the mass m.  Then one can integrate out fermionic degrees of freedom and \
obtain an induced effective action for the \[Phi]-field as a functional \
determinant.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{Subscript[$CellContext`S, $CellContext`eff] -> -Log[
          Det[
           Style["D", Italic]]]}, {
      Style["D", Italic] -> Complex[0, 1] E^(Complex[0, 1] Dot[
             $CellContext`Tensor[$CellContext`\[Gamma], {
              5}, {$CellContext`Void}], $CellContext`\[Phi]]) $CellContext`m + 
        Complex[0, 1] Dot[
           $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}], 
           Complex[0, -1] $CellContext`Tensor[$CellContext`A, \
{$CellContext`Void}, {$CellContext`\[Mu]}] + $CellContext`tuDDown[
            "\[PartialD]"][
             Blank[], $CellContext`\[Mu]]]}}, Dividers -> {{True}, {False}}, 
     FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["We calculate the effective action using the gradient expansion \
method. Namely, we calculate the variation of e[78] with respect to the \
\[Phi] and A-fields and use", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{$CellContext`\[Delta][
         Subscript[$CellContext`S, $CellContext`eff]] -> (-$CellContext`\
\[Delta][
           Log[
            Det[
             Style["D", Italic]]]] -> (-Tr[
            $CellContext`\[Delta][
             Log[
              Style["D", Italic]]]] -> (-Tr[
             Dot[
              $CellContext`\[Delta][
               Style["D", Italic]], D^"-1"]] -> -Tr[
             Dot[
              $CellContext`\[Delta][
               Style["D", Italic]], 
              ConjugateTranspose[
               Style["D", Italic]], Dot[D, 
                ConjugateTranspose[
                 Style["D", Italic]]]^"-1"]])))}}, 
     Dividers -> {{True}, {False}}, FrameStyle -> Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] (a) Calculate ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Dot[
     Style["D", Italic], 
     ConjugateTranspose[
      Style["D", Italic]]], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" for e[79].  Observe that this object depends only on gradients of \
\[Phi]-field.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] (b) Expand ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Dot[D, 
      ConjugateTranspose[
       Style["D", Italic]]]^"-1", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" in those gradients. This will be the expansion in 1/m. (It is \
convenient to introduce notation ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Subscript[$CellContext`G, 0]^
     "-1" -> $CellContext`m^2 - $CellContext`tuDDown["\[PartialD]"][
      Blank[], {$CellContext`\[Mu], $CellContext`\[Mu]}], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[").", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] (c) Calculate functional traces of th terms up to the \
order of \!\(\*SuperscriptBox[\(m\), \(0\)]\). Use the plane wave basis to \
calculate the trace ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Tr[
      OverHat[$CellContext`X]] -> Inactive[Integrate][
      Inactive[Integrate][
      Rational[1, 4] Pi^(-2) 
       Dot[E^(Complex[0, -1] Dot[$CellContext`p, $CellContext`x]), 
         OverHat[$CellContext`X], 
         E^(Complex[0, 1] 
          Dot[$CellContext`p, $CellContext`x])], $CellContext`p^2], \
$CellContext`x^2], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] (d) Identify the variation of the topological term in the \
obtained expression.  It contains the antisymmetric tensor ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" and is porportional to ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Sign[$CellContext`m], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] (e) Remove the variation from the obtained expression and \
find \!\(\*SubscriptBox[\(S\), \(eff\)]\) up to the \
\!\(\*SuperscriptBox[\(m\), \(0\)]\) order.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\n", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["\[Bullet] (f) Which terms of the obtained action are topological? \
Can you write tem in terms of differential forms? ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.8001885514483557`*^9, 3.800188915189393*^9, 
  3.8002678539987497`*^9},ExpressionUUID->"dacc7e62-1edc-436f-8fce-\
f1b97e2141a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PR", "[", 
   RowBox[{"CO", "[", 
    RowBox[{
    "\"\<Exercise 11: Dangers of chiral rotation\nTry to calculate the \
determinant of the previous exercise using the chiral rotation trick.  \
Namely, consider chiral rotation \>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$", "=", 
        RowBox[{"\[Psi]", "\[Rule]", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                RowBox[{"{", "5", "}"}]}], "]"}], ".", "\[Phi]"}], "/", 
             "2"}]}], "]"}], ".", "\[Psi]"}]}]}], ",", 
       RowBox[{"ct", "/@", "$"}], ",", 
       RowBox[{"OverBar", "/@", "$"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\"\<Use the identity \>\"", ",", 
     RowBox[{"$si", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ".", 
        RowBox[{"T", "[", 
         RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "5", "}"}]}], "]"}]}], "\[Rule]", 
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"T", "[", 
         RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], 
        RowBox[{"T", "[", 
         RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "\[Nu]", "}"}]}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     "\"\< and the anti-commutativity of Pauli matrices to show that the \
operator \>\"", ",", 
     RowBox[{
      RowBox[{"$", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"iD", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"A", ",", "\"\<d\>\"", ",", 
             RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ",", "\[Phi]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           OverscriptBox["iD", "~"], "[", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"A", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ",", "\[Phi]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "5", "}"}]}], "]"}], ".", "\[Phi]"}], "/", 
              "2"}]}], "]"}], ".", 
           RowBox[{"iD", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"A", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ",", "\[Phi]"}], "]"}], 
           ".", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"\[Gamma]", ",", "\"\<u\>\"", ",", 
                 RowBox[{"{", "5", "}"}]}], "]"}], ".", "\[Phi]"}], "/", 
              "2"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           OverscriptBox["iD", "~"], "[", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"A", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ",", "\[Phi]"}], "]"}], "->", 
          RowBox[{"iD", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"A", ",", "\"\<d\>\"", ",", 
               RowBox[{"{", "\[Mu]", "}"}]}], "]"}], "+", 
             RowBox[{
              RowBox[{"I", "/", "2"}], " ", 
              RowBox[{"T", "[", 
               RowBox[{"\[Epsilon]", ",", "\"\<uu\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], 
              RowBox[{"tuDPartial", "[", 
               RowBox[{"\[Phi]", ",", "\[Nu]"}], "]"}]}]}], ",", "0"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           OverscriptBox["iD", "~"], "[", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"A", ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ",", "\[Phi]"}], "]"}], "->", 
          RowBox[{
           OverscriptBox["iD", "~"], "[", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{
              OverscriptBox["A", "~"], ",", "\"\<d\>\"", ",", 
              RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ",", "0"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ColumnForms", "[", 
          RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "$", "]"}]}], 
     ",", "\[IndentingNewLine]", "\"\<Try to calculate \>\"", ",", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"Det", "[", 
        OverscriptBox["iD", "~"], "]"}], "]"}], "\[Rule]", 
      RowBox[{"Log", "[", 
       RowBox[{"Det", "[", 
        RowBox[{"iD", "[", 
         RowBox[{
          OverscriptBox["A", "~"], ",", "0"}], "]"}], "]"}], "]"}]}], ",", 
     "\"\< using expansion in \!\(\*OverscriptBox[\(A\), \(~\)]\). You will \
see that the result does not match the effective action obtained in the \
previous exercise. Why? What should one add to the chiral rotation trick to \
make the correct calculation? Answer: The Jacobian of the change of variables \
corresponding to the chiral rotation.\>\""}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.7961275799315557`*^9, {3.7961288153297997`*^9, 3.796128966062581*^9}, {
   3.796129001705711*^9, 3.7961290217689342`*^9}, {3.796129051769184*^9, 
   3.796129099904331*^9}, {3.796129135202433*^9, 3.7961291524727488`*^9}, {
   3.796129187393594*^9, 3.796129551367432*^9}, {3.796129592830126*^9, 
   3.796129948211351*^9}, {3.796129987686699*^9, 3.796130002642994*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1b81ab08-eef7-4470-b152-ae1b75310cd5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Exercise 11: Dangers of chiral rotation\\nTry to calculate \
the determinant of the previous exercise using the chiral rotation trick.  \
Namely, consider chiral rotation \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Psi]", "\[Rule]", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["\[Gamma]", 
             StyleBox["5",
              StripOnInput->False,
              ShowContents->False], "5"],
            $CellContext`Tensor[$CellContext`\[Gamma], {
             5}, {$CellContext`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ".", "\[Phi]"}]}]], ".", "\[Psi]"}]}], ",", 
      RowBox[{
       InterpretationBox[
        SuperscriptBox["\[Psi]", "\[Dagger]"],
        ConjugateTranspose[$CellContext`\[Psi]],
        Editable->False,
        SyntaxForm->Automatic], "\[Rule]", 
       RowBox[{
        InterpretationBox[
         SuperscriptBox["\[Psi]", "\[Dagger]"],
         ConjugateTranspose[$CellContext`\[Psi]],
         Editable->False,
         SyntaxForm->Automatic], ".", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
          RowBox[{
           InterpretationBox[
            SuperscriptBox["\[Phi]", "\[Dagger]"],
            ConjugateTranspose[$CellContext`\[Phi]],
            Editable->False,
            SyntaxForm->Automatic], ".", 
           InterpretationBox[
            SuperscriptBox[
             RowBox[{"(", 
              InterpretationBox[
               SubsuperscriptBox["\[Gamma]", 
                StyleBox["5",
                 StripOnInput->False,
                 ShowContents->False], "5"],
               $CellContext`Tensor[$CellContext`\[Gamma], {
                5}, {$CellContext`Void}],
               BaseStyle->{AutoMultiplicationSymbol -> False},
               Editable->False], ")"}], "\[Dagger]"],
            ConjugateTranspose[
             $CellContext`Tensor[$CellContext`\[Gamma], {
              5}, {$CellContext`Void}]],
            Editable->False,
            SyntaxForm->Automatic]}]}]]}]}], ",", 
      RowBox[{
       OverscriptBox["\[Psi]", "_"], "\[Rule]", 
       OverscriptBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["\[Gamma]", 
              StyleBox["5",
               StripOnInput->False,
               ShowContents->False], "5"],
             $CellContext`Tensor[$CellContext`\[Gamma], {
              5}, {$CellContext`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ".", "\[Phi]"}]}]], ".", "\[Psi]"}], "_"]}]}], 
     "}"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"Use the identity \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{
      InterpretationBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox["\[Mu]",
         StripOnInput->False,
         ShowContents->False], "\[Mu]"],
       $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], ".", 
      InterpretationBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox["5",
         StripOnInput->False,
         ShowContents->False], "5"],
       $CellContext`Tensor[$CellContext`\[Gamma], {5}, {$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Gamma]", 
        StyleBox["\[Nu]",
         StripOnInput->False,
         ShowContents->False], "\[Nu]"],
       $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Nu]}, \
{$CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False], " ", 
      InterpretationBox[
       SubsuperscriptBox["\[Epsilon]", 
        StyleBox[
         RowBox[{"\[Mu]", "\[Nu]"}],
         StripOnInput->False,
         ShowContents->False], 
        RowBox[{"\[Mu]", "\[Nu]"}]],
       $CellContext`Tensor[$CellContext`\[Epsilon], {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {$CellContext`Void, $CellContext`Void}],
       BaseStyle->{AutoMultiplicationSymbol -> False},
       Editable->False]}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" and the anti-commutativity of Pauli matrices to show that \
the operator \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {
        RowBox[{
         StyleBox["\<\"D\"\>",
          StripOnInput->False,
          FontSlant->Italic], "[", 
         RowBox[{
          InterpretationBox[
           SubsuperscriptBox["A", "\[Mu]", 
            StyleBox["\[Mu]",
             StripOnInput->False,
             ShowContents->False]],
           $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
           BaseStyle->{AutoMultiplicationSymbol -> False},
           Editable->False], ",", "\[Phi]"}], "]"}]},
       {
        RowBox[{
         RowBox[{
          OverscriptBox[
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "~"], "[", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["A", "\[Mu]", 
             StyleBox["\[Mu]",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", "\[Phi]"}], "]"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["\[Gamma]", 
               StyleBox["5",
                StripOnInput->False,
                ShowContents->False], "5"],
              $CellContext`Tensor[$CellContext`\[Gamma], {
               5}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ".", "\[Phi]"}]}]], ".", 
          RowBox[{
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "[", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["A", "\[Mu]", 
              StyleBox["\[Mu]",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ",", "\[Phi]"}], "]"}], ".", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
            RowBox[{
             InterpretationBox[
              SubsuperscriptBox["\[Gamma]", 
               StyleBox["5",
                StripOnInput->False,
                ShowContents->False], "5"],
              $CellContext`Tensor[$CellContext`\[Gamma], {
               5}, {$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ".", "\[Phi]"}]}]]}]}]},
       {
        RowBox[{
         RowBox[{
          OverscriptBox[
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "~"], "[", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["A", "\[Mu]", 
             StyleBox["\[Mu]",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", "\[Phi]"}], "]"}], "\[Rule]", 
         RowBox[{
          StyleBox["\<\"D\"\>",
           StripOnInput->False,
           FontSlant->Italic], "[", 
          RowBox[{
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["A", "\[Mu]", 
              StyleBox["\[Mu]",
               StripOnInput->False,
               ShowContents->False]],
             $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
             InterpretationBox[
              SubsuperscriptBox["\[Epsilon]", 
               StyleBox[
                RowBox[{"\[Mu]", "\[Nu]"}],
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"\[Mu]", "\[Nu]"}]],
              $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], " ", 
             InterpretationBox[
              RowBox[{
               SubscriptBox[
                UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", 
               "\[Phi]", "]"}],
              $CellContext`tuDDown[
              "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Nu]],
              Editable->False,
              SyntaxForm->Automatic]}]}], ",", "0"}], "]"}]}]},
       {
        RowBox[{
         RowBox[{
          OverscriptBox[
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "~"], "[", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["A", "\[Mu]", 
             StyleBox["\[Mu]",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", "\[Phi]"}], "]"}], "\[Rule]", 
         RowBox[{
          OverscriptBox[
           StyleBox["\<\"D\"\>",
            StripOnInput->False,
            FontSlant->Italic], "~"], "[", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox[
             OverscriptBox["A", "~"], "\[Mu]", 
             StyleBox["\[Mu]",
              StripOnInput->False,
              ShowContents->False]],
            $CellContext`Tensor[
             
             OverTilde[$CellContext`A], {$CellContext`Void}, {$CellContext`\
\[Mu]}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], ",", "0"}], "]"}]}]}
      },
      AutoDelete->False,
      FrameStyle->Directive[
        RGBColor[0.7, 0, 1, 1], 
        Thickness[Tiny]],
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxDividers->{"Columns" -> {True}, "Rows" -> {False}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Grid"],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\"Try to calculate \"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox[
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Det", "[", 
       OverscriptBox[
        StyleBox["\<\"D\"\>",
         StripOnInput->False,
         FontSlant->Italic], "~"], "]"}], "]"}], "\[Rule]", 
     RowBox[{"Log", "[", 
      RowBox[{"Det", "[", 
       RowBox[{
        StyleBox["\<\"D\"\>",
         StripOnInput->False,
         FontSlant->Italic], "[", 
        RowBox[{
         OverscriptBox["A", "~"], ",", "0"}], "]"}], "]"}], "]"}]}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]], "\[InvisibleSpace]", 
   StyleBox["\<\" using expansion in \\!\\(\\*OverscriptBox[\\(A\\), \\(~\\)]\
\\). You will see that the result does not match the effective action \
obtained in the previous exercise. Why? What should one add to the chiral \
rotation trick to make the correct calculation? Answer: The Jacobian of the \
change of variables corresponding to the chiral rotation.\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0.5, 0],
    FrontFaceColor->RGBColor[1, 0.5, 0],
    BackFaceColor->RGBColor[1, 0.5, 0],
    GraphicsColor->RGBColor[1, 0.5, 0],
    FontFamily->"Helvetica",
    FontColor->RGBColor[1, 0.5, 0]]}],
  SequenceForm[
   Style["Exercise 11: Dangers of chiral rotation\nTry to calculate the \
determinant of the previous exercise using the chiral rotation trick.  \
Namely, consider chiral rotation ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[{$CellContext`\[Psi] -> Dot[E^(Complex[0, 
          Rational[-1, 2]] Dot[
          $CellContext`Tensor[$CellContext`\[Gamma], {
           5}, {$CellContext`Void}], $CellContext`\[Phi]]), $CellContext`\
\[Psi]], ConjugateTranspose[$CellContext`\[Psi]] -> Dot[
       ConjugateTranspose[$CellContext`\[Psi]], E^(Complex[0, 
          Rational[1, 2]] Dot[
          ConjugateTranspose[$CellContext`\[Phi]], 
          ConjugateTranspose[
           $CellContext`Tensor[$CellContext`\[Gamma], {
            5}, {$CellContext`Void}]]])], OverBar[$CellContext`\[Psi]] -> 
     OverBar[
       Dot[E^(Complex[0, 
           Rational[-1, 2]] Dot[
           $CellContext`Tensor[$CellContext`\[Gamma], {
            5}, {$CellContext`Void}], $CellContext`\[Phi]]), $CellContext`\
\[Psi]]]}, 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["Use the identity ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Dot[
      $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\[Mu]}, \
{$CellContext`Void}], 
      $CellContext`Tensor[$CellContext`\[Gamma], {5}, {$CellContext`Void}]] -> 
    Complex[0, -1] $CellContext`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Nu]}, {$CellContext`Void}] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" and the anti-commutativity of Pauli matrices to show that the \
operator ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[
    Grid[{{
       Style["D", Italic][
        $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}], $CellContext`\[Phi]]}, {OverTilde[
         Style["D", Italic]][
         $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}], $CellContext`\[Phi]] -> Dot[E^(Complex[0, 
            Rational[-1, 2]] Dot[
            $CellContext`Tensor[$CellContext`\[Gamma], {
             5}, {$CellContext`Void}], $CellContext`\[Phi]]), 
         Style["D", Italic][
          $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}], $CellContext`\[Phi]], E^(Complex[0, 
            Rational[-1, 2]] Dot[
            $CellContext`Tensor[$CellContext`\[Gamma], {
             5}, {$CellContext`Void}], $CellContext`\[Phi]])]}, {OverTilde[
         Style["D", Italic]][
         $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}], $CellContext`\[Phi]] -> 
       Style["D", 
         Italic][$CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}] + Complex[0, 
            Rational[
            1, 2]] $CellContext`Tensor[$CellContext`\[Epsilon], \
{$CellContext`\[Mu], $CellContext`\[Nu]}, {$CellContext`Void, \
$CellContext`Void}] $CellContext`tuDDown[
           "\[PartialD]"][$CellContext`\[Phi], $CellContext`\[Nu]], 0]}, {
      OverTilde[
         Style["D", Italic]][
         $CellContext`Tensor[$CellContext`A, {$CellContext`Void}, \
{$CellContext`\[Mu]}], $CellContext`\[Phi]] -> OverTilde[
         Style["D", Italic]][
         $CellContext`Tensor[
          
          OverTilde[$CellContext`A], {$CellContext`Void}, \
{$CellContext`\[Mu]}], 0]}}, Dividers -> {{True}, {False}}, FrameStyle -> 
     Directive[
       RGBColor[0.7, 0, 1, 1], 
       Thickness[Tiny]], Alignment -> Left], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style["Try to calculate ", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[Log[
      Det[
       OverTilde[
        Style["D", Italic]]]] -> Log[
      Det[
       Style["D", Italic][
        OverTilde[$CellContext`A], 0]]], 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"], 
   Style[" using expansion in \!\(\*OverscriptBox[\(A\), \(~\)]\). You will \
see that the result does not match the effective action obtained in the \
previous exercise. Why? What should one add to the chiral rotation trick to \
make the correct calculation? Answer: The Jacobian of the change of variables \
corresponding to the chiral rotation.", 
    RGBColor[1, 0.5, 0], FontFamily -> "Helvetica"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.80018855161685*^9, 3.8001889153085337`*^9, 
  3.8002678540990343`*^9},ExpressionUUID->"f9e30f7b-c06d-422e-822c-\
7f2d1b0c9769"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$j", "=", 
  RowBox[{
   SubscriptBox["J", "z"], "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], " ", 
     RowBox[{"tuDPartial", "[", 
      RowBox[{"_", ",", "\[Phi]"}], "]"}]}], "+", 
    "j"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$", "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["J", "z"], ".", "\[Psi]"}], "\[Rule]", 
   RowBox[{"e", "  ", "\[Psi]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"$", "/.", "$j"}], "//", 
     RowBox[{"tuBlankOpNest", "[", "]"}]}], "//", 
    RowBox[{"tuArgAdd", "[", 
     RowBox[{"\[Psi]", ",", "\[Phi]"}], "]"}]}], "//", 
   "tuDerivOps2D"}]}], "\[IndentingNewLine]", 
 RowBox[{"$", "=", 
  RowBox[{
   RowBox[{"$", "/.", "toTimes"}], "/.", "toEqual"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{"$", ",", 
    RowBox[{"\[Psi]", "[", "\[Phi]", "]"}], ",", "\[Phi]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.800701065058991*^9, 3.800701186834408*^9}, {
  3.800701228921419*^9, 3.800701460142543*^9}, {3.800701893995345*^9, 
  3.800701907839244*^9}, {3.800708450467956*^9, 
  3.800708463464397*^9}},ExpressionUUID->"7cfa486b-ea47-49fb-89ee-\
874d56ee3864"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "z"], "\[Rule]", 
  RowBox[{"j", "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    InterpretationBox[
     RowBox[{
      SubscriptBox[
       UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Phi]"], "[", "_", 
      "]"}],
     $CellContext`tuDDown["\[PartialD]"][
      Blank[], $CellContext`\[Phi]],
     Editable->False,
     SyntaxForm->Automatic]}]}]}]], "Output",
 CellChangeTimes->{
  3.800701106286716*^9, 3.8007011650300503`*^9, {3.800701252009046*^9, 
   3.80070129052806*^9}, 3.800701346461522*^9, {3.800701384787553*^9, 
   3.800701430990348*^9}, 
   3.80070146263192*^9},ExpressionUUID->"45c04262-70fe-47a0-8b75-\
c8a3d4d27f72"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["J", "z"], ".", "\[Psi]"}], "\[Rule]", 
  RowBox[{"e", " ", "\[Psi]"}]}]], "Output",
 CellChangeTimes->{
  3.800701106286716*^9, 3.8007011650300503`*^9, {3.800701252009046*^9, 
   3.80070129052806*^9}, 3.800701346461522*^9, {3.800701384787553*^9, 
   3.800701430990348*^9}, 
   3.8007014626402903`*^9},ExpressionUUID->"af22278b-243e-4a12-9a72-\
6976b66f5bf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"j", ".", 
    RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{
     SuperscriptBox["\[Psi]", "\[Prime]",
      MultilineFunction->None], "[", "\[Phi]", "]"}]}]}], "\[Rule]", 
  RowBox[{"e", ".", 
   RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.800701106286716*^9, 3.8007011650300503`*^9, {3.800701252009046*^9, 
   3.80070129052806*^9}, 3.800701346461522*^9, {3.800701384787553*^9, 
   3.800701430990348*^9}, 
   3.800701462645296*^9},ExpressionUUID->"ea98ccf5-a11d-4447-9b9b-\
8d33f8fa8026"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"j", " ", 
    RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}], "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{
     SuperscriptBox["\[Psi]", "\[Prime]",
      MultilineFunction->None], "[", "\[Phi]", "]"}]}]}], "\[Equal]", 
  RowBox[{"e", " ", 
   RowBox[{"\[Psi]", "[", "\[Phi]", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.800701106286716*^9, 3.8007011650300503`*^9, {3.800701252009046*^9, 
   3.80070129052806*^9}, 3.800701346461522*^9, {3.800701384787553*^9, 
   3.800701430990348*^9}, 
   3.8007014626504393`*^9},ExpressionUUID->"d68ff6ab-3f4a-4720-bfd0-\
7307240cf2cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "\[Phi]", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "e", " ", "\[Phi]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "j", " ", "\[Phi]"}]}]], " ", 
     RowBox[{"C", "[", "1", "]"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.800701106286716*^9, 3.8007011650300503`*^9, {3.800701252009046*^9, 
   3.80070129052806*^9}, 3.800701346461522*^9, {3.800701384787553*^9, 
   3.800701430990348*^9}, 
   3.80070146270747*^9},ExpressionUUID->"21f4cdc9-fbad-4544-bd2b-\
9055d0fcf45c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{843, 680},
WindowMargins->{{50, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"tuTensorialStyle.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 728, 12, 57, "Input",ExpressionUUID->"5fbe7f1f-bb50-45f0-a196-f918e4732957",
 InitializationCell->True],
Cell[1311, 36, 232, 4, 25, "Output",ExpressionUUID->"5e97429d-8dca-47f8-9c3f-3e699e9a1d50"]
}, Open  ]],
Cell[1558, 43, 304, 7, 79, "Section",ExpressionUUID->"0ac4dab0-4cd0-4d9b-a985-bd0415c877ed"],
Cell[CellGroupData[{
Cell[1887, 54, 155, 3, 32, "Section",ExpressionUUID->"72d21847-5b16-4c32-9725-b73476101bef"],
Cell[2045, 59, 634, 14, 30, "InlineFormula",ExpressionUUID->"466d7187-6c67-45bb-9daf-32627d6d30b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2716, 78, 166, 3, 52, "Section",ExpressionUUID->"d6dd88c9-bc1d-48d0-bc63-b79b0a93b3f3"],
Cell[CellGroupData[{
Cell[2907, 85, 1275, 37, 103, "Code",ExpressionUUID->"15c8e8a3-b541-4ed5-a9d2-c0cc7d54962d"],
Cell[4185, 124, 1926, 57, 46, "Output",ExpressionUUID->"91d0aedc-04dc-43ef-bb85-f346fea872b0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6160, 187, 189, 3, 52, "Section",ExpressionUUID->"7e555e1f-5a96-4217-bb6b-7f805621b557"],
Cell[CellGroupData[{
Cell[6374, 194, 180, 3, 47, "Subsection",ExpressionUUID->"f7c569ef-76f9-4d72-8d27-f76ea5d95d90"],
Cell[CellGroupData[{
Cell[6579, 201, 4671, 117, 252, "Input",ExpressionUUID->"518a0ad7-d6d4-4b64-baf6-255975dc9e48",
 InitializationCell->False],
Cell[11253, 320, 8252, 234, 194, "Print",ExpressionUUID->"2ebb2354-5489-46a2-8509-33821bd3060b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19554, 560, 176, 2, 47, "Subsection",ExpressionUUID->"fd6d9595-7898-43a5-a473-76b576704950"],
Cell[CellGroupData[{
Cell[19755, 566, 7092, 147, 251, "Input",ExpressionUUID->"638ac9e5-e8ab-4a41-b8f1-08a474072ca3"],
Cell[26850, 715, 9294, 275, 258, "Output",ExpressionUUID->"163b688b-ecca-4d89-93c5-08db77b4f7f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36193, 996, 242, 6, 47, "Subsection",ExpressionUUID->"55d85157-d3d1-4a02-a04d-23bc7a63194c"],
Cell[CellGroupData[{
Cell[36460, 1006, 7667, 185, 314, "Input",ExpressionUUID->"0810582f-884c-415f-825d-cc1b941d0849"],
Cell[44130, 1193, 16783, 411, 234, "Output",ExpressionUUID->"40d92aef-92f2-486b-8b31-a2fb40535486"]
}, Open  ]],
Cell[60928, 1607, 170, 3, 42, "Subsubsection",ExpressionUUID->"a6a27bad-5ce2-449a-8885-76aa00e99293"],
Cell[CellGroupData[{
Cell[61123, 1614, 241, 4, 28, "Subsubsection",ExpressionUUID->"14573c17-dbf0-4e74-bdc1-4a1c595a0ffb"],
Cell[CellGroupData[{
Cell[61389, 1622, 1068, 30, 106, "Input",ExpressionUUID->"f405734f-e899-4ab8-ac08-e1294930b0ae"],
Cell[62460, 1654, 1956, 53, 54, "Print",ExpressionUUID->"a3a81949-a45c-4680-aaac-8b8478e75e54"]
}, Open  ]]
}, Open  ]],
Cell[64443, 1711, 199, 3, 42, "Subsubsection",ExpressionUUID->"6405ae2e-a2cc-44b6-9bec-abfb98636916"],
Cell[64645, 1716, 196, 3, 28, "Subsubsection",ExpressionUUID->"ee2e0258-092b-498c-a6dd-0718c7fa6f0c"],
Cell[64844, 1721, 213, 4, 28, "Subsubsection",ExpressionUUID->"560b51ae-d720-40bb-acab-5bbe965a1398"],
Cell[CellGroupData[{
Cell[65082, 1729, 164, 3, 28, "Subsubsection",ExpressionUUID->"555164ed-fd16-48e9-ba05-bfa36d8d4b0c"],
Cell[65249, 1734, 224, 3, 45, "Text",ExpressionUUID->"2c522b4a-f377-4ad4-a323-1879c50064ee"],
Cell[CellGroupData[{
Cell[65498, 1741, 16008, 385, 839, "Input",ExpressionUUID->"bb190453-d07f-4802-8732-909c1a7c07ca"],
Cell[81509, 2128, 31214, 780, 608, "Print",ExpressionUUID->"c4cd1c3c-c62e-44be-8d73-f5430591e6cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112760, 2913, 14009, 337, 717, "Input",ExpressionUUID->"25ef077c-7ff3-4e1f-a767-faeda182611c"],
Cell[126772, 3252, 38803, 1026, 653, "Print",ExpressionUUID->"9316f33d-fe97-4e9b-9b0f-22447c6fbf56"]
}, Open  ]],
Cell[165590, 4281, 239, 4, 29, "Text",ExpressionUUID->"d098bf65-1821-4694-9914-5b7f48909d14"],
Cell[CellGroupData[{
Cell[165854, 4289, 2779, 70, 186, "Input",ExpressionUUID->"b1beca73-91e5-45ef-8abc-1deb8635bf8d"],
Cell[168636, 4361, 9344, 264, 188, "Print",ExpressionUUID->"47e1ad5c-e301-4686-9b1d-b7535ee0794f"]
}, Open  ]],
Cell[177995, 4628, 199, 3, 29, "Text",ExpressionUUID->"09a1e7d1-0130-4191-b007-6c162d63a6a3"],
Cell[CellGroupData[{
Cell[178219, 4635, 8643, 205, 340, "Input",ExpressionUUID->"9a9bf8d8-3cbb-498a-bc24-7107bccb6953"],
Cell[186865, 4842, 25940, 618, 488, "Print",ExpressionUUID->"a3fe551a-a935-49dc-ab17-b83a33c9acb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212842, 5465, 4530, 106, 221, "Input",ExpressionUUID->"8d0830d0-6691-41ff-b1d6-11d849245960"],
Cell[217375, 5573, 30171, 808, 274, "Print",ExpressionUUID->"cb71b5ca-05cd-4422-9a07-a5df15e24469"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247583, 6386, 5162, 137, 361, "Input",ExpressionUUID->"8fffeb94-a9a8-4179-b77f-c09c8d6f8802"],
Cell[252748, 6525, 24495, 619, 392, "Print",ExpressionUUID->"0ce925aa-d563-4c28-bfe9-d7c51deaec17"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[277316, 7152, 178, 3, 52, "Section",ExpressionUUID->"ca95ee77-9fec-40e5-8a4d-00fc31d9f57e"],
Cell[CellGroupData[{
Cell[277519, 7159, 169, 3, 42, "Subsubsection",ExpressionUUID->"a9906281-b35d-4911-860b-b2d6d5783480"],
Cell[CellGroupData[{
Cell[277713, 7166, 14272, 312, 688, "Input",ExpressionUUID->"c4ece8f8-00ae-4fd3-a9f1-5d1d5953ebf7"],
Cell[291988, 7480, 39423, 930, 496, "Print",ExpressionUUID->"b32db11f-81bf-4d2e-8543-41b39b9404d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[331448, 8415, 10787, 251, 499, "Input",ExpressionUUID->"72a50735-bf2a-4a6d-9e50-4b682ec2dcd0"],
Cell[342238, 8668, 25149, 689, 305, "Print",ExpressionUUID->"dbc87301-f2cc-436c-8201-0ac250272197"]
}, Open  ]],
Cell[CellGroupData[{
Cell[367424, 9362, 5669, 144, 331, "Input",ExpressionUUID->"7cc40990-9ecd-4763-a6e9-37824902e917"],
Cell[373096, 9508, 15959, 402, 290, "Print",ExpressionUUID->"83b0d31e-f362-4bf6-ba1a-203741393f99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389092, 9915, 3429, 85, 219, "Input",ExpressionUUID->"0d37fe3e-0973-4132-be13-d417b0ee67ad"],
Cell[392524, 10002, 16720, 438, 301, "Print",ExpressionUUID->"a3d6217f-83b7-4b3d-ba75-cbb0b06599dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[409281, 10445, 5467, 123, 203, "Input",ExpressionUUID->"8e0e9a19-a0ea-4717-b709-9827c0d50c58"],
Cell[414751, 10570, 22760, 594, 204, "Print",ExpressionUUID->"066a18ab-42d9-4904-8f06-70a7725b1904"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[437560, 11170, 221, 4, 42, "Subsubsection",ExpressionUUID->"7189448f-d136-4291-9e6c-10bf117fa4a7"],
Cell[CellGroupData[{
Cell[437806, 11178, 3692, 94, 141, "Input",ExpressionUUID->"71b0aea1-7001-4a57-980e-bab740d9857d"],
Cell[441501, 11274, 8403, 221, 132, "Print",ExpressionUUID->"3b0a42a9-6e27-44db-986d-02f172a522ee"]
}, Open  ]],
Cell[449919, 11498, 185, 3, 29, "Text",ExpressionUUID->"a26c980c-5b9a-4098-9951-8fe074881df0"],
Cell[CellGroupData[{
Cell[450129, 11505, 12395, 273, 463, "Input",ExpressionUUID->"6dcdcb7b-77b3-4600-b901-7285be1db96d"],
Cell[462527, 11780, 29408, 705, 376, "Print",ExpressionUUID->"161845f0-8d2b-4d00-9421-83893a37004f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[491972, 12490, 8729, 204, 296, "Input",ExpressionUUID->"18eb4fec-c071-4751-baf1-99348065f649"],
Cell[500704, 12696, 13065, 392, 205, "Print",ExpressionUUID->"c131f5d6-b4de-4565-8734-934e09dc4c47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[513806, 13093, 4902, 134, 353, "Input",ExpressionUUID->"2f24f1b5-a802-4038-a8e3-8895a7c74634"],
Cell[518711, 13229, 27248, 711, 430, "Print",ExpressionUUID->"f4d61c70-b3d6-4dde-b48a-f15ea10d6f84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[545996, 13945, 9363, 254, 515, "Input",ExpressionUUID->"115c1bca-e8c9-4aaf-a825-daa9c051af92"],
Cell[555362, 14201, 24999, 631, 405, "Print",ExpressionUUID->"ec6fe08e-8039-476e-9e4c-de247fa2821f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[580410, 14838, 231, 5, 42, "Subsubsection",ExpressionUUID->"46562e8f-9a41-4cc3-bbd1-aee4cd3d13f8"],
Cell[CellGroupData[{
Cell[580666, 14847, 12133, 283, 517, "Input",ExpressionUUID->"cb210c9f-7f63-4320-b39f-47489312e142"],
Cell[592802, 15132, 22004, 579, 470, "Print",ExpressionUUID->"ca12e226-03aa-4bce-a910-b251edc06c0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[614843, 15716, 6478, 135, 202, "Input",ExpressionUUID->"aabb7ebb-6ad9-4248-8229-eb1afab371a3"],
Cell[621324, 15853, 2353, 66, 30, "Output",ExpressionUUID->"0ff6080c-e220-4e5c-9c99-c2cda8e83c4c"],
Cell[623680, 15921, 37839, 902, 484, "Output",ExpressionUUID->"01e64c2e-c94c-49ec-a844-8b9b80e9c2ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[661556, 16828, 2767, 67, 174, "Input",ExpressionUUID->"ab09cbe1-f735-4c42-bdc4-c034496a7a77"],
Cell[664326, 16897, 2616, 72, 30, "Output",ExpressionUUID->"7f870a23-d6bf-4559-8107-7511c4d6a034"],
Cell[666945, 16971, 1534, 43, 30, "Output",ExpressionUUID->"e1f95bc9-ce8d-42ac-85e9-153d1a0e48d1"],
Cell[668482, 17016, 1487, 43, 52, "Output",ExpressionUUID->"94d0dd9d-f0ea-48c5-bd4e-48c62958cfca"],
Cell[669972, 17061, 11903, 313, 143, "Output",ExpressionUUID->"3467b46a-2013-4c70-9956-fcf7d573e4c2"],
Cell[681878, 17376, 4566, 122, 85, "Output",ExpressionUUID->"61cb64c9-d3ba-4ade-9fc7-c9fd6d674243"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[686493, 17504, 164, 3, 42, "Subsubsection",ExpressionUUID->"731b3ae6-3cf6-40b6-8a78-918627feb44e"],
Cell[CellGroupData[{
Cell[686682, 17511, 3645, 84, 315, "Input",ExpressionUUID->"8cb86057-ea22-4f90-b6f7-57be2b95cc94"],
Cell[690330, 17597, 9435, 220, 268, "Print",ExpressionUUID->"735f98a6-6204-4234-975b-bace251bfc3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[699802, 17822, 7997, 191, 328, "Input",ExpressionUUID->"2014b27c-1603-47a9-ae64-0ae6295ad294"],
Cell[707802, 18015, 27097, 627, 303, "Print",ExpressionUUID->"4740f7ff-5134-4aa8-8b06-1e38b5a8d577"]
}, Open  ]],
Cell[CellGroupData[{
Cell[734936, 18647, 6665, 153, 305, "Input",ExpressionUUID->"523e4944-b0c3-4d7f-ae6f-73046e02308b"],
Cell[741604, 18802, 45876, 1096, 348, "Print",ExpressionUUID->"4cda23b5-ce3e-43fd-ba42-72a717536852"]
}, Open  ]],
Cell[CellGroupData[{
Cell[787517, 19903, 13479, 332, 680, "Input",ExpressionUUID->"53c7634f-eff2-403e-b892-105866dac90d"],
Cell[800999, 20237, 48507, 1302, 504, "Print",ExpressionUUID->"8c1ceb2b-4e6b-4c34-884c-faef6775ff06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[849543, 21544, 3261, 53, 341, "Input",ExpressionUUID->"2561f7d8-d921-4daf-a413-8a56a7f74a5d"],
Cell[852807, 21599, 5986, 104, 252, "Print",ExpressionUUID->"c0b832d9-137c-4ee2-9c7d-6dae82db1999"]
}, Open  ]],
Cell[CellGroupData[{
Cell[858830, 21708, 7846, 198, 427, "Input",ExpressionUUID->"10d85454-025a-4fa3-ae03-916788b6f56e"],
Cell[866679, 21908, 65256, 1538, 533, "Print",ExpressionUUID->"d5cee5e3-e366-4f78-99b1-6ae57c863896"],
Cell[931938, 23448, 27325, 645, 237, "Print",ExpressionUUID->"cde582eb-1c25-4d53-a142-79a04224ddd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[959300, 24098, 2148, 51, 203, "Input",ExpressionUUID->"07c4076d-015b-4cbc-b67d-4f63db8f7bf0"],
Cell[961451, 24151, 6438, 159, 164, "Print",ExpressionUUID->"3e094b54-5631-45fa-b0dd-c6742f2d4cae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[967926, 24315, 18322, 436, 953, "Input",ExpressionUUID->"f5217d92-3bb2-41fc-b27d-9131100e897b"],
Cell[986251, 24753, 60963, 1329, 701, "Print",ExpressionUUID->"913396c5-52fd-49f9-abd5-fae1557fd9a8"],
Cell[1047217, 26084, 155203, 3313, 905, "Print",ExpressionUUID->"51e9b3a9-5c17-4cc0-94c3-7342bed9869f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1202457, 29402, 16527, 446, 1052, "Input",ExpressionUUID->"a43d0637-c6e2-43c6-8aa0-0c242bdfe7d0"],
Cell[1218987, 29850, 73625, 1741, 401, "Print",ExpressionUUID->"74fa1f92-bc28-42d1-95c5-be124f1dec7f"],
Cell[1292615, 31593, 34229, 954, 646, "Print",ExpressionUUID->"4ecc0ffa-e691-4b6a-aa1c-211686d67950"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1326881, 32552, 3082, 67, 268, "Input",ExpressionUUID->"41ce177f-3566-4b14-92fd-678784d2eb56"],
Cell[1329966, 32621, 8256, 204, 187, "Print",ExpressionUUID->"e53d86fc-74e1-48cd-af1e-826dbbcf739c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1338259, 32830, 9776, 208, 380, "Input",ExpressionUUID->"990dbbf6-d2a4-43ff-81cb-471e997ae3cd"],
Cell[1348038, 33040, 46818, 1162, 363, "Print",ExpressionUUID->"81df8fbb-78b1-4f47-91d7-04650d5a9e17"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1394893, 34207, 3017, 66, 234, "Input",ExpressionUUID->"d3d32dc3-3979-4842-94eb-8c8e10275021"],
Cell[1397913, 34275, 1871, 53, 29, "Output",ExpressionUUID->"e5fd2d03-b393-45a3-9377-31afd037122d"],
Cell[1399787, 34330, 13399, 307, 101, "Output",ExpressionUUID->"f6dd130d-5615-4a50-a15e-1d8cc5e5fd16"],
Cell[1413189, 34639, 17632, 434, 170, "Print",ExpressionUUID->"2f8eac8c-2756-498b-a8b4-3839e85252b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1430858, 35078, 1565, 26, 220, "Input",ExpressionUUID->"5cedd6b6-fcf4-4bf3-9e30-30b28a50b1f9"],
Cell[1432426, 35106, 4167, 85, 201, "Print",ExpressionUUID->"40f7825b-864e-459e-b7d7-b3c58badb38f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1436630, 35196, 278, 5, 42, "Input",ExpressionUUID->"9b770217-184e-44b2-815f-861a39d19696"],
Cell[1436911, 35203, 1159, 30, 51, "Output",ExpressionUUID->"f1405760-60ce-44f3-a85f-7037a36dbb52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1438107, 35238, 6135, 153, 370, "Input",ExpressionUUID->"f27597cb-16f1-440c-8eb4-60ddc8b499e7"],
Cell[1444245, 35393, 16104, 415, 333, "Print",ExpressionUUID->"50e36d93-dcf0-4ad5-acde-a8dcb1967221"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1460386, 35813, 9264, 225, 698, "Input",ExpressionUUID->"0c834fe7-e792-4d6f-b670-aca71817583c"],
Cell[1469653, 36040, 30419, 769, 534, "Print",ExpressionUUID->"dacc7e62-1edc-436f-8fce-f1b97e2141a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1500109, 36814, 6220, 153, 367, "Input",ExpressionUUID->"1b81ab08-eef7-4470-b152-ae1b75310cd5"],
Cell[1506332, 36969, 19212, 486, 297, "Print",ExpressionUUID->"f9e30f7b-c06d-422e-822c-7f2d1b0c9769"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1525581, 37460, 1274, 36, 137, "Input",ExpressionUUID->"7cfa486b-ea47-49fb-89ee-874d56ee3864"],
Cell[1526858, 37498, 678, 19, 30, "Output",ExpressionUUID->"45c04262-70fe-47a0-8b75-c8a3d4d27f72"],
Cell[1527539, 37519, 410, 10, 26, "Output",ExpressionUUID->"af22278b-243e-4a12-9a72-6976b66f5bf1"],
Cell[1527952, 37531, 619, 16, 26, "Output",ExpressionUUID->"ea98ccf5-a11d-4447-9b9b-8d33f8fa8026"],
Cell[1528574, 37549, 622, 16, 26, "Output",ExpressionUUID->"d68ff6ab-3f4a-4720-bfd0-7307240cf2cd"],
Cell[1529199, 37567, 649, 16, 28, "Output",ExpressionUUID->"21f4cdc9-fbad-4544-bd2b-9055d0fcf45c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

