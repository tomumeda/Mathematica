(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    988951,      23974]
NotebookOptionsPosition[    985763,      23874]
NotebookOutlinePosition[    986208,      23893]
CellTagsIndexPosition[    986165,      23890]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Revised definitions.  (The goal is streamline and generalize the \
definitions for most QFT problems.  Unfortunately, the metric tensor is \
defined differently between Srednicki\n(negative time) and Peskin-Schroeder \
(positive time).  We will use P-S convention here. )  We will use the \
Tensorial package for the primary notational basis.   The developmental Dot \
and IntegralOp functions are also incorporated.  The Dot[] function is used \
to maintain non-communicative relationship between products.  Most \
relationships will be maintained as Rule[] since ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " changes the position of terms in Equal[[] relationships."
}], "Text",
 CellChangeTimes->{{3.475327771927926*^9, 3.475327795604416*^9}, {
  3.4753278343184958`*^9, 3.475328036401976*^9}, {3.475328152556926*^9, 
  3.4753282968651867`*^9}, {3.4753284939034557`*^9, 3.475328512244706*^9}, {
  3.4753298929719687`*^9, 3.475329962196875*^9}, {3.475329997312049*^9, 
  3.475330030626697*^9}, {3.4753333336267138`*^9, 3.4753333941058693`*^9}, {
  3.475333638454989*^9, 3.4753337240466433`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"External", " ", "packages"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<TensorCalculus5`Tensorial`\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TensorialHelp", ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Extensions", " ", "to", " ", "Tensorial", " ", "5"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "a", " ", "a", " ", "replacement", " ", "routine", " ", 
      "that", " ", "includes", " ", "xPartialD"}], ",", " ", 
     RowBox[{
      RowBox[{"etc", ".", "  ", "The", " ", ".", "m"}], " ", "version", " ", 
      "does", " ", "not", " ", "work", " ", "for", " ", "some", " ", 
      RowBox[{"reason", ".", "  ", 
       RowBox[{"??", 
        RowBox[{"?", " ", 
         RowBox[{"1", 
          RowBox[{"June2012", "."}]}]}]}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xArrayExpansion", "[", 
        RowBox[{"indices_List", ",", 
         RowBox[{"baseindices_:", "Automatic"}]}], "]"}], "[", "expr_", "]"}],
       "/;", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"baseindices", ",", 
        RowBox[{"Automatic", "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"_Integer", "|", "_Symbol"}], ")"}], ".."}], "}"}], "|", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_Integer", "|", "_Symbol"}], ")"}], ".."}], "}"}], 
           ".."}], "}"}]}]}], "]"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "idx", ",", "inindex", ",", "wbaseindices", ",", "indexstructure", 
         ",", "wstructure", ",", "replace", ",", "uq", ",", "q", ",", 
         "uqreplace"}], "}"}], ",", 
       RowBox[{
        RowBox[{"wbaseindices", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "baseindices", "]"}], ",", 
           RowBox[{"{", "baseindices", "}"}], ",", "baseindices"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"indexstructure", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"index", ",", "bases", ",", "subbases"}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"index", "=", 
               RowBox[{"Part", "[", 
                RowBox[{"indices", ",", "idx"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"bases", "=", 
               RowBox[{"GetBaseIndices", "[", "index", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"subbases", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "wbaseindices", "]"}], 
                  "\[GreaterEqual]", "idx"}], ",", 
                 RowBox[{"Part", "[", 
                  RowBox[{"wbaseindices", ",", "idx"}], "]"}], ",", "bases"}],
                 "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"\[Not]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Intersection", "[", 
                    RowBox[{"subbases", ",", "bases"}], "]"}], "===", 
                   RowBox[{"Sort", "[", "subbases", "]"}]}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{
                   RowBox[{"SumArrayExpansion", "::", "subset"}], ",", 
                   "subbases", ",", "bases"}], "]"}], ";", 
                 RowBox[{"Abort", "[", "]"}]}], ",", 
                RowBox[{"bases", "=", "subbases"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"index", ",", "bases"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"idx", ",", "1", ",", 
               RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"inindex", "[", "i_", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"{", "expr", "}"}], ",", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"up_", "/;", 
                  RowBox[{"\[Not]", 
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"up", ",", "i", ",", "1"}], "]"}]}]}], ",", 
                 "down_"}], "]"}], "|", 
               RowBox[{"Tensor", "[", 
                RowBox[{"_", ",", "up_", ",", 
                 RowBox[{"down_", "/;", 
                  RowBox[{"\[Not]", 
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"down", ",", "i", ",", "1"}], "]"}]}]}]}], "]"}], 
               "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"PartialD", "[", 
                 RowBox[{"_", ",", "i"}], "]"}], "]"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"PartialD", "[", 
                 RowBox[{"_", ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "i", ",", "___"}], "}"}]}], "]"}], 
                "]"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"CovariantD", "[", 
                 RowBox[{"_", ",", "i"}], "]"}], "]"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"CovariantD", "[", 
                 RowBox[{"_", ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "i", ",", "___"}], "}"}]}], "]"}], 
                "]"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"TU", " ", "1", "June2012"}], "*)"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"xPartialD", "[", 
                 RowBox[{"_", ",", "i"}], "]"}], "]"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"xPartialDu", "[", 
                 RowBox[{"_", ",", "i"}], "]"}], "]"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"xCovariantD", "[", 
                 RowBox[{"_", ",", "i"}], "]"}], "]"}], "|", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"xCovariantDu", "[", 
                 RowBox[{"_", ",", "i"}], "]"}], "]"}]}], ",", "\[Infinity]", 
              ",", 
              RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}], ">", "0"}], 
           "\[And]", 
           RowBox[{"\[Not]", 
            RowBox[{"BaseIndexQ", "[", "i", "]"}]}]}], ")"}]}], ";", "\n", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"replace", "[", 
          RowBox[{"i_", ",", "newindex_"}], "]"}], ":=", 
         RowBox[{"Switch", "[", 
          RowBox[{
           RowBox[{"Head", "[", "i", "]"}], ",", 
           RowBox[{"_", "?", "IndexFlavorQ"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "i", "]"}], "[", "newindex", "]"}], ",", "_",
            ",", "newindex"}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"uqreplace", "[", "i_", "]"}], ":=", 
         RowBox[{"Switch", "[", 
          RowBox[{
           RowBox[{"Head", "[", "i", "]"}], ",", 
           RowBox[{"_", "?", "IndexFlavorQ"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "i", "]"}], "[", "q", "]"}], ",", "_", ",", 
           "q"}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
        RowBox[{"wstructure", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"indexstructure", ",", 
           RowBox[{
            RowBox[{"inindex", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\n", "\[IndentingNewLine]", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"List", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "//", 
                 RowBox[{"IndexChange", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], ",", 
                    RowBox[{"uq", "=", 
                    RowBox[{"uqreplace", "[", 
                    RowBox[{"First", "[", "#2", "]"}], "]"}]}]}], "}"}], 
                  "]"}]}], ")"}], "/.", 
               RowBox[{"uq", "\[Rule]", 
                RowBox[{"replace", "[", 
                 RowBox[{
                  RowBox[{"First", "[", "#2", "]"}], ",", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{"Last", "[", "#2", "]"}], ",", "idx"}], "]"}]}], 
                 "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"idx", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Last", "[", "#2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "&"}], ",", "expr", ",", 
          RowBox[{"Reverse", "[", "wstructure", "]"}]}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Sums", " ", "xArrayExpansion", " ", 
     RowBox[{"results", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xArraySum", "[", "index_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Fold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", 
              RowBox[{
               RowBox[{"xArrayExpansion", "[", 
                RowBox[{"{", "#2", "}"}], "]"}], "[", "#1", "]"}]}], "]"}], 
            "&"}], ",", "exp", ",", "index"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rules", " ", "for", " ", "expanding", " ", "Einstein", " ", 
     RowBox[{"indices", ".", "  ", "Handles"}], " ", 
     RowBox[{"xPartialD", "'"}], "s", " ", "and", " ", 
     RowBox[{"xCovariantD", "'"}], 
     RowBox[{"s", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xEinsteinSum", "[", 
       RowBox[{"baseindices_:", "Automatic"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"ExpandAll", "[", "exp", "]"}]}], ",", "xtmp", ",", "sub"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sub", "[", "func_", "]"}], ":=", 
         RowBox[{
          RowBox[{"a___", " ", 
           RowBox[{"func", "[", 
            RowBox[{"d_", ",", "e_"}], "]"}], "c___"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{
            RowBox[{"xArraySum", "[", 
             RowBox[{"{", "e", "}"}], "]"}], "[", 
            RowBox[{"a", " ", 
             RowBox[{"func", "[", 
              RowBox[{"d", ",", "e"}], "]"}], "c"}], "]"}], "/;", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"ExtractDummyIndices", "[", 
              RowBox[{"a", " ", 
               RowBox[{"func", "[", 
                RowBox[{"d", ",", "e"}], "]"}], "c"}], "]"}], ",", "e"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"EinsteinSum", "[", "baseindices", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"sub", "[", "xPartialD", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"sub", "[", "xCovariantD", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"sub", "[", "xPartialDu", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"sub", "[", "xCovariantDu", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*****)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Past", " ", "definitions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeclareZeroTensor", "[", "zero", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorLabelFormat", "[", 
     RowBox[{"zero", ",", "0"}], "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"<<", "Local`LocalFunctions`"}], "\[IndentingNewLine]", 
   "DotFunctions", "\[IndentingNewLine]", "IntegralFunctions", "\n", 
   "IntegrateSumFunctions", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Area", " ", "for", " ", "specific", " ", "assignments", " ", "of", " ", 
     "variables", " ", "for", " ", "all", " ", 
     RowBox[{"problems", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Indices4D", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"field", ",", "Green"}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"space", ",", "Red"}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"timespace", ",", "Magenta"}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"feyn", ",", "Orange"}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"groupR", ",", "Blue"}], "}"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeclareBaseIndices", "[", 
     RowBox[{"Indices4D", ",", 
      RowBox[{"{", 
       RowBox[{"field", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"feyn", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"space", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"timespace", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"groupR", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "CompleteBaseIndices", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "QCDBaseIndices", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QCDBaseIndices", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DeclareIndexFlavor", "[", 
         RowBox[{"{", 
          RowBox[{"color", ",", "Brown"}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeclareIndexFlavor", "[", 
         RowBox[{"{", 
          RowBox[{"flavor", ",", "Orange"}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeclareIndexFlavor", "[", 
         RowBox[{"{", 
          RowBox[{"family", ",", 
           RowBox[{"Darker", "[", "Green", "]"}]}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AddBaseIndex", "[", 
         RowBox[{"{", 
          RowBox[{"gaugeG", ",", 
           RowBox[{"{", 
            RowBox[{
            "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", 
             ",", "8"}], "}"}]}], "}"}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"SU", "[", "3", "]"}], " ", "gauge", " ", "group", " ", 
          "index"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AddBaseIndex", "[", 
         RowBox[{"{", 
          RowBox[{"color", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"SU", "[", "3", "]"}], " ", "singlet", " ", "index"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AddBaseIndex", "[", 
         RowBox[{"{", 
          RowBox[{"flavor", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
            "}"}]}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"correspondence", ":", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"u", ",", "c", ",", "t", ",", " ", 
              RowBox[{
               RowBox[{"with", " ", "Q"}], "=", 
               RowBox[{"2", "/", "3"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"d", ",", "s", ",", "b", ",", " ", 
              RowBox[{
               RowBox[{"with", " ", "Q"}], "=", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "3"}]}]}], "}"}]}], "}"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AddBaseIndex", "[", 
         RowBox[{"{", 
          RowBox[{"family", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", "CompleteBaseIndices"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefineTensor", "[", "\[IndentingNewLine]", 
     RowBox[{
     "\[CurlyPhi]", ",", "\[Psi]", ",", "m", ",", "k", ",", "x", ",", "y", 
      ",", "z", ",", "dx", ",", "\[Xi]", ",", "b", ",", "c", ",", "r", ",", 
      "\[CurlyPhi]", ",", "\[Phi]", ",", "\[Psi]", ",", "\[Psi]c", ",", "J", 
      ",", "K", ",", "P", ",", "a", ",", "k", ",", "l", ",", "e", ",", "p", 
      ",", "q", ",", "dp", ",", "dq", ",", "j", ",", "A", ",", "B", ",", 
      "\[Gamma]", ",", "G", ",", "n", ",", "\[Sigma]", ",", "h", ",", 
      "\[Chi]", ",", "\[Theta]", ",", "\[Epsilon]", ",", "\[Zeta]", ",", "x", 
      ",", "k", ",", "g", ",", "\[Delta]", " ", ",", "\[Sigma]", ",", 
      "\[Omega]", ",", "\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]s", ",", 
      "\[Omega]a", ",", "\[Eta]", ",", "\[CapitalLambda]", ",", "A", ",", "B",
       ",", "M", ",", "\[Delta]\[Omega]", ",", "\[Delta]\[Alpha]", ",", "q", 
      ",", "p", ",", "R", ",", "T", ",", "\[Theta]", ",", "S", ",", "F", ",", 
      "P", ",", "W", ",", "\[Epsilon]", ",", "J", ",", "\[CapitalGamma]", ",",
       "\[Epsilon]", ",", "f", ",", "W", ",", "J", ",", "\[Epsilon]"}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"labels", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Delta]", ",", "g", ",", " ", "\[CapitalGamma]"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]", "@", 
      RowBox[{"uu", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]", "@", 
      RowBox[{"dd", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]", "@", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"timespace", "@", "i"}], ",", 
        RowBox[{"timespace", "@", "j"}]}], "]"}]}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]", "@", 
      RowBox[{"uu", "[", 
       RowBox[{
        RowBox[{"timespace", "@", "i"}], ",", 
        RowBox[{"timespace", "@", "j"}]}], "]"}]}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Delta]", "@", 
      RowBox[{"ud", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ",", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Add", " ", "index", " ", "pattern", " ", "for", " ", 
     RowBox[{"xPartialD", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexspecs1", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"_", ",", 
           RowBox[{"index_", "/;", 
            RowBox[{
             RowBox[{"Head", "[", "index", "]"}], "=!=", "List"}]}]}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "_"}], "}"}], ",", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"_", ",", "index_List"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"xCovariantD", "[", 
          RowBox[{"_", ",", 
           RowBox[{"index_", "/;", 
            RowBox[{
             RowBox[{"Head", "[", "index", "]"}], "=!=", "List"}]}]}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "_"}], "}"}], ",", 
         RowBox[{"xCovariantD", "[", 
          RowBox[{"_", ",", "index_List"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"xD", "[", 
          RowBox[{"_", ",", "_", ",", 
           RowBox[{"index_", "/;", 
            RowBox[{
             RowBox[{"Head", "[", "index", "]"}], "=!=", "List"}]}]}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "_"}], "}"}], ",", 
         RowBox[{"xD", "[", 
          RowBox[{"_", ",", "_", ",", "index_List"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexspecs2", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"_", ",", 
           RowBox[{"index_", "/;", 
            RowBox[{
             RowBox[{"Head", "[", "index", "]"}], "=!=", "List"}]}]}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "_"}], "}"}], ",", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"_", ",", "index_List"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"xCovariantDu", "[", 
          RowBox[{"_", ",", 
           RowBox[{"index_", "/;", 
            RowBox[{
             RowBox[{"Head", "[", "index", "]"}], "=!=", "List"}]}]}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "_"}], "}"}], ",", 
         RowBox[{"xCovariantDu", "[", 
          RowBox[{"_", ",", "index_List"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NewIndexChangePatterns", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"indexspecs1", ",", "indexspecs2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"NewIndexChangePatterns", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndexParsingRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        OverscriptBox["t_Tensor", "_"], "->", "t"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xPartialDu", "[", 
         RowBox[{
          RowBox[{"xPartialD", "[", 
           RowBox[{"$a_", ",", "$m_"}], "]"}], ",", "$n_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "$n", "}"}], ",", 
           RowBox[{"{", "$m", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{
          RowBox[{"xPartialDu", "[", 
           RowBox[{"$a_", ",", "$m_"}], "]"}], ",", "$n_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "$m", "}"}], ",", 
           RowBox[{"{", "$n", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"$a_", ",", "$m_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "$m", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"xPartialDu", "[", 
         RowBox[{"$a_", ",", "$m_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "$m", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xCovariantD", "[", 
         RowBox[{"$a_", ",", "$m_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "$m", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"xCovariantDu", "[", 
         RowBox[{"$a_", ",", "$m_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "$m", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xD", "[", 
         RowBox[{"$s_", ",", "$a_", ",", "$m_"}], "]"}], "\[Rule]", 
        RowBox[{"$a", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$XXX", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "$m", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", "a__", "]"}], "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{"$b_", ",", "$c_", ",", "$d_"}], "]"}], "]"}], "->", 
        RowBox[{"Tensor", "[", 
         RowBox[{"$b", ",", "$c", ",", "$d"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Functional", " ", "patterns", " ", "that", " ", "may", " ", "use", " ", 
     "indices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndexVarPatterns", "=", 
     RowBox[{
      RowBox[{"Tensor", "[", 
       RowBox[{"_", ",", "_", ",", "_"}], "]"}], "|", 
      RowBox[{"xPartialD", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{"xPartialDu", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{"xCovariantD", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{"xCovariantDu", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "|", 
      RowBox[{"xD", "[", 
       RowBox[{"_", ",", "_", ",", "_"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Notation", " ", "in", " ", "QFT", " ", "has", " ", "too", " ", "many", 
     " ", "requirements", " ", "and", " ", "often", " ", "needs", " ", "to", 
     " ", "be", " ", "problem", " ", 
     RowBox[{"specific", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Slashes", " ", "symbol_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"Slash", "[", "symbol_", "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToBoxes", "[", "\"\</\>\"", "]"}], ",", 
          RowBox[{"AdjustmentBox", "[", 
           RowBox[{
            RowBox[{"ToBoxes", "[", "symbol", "]"}], ",", 
            RowBox[{"BoxMargins", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", ".8"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{".0", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], "}"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToBoxes", "[", "symbol", "]"}], ",", 
           RowBox[{"AdjustmentBox", "[", 
            RowBox[{"\"\</\>\"", ",", 
             RowBox[{"BoxMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.6666666666666666"}], ",", "0.0"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0."}], "}"}]}], "}"}]}]}], "]"}]}], 
          "}"}], "]"}], "*)"}], ",", " ", 
       RowBox[{"Slash", "[", "symbol", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PartialDSlash", "[", "symbol_", "]"}], " ", 
     RowBox[{"notation", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"PartialDSlash", "[", "symbol_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToBoxes", "[", "\"\</\>\"", "]"}], ",", 
           RowBox[{"AdjustmentBox", "[", 
            RowBox[{"\"\<\[PartialD]\>\"", ",", 
             RowBox[{"BoxMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.8"}], ",", "0.0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0."}], "}"}]}], "}"}]}]}], "]"}], ",", 
           RowBox[{"ToBoxes", "[", "symbol", "]"}]}], "}"}], "]"}], ",", " ", 
        
        RowBox[{"PartialDSlash", "[", "symbol", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CovariantDSlash", "[", "symbol_", "]"}], " ", 
     RowBox[{"notation", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"CovariantDSlash", "[", "symbol_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToBoxes", "[", "\"\<\[ScriptCapitalD]\>\"", "]"}], ",", 
           RowBox[{"AdjustmentBox", "[", 
            RowBox[{"\"\</\>\"", ",", 
             RowBox[{"BoxMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.6666666666666666"}], ",", 
                  RowBox[{"-", "0.6666"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0."}], "}"}]}], "}"}]}]}], "]"}], ",", 
           "\"\<[\>\"", ",", 
           RowBox[{"ToBoxes", "[", "symbol", "]"}], ",", "\"\<]\>\""}], "}"}],
          "]"}], ",", " ", 
        RowBox[{"CovariantDSlash", "[", "symbol", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GammaSlash", " ", "display", " ", 
      RowBox[{"definition", ".", "  ", "May"}], " ", "want", " ", "to", " ", 
      "redefine", " ", "it", " ", "as", " ", 
      RowBox[{"g", "[", "a_", "]"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"GammaSlash", "[", "a", "]"}], ".", "  ", "Perhaps"}], " ", 
      "the", " ", "Bold", " ", "is", " ", 
      RowBox[{"enough", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"GammaSlash", "[", "a_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      "\n", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"a", ",", "Bold"}], "]"}], ",", "\"\</\>\""}], "]"}], 
         "]"}], ",", " ", 
        RowBox[{"GammaSlash", "[", "a", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"IntegralOp", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"IntegralOp", "[", 
        RowBox[{"v_", ",", "a_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"\"\<\[Integral]\>\"", ",", 
            RowBox[{"Column", "[", "v", "]"}]}], "]"}], "[", "a", "]"}], 
         "]"}], ",", " ", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{"v", ",", "a"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Transpose", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "a_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{"Superscript", "[", 
          RowBox[{"a", ",", "T"}], "]"}], "]"}], ",", " ", 
        RowBox[{"Transpose", "[", "a", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"ConjugateTranspose", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{"SuperDagger", "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Conjugate", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", "a_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{"SuperStar", "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"Conjugate", "[", "a", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xPartialD", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<\[PartialD]\>\"", "_"], ",", "b"}], "]"}], 
          "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"xPartialD", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xPartialDu", " ", 
     RowBox[{"(", 
      RowBox[{"contravariant", " ", "derivative"}], ")"}], " ", "display", 
     " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xPartialDu", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<\[PartialD]\>\"", "_"], ",", "b"}], "]"}], 
          "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"xPartialDu", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xCovariantD", " ", 
     RowBox[{"(", 
      RowBox[{"contravariant", " ", "covariant", " ", "derivative"}], ")"}], 
     " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xCovariantD", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<\[GothicCapitalD]\>\"", "_"], ",", "b"}], 
           "]"}], "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"xCovariantD", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xCovariantDu", " ", 
     RowBox[{"(", 
      RowBox[{"contravariant", " ", "covariant", " ", "derivative"}], ")"}], 
     " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"xCovariantDu", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         RowBox[{"Superscript", "[", 
          RowBox[{
           UnderscriptBox["\"\<\[GothicCapitalD]\>\"", "_"], ",", "b"}], 
          "]"}], "[", "a", "]"}], "]"}], ",", " ", 
       RowBox[{"xCovariantDu", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xLieD", " ", 
     RowBox[{"(", 
      RowBox[{"Lie", " ", "derivative"}], ")"}], " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xLieD", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<\[ScriptCapitalL]\>\"", "_"], ",", "b"}], 
           "]"}], "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"xLieD", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"deltaD", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"deltaD", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<\[Delta]\>\"", "_"], ",", "b"}], "]"}], "[", 
          "a", "]"}], "]"}], ",", " ", 
        RowBox[{"deltaD", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xDeltaD", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xDeltaD", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<\[Del]\>\"", "_"], ",", "b"}], "]"}], "[", 
          "a", "]"}], "]"}], ",", " ", 
        RowBox[{"xDeltaD", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "xDeltaD", " ", "display", " ", "definition", " ", "for", " ", 
     "specified", " ", "symbol", " ", "s_."}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xDeltaD", "[", 
        RowBox[{"s_", ",", "a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["s", "_"], ",", "b"}], "]"}], "[", "a", "]"}], 
         "]"}], ",", " ", 
        RowBox[{"xDeltaD", "[", 
         RowBox[{"s", ",", "a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "xD", " ", "display", " ", "definition", " ", "specified", " ", "symbol", 
     " ", "s_."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xD", "[", 
        RowBox[{"s_", ",", "a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["s", "_"], ",", "b"}], "]"}], "[", "a", "]"}], 
         "]"}], ",", " ", 
        RowBox[{"xD", "[", 
         RowBox[{"s", ",", "a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xDDeltaD", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xDDeltaD", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{
            UnderscriptBox["\"\<D\>\"", "_"], ",", "b"}], "]"}], "[", "a", 
          "]"}], "]"}], ",", " ", 
        RowBox[{"xDDeltaD", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xDiscreteDelta", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"xDiscreteDelta", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         UnderscriptBox["\"\<\[Delta]\>\"", "_"], "[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", " ", 
       RowBox[{"xDiscreteDelta", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xSum", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xSum", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Underscript", "[", 
           RowBox[{
            UnderscriptBox[
             RowBox[{" ", "\"\<\[Sum]\>\""}], "_"], ",", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "b", "}"}], "]"}]}], "]"}], "[", "a", "]"}], "]"}], 
        ",", " ", 
        RowBox[{"xSum", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"xProduct", " ", "display", " ", 
     RowBox[{"definition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"xProduct", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          RowBox[{"Underscript", "[", 
           RowBox[{
            UnderscriptBox[
             RowBox[{" ", "\"\<\[Product]\>\""}], "_"], ",", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "b", "}"}], "]"}]}], "]"}], "[", "a", "]"}], "]"}], 
        ",", " ", 
        RowBox[{"xProduct", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Bra", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"Bra", "[", "b__", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[LeftAngleBracket]\>\"", ",", "Bold"}], "]"}], ",", 
           
           RowBox[{"ToBoxes", "[", "b", "]"}], ",", 
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[RightBracketingBar]\>\"", ",", "Bold"}], "]"}]}], 
          "}"}], "]"}], ",", " ", 
        RowBox[{"Bra", "[", "b", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Ket", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"Ket", "[", "b__", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[LeftBracketingBar]\>\"", ",", "Bold"}], "]"}], ",", 
           RowBox[{"ToBoxes", "[", "b", "]"}], ",", 
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[RightAngleBracket]\>\"", ",", "Bold"}], "]"}]}], 
          "}"}], "]"}], ",", " ", 
        RowBox[{"Ket", "[", "b", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BraKet", "[", "b", "]"}], " ", "display", " ", "definition"}], 
     ",", " ", 
     RowBox[{"<", "b", ">"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"BraKet", "[", "b__", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[LeftAngleBracket]\>\"", ",", "Bold"}], "]"}], ",", 
           
           RowBox[{"ToBoxes", "[", "b", "]"}], ",", 
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[RightAngleBracket]\>\"", ",", "Bold"}], "]"}]}], 
          "}"}], "]"}], ",", " ", 
        RowBox[{"BraKet", "[", "b", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BraKet", "[", 
       RowBox[{"b", ",", "c"}], "]"}], " ", "display", " ", "definition"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"<", "b"}], "|", 
      RowBox[{"c", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"BraKet", "[", 
        RowBox[{"b__", ",", "c__"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[LeftAngleBracket]\>\"", ",", "Bold"}], "]"}], ",", 
           
           RowBox[{"ToBoxes", "[", "b", "]"}], ",", 
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<|\>\"", ",", "Bold"}], "]"}], ",", 
           RowBox[{"ToBoxes", "[", "c", "]"}], ",", 
           RowBox[{"StyleBox", "[", 
            RowBox[{"\"\<\[RightAngleBracket]\>\"", ",", "Bold"}], "]"}]}], 
          "}"}], "]"}], ",", " ", 
        RowBox[{"BraKet", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"CommutatorM", " ", "display", " ", 
     RowBox[{"definition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"CommutatorM", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<[\>\"", ",", 
           RowBox[{"ToBoxes", "[", "a", "]"}], ",", "\"\<,\>\"", ",", 
           RowBox[{"ToBoxes", "[", "b", "]"}], ",", "\"\<]\>\""}], "}"}], 
         "]"}], ",", " ", 
        RowBox[{"CommutatorM", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"CommutatorP", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"CommutatorP", "[", 
        RowBox[{"a_", ",", "b__"}], "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RowBox", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<{\>\"", ",", 
           RowBox[{"ToBoxes", "[", "a", "]"}], ",", "\"\<,\>\"", ",", 
           RowBox[{"ToBoxes", "[", "b", "]"}], ",", "\"\<}\>\""}], "}"}], 
         "]"}], ",", " ", 
        RowBox[{"CommutatorP", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"HodgeStar", " ", "display", " ", "definition"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"HodgeStar", "[", "a_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          UnderscriptBox["\"\<*\>\"", "_"], "[", "a", "]"}], "]"}], ",", " ", 
        
        RowBox[{"HodgeStar", "[", "a", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "DifForm", " ", "display", " ", "definition", " ", "11", "July2012"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"DifForm", "[", "a_", "]"}], ",", 
       RowBox[{"form", ":", 
        RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"InterpretationBox", "[", 
        RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
         RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{
          UnderscriptBox["d", "_"], "[", "a", "]"}], "]"}], ",", " ", 
        RowBox[{"DifForm", "[", "a", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Commutation", " ", "and", " ", "Anti"}], "-", 
     RowBox[{"commutation", " ", 
      RowBox[{"definitions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MCommutator", "::", "usage"}], " ", "=", " ", 
     "\"\<MCommutator[A,B] calculates the commutator of matrices A and \
B\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MCommutator", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "-", 
      RowBox[{"B", ".", "A"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ACommutator", "::", "usage"}], " ", "=", " ", 
     "\"\<ACommutator[A,B] calculates the commutator of matrices A and \
B\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ACommutator", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "+", 
      RowBox[{"B", ".", "A"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.474902202988223*^9, 3.474902218781245*^9}, {
   3.474902249452106*^9, 3.474902252358342*^9}, 3.4749022885666847`*^9, {
   3.474904002467537*^9, 3.474904015966226*^9}, {3.474904313637267*^9, 
   3.474904314548793*^9}, {3.4749048751484833`*^9, 3.474904921574607*^9}, {
   3.474904979979472*^9, 3.4749049974963837`*^9}, {3.474905066647118*^9, 
   3.4749050811369257`*^9}, {3.47490523544936*^9, 3.474905236168868*^9}, {
   3.474944627432186*^9, 3.474944639810153*^9}, {3.4749447417941303`*^9, 
   3.474944745533605*^9}, {3.47494480052849*^9, 3.474944888358387*^9}, {
   3.4749449236275597`*^9, 3.4749449266154633`*^9}, {3.4749449876399603`*^9, 
   3.4749450212062597`*^9}, {3.474945424838657*^9, 3.4749454345521097`*^9}, {
   3.474945466141786*^9, 3.474945538456306*^9}, {3.474945628035927*^9, 
   3.4749456296334476`*^9}, {3.474945732962715*^9, 3.474945737890752*^9}, {
   3.4749482603608637`*^9, 3.474948281093103*^9}, {3.4749483840846977`*^9, 
   3.4749483992388697`*^9}, {3.47494875051725*^9, 3.474948803611261*^9}, {
   3.474948884947719*^9, 3.474948931840364*^9}, {3.4749492406201077`*^9, 
   3.47494925331595*^9}, 3.4749494733800087`*^9, {3.4749495113089247`*^9, 
   3.474949513753845*^9}, 3.474949573354327*^9, 3.4749499896837673`*^9, 
   3.474950029369328*^9, {3.474950131732786*^9, 3.474950132368799*^9}, {
   3.474981806402833*^9, 3.474981899327038*^9}, {3.474981930863414*^9, 
   3.4749819526597548`*^9}, {3.474982139741414*^9, 3.474982219964347*^9}, 
   3.4749823960052423`*^9, {3.474982459470777*^9, 3.4749824720743837`*^9}, {
   3.474984800287813*^9, 3.4749848254758472`*^9}, {3.474985004182403*^9, 
   3.4749850117712927`*^9}, {3.474985086786294*^9, 3.474985134182914*^9}, {
   3.474985177061207*^9, 3.4749851963052073`*^9}, {3.4749852770738363`*^9, 
   3.474985279382162*^9}, {3.474985317981666*^9, 3.474985318796495*^9}, {
   3.474985397408358*^9, 3.4749854396534157`*^9}, {3.475036704893425*^9, 
   3.475036731196498*^9}, {3.4750389758328333`*^9, 3.475039012093803*^9}, {
   3.475039049487483*^9, 3.4750390689880657`*^9}, {3.475039105243697*^9, 
   3.475039159964554*^9}, {3.4750392870967073`*^9, 3.475039385368299*^9}, {
   3.475039458528109*^9, 3.475039503603745*^9}, {3.475063508482891*^9, 
   3.475063663796075*^9}, {3.475063695597624*^9, 3.475063763677724*^9}, 
   3.475063796432467*^9, {3.475063970321206*^9, 3.475064036031556*^9}, 
   3.475064099865511*^9, {3.4750641864351683`*^9, 3.475064298812497*^9}, {
   3.475064353035616*^9, 3.4750644186614227`*^9}, {3.475064520693749*^9, 
   3.475064524811913*^9}, {3.475064601896146*^9, 3.475064610046653*^9}, {
   3.475064688899332*^9, 3.4750647411643953`*^9}, {3.47506479413098*^9, 
   3.475064868797393*^9}, {3.475327441006032*^9, 3.475327452271845*^9}, {
   3.475327660591365*^9, 3.475327669398367*^9}, {3.475333293468802*^9, 
   3.47533329498803*^9}, {3.475333430884448*^9, 3.475333507277213*^9}, {
   3.475509439666131*^9, 3.475509440215962*^9}, {3.475808837281938*^9, 
   3.475808862101738*^9}, {3.475808893363825*^9, 3.4758090991040487`*^9}, {
   3.475809285434099*^9, 3.475809308024102*^9}, {3.475809566820257*^9, 
   3.4758095722907352`*^9}, {3.475898672757971*^9, 3.475898765258114*^9}, {
   3.475899848905645*^9, 3.4758998957129507`*^9}, {3.4763897180650787`*^9, 
   3.476389718908877*^9}, {3.476394465322373*^9, 3.476394470317672*^9}, {
   3.476394524776701*^9, 3.476394532918673*^9}, {3.476475121496636*^9, 
   3.476475148939528*^9}, {3.476475180297505*^9, 3.4764752046779013`*^9}, {
   3.476475244590598*^9, 3.4764754125132837`*^9}, {3.476824581316856*^9, 
   3.47682466249527*^9}, {3.476824721532248*^9, 3.476824789474885*^9}, {
   3.47682488084687*^9, 3.476824889776174*^9}, {3.476825118436091*^9, 
   3.476825133069786*^9}, {3.4768251972628813`*^9, 3.476825201005974*^9}, {
   3.476891015110813*^9, 3.4768911658439093`*^9}, {3.47689128459365*^9, 
   3.476891327240355*^9}, {3.4781225088749332`*^9, 3.478122510170926*^9}, {
   3.478281524916589*^9, 3.478281541989093*^9}, {3.4783504236141663`*^9, 
   3.478350443455793*^9}, {3.478540691886973*^9, 3.478540756549728*^9}, {
   3.478704614167588*^9, 3.4787046954582*^9}, {3.4787284987021103`*^9, 
   3.478728572584029*^9}, 3.4787286358032503`*^9, {3.4787287078152237`*^9, 
   3.478728751465004*^9}, {3.479094639012525*^9, 3.479094640981619*^9}, {
   3.479823095470861*^9, 3.479823097868977*^9}, {3.480704788150837*^9, 
   3.480704788738905*^9}, {3.481082722497822*^9, 3.481082722779748*^9}, {
   3.481083321369286*^9, 3.481083328317712*^9}, 3.481725675991349*^9, 
   3.482148715235587*^9, {3.482185298093439*^9, 3.482185298895957*^9}, {
   3.4821854152750893`*^9, 3.4821854165183496`*^9}, {3.482236737238839*^9, 
   3.482236747909891*^9}, {3.4824294407189703`*^9, 3.4824294456308737`*^9}, {
   3.48251241688312*^9, 3.4825124177552223`*^9}, {3.482546884730997*^9, 
   3.4825468880538588`*^9}, {3.482547761319466*^9, 3.482547766588665*^9}, {
   3.482604340389491*^9, 3.4826043550210876`*^9}, 3.48260442831594*^9, {
   3.4826335414095488`*^9, 3.482633547869377*^9}, {3.482633609701015*^9, 
   3.482633613077763*^9}, {3.482637096849654*^9, 3.482637097680759*^9}, {
   3.4826703830360117`*^9, 3.4826703838774548`*^9}, {3.482673603256509*^9, 
   3.482673662540257*^9}, {3.482673697366275*^9, 3.4826737257435102`*^9}, {
   3.482673839152343*^9, 3.4826738395414658`*^9}, {3.482678360478923*^9, 
   3.4826783610311947`*^9}, {3.482721043643178*^9, 3.4827210763884277`*^9}, {
   3.482721333608243*^9, 3.482721333741722*^9}, {3.482868680893037*^9, 
   3.482868742739963*^9}, {3.4830648741403427`*^9, 3.483064875569902*^9}, {
   3.48500705514178*^9, 3.485007077555449*^9}, {3.485007230414259*^9, 
   3.485007238393736*^9}, {3.485007322134348*^9, 3.4850073419800262`*^9}, {
   3.4853497458091307`*^9, 3.48534978019737*^9}, {3.4853498601902227`*^9, 
   3.485349860546287*^9}, {3.4864683683970737`*^9, 3.486468376508766*^9}, {
   3.48673067878537*^9, 3.486730731968979*^9}, {3.489846032895563*^9, 
   3.489846033748596*^9}, {3.489847242765437*^9, 3.489847243495686*^9}, {
   3.490193824777232*^9, 3.4901938703675623`*^9}, {3.4901941313958597`*^9, 
   3.4901942388797503`*^9}, {3.491961182980302*^9, 3.491961260689644*^9}, {
   3.491961926167563*^9, 3.491961975600124*^9}, {3.492093048589561*^9, 
   3.4920931082587643`*^9}, {3.492477146003482*^9, 3.492477150452724*^9}, 
   3.492530040864007*^9, 3.492530939388747*^9, {3.495330323944461*^9, 
   3.495330412607485*^9}, {3.496418489105599*^9, 3.496418499479809*^9}, {
   3.4971882659247723`*^9, 3.497188335314774*^9}, {3.4971884918118896`*^9, 
   3.497188493840942*^9}, {3.497188532432785*^9, 3.4971885401626062`*^9}, {
   3.497188689002428*^9, 3.497188756616213*^9}, {3.497188808049087*^9, 
   3.497188813463811*^9}, {3.497188856915152*^9, 3.497188933815338*^9}, {
   3.497189191779944*^9, 3.4971892835387583`*^9}, {3.497194928995056*^9, 
   3.497194932926819*^9}, {3.50117772160289*^9, 3.5011777269658003`*^9}, {
   3.501177763481373*^9, 3.501177764929788*^9}, {3.501178081472568*^9, 
   3.501178082590404*^9}, {3.501178321091796*^9, 3.501178336586912*^9}, {
   3.501178367142498*^9, 3.501178375469048*^9}, {3.501179047593821*^9, 
   3.501179083220793*^9}, {3.5011794098632803`*^9, 3.501179416107768*^9}, {
   3.501206212115271*^9, 3.5012062409825697`*^9}, {3.501206481469286*^9, 
   3.50120648221948*^9}, {3.5012066273002253`*^9, 3.5012066477607613`*^9}, {
   3.5012067411793737`*^9, 3.501206746371129*^9}, {3.5012067828548326`*^9, 
   3.501206870171858*^9}, {3.505743666057332*^9, 3.505743694561953*^9}, {
   3.507040187520445*^9, 3.5070402484347363`*^9}, {3.507040292073475*^9, 
   3.507040387231353*^9}, {3.507040421568221*^9, 3.5070404293419*^9}, {
   3.5070405905557547`*^9, 3.507040754180627*^9}, {3.507403711463745*^9, 
   3.5074037506595783`*^9}, {3.507404921843438*^9, 3.507404934591123*^9}, {
   3.509886752215684*^9, 3.509886752982313*^9}, {3.510318906220117*^9, 
   3.510318908804021*^9}, {3.512909449063163*^9, 3.512909511210724*^9}, {
   3.51455942285139*^9, 3.514559521571856*^9}, {3.514563004726968*^9, 
   3.514563010477454*^9}, {3.514563074893447*^9, 3.514563126181097*^9}, {
   3.514563551529117*^9, 3.514563558036141*^9}, 3.517141849222274*^9, {
   3.5173985801442842`*^9, 3.517398637240151*^9}, {3.517398706275816*^9, 
   3.517398713241227*^9}, {3.5173987566518497`*^9, 3.517398787391902*^9}, {
   3.517398906090645*^9, 3.517398918882574*^9}, {3.51739895353936*^9, 
   3.5173989537357683`*^9}, {3.517399107149704*^9, 3.517399112559073*^9}, {
   3.517399172795806*^9, 3.51739917612143*^9}, {3.5173993135494423`*^9, 
   3.517399313886087*^9}, {3.517399354825639*^9, 3.517399355021492*^9}, {
   3.517399615727089*^9, 3.517399615943577*^9}, {3.517922461363771*^9, 
   3.517922519111821*^9}, 3.520604439885626*^9, {3.520604485580719*^9, 
   3.5206045633393183`*^9}, {3.5206046709555683`*^9, 3.52060472848389*^9}, {
   3.5206047604679737`*^9, 3.520604761689803*^9}, {3.5206048261342907`*^9, 
   3.520604892395482*^9}, {3.5206049307069798`*^9, 3.520604933949596*^9}, {
   3.520604966978264*^9, 3.5206049998445683`*^9}, {3.520605061308443*^9, 
   3.520605069611031*^9}, {3.520605111585581*^9, 3.520605118147347*^9}, {
   3.520605660245088*^9, 3.520605789491481*^9}, {3.5245875402485437`*^9, 
   3.524587545392435*^9}, {3.524587677365147*^9, 3.524587692716282*^9}, {
   3.524587928238309*^9, 3.5245879328401814`*^9}, {3.5245879887756653`*^9, 
   3.5245879916961737`*^9}, {3.5245897982588043`*^9, 
   3.5245898451716127`*^9}, {3.5245899039439087`*^9, 3.524589915047142*^9}, {
   3.524589957001099*^9, 3.524589993244589*^9}, {3.525792365238401*^9, 
   3.525792430328878*^9}, {3.5360796120405397`*^9, 3.536079661317154*^9}, {
   3.5360813788158817`*^9, 3.5360814159663982`*^9}, {3.536082463100623*^9, 
   3.536082463469048*^9}, {3.53609258082764*^9, 3.536092589107584*^9}, {
   3.5417796080821323`*^9, 3.5417796139624662`*^9}, {3.543325811800481*^9, 
   3.543325856810061*^9}, {3.547466955841556*^9, 3.5474669602275343`*^9}, {
   3.547467036670439*^9, 3.547467060881939*^9}, 3.547521472789277*^9, {
   3.54752153591936*^9, 3.5475215382851477`*^9}, {3.547569792960968*^9, 
   3.5475698144053288`*^9}, {3.547569907007142*^9, 3.547569912452526*^9}, {
   3.54756994458948*^9, 3.547569950365323*^9}, {3.547573068242045*^9, 
   3.547573196930344*^9}, {3.547606057479868*^9, 3.547606066567369*^9}, {
   3.547776334300455*^9, 3.547776343902893*^9}, {3.547820344308168*^9, 
   3.547820346054772*^9}, {3.547820494822114*^9, 3.547820504577984*^9}, {
   3.547821255017911*^9, 3.547821360971533*^9}, {3.547821478017498*^9, 
   3.547821478589033*^9}, {3.547821623438278*^9, 3.547821631282832*^9}, {
   3.5478290591858892`*^9, 3.5478290671293163`*^9}, {3.547913827318898*^9, 
   3.5479138486403637`*^9}, 3.5479146111360083`*^9, 3.547914890397006*^9, {
   3.547952343777731*^9, 3.547952350961772*^9}, {3.547984612762704*^9, 
   3.547984624069708*^9}, {3.547988313947021*^9, 3.547988314140554*^9}, {
   3.5479883770279083`*^9, 3.547988392020302*^9}, {3.547989473059956*^9, 
   3.5479894772742157`*^9}, 3.548296827630518*^9, {3.548672135665238*^9, 
   3.548672179829811*^9}, {3.5486722300911913`*^9, 3.548672299206053*^9}, {
   3.548676008494523*^9, 3.5486761531538687`*^9}, 3.5486762120604057`*^9, 
   3.54867672077451*^9, 3.548760910203574*^9, {3.5490367717020493`*^9, 
   3.549036825475224*^9}, {3.5492009260709953`*^9, 3.5492009490136003`*^9}, {
   3.549202845824753*^9, 3.5492028670436783`*^9}, {3.5492028981234303`*^9, 
   3.549203096393979*^9}, {3.549461773653892*^9, 3.5494617997942142`*^9}, {
   3.5494658071402893`*^9, 3.549465826515318*^9}, {3.549465864346469*^9, 
   3.549465865711234*^9}, {3.549467711803896*^9, 3.549467738918034*^9}, {
   3.549636724565477*^9, 3.549636767877368*^9}, {3.549636809899124*^9, 
   3.549636826650112*^9}, {3.549637124194193*^9, 3.5496371316916943`*^9}, {
   3.5496387523977547`*^9, 3.5496387583329983`*^9}, {3.551009054328559*^9, 
   3.55100919140309*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"field", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"feyn", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"space", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"timespace", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"groupR", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.549467755685375*^9, 3.5496366186915617`*^9, 3.549636787450185*^9, 
   3.549636836603594*^9, 3.5496371406702127`*^9, 3.549638763324464*^9, 
   3.5509743561196623`*^9, 3.551009136041224*^9, 3.551112139068774*^9, {
   3.5511947170098352`*^9, 3.551194718254487*^9}}]
}, Open  ]],

Cell["Miscellaneous Functions ", "Text",
 CellChangeTimes->{{3.491742726218636*^9, 3.4917427373277283`*^9}, {
  3.491742868186756*^9, 3.491742883123385*^9}, {3.532197713706972*^9, 
  3.5321977316368427`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Tests", " ", "exp_", " ", "to", " ", "be", " ", "free", " ", "of", " ", 
    "any", " ", "item", " ", "in", " ", "list_.", "  ", "Returns", " ", 
    "index", " ", "of", " ", 
    RowBox[{"first", " ", "!"}], "FreeQ", " ", "in", " ", "list_."}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListFreeQ", "[", 
      RowBox[{"exp_", ",", "items_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"tmp", "=", 
          RowBox[{"Flatten", "[", "items", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<ListFreeQ\>\"", ",", "DEBUG", ",", 
          RowBox[{"{", 
           RowBox[{"exp", ",", "items"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{
           RowBox[{"i", "<=", 
            RowBox[{"Length", "[", "items", "]"}]}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"exp", ",", 
             RowBox[{"items", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"i", "++"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", 
           RowBox[{"Length", "[", "items", "]"}]}], ",", "0", ",", "i"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Tests", " ", "variable_", " ", "to", " ", "be", " ", "MemberQ", " ", 
     "of", " ", "any", " ", "item", " ", "in", " ", 
     RowBox[{"patterns_List", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListMemberQ", "[", 
      RowBox[{"variable_", ",", "patterns_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", "variable", "}"}], ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Flatten", "[", "patterns", "]"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Removed", " ", 
           RowBox[{"{", "variable", "}"}]}], "//", 
          RowBox[{"Flatten", "->", 
           RowBox[{"causes", " ", "problem", " ", "with", " ", 
            RowBox[{"arrays", ".", 
             RowBox[{"(", "2011.4", ")"}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<ListMemberQ\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"tmp", ",", "patterns"}], "}"}], ",", "\"\<tmp\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"tmp", ",", "True"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extract", " ", 
     RowBox[{"Sum", "'"}], "s", " ", "from", " ", "Dot", " ", "expressions", 
     " ", "and", " ", "simplifies", " ", "Sum", " ", 
     RowBox[{"expression", "."}]}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"DotSum2SumDot", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<DotSum2SumDot\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"Sum", "->", "xSum"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp1}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"xSum", "[", 
              RowBox[{"b_", ",", "nb__"}], "]"}], ",", "c___"}], "]"}], "->", 
           
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "nb"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp2}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "subGatherSum"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"xSum", "->", "Sum"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rules", " ", "to", " ", "simplify", " ", "Scalars", " ", "in", " ", 
      RowBox[{"Transpose", "[", "]"}], " ", "and", " ", 
      RowBox[{"ConjugateTranspose", "[", "]"}], " ", 
      RowBox[{"expressions", ".", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", "expression"}]}]}], "//.", 
     RowBox[{"simpleTranspose", "[", "scalar_List", "]"}]}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleTranspose", "[", "scalar_List", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"a_", " ", "b___"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"Transpose", "[", "b", "]"}]}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "scalar"}], "]"}], "||", 
           RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{"a_", ",", "n_"}], "]"}], " ", "b_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{"a", ",", "n"}], "]"}], " ", 
          RowBox[{"Transpose", "[", "b", "]"}]}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "scalar"}], "]"}], "||", 
           RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", "a_", " ", "]"}], ":>", 
        RowBox[{"a", " ", "/;", 
         RowBox[{
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"a", ",", "scalar"}], "]"}], "||", 
          RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"c_", ",", "x_"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{"c", ",", "x"}], "]"}], "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"c", ",", "scalar"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], " ", "]"}], ":>", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"Power", "[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"a", ",", "scalar"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "a_", " ", "]"}], ":>", 
        RowBox[{
         RowBox[{"Conjugate", "[", "a", "]"}], " ", "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"a", ",", "scalar"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"c_", ",", "x_"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"c", ",", "x"}], "]"}], "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"c", ",", "scalar"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"c_", ",", "x_"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"xPartialDu", "[", 
          RowBox[{"c", ",", "x"}], "]"}], "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"c", ",", "scalar"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"c_", ",", "x_"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"xPartialD", "[", 
           RowBox[{"c", ",", "x"}], "]"}], "]"}], "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"c", ",", "scalar"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"c_", ",", "x_"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"xPartialDu", "[", 
           RowBox[{"c", ",", "x"}], "]"}], "]"}], "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"c", ",", "scalar"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "TransposeMatrix", " ", "applies", " ", "Transpose", " ", "to", " ", 
     "elements", " ", "of", " ", "matrix_", " ", 
     RowBox[{"(", 
      RowBox[{"level", " ", "2"}], ")"}], " ", "where", " ", "elements", " ", 
     "may", " ", "be", " ", "symbolic", " ", 
     RowBox[{"elements", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TransposeMatrix", "[", "matrix_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "matrix"}], ",", 
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"matrix", ",", "_", ",", "2"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"pos", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], "==", "2"}], "&&", 
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", "0"}], "]"}]}]}], "&"}]}], " ", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "#", "]"}], "&"}], ",", "matrix", ",", 
          "pos"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "for", " ", "expanding", " ", "Dot", " ", "of", " ", 
     "Sums"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DotExpand", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"b_", "+", "c_"}], ",", "d___"}], "]"}], "->", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a", ",", "b", ",", "d"}], "]"}], "+", 
         RowBox[{"Dot", "[", 
          RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"b_", "+", "c_"}], ",", "d___"}], "]"}], "->", 
        RowBox[{
         RowBox[{"xDot", "[", 
          RowBox[{"a", ",", "b", ",", "d"}], "]"}], "+", 
         RowBox[{"xDot", "[", 
          RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DotExpandAll", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "ExpandAll"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "DotExpand"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DotExpandAll2", "[", "scalar_List", "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//", "ExpandAll"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", "DotExpand"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{"simpleDot2", "[", "scalar", "]"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rules", " ", "to", " ", "simplify", " ", "Dot", " ", 
      RowBox[{"expressions", ".", "  ", 
       RowBox[{"Usage", ":", " ", "expression"}]}]}], "//.", 
     RowBox[{"simpleDot", ".", "  ", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{"This", " ", "Rule", " ", "does", " ", "not", " ", "work", " ", 
        RowBox[{"consistently", "."}]}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpleDot", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"n_", " ", "d_"}], ",", "c___"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"n", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{"a", ",", "d", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "n", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"a___", ",", "b_", ",", "c___"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"Dot", "[", 
           RowBox[{"a", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"-", "b_"}], ",", "c___"}], "]"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"Dot", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"Dot", "[", "a__", "]"}], "]"}], ":>", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Dot", "[", "a", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"n_", " ", "d_"}], ",", "c___"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"n", " ", 
          RowBox[{"xDot", "[", 
           RowBox[{"a", ",", "d", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "n", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a___", ",", "b_", ",", "c___"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"xDot", "[", 
           RowBox[{"a", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"-", "b_"}], ",", "c___"}], "]"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"xDot", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"xDot", "[", "b__", "]"}]}], "]"}], "->", 
        RowBox[{"xDot", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Rules", " ", "to", " ", "simplify", " ", "Dot", " ", "expressions", " ",
       "with", " ", "extention", " ", "to", " ", "simpleDot", " ", "to", " ", 
      "account", " ", "for", " ", "scalars_.", "  ", 
      RowBox[{"Usage", ":", " ", "expression"}]}], "//.", 
     RowBox[{"simpleDot1", "[", "scalars_List", "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleDot1", "[", "scalars_List", "]"}], ":=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"d___", " ", "c_"}], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"Dot", "[", 
            RowBox[{"a", ",", "d", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"d___", " ", 
            SuperscriptBox["c_", "n_"]}], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "n"], " ", 
           RowBox[{"Dot", "[", 
            RowBox[{"a", ",", "d", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a___", ",", "c_", ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"Dot", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
          RowBox[{
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"c", ",", "scalars"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "a", "}"}], "]"}], ">", "0"}], "||", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "b", "}"}], "]"}], ">", "0"}]}], ")"}]}]}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a___", ",", 
           SuperscriptBox["c_", "n_"], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "n"], " ", 
           RowBox[{"Dot", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
          RowBox[{
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"c", ",", "scalars"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "a", "]"}], ">", "0"}], "||", 
             RowBox[{
              RowBox[{"Length", "[", "b", "]"}], ">", "0"}]}], ")"}]}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"simpleTranspose", "[", "scalars", "]"}], ",", 
        "\[IndentingNewLine]", "simpleDot"}], "}"}], "//", "Flatten"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rules", " ", "to", " ", "simplify", " ", "Dot", " ", "expressions", " ",
       "with", " ", "extention", " ", "to", " ", "simpleDot", " ", "to", " ", 
      "account", " ", "for", " ", "scalars_.", "  ", "Include", " ", 
      RowBox[{"DotExpand", ".", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", "expression"}]}]}], "//.", 
     RowBox[{
      RowBox[{"simpleDot2", "[", "scalars_List", "]"}], ".", "  ", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{
       "DotExpand", " ", "works", " ", "for", " ", "only", " ", "simple", " ", 
        RowBox[{"sums", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleDot2", "[", "scalars_List", "]"}], ":=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"DotExpand", ",", "\[IndentingNewLine]", 
        RowBox[{"simpleDot1", "[", "scalars", "]"}]}], "\[IndentingNewLine]", 
       "}"}], "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "There", " ", "cases", " ", "when", " ", "above", " ", "Rule", " ", 
     "does", " ", "not", " ", 
     RowBox[{"work", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"simpleDot3", "[", "scalars_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{"tmp", "//.", 
              RowBox[{"simpleDot2", "[", "scalars", "]"}]}], "//", 
             "Expand"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rules", " ", "to", " ", "simplify", " ", "NonCommuting", " ", 
      RowBox[{"expressions", ".", "  ", 
       RowBox[{"Usage", ":", " ", 
        RowBox[{"a", "\[CircleTimes]", 
         RowBox[{"(", 
          RowBox[{"4", " ", "b"}], ")"}], "\[CircleTimes]", "c"}]}]}]}], "//.", 
     RowBox[{
      RowBox[{"simpleNC", "[", "op", "]"}], ".", " ", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{"Does", " ", "not", " ", "work", " ", "for", " ", 
        RowBox[{"Dot", ".", " ", "25"}], " ", "June", " ", "2012"}]}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "simpleNC", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleNC", "[", 
      RowBox[{"op_", ",", "scalars_List"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"d___", " ", "c_"}], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"op", "[", 
            RowBox[{"a", ",", "d", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"d___", " ", 
            SuperscriptBox["c_", "n_"]}], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "n"], " ", 
           RowBox[{"op", "[", 
            RowBox[{"a", ",", "d", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", "c_", ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"op", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
          RowBox[{
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"c", ",", "scalars"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "a", "}"}], "]"}], ">", "0"}], "||", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "b", "}"}], "]"}], ">", "0"}]}], ")"}]}]}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", 
           SuperscriptBox["c_", "n_"], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "n"], " ", 
           RowBox[{"op", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
          RowBox[{
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"c", ",", "scalars"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "a", "]"}], ">", "0"}], "||", 
             RowBox[{
              RowBox[{"Length", "[", "b", "]"}], ">", "0"}]}], ")"}]}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"simpleTranspose", "[", "scalars", "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"CHECK", " ", "if", " ", 
          RowBox[{"appropriate", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"n_", " ", "d_"}], ",", "c___"}], "]"}], "\[RuleDelayed]", 
         
         RowBox[{
          RowBox[{"n", " ", 
           RowBox[{"op", "[", 
            RowBox[{"a", ",", "d", ",", "c"}], "]"}]}], "/;", 
          RowBox[{"NumericQ", "[", "n", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", "b_", ",", "c___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"b", " ", 
           RowBox[{"op", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "/;", 
          RowBox[{"NumericQ", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"op", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"-", "b_"}], ",", "c___"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"op", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"op", "[", "a__", "]"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Conjugate", "[", "#", "]"}], "&"}], ",", 
            RowBox[{"op", "[", "a", "]"}]}], "]"}], "/;", 
          RowBox[{"op", "=!=", "Dot"}]}]}]}], "\[IndentingNewLine]", "}"}], "//",
       "Flatten"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Trace", " ", "expansion", " ", "Rules"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TrExpand", "=", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"b_", "+", "c_"}], ",", "d___"}], "]"}], "->", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"a", ",", "b", ",", "d"}], "]"}], "+", 
       RowBox[{"Tr", "[", 
        RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"simplify", " ", "Trace", " ", "expressions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpleTr", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"-", "a_"}], ",", "b__"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"Tr", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{"a__", ",", 
           RowBox[{"-", "b_"}]}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"Tr", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"Tr", "[", "b", "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "a", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{"a__", ",", "b_"}], "]"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"Tr", "[", "a", "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{"a__", ",", 
           RowBox[{"Tr", "[", "b__", "]"}]}], "]"}], "]"}], "\[RuleDelayed]", 
        
        RowBox[{
         RowBox[{"Tr", "[", "a", "]"}], 
         RowBox[{"Tr", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{"a___", ",", "n_", ",", "c___"}], "]"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"n", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"a", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "n", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"n_", " ", "d_"}], ",", "c___"}], "]"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"n", " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"a", ",", "d", ",", "c"}], "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "n", "]"}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rules", " ", "to", " ", "simplify", " ", "Tr", " ", "expressions", " ", 
      "with", " ", "extention", " ", "to", " ", "simpleTr", " ", "to", " ", 
      "account", " ", "for", " ", "scalars_.", "  ", "Include", " ", 
      RowBox[{"TrExpand", ".", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", "expression"}]}]}], "//.", 
     RowBox[{"simpleTr2", "[", "scalars_List", "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleTr2", "[", "scalars_List", "]"}], ":=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"d_", " ", "c_"}], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"Tr", "[", 
            RowBox[{"a", ",", "d", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"d_", " ", 
            SuperscriptBox["c_", "n_"]}], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "n"], " ", 
           RowBox[{"Tr", "[", 
            RowBox[{"a", ",", "d", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"a___", ",", "c_", ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"Tr", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"a___", ",", 
           SuperscriptBox["c_", "n_"], ",", "b___"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "n"], " ", 
           RowBox[{"Tr", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"c", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Tr", "[", "b", "]"}]}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"a", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"a__", ",", "b_"}], "]"}], ":>", 
         RowBox[{
          RowBox[{
           RowBox[{"Tr", "[", "a", "]"}], "b"}], "/;", 
          RowBox[{"ListMemberQ", "[", 
           RowBox[{"b", ",", "scalars"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "simpleTr", ",", "TrExpand", ",", 
        RowBox[{"simpleDot2", "[", "scalars", "]"}]}], "}"}], "//", 
      "Flatten"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rules", " ", "for", " ", "simplifying", " ", "expressions", " ", "with", 
     " ", "metric", " ", 
     RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleMetric", "[", "g_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Tensor", "[", 
         RowBox[{"g", ",", 
          RowBox[{"{", 
           RowBox[{"Void", ",", "$a_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"$b_", ",", "Void"}], "}"}]}], "]"}], "->", 
        RowBox[{"Tensor", "[", 
         RowBox[{"g", ",", 
          RowBox[{"{", 
           RowBox[{"$b", ",", "Void"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Void", ",", "$a"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}]}], "]"}], "|", 
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "->", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "a_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}]}], "]"}], "|", 
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "a_"}], "}"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{"-", "1"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "a"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "b_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}]}], "]"}], "|", 
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}]}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "a", "]"}], "&&", 
          RowBox[{"IntegerQ", "[", "b", "]"}], "&&", 
          RowBox[{"a", "=!=", "b"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "a_"}], "}"}]}], "]"}], "|", 
         RowBox[{"Tensor", "[", 
          RowBox[{"g", ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "a_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "Void"}], "}"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{"-", "2"}], "/;", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "a", "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Finds", " ", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"x", ",", "x", ",", "x", ",", "x"}], "]"}], " ", 
      RowBox[{"(", "LeviCivitaTensor", ")"}], " ", "in", " ", "expression", 
      " ", "and", " ", "set"}], " ", "\[Equal]", " ", 
     RowBox[{
     "0", " ", "if", " ", "any", " ", "upper", " ", "and", " ", "lower", " ", 
      "indices", " ", "are", " ", "duplicated"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simple\[Epsilon]", "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tmp", ",", "upper", ",", "lower", ",", "tensors", ",", "indices"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensors", "=", 
        RowBox[{"ExtractPositionPattern", "[", 
         RowBox[{"exp", ",", 
          RowBox[{"Tensor", "[", 
           RowBox[{"\[Epsilon]", ",", "_List", ",", "_List"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"$i", "=", "1"}], ",", 
         RowBox[{"$i", "<=", 
          RowBox[{"Length", "[", "tensors", "]"}]}], ",", 
         RowBox[{"$i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"tensors", "[", 
            RowBox[{"[", "$i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"upper", "=", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lower", "=", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"upper", ",", "lower"}], "}"}], "]"}], ",", "Void"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"DeleteDuplicates", "[", "indices", "]"}], "]"}], "!=", 
             
             RowBox[{"Length", "[", "indices", "]"}]}], ",", 
            RowBox[{
             RowBox[{"tmp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", "0"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tensors", "[", 
            RowBox[{"[", "$i", "]"}], "]"}], "=", "tmp"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"exp", ",", "tensors"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Standard", " ", "order", " ", "of", " ", "indices", " ", "of", " ", 
      "LeviCivita", " ", "tensor"}], ",", " ", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["\[Epsilon]", "abc"], ")"}], "def"]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Order\[Epsilon]", "[", "tensor_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "tmps", ",", "u1", ",", "d1", ",", "u", ",", "d", ",", 
         "xx", ",", "yy", ",", "cycle", ",", "order", ",", "tmpx", ",", 
         "tmpy"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u1", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d1", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xx", "[", "#1", "]"}], ",", 
                 RowBox[{"yy", "[", "#2", "]"}]}], "}"}], ",", 
               RowBox[{"_", "[", "Void", "]"}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"u1", ",", "d1"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmps", "=", 
         RowBox[{"Sort", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cycle", "=", 
         RowBox[{"FindPermutation", "[", 
          RowBox[{"tmp", ",", "tmps"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"order", "=", 
         RowBox[{"PermutationOrder", "[", "cycle", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpy", "=", 
         RowBox[{
          RowBox[{"tmps", "/.", 
           RowBox[{
            RowBox[{"xx", "[", "_", "]"}], "\[Rule]", "Void"}]}], "/.", 
          RowBox[{
           RowBox[{"yy", "[", "a_", "]"}], "\[Rule]", "a"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpx", "=", 
         RowBox[{
          RowBox[{"tmps", "/.", 
           RowBox[{
            RowBox[{"yy", "[", "_", "]"}], "\[Rule]", "Void"}]}], "/.", 
          RowBox[{
           RowBox[{"xx", "[", "a_", "]"}], "\[Rule]", "a"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"order", "+", "1"}]], 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"tensor", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "tmpx", ",", "tmpy"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "for", " ", "standard", " ", "ordering", " ", "of", " ", 
     "all", " ", "\[Epsilon]", " ", 
     RowBox[{"tensors", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"OrderAll\[Epsilon]", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Tensor", "[", 
       RowBox[{"\[Epsilon]", ",", "a_", ",", "b_"}], "]"}], ":>", 
      RowBox[{"Order\[Epsilon]", "[", 
       RowBox[{"Tensor", "[", 
        RowBox[{"\[Epsilon]", ",", "a", ",", "b"}], "]"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Contracts", " ", "\[Epsilon]", " ", "tensor", " ", "pairs", " ", "in", 
      " ", "n"}], "-", 
     RowBox[{"dimensions", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simple2\[Epsilon]", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "tmpp", ",", "tmp1", ",", "tmp2", ",", "tmpd", ",", "u1", 
         ",", "u2", ",", "d1", ",", "d2", ",", "U1", ",", "D1", ",", "U2", 
         ",", "D2", ",", "E\[Epsilon]E"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Epsilon]", ",", "u1_List", ",", "d1_List"}], "]"}], 
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Epsilon]", ",", "u2_List", ",", "d2_List"}], "]"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"E\[Epsilon]E", "[", 
            RowBox[{"u1", ",", "d1", ",", "u2", ",", "d2"}], "]"}]}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tmpp", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"E\[Epsilon]E", "[", "___", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"$i", "=", "1"}], ",", 
          RowBox[{"$i", "<=", 
           RowBox[{"Length", "[", "tmpp", "]"}]}], ",", 
          RowBox[{"$i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp1", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", 
              RowBox[{"tmpp", "[", 
               RowBox[{"[", 
                RowBox[{"$i", ",", "2", ",", 
                 RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"!!", "\[IndentingNewLine]", "tmp1"}], "=", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"U1", "[", "#1", "]"}], ",", 
                    RowBox[{"D1", "[", "#2", "]"}]}], "}"}], ",", 
                  RowBox[{"_", "[", "Void", "]"}]}], "]"}], "&"}], ",", 
               "tmp1"}], "]"}], "//", "Flatten"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp2", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", 
              RowBox[{"tmpp", "[", 
               RowBox[{"[", 
                RowBox[{"$i", ",", "2", ",", 
                 RowBox[{"3", ";;", "4"}]}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp2", "=", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"U1", "[", "#1", "]"}], ",", 
                    RowBox[{"D1", "[", "#2", "]"}]}], "}"}], ",", 
                  RowBox[{"_", "[", "Void", "]"}]}], "]"}], "&"}], ",", 
               "tmp2"}], "]"}], "//", "Flatten"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmpd", "=", 
            RowBox[{
             RowBox[{"Array", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"\[Delta]", ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tmp1", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"tmp2", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{
                    RowBox[{"D1", "[", "_", "]"}], "\[Rule]", "Void"}]}], 
                   ")"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tmp1", "[", 
                    RowBox[{"[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"tmp2", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{
                    RowBox[{"U1", "[", "_", "]"}], "\[Rule]", "Void"}]}], 
                   ")"}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Length", "[", "tmp1", "]"}], ",", 
                 RowBox[{"Length", "[", "tmp1", "]"}]}], "}"}]}], "]"}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"U1", "|", "D1"}], ")"}], "[", "a_", "]"}], "\[Rule]",
               "a"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpd", "=", 
            RowBox[{"Det", "[", "tmpd", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpd", "=", 
            RowBox[{"tmpd", "//", 
             RowBox[{"simple\[Delta]", "[", "\[Delta]", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tmpp", "[", 
             RowBox[{"[", 
              RowBox[{"$i", ",", "2"}], "]"}], "]"}], "=", "tmpd"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"tmp", ",", "tmpp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Relabels", " ", "\[Epsilon]"}], "-", 
      RowBox[{
      "matrix", " ", "indices", " ", "contained", " ", "in", " ", "product", 
       " ", "terms", " ", "to", " ", "indices", " ", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}]}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", "..."}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Relabel\[Epsilon]", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "pos", ",", "ipos", ",", "tmpp", 
         ",", "pos\[Delta]", ",", "ipos\[Delta]", ",", "indices", ",", 
         "post"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}], ",", 
             "b___"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ipos", "=", "1"}], ",", 
          RowBox[{"ipos", "\[LessEqual]", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpp", "=", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pos\[Delta]", "=", 
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"tmpp", ",", 
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"post", "=", 
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"tmpp", ",", 
              RowBox[{"Tensor", "[", 
               RowBox[{"_", ",", "_", ",", "_"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"ipos\[Delta]", "=", "1"}], ",", 
             RowBox[{"ipos\[Delta]", "\[LessEqual]", 
              RowBox[{"Length", "[", "pos\[Delta]", "]"}]}], ",", 
             RowBox[{"ipos\[Delta]", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"indices", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Apply", "[", 
                   RowBox[{"List", ",", 
                    RowBox[{"pos\[Delta]", "[", 
                    RowBox[{"[", 
                    RowBox[{"ipos\[Delta]", ",", "2"}], "]"}], "]"}]}], "]"}],
                   "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ";;", "3"}], "]"}], "]"}], "//", 
                 "Flatten"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"indices", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"indices", ",", "Void"}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
              RowBox[{"indices", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"indices", ",", 
                   RowBox[{"Array", "[", 
                    RowBox[{"\[Epsilon]", ",", 
                    RowBox[{"Length", "[", "indices", "]"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"post", "=", 
               RowBox[{"post", "//", 
                RowBox[{"IndexChangeTU", "[", "indices", "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tmpp", "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"tmpp", ",", "post"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", "tmpp"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tmp", ",", "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Expands", " ", "and", " ", "changes", " ", "each", " ", "term", " ", 
     "in", " ", "expression", " ", "so", " ", "that", " ", "all", " ", 
     "\[Epsilon]", " ", "indices", " ", "are", " ", "in", " ", "down", " ", 
     RowBox[{"position", ".", "  ", "May"}], " ", "not", " ", "handle", " ", 
     "summing", " ", "over", " ", "2", " ", "\[Epsilon]", " ", 
     RowBox[{"tensors", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"All\[Epsilon]Down", "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "pos", ",", "ipos", ",", "tmpp", 
        ",", "pos\[Epsilon]", ",", "ipos\[Epsilon]", ",", "indices"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Times", " ", "terms", " ", "with", " ", "\[Epsilon]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"ExtractPositionPattern", "[", 
         RowBox[{"tmp", ",", 
          RowBox[{"Times", "[", 
           RowBox[{"a___", ",", 
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}], ",", "b___"}],
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ipos", "=", "1"}], ",", 
         RowBox[{"ipos", "\[LessEqual]", 
          RowBox[{"Length", "[", "pos", "]"}]}], ",", 
         RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmpp", "=", 
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pos\[Epsilon]", "=", 
           RowBox[{"ExtractPositionPattern", "[", 
            RowBox[{"tmpp", ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Epsilon]", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ipos\[Epsilon]", "=", "1"}], ",", 
            RowBox[{"ipos\[Epsilon]", "\[LessEqual]", 
             RowBox[{"Length", "[", "pos\[Epsilon]", "]"}]}], ",", 
            RowBox[{"ipos\[Epsilon]", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"indices", "=", 
              RowBox[{
               RowBox[{"pos\[Epsilon]", "[", 
                RowBox[{"[", "ipos\[Epsilon]", "]"}], "]"}], "  ", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"indices", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"indices", ",", "Void"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tmpp", "=", 
              RowBox[{"tmpp", "//", 
               RowBox[{"SwapUpDownIndices", "[", "indices", "]"}]}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", "tmpp"}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"tmp", ",", "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Returns", " ", "a", " ", 
     RowBox[{"{", 
      RowBox[{"exp_", ",", " ", 
       RowBox[{
       "Down", " ", "index", " ", "version", " ", "of", " ", "exp_", " ", 
        "of", " ", "indices_List"}]}], "}"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"WithIndexDown", "[", "indices_List", "]"}], "[", "exp_", "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"exp", ",", 
          RowBox[{"Fold", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"LowerIndex", "[", 
               RowBox[{"#2", ",", "#2"}], "]"}], "[", "#1", "]"}], "&"}], ",",
             "exp", ",", "indices"}], "]"}]}], "}"}], "//", "Flatten"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Replacement", " ", "for", " ", "the", " ", "IndexChange", " ", 
      "routine", " ", "which", " ", "does", " ", "not", " ", "handle", " ", 
      "indices", " ", "in", " ", "functional", " ", "form"}], ",", " ", 
     RowBox[{"i", ".", "e", "."}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "i", "]"}], ".", "  ", "pairs_List"}], " ", "is", 
      " ", "a", " ", "List", " ", "of", " ", "pairs"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "."}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IndexChangeTU", "[", "pairs_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "pos", ",", "rules", ",", "ipos", ",", "tmpp"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rules", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Rule", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "pairs", "}"}], "]"}], ",", "2"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp", ",", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"_", ",", "_", ",", "_"}], "]"}], "|", 
            RowBox[{"xPartialD", "[", 
             RowBox[{"_", ",", "_"}], "]"}], "|", 
            RowBox[{"xD", "[", 
             RowBox[{"_", ",", "_", ",", "_"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ipos", "=", "1"}], ",", 
          RowBox[{"ipos", "\[LessEqual]", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpp", "=", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "xPartialD", ",", "xPartialDu", ",", "xCovariantD", ",", 
                 "xCovariantDu", ",", "xD"}], "}"}], ",", 
               RowBox[{"Head", "[", "tmpp", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"tmpp", "=", 
              RowBox[{"MapAt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "/.", "rules"}], "&"}], ",", "tmpp", ",", 
                RowBox[{"{", 
                 RowBox[{"{", "2", "}"}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"tmpp", "=", 
              RowBox[{"MapAt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "/.", "rules"}], "&"}], ",", "tmpp", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "2", "}"}], ",", 
                  RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", "tmpp"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"exp", ",", "pos"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Returns", " ", "exp_", " ", "antisymmetrized", " ", "over", " ", 
     "indices_List", "  ", "Try", " ", "AntiSymmetric", " ", "in", " ", 
     RowBox[{"Tensorial", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AntiSymmetrizeIndices", "[", "indices_List", "]"}], "[", 
      "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"Expand", "[", "exp", "]"}]}], ",", "pos", ",", "ipos", ",",
          "tmpp", ",", "indexFree", ",", "indPermuted", ",", "signature", ",",
          "sub"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Dot", "->", "xDot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "HoldPattern", " ", "does", " ", "not", " ", "work", " ", "with", 
          " ", "Dot"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pos", "=", 
             RowBox[{"ExtractPositionPattern", "[", 
              RowBox[{"tmp", ",", 
               RowBox[{"Times", "[", 
                RowBox[{"a___", ",", "IndexVarPatterns", ",", "b___"}], 
                "]"}]}], "]"}]}], ")"}], "==", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pos", "=", 
               RowBox[{"ExtractPositionPattern", "[", 
                RowBox[{"tmp", ",", 
                 RowBox[{"xDot", "[", 
                  RowBox[{"a___", ",", "IndexVarPatterns", ",", "b___"}], 
                  "]"}]}], "]"}]}], ")"}], "==", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"pos", "=", 
             RowBox[{"ExtractPositionPattern", "[", 
              RowBox[{"tmp", ",", 
               RowBox[{"Tensor", "[", 
                RowBox[{"_", ",", "_", ",", "_"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indPermuted", "=", 
         RowBox[{"Permutations", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"signature", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Signature", "[", "#", "]"}], "&"}], ",", "indPermuted"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"indices", "->", "#"}], "]"}], "&"}], ",", 
            "indPermuted"}], "]"}], "/.", 
          RowBox[{"Rule", "->", "List"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ipos", "=", "1"}], ",", 
          RowBox[{"ipos", "\[LessEqual]", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpp", "=", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"indexFree", "=", 
            RowBox[{
             RowBox[{"ExtractFreeIndices", "[", "tmpp", "]"}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"IndexChangeTU", "[", "#", "]"}], "[", "tmpp", "]"}], 
               "&"}], ",", "sub"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", 
              RowBox[{"Thread", "[", 
               RowBox[{"signature", " ", "tmpp"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"tmpp", "/", 
             RowBox[{"(", 
              RowBox[{"Length", "[", "indPermuted", "]"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", "tmpp"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"List", "[", 
         RowBox[{"pos", "=", 
          RowBox[{"pos", "/.", 
           RowBox[{"xDot", "->", "Dot"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"tmp", ",", "pos"}], "]"}]}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Returns", " ", "exp_", " ", "symmetrized", " ", "over", " ", 
     RowBox[{"indices_List", ".", " ", "First"}], " ", "try", " ", 
     "Symmetric", " ", "in", " ", 
     RowBox[{"Tensorial", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SymmetrizeIndices", "[", "indices_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"Expand", "[", "exp", "]"}]}], ",", "pos", ",", "ipos", ",",
          "tmpp", ",", "indexFree", ",", "indPermuted", ",", "signature", ",",
          "sub"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Dot", "->", "xDot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "HoldPattern", " ", "does", " ", "not", " ", "work", " ", "with", 
          " ", "Dot"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pos", "=", 
             RowBox[{"ExtractPositionPattern", "[", 
              RowBox[{"tmp", ",", 
               RowBox[{"Times", "[", 
                RowBox[{"a___", ",", "IndexVarPatterns", ",", "b___"}], 
                "]"}]}], "]"}]}], ")"}], "==", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pos", "=", 
               RowBox[{"ExtractPositionPattern", "[", 
                RowBox[{"tmp", ",", 
                 RowBox[{"xDot", "[", 
                  RowBox[{"a___", ",", "IndexVarPatterns", ",", "b___"}], 
                  "]"}]}], "]"}]}], ")"}], "==", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"pos", "=", 
             RowBox[{"ExtractPositionPattern", "[", 
              RowBox[{"tmp", ",", 
               RowBox[{"Tensor", "[", 
                RowBox[{"_", ",", "_", ",", "_"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indPermuted", "=", 
         RowBox[{"Permutations", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"indices", "->", "#"}], "]"}], "&"}], ",", 
            "indPermuted"}], "]"}], "/.", 
          RowBox[{"Rule", "->", "List"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ipos", "=", "1"}], ",", 
          RowBox[{"ipos", "\[LessEqual]", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpp", "=", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"indexFree", "=", 
            RowBox[{
             RowBox[{"ExtractFreeIndices", "[", "tmpp", "]"}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"IndexChangeTU", "[", "#", "]"}], "[", "tmpp", "]"}], 
               "&"}], ",", "sub"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", 
              RowBox[{"Thread", "[", " ", "tmpp", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"tmpp", "/", 
             RowBox[{"(", 
              RowBox[{"Length", "[", "indPermuted", "]"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", "tmpp"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"List", "[", 
         RowBox[{"pos", "=", 
          RowBox[{"pos", "/.", 
           RowBox[{"xDot", "->", "Dot"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"tmp", ",", "pos"}], "]"}]}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Simplifies", " ", "\[Delta]uu"}], ",", "\[Delta]ud", ",", 
     "\[Delta]du", ",", 
     RowBox[{
      RowBox[{
      "\[Delta]dd", " ", "and", " ", "contractions", " ", "into", " ", 
       "standard", " ", 
       RowBox[{"form", ".", "  ", "Does"}], " ", "not", " ", "care", " ", 
       "about", " ", "Einstein", " ", 
       RowBox[{"notation", ".", " ", 
        RowBox[{"Usage", ":", " ", "exp_"}]}]}], "//.", 
      RowBox[{"simple\[Delta]", "[", "dim_", "]"}]}]}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"simple\[Delta]", "[", "\[Delta]_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"KroneckerAbsorb", "[", "\[Delta]", "]"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
         "This", " ", "only", " ", "works", " ", "with", " ", "UpDown", " ", 
          RowBox[{"\[Delta]", "'"}], "s"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Delta]", "@", 
              RowBox[{"uu", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"uu", "[", 
                RowBox[{"b", ",", "a"}], "]"}]}], "/;", 
              RowBox[{"OrderedQ", "[", 
               RowBox[{"b", ",", "a"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\[Delta]", "@", 
              RowBox[{"dd", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"dd", "[", 
                RowBox[{"b", ",", "a"}], "]"}]}], "/;", 
              RowBox[{"OrderedQ", "[", 
               RowBox[{"b", ",", "a"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\[Delta]", "@", 
              RowBox[{"du", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"ud", "[", 
                RowBox[{"b", ",", "a"}], "]"}]}], "/;", 
              RowBox[{"OrderedQ", "[", 
               RowBox[{"b", ",", "a"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Following", " ", "not", " ", "recognized", " ", "by", " ", 
              RowBox[{"KroneckerAbsorb", "[", "\[Delta]", "]"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"uu", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}]}], 
              RowBox[{"\[Delta]", "@", 
               RowBox[{"dd", "[", 
                RowBox[{"a_", ",", "c_"}], "]"}]}]}], ":>", 
             RowBox[{"\[Delta]", "@", 
              RowBox[{"ud", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}]}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"Einstein", " ", "sums"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"uu", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}]}], 
              RowBox[{"\[Delta]", "@", 
               RowBox[{"dd", "[", 
                RowBox[{"c_", ",", "a_"}], "]"}]}]}], ":>", 
             RowBox[{"\[Delta]", "@", 
              RowBox[{"ud", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"uu", "[", 
                RowBox[{"b_", ",", "a_"}], "]"}]}], 
              RowBox[{"\[Delta]", "@", 
               RowBox[{"dd", "[", 
                RowBox[{"a_", ",", "c_"}], "]"}]}]}], ":>", 
             RowBox[{"\[Delta]", "@", 
              RowBox[{"ud", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Delta]", "@", 
               RowBox[{"uu", "[", 
                RowBox[{"b_", ",", "a_"}], "]"}]}], 
              RowBox[{"\[Delta]", "@", 
               RowBox[{"dd", "[", 
                RowBox[{"c_", ",", "a_"}], "]"}]}]}], ":>", 
             RowBox[{"\[Delta]", "@", 
              RowBox[{"ud", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "a_List", ",", "b_List"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"GetBaseIndices", "[", 
                RowBox[{"First", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "Void"}], "]"}], 
                 "]"}], "]"}], "]"}], "/;", 
              RowBox[{"Apply", "[", 
               RowBox[{"Equal", ",", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "Void"}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Contracts", " ", "\[Delta]", " ", 
      RowBox[{"(", "KroneckerDelta", ")"}], " ", "indices", " ", "with", " ", 
      "other", " ", "expression", " ", 
      RowBox[{"indices", ".", " ", "Does"}], " ", "not", " ", "respect", " ", 
      "Einstein", " ", 
      RowBox[{"up", "/", "down"}], " ", 
      RowBox[{"notation", ".", " ", "KroneckerContract"}], " ", "works", " ", 
      "better", " ", "although", " ", "needs", " ", "up"}], "-", 
     RowBox[{"down", " ", 
      RowBox[{"convention", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Contract\[Delta]", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "pos", ",", "ipos", ",", "tmpp", 
         ",", "pos\[Delta]", ",", "ipos\[Delta]", ",", "indices", ",", "post",
          ",", "testindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "_", ",", "_"}], "]"}], ",", "b___"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"List", "[", "pos", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ipos", "=", "1"}], ",", 
          RowBox[{"ipos", "\[LessEqual]", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpp", "=", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pos\[Delta]", "=", 
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"tmpp", ",", 
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Delta]", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"List", "[", "pos\[Delta]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmpp", "=", 
            RowBox[{"tmpp", "/.", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Delta]", ",", "_", ",", "_"}], "]"}], "\[Rule]", 
              "1"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"post", "=", 
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"tmpp", ",", 
              RowBox[{"Tensor", "[", 
               RowBox[{"_", ",", "_", ",", "_"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"ipos\[Delta]", "=", "1"}], ",", 
             RowBox[{"ipos\[Delta]", "\[LessEqual]", 
              RowBox[{"Length", "[", "pos\[Delta]", "]"}]}], ",", 
             RowBox[{"ipos\[Delta]", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"indices", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Apply", "[", 
                  RowBox[{"List", ",", 
                   RowBox[{"pos\[Delta]", "[", 
                    RowBox[{"[", 
                    RowBox[{"ipos\[Delta]", ",", "2"}], "]"}], "]"}]}], "]"}],
                  "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ";;", "3"}], "]"}], "]"}], "//", "Flatten"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"indices", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"indices", ",", "Void"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Check", " ", "if", " ", "indices", " ", "match", " ", "to", 
                " ", "see", " ", "if", " ", "\[Delta]", " ", "is", " ", 
                RowBox[{"consumed", "."}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"testindices", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"ParseTermIndices", "[", "tmpp", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "//", "Flatten"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"testindices", ",", 
                  RowBox[{"First", "[", "indices", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"post", "=", 
                  RowBox[{"post", "//", 
                   RowBox[{"IndexChangeTU", "[", 
                    RowBox[{"{", "indices", "}"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tmpp", "=", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{"tmpp", ",", "post"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"tmpp", "=", 
                 RowBox[{"tmpp", " ", 
                  RowBox[{"pos\[Delta]", "[", 
                   RowBox[{"[", 
                    RowBox[{"ipos\[Delta]", ",", "2"}], "]"}], "]"}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", "tmpp"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tmp", ",", "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rules", " ", "for", " ", "expanding", " ", "Einstein", " ", "indices", 
     " ", "in", " ", 
     RowBox[{"Dot", "'"}], "d", " ", 
     RowBox[{"expression", ".", "  ", "Handles"}], " ", 
     RowBox[{
      RowBox[{"xPartialD", "[", "]"}], "'"}], "s", " ", "and", " ", "Uses", 
     " ", 
     RowBox[{"\[Eta]dd", "[", "]"}], " ", "as", " ", "coefficients", " ", 
     "in", " ", "sum", " ", "and", " ", "preference", " ", "for", " ", 
     "results", " ", "with", " ", "lower", " ", 
     RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DotSumExpand", "[", "range_List", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ".", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"d_", ",", "e_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", 
             RowBox[{"xPartialD", "[", 
              RowBox[{"d", ",", "e"}], "]"}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"d_", ",", "e_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"d", ",", "e"}], "]"}], ".", 
             RowBox[{"Tensor", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ".", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"d_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{"a", ",", "b"}], "]"}], ".", 
            RowBox[{"xPartialDu", "[", 
             RowBox[{"d", ",", "b"}], "]"}]}], "/.", 
           RowBox[{"b", "\[Rule]", "j"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "range"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialDu", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ".", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"d_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"xPartialDu", "[", 
             RowBox[{"a", ",", "b"}], "]"}], ".", 
            RowBox[{"xPartialD", "[", 
             RowBox[{"d", ",", "b"}], "]"}]}], "/.", 
           RowBox[{"b", "\[Rule]", "j"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "range"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"NOT", " ", "FINISHED", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ".", 
          RowBox[{"Tensor", "[", 
           RowBox[{"d_", ",", "e_", ",", "f_"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Eta]uu", "[", 
              RowBox[{"e", ",", "e"}], "]"}], 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", 
              RowBox[{"Tensor", "[", 
               RowBox[{"d", ",", "e", ",", "f"}], "]"}]}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", "range"}], "}"}], "//", "Flatten"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"FIND", " ", "mutual", " ", "index"}], "*)"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rules", " ", "for", " ", "expanding", " ", "Einstein", " ", "indices", 
      " ", "in", " ", 
      RowBox[{"Dot", "'"}], "d", " ", 
      RowBox[{"expression", ".", "  ", "Handles"}], " ", 
      RowBox[{
       RowBox[{"xPartialDu", "[", "]"}], "'"}], "s", " ", "and", " ", "uses", 
      " ", 
      RowBox[{"\[Eta]dd", "[", "]"}], " ", "to", " ", "convert", " ", "from", 
      " ", "xPartialDu"}], "->", "xPartialD"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DotSumExpand\[Eta]", "[", "range_List", "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ".", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"d_", ",", "e_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", 
             RowBox[{"xPartialD", "[", 
              RowBox[{"d", ",", "e"}], "]"}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ".", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"d_", ",", "e_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", 
              RowBox[{"xPartialD", "[", 
               RowBox[{"d", ",", "e"}], "]"}]}], 
             RowBox[{"\[Eta]uu", "[", 
              RowBox[{"e", ",", "e"}], "]"}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"c", ",", "e"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"d_", ",", "e_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"d", ",", "e"}], "]"}], ".", 
             RowBox[{"Tensor", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialDu", "[", 
          RowBox[{"d_", ",", "e_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"xPartialD", "[", 
               RowBox[{"d", ",", "e"}], "]"}], ".", 
              RowBox[{"Tensor", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], 
             RowBox[{"\[Eta]uu", "[", 
              RowBox[{"e", ",", "e"}], "]"}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ".", 
         RowBox[{"xPartialDu", "[", 
          RowBox[{"d_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ".", 
             RowBox[{"xPartialD", "[", 
              RowBox[{"d", ",", "b"}], "]"}]}], 
            RowBox[{"\[Eta]uu", "[", 
             RowBox[{"b", ",", "b"}], "]"}]}], "/.", 
           RowBox[{"b", "\[Rule]", "j"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "range"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialDu", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ".", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"d_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ".", 
             RowBox[{"xPartialD", "[", 
              RowBox[{"d", ",", "b"}], "]"}]}], 
            RowBox[{"\[Eta]uu", "[", 
             RowBox[{"b", ",", "b"}], "]"}]}], "/.", 
           RowBox[{"b", "\[Rule]", "j"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "range"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"NOT", " ", "FINISHED", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ".", 
          RowBox[{"Tensor", "[", 
           RowBox[{"d_", ",", "e_", ",", "f_"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Eta]uu", "[", 
              RowBox[{"e", ",", "e"}], "]"}], 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], ".", 
              RowBox[{"Tensor", "[", 
               RowBox[{"d", ",", "e", ",", "f"}], "]"}]}]}], "/.", 
            RowBox[{"e", "\[Rule]", "j"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", "range"}], "}"}], "//", "Flatten"}]}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"b", ",", "e"}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"FIND", " ", "mutual", " ", "index"}], "*)"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"DotIndexSum", "[", 
      RowBox[{"exp_", ",", "range_List"}], "]"}], " ", "sums", " ", "indices",
      " ", "over", " ", "range_list", " ", "in", " ", 
     RowBox[{"Dot", "[", "]"}], " ", "expressions", " ", "in", " ", "exp_.", "  ",
      "This", " ", "routine", " ", "removes", " ", "difficiences", " ", "in", 
     " ", "NewIndexChangePatterns", " ", "and", " ", 
     RowBox[{
      RowBox[{"EinsteinSum", "[", "]"}], ".", "  ", "Replaces"}], " ", 
     RowBox[{"DotSumExpand", "[", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DotIndexSum", "[", 
      RowBox[{"exp_", ",", "range_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"exp0", "=", "exp"}], ",", "tmp", ",", "onetime", ",", 
         "list", ",", "dlist", ",", "ilist", ",", "i", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<DotIndexSum\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp0", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"Dot", "\[Rule]", "xDot"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Next", " ", "line", " ", "does", " ", "not", " ", "work", " ", 
           "with", " ", 
           RowBox[{"Dot", "[", "]"}]}], ",", " ", 
          RowBox[{"needs", " ", 
           RowBox[{"xDot", "[", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp0", ",", 
           RowBox[{"xDot", "[", "__", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"list", ",", 
            RowBox[{"Length", "[", "list", "]"}], ",", "onetime"}], "}"}], 
          ",", "\"\<list\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "list", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dlist", "=", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "/.", 
             RowBox[{"xDot", "\[Rule]", "Dot"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"IfDEBUG", "[", 
            RowBox[{"mname", ",", 
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"{", "dlist", "}"}], ",", "\"\<dlist\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ilist", "=", 
            RowBox[{
             RowBox[{"ParseTermIndices", "[", "dlist", "]"}], "//", 
             "First"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dlist", "=", 
            RowBox[{"dlist", "//", 
             RowBox[{"EinsteinSum", "[", "range", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"IfDEBUG", "[", 
            RowBox[{"mname", ",", 
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"ilist", ",", "dlist"}], "}"}], ",", 
             "\"\<ilist,dlist\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"dlist", "=", 
            RowBox[{"dlist", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"xPartialD", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], ".", "s___", ".", 
               RowBox[{"xPartialDu", "[", 
                RowBox[{"d_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"xPartialD", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ".", "s", ".", 
                   RowBox[{"xPartialDu", "[", 
                    RowBox[{"d", ",", "b"}], "]"}]}], "/.", 
                  RowBox[{"b", "\[Rule]", "j"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "range"}], "}"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"ilist", ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dlist", "=", 
            RowBox[{"dlist", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"xPartialDu", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], ".", "s___", ".", 
               RowBox[{"xPartialD", "[", 
                RowBox[{"d_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"xPartialD", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ".", "s", ".", 
                   RowBox[{"xPartialDu", "[", 
                    RowBox[{"d", ",", "b"}], "]"}]}], "/.", 
                  RowBox[{"b", "\[Rule]", "j"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"j", ",", "range"}], "}"}], "//", "Flatten"}]}], 
                "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"ilist", ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", "dlist"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"IfDEBUG", "[", 
            RowBox[{"mname", ",", 
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"{", "list", "}"}], ",", "\"\<list\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "exp0", "]"}], "===", "xDot"}], ",", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"exp0", ",", "list"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DotIndexSum", "[", "range_List", "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"DotIndexSum", "[", 
     RowBox[{"exp", ",", "range"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Computes", " ", "Euler"}], "-", 
      RowBox[{
      "Lagrange", " ", "equation", " ", "for", " ", "single", " ", "field", 
       " ", 
       RowBox[{"(", "field_", ")"}], "given", " ", "Lagrangian_", " ", "and", 
       " ", "indices"}]}], ",", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"t_", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ".", "  ", 
         "Uses"}], " ", 
        RowBox[{"\[Eta]uu", "[", "]"}], " ", "for", " ", "summing", " ", 
        "over", " ", "indices", " ", "t_.", "  ", "Returns", " ", "Euler"}], 
       "-", 
       RowBox[{"Lagrange", " ", "equation"}]}], " ", "\[Rule]", " ", "0"}]}], 
    " ", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"EulerLagrange", "[", 
      RowBox[{"Lagrangian_", ",", "field_", ",", "t_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "tL", ",", "tEL", ",", "tEL0", ",", "tEL1", ",", "\[Mu]", 
         ",", "i", ",", "j", ",", "out", ",", "dfield", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<EulerLagrange\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tL", "=", 
         RowBox[{"Lagrangian", "/.", 
          RowBox[{"DotSumExpand\[Eta]", "[", "t", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tL", "}"}], ",", "\"\<{tL}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dfield", "=", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"field", ",", "\[Mu]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tEL", "=", 
         RowBox[{
          RowBox[{"xPartialD", "[", 
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{"tL", ",", 
              RowBox[{"xPartialD", "[", 
               RowBox[{"field", ",", "\[Mu]"}], "]"}]}], "]"}], ",", 
            "\[Mu]"}], "]"}], "-", 
          RowBox[{"xPartialD", "[", 
           RowBox[{"tL", ",", "field"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tEL0", "=", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"tL", ",", "field"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tEL0", "=", 
         RowBox[{"tEL0", "/.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{"D", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"tEL1", "=", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"tL", ",", "dfield"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"tEL1", "=", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"tEL1", ",", "\[Mu]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "t", ",", "tEL1"}], "}"}], ",", 
          "\"\<{j,t,tEL1}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tEL1", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"tEL1", "/.", 
            RowBox[{"\[Mu]", "\[Rule]", "j"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "t"}], "}"}]}], "  ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tEL1", "}"}], ",", "\"\<{tEL1}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "t", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"tEL1", "=", 
           RowBox[{"tEL1", "/.", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a_", ",", 
               RowBox[{"dfield", "/.", 
                RowBox[{"\[Mu]", "\[Rule]", 
                 RowBox[{"t", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}], ":>", 
             RowBox[{"D", "[", 
              RowBox[{"a", ",", 
               RowBox[{"dfield", "/.", 
                RowBox[{"\[Mu]", "\[Rule]", 
                 RowBox[{"t", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"out", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"tEL1", "-", "tEL0"}], "/.", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "__", "]"}], "[", "_", "]"}], "[", 
              "__", "]"}], "\[Rule]", "0"}]}], "//.", 
           RowBox[{"xPartialDExpand", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Gamma]u", "[", "_", "]"}], ",", 
              RowBox[{"\[Gamma]", "[", "_", "]"}]}], "}"}], "]"}]}], "//.", 
          "simpleDot"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"out", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generates", " ", "a", " ", "Series", " ", "to", " ", "order_", " ", "in",
      " ", "pattern_", " ", "from", " ", "exp_"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesByPattern", "[", 
      RowBox[{"exp_", ",", "pattern_", ",", "order_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "tmp", ",", "xpos", ",", "XXXX", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<SeriesPattern\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp", ",", "pattern"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"exp", ",", "pattern", ",", "pos"}], "}"}], ",", 
          "\"\<{exp,pattern,pos}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xpos", "=", 
         RowBox[{"pos", "/.", 
          RowBox[{"pattern", "\[Rule]", "XXXX"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"exp", ",", "xpos"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"xpos", ",", "tmp"}], "}"}], ",", "\"\<{xpos,tmp}\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"XXXX", ",", "0", ",", "order"}], "}"}]}], "]"}], "//", 
          "Normal"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"XXXX", "\[Rule]", 
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplifies", " ", 
     RowBox[{"BraKet", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpleBraKet", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"BraKet", "[", 
         RowBox[{"a_", "+", "b_"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"BraKet", "[", "a", "]"}], "+", 
         RowBox[{"BraKet", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BraKet", "[", 
         RowBox[{"a_", " ", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"BraKet", "[", "b", "]"}]}], "/;", 
         RowBox[{"NumericQ", "[", "a", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"BraKet", "[", "a_", " ", "]"}], "\[RuleDelayed]", 
        RowBox[{"a", " ", "/;", 
         RowBox[{"NumericQ", "[", "a", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"Bra", "[", "a_", "]"}], ".", " ", 
         RowBox[{"(", 
          RowBox[{"b_", "+", "c_"}], ")"}], " ", ".", " ", 
         RowBox[{"Ket", "[", "d_", "]"}]}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"Bra", "[", "a", "]"}], ".", "b", ".", 
          RowBox[{"Ket", "[", "d", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Bra", "[", "a", "]"}], ".", "c", ".", 
          RowBox[{"Ket", "[", "d", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Bra", "[", "a_", "]"}], " ", ".", " ", 
         RowBox[{"(", 
          RowBox[{"b_", "  ", "c_"}], ")"}], " ", ".", " ", 
         RowBox[{"Ket", "[", "d_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{
           RowBox[{"Bra", "[", "a", "]"}], " ", ".", " ", "c", " ", ".", " ", 
           
           RowBox[{"Ket", "[", "d", "]"}]}]}], "/;", 
         RowBox[{"NumericQ", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"Bra", "[", "a_", "]"}], ".", " ", 
         RowBox[{"(", "b_", ")"}], " ", ".", " ", 
         RowBox[{"Ket", "[", "d_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{
           RowBox[{"Bra", "[", "a", "]"}], ".", 
           RowBox[{"Ket", "[", "d", "]"}]}]}], "/;", 
         RowBox[{"NumericQ", "[", "b", "]"}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generates", " ", "a", " ", "list", " ", "of", " ", "Clifford", " ", 
     "algebra", " ", "basis", " ", "in", " ", "Wedge", " ", "form", 
     "\[IndentingNewLine]", "assuming", " ", "basis", " ", 
     RowBox[{"ed", "[", "i", "]"}], " ", "for", " ", "vector", " ", "space", 
     " ", "V", " ", "of", " ", "dimension", " ", 
     RowBox[{"d", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WedgeClifBasis", "[", "d_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Subsets", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ed", "[", "#", "]"}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"\[ScriptCapitalC]\[ScriptL]", "[", 
           RowBox[{
            RowBox[{"V", "[", "d", "]"}], ",", "Q"}], "]"}], "->", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
               RowBox[{"Apply", "[", 
                RowBox[{"Wedge", ",", 
                 RowBox[{"Sequence", "[", "#", "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "#", "]"}], "==", "1"}], ",", 
                 RowBox[{"#", "//", "First"}], ",", 
                 RowBox[{"Id", "[", "d", "]"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], "&"}], ",", "tmp"}], 
           "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", "TensorFormRoutines", " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorFormRoutines", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Needs", "[", "\"\<TensorForms1V6`TensorialForms`\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{"Wedge", " ", "Attributes"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SetAttributes", "[", 
           RowBox[{"Wedge", ",", 
            RowBox[{"{", 
             RowBox[{
             "Flat", ",", "OneIdentity", ",", "Listable", ",", "Protected"}], 
             "}"}]}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"(*", "\[IndentingNewLine]", 
           RowBox[{
           "Simplifies", " ", "Wedge", " ", "expressions", " ", "leaving", 
            " ", "Wedge", " ", "arguement", " ", "in", " ", "canonical", " ", 
            "order", " ", "*", "16", "July2012"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"SimpleWedge", "[", "exp_", "]"}]}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tmp", "=", "exp"}], ",", "tmp0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"tmp0", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tmp0", "=", "tmp"}], ";", "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "/.", 
                 RowBox[{
                  RowBox[{"Wedge", "[", 
                   RowBox[{"a___", ",", 
                    RowBox[{"Wedge", "[", "b__", "]"}], ",", "c___"}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"Wedge", "[", 
                   RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}]}], ";", 
               RowBox[{"(*", 
                RowBox[{"remove", " ", 
                 RowBox[{"Wedge", "[", 
                  RowBox[{"Wedge", "[", "]"}], "]"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "/.", 
                 RowBox[{
                  RowBox[{"Wedge", "[", "a__", "]"}], ":>", 
                  RowBox[{
                   RowBox[{"Signature", "[", 
                    RowBox[{"{", "a", "}"}], "]"}], 
                   RowBox[{"Wedge", "[", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Sequence", ",", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", "a", "}"}], "]"}]}], "]"}], "]"}]}]}]}]}], 
               ";", 
               RowBox[{"(*", 
                RowBox[{"canonical", " ", "ordering"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "remove", " ", "Wedge", " ", "of", " ", "single", " ", 
                 "variable"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "/.", 
                 RowBox[{
                  RowBox[{"Wedge", "[", "a_", "]"}], ":>", 
                  RowBox[{"a", "/;", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Symbol", ",", "Tensor"}], "}"}], ",", 
                    RowBox[{"Head", "[", "a", "]"}]}], "]"}]}]}]}]}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ExpandWedge", "[", "scalar_List", "]"}], "[", "exp_", 
           "]"}], " ", "expands", " ", "Wedge", " ", "product", " ", "exp_", 
          " ", "accounting", " ", "for", " ", 
          RowBox[{"scalar_List", "."}], "  ", "*", "16", "July2012"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"WedgeSimplify", "[", "scalar_List", "]"}], "[", "exp_", 
          "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tmp", "=", "exp"}], ",", "sub", ",", "tmp0", ",", 
             "xtmp"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"tmp0", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tmp0", "=", "tmp"}], ";", "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "/.", 
                 RowBox[{
                  RowBox[{"Wedge", "[", "a__", "]"}], ":>", 
                  RowBox[{"ExpandWedge", "[", 
                   RowBox[{"Wedge", "[", "a", "]"}], "]"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"move", " ", "scalars", " ", "out", " ", "of", " ", 
                 RowBox[{"Wedge", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//.", 
                 RowBox[{
                  RowBox[{"Wedge", "[", " ", 
                   RowBox[{"a___", ",", 
                    RowBox[{"c1_", "  ", "b_"}], ",", "f___"}], "]"}], 
                  "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"c1", " ", 
                    RowBox[{"Wedge", "[", 
                    RowBox[{"a", ",", "b", ",", "f"}], "]"}]}], "/;", 
                   RowBox[{
                    RowBox[{"ListMemberQ", "[", 
                    RowBox[{"c1", ",", "scalar"}], "]"}], "||", 
                    RowBox[{"NumberQ", "[", "c1", "]"}]}]}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//.", 
                 RowBox[{
                  RowBox[{"Wedge", "[", 
                   RowBox[{"a___", ",", "c1_", "  ", ",", "b___"}], "]"}], 
                  "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"c1", " ", 
                    RowBox[{"Wedge", "[", 
                    RowBox[{"a", "  ", ",", "b"}], "]"}]}], "/;", 
                   RowBox[{
                    RowBox[{"ListMemberQ", "[", 
                    RowBox[{"c1", ",", "scalar"}], "]"}], "||", 
                    RowBox[{"NumberQ", "[", "c1", "]"}]}]}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//", "SimpleWedge"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"tmp", "//", "ExpandAll"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
         "ExpandWedge", " ", "from", " ", "ExpandNCM", " ", "example", " ", 
          "*", "16", "July2012"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ExpandWedge", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", ":", "Wedge"}], ")"}], "[", 
           RowBox[{"a___", ",", "b_Plus", ",", "c___"}], "]"}], "]"}], ":=", 
         RowBox[{"Distribute", "[", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "Plus", ",", "h", 
           ",", "Plus", ",", 
           RowBox[{
            RowBox[{"ExpandWedge", "[", 
             RowBox[{"h", "[", "##", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ExpandWedge", "[", "a_", "]"}], ":=", 
         RowBox[{
          RowBox[{"ExpandAll", "[", "a", "]"}], "\[IndentingNewLine]", 
          RowBox[{"(*", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ExteriorDContract", "[", 
               RowBox[{"scalars_List", ",", "constants_List"}], "]"}], "[", 
              "exp_", "]"}], " ", "contracts", " ", 
             RowBox[{"ExteriorD", "[", "a_", "]"}], 
             RowBox[{
              RowBox[{"PartialD", "[", "l_", "]"}], "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], " ", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"ExteriorD", "[", "b", "]"}], " ", "*", "16", 
             "July2012"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Clear", "[", "ExteriorDContract", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ExteriorDContract", "[", "exp_", "]"}], ":=", 
         RowBox[{
          RowBox[{"exp", "//.", 
           RowBox[{
            RowBox[{"HoldPattern", " ", "[", 
             RowBox[{
              RowBox[{"ExteriorD", "[", "a_", "]"}], 
              RowBox[{
               RowBox[{"PartialD", "[", "l_", "]"}], "[", 
               RowBox[{"b_", ",", "a_"}], "]"}]}], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"ExteriorD", "[", "b", "]"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ExteriorDContract", "[", 
               RowBox[{"scalars_List", ",", "constants_List"}], "]"}], "[", 
              "exp_", "]"}]}]}]}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"tmp", "=", "exp"}], ",", "tmp0", ",", "xtmp"}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"tmp0", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp0", "=", "tmp"}], ";", "\[IndentingNewLine]", 
                RowBox[{"tmp", "=", 
                 RowBox[{
                  RowBox[{"WedgeSimplify", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"scalars", ",", "constants"}], "]"}], "]"}], "[", 
                  "tmp", "]"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"Expand", " ", "Wedge", " ", 
                  RowBox[{"ExteriorD", "[", "exp_", "]"}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"tmp", "=", 
                 RowBox[{"tmp", "//", "ExteriorDContract"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{
                 "Contracts", " ", "PartialD", " ", "ExteriorD", " ", 
                  "expressions"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"tmp", "=", 
                 RowBox[{"tmp", "//.", 
                  RowBox[{
                   RowBox[{"ExteriorD", "[", 
                    RowBox[{"c1_", " ", "a__"}], "]"}], "\[RuleDelayed]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Wedge", "[", 
                    RowBox[{
                    RowBox[{"ExteriorD", "[", "c1", "]"}], ",", "a"}], "]"}], 
                    "+", 
                    RowBox[{"c1", " ", 
                    RowBox[{"Wedge", "[", "a", "]"}]}]}], "/;", 
                    RowBox[{"ListMemberQ", "[", 
                    RowBox[{"c1", ",", "scalars"}], "]"}]}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tmp", "=", 
                 RowBox[{"tmp", "/.", 
                  RowBox[{
                   RowBox[{"ExteriorD", "[", "a_", "]"}], "\[RuleDelayed]", 
                   RowBox[{"0", "/;", 
                    RowBox[{"ListMemberQ", "[", 
                    RowBox[{"a", ",", "constants"}], "]"}]}]}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "tmp"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"dDifForm", "[", 
            RowBox[{"scalars_List", ",", "constants_List"}], "]"}], "[", 
           "exp_", "]"}], " ", "computes", " ", "the", " ", "exterior", " ", 
          "derivative", " ", "of", " ", "exp_", " ", "accounting", " ", "for",
           " ", "scalars_List", " ", "and", " ", 
          RowBox[{"constants_List", ".", "  ", "Look"}], " ", "at", " ", 
          "TensorForm", " ", "package", " ", "first", " ", "with", " ", 
          RowBox[{"ExteriorD", "[", "]"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"dDifForm", "[", 
           RowBox[{"scalars_List", ",", "constants_List"}], "]"}], "[", 
          "exp_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{"d", "[", "exp", "]"}]}], ",", "tmp0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"tmp0", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tmp0", "=", "tmp"}], ";", "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{
                 RowBox[{"WedgeSimplify", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"scalars", ",", "constants"}], "]"}], "]"}], "[", 
                 "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//.", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"a_", " ", "b__"}], "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Wedge", "[", 
                    RowBox[{
                    RowBox[{"d", "[", "a", "]"}], ",", "b"}], "]"}], "/;", 
                   RowBox[{"ListMemberQ", "[", 
                    RowBox[{"a", ",", "scalars"}], "]"}]}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//.", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"d", "[", "a__", " ", "]"}], "]"}], "->", 
                  "0"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//", 
                 RowBox[{"\[Delta]Expand", "[", 
                  RowBox[{"d", ",", "constants"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//.", 
                 RowBox[{
                  RowBox[{"d", "[", "a_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"0", "/;", 
                   RowBox[{"ListMemberQ", "[", 
                    RowBox[{"s", ",", "constants"}], "]"}]}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tmp", "=", 
                RowBox[{"tmp", "//.", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"Wedge", "[", 
                    RowBox[{"a_", ",", "b__"}], "]"}], "]"}], 
                  "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Wedge", "[", 
                    RowBox[{
                    RowBox[{"d", "[", "a", "]"}], ",", "b"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"b", "+", "1"}], "}"}], "]"}]}], 
                    RowBox[{"Wedge", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{"d", "[", 
                    RowBox[{"Wedge", "[", "b", "]"}], "]"}]}], 
                    "]"}]}]}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Inserts", " ", "right", " ", "arguement", " ", "into", " ", "operator", 
      " ", "style", " ", "xPartialD", " ", "into", " ", 
      RowBox[{"xPartialD", ".", "\[IndentingNewLine]", 
       RowBox[{"xPartialD", "[", 
        RowBox[{"_", ",", "mu"}], "]"}], ".", "RightArguement"}]}], " ", "->",
      " ", 
     RowBox[{"xPartialD", "[", 
      RowBox[{"RightArugement", ",", "mu"}], "]"}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OperateDotRight", "=", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"c___", " ", 
         RowBox[{"xPartialD", "[", 
          RowBox[{
           RowBox[{"HoldPattern", "[", "_", "]"}], ",", "mu_"}], "]"}]}], ",",
         "b_"}], "]"}], "\[Rule]", 
      RowBox[{"Dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"c", " ", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"b", ",", "mu"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Forms", " ", "dot", " ", "product", " ", "of", " ", "Tensor", " ", "ku_",
      " ", "over", " ", "index", " ", "m_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dot2", "[", 
      RowBox[{"ku_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"ku", ".", 
      RowBox[{
       RowBox[{"LowerIndex", "[", 
        RowBox[{"m", ",", "m"}], "]"}], "[", "ku", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"conversion", " ", "to", " ", "differential", " ", 
     RowBox[{"operator", ".", "  ", 
      RowBox[{"Op", "[", "a", "]"}]}], " ", "indicates", " ", "what", " ", 
     "is", " ", "being", " ", "operated", " ", 
     RowBox[{"on", "."}]}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xsubDif2Op", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xPartialD", "[", 
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ",", "b_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{
          RowBox[{"xPartialD", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"Op", "[", "a", "]"}], "]"}], ",", "b"}], "]"}], ",", 
          "b"}], "]"}], "a"}], "/;", 
       RowBox[{
        RowBox[{"Head", "[", "a", "]"}], "=!=", "Op"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"permutes", " ", "xPartialD", " ", "variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xPartialDPermute", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"xPartialD", "[", 
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"v_", ",", "b"}], "]"}], ",", "a"}], "]"}], "->", 
      RowBox[{"xPartialD", "[", 
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"v", ",", "a"}], "]"}], ",", "b"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Permutes", " ", 
     RowBox[{"IntegralOp", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralOpPermute", "=", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], "->", 
      RowBox[{"IntegralOp", "[", 
       RowBox[{"b", ",", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a", ",", "c"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Print", " ", "routine", " ", "for", " ", "DEBUGing", " ", 
     RowBox[{"Modules", "."}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IfDEBUG", "[", 
      RowBox[{"name_", ",", "DEBUG_", ",", "list_", ",", "comment_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", "==", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "name", ",", "\"\<:\>\"", ",", "comment", ",", "\"\<:\>\"", ",", 
             "list"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Factors", " ", "exp_", " ", "in", " ", "form", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"A_", " ", "B"}], ")"}]}], " ", "into", " ", 
      RowBox[{"1", "/", "A"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "B"}], " ", 
      RowBox[{"form", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FactorABinv", "[", 
      RowBox[{"exp_", ",", "A_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Binv", ",", "B", ",", "tmp", ",", 
         RowBox[{"numer", "=", 
          RowBox[{"Numerator", "[", "exp", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"B", "=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"A", " ", 
             RowBox[{"exp", "/", "numer"}]}], "//", "Simplify"}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", "A"}], "-", 
            RowBox[{"1", "/", "B"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"B", "-", "A"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"numer", " ", "tmp", 
          RowBox[{"(", 
           RowBox[{"B", "-", "A"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Factors", " ", "exp_", " ", "in", " ", "form", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "A"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"1", "/", "B"}], ")"}]}], " ", "into", " ", 
      RowBox[{"1", "/", "A"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "B"}], " ", 
      RowBox[{"form", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FactorDotABinv", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "Binv", ",", "B", ",", "tmp", ",", 
         RowBox[{"numer", "=", 
          RowBox[{"Numerator", "[", "exp", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"1", "/", 
          RowBox[{"First", "[", "exp", "]"}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"B", "=", 
         RowBox[{"1", "/", 
          RowBox[{"Last", "[", "exp", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"B", "-", "A"}], "/.", 
             RowBox[{"Dot", "\[Rule]", "Times"}]}], "//", "Expand"}], "//", 
           "SimplifyTensorSum"}], "//", "UpDownAdjust"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", "A"}], "-", 
            RowBox[{"1", "/", "B"}]}], ")"}], "/", "tmp"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ReplaceVariableNames", 
     RowBox[{"{", "}"}], " ", "replaces", " ", "exp_", " ", "with", " ", 
     "standard", " ", "set", " ", "of", " ", "variables", " ", "of", " ", 
     "form", " ", "S$nnnn", " ", "for", " ", 
     RowBox[{"manipulation", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StandardVariableNames", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "list"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"Dot", "|", "Times", "|", "Plus", "|", "Power"}], "->", 
            "List"}]}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"list", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NumericQ", "[", "#", "]"}]}], "&"}]}], "]"}], "//", 
          "Union"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", "->", 
              RowBox[{"Unique", "[", "S", "]"}]}], "}"}], "&"}], ",", 
           "list"}], "]"}], "//", "Flatten"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ExtractPattern", "[", 
      RowBox[{"exp_", ",", "pattern_"}], "]"}], " ", "extracts", " ", "a", 
     " ", "list", " ", "of", " ", "items", " ", "that", " ", "match", " ", 
     "pattern_", " ", "from", " ", "exp_."}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractPattern", "[", 
      RowBox[{"exp_", ",", "pattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "list"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"exp", ",", "pattern"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"Extract", "[", 
          RowBox[{"exp", ",", "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExtractPattern", "[", "pattern_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "list"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"exp", ",", "pattern"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"Extract", "[", 
          RowBox[{"exp", ",", "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Applies", " ", "function_", " ", "to", " ", "Tensor", " ", "products", 
     " ", "in", " ", "Times", " ", "expression", " ", "exp_."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToTensorProductOnly", "[", 
      RowBox[{"function_", ",", "exp_Times"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "tmpt", ",", "tmpa"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "exp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmpt", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Tensor"}], ",", "#", 
              ",", "1"}], "]"}], "&"}], ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpa", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Tensor"}], ",", "1", 
              ",", "#"}], "]"}], "&"}], ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpt", "=", 
         RowBox[{"function", "[", 
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "tmpt"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpa", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", "tmpa"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmpa", " ", "tmpt"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "returns", " ", "Tensor", " ", "product", " ", "terms", " ", "in", " ", 
     "Times", " ", "expression", " ", "exp_."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorProductOnly", "[", "exp_Times", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "exp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Tensor"}], ",", "#", 
              ",", "1"}], "]"}], "&"}], ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", "tmp"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"returns", " ", "Position"}], "->", 
     RowBox[{"Patterns", " ", "of", " ", "Tensor", " ", "products"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractTensorProducts", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"Tensor", "[", "___", "]"}], ",", "b___"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MapAt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TensorProductOnly", "[", "#", "]"}], "&"}], ",", "#", 
             ",", "2"}], "]"}], "&"}], ",", "tmp"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "apply", " ", "function_", " ", "to", " ", "Tensor", " ", "products", " ",
      "in", " ", "exp_."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToTensorProducts", "[", 
      RowBox[{"function_", ",", "exp_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"Tensor", "[", "___", "]"}], ",", "b___"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MapAt", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ApplyToTensorProductOnly", "[", 
                RowBox[{"function", ",", "#"}], "]"}], "&"}], ",", "#", ",", 
              "2"}], "]"}], "&"}], ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"exp", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ExtractPositionPattern", "[", 
      RowBox[{"exp_", ",", "pattern_"}], "]"}], " ", "extracts", " ", "a", 
     " ", "list", " ", "Position", " ", "and", " ", "items", " ", "that", " ",
      "match", " ", "pattern_", " ", "from", " ", "exp_.", " ", "Returns", 
     " ", "a", " ", 
     RowBox[{"List", "[", " ", 
      RowBox[{
       RowBox[{"pos1", "->", "match1"}], ",", 
       RowBox[{"pos2", "->", "match2"}], ",", "..."}], " ", "]"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractPositionPattern", "[", 
      RowBox[{"exp_", ",", "pattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "list"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"exp", ",", "pattern"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"Extract", "[", 
          RowBox[{"exp", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"pos", ",", "list"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExtractPositionPatterns", "[", 
      RowBox[{"exp_", ",", "pattern_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"exp", ",", "#"}], "]"}], "&"}], ",", "pattern"}], "]"}],
          "//", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExtractPositionPatterns", "[", "pattern_List", "]"}], "[", 
      "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"exp", ",", "#"}], "]"}], "&"}], ",", "pattern"}], "]"}],
          "//", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "ReplaceExtract", " ", "returns", " ", "extract_List", " ", "second", " ",
      "items", " ", "with", " ", "repl_List"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceExtract", "[", 
      RowBox[{"extract_List", ",", "repl_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"First", "[", "#1", "]"}], ",", "#2"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"extract", ",", "repl"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tests", " ", "exp_", " ", "to", " ", "be", " ", "FreeQ", " ", "of", " ", 
     "any", " ", "patterns_."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FreePattern", "[", 
      RowBox[{"exp_", ",", "patterns_List"}], "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"exp", ",", "#"}], "]"}], "&"}], ",", "patterns"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Runs", " ", "Collect", " ", "after", " ", "substituting", " ", "for", 
       " ", "matched", " ", 
       RowBox[{"patterns", ".", "  ", "The"}], " ", "pattern", " ", "may", 
       " ", "be", " ", "of", " ", "form", " ", "P1"}], "|", 
      RowBox[{
       RowBox[{"P2", ".", "  ", "Patterns"}], " ", "involving", " ", "Times", 
       " ", "do", " ", "not", " ", "work"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"e", ".", "g", ".", " ", "pattern_"}], "->", " ", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], 
             RowBox[{"Tensor", "[", 
              RowBox[{"d_", ",", "e_", ",", "f_"}], "]"}], 
             "\[IndentingNewLine]", "One", " ", "way", " ", "around", " ", 
             "it", " ", "is", " ", "to", " ", "use", " ", "substitution", " ", 
             RowBox[{"first", ":", "\[IndentingNewLine]", "sub"}]}]}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], 
             RowBox[{"Tensor", "[", 
              RowBox[{"d_", ",", "e_", ",", "f_"}], "]"}]}], "\[Rule]", 
            RowBox[{"Tensor2", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"subr", "=", 
           RowBox[{"RuleX1", "[", 
            RowBox[{"sub", ",", " ", 
             RowBox[{"Tensor2", "[", "___", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}],
               "}"}]}], "]"}]}], ";"}], " ", "\[LongLeftArrow]", "reverse"}], 
        " ", "substitution", "\[IndentingNewLine]", "tmp"}], "=", 
       RowBox[{"tmp", "/.", " ", "sub"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CollectPattern", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{"Tensor2", "[", "___", "]"}]}], "]"}], "/.", "subr"}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CollectPattern", "[", 
      RowBox[{"exp_", ",", "pattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"exp", ",", "pattern"}], "]"}]}], ",", "tmp", ",", 
         "varlist", ",", "sub", ",", "uvar"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"varlist", "=", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"exp", ",", "pos"}], "]"}], "//", "Union"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uvar", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Unique", "[", "]"}], "&"}], ",", "varlist"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"varlist", ",", "uvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{"tmp", ",", "uvar"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Reverse", "[", "#", "]"}], "&"}], ",", "sub"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extract", " ", "from", " ", 
     RowBox[{"Dot", "[", "]"}], " ", "expression", " ", "elements", " ", 
     "that", " ", "do", " ", "not", " ", "match", " ", "any", " ", "of", " ", 
     "the", " ", 
     RowBox[{"patterns", ".", " ", 
      RowBox[{"Usage", ":", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DotKeepPattern1", "[", "patternlist", "]"}], "[", 
          "expression", "]"}], ".", "  ", "Returns"}], " ", 
        RowBox[{"(", "nokeeps", ")"}], " ", 
        RowBox[{"Dot", "[", " ", "keeps", " ", "]"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DotKeepPattern1", "[", "patterns_", "]"}], "[", "exp_", "]"}], 
     ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "dot", ",", "times", ",", "test", 
         ",", "dots", ",", "pos", ",", 
         RowBox[{"repl", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        StyleBox[
         RowBox[{"DotExpandMode", "[", "False", "]"}],
         FontWeight->"Bold"], 
        StyleBox[";",
         FontWeight->"Bold"], 
        StyleBox["\[IndentingNewLine]",
         FontWeight->"Bold"], 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotKeepPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "exp", "}"}], ",", "\"\<exp\>\""}], "]"}], ";", 
        StyleBox["\[IndentingNewLine]",
         FontWeight->"Bold"], 
        StyleBox[
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"exp", ",", 
            RowBox[{"HoldPattern", "[", 
             RowBox[{"Dot", "[", "__", "]"}], "]"}]}], "]"}]}],
         FontWeight->"Bold"], 
        StyleBox[";",
         FontWeight->"Bold"], 
        StyleBox["\[IndentingNewLine]",
         FontWeight->"Bold"], 
        StyleBox[
         RowBox[{"dots", "=", 
          RowBox[{"Extract", "[", 
           RowBox[{"exp", ",", "pos"}], "]"}]}],
         FontWeight->"Bold"], 
        StyleBox[";",
         FontWeight->"Bold"], 
        StyleBox["\[IndentingNewLine]",
         FontWeight->"Bold"], 
        RowBox[{
         StyleBox["For",
          FontWeight->"Bold"], 
         StyleBox["[",
          FontWeight->"Bold"], 
         RowBox[{
          StyleBox[
           RowBox[{"i", "=", "1"}],
           FontWeight->"Bold"], 
          StyleBox[",",
           FontWeight->"Bold"], 
          RowBox[{
           StyleBox["i",
            FontWeight->"Bold"], 
           StyleBox["\[LessEqual]",
            FontWeight->"Bold"], 
           RowBox[{"Length", "[", "dots", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dot", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"dots", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"IfDEBUG", "[", 
            RowBox[{"\"\<DotKeepPattern\>\"", ",", 
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "tmp"}], "}"}], ",", "\"\<{i,tmp}\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", 
             RowBox[{"Times", "->", "Dot"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "tmp"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"test", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"FreePattern", "[", 
                RowBox[{"#", ",", "patterns"}], "]"}], "&"}], ",", "tmp"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"times", "=", 
            RowBox[{"Pick", "[", 
             RowBox[{"tmp", ",", "test", ",", "True"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"times", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", "times"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dot", "=", 
            RowBox[{"Pick", "[", 
             RowBox[{"tmp", ",", "test", ",", "False"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dot", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "dot", "]"}], ">", "0"}], ",", 
              RowBox[{"Apply", "[", 
               RowBox[{"Dot", ",", "dot"}], "]"}], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"repl", ",", 
             RowBox[{
              RowBox[{"pos", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "->", 
              RowBox[{"(", 
               RowBox[{"times", " ", "dot"}], ")"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"exp", ",", "repl"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Extracts", " ", "terms", " ", "in", " ", "DotExp_", " ", "that", " ", 
      "do", " ", "not", " ", "match", " ", "patterns_", " ", "in", " ", 
      RowBox[{"Dot", "[", "]"}]}], "->", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"no", " ", "match"}], ")"}], " ", 
      RowBox[{
       RowBox[{"Dot", "[", "match", "]"}], ".", "  ", 
       RowBox[{"Doesn", "'"}]}], "t", " ", "work", " ", "for", " ", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"a", " ", "b"}], ",", 
         RowBox[{"n", " ", "m"}]}], "]"}], "."}]}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DotPatternIn", "[", "patterns_", "]"}], "[", "DotExp_", "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "DotExp"}], ",", "test", ",", "times", ",", 
         "dot", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"patterns", ",", "tmp"}], "}"}], ",", "\"\<{tmp}\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", "tmp", "]"}], "//.", 
           RowBox[{
            RowBox[{"Times", "|", "Dot"}], "->", "List"}]}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "2"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"test", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FreePattern", "[", 
             RowBox[{"#", ",", "patterns"}], "]"}], "&"}], ",", "tmp"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "2"}], ",", 
          RowBox[{"{", "test", "}"}], ",", "\"\<{test}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"times", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"tmp", ",", "test", ",", "True"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"times", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", "times"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dot", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"tmp", ",", "test", ",", "False"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dot", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dot", "]"}], ">", "0"}], ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"Dot", ",", "dot"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"times", ",", "dot"}], "}"}], ",", "\"\<{times,dot}\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"times", " ", "dot"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<result\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"4.25", ".10"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DotPatternIn1", "[", "patterns_", "]"}], "[", "DotExp_", "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "DotExp"}], ",", "test", ",", "times", ",", 
         "dot", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"patterns", ",", "tmp"}], "}"}], ",", "\"\<{input}\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", "tmp", "]"}], "//.", 
           RowBox[{
            RowBox[{"Times", "|", "Dot"}], "\[Rule]", "xDot"}]}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "2"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"test", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FreePattern", "[", 
             RowBox[{"#", ",", "patterns"}], "]"}], "&"}], ",", "tmp"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "2"}], ",", 
          RowBox[{"{", "test", "}"}], ",", "\"\<{test}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"times", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"tmp", ",", "test", ",", "True"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"times", "=", 
         RowBox[{"times", "/.", 
          RowBox[{"xDot", "\[Rule]", "Times"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dot", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"tmp", ",", "test", ",", "False"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dot", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dot", "]"}], ">", "0"}], ",", 
           RowBox[{"dot", "/.", 
            RowBox[{"xDot", "\[Rule]", "Dot"}]}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"times", ",", "dot"}], "}"}], ",", "\"\<{times,dot}\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"times", " ", "dot"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<result\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"4.9", ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DotKeepPattern", "[", "patterns_", "]"}], "[", "exp_", "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Extract", " ", "from", " ", 
        RowBox[{"Dot", "[", "]"}], " ", "expression", " ", "elements", " ", 
        "that", " ", "do", " ", "not", " ", "match", " ", "any", " ", "of", 
        " ", "the", " ", 
        RowBox[{"patterns", ".", " ", "\[IndentingNewLine]", 
         RowBox[{"Usage", ":", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DotKeepPattern", "[", "patternlist", "]"}], "[", 
             "expression", "]"}], ".", "\[IndentingNewLine]", "  ", 
            "Returns"}], " ", "expression", " ", "with", " ", 
           RowBox[{
            RowBox[{"Dot", "[", "]"}], "'"}], "s"}]}]}]}], "->", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", "nokeeps", ")"}], " ", 
        RowBox[{
         RowBox[{"Dot", "[", " ", "keeps", " ", "]"}], ".", "  ", "This"}], 
        " ", "is", " ", "a", " ", "frontend", " ", "routine", " ", "expands", 
        " ", 
        RowBox[{"xPartialD", "'"}], "s", " ", "and", " ", "eliminates", " ", 
        "remembering", " ", 
        RowBox[{"HoldPattern", "[", "]"}], " ", "on", " ", 
        RowBox[{
         RowBox[{"Dot", "[", "__", "]"}], "."}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "dot", ",", "times", ",", "test", ",", "dots", ",", "pos",
          ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DotExpandMode", "[", "True", "]"}], ";", 
        StyleBox["\[IndentingNewLine]",
         FontWeight->"Bold"], 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotKeepPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "exp", "}"}], ",", "\"\<input\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{"xPartialDDot", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"pos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"HoldPattern", "[", 
            RowBox[{"Dot", "[", "__", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotKeepPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "pos", "}"}], ",", "\"\<pos\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{
           RowBox[{"DotPatternIn1", "[", "patterns", "]"}], ",", "tmp", ",", 
           "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Apply", " ", "twice", " ", "to", " ", "clean", " ", "up"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"HoldPattern", "[", 
            RowBox[{"Dot", "[", "__", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<DotKeepPattern\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "pos", "}"}], ",", "\"\<pos\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{
           RowBox[{"DotPatternIn1", "[", "patterns", "]"}], ",", "tmp", ",", 
           "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Solves", " ", "for", " ", "pattern_", " ", "in", " ", "EqualExp_"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve4Pattern", "[", 
      RowBox[{"EqualExp_", ",", "pattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "EqualExp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Rule", "->", "Equal"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"pattern", "\[Rule]", "$XX"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"tmp", ",", "$XX"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"$XX", "\[Rule]", "pattern"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Solves", " ", "for", " ", "pattern_", " ", "in", " ", "RuleExp_", " ", 
     "29", "June2012"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Rule4Pattern", "[", 
      RowBox[{"RuleExp_", ",", "pattern_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "RuleExp"}], ",", "patList", ",", "$X"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Rule", "->", "Equal"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"patList", "=", 
         RowBox[{"ExtractPattern", "[", 
          RowBox[{"tmp", ",", "pattern"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", "patList", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"pattern", "\[Rule]", "$X"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"tmp", ",", "$X"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"$X", "\[Rule]", 
           RowBox[{"patList", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MatrixSubs", " ", "applies", " ", "Rules"}], "->", 
     RowBox[{
      RowBox[{
      "sublist_", " ", "to", " ", "matrix", " ", "equation", " ", "where", 
       " ", 
       RowBox[{"Plus", "[", "]"}], " ", "is", " ", 
       RowBox[{"disabled", ".", "  ", "The"}], " ", "auto"}], "-", 
      RowBox[{"evaluation", " ", "of", " ", 
       RowBox[{"Plus", "[", "]"}], " ", "creates", " ", "unwanted", " ", 
       RowBox[{"results", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixSubs", "[", 
      RowBox[{"exp_", ",", "sublist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "i", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Plus", "\[Rule]", "xPlus"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"\"\<MatrixSubs\>\"", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<tmp\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp", "=", " ", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{"tmp", ",", 
             RowBox[{"sublist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "sublist", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"xPlus", "\[Rule]", "Plus"}]}]}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "EvenPowers", " ", "eliminates", " ", "odd", " ", "powers", " ", "of", 
     " ", "var_List", " ", "in", " ", "exp_."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"EvenPowers", "[", "var_List", "]"}], "[", "exp_", "]"}], ":=", 
     
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sub", ",", "tmp", ",", "delete", ",", "n", ",", "V", ",", "L"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"V", ",", "L"}], "}"}], "=", 
         RowBox[{"Unique", "[", 
          RowBox[{"{", 
           RowBox[{"V", ",", "L"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"V", ":", "#"}], ",", 
              RowBox[{"L", " ", "V"}]}], "]"}], "&"}], ",", "var"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"CoefficientList", "[", 
          RowBox[{"tmp", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delete", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{"Length", "[", "tmp", "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"{", "delete", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "IntegralOpDeleteOddPowers", " ", "deletes", " ", "odd", " ", "powers", 
     " ", "of", " ", "var_List", " ", "from", " ", "the", " ", "deepest", " ",
      "level", " ", "IntegralOp", " ", "in", " ", "exp_"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IntegralOpDeleteOddPowers", "[", "var_List", "]"}], "[", 
      "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmpe", ",", "tmpd", ",", "tmpn"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpe", "=", 
         RowBox[{"ExtractIntegrand", "[", "tmp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpd", "=", 
         RowBox[{
          RowBox[{"tmpe", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "//", "Denominator"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmpn", "=", 
         RowBox[{
          RowBox[{"tmpe", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "//", "Numerator"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tmpn", "=", 
         RowBox[{"tmpn", "//", 
          RowBox[{"EvenPowers", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"pu", "[", "_", "]"}], ",", 
             RowBox[{"pd", "[", "_", "]"}]}], " ", "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{
            RowBox[{"tmpe", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "->", 
            RowBox[{"tmpn", "/", "tmpd"}]}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Make", " ", 
      RowBox[{"Rule", "[", "]"}], "s", " ", "from", " ", "a", " ", "2"}], "-", 
     RowBox[{
     "D", " ", "table", " ", "where", " ", "the", " ", "first", " ", "row", 
      " ", "defines", " ", "column", " ", "parameter", " ", "labels", " ", 
      "and", " ", "the", " ", "first", " ", "column", " ", "defines", " ", 
      "variables", " ", "referenced", " ", "by", " ", "var_.", "  ", "The", 
      " ", "result", " ", "is", " ", "a", " ", "set", " ", "of", " ", 
      RowBox[{"Rule", "[", "]"}], "s", " ", "for", " ", "each", " ", "column",
       " ", "parameter", " ", "of", " ", "the", " ", "var_", " ", 
      RowBox[{"specified", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TableRules", "[", "table_", "]"}], "[", "var_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"head", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"tmp", "=", "table"}], ",", "pattern", ",", "row"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pattern", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"_", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "head", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pattern", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "var"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"tmp", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"row", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"tmp", ",", "pattern"}], "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"head", ",", "row"}], "]"}], "]"}], ",", "1"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Adds", " ", "columns", " ", "of", " ", "tablex_", " ", "to", " ", "the", 
     " ", "right", " ", "of", " ", 
     RowBox[{"table", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TableAddColumn", "[", "table_", "]"}], "[", "tablex_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"head", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"tmp", "=", "table"}], ",", "pattern", ",", "row", ",", 
         RowBox[{"mname", "=", "\"\<TableAddColumn\>\""}], ",", 
         RowBox[{"DEBUG", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Join", ",", 
           RowBox[{"{", 
            RowBox[{"tmp", ",", "tablex"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "SubtractRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", 
     "Rules", " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which", 
     " ", "the", " ", "first", " ", "Rule", " ", "minus", " ", "the", " ", 
     "subsequent", " ", "Rules", " ", "for", " ", "the", " ", "right", " ", 
     "and", " ", "left", " ", "Rule", " ", 
     RowBox[{"terms", "."}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SubtractRules", "[", "rules_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", ",", "head", ",", "first", ",", "rest"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"head", "=", 
        RowBox[{"Head", "[", 
         RowBox[{"first", "=", 
          RowBox[{"First", "[", "rules", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rest", "=", 
        RowBox[{"Rest", "[", "rules", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"first", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "first"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"rest", "=", 
        RowBox[{"-", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rest"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "first", "}"}], ",", "rest"}], "}"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Plus", ",", "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Apply", "[", 
        RowBox[{"head", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", "rules"}], "]"}]}], 
      "]"}], "\[Rule]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#", "]"}], "&"}], ",", "rules"}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "AddRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", "Rules", 
      " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which", " ", 
      "is", " ", "a", " ", "sum", " ", "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "sum", " ", "of", " ", 
      "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AddRules", "[", "rules_List", "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], "&"}], ",", "rules"}], "]"}]}], 
       "]"}], "\[Rule]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], "&"}], ",", "rules"}], "]"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "TimesRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", 
      "Rules", " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which",
       " ", "is", " ", "a", " ", "product", " ", "of", " ", "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "product", " ", "of", 
      " ", "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TimesRules", "[", "rules_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Times", ",", "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "DivideRules", " ", "takes", " ", "two", " ", "Rules", " ", "and", " ", 
      "output", " ", "a", " ", "Rule", " ", "which", " ", "is", " ", "a", " ",
       "ratio", " ", "of", " ", "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "ratio", " ", "of", " ", 
      "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DivideRules", "[", "rules_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "/", "#2"}], "&"}], ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "OpRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", "Rules", 
      " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which", " ", 
      "is", " ", "a", " ", "Op", " ", "combination", " ", "of", " ", 
      "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "Op", " ", "combination",
       " ", "of", " ", "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpRules", "[", 
      RowBox[{"rules_List", ",", "operator_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"operator", ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "OpRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", "Rules", 
      " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which", " ", 
      "is", " ", "a", " ", "Op", " ", "combination", " ", "of", " ", 
      "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "Op", " ", "combination",
       " ", "of", " ", "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpRules", "[", 
      RowBox[{"operator_", ",", "rules_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "head"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"Head", "[", 
          RowBox[{"First", "[", "rules", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"operator", ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"head", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Solves", " ", "vars_", " ", "for", " ", "a", " ", "set", " ", "of", " ", 
     "rules_"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SolveRules", "[", 
      RowBox[{"rules_", ",", "vars_"}], "]"}], ":=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rules", "//.", 
         RowBox[{"Rule", "->", "Equal"}]}], ")"}], ",", "vars"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"DifNoDependance", "[", 
       RowBox[{"exp_", ",", "set1_List", ",", "set2_List"}], "]"}], " ", 
      "zeros", " ", 
      RowBox[{"xPartialD", "[", 
       RowBox[{"a", ",", "b"}], "]"}], " ", "if", " ", "a"}], "\[Element]", 
     RowBox[{"set1", " ", "and", " ", "b"}], "\[Element]", 
     RowBox[{"set2", " ", "or", " ", "a"}], "\[Element]", 
     RowBox[{"set2", " ", "and", " ", "b"}], "\[Element]", "set1"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DifNoDependance", "[", 
      RowBox[{"exp_", ",", "set1_List", ",", "set2_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{"0", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"a", ",", "set1"}], "]"}], "&&", 
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"b", ",", "set2"}], "]"}]}], "||", 
              RowBox[{
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"b", ",", "set1"}], "]"}], "&&", 
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"a", ",", "set2"}], "]"}]}]}], "\[IndentingNewLine]", 
             ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xPartialDu", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{"0", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"a", ",", "set1"}], "]"}], "&&", 
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"b", ",", "set2"}], "]"}]}], "||", 
              RowBox[{
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"b", ",", "set1"}], "]"}], "&&", 
               RowBox[{"ListMemberQ", "[", 
                RowBox[{"a", ",", "set2"}], "]"}]}]}], "\[IndentingNewLine]", 
             ")"}]}]}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "that", " ", "lowers", " ", "all", " ", "indices", " ", "in",
      " ", "Tensor", " ", "if", " ", "possible"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sLowerAllIndices", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tensor", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
      RowBox[{"Tensor", "[", 
       RowBox[{"a", ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#2", "===", "Void"}], ",", "Void", ",", "#1"}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "c"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#2", "===", "Void"}], ",", "#1", ",", "#2"}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "that", " ", "raises", " ", "all", " ", "indices", " ", "in",
      " ", "Tensor", " ", "except", " ", "except_List"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sRaiseAllIndices", "[", "except_List", "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Tensor", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
        RowBox[{"Tensor", "[", 
         RowBox[{"a", ",", "\[IndentingNewLine]", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "===", "Void"}], "&&", 
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"except", ",", "#2"}], "]"}]}]}], ",", "#2", ",", 
               "#1"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "c"}], "}"}]}], "]"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "===", "Void"}], "&&", 
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"except", ",", "#2"}], "]"}]}]}], ",", "Void", ",", 
               "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"xPartialDu", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "/;", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"except", ",", "b"}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"xCovariantD", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"xCovariantDu", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "/;", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"except", ",", "b"}], "]"}]}]}]}]}], "\[IndentingNewLine]",
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Lowers", " ", "indices", " ", "in", " ", 
     RowBox[{"Tensor", "'"}], "s", " ", "based", " ", "upon", " ", 
     RowBox[{"index_List", ".", "  ", "Applies"}], " ", "\[Eta]uu", " ", 
     RowBox[{"(", 
      RowBox[{"signature", " ", "factor"}], ")"}], " ", "on", " ", "Tensor", 
     " ", "indices", " ", "that", " ", "are", " ", 
     RowBox[{"lowered", ".", "  ", "\[IndentingNewLine]", 
      RowBox[{"Usage", ":", "  ", 
       RowBox[{
        RowBox[{"LowerIndex\[Eta]", "[", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "i2", ",", "..."}], "}"}], "]"}], "[", 
        "expression", "]"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LowerIndex\[Eta]", "[", "index_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "tmp1", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<LowerIndex\[Eta]\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", "exp"}], "}"}], ",", "\"\<{index,exp}\>\""}],
          "]"}], ";", 
        RowBox[{
         RowBox[{"m", "\[IndentingNewLine]", "tmp"}], "=", 
         RowBox[{"exp", "/.", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"a", ",", "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#2", "===", "Void"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"index", ",", "#1"}], "]"}]}], ",", "Void", ",", 
                   "#1"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "c"}], "}"}]}], "]"}], ",", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#2", "===", "Void"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"index", ",", "#1"}], "]"}]}], ",", "#1", ",", 
                   "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], 
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#2", "===", "Void"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"index", ",", "#1"}], "]"}]}], ",", 
                   RowBox[{"\[Eta]uu", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}], ",", "1"}], "]"}], 
                 "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], "]"}]}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "/.", "fixTensorWithArg"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rule", " ", "version", " ", "of", " ", 
     RowBox[{"LowerIndex\[Eta]", ".", "  ", "Does"}], " ", "not", " ", 
     "fixTensorWithArg"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sLowerIndex\[Eta]", "[", "index_List", "]"}], ":=", 
     RowBox[{
      RowBox[{"Tensor", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"Tensor", "[", 
        RowBox[{"a", ",", "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#2", "===", "Void"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"index", ",", "#1"}], "]"}]}], ",", "Void", ",", 
              "#1"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], "]"}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#2", "===", "Void"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"index", ",", "#1"}], "]"}]}], ",", "#1", ",", "#2"}],
              "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#2", "===", "Void"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"index", ",", "#1"}], "]"}]}], ",", 
              RowBox[{"\[Eta]uu", "[", 
               RowBox[{"#1", ",", "#1"}], "]"}], ",", "1"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "c"}], "}"}]}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "repairs", " ", "notation", " ", "of", " ", "Tensor", " ", "with", " ", 
      "arguements"}], ",", " ", 
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"Au", "[", "i", "]"}]}], ")"}], "[", "x", "]"}]}], "->", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Au", "[", "i", "]"}], "[", "x", "]"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fixTensorWithArg", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a_", " ", 
          RowBox[{"Tensor", "[", 
           RowBox[{"b_", ",", "c_", ",", "d_"}], "]"}]}], ")"}], "[", "e_", 
        "]"}], "->", 
       RowBox[{"a", " ", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"b", ",", "c", ",", "d"}], "]"}], "[", "e", "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Manipulates", " ", "limit", " ", "expression", " ", "into", " ", 
      "integration", " ", "variable", " ", "specification"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "<", "x", "<", "b"}], " ", "&&", " ", 
       RowBox[{"c", "<", "y", "<", "d"}]}], " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "c", ",", "d"}], "}"}]}], "}"}]}]}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Limits2IntRange", "[", "limit_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "limit"}], ",", "tmp1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"LessEqual", "->", "Less"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "multiple", " ", "Alternative", " ", "does", " ", "not", " ", 
          "work"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp1", "=", 
         RowBox[{"ExtractPattern", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"Inequality", "[", 
            RowBox[{"a_", ",", "Less", ",", "b_", ",", "Less", ",", "c_"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], "&"}], ",", "tmp1"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4786102372156887`*^9, 3.478610406934451*^9}, {
   3.478610855969976*^9, 3.478610862686778*^9}, {3.478611015275567*^9, 
   3.4786110171364326`*^9}, {3.47861515646321*^9, 3.478615269127612*^9}, {
   3.478615431381485*^9, 3.478615448610847*^9}, {3.4786155766212807`*^9, 
   3.478615586197624*^9}, {3.4786156329514227`*^9, 3.478615650543906*^9}, {
   3.478796737083694*^9, 3.4787968393353233`*^9}, {3.478796889454749*^9, 
   3.4787969690871677`*^9}, {3.478797335320719*^9, 3.478797348118431*^9}, {
   3.478797712408489*^9, 3.47879778150568*^9}, 3.478797892539719*^9, {
   3.479155592466757*^9, 3.479155643725765*^9}, {3.4792411985097322`*^9, 
   3.479241365005563*^9}, {3.479241483553792*^9, 3.479241495767495*^9}, {
   3.4792416028091927`*^9, 3.47924160346976*^9}, {3.479241645158012*^9, 
   3.479241649242013*^9}, 3.479260522776637*^9, {3.479344814851748*^9, 
   3.479344822349351*^9}, {3.4793920458429937`*^9, 3.47939205723341*^9}, {
   3.479392660327568*^9, 3.479392726987226*^9}, {3.479392784124838*^9, 
   3.479392789938311*^9}, {3.479727584268229*^9, 3.4797276509181843`*^9}, {
   3.4797278368235598`*^9, 3.479727928551259*^9}, {3.479844938707513*^9, 
   3.4798450133361883`*^9}, {3.47984549389117*^9, 3.479845496244192*^9}, 
   3.4798667084285097`*^9, {3.479869384570661*^9, 3.479869532973919*^9}, {
   3.4798695714337873`*^9, 3.479869647324463*^9}, {3.48012280753522*^9, 
   3.480122812080276*^9}, {3.480122876540786*^9, 3.480123023617621*^9}, {
   3.48012320392129*^9, 3.4801232239281807`*^9}, {3.4801235626684647`*^9, 
   3.480123567447248*^9}, {3.480123973291667*^9, 3.4801241161603193`*^9}, {
   3.480124354733694*^9, 3.4801243553962917`*^9}, {3.48012473764014*^9, 
   3.4801247382808228`*^9}, {3.480124845092704*^9, 3.480124855878384*^9}, {
   3.4801249578742533`*^9, 3.4801249597358*^9}, {3.480254183992126*^9, 
   3.4802541862448606`*^9}, {3.480254440921534*^9, 3.480254449476861*^9}, {
   3.480254520273275*^9, 3.480254528325592*^9}, {3.4802545654281*^9, 
   3.480254636849628*^9}, {3.480255093699082*^9, 3.4802550968418427`*^9}, 
   3.480261499894415*^9, {3.480298617728445*^9, 3.480298629578302*^9}, {
   3.480366677542243*^9, 3.480366679903627*^9}, 3.480449793270129*^9, {
   3.4804509385995913`*^9, 3.480450951486458*^9}, {3.480451030574829*^9, 
   3.480451099865816*^9}, {3.4804511472638903`*^9, 3.4804512406334267`*^9}, {
   3.4804512972065077`*^9, 3.480451297778864*^9}, {3.480451420047908*^9, 
   3.480451422833849*^9}, 3.480451476951598*^9, {3.480451533208934*^9, 
   3.480451576753871*^9}, 3.4804516673639927`*^9, {3.48086314479327*^9, 
   3.4808631912864447`*^9}, {3.480863727078332*^9, 3.4808637326435843`*^9}, {
   3.480864580905727*^9, 3.480864590644514*^9}, {3.481161692612461*^9, 
   3.4811616937356462`*^9}, {3.481161786374762*^9, 3.481161844737656*^9}, {
   3.48116187861524*^9, 3.481161887351522*^9}, {3.481162324737865*^9, 
   3.481162325494508*^9}, {3.4811668219011297`*^9, 3.4811668820667543`*^9}, 
   3.481215189056052*^9, {3.4812157714305058`*^9, 3.4812158493130913`*^9}, {
   3.4812159794740133`*^9, 3.4812160026292887`*^9}, {3.481216313037956*^9, 
   3.4812163299869747`*^9}, {3.481216735112289*^9, 3.481216750258905*^9}, {
   3.481217149087227*^9, 3.481217164856399*^9}, {3.4812172000775414`*^9, 
   3.4812172760227222`*^9}, {3.482196362330307*^9, 3.482196510980296*^9}, 
   3.48219836371066*^9, {3.482412040271055*^9, 3.482412076916341*^9}, {
   3.482412112498901*^9, 3.482412140155895*^9}, {3.482412191879125*^9, 
   3.4824121948655443`*^9}, {3.482412350264715*^9, 3.482412354083776*^9}, {
   3.482413542378669*^9, 3.482413554187601*^9}, 3.4824167518167343`*^9, {
   3.482421342300746*^9, 3.4824214197961397`*^9}, {3.482421472697585*^9, 
   3.48242148194658*^9}, {3.4824229719429903`*^9, 3.482423001595422*^9}, {
   3.4824231240385733`*^9, 3.482423124764371*^9}, {3.4824232274978237`*^9, 
   3.48242322817693*^9}, {3.482423343581423*^9, 3.48242334509944*^9}, {
   3.4824233953509693`*^9, 3.482423396814191*^9}, {3.482424391655456*^9, 
   3.4824243943359613`*^9}, {3.482425114539362*^9, 3.482425130369132*^9}, {
   3.482425209230916*^9, 3.482425244442646*^9}, 3.484318600528719*^9, {
   3.4843187114723454`*^9, 3.484318780386221*^9}, {3.484318944154086*^9, 
   3.4843189462914248`*^9}, {3.4843232830315638`*^9, 3.48432328316894*^9}, {
   3.484365432360471*^9, 3.484365580967024*^9}, {3.48440300221239*^9, 
   3.484403060115597*^9}, 3.48440311196926*^9, {3.484403342817935*^9, 
   3.484403406942521*^9}, {3.484405042039632*^9, 3.484405184776244*^9}, {
   3.484487396021353*^9, 3.4844873967614927`*^9}, {3.484487947818367*^9, 
   3.484487949952114*^9}, {3.484489859392941*^9, 3.484489949819316*^9}, {
   3.484588051710988*^9, 3.4845882095741577`*^9}, {3.485023677482976*^9, 
   3.485023882119966*^9}, {3.485023912392026*^9, 3.485023936527218*^9}, {
   3.4851944681890717`*^9, 3.4851944716362333`*^9}, {3.485194526533902*^9, 
   3.485194528908832*^9}, {3.485194892202572*^9, 3.485194927910016*^9}, {
   3.485354038772883*^9, 3.48535405970732*^9}, {3.485570735573872*^9, 
   3.48557083101537*^9}, {3.485571839674246*^9, 3.4855718458365726`*^9}, {
   3.485626063977055*^9, 3.485626082943725*^9}, {3.486424696306481*^9, 
   3.486424697225135*^9}, 3.4864247554217777`*^9, {3.486425000902595*^9, 
   3.486425145486641*^9}, 3.486432399596333*^9, {3.4864330379558773`*^9, 
   3.4864330564341*^9}, {3.486433352225195*^9, 3.4864333741459208`*^9}, 
   3.486472251065795*^9, {3.48647242345576*^9, 3.486472496072131*^9}, {
   3.4864725379002438`*^9, 3.486472609821184*^9}, {3.486492165898141*^9, 
   3.486492169109508*^9}, {3.486694032742361*^9, 3.4866941086494083`*^9}, {
   3.486694163351001*^9, 3.486694163971389*^9}, {3.486744532259694*^9, 
   3.486744558815333*^9}, {3.486818553319242*^9, 3.486818581374219*^9}, {
   3.486818641605287*^9, 3.486818675510168*^9}, {3.4870773280363894`*^9, 
   3.48707733351422*^9}, {3.487097851596468*^9, 3.487098067456719*^9}, 
   3.48709818447042*^9, {3.4875124735580997`*^9, 3.4875125209611588`*^9}, {
   3.48751255447687*^9, 3.487512691957387*^9}, {3.487608785217223*^9, 
   3.487608785958682*^9}, {3.487608867498207*^9, 3.4876088871145363`*^9}, {
   3.487608918615261*^9, 3.4876089701823997`*^9}, {3.4876091332723618`*^9, 
   3.4876091608528233`*^9}, {3.487609195387784*^9, 3.487609195521039*^9}, {
   3.48760931620555*^9, 3.487609340041665*^9}, 3.4876093969563932`*^9, {
   3.48761585357238*^9, 3.487615872455495*^9}, {3.487615939236906*^9, 
   3.487615958559141*^9}, {3.48761672313764*^9, 3.48761675638579*^9}, {
   3.487616786397892*^9, 3.487616819187319*^9}, {3.487616991718307*^9, 
   3.487617009912848*^9}, {3.487617080177371*^9, 3.48761710461699*^9}, {
   3.487617159229903*^9, 3.48761718939327*^9}, 3.487632603442627*^9, {
   3.487632913012683*^9, 3.4876329361166677`*^9}, {3.4876374315334263`*^9, 
   3.4876374320573177`*^9}, {3.4876383630476017`*^9, 3.487638409619794*^9}, {
   3.4876384876794*^9, 3.487638488120678*^9}, {3.488197734586635*^9, 
   3.488197747204503*^9}, {3.488197780887043*^9, 3.488197857696231*^9}, 
   3.4881978956493483`*^9, {3.488197951496665*^9, 3.488198021884431*^9}, {
   3.4881980678206253`*^9, 3.488198122446916*^9}, 3.4881981602372313`*^9, {
   3.488198224512499*^9, 3.488198273446568*^9}, 3.488198399060494*^9, {
   3.488888761915155*^9, 3.488888767488962*^9}, {3.488889094094098*^9, 
   3.488889138776548*^9}, {3.488889184803143*^9, 3.488889214340686*^9}, {
   3.4891582110953608`*^9, 3.489158264453088*^9}, {3.4891583102243032`*^9, 
   3.489158319457137*^9}, {3.489158475189715*^9, 3.489158573211356*^9}, {
   3.489158722120892*^9, 3.489158739735186*^9}, {3.4891589193588867`*^9, 
   3.489158920871798*^9}, {3.489159273094779*^9, 3.489159296827469*^9}, {
   3.489159357852235*^9, 3.489159419332803*^9}, {3.48915974439427*^9, 
   3.489159771315316*^9}, {3.489927197078717*^9, 3.48992742567104*^9}, {
   3.490018126522723*^9, 3.490018271715681*^9}, {3.490018772557356*^9, 
   3.4900188270290728`*^9}, 3.4900312446170893`*^9, {3.490031288296969*^9, 
   3.490031346907186*^9}, {3.490031485761292*^9, 3.4900315942919807`*^9}, {
   3.4900316309091*^9, 3.49003164813223*^9}, 3.4900317319307003`*^9, 
   3.490031830671362*^9, {3.4900318835244703`*^9, 3.490031890950267*^9}, {
   3.490031927974317*^9, 3.490031936614291*^9}, {3.490032683659718*^9, 
   3.4900327557125072`*^9}, {3.490032803608893*^9, 3.490032813144595*^9}, {
   3.490032856470592*^9, 3.490032913220558*^9}, {3.490032953550675*^9, 
   3.4900329736248083`*^9}, 3.490033029409218*^9, {3.490033113894849*^9, 
   3.490033208362678*^9}, {3.490033269071088*^9, 3.4900332718663883`*^9}, {
   3.4900335865101957`*^9, 3.490033607332273*^9}, {3.490035992558507*^9, 
   3.490036071966061*^9}, {3.490190361205695*^9, 3.490190388406308*^9}, {
   3.490283429694734*^9, 3.4902835820735073`*^9}, {3.4902836174686813`*^9, 
   3.490283671177381*^9}, {3.490283729375307*^9, 3.4902837984676533`*^9}, {
   3.490283842068355*^9, 3.490283842597979*^9}, {3.4902840910943108`*^9, 
   3.490284200005829*^9}, {3.4902842373088017`*^9, 3.490284459288745*^9}, {
   3.4902844936087217`*^9, 3.490284505893586*^9}, {3.4902845909349127`*^9, 
   3.490284632556396*^9}, 3.490364423358285*^9, {3.490373078618058*^9, 
   3.490373082140606*^9}, {3.4903846930466757`*^9, 3.490384705085994*^9}, {
   3.49044070130239*^9, 3.4904407156449423`*^9}, {3.490440746162054*^9, 
   3.4904407545773363`*^9}, {3.490441679696218*^9, 3.490441693554639*^9}, {
   3.490701445389049*^9, 3.4907014476642313`*^9}, {3.4908790117581177`*^9, 
   3.490879044268957*^9}, {3.4909901271495237`*^9, 3.490990131413314*^9}, {
   3.490991432055126*^9, 3.490991496248363*^9}, 3.49099154223437*^9, {
   3.490991707911269*^9, 3.4909917087071*^9}, 3.490991758605701*^9, {
   3.490992038779179*^9, 3.4909920621408587`*^9}, {3.4909920959729652`*^9, 
   3.490992096742137*^9}, {3.490992575582806*^9, 3.490992583747328*^9}, {
   3.490992687765245*^9, 3.490992695002722*^9}, {3.490992743159308*^9, 
   3.490992747753585*^9}, {3.4910109015274467`*^9, 3.49101091664802*^9}, {
   3.4910109545688887`*^9, 3.491011193852963*^9}, {3.4910112248368196`*^9, 
   3.491011269863388*^9}, {3.49101142538625*^9, 3.491011425989616*^9}, {
   3.4910116564512577`*^9, 3.4910117539767447`*^9}, {3.491011795347417*^9, 
   3.491011856027932*^9}, {3.491011902740211*^9, 3.491011989380994*^9}, {
   3.491012136896916*^9, 3.4910121560438213`*^9}, {3.491012188717545*^9, 
   3.491012213055629*^9}, {3.491012247387416*^9, 3.49101226751521*^9}, {
   3.491012299084598*^9, 3.491012335329927*^9}, {3.4910124510930967`*^9, 
   3.491012451960444*^9}, {3.491012716014881*^9, 3.4910127280484257`*^9}, 
   3.491340515629616*^9, {3.491345484110201*^9, 3.491345506280718*^9}, {
   3.491345759440847*^9, 3.491345771662321*^9}, {3.49158311467412*^9, 
   3.491583291421167*^9}, 3.491583349256851*^9, {3.491583489414439*^9, 
   3.491583495906961*^9}, {3.491655252502573*^9, 3.491655271740782*^9}, {
   3.491744351883615*^9, 3.4917443527532043`*^9}, 3.4917443957044477`*^9, {
   3.491744519466035*^9, 3.491744570864132*^9}, {3.491744887866613*^9, 
   3.491744897127407*^9}, {3.491744984372656*^9, 3.49174510359024*^9}, {
   3.491745154475388*^9, 3.4917452294721127`*^9}, {3.492433670358795*^9, 
   3.4924336730959883`*^9}, {3.49243377848742*^9, 3.4924338421747932`*^9}, {
   3.492435801928302*^9, 3.4924358381065617`*^9}, {3.492435920874463*^9, 
   3.492435936679744*^9}, {3.492435974004201*^9, 3.492436087684527*^9}, {
   3.492436171841756*^9, 3.4924362035166473`*^9}, {3.492436284120591*^9, 
   3.492436285800323*^9}, {3.492436549760571*^9, 3.492436610755664*^9}, {
   3.492959852610609*^9, 3.492959854569611*^9}, {3.493041538187963*^9, 
   3.4930415764684*^9}, 3.493057169534026*^9, {3.494116862992071*^9, 
   3.494116898218539*^9}, {3.494116975930553*^9, 3.494117063429872*^9}, {
   3.495291079166973*^9, 3.495291080761964*^9}, {3.49529112014008*^9, 
   3.495291211840742*^9}, {3.497195132547572*^9, 3.497195138464801*^9}, {
   3.501171610463068*^9, 3.501171634704878*^9}, {3.5011717070641212`*^9, 
   3.501171722351268*^9}, {3.503862567950595*^9, 3.503862575184511*^9}, {
   3.503862749554532*^9, 3.503862767111421*^9}, {3.503862892863998*^9, 
   3.503862919598208*^9}, {3.5050537734178*^9, 3.5050537795954247`*^9}, {
   3.5057674486212053`*^9, 3.505767554950924*^9}, {3.505828486847911*^9, 
   3.505828532607121*^9}, {3.505829591955325*^9, 3.505829614460332*^9}, {
   3.5058379135470247`*^9, 3.505837915256949*^9}, {3.5058379527357883`*^9, 
   3.505837955419557*^9}, {3.506032191061041*^9, 3.506032291133333*^9}, {
   3.5060324154174767`*^9, 3.506032438218273*^9}, {3.506047966531658*^9, 
   3.5060479967774153`*^9}, {3.506082605388371*^9, 3.5060826124059887`*^9}, 
   3.5060826505223846`*^9, {3.506083891991935*^9, 3.506084016259059*^9}, {
   3.506084352410001*^9, 3.506084364648933*^9}, {3.5060844483340263`*^9, 
   3.5060845008830214`*^9}, {3.5060845329406567`*^9, 3.506084542562902*^9}, {
   3.5060846451202106`*^9, 3.5060846521018248`*^9}, {3.506084705700205*^9, 
   3.506084709361506*^9}, {3.506084743145753*^9, 3.506084760930922*^9}, {
   3.506084945540544*^9, 3.506084953896592*^9}, 3.506085021144985*^9, {
   3.506085122698337*^9, 3.506085128448182*^9}, {3.50608520630322*^9, 
   3.5060853330259438`*^9}, {3.506085436284562*^9, 3.506085447552799*^9}, {
   3.5060855067191763`*^9, 3.506085508225185*^9}, {3.5060855912286987`*^9, 
   3.5060856181755533`*^9}, {3.5060856615420027`*^9, 3.506085663158144*^9}, {
   3.5061021015775433`*^9, 3.506102113922099*^9}, {3.506102913621128*^9, 
   3.506102919992713*^9}, {3.506103024981784*^9, 3.50610302528598*^9}, {
   3.506103143103932*^9, 3.506103144032436*^9}, {3.506103239054166*^9, 
   3.506103240267725*^9}, {3.506103390991555*^9, 3.506103403653122*^9}, {
   3.5061036602239513`*^9, 3.506103690423588*^9}, {3.5061037517852907`*^9, 
   3.506103763253104*^9}, {3.506103823618952*^9, 3.5061038396288147`*^9}, 
   3.506168157585307*^9, {3.5061884904103394`*^9, 3.5061885769124403`*^9}, {
   3.506206720294086*^9, 3.5062067268925858`*^9}, {3.506261779709469*^9, 
   3.506261805254414*^9}, {3.5064343766171618`*^9, 3.506434560942319*^9}, {
   3.506434735220758*^9, 3.506434829419094*^9}, {3.506434860305985*^9, 
   3.506434920124405*^9}, {3.506434977526546*^9, 3.5064350459657307`*^9}, {
   3.506435079399638*^9, 3.506435133046459*^9}, {3.506435274622357*^9, 
   3.506435275514179*^9}, {3.506435314040987*^9, 3.506435387061812*^9}, 
   3.5064359046970167`*^9, {3.5064363448105783`*^9, 3.506436362385597*^9}, {
   3.506436698773597*^9, 3.506436700221006*^9}, {3.506436739350507*^9, 
   3.506436740169915*^9}, {3.506874312063685*^9, 3.5068743980228157`*^9}, {
   3.507047950652614*^9, 3.507047960048657*^9}, 3.507048509573*^9, {
   3.507050545995659*^9, 3.507050551762394*^9}, {3.5070510614084044`*^9, 
   3.507051068288767*^9}, {3.50706462023347*^9, 3.507064637025509*^9}, 
   3.507404606847165*^9, 3.507408280345475*^9, {3.5074083129245863`*^9, 
   3.50740831376236*^9}, 3.50741380080933*^9, 3.5094122286138783`*^9, 
   3.509419096533609*^9, {3.50972204612875*^9, 3.5097221236353188`*^9}, {
   3.50972217510306*^9, 3.509722191257596*^9}, {3.509724137352021*^9, 
   3.509724184941486*^9}, {3.5097242641417*^9, 3.509724343802421*^9}, {
   3.5097245241689243`*^9, 3.5097245648373337`*^9}, {3.509724764809855*^9, 
   3.509724789906074*^9}, {3.509725087876548*^9, 3.509725105187175*^9}, {
   3.50972560494099*^9, 3.5097256794256496`*^9}, {3.5098046922111673`*^9, 
   3.509804697297072*^9}, {3.510578475707192*^9, 3.510578476365436*^9}, {
   3.510580733445777*^9, 3.5105807935841103`*^9}, {3.510581006663415*^9, 
   3.510581190547359*^9}, {3.510627947590703*^9, 3.510627949204385*^9}, {
   3.510669551808805*^9, 3.5106697492313423`*^9}, 3.511274902134137*^9, {
   3.5112749450074787`*^9, 3.511274976523842*^9}, {3.511275072396912*^9, 
   3.511275089129087*^9}, {3.512910303705904*^9, 3.512910320472837*^9}, 
   3.5129971509687653`*^9, {3.5129971861874523`*^9, 3.51299722407197*^9}, {
   3.5134370363177023`*^9, 3.513437137209447*^9}, {3.5136426384188337`*^9, 
   3.5136426613643417`*^9}, {3.514898801564375*^9, 3.514898823958069*^9}, {
   3.5148991526388693`*^9, 3.514899157178446*^9}, {3.514899488612131*^9, 
   3.51489950812823*^9}, {3.514899855536463*^9, 3.514899913380872*^9}, {
   3.514900204965908*^9, 3.514900209315008*^9}, {3.5149004315522957`*^9, 
   3.5149004376995277`*^9}, {3.514901200064176*^9, 3.514901273768056*^9}, {
   3.514901307094572*^9, 3.5149013084305162`*^9}, {3.514901365683806*^9, 
   3.5149013820604258`*^9}, {3.5151613582007837`*^9, 3.515161360427199*^9}, {
   3.515161509359447*^9, 3.515161530858087*^9}, {3.515161573138899*^9, 
   3.5151615759082527`*^9}, {3.515161710501398*^9, 3.515161710979672*^9}, {
   3.515168620878813*^9, 3.515168683176241*^9}, {3.515499033820668*^9, 
   3.515499052182294*^9}, {3.515499131878474*^9, 3.51549913377575*^9}, {
   3.515499189884872*^9, 3.515499191589026*^9}, 3.5154992324115143`*^9, {
   3.515499356548826*^9, 3.515499364397264*^9}, {3.5154994039294786`*^9, 
   3.5154994193285646`*^9}, {3.5154994951231403`*^9, 3.515499500290349*^9}, {
   3.516542182671329*^9, 3.516542183496647*^9}, {3.5182779716476707`*^9, 
   3.518277992085719*^9}, {3.518278035290607*^9, 3.5182781565094643`*^9}, {
   3.518278190243012*^9, 3.518278202251795*^9}, {3.518278350503511*^9, 
   3.518278432955707*^9}, {3.518278472756031*^9, 3.518278479336978*^9}, {
   3.518278511405218*^9, 3.518278557162137*^9}, 3.518278663672791*^9, {
   3.518278701553152*^9, 3.518278703174077*^9}, {3.518278741875976*^9, 
   3.518278755700611*^9}, {3.518278840994277*^9, 3.518278847638773*^9}, {
   3.518278907691203*^9, 3.5182789134009657`*^9}, {3.518279097911199*^9, 
   3.5182791143029013`*^9}, {3.518279365409206*^9, 3.518279366343*^9}, {
   3.519310649462757*^9, 3.5193107521320066`*^9}, {3.520258132865757*^9, 
   3.5202582035268993`*^9}, {3.520258265076558*^9, 3.520258306867817*^9}, {
   3.520258390357552*^9, 3.520258432732916*^9}, {3.5243258198487873`*^9, 
   3.524325859270446*^9}, {3.524325924173465*^9, 3.5243259422745953`*^9}, 
   3.524326046068059*^9, {3.524754202820118*^9, 3.5247542479391327`*^9}, {
   3.524765514630958*^9, 3.524765576352322*^9}, {3.524765643074082*^9, 
   3.524765652964488*^9}, {3.524765722085725*^9, 3.524765811379334*^9}, {
   3.524765879469005*^9, 3.524765931570101*^9}, {3.525792287582165*^9, 
   3.52579229606057*^9}, {3.532197704076823*^9, 3.532197718558428*^9}, {
   3.532197752931507*^9, 3.532197753626295*^9}, {3.535655732644462*^9, 
   3.535655798012876*^9}, {3.53568650894659*^9, 3.535686548759942*^9}, {
   3.535726967002932*^9, 3.535727166537365*^9}, {3.535727324684705*^9, 
   3.535727333108614*^9}, {3.5357276857331343`*^9, 3.5357276898566732`*^9}, {
   3.535942193894785*^9, 3.5359422006577063`*^9}, {3.537196923974163*^9, 
   3.537196930884554*^9}, {3.537196988838977*^9, 3.537196994436515*^9}, {
   3.540173788797316*^9, 3.540173799297715*^9}, {3.541437911003057*^9, 
   3.541437913084115*^9}, {3.54151228921513*^9, 3.541512337633354*^9}, 
   3.541936698449689*^9, {3.5420322276692467`*^9, 3.542032277313403*^9}, {
   3.543321908819312*^9, 3.543321922588873*^9}, {3.547820423773589*^9, 
   3.547820423943359*^9}, {3.54782216462007*^9, 3.547822165497958*^9}, 
   3.5478283342656116`*^9, {3.5478284199569674`*^9, 3.5478284210225487`*^9}, {
   3.547828461521236*^9, 3.547828477375372*^9}, {3.5478288045573177`*^9, 
   3.5478288047718763`*^9}, {3.547866670570098*^9, 3.547866673097927*^9}, {
   3.547868421410634*^9, 3.547868433306251*^9}, {3.547868469733098*^9, 
   3.547868484155079*^9}, {3.547868569644648*^9, 3.54786857879503*^9}, {
   3.5479079077678413`*^9, 3.547907910034872*^9}, {3.549111477297695*^9, 
   3.549111497873914*^9}, {3.549111572759609*^9, 3.5491115927529383`*^9}, {
   3.5496365936208897`*^9, 3.5496366107703*^9}, 3.549888861616987*^9, {
   3.549889749436043*^9, 3.549889790799762*^9}, {3.549891080912258*^9, 
   3.5498910981015577`*^9}, {3.5498911283293667`*^9, 3.549891131394047*^9}, {
   3.5499894049436407`*^9, 3.549989443224435*^9}, {3.55000148860474*^9, 
   3.550001516159936*^9}, {3.550853037189777*^9, 3.550853057195426*^9}, {
   3.550859840743073*^9, 3.550859845893927*^9}, {3.550859881121091*^9, 
   3.550859902510742*^9}, {3.550863950614892*^9, 3.550864008856002*^9}, {
   3.550925530646359*^9, 3.55092556805079*^9}, 3.550974136337838*^9, {
   3.550974621202701*^9, 3.5509746251727333`*^9}, {3.550975372656057*^9, 
   3.550975399161709*^9}, 3.551014668771496*^9, {3.55101475637115*^9, 
   3.551014809942267*^9}, {3.5510159252023067`*^9, 3.5510159498027163`*^9}, {
   3.551112005326097*^9, 3.55111204936761*^9}, {3.551184771986615*^9, 
   3.551184799326428*^9}, {3.551184833974728*^9, 3.5511848415239277`*^9}, {
   3.551184893813675*^9, 3.5511848940267963`*^9}, 3.551407839303104*^9, {
   3.5514137398026123`*^9, 3.551413760771473*^9}, 3.551413819112974*^9, {
   3.5514407003828707`*^9, 3.5514407023464947`*^9}, {3.5514434681764517`*^9, 
   3.5514434943645372`*^9}, {3.551443532366508*^9, 3.551443572905612*^9}, {
   3.551443637954463*^9, 3.551443707126733*^9}, {3.551446349102805*^9, 
   3.551446379014412*^9}, {3.551446447138619*^9, 3.55144648556391*^9}, {
   3.5514468830485277`*^9, 3.551446899833353*^9}, {3.5514470295093527`*^9, 
   3.5514471255259857`*^9}, 3.5514471848359547`*^9, {3.551447233704316*^9, 
   3.5514472796635513`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Tensor", "[", 
    RowBox[{"\[Epsilon]", ",", "a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"Order\[Epsilon]", "[", 
    RowBox[{"Tensor", "[", 
     RowBox[{"\[Epsilon]", ",", "a", ",", "b"}], "]"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.547820375940894*^9, 3.547820378116016*^9}, 
   3.5478256761099863`*^9, 3.547830443857061*^9, {3.5478666777820807`*^9, 
   3.5478666792351303`*^9}, 3.547913473166772*^9, 3.547913615002963*^9, 
   3.5479145701943913`*^9, 3.547914895901795*^9, 3.5480962819157457`*^9, 
   3.548731322799788*^9, 3.54937588262074*^9, {3.5496366192087812`*^9, 
   3.549636620135035*^9}, 3.550974357009796*^9, 3.5509746297037067`*^9, {
   3.551112139362722*^9, 3.5511121403676443`*^9}, 3.551194717306264*^9, 
   3.551413763795445*^9, 3.5514138232491198`*^9}]
}, Open  ]],

Cell["\<\
Transpose, ConjugateTranspose, Dot ExpandMode and simplification routines\
\>", "Text",
 CellChangeTimes->{{3.4782815530805187`*^9, 3.478281587214243*^9}, {
  3.478281681009639*^9, 3.478281689444175*^9}, {3.478543089663787*^9, 
  3.47854310673521*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "Transpose", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", "b", "]"}], ",", 
    RowBox[{"Transpose", "[", "a", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Times", "[", 
    RowBox[{"c_", ",", 
     RowBox[{"Dot", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"c", " ", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "b", "]"}], ",", 
      RowBox[{"Transpose", "[", "a", "]"}]}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"c", ",", "Dot"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Times", "[", 
    RowBox[{"c_", ",", "a_"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"c", " ", 
    RowBox[{"Transpose", "[", "a", "]"}]}], "/;", 
   RowBox[{"NumericQ", "[", "c", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"Transpose", "[", "a_", "]"}], "]"}], ":=", 
  "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"a_", "+", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Transpose", "[", "a", "]"}], "+", 
   RowBox[{"Transpose", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "Transpose", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "ConjugateTranspose", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "b", "]"}], ",", 
    RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", 
   RowBox[{"Times", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"Times", "[", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "b", "]"}], ",", 
    RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", 
   RowBox[{"Times", "[", 
    RowBox[{"c_", ",", 
     RowBox[{"Dot", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "c", "]"}], " ", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "b", "]"}], ",", 
      RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], "]"}]}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"c", ",", "Dot"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", 
   RowBox[{"ConjugateTranspose", "[", "a_", "]"}], "]"}], ":=", 
  "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", 
   RowBox[{"a_", "+", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ConjugateTranspose", "[", "a", "]"}], "+", 
   RowBox[{"ConjugateTranspose", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"Exp", "[", "a_", "]"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{"ConjugateTranspose", "[", "a", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", 
   RowBox[{"Rule", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"Rule", "[", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "a", "]"}], ",", 
    RowBox[{"ConjugateTranspose", "[", "b", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Conjugate", "[", "a", "]"}], "/;", 
   RowBox[{"NumericQ", "[", "a", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "ConjugateTranspose", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Rule", " ", "for", " ", "distributing", " ", "Transpose", " ", "over", 
     " ", "Sums", " ", "and", " ", 
     RowBox[{"Dot", ".", "\[IndentingNewLine]", 
      RowBox[{"Usage", ":", "  ", "exp"}]}]}], "//.", "sTransposeExpand"}], 
   "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sTransposeExpand", ":=", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"a__", "+", "b__"}], "]"}], "->", 
       RowBox[{
        RowBox[{"Transpose", "[", "a", "]"}], "+", 
        RowBox[{"Transpose", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Dot", "[", "a__", "]"}], "]"}], ":>", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Dot", "[", 
          RowBox[{"Reverse", "[", "a", "]"}], "]"}]}], "]"}]}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Rule", " ", "to", " ", "ease", " ", "typing", " ", "of", " ", 
    RowBox[{"ConjugateTranspose", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subDaggerCT", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SuperDagger", "->", "ConjugateTranspose"}], ",", 
      RowBox[{"SuperStar", "->", "Conjugate"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Replaces", " ", 
      RowBox[{"Conjugate", "[", "realVar", "]"}]}], "|", 
     RowBox[{"ConjugateTranspose", "[", "realVar", "]"}]}], "->", 
    RowBox[{
    "realVar", " ", "in", " ", "exp_", " ", "if", " ", "realVar", " ", "is", 
     " ", "MemberQ", " ", "of", " ", "reals_"}]}], "  ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateReals", "[", 
     RowBox[{"exp_", ",", "reals_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"DistributeConjugateCT", "[", "tmp", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"a", "\[Element]", "Reals"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"DistributeConjugateCT", "[", "tmp", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":>", 
          RowBox[{
           RowBox[{"Transpose", "[", "a", "]"}], "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Simplifies", " ", "exp_", " ", "based", " ", "upon", " ", 
    RowBox[{"reals_", " ", ".", "  ", "NEEDS"}], " ", "to", " ", "accept", 
    " ", "patterns", " ", "in", " ", "reals_"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateSimplify", "[", 
     RowBox[{"exp_", ",", "reals_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"DistributeConjugate", "[", "tmp", "]"}], "//.", 
         "simpleDot"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"a", "\[Element]", "Reals"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{
            RowBox[{"ListFreeQ", "[", 
             RowBox[{"a", ",", "reals"}], "]"}], ">", "0"}]}]}]}]}]}]}], 
     RowBox[{"(*", "redundant", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Distributes", " ", "Conjugate", " ", "over", " ", "exp_.", "  ", 
    "Replaces", " ", "and", " ", "expands", " ", 
    RowBox[{
     RowBox[{"DistConjugate", "[", "]"}], "."}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistributeConjugate", "[", "exp_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", 
        RowBox[{"tmp1", "=", "Null"}], ",", "sub"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"a_", "+", "b_"}], "]"}], "->", 
           RowBox[{
            RowBox[{"Conjugate", "[", "a", "]"}], "+", 
            RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"a_", " ", "b_"}], "]"}], "->", 
           RowBox[{
            RowBox[{"Conjugate", "[", "a", "]"}], " ", 
            RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Power", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "->", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", 
             RowBox[{"Conjugate", "[", "b", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"a_", "==", "b_"}], "]"}], "->", 
           RowBox[{
            RowBox[{"Conjugate", "[", "a", "]"}], "==", 
            RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"a_", "->", "b_"}], "]"}], "->", 
           RowBox[{
            RowBox[{"Conjugate", "[", "a", "]"}], "->", 
            RowBox[{"Conjugate", "[", "b", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{"a_", ",", "b__"}], "]"}], "]"}], ":>", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", "b"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"xSum", "[", 
             RowBox[{"a_", ",", "d__"}], "]"}], "]"}], "->", 
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", "d"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Integrate", "[", 
             RowBox[{"a_", ",", "b__List"}], "]"}], "]"}], "->", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", "b"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"IntegralOp", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{"a", ",", 
             RowBox[{"Conjugate", "[", "d", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"xPartialD", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", 
             RowBox[{"Conjugate", "[", "d", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"xPartialDu", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"xPartialDu", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", 
             RowBox[{"Conjugate", "[", "d", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Dot", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "->", 
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], " ", ",", " ", 
             RowBox[{"Conjugate", "[", "b", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Simplifies", " ", "exp_", " ", "based", " ", "upon", " ", 
    RowBox[{"reals_", " ", ".", "  ", "NEEDS"}], " ", "to", " ", "accept", 
    " ", "patterns", " ", "in", " ", "reals_"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateCTSimplify", "[", 
     RowBox[{"exp_", ",", "reals_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"DistributeConjugateCT", "[", "tmp", "]"}], "/.", 
         "simpleDot"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"a", "\[Element]", "Reals"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":>", 
          RowBox[{
           RowBox[{"Transpose", "[", "a", "]"}], "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"a", ",", "reals"}], "]"}], ">", "0"}]}]}]}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{"chnaged", " ", "30", "Sep10", " ", "from", " ", "ListFreeQ"}], 
      "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Simplifies", " ", "exp_", " ", "based", " ", "upon", " ", "reals_", " ", 
    "and", " ", 
    RowBox[{"scalars_", " ", ".", "  ", "NEEDS"}], " ", "to", " ", "accept", 
    " ", "patterns", " ", "in", " ", "reals_"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateCTSimplify", "[", 
     RowBox[{"exp_", ",", "reals_List", ",", "scalars_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"DistributeConjugateCT", "[", "tmp", "]"}], "//.", 
         RowBox[{"simpleDot1", "[", "scalars", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":>", 
          RowBox[{
           RowBox[{"Transpose", "[", "a", "]"}], "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{"simpleTranspose", "[", "scalars", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{"simpleDot1", "[", "scalars", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"a", ",", "reals"}], "]"}], ">", "0"}]}]}]}]}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"changed", " ", "30", "Sep10"}], "*)"}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Simplifies", " ", "exp_", " ", "based", " ", "upon", " ", "reals_", " ", 
    "and", " ", 
    RowBox[{"scalars_", " ", ".", "  ", "NEEDS"}], " ", "to", " ", "accept", 
    " ", "patterns", " ", "in", " ", "reals_"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateCTSimplify", "[", 
     RowBox[{
     "exp_", ",", "reals_List", ",", "scalars_List", ",", "hermitian_List"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Expand", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"DistributeConjugateCT", "[", "tmp", "]"}], "//.", 
         RowBox[{"simpleDot1", "[", "scalars", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":>", 
          RowBox[{
           RowBox[{"Transpose", "[", "a", "]"}], "/;", 
           RowBox[{"ListMemberQ", "[", 
            RowBox[{"a", ",", "reals"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{"simpleTranspose", "[", "scalars", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{"simpleHermitian", "[", "hermitian", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{"simpleDot1", "[", "scalars", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
          RowBox[{"a", "/;", 
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"a", ",", "reals"}], "]"}], ">", "0"}]}]}]}]}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"changed", " ", "3", "May11"}], "*)"}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugateCTSimplify1", "[", "reals_List", "]"}], "[", "exp_", 
   "]"}], ":=", 
  RowBox[{"ConjugateCTSimplify", "[", 
   RowBox[{"exp", ",", "reals"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugateCTSimplify1", "[", 
    RowBox[{"reals_List", ",", "scalars_List"}], "]"}], "[", "exp_", "]"}], ":=", 
  RowBox[{"ConjugateCTSimplify", "[", 
   RowBox[{"exp", ",", "reals", ",", "scalars"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateCTSimplify1", "[", 
     RowBox[{"reals_List", ",", "scalars_List", ",", "hermitian_List"}], 
     "]"}], "[", "exp_", "]"}], ":=", 
   RowBox[{"ConjugateCTSimplify", "[", 
    RowBox[{"exp", ",", "reals", ",", "scalars", ",", "hermitian"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Distributes", " ", "Conjugate", " ", "and", " ", "ConjugateTranspose", 
    " ", "over", " ", "exp_.", " ", "Replaces", " ", "SuperDagger", " ", 
    "with", " ", 
    RowBox[{"ConjugateTranspose", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistributeConjugateCT", "[", "exp_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", 
        RowBox[{"tmp1", "=", "Null"}], ",", "sub"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "//.", "subDaggerCT"}], "/.", 
         RowBox[{"Dot", "->", "xDot"}]}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Dot", " ", "interferes", " ", "with", " ", "Rule", " ", 
         RowBox[{"sometimes", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sub", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Power", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "->", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", 
             RowBox[{"Conjugate", "[", "b", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{"a_", ",", "b__"}], "]"}], "]"}], ":>", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", "b"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"xSum", "[", 
             RowBox[{"a_", ",", "d__"}], "]"}], "]"}], "->", 
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", "d"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"Integrate", "[", 
             RowBox[{"a_", ",", "b__List"}], "]"}], "]"}], "->", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", "a", "]"}], ",", "b"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"IntegralOp", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{"a", ",", 
             RowBox[{"Conjugate", "[", "d", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", "a_", "]"}], ":>", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Conjugate", "[", "#", "]"}], "&"}], ",", "a"}], "]"}],
             "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "List", ",", "Plus", ",", "Equal", ",", "Rule", ",", "Times", 
                ",", "xPartialD", ",", "xPartialDu", ",", "Dot", ",", 
                "xDot"}], "}"}], ",", 
              RowBox[{"Head", "[", "a", "]"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{"a_", ",", "b__"}], "]"}], "]"}], "->", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", "a", "]"}], ",", "b"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"xSum", "[", 
             RowBox[{"a_", ",", "d__"}], "]"}], "]"}], "->", 
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", "a", "]"}], ",", "d"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"IntegralOp", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{"a", ",", 
             RowBox[{"ConjugateTranspose", "[", "d", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"xPartialD", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", "a", "]"}], ",", 
             RowBox[{"Conjugate", "[", "d", "]"}]}], "]"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{"d", " ", "scalar"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"xPartialDu", "[", 
             RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
           RowBox[{"xPartialDu", "[", 
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", "a", "]"}], ",", 
             RowBox[{"Conjugate", "[", "d", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"xDot", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], "]"}], "->", 
           RowBox[{"xDot", "[", 
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", "b", "]"}], " ", ",", " ", 
             RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":>", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ConjugateTranspose", "[", "#", "]"}], "&"}], ",", 
              "a"}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"List", ",", "Plus", ",", "Equal", ",", "Rule"}], 
               "}"}], ",", 
              RowBox[{"Head", "[", "a", "]"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"Conjugate", "[", "a_", "]"}], "]"}], "->", 
           RowBox[{"Transpose", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"ConjugateTranspose", "[", "a_", "]"}], "]"}], "->", 
           RowBox[{"Transpose", "[", "a", "]"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"xPartialD", "[", 
              RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "a", "]"}], ",", "d"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"xPartialDu", "[", 
              RowBox[{"a_", ",", "d_"}], "]"}], "]"}], "->", 
            RowBox[{"xPartialDu", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "a", "]"}], ",", "d"}], "]"}]}]}], 
          "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "//.", "sub"}], "/.", 
         RowBox[{"xDot", "->", "Dot"}]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Rules", " ", "for", " ", "simplifying", " ", "Hermitian", " ", 
    RowBox[{"variables", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simpleHermitian", "[", "hermitian_List", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ":>", 
     RowBox[{"a", "/;", 
      RowBox[{"ListMemberQ", "[", 
       RowBox[{"a", ",", "hermitian"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.474902202988223*^9, 3.474902218781245*^9}, {
   3.474902249452106*^9, 3.474902252358342*^9}, 3.4749022885666847`*^9, {
   3.474904002467537*^9, 3.474904015966226*^9}, {3.474904313637267*^9, 
   3.474904314548793*^9}, {3.4749048751484833`*^9, 3.474904921574607*^9}, {
   3.474904979979472*^9, 3.4749049974963837`*^9}, {3.474905066647118*^9, 
   3.4749050811369257`*^9}, {3.47490523544936*^9, 3.474905236168868*^9}, {
   3.474944627432186*^9, 3.474944639810153*^9}, {3.4749447417941303`*^9, 
   3.474944745533605*^9}, {3.47494480052849*^9, 3.474944888358387*^9}, {
   3.4749449236275597`*^9, 3.4749449266154633`*^9}, {3.4749449876399603`*^9, 
   3.4749450212062597`*^9}, {3.474945424838657*^9, 3.4749454345521097`*^9}, {
   3.474945466141786*^9, 3.474945538456306*^9}, {3.474945628035927*^9, 
   3.4749456296334476`*^9}, {3.474945732962715*^9, 3.474945737890752*^9}, {
   3.4749482603608637`*^9, 3.474948281093103*^9}, {3.4749483840846977`*^9, 
   3.4749483992388697`*^9}, {3.47494875051725*^9, 3.474948803611261*^9}, {
   3.474948884947719*^9, 3.474948931840364*^9}, {3.4749492406201077`*^9, 
   3.47494925331595*^9}, 3.4749494733800087`*^9, {3.4749495113089247`*^9, 
   3.474949513753845*^9}, 3.474949573354327*^9, 3.4749499896837673`*^9, 
   3.474950029369328*^9, {3.474950131732786*^9, 3.474950132368799*^9}, {
   3.474981806402833*^9, 3.474981899327038*^9}, {3.474981930863414*^9, 
   3.4749819526597548`*^9}, {3.474982139741414*^9, 3.474982219964347*^9}, 
   3.4749823960052423`*^9, {3.474982459470777*^9, 3.4749824720743837`*^9}, {
   3.474984800287813*^9, 3.4749848254758472`*^9}, {3.474985004182403*^9, 
   3.4749850117712927`*^9}, {3.474985086786294*^9, 3.474985134182914*^9}, {
   3.474985177061207*^9, 3.4749851963052073`*^9}, {3.4749852770738363`*^9, 
   3.474985279382162*^9}, {3.474985317981666*^9, 3.474985318796495*^9}, {
   3.474985397408358*^9, 3.4749854396534157`*^9}, {3.475036704893425*^9, 
   3.475036731196498*^9}, {3.4750389758328333`*^9, 3.475039012093803*^9}, {
   3.475039049487483*^9, 3.4750390689880657`*^9}, {3.475039105243697*^9, 
   3.475039159964554*^9}, {3.4750392870967073`*^9, 3.475039385368299*^9}, {
   3.475039458528109*^9, 3.475039503603745*^9}, {3.475063508482891*^9, 
   3.475063663796075*^9}, {3.475063695597624*^9, 3.475063763677724*^9}, 
   3.475063796432467*^9, {3.475063970321206*^9, 3.475064036031556*^9}, 
   3.475064099865511*^9, {3.4750641864351683`*^9, 3.475064298812497*^9}, {
   3.475064353035616*^9, 3.4750644186614227`*^9}, {3.475064520693749*^9, 
   3.475064524811913*^9}, {3.475064601896146*^9, 3.475064610046653*^9}, {
   3.475064688899332*^9, 3.4750647411643953`*^9}, {3.47506479413098*^9, 
   3.475064868797393*^9}, {3.475327441006032*^9, 3.475327452271845*^9}, {
   3.475327660591365*^9, 3.475327669398367*^9}, {3.475333293468802*^9, 
   3.47533329498803*^9}, {3.475333430884448*^9, 3.475333507277213*^9}, {
   3.475509439666131*^9, 3.475509440215962*^9}, {3.475808837281938*^9, 
   3.475808862101738*^9}, {3.475808893363825*^9, 3.4758090991040487`*^9}, {
   3.475809285434099*^9, 3.475809308024102*^9}, {3.475809566820257*^9, 
   3.4758095722907352`*^9}, {3.475898672757971*^9, 3.475898765258114*^9}, {
   3.475899848905645*^9, 3.4758998957129507`*^9}, {3.4763897180650787`*^9, 
   3.476389718908877*^9}, {3.476394465322373*^9, 3.476394470317672*^9}, {
   3.476394524776701*^9, 3.476394532918673*^9}, {3.476475121496636*^9, 
   3.476475148939528*^9}, {3.476475180297505*^9, 3.4764752046779013`*^9}, {
   3.476475244590598*^9, 3.4764754125132837`*^9}, {3.476824581316856*^9, 
   3.47682466249527*^9}, {3.476824721532248*^9, 3.476824789474885*^9}, {
   3.47682488084687*^9, 3.476824889776174*^9}, {3.476825118436091*^9, 
   3.476825133069786*^9}, {3.4768251972628813`*^9, 3.476825201005974*^9}, {
   3.476891015110813*^9, 3.4768911658439093`*^9}, {3.47689128459365*^9, 
   3.476891327240355*^9}, {3.4781225088749332`*^9, 3.478122510170926*^9}, {
   3.478281524916589*^9, 3.478281541989093*^9}, {3.478282567922708*^9, 
   3.478282593251577*^9}, {3.478542113886857*^9, 3.478542247165222*^9}, {
   3.478542280901883*^9, 3.478542326541152*^9}, {3.478542564934021*^9, 
   3.4785426055524797`*^9}, {3.478542985795989*^9, 3.478542990425305*^9}, 
   3.478543048125431*^9, {3.478739712963337*^9, 3.478739739292533*^9}, {
   3.478740135179277*^9, 3.478740167554812*^9}, {3.478750737455007*^9, 
   3.478750751132345*^9}, {3.482152394602234*^9, 3.482152549400078*^9}, {
   3.482417280894374*^9, 3.482417313959673*^9}, {3.482417360851695*^9, 
   3.482417400715022*^9}, {3.482417527440649*^9, 3.482417540050824*^9}, {
   3.482419113278393*^9, 3.482419173561716*^9}, {3.482419218393256*^9, 
   3.4824192461395473`*^9}, {3.4824193535031843`*^9, 3.482419355074546*^9}, {
   3.4824196427340384`*^9, 3.4824196663043413`*^9}, {3.482419726452313*^9, 
   3.482419727275962*^9}, {3.482419998541047*^9, 3.4824200127574253`*^9}, {
   3.48242009418847*^9, 3.4824201583681803`*^9}, {3.482422181571136*^9, 
   3.482422200702643*^9}, {3.482422349869032*^9, 3.4824223536512117`*^9}, {
   3.483802724072695*^9, 3.4838027242784557`*^9}, {3.483890609630702*^9, 
   3.483890610606539*^9}, {3.4838906873666773`*^9, 3.4838906894511538`*^9}, {
   3.483890720243185*^9, 3.483890805040807*^9}, {3.4869870593998337`*^9, 
   3.4869870889702587`*^9}, {3.487814331867058*^9, 3.4878146971943293`*^9}, {
   3.48781474540722*^9, 3.487814805428728*^9}, {3.4878148422683783`*^9, 
   3.487814857976061*^9}, {3.4878148986641483`*^9, 3.487814905830181*^9}, {
   3.487814943633572*^9, 3.487815012079419*^9}, {3.487815068726634*^9, 
   3.487815091619801*^9}, {3.4878153476325808`*^9, 3.4878153664660683`*^9}, 
   3.487815528343542*^9, {3.488027676484577*^9, 3.488027726163932*^9}, {
   3.4880278187584467`*^9, 3.4880278318477507`*^9}, {3.488027870865732*^9, 
   3.488027898592762*^9}, {3.488120888801943*^9, 3.488120971614522*^9}, {
   3.488715948540353*^9, 3.488715997501904*^9}, {3.488716194097541*^9, 
   3.488716252638253*^9}, {3.4887162908560953`*^9, 3.4887163774731817`*^9}, {
   3.488716599357139*^9, 3.4887166469443903`*^9}, {3.488716846349348*^9, 
   3.4887168513008213`*^9}, 3.488716917130862*^9, {3.4887272445934553`*^9, 
   3.488727245878105*^9}, {3.489235042492752*^9, 3.489235043496998*^9}, {
   3.489235127021331*^9, 3.4892351510448933`*^9}, {3.4899289331771183`*^9, 
   3.489928964398836*^9}, {3.489929066482153*^9, 3.4899290978225203`*^9}, 
   3.48992915098853*^9, {3.4899292159807997`*^9, 3.4899292233358917`*^9}, {
   3.489929324176581*^9, 3.489929353032815*^9}, {3.489929606806863*^9, 
   3.489929609723671*^9}, {3.490620935398858*^9, 3.490621188005164*^9}, {
   3.490670392069662*^9, 3.490670444142055*^9}, {3.4906705383281937`*^9, 
   3.490670558773653*^9}, {3.490670947683103*^9, 3.4906709553644867`*^9}, {
   3.49070464268841*^9, 3.49070476584444*^9}, {3.4907049192328873`*^9, 
   3.490704947662567*^9}, {3.490988856829043*^9, 3.49098888970508*^9}, {
   3.491341073476224*^9, 3.491341076933086*^9}, 3.491341231947568*^9, {
   3.4915862154421377`*^9, 3.49158621754423*^9}, {3.492432337084391*^9, 
   3.492432446992922*^9}, {3.4924324974597692`*^9, 3.492432508732259*^9}, 
   3.4924325781432257`*^9, 3.492432640109314*^9, {3.492432689293271*^9, 
   3.492432709267672*^9}, {3.494853609452252*^9, 3.4948537103938932`*^9}, {
   3.508791185121291*^9, 3.508791196007641*^9}, {3.509226463984026*^9, 
   3.509226542154163*^9}, {3.509226609649604*^9, 3.509226633234239*^9}, {
   3.5092268432015257`*^9, 3.50922687102273*^9}, 3.5092270235388813`*^9, {
   3.509227060980633*^9, 3.509227061657419*^9}, 3.509227572044039*^9, {
   3.509227849775589*^9, 3.509227851056636*^9}, {3.509228129042069*^9, 
   3.50922819348845*^9}, {3.509228299168318*^9, 3.509228302851684*^9}, {
   3.509229070046472*^9, 3.50922909557236*^9}, {3.509229162530674*^9, 
   3.509229192322863*^9}, {3.509229235662715*^9, 3.5092293073306417`*^9}, {
   3.5092293397890053`*^9, 3.50922935302642*^9}, {3.509229391653954*^9, 
   3.5092294396174097`*^9}, {3.509229489222184*^9, 3.5092295000024633`*^9}, {
   3.5092295350601387`*^9, 3.509229536557579*^9}, {3.511278976606083*^9, 
   3.5112789771634817`*^9}, {3.513014409543192*^9, 3.513014447597735*^9}, {
   3.51308415663741*^9, 3.5130842934579363`*^9}, {3.513428179198797*^9, 
   3.5134283016368027`*^9}, {3.5237181578698072`*^9, 
   3.5237181636449614`*^9}, {3.537196341343886*^9, 3.537196383486946*^9}}],

Cell["Notational and Notebook display definitions.", "Text",
 CellChangeTimes->{{3.475328524687422*^9, 3.475328566517704*^9}, {
  3.4753286023383007`*^9, 3.4753286317238607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"\"\<PR[] annotations:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Imply", "=", "\"\<\\n\[DoubleRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imply", "=", "\"\< \[DoubleRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implyQ", "=", "\"\< ?\[DoubleRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yield", "=", "\"\<\\n\[RightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yield", "=", "\"\< \[LongRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"back", "=", "\"\< \[LongLeftArrow]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"and", "=", "\"\< and \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"CR", "[", "\"\<\[LongLeftArrow]CHECK\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CHECK", "=", 
   RowBox[{"CR", "[", "\"\<\[DoubleLeftArrow]CHECK\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STOP", "=", "\"\<STOP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"POFF", "=", "\"\<POFF\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PON", "=", "\"\<PON\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"New", "=", "\"\<\\n\[FilledSmallCircle] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"next", "=", "\"\<\\n\[FilledDiamond]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"note", "=", 
   RowBox[{"CR", "[", "\"\<\\n\[CloverLeaf]\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NL", "=", "\"\<\\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PR1", "[", "exp___", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmpi", ",", "i", ",", 
        RowBox[{"out", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Tcolor", "=", "Blue"}], ",", 
        RowBox[{"PX", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "tmp", "}"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"tmpi", "=", 
           RowBox[{
            RowBox[{"{", "tmp", "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "tmpi", "]"}], "===", "TCOLOR"}], ",", 
            RowBox[{"{", 
             RowBox[{"Tcolor", "=", 
              RowBox[{"tmpi", "/.", 
               RowBox[{
                RowBox[{"TCOLOR", "[", "a_", "]"}], "\[Rule]", "a"}]}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"tmpi", "===", "\"\<PON\>\""}], ",", 
               RowBox[{"PX", "=", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"tmpi", "===", "\"\<PONdd\>\""}], "&&", 
                   RowBox[{"PX", "===", "0"}]}], ",", 
                  RowBox[{
                   RowBox[{"PX", "=", "1"}], ";", 
                   RowBox[{"tmpi", "=", 
                    RowBox[{"CR", "[", "\"\<\\n.......\>\"", "]"}]}], ";", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "tmpi"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"tmpi", "===", "\"\<POFF\>\""}], ",", 
                    RowBox[{"PX", "=", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"PX", "===", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"tmpi", "===", "\"\<STOP\>\""}], ",", 
                    RowBox[{
                    RowBox[{"i", "=", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "tmp", "}"}], "]"}], "+", "1"}]}], ";", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<STOP\>\"", ",", "Red", ",", "Larger"}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", "tmpi", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"tmpi", ",", "Tcolor", ",", "Larger"}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "tmpi"}], "]"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"Sequence", ",", "out"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Applies", " ", "MatrixForm", " ", "to", " ", "elements", " ", "of", " ", 
     
     RowBox[{
      RowBox[{"Dot", "[", "]"}], ".", "  ", "Usagae"}], " ", "exp"}], "/.", 
    RowBox[{"Dot", "\[RuleDelayed]", "DotMatrixForm"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DotMatrixForm", "[", "a__", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "tmp", "}"}], ",", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"List", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "=!=", "MatrixForm"}], ",", 
             RowBox[{"MatrixForm", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], 
          ",", "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Apply", "[", 
        RowBox[{"Dot", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Applies", " ", "MatrixForm", " ", "to", " ", 
    RowBox[{"List", "[", 
     RowBox[{
      RowBox[{"List", "[", "___", "]"}], "..."}], "]"}], " ", 
    RowBox[{"pattern", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForms", "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lpos", ",", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lpos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"exp", ",", 
          RowBox[{"List", "[", 
           RowBox[{
            RowBox[{"{", "___", "}"}], "..."}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MapAt", "[", 
        RowBox[{"MatrixForm", ",", "exp", ",", "lpos"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColumnSum", "[", "exp_Plus", "]"}], ":=", 
   RowBox[{"Column", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"List", ",", "exp"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColumnSumExp", "[", "exp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"exp", "/.", 
      RowBox[{"Plus", "->", "xPlus"}]}], "/.", 
     RowBox[{
      RowBox[{"xPlus", "[", "a__", "]"}], ":>", 
      RowBox[{"\"\<\[Sum]\>\"", "[", 
       RowBox[{"ColumnSum", "[", 
        RowBox[{"Plus", "[", "a", "]"}], "]"}], "]"}]}]}], "/.", 
    RowBox[{"xPlus", "->", "Plus"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FramedColumn", "[", "items_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "items", "]"}], "===", "List"}], ",", 
     RowBox[{"Framed", "[", 
      RowBox[{"Column", "[", "items", "]"}], "]"}], ",", 
     RowBox[{"Framed", "[", "items", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColumnForms", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lpos", ",", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lpos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"exp", ",", 
         RowBox[{"List", "[", "___", "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Column", ",", "exp", ",", "lpos"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.475328570655633*^9, 3.4753285774188538`*^9}, {
   3.4753300636904793`*^9, 3.475330135116205*^9}, {3.477233895742262*^9, 
   3.4772339399220247`*^9}, {3.478729766020067*^9, 3.478729770834734*^9}, {
   3.47872980629294*^9, 3.47872983712565*^9}, {3.47873438422576*^9, 
   3.478734445391779*^9}, 3.4787345370977*^9, {3.47873463739198*^9, 
   3.47873467436158*^9}, {3.478734730483932*^9, 3.4787349364534607`*^9}, {
   3.4787350482399607`*^9, 3.478735081601348*^9}, {3.4787351538597107`*^9, 
   3.478735160424721*^9}, {3.4787352986214237`*^9, 3.478735308952676*^9}, {
   3.4800759941735992`*^9, 3.4800760233879623`*^9}, {3.480076063368149*^9, 
   3.4800760747555428`*^9}, {3.4800761180727043`*^9, 3.480076141226519*^9}, {
   3.480076190677348*^9, 3.480076218595854*^9}, {3.480076281251539*^9, 
   3.480076325747992*^9}, {3.481763184967868*^9, 3.4817632300389557`*^9}, {
   3.48176543113666*^9, 3.4817654734612722`*^9}, 3.481767654535697*^9, {
   3.481767685882004*^9, 3.481767686222459*^9}, {3.481803605819072*^9, 
   3.481803663844309*^9}, {3.4824609821896772`*^9, 3.482461013016571*^9}, {
   3.482841034952417*^9, 3.4828410619692373`*^9}, {3.4828411156589813`*^9, 
   3.482841144813992*^9}, {3.482841391146286*^9, 3.482841406223794*^9}, {
   3.4828414411092033`*^9, 3.482841441980075*^9}, {3.482841515644906*^9, 
   3.482841569534915*^9}, {3.482841604462352*^9, 3.482841623120454*^9}, {
   3.484050364861733*^9, 3.484050396333696*^9}, {3.484059009232099*^9, 
   3.484059015517432*^9}, {3.4843866883735247`*^9, 3.4843867007234983`*^9}, 
   3.48704202890519*^9, {3.494245566007492*^9, 3.4942455820735683`*^9}, {
   3.494245628315707*^9, 3.494245630524445*^9}, {3.494247383253809*^9, 
   3.494247394191476*^9}, {3.494247462848922*^9, 3.494247467886146*^9}, {
   3.501260495702635*^9, 3.5012604986615677`*^9}, {3.501260582185033*^9, 
   3.501260694014104*^9}, {3.505053823363668*^9, 3.50505384898391*^9}, {
   3.5050538805776987`*^9, 3.505053917882497*^9}, {3.505054262560883*^9, 
   3.50505431112477*^9}, {3.505054372248035*^9, 3.5050543772541323`*^9}, {
   3.5050544336785107`*^9, 3.505054435483047*^9}, {3.505054516536099*^9, 
   3.5050545332954693`*^9}, {3.505054570063496*^9, 3.505054601663795*^9}, {
   3.50505468340886*^9, 3.505054700545114*^9}, {3.505054779533465*^9, 
   3.5050547805915833`*^9}, {3.50505509424123*^9, 3.505055096897439*^9}, {
   3.505055148019641*^9, 3.505055157795885*^9}, {3.505055210099432*^9, 
   3.5050552548137903`*^9}, {3.505055453460677*^9, 3.505055518511758*^9}, {
   3.505055623478874*^9, 3.505055662930497*^9}, {3.505134598844204*^9, 
   3.5051347013105307`*^9}, {3.505224237336009*^9, 3.505224245208104*^9}, {
   3.5245902131149054`*^9, 3.524590300344492*^9}, {3.524590358749851*^9, 
   3.52459035915845*^9}, {3.524590437331218*^9, 3.524590438219252*^9}, 
   3.524590542166341*^9, {3.524590618102206*^9, 3.524590646389022*^9}, {
   3.524590689493154*^9, 3.524590701315659*^9}, {3.52459076368473*^9, 
   3.524590804028916*^9}, {3.524590856955906*^9, 3.5245908767931013`*^9}, {
   3.524757459052862*^9, 3.524757550849388*^9}, {3.5259674199396677`*^9, 
   3.525967435539953*^9}, {3.525967468634207*^9, 3.525967530410571*^9}, {
   3.5259676369289293`*^9, 3.525967642432077*^9}, {3.525967685335023*^9, 
   3.525967685502886*^9}, {3.525967804665818*^9, 3.525967805906081*^9}, 
   3.5348609064464703`*^9, {3.53797244013745*^9, 3.537972458349691*^9}, {
   3.5443547939836473`*^9, 3.544354822608534*^9}, {3.544355112502852*^9, 
   3.544355113253008*^9}, {3.544355209624304*^9, 3.544355270761162*^9}, {
   3.544355710143323*^9, 3.544355717504825*^9}, {3.5443557855601788`*^9, 
   3.544355793568564*^9}, 3.548761386665176*^9}],

Cell[BoxData["\<\"PR[] annotations:\"\>"], "Output",
 CellChangeTimes->{{3.547820376084591*^9, 3.547820378293614*^9}, 
   3.547825676230727*^9, 3.547830443924938*^9, 3.547866677932363*^9, 
   3.547913473323432*^9, 3.547913615149314*^9, 3.547914570316861*^9, 
   3.547914896021854*^9, 3.548096282039773*^9, 3.5487313229299927`*^9, 
   3.549375883044159*^9, 3.5496366193568697`*^9, 3.550974357132517*^9, 
   3.5511121394866343`*^9, 3.551194717424982*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\"\<e[] == unit vector.\>\"", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distributes", " ", "pair", " ", "operator", " ", "op_", " ", "in", " ", 
     "expression", " ", "op_.", 
     RowBox[{"A", ".", "op_"}], " ", "over", " ", "each", " ", "term", " ", 
     "in", " ", "exp_"}], ",", " ", 
    RowBox[{"e", ".", "g", "."}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"op_.", "A", " ", 
      RowBox[{"B", ".", "op_"}]}], "->", 
     RowBox[{"op_.", 
      RowBox[{"A", ".", "op_."}], "op_.", 
      RowBox[{"B", ".", "op_"}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandPairOp", "[", 
     RowBox[{"op_", ",", "exp_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"tmp1", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"{", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Odd", " ", "that"}], " ", "//.", " ", 
               RowBox[{"yields", " ", "different", " ", 
                RowBox[{"results", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"DotExpand", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"op", ",", 
                 RowBox[{"b_", " ", "c_"}], ",", "op"}], "]"}], ":>", 
               RowBox[{
                RowBox[{"Dot", "[", 
                 RowBox[{
                 "op", ",", "b", ",", "op", ",", "op", ",", "c", ",", "op"}], 
                 "]"}], "/;", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"b", ",", "op"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"c", ",", "op"}], "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"op", ",", "b_", ",", "c_", ",", "op"}], "]"}], ":>", 
               
               RowBox[{
                RowBox[{"Dot", "[", 
                 RowBox[{
                 "op", ",", "b", ",", "op", " ", ",", "op", ",", "c", ",", 
                  "op"}], "]"}], "/;", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"b", ",", "op"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"c", ",", "op"}], "]"}]}]}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", "simpleDot"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "DotExpand", " ", "works", " ", "for", " ", "only", " ", "simple", " ", 
     RowBox[{"sums", ".", "  ", "Need"}], " ", "to", " ", "precede", " ", 
     "it", " ", "with", " ", 
     RowBox[{"ExpandAll", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DotExpand", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"b_", "+", "c_"}], ",", "dd___"}], "]"}], "->", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"a", ",", "b", ",", "dd"}], "]"}], "+", 
        RowBox[{"Dot", "[", 
         RowBox[{"a", ",", "c", ",", "dd"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xDot", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"b_", "+", "c_"}], ",", "d___"}], "]"}], "->", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a", ",", "b", ",", "dd"}], "]"}], "+", 
        RowBox[{"xDot", "[", 
         RowBox[{"a", ",", "c", ",", "dd"}], "]"}]}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Keeps", " ", "under", " ", "Dot", " ", "items", " ", "in", " ", 
     RowBox[{"clist", ".", " ", "Usage"}], "  ", "expression"}], "/.", 
    RowBox[{
     RowBox[{"Dot", "[", "a___", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"dotKeep", "[", 
         RowBox[{"{", " ", "keep_list", " ", "}"}], "]"}], "  ", "[", "a", 
        "]"}], ".", "  ", "Returns"}], "  ", "nokeep_list", " ", 
      RowBox[{"Dot", "[", " ", "keep_list", " ", "]"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Newer", " ", 
    RowBox[{"version", ".", " ", "2010.2"}], ".16"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DotKeep1", "[", 
     RowBox[{"clist_", ",", "seq_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "seq"}], ",", "i", ",", "j", ",", "member", ",", 
        RowBox[{"dot", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"times", "=", 
         RowBox[{"{", "1", "}"}]}], ",", "test", ",", 
        RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{"Times", "->", "Dot"}]}], "/.", "simpleDot"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<DotKeep< \>\"", ",", "clist", ",", "\"\< : \>\"", ",", "tmp", 
           ",", "\"\< \>\"", ",", 
           RowBox[{"Length", "[", "tmp", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "tmp", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"test", "=", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "1"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<DotKeep: \>\"", ",", "test", ",", "\"\< : \>\"", ",", 
              "clist"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"member", "=", "False"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"clist", ",", "test"}], "]"}], ",", 
            RowBox[{"member", "=", "True"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "clist", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", " ", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"test", ",", 
                 RowBox[{"clist", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"member", "=", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", " ", 
           RowBox[{"member", ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", " ", 
             RowBox[{"dot", ",", "test"}], "]"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"AppendTo", "[", " ", 
             RowBox[{"times", ",", "test"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "1"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<DotKeep: \>\"", ",", "dot", ",", "times"}], "]"}]}],
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "times", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "times"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dot", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", " ", 
           RowBox[{"Apply", "[", 
            RowBox[{"Dot", ",", "dot"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<DotKeep>> \>\"", ",", "tmp"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaRight", "[", 
    RowBox[{"exp_", ",", "gamma_"}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Moves", " ", "gamma_", " ", "in", " ", 
      RowBox[{"Dot", "[", "]"}], " ", "expression", " ", "to", " ", "the", 
      " ", "right", " ", "until", " ", "the", " ", "end", " ", "or", " ", 
      "the", " ", "term", " ", 
      RowBox[{"disappears", ".", "  ", 
       RowBox[{"Usage", ":", " ", "expression"}]}]}], "/.", 
     RowBox[{
      RowBox[{"Dot", "[", "a__", "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"GammaRight", "[", "a", "]"}], ".", "  ", "Returns"}], " ", 
       "replacement", " ", "for", " ", 
       RowBox[{
        RowBox[{"Dot", "[", "]"}], "."}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "out", ",", "gpos", ",",
        "Ngpos", ",", "igpos", ",", 
       RowBox[{"indu", "=", "Null"}], ",", 
       RowBox[{"indd", "=", "Null"}], ",", "pair", ",", 
       RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DEBUG", ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<GammaRight: \>\"", ",", "tmp", ",", "\"\< : \>\"", ",", 
          "gamma"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"tmp1", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
         RowBox[{"indu", "=", 
          RowBox[{"gamma", "/.", 
           RowBox[{
            RowBox[{"\[Gamma]u", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indd", "=", 
          RowBox[{"gamma", "/.", 
           RowBox[{
            RowBox[{"\[Gamma]d", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"a___", ",", "gamma", ",", "b_", ",", "c___"}], "]"}], ":>", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a", ",", 
               RowBox[{"CommuteG", "[", 
                RowBox[{"gamma", ",", "b"}], "]"}], ",", "c"}], "]"}], "/;", 
             RowBox[{"(", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", "b", "}"}], ",", 
                RowBox[{
                 RowBox[{"\[Gamma]u", "[", "_", "]"}], "||", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"{", "b", "}"}], ",", 
                   RowBox[{"\[Gamma]d", "[", "_", "]"}]}], "]"}]}]}], "]"}], 
              ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Expand", "[", "tmp", "]"}], "/.", "simpleDot"}], "//", 
           "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DEBUG", ">", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<GammaRight>  \>\"", ",", "tmp"}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", "/.", 
           RowBox[{"Dot", "->", "xDot"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", "//.", 
           RowBox[{
            RowBox[{"xDot", "[", "a__", "]"}], ":>", 
            RowBox[{"DotKeep1", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Gamma]d", "[", "_", "]"}], ",", 
                RowBox[{"\[Gamma]u", "[", "_", "]"}]}], "}"}], ",", 
              RowBox[{"{", "a", "}"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{"Expand", "[", "tmp", "]"}], "/.", "simpleDot"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a___", ",", 
                RowBox[{"\[Gamma]d", "[", "b_", "]"}], ",", 
                RowBox[{"\[Gamma]u", "[", "b_", "]"}], ",", "c___"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"dim", "[", "x", "]"}], 
               RowBox[{"Dot", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a___", ",", 
                RowBox[{"\[Gamma]u", "[", "b_", "]"}], ",", 
                RowBox[{"\[Gamma]d", "[", "b_", "]"}], ",", "c___"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"dim", "[", "x", "]"}], " ", 
               RowBox[{"Dot", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DEBUG", ">", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<GammaRight>> \>\"", ",", "tmp"}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GammaRight", "[", 
     RowBox[{"exp_", ",", "gamma_Tensor"}], "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Moves", " ", "gamma", " ", "matrix", " ", "gamma_", " ", "in", " ", 
      "expression", " ", "with", " ", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{",", "gamma_", ",", "\[Gamma]", ",", 
         RowBox[{"\[Gamma]", "..."}]}], "]"}], "'"}], "s", " ", "through", 
      " ", 
      RowBox[{"\[Gamma]", "'"}], "s", " ", "to", " ", "the", " ", "far", " ", 
      "right", " ", "or", " ", "until", " ", "it", " ", 
      RowBox[{"disappears", ".", "  ", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"GammaLeft", "[", 
           RowBox[{"exp_", ",", "gamma_"}], "]"}], ".", "  ", "Returns"}], 
         " ", "exp_", " ", "with", " ", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{",", "gamma_", ",", "..."}], "]"}], "'"}], "s", " ", 
         "replaced", " ", "with", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{",", "gamma_", ","}], "]"}], " ", "where", " ", "gamma_", 
         " ", "is", " ", "moved", " ", "to", " ", "the", " ", 
         RowBox[{"right", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "gammaT", ",", 
        "isgamma", ",", "out", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<GammaRight\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"tmp", ",", "gamma"}], "}"}], ",", "\"\<{tmp,gamma}\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammaT", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "gamma"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"isgamma", "=", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"{", "gamma", "}"}], ",", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"{", "_", "}"}], ",", 
             RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", "1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp1", "=!=", "tmp"}], "&&", "isgamma"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a___", ",", "gamma", ",", "b_", ",", "c___"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a", ",", 
                RowBox[{"CommuteG", "[", 
                 RowBox[{"gamma", ",", "b"}], "]"}], ",", "c"}], "]"}], "/;", 
              
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"{", "b", "}"}], ",", 
                 RowBox[{"Tensor", "[", 
                  RowBox[{"\[Gamma]", ",", 
                   RowBox[{"{", "_", "}"}], ",", 
                   RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", 
               "1"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Expand", "[", "tmp", "]"}], "//.", "DotExpand"}], "//.",
              "simpleDot"}], "//", "Expand"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GammaLeft", "[", 
     RowBox[{"exp_", ",", "gamma_Tensor"}], "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Moves", " ", "gamma", " ", "matrix", " ", "gamma_", " ", "in", " ", 
      "expression", " ", "exp_", " ", "with", " ", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{",", "\[Gamma]", ",", "\[Gamma]", ",", "gamma_", ",", "..."}],
         "]"}], "'"}], "s", " ", "through", " ", 
      RowBox[{"\[Gamma]", "'"}], "s", " ", "to", " ", "the", " ", "far", " ", 
      "left", " ", "or", " ", "until", " ", "it", " ", 
      RowBox[{"disappears", ".", "  ", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"GammaLeft", "[", 
           RowBox[{"exp_", ",", "gamma_"}], "]"}], ".", "  ", "Returns"}], 
         " ", "exp_", " ", "with", " ", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{",", "gamma_", ",", "..."}], "]"}], "'"}], "s", " ", 
         "replaced", " ", "with", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{",", "gamma_", ","}], "]"}], " ", "where", " ", "gamma_", 
         " ", "is", " ", "moved", " ", "to", " ", "the", " ", 
         RowBox[{"left", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "gammaT", ",", 
        "isgamma", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<GammaLeft\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"tmp", ",", "gamma"}], "}"}], ",", "\"\<{tmp,gamma}\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammaT", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "gamma"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"isgamma", "=", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"{", "gamma", "}"}], ",", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"{", "_", "}"}], ",", 
             RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", "1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp1", "=!=", "tmp"}], "&&", "isgamma"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a___", ",", "b_", ",", "gamma", ",", "c___"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a", ",", 
                RowBox[{"CommuteG", "[", 
                 RowBox[{"b", ",", "gamma"}], "]"}], ",", "c"}], "]"}], "/;", 
              
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"{", "b", "}"}], ",", 
                 RowBox[{"Tensor", "[", 
                  RowBox[{"\[Gamma]", ",", 
                   RowBox[{"{", "_", "}"}], ",", 
                   RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", 
               "1"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Expand", "[", "tmp", "]"}], "//.", "DotExpand"}], "//.",
              "simpleDot"}], "//", "Expand"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GammaRight", "[", "gamma_Tensor", "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Moves", " ", "gamma", " ", "matrix", " ", "gamma_", " ", "in", " ", 
      "expression", " ", "exp_", " ", "with", " ", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{",", "gamma_", ",", "\[Gamma]", ",", "\[Gamma]", ",", "..."}],
         "]"}], "'"}], "s", " ", "through", " ", 
      RowBox[{"\[Gamma]", "'"}], "s", " ", "to", " ", "the", " ", "far", " ", 
      "right", " ", "or", " ", "until", " ", "it", " ", 
      RowBox[{"disappears", ".", "  ", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"GammaRight", "[", "gamma_", "]"}], "[", "exp_", "]"}], 
          ".", "  ", "Returns"}], " ", "exp_", " ", "with", " ", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{",", "gamma_", ",", "..."}], "]"}], "'"}], "s", " ", 
         "replaced", " ", "with", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{"...", ",", "gamma_", ","}], "]"}], " ", "where", " ", 
         "gamma_", " ", "is", " ", "moved", " ", "to", " ", "the", " ", 
         "right", " ", "through", " ", "other", " ", 
         RowBox[{"gamma", "'"}], 
         RowBox[{"s", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "gammaT", ",", 
        "isgamma", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<GammaRight\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"tmp", ",", "gamma"}], "}"}], ",", "\"\<{tmp,gamma}\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammaT", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "gamma"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"isgamma", "=", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"{", "gamma", "}"}], ",", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"{", "_", "}"}], ",", 
             RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", "1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp1", "=!=", "tmp"}], "&&", "isgamma"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a___", ",", "gamma", ",", "b_", ",", "c___"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a", ",", 
                RowBox[{"CommuteG", "[", 
                 RowBox[{"gamma", ",", "b"}], "]"}], ",", "c"}], "]"}], "/;", 
              
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"{", "b", "}"}], ",", 
                 RowBox[{"Tensor", "[", 
                  RowBox[{"\[Gamma]", ",", 
                   RowBox[{"{", "_", "}"}], ",", 
                   RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", 
               "1"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Expand", "[", "tmp", "]"}], "//.", "DotExpand"}], "//.",
              "simpleDot"}], "//", "Expand"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GammaLeft", "[", "gamma_Tensor", "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Moves", " ", "gamma", " ", "matrix", " ", "gamma_", " ", "in", " ", 
      "expression", " ", "exp_", " ", "with", " ", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{",", "\[Gamma]", ",", "\[Gamma]", ",", "gamma_", ",", "..."}],
         "]"}], "'"}], "s", " ", "through", " ", 
      RowBox[{"\[Gamma]", "'"}], "s", " ", "to", " ", "the", " ", "far", " ", 
      "left", " ", "or", " ", "until", " ", "it", " ", 
      RowBox[{"disappears", ".", "  ", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"GammaLeft", "[", 
           RowBox[{"exp_", ",", "gamma_"}], "]"}], ".", "  ", "Returns"}], 
         " ", "exp_", " ", "with", " ", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{",", "gamma_", ",", "..."}], "]"}], "'"}], "s", " ", 
         "replaced", " ", "with", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{",", "gamma_", ","}], "]"}], " ", "where", " ", "gamma_", 
         " ", "is", " ", "moved", " ", "to", " ", "the", " ", 
         RowBox[{"left", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "gammaT", ",", 
        "isgamma", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<GammaLeft\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"tmp", ",", "gamma"}], "}"}], ",", "\"\<{tmp,gamma}\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammaT", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "gamma"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"isgamma", "=", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"{", "gamma", "}"}], ",", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"{", "_", "}"}], ",", 
             RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", "1"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp1", "=!=", "tmp"}], "&&", "isgamma"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a___", ",", "b_", ",", "gamma", ",", "c___"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a", ",", 
                RowBox[{"CommuteG", "[", 
                 RowBox[{"b", ",", "gamma"}], "]"}], ",", "c"}], "]"}], "/;", 
              
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"{", "b", "}"}], ",", 
                 RowBox[{"Tensor", "[", 
                  RowBox[{"\[Gamma]", ",", 
                   RowBox[{"{", "_", "}"}], ",", 
                   RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "\[Equal]", 
               "1"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Expand", "[", "tmp", "]"}], "//.", "DotExpand"}], "//.",
              "simpleDot"}], "//", "Expand"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Commutes", " ", "\[Gamma]", " ", "matrices", " ", "g1_"}], ",", 
    " ", "g2_", ",", " ", 
    RowBox[{"Returns", " ", "-", 
     RowBox[{"g2_.", "g1_"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"\[Eta]__", "[", ",", "]"}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CommuteG", "[", 
     RowBox[{"g1_Tensor", ",", "g2_Tensor"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tmp", ",", "g1T", ",", "g2T", ",", "iup", ",", "idown", ",", "is5", 
        ",", "twog", ",", 
        RowBox[{"gtmp", "=", "1"}], ",", "out", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<CommuteG\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"g1", ",", "g2"}], "}"}], ",", "\"\<{g1,g2}\>\""}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"g1T", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "g1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"g2T", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "g2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"iup", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"g1T", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"g2T", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"idown", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"g1T", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"g2T", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"is5", "=", 
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"iup", ",", "idown"}], "}"}], ",", "5"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"iup", ",", "idown"}], "}"}], ",", "\"\<{iup,idown}\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"twog", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"{", "g1", "}"}], ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Gamma]", ",", 
               RowBox[{"{", "_", "}"}], ",", 
               RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}], "+", 
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"{", "g2", "}"}], ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Gamma]", ",", 
               RowBox[{"{", "_", "}"}], ",", 
               RowBox[{"{", "_", "}"}]}], "]"}]}], "]"}]}], ")"}], "\[Equal]",
          "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"!", "twog"}], ",", 
         RowBox[{"out", "=", 
          RowBox[{"g1", ".", "g2"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"not", " ", "2", " ", 
            RowBox[{"\[Gamma]", "'"}], "s", " ", "return"}], "\[Rule]", 
           RowBox[{"no", " ", "change"}]}], " ", "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"twog", "&&", 
          RowBox[{"g1", "===", "g2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"If", "[", 
           RowBox[{"is5", ",", "1", ",", 
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Eta]", ",", "iup", ",", "idown"}], "]"}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", "twog", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gtmp", "=", 
           RowBox[{"If", "[", 
            RowBox[{"is5", ",", "0", ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Eta]", ",", "iup", ",", "idown"}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"out", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"g2", ".", "g1"}]}], "+", 
            RowBox[{"2", "gtmp"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sorts", " ", "Grassmanian", " ", "variables", " ", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], " ", "in", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], " ", "expression"}], ".."}], 
     "\[IndentingNewLine]", 
     RowBox[{"Usage", ":", " ", "exp"}]}], "/.", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"gDotSort", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "."}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GrassmanDotSort", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"order", "=", 
         RowBox[{"Order", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}], ",", 
        RowBox[{"tmp", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"order", "===", "0"}], ",", 
         RowBox[{"order", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Dot", ",", "tmp"}], "]"}], "order"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Dot", " ", "product", " ", "of", " ", "vectors", " ", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], " ", "of", " ", "Grassmanian", " ", 
    RowBox[{"variables", "."}]}], " ", "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GrassmanDot", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmp", ",", "tmpa", ",", "tmpb"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "a", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "b", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "a", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"Dimensions", "[", "b", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmpa", "=", 
          RowBox[{"Flatten", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmpb", "=", 
          RowBox[{"Flatten", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmpa", "=", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Dot", ",", 
             RowBox[{"{", 
              RowBox[{"tmpa", ",", "tmpb"}], "}"}]}], "]"}], "/.", 
           "simpleDot"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmpa", "/.", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"c_", ",", "d_"}], "]"}], ":>", 
            RowBox[{"gDotSort", "[", 
             RowBox[{"c", ",", "d"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"NonCommuting", " ", "2", "D"}], "-", 
     RowBox[{"2", "D", " ", "Matrix", " ", 
      RowBox[{"multiply", ".", "  ", "Outputs"}], " ", "variable", " ", 
      "ordering", " ", "with", " ", "Dot", " ", 
      RowBox[{"function", ".", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", "exp"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"xDot", "[", "a__", "]"}], ":>", 
     RowBox[{"NCxDotMultiply", "[", 
      RowBox[{"xDot", "[", "a", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NCxDotMatrixMultiply", "[", "xdotexp_xDot", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "xdotexp"}], ",", "a", ",", "xD", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<NCxDotMatrixMultiply\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", "tmp", "}"}], ",", "\"\<{xdotexp}\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"xDot", "[", "a__", "]"}], "\[RuleDelayed]", 
          RowBox[{"First", "[", 
           RowBox[{"xDot", "[", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xD", "[", 
                RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", 
              RowBox[{"{", "a", "}"}], ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Dot", ",", "tmp"}], "]"}], "/.", 
          RowBox[{"Times", "\[Rule]", "Dot"}]}], "/.", 
         RowBox[{
          RowBox[{"xD", "[", 
           RowBox[{"_", ",", "a_"}], "]"}], "\[Rule]", "a"}]}], "//.", 
        "simpleDot"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"NonCommuting", " ", "2", "D"}], "-", 
     RowBox[{"2", "D", " ", "Matrix", " ", 
      RowBox[{"multiply", ".", "  ", "Outputs"}], " ", "variable", " ", 
      "ordering", " ", "with", " ", "Dot", " ", 
      RowBox[{"function", ".", "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", "exp"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"xDot", "[", "a__", "]"}], ":>", 
     RowBox[{"NCxDotMultiply1", "[", "a", "]"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NCxDotMatrixMultiply1", "[", "xdotarg__", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "xdotarg"}], ",", "xD", ",", 
        RowBox[{"DEBUG", "=", "0"}], ",", 
        RowBox[{"mname", "=", "\"\<NCxDotMatrixMultiply1\>\""}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"First", "[", 
         RowBox[{"xDot", "[", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xD", "[", 
              RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", 
            RowBox[{"{", "tmp", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IfDEBUG", "[", 
        RowBox[{"mname", ",", 
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Dot", ",", "tmp"}], "]"}], "/.", 
          RowBox[{"Times", "\[Rule]", "Dot"}]}], "/.", 
         RowBox[{
          RowBox[{"xD", "[", 
           RowBox[{"_", ",", "a_"}], "]"}], "\[Rule]", "a"}]}], "//.", 
        "simpleDot"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Example", " ", "of", " ", "routine", " ", "that", " ", "moves", " ", 
    "the", " ", "left", " ", "arguement", " ", "in", " ", "pair_List", " ", 
    "contained", " ", "in", " ", "exp_", " ", "to", " ", "the", " ", "right", 
    " ", "until", " ", "they", " ", "are", " ", "adjacent", " ", 
    "alternating", " ", "arguement", " ", "pairs", " ", "each", " ", 
    RowBox[{"tranposition", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MovePairRight", "[", "pair_List", "]"}], "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tmp", "=", "exp"}], ",", 
      RowBox[{"tmpv", "=", "pair"}], ",", "tmpx1", ",", "x1", ",", "x2", ",", 
      "tmpp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tmpp", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"tmp", ",", 
            RowBox[{"Apply", "[", 
             RowBox[{"Alternatives", ",", "tmpv"}], "]"}]}], "]"}]}], ";", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "=", 
             RowBox[{"tmpp", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"x1", "=", 
             RowBox[{"tmpp", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}], ">", "1"}]}],
         ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpx1", "=", 
         RowBox[{"Extract", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"{", "x1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tmpx1", " ", "===", " ", 
           RowBox[{"tmpv", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"tmpx1", "=", 
           RowBox[{"tmpv", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"tmpx1", " ", "===", " ", 
             RowBox[{"tmpv", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"tmpx1", "=", 
             RowBox[{"tmpv", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Permute", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"Cycles", "[", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"x1", ",", 
               RowBox[{"x1", "+", "1"}]}], "}"}], "}"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", "+", "1"}], "}"}], "\[Rule]", "tmpx1"}]}], "]"}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "tmp"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4753465512080317`*^9, 3.475346554216423*^9}, {
   3.4753465856310472`*^9, 3.475346621892208*^9}, {3.475346668954856*^9, 
   3.475346669176675*^9}, 3.4753472519988728`*^9, {3.47534729491439*^9, 
   3.475347364623801*^9}, {3.475347396784602*^9, 3.475347433158287*^9}, {
   3.475347707841419*^9, 3.4753477082870207`*^9}, {3.475347742903981*^9, 
   3.47534782387926*^9}, {3.47534995783218*^9, 3.475350031994712*^9}, {
   3.4753500711048393`*^9, 3.475350144816533*^9}, {3.475350306389287*^9, 
   3.475350469087633*^9}, {3.475350555524749*^9, 3.475350592362454*^9}, {
   3.475350664898057*^9, 3.475350678053525*^9}, {3.475350903184366*^9, 
   3.475351003725884*^9}, {3.475351129605673*^9, 3.475351138071467*^9}, {
   3.475351175685073*^9, 3.4753511898701973`*^9}, {3.47535123151435*^9, 
   3.475351283995439*^9}, 3.4753515093495703`*^9, {3.475351800064806*^9, 
   3.47535202418405*^9}, {3.4753520668621473`*^9, 3.475352101918038*^9}, {
   3.475352334938896*^9, 3.475352518664269*^9}, {3.4753526273365793`*^9, 
   3.475352638287677*^9}, {3.4753526763962107`*^9, 3.4753527344462423`*^9}, {
   3.4753532423985577`*^9, 3.4753533212858763`*^9}, {3.475353406296814*^9, 
   3.4753534133791113`*^9}, {3.475353445171694*^9, 3.475353495856761*^9}, {
   3.475353531133277*^9, 3.475353603671583*^9}, {3.4753536352110443`*^9, 
   3.4753537615539017`*^9}, {3.475353889894141*^9, 3.475353892904949*^9}, {
   3.475353925167573*^9, 3.475354009927945*^9}, {3.475354100114399*^9, 
   3.4753541861843777`*^9}, {3.4753542428876057`*^9, 
   3.4753542749926147`*^9}, {3.4753543800384398`*^9, 
   3.4753544018476553`*^9}, {3.475354447158379*^9, 3.475354556825355*^9}, {
   3.475354634416751*^9, 3.475354813540646*^9}, {3.475354849353096*^9, 
   3.475354939979602*^9}, {3.4753559748272963`*^9, 3.475355982165483*^9}, {
   3.475356015326829*^9, 3.475356021349093*^9}, {3.475356149335154*^9, 
   3.475356149895138*^9}, {3.475356229732254*^9, 3.475356262661701*^9}, {
   3.4753563072548723`*^9, 3.4753563320771217`*^9}, {3.475356390458597*^9, 
   3.4753564309393578`*^9}, {3.475363035922538*^9, 3.475363213595894*^9}, {
   3.475363268345435*^9, 3.4753632972633677`*^9}, {3.4753633348269463`*^9, 
   3.475363348724815*^9}, {3.47536340700237*^9, 3.4753635806026793`*^9}, {
   3.475363612311414*^9, 3.475363873918358*^9}, {3.475363907884944*^9, 
   3.475363908841063*^9}, 3.47536397787424*^9, {3.475364009757326*^9, 
   3.4753640104061213`*^9}, {3.475364098991889*^9, 3.4753641452072897`*^9}, 
   3.475365260018832*^9, {3.475365658093651*^9, 3.475365949439968*^9}, {
   3.475366004856884*^9, 3.475366141720459*^9}, {3.475386134303418*^9, 
   3.475386209962783*^9}, {3.475386245836129*^9, 3.475386246680723*^9}, {
   3.4754150378389397`*^9, 3.475415096118135*^9}, {3.475415157576167*^9, 
   3.475415217406499*^9}, {3.475415313529755*^9, 3.475415329065259*^9}, {
   3.475415369736064*^9, 3.475415392087422*^9}, {3.475415428487733*^9, 
   3.475415455526229*^9}, {3.4754155177665157`*^9, 3.47541555046257*^9}, {
   3.475415638800124*^9, 3.475415752192183*^9}, {3.475415833030077*^9, 
   3.475415859154005*^9}, {3.475415895199882*^9, 3.4754159829568787`*^9}, {
   3.475416026886198*^9, 3.4754160720239162`*^9}, {3.4754161045871563`*^9, 
   3.4754161132979307`*^9}, {3.4754161650223627`*^9, 
   3.4754161757824707`*^9}, {3.475416231473404*^9, 3.475416278242137*^9}, {
   3.4754164023376427`*^9, 3.475416444314909*^9}, {3.475416561506901*^9, 
   3.4754165673771563`*^9}, {3.475416602785972*^9, 3.4754166290160933`*^9}, 
   3.4754166717953243`*^9, {3.475416705559785*^9, 3.475416747608629*^9}, {
   3.475416816396978*^9, 3.475416915215006*^9}, {3.475416984662531*^9, 
   3.475417003617631*^9}, {3.4754170402279987`*^9, 3.47541710720545*^9}, {
   3.475417142413661*^9, 3.475417158996089*^9}, {3.475417195402669*^9, 
   3.47541737468452*^9}, {3.4754467153526783`*^9, 3.4754468188230543`*^9}, {
   3.4754468546907167`*^9, 3.475446888727203*^9}, {3.475446941267878*^9, 
   3.475447008401469*^9}, {3.475447677175087*^9, 3.4754477446712933`*^9}, {
   3.475447988883189*^9, 3.475448026703464*^9}, {3.475448073077318*^9, 
   3.475448154432979*^9}, {3.475448221802416*^9, 3.4754483776065073`*^9}, {
   3.475448408722733*^9, 3.475448520042667*^9}, {3.475448952085341*^9, 
   3.475449087137871*^9}, {3.475449148314666*^9, 3.475449279585099*^9}, {
   3.475449324875442*^9, 3.475449457419395*^9}, {3.475449514698174*^9, 
   3.47544952148781*^9}, {3.475454675464456*^9, 3.475454773317904*^9}, {
   3.4754548897474947`*^9, 3.475454910894479*^9}, {3.475455008155828*^9, 
   3.475455015700056*^9}, {3.4754550631255693`*^9, 3.4754552253892717`*^9}, {
   3.475455274141914*^9, 3.4754553161379137`*^9}, {3.47545535425865*^9, 
   3.475455391838245*^9}, {3.475455433822481*^9, 3.475455443877643*^9}, {
   3.4754555096904287`*^9, 3.4754555271290817`*^9}, {3.475455696776729*^9, 
   3.4754557242910967`*^9}, {3.475455776970767*^9, 3.475455801624564*^9}, {
   3.475456198217016*^9, 3.475456202459544*^9}, {3.4754596079949102`*^9, 
   3.475459614311833*^9}, {3.475460047477614*^9, 3.4754600586481457`*^9}, {
   3.475461589826283*^9, 3.475461633882329*^9}, {3.475463374251835*^9, 
   3.4754633775024652`*^9}, {3.4754634954651003`*^9, 3.475463499979669*^9}, {
   3.475463914208621*^9, 3.475463914703012*^9}, {3.4754640703486233`*^9, 
   3.475464071152954*^9}, {3.475464596822629*^9, 3.475464598482012*^9}, {
   3.475467628195072*^9, 3.475467632883882*^9}, 3.475467808401226*^9, {
   3.475467854837569*^9, 3.475467858367579*^9}, {3.475467919966097*^9, 
   3.475467925229865*^9}, {3.4754680977570057`*^9, 3.475468104197669*^9}, {
   3.4754682504201508`*^9, 3.475468283668222*^9}, {3.4754683782786703`*^9, 
   3.4754683801489277`*^9}, {3.475468571023386*^9, 3.4754686213372593`*^9}, {
   3.475469546102528*^9, 3.475469546324548*^9}, {3.475469719124421*^9, 
   3.4754697193239326`*^9}, {3.475470307205607*^9, 3.4754703409426527`*^9}, {
   3.4754704009210978`*^9, 3.475470410527676*^9}, {3.4754704930047617`*^9, 
   3.47547051961092*^9}, {3.475470640915954*^9, 3.475470652022987*^9}, {
   3.475470779667163*^9, 3.475470809595195*^9}, {3.475470905598742*^9, 
   3.4754709172555323`*^9}, 3.4754710310452337`*^9, {3.4754710780841217`*^9, 
   3.475471078857292*^9}, {3.4754712077509108`*^9, 3.475471263098508*^9}, {
   3.475471294762836*^9, 3.475471295757835*^9}, 3.4754972971370487`*^9, {
   3.475497343571782*^9, 3.475497344874321*^9}, {3.4754974778517103`*^9, 
   3.4754975094158*^9}, {3.475497551224495*^9, 3.475497769366085*^9}, {
   3.4754978068464727`*^9, 3.475497839446032*^9}, 3.47549797887855*^9, 
   3.475498054452549*^9, {3.475498084682022*^9, 3.4754980893247747`*^9}, {
   3.4754982136296597`*^9, 3.4754982342978067`*^9}, {3.4754983037423697`*^9, 
   3.475498308983923*^9}, {3.4754984296141872`*^9, 3.475498440353137*^9}, {
   3.475498597400405*^9, 3.475498612116949*^9}, {3.47549870525282*^9, 
   3.475498706324493*^9}, {3.4754987397203608`*^9, 3.4754987411779337`*^9}, {
   3.475498900664324*^9, 3.475498905158126*^9}, {3.47550126640407*^9, 
   3.475501289509036*^9}, {3.475501386244501*^9, 3.475501422686417*^9}, {
   3.475501630329604*^9, 3.475501630925071*^9}, 3.475501701107646*^9, {
   3.4755027499069347`*^9, 3.475502922633955*^9}, {3.475502990083099*^9, 
   3.475503007384081*^9}, {3.4755030392540007`*^9, 3.4755031134276743`*^9}, {
   3.475503231196392*^9, 3.475503245004574*^9}, {3.475503280972286*^9, 
   3.475503282110127*^9}, {3.475503315021574*^9, 3.4755033351620502`*^9}, {
   3.475503410412566*^9, 3.475503423605751*^9}, {3.475503481841188*^9, 
   3.47550348527631*^9}, {3.4755036378160677`*^9, 3.475503645979293*^9}, {
   3.4755066129313498`*^9, 3.475506616377406*^9}, {3.475506662154272*^9, 
   3.475506692827354*^9}, {3.4755067232601843`*^9, 3.4755067470820427`*^9}, {
   3.475507691267541*^9, 3.4755076920022306`*^9}, {3.475507726178258*^9, 
   3.475507733766214*^9}, {3.475507787475226*^9, 3.4755077900377274`*^9}, {
   3.475507898099065*^9, 3.4755078989424667`*^9}, {3.475507965542246*^9, 
   3.4755079749700737`*^9}, {3.475508235497374*^9, 3.475508339879795*^9}, {
   3.475508417873733*^9, 3.4755084203725367`*^9}, {3.4755084999812613`*^9, 
   3.475508510309757*^9}, {3.475508543979864*^9, 3.475508663519725*^9}, {
   3.475508743636683*^9, 3.47550874729813*^9}, {3.4755089889734573`*^9, 
   3.475509004736499*^9}, {3.475509276776189*^9, 3.475509278491297*^9}, {
   3.475509349761141*^9, 3.475509426075082*^9}, {3.475509475983533*^9, 
   3.4755094775681067`*^9}, {3.475509590460648*^9, 3.475509594347418*^9}, {
   3.4755097835784197`*^9, 3.4755098221523542`*^9}, {3.475509897357624*^9, 
   3.4755099129388742`*^9}, {3.475509977557598*^9, 3.4755100565937757`*^9}, {
   3.475510089814702*^9, 3.4755101474737387`*^9}, {3.475510185736668*^9, 
   3.475510185914915*^9}, {3.4755102695572987`*^9, 3.475510277308406*^9}, {
   3.4755103404479303`*^9, 3.475510344444532*^9}, {3.47551056021583*^9, 
   3.4755106340488863`*^9}, {3.475510726204956*^9, 3.475510743836422*^9}, {
   3.475510792277956*^9, 3.475510792960672*^9}, {3.475510852256757*^9, 
   3.475510884828628*^9}, {3.475510917380827*^9, 3.475510923956871*^9}, {
   3.475510957325715*^9, 3.475510962290093*^9}, {3.4755346056140947`*^9, 
   3.475534652262253*^9}, {3.4755346863406277`*^9, 3.475534686642283*^9}, {
   3.4755383244743013`*^9, 3.4755383467610197`*^9}, {3.475538398332961*^9, 
   3.475538427636799*^9}, {3.47554307341286*^9, 3.475543106914772*^9}, {
   3.475543802211911*^9, 3.475543852873358*^9}, {3.475543918608522*^9, 
   3.475543921693429*^9}, {3.475543960247807*^9, 3.475543976558617*^9}, 
   3.4755497145716248`*^9, {3.484486050247908*^9, 3.48448606759993*^9}, {
   3.485195965286615*^9, 3.485195981876095*^9}, {3.48583049444412*^9, 
   3.485830496681006*^9}, 3.4858305273914337`*^9, {3.485830580538493*^9, 
   3.485830595144692*^9}, {3.485830706871621*^9, 3.485830773194625*^9}, {
   3.4858618341858177`*^9, 3.48586184875429*^9}, {3.485861940147129*^9, 
   3.485861964840062*^9}, {3.485862081060978*^9, 3.485862113596067*^9}, {
   3.4858621445492163`*^9, 3.4858621714852743`*^9}, {3.485862214602599*^9, 
   3.485862374549242*^9}, 3.487598356866372*^9, {3.487601950270562*^9, 
   3.4876019521414623`*^9}, {3.487602007751465*^9, 3.487602009450815*^9}, {
   3.4876020537212973`*^9, 3.4876020542753696`*^9}, {3.4888073778166513`*^9, 
   3.488807445327022*^9}, {3.488807482305338*^9, 3.488807550955323*^9}, {
   3.488808265686858*^9, 3.488808382746723*^9}, {3.4888085549033318`*^9, 
   3.4888085834938726`*^9}, {3.4888086582610292`*^9, 3.48880867292484*^9}, {
   3.4888088029022913`*^9, 3.488808818482251*^9}, {3.4888088669825697`*^9, 
   3.488808882374522*^9}, {3.488808914746084*^9, 3.4888089388304453`*^9}, {
   3.488809018684176*^9, 3.488809050258507*^9}, {3.488809080589534*^9, 
   3.4888090827257757`*^9}, {3.488809137132708*^9, 3.4888091836372757`*^9}, {
   3.488809226208148*^9, 3.488809231984322*^9}, 3.4888093095727673`*^9, {
   3.4888093475470457`*^9, 3.488809376669838*^9}, 3.488809436667774*^9, {
   3.488820228949336*^9, 3.488820235731703*^9}, {3.488820631332107*^9, 
   3.488820635805623*^9}, 3.4888208232291117`*^9, {3.488820895865839*^9, 
   3.4888209568062077`*^9}, {3.4888210487811127`*^9, 3.488821067070236*^9}, {
   3.4888558129121313`*^9, 3.488855906699357*^9}, {3.48885593980875*^9, 
   3.488855981366467*^9}, {3.4888568943016453`*^9, 3.488856999025888*^9}, {
   3.4888570401083317`*^9, 3.488857070233328*^9}, {3.492433889975027*^9, 
   3.4924339600751*^9}, {3.493400387916945*^9, 3.493400425778529*^9}, {
   3.4940831823455553`*^9, 3.49408318473433*^9}, 3.494083288763645*^9, {
   3.49411729631985*^9, 3.4941173557344017`*^9}, {3.494120115998885*^9, 
   3.494120142202883*^9}, 3.494172512335793*^9, {3.494172550462904*^9, 
   3.494172646337248*^9}, 3.4941727969916277`*^9, {3.494208356015231*^9, 
   3.494208374319687*^9}, {3.4942088540639153`*^9, 3.494208866130795*^9}, {
   3.505743269796804*^9, 3.505743521492309*^9}, 3.505743633064543*^9, {
   3.5057444203921337`*^9, 3.50574442920828*^9}, {3.52380640783531*^9, 
   3.523806541724936*^9}, {3.523806693163978*^9, 3.523806700402073*^9}, {
   3.5238068050956497`*^9, 3.5238068061021233`*^9}, {3.523806872898848*^9, 
   3.523806881442992*^9}, {3.523806914343727*^9, 3.5238069435501413`*^9}, {
   3.523807022838546*^9, 3.523807023327516*^9}, {3.523807141273609*^9, 
   3.5238071465658703`*^9}, {3.536504000957505*^9, 3.5365040425681257`*^9}, {
   3.537625179497781*^9, 3.5376251816410017`*^9}, 3.537625694845705*^9, {
   3.5473445930676193`*^9, 3.547344608326131*^9}}],

Cell["Miscellaneous routines", "Text",
 CellChangeTimes->{{3.478551281256507*^9, 3.4785512883429937`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Returns", " ", 
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"First", "[", "mn_", "]"}], "\[Rule]", "_"}], "]"}], " ", 
      "for", " ", "exp_"}], "\[Equal]", 
     RowBox[{"0", " ", "for", " ", "pair", " ", "mn_.", " ", 
      RowBox[{"e", ".", "g", "."}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"ZeroMN", "[", 
      RowBox[{
       RowBox[{"I", " ", "2", " ", "\[Pi]", " ", "m", " ", 
        RowBox[{"t", "/", "\[Beta]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}]}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{">", " ", "m"}], "->", "0"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMN", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"exp", "==", "0"}], ",", 
           RowBox[{"First", "[", "mn", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"First", "[", "tmp", "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"First", "[", 
            RowBox[{"First", "[", "tmp", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{"exp", "==", "0"}], ",", 
              RowBox[{"Last", "[", "mn", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"First", "[", "tmp", "]"}], "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"tmp", "=", 
              RowBox[{"First", "[", 
               RowBox[{"First", "[", "tmp", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmp", "=", "exp"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Returns", " ", 
     RowBox[{"xDiscreteDelta", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"mn_", ",", "_"}], "]"}], " ", "for", " ", "exp_"}], 
         "\[Equal]", " ", 
         RowBox[{"0", " ", "for", " ", "pair", " ", "mn_"}]}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], ".", " ", "e", ".", "g", "."}]}], 
       ",", " ", 
       RowBox[{
        RowBox[{"ZeroMN", "[", 
         RowBox[{
          RowBox[{"I", " ", "2", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"m", "-", "n"}], ")"}], " ", 
           RowBox[{"t", "/", "\[Beta]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}]}], "]"}], "->", 
        RowBox[{"xDiscreteDelta", "[", 
         RowBox[{"First", "[", 
          RowBox[{"m", ",", "n"}], "]"}], "]"}]}]}], "  "}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMNDiscreteDelta", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ZeroMN", "[", 
          RowBox[{"exp", ",", "mn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ZeroMNDiscreteDelta: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"exp", ",", "mn", ",", "tmp", ",", 
              RowBox[{"Head", "[", "tmp", "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tmp", "]"}], "===", "Rule"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"Rule", "\[Rule]", "xDiscreteDelta"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", "exp"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Returns", " ", 
     RowBox[{"\[Delta]uu", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"mn_", ",", "_"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DiscreteDelta", "[", "]"}], " ", "for", " ", "exp_"}], 
         "\[Equal]", " ", 
         RowBox[{"0", " ", "for", " ", "pair", " ", "mn_"}]}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], ".", " ", "e", ".", "g", "."}]}], 
       ",", " ", 
       RowBox[{"ZeroMN", "[", 
        RowBox[{
         RowBox[{"I", " ", "2", " ", "\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{"m", "-", "n"}], ")"}], " ", 
          RowBox[{"t", "/", "\[Beta]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], " "}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMN\[Delta]", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<ZeroMN\[Delta]\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ZeroMN", "[", 
          RowBox[{"exp", ",", "mn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"exp", ",", "mn", ",", "tmp"}], "}"}], ",", "\"\<\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tmp", "]"}], "===", "Rule"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"Rule", "\[Rule]", "\[Delta]uu"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", "exp"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Rule", " ", "for", " ", "Sum"}], "|", 
     RowBox[{"xSum", " ", "consolidation"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"GatherSumSubs", "=", 
     RowBox[{"subGatherSum", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "->", "xSum"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"xSum", "[", 
            RowBox[{"a_", ",", "b__"}], "]"}], ",", "c__"}], "]"}], ":>", 
         RowBox[{"xSum", "[", 
          RowBox[{"a", ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"Sequence", ",", 
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"b", ",", "c"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d_", " ", 
          RowBox[{"xSum", "[", 
           RowBox[{"a_", ",", "b__"}], "]"}]}], ":>", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"d", " ", "a"}], "]"}], ",", "b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d_", " ", ".", " ", 
          RowBox[{"xSum", "[", 
           RowBox[{"a_", ",", "b__"}], "]"}]}], "->", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"d", ".", " ", "a"}], ",", "b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"xSum", "[", 
           RowBox[{"a_", ",", "b__"}], "]"}], ".", "d_"}], "->", 
         RowBox[{"xSum", "[", " ", 
          RowBox[{
           RowBox[{"a", ".", "d"}], ",", "b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"xSum", "[", 
           RowBox[{"a_", ",", "b__"}], "]"}], "+", 
          RowBox[{"xSum", "[", 
           RowBox[{"c_", ",", "b__"}], "]"}]}], "->", 
         RowBox[{"xSum", "[", 
          RowBox[{
           RowBox[{"a", "+", "c"}], ",", "b"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Consolidation", " ", 
     RowBox[{
      RowBox[{"Rule", "[", "]"}], "'"}], "s", " ", "for", " ", "IntegralOp"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GatherIntOpSubs", "=", 
     RowBox[{"subGatherIntOp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a_List", ",", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{"b_List", ",", "c_"}], "]"}]}], "]"}], ":>", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", " ", "b"}], "}"}], ",", "c"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"d_", " ", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a", ",", 
           RowBox[{"Expand", "[", 
            RowBox[{"d", " ", "b"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "+", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}]}], "->", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a", ",", 
           RowBox[{"c", "+", "b"}]}], "]"}]}]}], "\[IndentingNewLine]", 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Changes", " ", 
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], "\[Rule]", 
     RowBox[{"Sum", "[", 
      RowBox[{"a", ",", 
       RowBox[{"PartialD", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"2.28", ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExchangexPartialDSum", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ExchangePartialDSum: \>\"", ",", "tmp"}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Partiald", " ", "does", " ", "not", " ", "substitute"}], 
          ",", " ", 
          RowBox[{"change", " ", "to", " ", "xPartialD"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", "distributePartialD"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{"a_", ",", "c__"}], "]"}], ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"xSum", "[", 
              RowBox[{"a_", ",", "c__"}], "]"}], ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Distribute", " ", "xSum", " ", "over", " ", 
     RowBox[{"ExpandAll", "[", "sumand", "]"}], " ", "of", " ", 
     RowBox[{
      RowBox[{"Sum", "[", "]"}], ".", "  ", "Returns"}], " ", 
     RowBox[{
      RowBox[{"xSum", "[", "]"}], ".", " ", "\[IndentingNewLine]", "3.1"}], 
     ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DistributeSum", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"tmp1", "=", "NULL"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"Sum", "->", "xSum"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<DistributeSum: \>\"", ",", "tmp"}], "]"}]}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "c__"}], "]"}], ":>", 
              RowBox[{"xSum", "[", 
               RowBox[{
                RowBox[{"ExpandAll", "[", "a", "]"}], ",", "c"}], "]"}]}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xSum", "[", 
                   RowBox[{"#", ",", "b"}], "]"}], "&"}], ",", "a"}], "]"}], "/;", 
               RowBox[{
                RowBox[{"Head", "[", "a", "]"}], "===", "Plus"}]}]}]}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Contracts", " ", 
     RowBox[{"xDiscreteDelta", "[", 
      RowBox[{"n_", ",", "m_"}], "]"}], " ", "in", " ", 
     RowBox[{"xSum", ".", "  ", "Eliminates"}], " ", "on", " ", 
     RowBox[{
      RowBox[{"xSum", "[", "]"}], ".", " ", "\[IndentingNewLine]", "3.1"}], 
     ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SumDiscreteDelta", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"tmp1", "=", "Null"}], ",", "pos", ",", "arg", ",", "index", 
         ",", "sumvar", ",", "xsum", ",", "xdelta", ",", "posd", ",", "n", 
         ",", "m", ",", 
         RowBox[{"repl", "=", 
          RowBox[{"{", "}"}]}], ",", "sub", ",", "i", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "//", "DistributeSum"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<SumDiscreteDelta: \>\"", ",", "tmp"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"tmp", ",", 
              RowBox[{"xSum", "[", "__", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", 
              RowBox[{"Length", "[", "pos", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xsum", "=", 
               RowBox[{"Extract", "[", 
                RowBox[{"tmp", ",", 
                 RowBox[{"pos", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"arg", ",", "index"}], "}"}], "=", 
               RowBox[{"Apply", "[", 
                RowBox[{"List", ",", "xsum"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "index", "]"}], "===", "List"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"sumvar", "=", 
                 RowBox[{"First", "[", "index", "]"}]}], ",", 
                RowBox[{"sumvar", "=", "index"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<SumDiscreteDelta{arg,index}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"arg", ",", "index"}], "}"}]}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"xdelta", "=", 
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"arg", ",", 
                  RowBox[{"posd", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{"arg", ",", 
                    RowBox[{"xDiscreteDelta", "[", "__", "]"}]}], "]"}]}]}], 
                 "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"sub", "=", "Null"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"xdelta", ",", "sumvar"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "xdelta", "]"}], "==", "2"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"sub", "=", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{"Apply", "[", 
                    RowBox[{"Equal", ",", "xdelta"}], "]"}], ",", "sumvar"}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "xdelta", "]"}], "==", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"sub", "=", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "xdelta", "]"}], "==", "0"}], ",", 
                    "sumvar"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<SumDiscreteDelta{Length[xdelta],xdelta,sub}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Length", "[", "xdelta", "]"}], ",", "xdelta", 
                    ",", "sub"}], "}"}]}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<SumDiscreteDelta{sub,arg}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"sub", ",", "arg"}], "}"}]}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sub", "=!=", "Null"}], ",", 
                RowBox[{
                 RowBox[{"arg", "=", 
                  RowBox[{
                   RowBox[{"arg", "/.", "sub"}], "/.", 
                   RowBox[{
                    RowBox[{"xDiscreteDelta", "[", "__", "]"}], "->", 
                    "1"}]}]}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"repl", ",", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "->", "arg"}]}], 
                  "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<SumDiscreteDelta{index,sub,repl}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", "sub", ",", "repl"}], "}"}]}], 
                 "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tmp", ",", "repl"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applies", " ", 
     RowBox[{"Integrate", "[", "]"}], " ", "to", " ", "one", " ", 
     RowBox[{"IntegralOp", "[", " ", "integration_parameter", " ", "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrateOne", "[", 
      RowBox[{"parm_", ",", "exp_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"IntegralOp", "->", "IntegralOp"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<IntegrateOne{parm,tmp}: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"parm", ",", "tmp"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<IntegrateOne{DeleteCases[a,parm]}: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"a", ",", "parm"}], "]"}], "}"}]}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"IntegralOp", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"IntegralOp", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{"a", ",", "parm"}], "]"}], ",", 
              RowBox[{"Integrate", "[", 
               RowBox[{"b", ",", "parm"}], "]"}]}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"a", ",", "parm"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generate", " ", "the", " ", "complement", " ", "t1_", " ", "t2_", " ", 
     "expression", " ", "relative", " ", "to", " ", "total", " ", 
     RowBox[{"differential", ".", "  ", "t1_"}], " ", "is", " ", "the", " ", 
     RowBox[{"xPartialD", "[", 
      RowBox[{"_", ",", "x"}], "]"}], " ", "term", " ", "which", " ", "has", 
     " ", "the", " ", "variable", " ", "used", " ", "for", " ", 
     RowBox[{"differentiating", ".", "  ", "t2"}], " ", "is", " ", "the", " ",
      "remaining", " ", 
     RowBox[{"term", ".", " ", "The"}], " ", "total", " ", "differential", 
     " ", "term", " ", "is", " ", "specified", " ", "by", " ", 
     RowBox[{
      RowBox[{"DD", "[", 
       RowBox[{"_", ",", "x"}], "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalDiffByParts", "[", 
      RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "var", ",", "f1", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f1", ",", "var"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<TotalDiffByParts: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"f1", ",", "var"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"DD", "[", 
           RowBox[{
            RowBox[{"f1", " ", "t2"}], ",", "var"}], "]"}], "-", 
          RowBox[{"f1", " ", 
           RowBox[{"xPartialD", "[", 
            RowBox[{"t2", ",", "var"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TotalDiffByParts1", "[", 
       RowBox[{"productexp_", ",", " ", "partialD_"}], "]"}], " ", 
      "generates", " ", "a", "  ", "expression", " ", "generated", " ", "by", 
      " ", "differentiating", " ", "by", " ", "parts", " ", "where", " ", 
      "productexp_", " ", "is", " ", "the", " ", "original", " ", "a", " ", 
      "product"}], "|", 
     RowBox[{
     "Dot", " ", "expression", " ", "and", " ", "partialD_", " ", "is", " ", 
      "the", " ", "imbedded", " ", "differential", " ", "of", " ", 
      RowBox[{"issue", ".", "  ", "\"\<partialdLoc\>\""}], " ", "shows", " ", 
      "the", " ", "location", " ", "of", " ", "the", " ", "partialD_", " ", 
      "and", " ", "its", " ", "arguement", " ", "is", " ", 
      RowBox[{"Dot", "'"}], "d", " ", "into", " ", "the", " ", 
      "complementory", " ", 
      RowBox[{"differential", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalDiffByParts1", "[", 
      RowBox[{"productexp_", ",", " ", "partialD_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "productexp"}], ",", "var", ",", "f1", ",", 
         "tmp1", ",", "tmp2", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f1", ",", "var"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "partialD"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp1", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"partialD", "\[Rule]", "partialdLoc"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<TotalDiffByParts: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"f1", ",", "var", ",", "tmp1"}], "}"}]}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"tmp2", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"partialD", "\[Rule]", "f1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"DD", "[", 
           RowBox[{"tmp2", ",", "var"}], "]"}], "-", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{"tmp1", ",", "var"}], "]"}], ".", "f1"}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generates", " ", "a", " ", "list", " ", "from", " ", "pure", " ", 
     "product", " ", "of", " ", "terms", " ", "including", " ", "Power", " ", 
     "terms", " ", "with", " ", "defined", " ", 
     RowBox[{"power", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Product2List", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"exp", ",", "Plus"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"exp", "/.", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
             RowBox[{"DotPower", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}]}], "/.", 
           RowBox[{"Times", "->", "Dot"}]}], "/.", 
          RowBox[{"Dot", "->", "List"}]}], ",", "\[IndentingNewLine]", 
         "exp"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rules", " ", "to", " ", "Expand", " ", "by", " ", "name", " ", "Dif", 
      " ", "operator"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", "xPartialD", ",", " ", 
     "xPartialDu", ",", " ", "xCovariantD", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"xCovariantDu", ".", "  ", "Terms"}], " ", "that", " ", 
       "match", " ", "any", " ", "of", " ", "list", " ", "of", " ", 
       "constants", " ", "are", " ", "treated", " ", "as", " ", 
       RowBox[{"constant", ".", "\[IndentingNewLine]", 
        RowBox[{"Usage", ":", " ", "exp"}]}]}], "//.", 
      RowBox[{"DifExpand", "[", 
       RowBox[{"xPartialD", ",", 
        RowBox[{"{", 
         RowBox[{"c1", ",", "c2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DifExpand", "[", 
      RowBox[{"name_", ",", "constants_List"}], "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"a_", " ", "c_"}], ",", "b_"}], "]"}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"name", "[", 
           RowBox[{"a", ",", "b"}], "]"}], "c"}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"name", "[", " ", 
           RowBox[{"c", ",", "b"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"a_", " ", ".", " ", "c_"}], ",", "b_"}], "]"}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"name", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ".", "c"}], "+", 
         RowBox[{"a", " ", ".", 
          RowBox[{"name", "[", " ", 
           RowBox[{"c", ",", "b"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"a_", "+", " ", "c_"}], ",", "b_"}], "]"}], "->", 
        RowBox[{
         RowBox[{"name", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "+", " ", 
         RowBox[{"name", "[", " ", 
          RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"Exp", "[", "a_", "]"}], ",", "b_"}], "]"}], "->", 
        RowBox[{
         RowBox[{"Exp", "[", "a", "]"}], " ", 
         RowBox[{"name", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"Log", "[", "a_", "]"}], ",", "b_"}], "]"}], "->", " ", 
        RowBox[{
         RowBox[{"name", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "/", "a"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{"a_", ",", "n_"}], "]"}], ",", "b_"}], "]"}], ":>", 
        RowBox[{"n", " ", 
         RowBox[{"Power", "[", 
          RowBox[{"a", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}], " ", 
         RowBox[{"name", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"NumericQ", "[", "a", "]"}]}]}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a_", ",", "a_"}], "]"}], ":>", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"a", ",", "constants"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a_", "]"}], ",", "b_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"name", "[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], "/;", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xCovariantD", ",", "xCovariantDu"}], "}"}], ",", 
            "name"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ",", "b_"}], "]"}], 
        ":>", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"name", "[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], "/;", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xCovariantD", ",", "xCovariantDu"}], "}"}], ",", 
            "name"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "a_", "]"}], ",", "b_"}], "]"}], ":>", 
        RowBox[{"Transpose", "[", 
         RowBox[{"name", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a__", ",", "\[Mu]_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"name", "[", 
           RowBox[{"a", ",", "\[Mu]"}], "]"}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "a", "]"}], "==", "List"}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Might", " ", "want", " ", "to", " ", "consider", " ", "xPartialD", " ", 
      "on", " ", "integral", " ", 
      RowBox[{"functions", ":", "\[IndentingNewLine]", 
       RowBox[{"xPartialD", "[", 
        RowBox[{
         RowBox[{"IntegralOp", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"a_", ",", "a0_", ",", "a1_"}], "}"}], "}"}], ",", 
           "b_"}], "]"}], ",", "c_"}], "]"}]}]}], ":>", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a0", ",", "a1"}], "}"}], "}"}], ",", 
        RowBox[{"xPartialD", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           RowBox[{"xPartialD", "[", 
            RowBox[{"a0", ",", "c"}], "]"}]}], "/.", 
          RowBox[{"a", "->", "a0"}]}], ")"}], " ", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "/.", 
            RowBox[{"a", "->", "a1"}]}], ")"}], " ", 
          RowBox[{"xPartialD", "[", 
           RowBox[{"a1", ",", "c"}], "]"}]}], ")"}]}], 
       "\[IndentingNewLine]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rules", " ", "for", " ", "applying", " ", "DifExpand", " ", "for", " ", 
     "D"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xPartialDExpand", "[", "constants_List", "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DifExpand", "[", 
         RowBox[{"xPartialD", ",", "constants"}], "]"}], ",", 
        RowBox[{"DifExpand", "[", 
         RowBox[{"xPartialDu", ",", "constants"}], "]"}]}], "}"}], "//", 
      "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xCovariantDExpand", "[", "constants_List", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DifExpand", "[", 
        RowBox[{"xCovariantD", ",", "constants"}], "]"}], ",", 
       RowBox[{"DifExpand", "[", 
        RowBox[{"xCovariantDu", ",", "constants"}], "]"}]}], "}"}], "//", 
     "Flatten"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xLieDExpand", "[", "constants_List", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"DifExpand", "[", 
       RowBox[{"xLieD", ",", "constants"}], "]"}], "}"}], "//", "Flatten"}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpandDerivDvar", "[", "head_", "]"}], ":=", 
    RowBox[{
     RowBox[{"head", "[", 
      RowBox[{"a_", ",", "b_List"}], "]"}], ":>", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "b", "]"}], ">", "1"}], ",", 
       RowBox[{"head", "[", 
        RowBox[{
         RowBox[{"head", "[", 
          RowBox[{"a", ",", 
           RowBox[{"First", "[", "b", "]"}]}], "]"}], ",", 
         RowBox[{"Rest", "[", "b", "]"}]}], "]"}], ",", 
       RowBox[{"head", "[", 
        RowBox[{"a", ",", 
         RowBox[{"First", "[", "b", "]"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expands", " ", "exp_", " ", "with", " ", "Leibnitz", " ", "like", " ", 
      RowBox[{"rule", ".", " ", "e", ".", "g", "."}]}], ",", " ", 
     RowBox[{
      RowBox[{"DerivativeExpand", "[", " ", 
       RowBox[{
        RowBox[{"\[ScriptCapitalL]d", "[", "X", "]"}], ",", 
        RowBox[{"{", "constants", "}"}]}], "]"}], "[", "exp_", "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DerivativeExpand", "[", "constants_List", "]"}], "[", "exp_", 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Expand", " ", "multiples", " ", "dvariables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"ExpandDerivDvar", "[", "xPartialD", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"ExpandDerivDvar", "[", "xPartialDu", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"ExpandDerivDvar", "[", "xCovariantD", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"ExpandDerivDvar", "[", "xCovariantDu", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"xPartialDExpand", "[", "constants", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"xCovariantDExpand", "[", "constants", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"xLieDExpand", "[", "constants", "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]Expand", "[", 
        RowBox[{"\[Delta]1_", ",", "constants_List"}], "]"}], "[", "exp_", 
       "]"}], " ", "expands", " ", "differential", " ", "operator"}], ",", 
     " ", "\[Delta]1_", ",", " ", 
     RowBox[{"via", " ", 
      RowBox[{
       RowBox[{"Dt", "[", "]"}], ".", "  ", "Corrections"}], " ", "are", " ", 
      "make", " ", "for", " ", "specified", " ", 
      RowBox[{"conditions", ".", " ", "Does"}], " ", "not", " ", "work", " ", 
      "for", " ", "the", " ", "new", " ", "Tensorial", " ", 
      RowBox[{"notation", ".", " ", "12"}], "July2012"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]Expand", "[", 
       RowBox[{"\[Delta]1_", ",", "constants_List"}], "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "sub", ",", 
         RowBox[{"name", "=", "\[Delta]1"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"\[Delta]1", "\[Rule]", "Dt"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Dt", "\[Rule]", "\[Delta]1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"name", "[", "a_", "]"}], ":>", 
            RowBox[{"0", "/;", 
             RowBox[{"ListMemberQ", "[", 
              RowBox[{"a", ",", "constants"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"name", "[", 
             RowBox[{"Conjugate", "[", "a_", "]"}], "]"}], ":>", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"name", "[", 
             RowBox[{"ConjugateTranspose", "[", "a_", "]"}], "]"}], ":>", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"name", "[", 
             RowBox[{"Transpose", "[", "a_", "]"}], "]"}], ":>", 
            RowBox[{"Transpose", "[", 
             RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"name", "[", "a__", "]"}], ":>", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"name", "[", "a", "]"}], "]"}], "/;", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "a", "]"}], "==", "List"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"name", "[", 
             RowBox[{"Tensor", "[", 
              RowBox[{
               RowBox[{"a_", " ", ".", " ", "d_"}], ",", "b_", ",", "c_"}], 
              "]"}], "]"}], "\[Rule]", 
            RowBox[{"Tensor", "[", 
             RowBox[{
              RowBox[{"name", "[", 
               RowBox[{"a", " ", ".", " ", "d"}], "]"}], ",", "b", ",", "c"}],
              "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"name", "[", "a_", "]"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], "[", "Conjugate", "]"}],
               "[", "a_", "]"}]}], "\[Rule]", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"name", "[", "Void", "]"}], "\[Rule]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"name", "[", "T_", "]"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", 
                RowBox[{"1", ",", "__"}], "]"}], "[", "Tensor", "]"}], "[", 
              RowBox[{"T_", ",", "i__"}], "]"}]}], "\[Rule]", 
            RowBox[{"name", "[", 
             RowBox[{"Tensor", "[", 
              RowBox[{"T", ",", "i"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"name", "[", "ii_", "]"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Derivative", "[", 
                RowBox[{"0", ",", "__"}], "]"}], "[", "Tensor", "]"}], "[", 
              RowBox[{"T_", ",", "i__"}], "]"}]}], "\[Rule]", "0"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "//.", "sub"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Rules", " ", "for", " ", "\[Delta]"}], "-", 
       RowBox[{
       "differentiation", " ", "function", " ", "where", " ", "name_"}]}], "->", 
      RowBox[{"\[Delta]", " ", "in", " ", "the", " ", "typical", " ", 
       RowBox[{"case", ".", " ", 
        RowBox[{"Usage", ":", " ", "exp"}]}]}]}], "//.", 
     RowBox[{
      RowBox[{"\[Delta]Expand", "[", 
       RowBox[{"\[Delta]", ",", 
        RowBox[{"{", "constant", "}"}]}], "]"}], "  ", "OBSOLETE"}]}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]ExpandXXX", "[", 
      RowBox[{"name_", ",", "constants_List"}], "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a_", " ", "c_"}], "]"}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"name", "[", "a", "]"}], "c"}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"name", "[", " ", "c", "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a_", "  ", ".", "  ", "c_"}], "]"}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"name", "[", "a", "]"}], ".", "c"}], "+", 
         RowBox[{"a", " ", ".", 
          RowBox[{"name", "[", " ", "c", "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"a_", "+", " ", "c_"}], "]"}], "->", 
        RowBox[{
         RowBox[{"name", "[", "a", "]"}], "+", " ", 
         RowBox[{"name", "[", " ", "c", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"Exp", "[", "a_", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"Exp", "[", "a", "]"}], " ", 
         RowBox[{"name", "[", "a", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"Log", "[", "a_", "]"}], "]"}], "->", " ", 
        RowBox[{
         RowBox[{"name", "[", "a", "]"}], "/", "a"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"a_", ",", "n_"}], "]"}], "]"}], ":>", 
        RowBox[{"n", " ", 
         RowBox[{"Power", "[", 
          RowBox[{"a", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}], " ", 
         RowBox[{"name", "[", "a", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", "a_", "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"NumericQ", "[", "a", "]"}]}]}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", "a_", "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"ListMemberQ", "[", 
          RowBox[{"a", ",", "constants"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"Conjugate", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"ConjugateTranspose", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"Transpose", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{"Transpose", "[", 
         RowBox[{"name", "[", "a", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", "a__", "]"}], ":>", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"name", "[", "a", "]"}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "a", "]"}], "==", "List"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"name", "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"a_", " ", ".", " ", "d_"}], ",", "b_", ",", "c_"}], "]"}],
          "]"}], "\[Rule]", 
        RowBox[{"Tensor", "[", 
         RowBox[{
          RowBox[{"name", "[", 
           RowBox[{"a", " ", ".", " ", "d"}], "]"}], ",", "b", ",", "c"}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"SwitchDeriv", "[", 
        RowBox[{"derIn_List", ",", "derOut_List"}], "]"}], "[", "exp_", "]"}],
       " ", "moves", " ", "derIn_List", " ", "derivatives", " ", "out", " ", 
      "from", " ", "under", " ", "derOut_List", " ", "derivatives", " ", "in",
       " ", "exp_"}], ",", " ", 
     RowBox[{"i", ".", "e"}], ",", " ", 
     RowBox[{
     "switches", " ", "the", " ", "order", " ", "of", " ", "differential", 
      " ", "operators"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{"\[Delta]", " ", "and", " ", 
      RowBox[{"xPartialD", ".", "  ", "2"}], "May2012"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SwitchDeriv", "[", 
       RowBox[{"derIn_List", ",", "derOut_List"}], "]"}], "[", "exp_", "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "sub", ",", "XXX"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"\[Delta]", "[", "a_", "]"}], "\[Rule]", 
           RowBox[{"\[Delta]", "[", 
            RowBox[{"a", ",", "XXX"}], "]"}]}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"make", " ", "uniform", " ", "arguements"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ListFreeQ", "[", 
            RowBox[{"derIn", ",", "derOut"}], "]"}], "===", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sub", "=", 
            RowBox[{
             RowBox[{"a_", "[", 
              RowBox[{
               RowBox[{"b_", "[", 
                RowBox[{"c_", ",", "d_"}], "]"}], ",", "e_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"b", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"c", ",", "e"}], "]"}], ",", "d"}], "]"}], "/;", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"derIn", ",", "b"}], "]"}], "&&", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"derOut", ",", "a"}], "]"}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", "sub"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"SwitchDerivERROR", "[", 
             RowBox[{"derIn", ",", "derOut"}], "]"}], "[", "tmp", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{"a_", ",", "XXX"}], "]"}], "\[Rule]", 
           RowBox[{"\[Delta]", "[", "a", "]"}]}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Integration", " ", "by", " ", "parts", " ", "assume", " ", "total", " ",
       "derivative"}], "->", 
     RowBox[{"0", " ", 
      RowBox[{"example", ":", " ", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"xPartialDu", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], "c_"}], ":>", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"xPartialDu", "[", 
              RowBox[{"c", ",", "b"}], "]"}]}], "a"}], "/;", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FreeQ", "[", 
               RowBox[{"a", ",", 
                RowBox[{"T", "[", 
                 RowBox[{"\[CurlyEpsilon]", ",", "\"\<u\>\"", ",", "_"}], 
                 "]"}]}], "]"}], "&&", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"a", ",", 
                RowBox[{"T", "[", 
                 RowBox[{"\[CurlyEpsilon]", ",", "\"\<d\>\"", ",", "_"}], 
                 "]"}]}], "]"}]}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], "c_"}], ":>", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"xPartialD", "[", 
              RowBox[{"c", ",", "b"}], "]"}]}], "a"}], "/;", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FreeQ", "[", 
               RowBox[{"a", ",", 
                RowBox[{"T", "[", 
                 RowBox[{"\[CurlyEpsilon]", ",", "\"\<u\>\"", ",", "_"}], 
                 "]"}]}], "]"}], "&&", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"a", ",", 
                RowBox[{"T", "[", 
                 RowBox[{"\[CurlyEpsilon]", ",", "\"\<d\>\"", ",", "_"}], 
                 "]"}]}], "]"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
        "}"}]}]}]}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.476642763862289*^9, 3.476642777525859*^9}, {
   3.476642811903961*^9, 3.476642911421946*^9}, 3.47664303789678*^9, 
   3.476643179165001*^9, {3.476643317075169*^9, 3.476643317936386*^9}, {
   3.476643402208899*^9, 3.4766434066830482`*^9}, {3.476643508211241*^9, 
   3.476643528519712*^9}, {3.476643562641294*^9, 3.4766436872674627`*^9}, {
   3.4766437628197317`*^9, 3.476643810538529*^9}, {3.476643938782834*^9, 
   3.476644005425108*^9}, {3.476644044434292*^9, 3.476644048809173*^9}, {
   3.476644120358526*^9, 3.476644167339213*^9}, {3.476644265665845*^9, 
   3.4766442958845*^9}, {3.476644328741139*^9, 3.476644404295808*^9}, {
   3.476644470998148*^9, 3.4766445398778048`*^9}, {3.476644750055437*^9, 
   3.476644861070799*^9}, 3.47664490044123*^9, {3.4766449535535727`*^9, 
   3.476644954367799*^9}, {3.476645016197184*^9, 3.476645033843459*^9}, {
   3.4766450969968243`*^9, 3.476645192595934*^9}, {3.4766699573515463`*^9, 
   3.4766700670649853`*^9}, {3.476672402720327*^9, 3.4766724049316196`*^9}, {
   3.4767542956697083`*^9, 3.4767543321489563`*^9}, {3.477178380157247*^9, 
   3.477178394343453*^9}, 3.477178518806591*^9, {3.4828503312341843`*^9, 
   3.482850358698378*^9}, {3.482850819237262*^9, 3.482850877150062*^9}, {
   3.482850910635704*^9, 3.482850913420699*^9}, {3.482850968642322*^9, 
   3.482850989821405*^9}, {3.483991989261016*^9, 3.4839920016509457`*^9}, {
   3.483992052929388*^9, 3.483992272737475*^9}, {3.483993222956908*^9, 
   3.48399332804101*^9}, 3.4839933709871397`*^9, 3.484058548100608*^9, {
   3.484058662604569*^9, 3.484058665450782*^9}, {3.484073095571376*^9, 
   3.484073111109579*^9}, {3.4841379161427402`*^9, 3.4841379633889837`*^9}, {
   3.484138097347961*^9, 3.484138107268364*^9}, {3.484141109394953*^9, 
   3.484141186807035*^9}, {3.485195501960164*^9, 3.485195519322579*^9}, {
   3.485626961186953*^9, 3.485626986682448*^9}, {3.485627048751285*^9, 
   3.485627058376111*^9}, 3.485627142134439*^9, {3.4856274966986513`*^9, 
   3.4856275238609877`*^9}, {3.48570130659975*^9, 3.485701330767749*^9}, {
   3.485701373487636*^9, 3.4857014160442*^9}, {3.485701468918556*^9, 
   3.485701485901005*^9}, {3.4857015715166388`*^9, 3.4857016541429033`*^9}, {
   3.485797376683008*^9, 3.485797401923904*^9}, {3.486489960822443*^9, 
   3.486490014015448*^9}, {3.486987332239148*^9, 3.4869873727309103`*^9}, {
   3.4871293507544737`*^9, 3.4871293517243347`*^9}, {3.4871300022098083`*^9, 
   3.487130063610505*^9}, {3.4871330829518223`*^9, 3.487133084938933*^9}, {
   3.487153147228982*^9, 3.4871531479793777`*^9}, {3.488220529021661*^9, 
   3.4882205422067823`*^9}, {3.488888169336214*^9, 3.488888185104648*^9}, {
   3.488888325687928*^9, 3.488888363875738*^9}, {3.488888495049947*^9, 
   3.488888515868672*^9}, {3.489161225061614*^9, 3.489161227475399*^9}, {
   3.49070036988326*^9, 3.490700400221613*^9}, {3.490700474382697*^9, 
   3.490700476612949*^9}, {3.4915905506497583`*^9, 3.491590555645852*^9}, 
   3.491590713183634*^9, {3.494102329129106*^9, 3.494102337466547*^9}, {
   3.4941024160518837`*^9, 3.4941024400636797`*^9}, {3.5082952524895687`*^9, 
   3.508295276019346*^9}, {3.508295589121359*^9, 3.508295595792159*^9}, {
   3.508297503974258*^9, 3.508297613547318*^9}, 3.5147290600480537`*^9, 
   3.521119841651842*^9, {3.521120114762586*^9, 3.521120157192663*^9}, {
   3.521120208602108*^9, 3.521120211102107*^9}, {3.521120339889695*^9, 
   3.521120346504696*^9}, {3.521120407286174*^9, 3.521120442932687*^9}, {
   3.521120609386323*^9, 3.521120624775743*^9}, {3.521120747878087*^9, 
   3.521120749158062*^9}, {3.521120830515046*^9, 3.521120833721381*^9}, {
   3.5211208767098513`*^9, 3.521120884655032*^9}, 3.521121082904139*^9, {
   3.52112111574216*^9, 3.521121133768067*^9}, {3.52112119210323*^9, 
   3.521121192931135*^9}, 3.521122000581759*^9, {3.521122293335088*^9, 
   3.521122294619671*^9}, 3.524789497239822*^9, 3.527340438984069*^9, {
   3.527340480625701*^9, 3.527340551548275*^9}, 3.527356399630188*^9, {
   3.527360714738388*^9, 3.527360715431793*^9}, {3.527385040372264*^9, 
   3.5273850916269903`*^9}, {3.5273851345176487`*^9, 3.527385317612133*^9}, {
   3.527385405774118*^9, 3.527385448835446*^9}, {3.527417758637363*^9, 
   3.527417814500292*^9}, {3.5274178911427193`*^9, 3.527417905038609*^9}, 
   3.52741989066042*^9, {3.527419923377001*^9, 3.527419946786434*^9}, {
   3.527424126906603*^9, 3.527424178646565*^9}, {3.52742421661795*^9, 
   3.527424275229167*^9}, {3.529770007220236*^9, 3.529770050078761*^9}, {
   3.529770084702052*^9, 3.529770118287924*^9}, {3.540232328064604*^9, 
   3.540232437872596*^9}, {3.5427289412337437`*^9, 3.542728949859419*^9}, {
   3.542729853057007*^9, 3.542729853765092*^9}, {3.542729892992072*^9, 
   3.542729961812655*^9}, {3.542730026089923*^9, 3.542730135359694*^9}, 
   3.542730167280415*^9, {3.542735844103541*^9, 3.542736003691204*^9}, {
   3.542736038762649*^9, 3.542736050793544*^9}, {3.54274084082145*^9, 
   3.54274088346202*^9}, {3.543256782319055*^9, 3.543256797833157*^9}, {
   3.5444130173122463`*^9, 3.544413041631049*^9}, {3.544440113446398*^9, 
   3.544440115670208*^9}, 3.544972049901931*^9, {3.546613483243095*^9, 
   3.546613487407197*^9}, {3.548731253610033*^9, 3.548731319632332*^9}, 
   3.550953376631815*^9, {3.5509741798520927`*^9, 3.5509742238986197`*^9}, {
   3.55097427434593*^9, 3.550974348226534*^9}}],

Cell[TextData[{
 "Index ",
 StyleBox["routines",
  InitializationCell->True]
}], "Text",
 CellChangeTimes->{{3.477347537208624*^9, 3.4773475425983887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Adds", "/", "modifies"}], " ", "index", " ", "to", " ", 
    "existing", " ", 
    RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AddBaseIndex", "[", "index_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<AddBaseIndex\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "index", "}"}], ",", "\"\<in\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"CompleteBaseIndices", ",", "index"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<tmp\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"index", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "a_"}], "}"}], "\[Rule]", 
            "index"}]}], "//", "DeleteDuplicates"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<tmp\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeclareBaseIndices", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "tmp"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "CompleteBaseIndices"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "CheckIndices", " ", "applies", " ", "ParseTermIndices", " ", "to", " ", 
     "eech", " ", "level", " ", "2", " ", "term", " ", "in", " ", "exp_.", 
     " ", "4", "Jul2012"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CheckIndices", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ParseTermIndices", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "tmp"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SwitchLabel", "[", 
       RowBox[{"exp_", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}], " ", "switches", " ", 
      "label", " ", "a"}], ",", 
     RowBox[{"b", " ", "in", " ", "exp_"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SwitchLabel", "[", 
      RowBox[{"exp_", ",", "mn_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "XXXX"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"First", "[", "mn", "]"}], "->", "XXXX"}]}], "/.", 
          RowBox[{
           RowBox[{"Last", "[", "mn", "]"}], "->", 
           RowBox[{"First", "[", "mn", "]"}]}]}], "/.", 
         RowBox[{"XXXX", "->", 
          RowBox[{"Last", "[", "mn", "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"SwitchLabel", "[", 
       RowBox[{"exp_", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}], "]"}], " ", "switches", " ", 
      "label", " ", "a"}], ",", 
     RowBox[{"b", " ", "in", " ", "exp_"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SwitchLabel", "[", "mn_List", "]"}], "[", "exp_", "]"}], ":=", 
     
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "XXXX"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"First", "[", "mn", "]"}], "->", "XXXX"}]}], "/.", 
          RowBox[{
           RowBox[{"Last", "[", "mn", "]"}], "->", 
           RowBox[{"First", "[", "mn", "]"}]}]}], "/.", 
         RowBox[{"XXXX", "->", 
          RowBox[{"Last", "[", "mn", "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Symmetrize2", "[", "indexPair_List", "]"}], "[", "exp_", "]"}],
      " ", "symmetrizes", " ", "exp_", " ", "over", " ", "indexPair_.", "  ", 
     
     RowBox[{"PROBLEM", ":", " ", 
      RowBox[{
      "all", " ", "indices", " ", "must", " ", "be", " ", "unique", " ", 
       "for", " ", "this", " ", "to", " ", "work", " ", 
       RowBox[{"correctly", ".", "  ", "Try"}], " ", "Symmetrize", " ", 
       RowBox[{"below", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Symmetrize2", "[", "indexPair_List", "]"}], "[", "exp_", "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp1", ",", "tmp2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp1", "=", "exp"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp2", "=", 
         RowBox[{
          RowBox[{"Swap", "[", "indexPair", "]"}], "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"tmp1", "+", "tmp2"}], ")"}], "/", "2"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AntiSymmetrize2", "[", "indexPair_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp1", ",", "tmp2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp1", "=", "exp"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp2", "=", 
         RowBox[{
          RowBox[{"Swap", "[", "indexPair", "]"}], "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"tmp1", "-", "tmp2"}], ")"}], "/", "2"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Symmetrize", "[", "tensorindex_List", "]"}], "[", "exp_", 
      "]"}], " ", "applies", " ", "a", " ", "list", " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"tensorindex", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tensorName", ",", "order", ",", "index_List"}], "}"}], " ",
          "to", " ", "exp_.", "  ", "If", " ", "order"}], " ", "<", " ", 
        RowBox[{
        "0", " ", "then", " ", "index_List", " ", "specify", " ", 
         "AntiSymmetric", " ", 
         RowBox[{"relationship", ".", "  ", "Uses"}], " ", "Tensorial", " ", 
         RowBox[{"routines", ".", "  ", "1"}], 
         RowBox[{"May2012", "."}]}]}]}], " "}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Symmetrize", "[", "tensorindex_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "tmp2", ",", "up0", 
         ",", "dn0", ",", "up1", ",", "dn1", ",", "order", ",", 
         "Symmetrize1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Symmetrize1", "[", "tensorindex1_List", "]"}], "[", 
          "exp1_", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tensorindex1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
           RowBox[{
            RowBox[{"SymmetrizeSlots", "[", 
             RowBox[{
              RowBox[{"tensorindex1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"tensorindex1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"Symmetric", "[", 
               RowBox[{"Apply", "[", 
                RowBox[{"Sequence", ",", 
                 RowBox[{"tensorindex1", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
            "[", "exp1", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SymmetrizeSlots", "[", 
             RowBox[{
              RowBox[{"tensorindex1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"tensorindex1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{"AntiSymmetric", "[", 
               RowBox[{"Apply", "[", 
                RowBox[{"Sequence", ",", 
                 RowBox[{"tensorindex1", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
            "[", "exp1", "]"}]}], "]"}]}], "\[IndentingNewLine]", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Symmetrize1", "[", "#2", "]"}], "[", "#1", "]"}], "&"}], 
          ",", "tmp", ",", "tensorindex"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OrderSymmetricTensor", "[", "tensor_Tensor", "]"}], " ", 
     "Canonical", " ", "orders", " ", "all", " ", "slots", " ", "of", " ", 
     RowBox[{"tensor_Tensor", ".", "  ", "May"}], " ", "be", " ", "useful", 
     " ", "in", " ", "simplifying", " ", "Tensor", " ", 
     RowBox[{"expressions", "."}]}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderSymmetricTensor", "[", "tensor_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "name", ",", "ups", ",", "dns", ",", "indices"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"name", ",", "ups", ",", "dns"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "tensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ups", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"25", "Apr2012", " ", "untested"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"OrderSymmetricTensor", "[", 
         RowBox[{"tensor", ",", "indices"}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OrderSymmetricTensor", "[", 
      RowBox[{"tensor_Tensor", ",", "indices_List"}], "]"}], " ", "Canonical",
      " ", "orders", " ", "slots", " ", "indices_List", " ", 
     RowBox[{"(", "Integers", ")"}], " ", "of", " ", "tensor_Tensor"}], " ", 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderSymmetricTensor", "[", 
      RowBox[{"tensor_Tensor", ",", "indices_List"}], 
      RowBox[{"(*", "Integer", "*)"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "tmps", ",", "tmp0", ",", "sub", ",", "name", ",", "ups", 
         ",", "dns", ",", "nosym", ",", "cases"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"name", ",", "ups", ",", "dns"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "tensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cases", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], ",", "indices"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nosym", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "i", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ups", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nosym", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"nosym", ",", "cases"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp0", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"List", "[", 
           RowBox[{"ups", ",", "dns"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmps", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"tmp0", ",", "nosym"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", "Void"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "tmps"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"f_", "[", "a_", "]"}], "->", "a"}]}], "&"}], ",", 
           "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cases", ",", "tmp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"tmp0", ",", "sub"}], "]"}], "//", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", 
         RowBox[{"name", ",", 
          RowBox[{"tmp", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"tmp", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OrderAntiSymmetricTensor", "[", 
      RowBox[{"tensor_Tensor", ",", "indices_List"}], "]"}], " ", "Canonical",
      " ", "orders", " ", "slots", " ", "indices_List", " ", "of", " ", 
     "tensor_Tensor", " ", "multiplied", " ", "by", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"Signature", "[", "indices", "]"}]}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderAntiSymmetricTensor", "[", 
      RowBox[{"tensor_Tensor", ",", "indices_List"}], 
      RowBox[{"(*", "Integer", "*)"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "tmps", ",", "tmp0", ",", "sub", ",", "name", ",", "ups", 
         ",", "dns", ",", "nosym", ",", "cases", ",", "signature"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"name", ",", "ups", ",", "dns"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "tensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cases", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], ",", "indices"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nosym", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "i", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ups", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nosym", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"nosym", ",", "cases"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp0", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"List", "[", 
           RowBox[{"ups", ",", "dns"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmps", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"tmp0", ",", "nosym"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", "Void"}], "]"}], "[", "#", "]"}], "&"}], ",", 
           "tmps"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"signature", "=", 
         RowBox[{"Signature", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"f_", "[", "a_", "]"}], "->", "a"}]}], "&"}], ",", 
           "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cases", ",", "tmp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{"tmp0", ",", "sub"}], "]"}], "//", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"signature", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"name", ",", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"OrderAntiSymmetricTensor", "[", "tensor_Tensor", "]"}], " ", 
      "Canonical", " ", "orders", " ", "all", " ", "slots", " ", "of", " ", 
      "anti"}], "-", 
     RowBox[{"symmetric", " ", 
      RowBox[{"tensor_Tensor", ".", "  ", "May"}], " ", "be", " ", "useful", 
      " ", "in", " ", "simplifying", " ", "Tensor", " ", 
      RowBox[{"expressions", "."}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderAntiSymmetricTensor", "[", "tensor_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "name", ",", "ups", ",", "dns", ",", "indices"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"name", ",", "ups", ",", "dns"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "tensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ups", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"25", "Apr2012", " ", "untested"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"OrderAntiSymmetricTensor", "[", 
         RowBox[{"tensor", ",", "indices"}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Swaps", " ", "pairs", " ", "of", " ", "anything", " ", "in", " ", 
     RowBox[{"expressions", ".", "  ", "Same"}], " ", "as", " ", 
     RowBox[{"SwitchLabel", ".", " ", 
      RowBox[{"Usage", ":", " ", 
       RowBox[{
        RowBox[{"Swap", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "[", 
        RowBox[{"expWith", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}], "    ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Swap", "[", "pair_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "XXXX"}], "}"}], ",", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"pair", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "XXXX"}]}], "//.", 
           RowBox[{
            RowBox[{"pair", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
            RowBox[{"pair", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "//.", 
          RowBox[{"XXXX", "\[Rule]", 
           RowBox[{"pair", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Swaps", " ", "sequential", " ", "pairs", " ", "of", " ", "anything", " ",
      "in", " ", 
     RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Swaps", "[", "pairs_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mName", "=", "\"\<Swaps\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"tmp", ",", "pairs", ",", 
            RowBox[{"Depth", "[", "pairs", "]"}]}], "}"}], ",", 
          "\"\<tmp,pairs\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", " ", 
         RowBox[{"Fold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Swap", "[", "#2", "]"}], "[", "#1", "]"}], "&"}], ",", 
           "exp", ",", "pairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Returns", " ", "list", " ", "of", " ", "positions", " ", "in", " ", 
     "list_", " ", "of", " ", "form_", " ", "or", " ", 
     RowBox[{"{", "}"}], " ", "if", " ", "none", " ", 
     RowBox[{"found", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IndicesQ", "[", 
      RowBox[{"list_List", ",", "form_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"pos", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "list", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "===", "form"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pos", ",", "i"}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "pos"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ContractUpDn", "[", "\[Delta]_", "]"}], "[", "exp_", "]"}], 
      " ", "Einstein", " ", "like", " ", "contraction", " ", 
      RowBox[{"(", 
       RowBox[{"up", "/", "dn"}], ")"}], " ", "of", " ", "terms", " ", "in", 
      " ", "exp_", " ", "using", " ", "\[Delta]_", " ", "as", " ", "metric", 
      " ", "variable", " ", "contained", " ", "in", " ", "each", " ", "term", 
      " ", "of", " ", "exp_.", " ", "The", " ", "choice", " ", "of", " ", 
      "contraction", " ", "indices", " ", "is", " ", "not", " ", "controlled",
       " ", "and", " ", "does", " ", "not", " ", "check", " ", "for", " ", 
      "proper", " ", 
      RowBox[{"up", "/", "dn"}], " ", "relationship", " ", "in", " ", 
      "exp_"}], ",", " ", 
     RowBox[{
     "only", " ", "the", " ", "presence", " ", "of", " ", "\[Delta]", " ", 
      "indices", " ", "as", " ", "symbol", " ", "in", " ", "exp_.", " ", 
      "Assumes", " ", "properly", " ", "formed", " ", "index", " ", 
      "relationships", " ", "in", " ", "exp_.", "\[IndentingNewLine]", "26", 
      RowBox[{"Apr2012", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractUpDn", "[", "\[Delta]_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"ExpandAll", "[", "exp", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"Minimize", " ", "complex", " ", "expressions"}], "*)"}], 
         ",", "sub", ",", "up", ",", "dn", ",", "test"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"test", "[", 
          RowBox[{"A_", ",", "from_", ",", "to_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"A", ",", "from"}], "]"}]}], "&&", 
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"from", ",", "to"}], "}"}], ",", "Void"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"LowerIndexTU", "[", 
               RowBox[{"dn1", ",", "dn2"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "dn1", ",", "dn2"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"LowerIndexTU", "[", 
               RowBox[{"dn2", ",", "dn1"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "dn2", ",", "dn1"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"RaiseIndexTU", "[", 
               RowBox[{"up1", ",", "up2"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "up1", ",", "up2"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"RaiseIndexTU", "[", 
               RowBox[{"up2", ",", "up1"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "up2", ",", "up1"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"up", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"ups", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"dn", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"dns", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"A", ",", 
                  RowBox[{"up", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
              RowBox[{"(", 
               RowBox[{"A", "/.", 
                RowBox[{"Rule", "[", 
                 RowBox[{
                  RowBox[{"up", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"dn", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"up", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"ups", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"dn", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"dns", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"A", ",", 
                  RowBox[{"dn", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
              RowBox[{"(", 
               RowBox[{"A", "/.", 
                RowBox[{"Rule", "[", 
                 RowBox[{
                  RowBox[{"dn", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"up", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ContractUpDn", "[", 
        RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], 
      " ", "Einstein", " ", "like", " ", "contraction", " ", 
      RowBox[{"(", 
       RowBox[{"up", "/", "dn"}], ")"}], " ", "of", " ", "terms", " ", "in", 
      " ", "exp_", " ", "using", " ", "\[Delta]_", " ", "as", " ", "metric", 
      " ", 
      RowBox[{"variable", ".", " ", "The"}], " ", "contraction", " ", "uses", 
      " ", "indices", " ", "ONLY", " ", "in", " ", 
      RowBox[{"index_List", ".", "  ", "Does"}], " ", "not", " ", "check", 
      " ", "for", " ", "proper", " ", 
      RowBox[{"up", "/", "dn"}], " ", "relationship", " ", "in", " ", 
      "exp_"}], ",", " ", 
     RowBox[{
     "only", " ", "the", " ", "presence", " ", "of", " ", "\[Delta]", " ", 
      "indices", " ", "as", " ", "symbol", " ", "in", " ", "exp_.", " ", 
      "Assumes", " ", "properly", " ", "formed", " ", "index", " ", 
      "relationships", " ", "in", " ", "exp_.", "\[IndentingNewLine]", "26", 
      RowBox[{"Apr2012", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractUpDn", "[", 
       RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"ExpandAll", "[", "exp", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"Minimize", " ", "complex", " ", "expressions"}], "*)"}], 
         ",", "sub", ",", "up", ",", "dn", ",", "test"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"test", "[", 
          RowBox[{"A_", ",", "from_", ",", "to_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"A", ",", "from"}], "]"}]}], "&&", 
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"from", ",", "to"}], "}"}], ",", "Void"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"ListFreeQ", "[", 
            RowBox[{"from", ",", "index"}], "]"}], ">", "0"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"LowerIndexTU", "[", 
               RowBox[{"dn1", ",", "dn2"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "dn1", ",", "dn2"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"LowerIndexTU", "[", 
               RowBox[{"dn2", ",", "dn1"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "dn2", ",", "dn1"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"RaiseIndexTU", "[", 
               RowBox[{"up1", ",", "up2"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "up1", ",", "up2"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", 
               RowBox[{"{", 
                RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"RaiseIndexTU", "[", 
               RowBox[{"up2", ",", "up1"}], "]"}], "[", "A", "]"}], "/;", 
             RowBox[{"test", "[", 
              RowBox[{"A", ",", "up2", ",", "up1"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"up", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"ups", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"dn", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"dns", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"A", ",", 
                  RowBox[{"up", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&&", 
               RowBox[{
                RowBox[{"ListFreeQ", "[", 
                 RowBox[{"up", ",", "index"}], "]"}], ">", "0"}]}], ",", 
              RowBox[{"(", 
               RowBox[{"A", "/.", 
                RowBox[{"Rule", "[", 
                 RowBox[{
                  RowBox[{"up", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"dn", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
            "\[RuleDelayed]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"up", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"ups", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"dn", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"dns", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], 
               "&&", "\[IndentingNewLine]", 
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"A", ",", 
                  RowBox[{"dn", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&&", 
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"dn", ",", "index"}], "]"}]}], ",", 
              RowBox[{"(", 
               RowBox[{"A", "/.", 
                RowBox[{"Rule", "[", 
                 RowBox[{
                  RowBox[{"dn", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"up", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ContractUpDnNot", "[", 
        RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], 
      " ", "Einstein", " ", "like", " ", "contraction", " ", 
      RowBox[{"(", 
       RowBox[{"up", "/", "dn"}], ")"}], " ", "of", " ", "terms", " ", "in", 
      " ", "exp_", " ", "using", " ", "\[Delta]_", " ", "as", " ", "metric", 
      " ", 
      RowBox[{"variable", ".", " ", "The"}], " ", "contraction", " ", "does", 
      " ", "NOT", " ", "use", " ", "indices", " ", "in", " ", "index_List"}], 
     ",", " ", 
     RowBox[{
     "but", " ", "the", " ", "use", " ", "of", " ", "other", " ", "indices", 
      " ", "is", " ", "not", " ", 
      RowBox[{"controlled", ".", "  ", "Does"}], " ", "not", " ", "check", 
      " ", "for", " ", "proper", " ", 
      RowBox[{"up", "/", "dn"}], " ", "relationship", " ", "in", " ", 
      "exp_"}], ",", " ", 
     RowBox[{
     "only", " ", "the", " ", "presence", " ", "of", " ", "\[Delta]", " ", 
      "indices", " ", "as", " ", "symbol", " ", "in", " ", "exp_.", " ", 
      "Assumes", " ", "properly", " ", "formed", " ", "index", " ", 
      "relationships", " ", "in", " ", "exp_.", "\[IndentingNewLine]", "26", 
      RowBox[{"Apr2012", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContractUpDnNot", "[", 
      RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ExpandAll", "[", "exp", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{"Minimize", " ", "complex", " ", "expressions"}], "*)"}], 
        ",", "sub", ",", "up", ",", "dn", ",", "test"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"test", "[", 
         RowBox[{"A_", ",", "from_", ",", "to_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"A", ",", "from"}], "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"from", ",", "to"}], "}"}], ",", "Void"}], "]"}]}], "&&", 
         RowBox[{
          RowBox[{"ListFreeQ", "[", 
           RowBox[{"from", ",", "index"}], "]"}], "==", "0"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sub", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", 
              RowBox[{"{", 
               RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"LowerIndexTU", "[", 
              RowBox[{"dn1", ",", "dn2"}], "]"}], "[", "A", "]"}], "/;", 
            RowBox[{"test", "[", 
             RowBox[{"A", ",", "dn1", ",", "dn2"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", 
              RowBox[{"{", 
               RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"LowerIndexTU", "[", 
              RowBox[{"dn2", ",", "dn1"}], "]"}], "[", "A", "]"}], "/;", 
            RowBox[{"test", "[", 
             RowBox[{"A", ",", "dn2", ",", "dn1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", 
              RowBox[{"{", 
               RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"RaiseIndexTU", "[", 
              RowBox[{"up1", ",", "up2"}], "]"}], "[", "A", "]"}], "/;", 
            RowBox[{"test", "[", 
             RowBox[{"A", ",", "up1", ",", "up2"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", 
              RowBox[{"{", 
               RowBox[{"up1_", ",", "up2_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"dn1_", ",", "dn2_"}], "}"}]}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"RaiseIndexTU", "[", 
              RowBox[{"up2", ",", "up1"}], "]"}], "[", "A", "]"}], "/;", 
            RowBox[{"test", "[", 
             RowBox[{"A", ",", "up2", ",", "up1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"up", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"ups", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], "&&",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"dn", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"dns", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], "&&",
               "\[IndentingNewLine]", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"up", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&&", 
              RowBox[{
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"up", ",", "index"}], "]"}], "==", "0"}]}], ",", 
             RowBox[{"(", 
              RowBox[{"A", "/.", 
               RowBox[{"Rule", "[", 
                RowBox[{
                 RowBox[{"up", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"dn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"up", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"ups", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], "&&",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"dn", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"dns", ",", "Void"}], "]"}]}], "]"}], "==", "1"}], "&&",
               "\[IndentingNewLine]", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"dn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&&", 
              RowBox[{
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"dn", ",", "index"}], "]"}], "==", "0"}]}], ",", 
             RowBox[{"(", 
              RowBox[{"A", "/.", 
               RowBox[{"Rule", "[", 
                RowBox[{
                 RowBox[{"dn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"up", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Contract", "[", "\[Delta]_", "]"}], "[", "exp_", "]"}], " ", 
     "does", " ", "Kronecker", " ", "contraction", " ", "on", " ", "terms", 
     " ", "in", " ", "exp_", " ", "containing", " ", "\[Delta]", " ", "over", 
     " ", "all", " ", "indices", " ", "without", " ", "control", " ", "over", 
     " ", "which", " ", "index", " ", 
     RowBox[{"remains", ".", "  ", "Ignores"}], " ", 
     RowBox[{"up", "/", "dn"}], " ", "positions", " ", "of", " ", 
     RowBox[{"indices", ".", " ", "\[IndentingNewLine]", "26"}], 
     RowBox[{"Apr2012", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Contract", "[", "\[Delta]_", "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ExpandAll", "[", "exp", "]"}]}], 
        RowBox[{"(*", 
         RowBox[{"Minimize", " ", "complex", " ", "expressions"}], "*)"}], 
        ",", "sub", ",", "updn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
          "\[RuleDelayed]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"(", 
                RowBox[{"updn", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"ups", ",", "Void"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"dns", ",", "Void"}], "]"}]}], "}"}], "]"}]}], 
                ")"}], "]"}], "==", "2"}], "&&", 
             RowBox[{"!", " ", 
              RowBox[{
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"A", ",", "updn"}], "]"}], "\[Equal]", "0"}]}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"A", "/.", 
               RowBox[{"Rule", "[", 
                RowBox[{
                 RowBox[{"updn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"updn", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"updn", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"updn", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Contract", "[", 
       RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], 
     " ", "does", " ", "Kronecker", " ", "contraction", " ", "on", " ", 
     "terms", " ", "in", " ", "exp_", " ", "containing", " ", "\[Delta]", " ",
      "over", " ", "ONLY", " ", "indices", " ", "contained", " ", "in", " ", 
     RowBox[{"index_List", ".", "  ", "Ignores"}], " ", 
     RowBox[{"up", "/", "dn"}], " ", "positions", " ", "of", " ", 
     RowBox[{"indices", ".", " ", "\[IndentingNewLine]", "26"}], 
     RowBox[{"Apr2012", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Contract", "[", 
       RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"ExpandAll", "[", "exp", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"Minimize", " ", "complex", " ", "expressions"}], "*)"}], 
         ",", "sub", ",", "updn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"(", 
                 RowBox[{"updn", "=", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"ups", ",", "Void"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"dns", ",", "Void"}], "]"}]}], "}"}], "]"}]}], 
                 ")"}], "]"}], "==", "2"}], "&&", 
              RowBox[{"!", " ", 
               RowBox[{
                RowBox[{"ListFreeQ", "[", 
                 RowBox[{"A", ",", "updn"}], "]"}], "\[Equal]", "0"}]}], "&&", 
              RowBox[{
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"updn", ",", "index"}], "]"}], ">", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"A", "/.", 
                RowBox[{
                 RowBox[{"updn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ":>", 
                 RowBox[{
                  RowBox[{"updn", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/;", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"index", ",", 
                    RowBox[{"updn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "/.", 
               RowBox[{
                RowBox[{"updn", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"updn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/;", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"index", ",", 
                   RowBox[{"updn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], ")"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"ContractNot", "[", 
       RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], 
     " ", "does", " ", "Kronecker", " ", "contraction", " ", "on", " ", 
     "terms", " ", "in", " ", "exp_", " ", "containing", " ", "\[Delta]", " ",
      "over", " ", "all", " ", "indices", " ", "EXCEPT", " ", "ones", " ", 
     "in", " ", 
     RowBox[{"index_List", ".", "  ", "Ignores"}], " ", 
     RowBox[{"up", "/", "dn"}], " ", "positions", " ", "of", " ", 
     RowBox[{"indices", ".", " ", "\[IndentingNewLine]", "26"}], 
     RowBox[{"Apr2012", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractNot", "[", 
       RowBox[{"\[Delta]_", ",", "index_List"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"ExpandAll", "[", "exp", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"Minimize", " ", "complex", " ", "expressions"}], "*)"}], 
         ",", "sub", ",", "updn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "ups_", ",", "dns_"}], "]"}], "A_"}], 
           "\[RuleDelayed]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"(", 
                 RowBox[{"updn", "=", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"ups", ",", "Void"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"dns", ",", "Void"}], "]"}]}], "}"}], "]"}]}], 
                 ")"}], "]"}], "==", "2"}], "&&", 
              RowBox[{"!", " ", 
               RowBox[{
                RowBox[{"ListFreeQ", "[", 
                 RowBox[{"A", ",", "updn"}], "]"}], "\[Equal]", "0"}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"A", "/.", 
                RowBox[{
                 RowBox[{"updn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ":>", 
                 RowBox[{
                  RowBox[{"updn", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/;", 
                  RowBox[{"!", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"index", ",", 
                    RowBox[{"updn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}]}], "/.", 
               RowBox[{
                RowBox[{"updn", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"updn", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/;", 
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"index", ",", 
                    RowBox[{"updn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}]}], ")"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"\[Delta]", ",", "ups", ",", "dns"}], "]"}], "A"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Lowers", " ", "all", " ", 
     RowBox[{"{", 
      RowBox[{"Tensor", ",", "xPartialDu", ",", "xCovariantDu"}], "}"}], " ", 
     "upper", " ", "indices", " ", "from_", " ", "to", " ", "lower", " ", 
     "indices", " ", "to_", " ", "in", " ", "exp_", "  ", "25", "Mar2012"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LowerIndexTU", "[", 
       RowBox[{"from_", ",", "to_"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"LowerIndex", "[", 
           RowBox[{"from", ",", "to"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a_", ",", "u_List", ",", "d_List"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"LowerIndex", "[", 
                RowBox[{"from", ",", "to"}], "]"}], "[", 
               RowBox[{"Tensor", "[", 
                RowBox[{"a", ",", "u", ",", "d"}], "]"}], "]"}], "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"u", ",", "from"}], "]"}]}]}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xPartialDu", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{"a", ",", "to"}], "]"}], "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"b", ",", "from"}], "]"}]}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xCovariantDu", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"xCovariantD", "[", 
             RowBox[{"a", ",", "to"}], "]"}], "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"b", ",", "from"}], "]"}]}]}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Raises", " ", "all", " ", 
     RowBox[{"{", 
      RowBox[{"Tensor", ",", "xPartialD", ",", "xCovariantD"}], "}"}], " ", 
     "lower", " ", "indices", " ", "from_", " ", "to", " ", "upper", " ", 
     "indices", " ", "to_", " ", "in", " ", "exp_", "  ", "25", "Mar2012"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RaiseIndexTU", "[", 
       RowBox[{"from_", ",", "to_"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"RaiseIndex", "[", 
           RowBox[{"from", ",", "to"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a_", ",", "u_List", ",", "d_List"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"RaiseIndex", "[", 
                RowBox[{"from", ",", "to"}], "]"}], "[", 
               RowBox[{"Tensor", "[", 
                RowBox[{"a", ",", "u", ",", "d"}], "]"}], "]"}], "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"d", ",", "from"}], "]"}]}]}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"xPartialDu", "[", 
             RowBox[{"a", ",", "to"}], "]"}], "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"b", ",", "from"}], "]"}]}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xCovariantD", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"xCovariantDu", "[", 
             RowBox[{"a", ",", "to"}], "]"}], "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"b", ",", "from"}], "]"}]}]}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Alternative", " ", "List", " ", "form", " ", "to", " ", 
     RowBox[{"above", ".", "  ", "25"}], "Mar2012"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LowerIndexTU1", "[", 
       RowBox[{"from_List", ",", "to_List"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "i", ",", "sub"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"LowerIndexTU", "[", 
           RowBox[{"from", ",", "to"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#2", "[", "#1", "]"}], "&"}], ",", "tmp", ",", "sub"}], 
         "]"}]}]}], "  ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Alternative", " ", "List", " ", "form", " ", "to", " ", 
     RowBox[{"above", ".", "  ", "25"}], "Mar2012"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RaiseIndexTU1", "[", 
       RowBox[{"from_List", ",", "to_List"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "i", ",", "sub"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"RaiseIndexTU", "[", 
           RowBox[{"from", ",", "to"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#2", "[", "#1", "]"}], "&"}], ",", "tmp", ",", "sub"}], 
         "]"}]}]}], "  ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Replace", " ", "all", " ", 
     RowBox[{"{", 
      RowBox[{
      "Tensor", ",", "xPartialD", ",", "xCovariantD", ",", "PartialD"}], 
      "}"}], " ", "indices", " ", "from_", " ", "to", " ", "indices", " ", 
     "to_", " ", "in", " ", "exp_", "  ", "25", "Mar2012"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ReplaceIndexTU", "[", 
       RowBox[{"from_", ",", "to_"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "sub"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sub", "[", "func_", "]"}], ":=", 
         RowBox[{
          RowBox[{"func", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"func", "[", 
            RowBox[{"a", ",", "to"}], "]"}], "/;", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"b", ",", "from"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"from", ",", "to"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"a_", ",", "u_List", ",", "d_List"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{
              RowBox[{
               RowBox[{"ReplaceIndex", "[", 
                RowBox[{"from", ",", "to"}], "]"}], "[", 
               RowBox[{"Tensor", "[", 
                RowBox[{"a", ",", "u", ",", "d"}], "]"}], "]"}], "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{
                 RowBox[{"u", "|", "d"}], ",", "from"}], "]"}]}]}]}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"sub", "[", "xPartialD", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"sub", "[", "xPartialDu", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"sub", "[", "xCovariantD", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"sub", "[", "xCovariantDu", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "//.", 
            RowBox[{"PartialD", "->", "PartialDx"}]}], "//.", 
           RowBox[{
            RowBox[{"PartialDx", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
            RowBox[{
             RowBox[{"PartialDx", "[", 
              RowBox[{"a", ",", "to"}], "]"}], "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"b", ",", "from"}], "]"}]}]}]}]}], "//.", 
          RowBox[{"PartialDx", "->", "PartialD"}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Swaps", " ", "up"}], "-", 
      RowBox[{
      "down", " ", "index", " ", "including", " ", "xPartialD", " ", 
       "derivative", " ", 
       RowBox[{"index", ".", "  ", "index_"}]}]}], " ", "->", " ", 
     RowBox[{"only", " ", "one", " ", 
      RowBox[{"index", ".", " ", "\[IndentingNewLine]", "Does"}], " ", "not", 
      " ", "check", " ", "for", " ", 
      RowBox[{"pairing", ".", "  ", "LowerIndex"}], " ", "and", " ", 
      "RaiseIndex", " ", "FAILS", " ", "if", " ", "index", " ", "is", " ", 
      "not", " ", "found", " ", "and", " ", "does", " ", "not", " ", "check", 
      " ", "for", " ", 
      RowBox[{
       RowBox[{"flavor", "@", "index"}], "."}]}]}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"UpDownIndexSwap", "[", "index_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "XXXX", ",", "YYYY"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"LowerIndexTU", "[", 
           RowBox[{"index", ",", "XXXX"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"RaiseIndexTU", "[", 
           RowBox[{"index", ",", "YYYY"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{"XXXX", "\[Rule]", "index"}]}], "/.", 
          RowBox[{"YYYY", "\[Rule]", "index"}]}]}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Swaps", " ", "a", " ", "list", " ", "of", " ", "up"}], "-", 
     RowBox[{
     "down", " ", "index", " ", "including", " ", "xPartialD", " ", 
      "derivative", " ", "index"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SwapUpDownIndices", "[", "indices_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"UpDownIndexSwap", "[", "#2", "]"}], "[", "#1", "]"}], 
           "&"}], ",", "exp", ",", "indices"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Eliminates", " ", "index", " ", "m_", " ", "from", " ", "exp_", " ", 
      "containing", " ", 
      RowBox[{
       RowBox[{"\[Delta]uu", "[", 
        RowBox[{"m_", ",", "n"}], "]"}], ".", "  ", "NEEDS"}], " ", 
      "expanding", " ", "to", " ", "\[Delta]ud"}], ",", " ", "\[Delta]du", 
     ",", " ", 
     RowBox[{
      RowBox[{"\[Delta]dd", ".", "  ", "A"}], " ", "strick", " ", "version", 
      " ", "would", " ", "check", " ", "for", " ", "proper", " ", "up", " ", 
      "and", " ", "down", " ", 
      RowBox[{"indices", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify\[Delta]uu", "[", 
      RowBox[{"exp_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", 
         RowBox[{"ind", "=", "m"}], ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<Simplify\[Delta]uu\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp1", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"a_", " ", 
                 RowBox[{"\[Delta]uu", "[", 
                  RowBox[{"m", ",", "b_"}], "]"}]}], ":>", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a", "/.", 
                   RowBox[{"m", "->", "b"}]}], ")"}], "/;", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"{", "a", "}"}], ",", "m"}], "]"}]}], "&&", 
                  RowBox[{"m", "=!=", "b"}]}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a_", " ", 
                 RowBox[{"\[Delta]uu", "[", 
                  RowBox[{"b_", ",", "m"}], "]"}]}], ":>", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a", "/.", 
                   RowBox[{"m", "->", "b"}]}], ")"}], "/;", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"{", "a", "}"}], ",", "m"}], "]"}]}], "&&", 
                  RowBox[{"m", "=!=", "b"}]}]}]}]}], "\[IndentingNewLine]", 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"IfDEBUG", "[", 
            RowBox[{"mname", ",", 
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "tmp"}], "}"}], ",", "\"\<{m,tmp}\>\""}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Simple", " ", "index", " ", "swapping", " ", "routine", " ", "across", 
      " ", 
      RowBox[{"xPartialD", ".", "  ", 
       SuperscriptBox["A", "m"]}], " ", 
      RowBox[{"xPartialD", "[", 
       RowBox[{
        SubscriptBox["A", "m"], ",", "n"}], "]"}]}], "->", " ", 
     RowBox[{
      SubscriptBox["A", "m"], " ", 
      RowBox[{
       RowBox[{"xPartialD", "[", 
        RowBox[{
         SuperscriptBox["A", "m"], ",", "n"}], "]"}], ".", "  ", "WARNING"}], 
      " ", "there", " ", "are", " ", "no", " ", 
      RowBox[{"checks", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RaiseIndexInxPartialD", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mName", "=", "\"\<RaiseIndexInxPartialD\>\""}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "exp", "}"}], ",", "\"\<input\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{
           RowBox[{"c_", " ", 
            RowBox[{"xPartialD", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{"SwapIndexPartialD", "[", 
            RowBox[{"{", 
             RowBox[{"c", ",", "a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{
           RowBox[{"c_", " ", 
            RowBox[{"xCovariantD", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{"SwapIndexPartialD", "[", 
            RowBox[{"{", 
             RowBox[{"c", ",", "a", ",", "b"}], "}"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<tmp\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Swaps", " ", "indices", " ", "in", " ", "list", " ", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["A", "m"], ",", 
        SubscriptBox["A", "m"], ",", "mu"}], "}"}]}], "->", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["A", "m"], 
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{
          SuperscriptBox["A", "m"], ",", "mu"}], "]"}], ".", "  ", "Only"}], 
       " ", "one", " ", "way"}], "->", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"NEEDS", " ", "two"}], "-", 
       RowBox[{"way", " ", "swap"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SwapIndexPartialD", "[", "list_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexdown", ",", 
         RowBox[{"tmp1", "=", "list"}], ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mName", "=", "\"\<SwapIndexPartialD\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indexdown", "=", 
         RowBox[{
          RowBox[{"ParseTermIndices", "[", 
           RowBox[{"tmp1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"tmp1", ",", "indexdown"}], "}"}], ",", 
          "\"\<tmp1,indexdown\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indexdown", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"indexdown", "=", 
            RowBox[{"First", "[", "indexdown", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tmp1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"tmp1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "//", 
             RowBox[{"LowerIndex", "[", 
              RowBox[{"indexdown", ",", "indexdown"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tmp1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"tmp1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "//", 
             RowBox[{"RaiseIndex", "[", 
              RowBox[{"indexdown", ",", "indexdown"}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp1", "}"}], ",", "\"\<tmp1\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"xPartialD", "[", 
          RowBox[{
           RowBox[{"tmp1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"tmp1", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Lowers", " ", "all", " ", 
      RowBox[{"xPartialDu", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}]}], "->", 
     RowBox[{
      RowBox[{"guu", "[", 
       RowBox[{
        RowBox[{"dum", "[", "b", "]"}], ",", "b"}], "]"}], 
      RowBox[{"xPartialD", "[", 
       RowBox[{"a", ",", 
        RowBox[{"dum", "[", "b", "]"}]}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xPartialDuLower", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{
        RowBox[{"MetricContractG", "[", 
         RowBox[{"exp", "/.", 
          RowBox[{
           RowBox[{"xPartialDu", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{"a", ",", 
              RowBox[{"dum", "[", "b", "]"}]}], "]"}], 
            RowBox[{"guu", "[", 
             RowBox[{
              RowBox[{"dum", "[", "b", "]"}], ",", "b"}], "]"}]}]}]}], "]"}], 
        "/.", 
        RowBox[{
         RowBox[{"dum", "[", "a_", "]"}], "\[Rule]", "a"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"g", " ", "Tensor", " ", 
     RowBox[{"contractions", ".", "  ", "Replaced"}], " ", "by", " ", 
     RowBox[{
      RowBox[{"MetricContract", "[", "g_", "]"}], "[", "exp_", "]"}], " ", 
     "except", " ", "for", " ", "Dimension"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractG", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"guu", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gud", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"guu", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"c_", ",", "a_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gud", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"guu", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gud", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"x", "\[IndentingNewLine]", 
         RowBox[{"guu", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"c_", ",", "a_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gud", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gud", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdd", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gud", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"c_", ",", "a_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdd", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gdu", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdd", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gdu", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], 
         RowBox[{"gdd", "[", 
          RowBox[{"c_", ",", "a_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdd", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gud", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], 
         RowBox[{"gdu", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdu", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gud", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], 
         RowBox[{"gud", "[", 
          RowBox[{"c_", ",", "a_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdu", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gdu", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], 
         RowBox[{"gdu", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdu", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"gdu", "[", 
          RowBox[{"b_", ",", "a_"}], "]"}], 
         RowBox[{"gud", "[", 
          RowBox[{"c_", ",", "a_"}], "]"}]}], "\[Rule]", 
        RowBox[{"gdu", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gdu", "[", 
         RowBox[{"a_", ",", "a_"}], "]"}], "\[Rule]", "4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gud", "[", 
         RowBox[{"a_", ",", "a_"}], "]"}], "\[Rule]", "4"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Simple", " ", "metric", " ", 
      RowBox[{"(", 
       RowBox[{"guu", ",", "gdd", ",", "gud", ",", "gdu"}], ")"}], " ", 
      "index", " ", "contraction", " ", 
      RowBox[{"routine", ".", " ", 
       RowBox[{"guu", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], 
      RowBox[{"Addd", "[", 
       RowBox[{"c", ",", "a", ",", "d"}], "]"}]}], "->", " ", 
     RowBox[{
      RowBox[{"Adud", "[", 
       RowBox[{"c", ",", "b", ",", "d"}], "]"}], " ", "Replaced", " ", "by", 
      " ", 
      RowBox[{
       RowBox[{"MetricContract", "[", "g_", "]"}], "[", "exp_", "]"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricContractG", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "pos", ",", "i", ",", 
         
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"tmp", "=!=", "tmp1"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", "ContractG"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "c", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "d", "}"}], ",", 
                   RowBox[{"pos", "->", "Void"}]}], "]"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", "d___", "}"}], "f"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "c", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "Void"}]}], "]"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "d", "}"}], ",", 
                   RowBox[{"pos", "->", "a"}]}], "]"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"{", "c", "}"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "d", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "c", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                 RowBox[{"{", "d", "}"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"for", " ", "tensors", " ", "with", " ", 
             RowBox[{"arg", "@", "uements"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", 
                    RowBox[{"pos", "->", "Void"}]}], "]"}]}], "]"}], "[", 
                "arg", "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "Void"}]}], "]"}], ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", 
                    RowBox[{"pos", "->", "a"}]}], "]"}]}], "]"}], "[", "arg", 
                "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"{", "c", "}"}], ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}]}], "]"}], "[", "arg", "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                  RowBox[{"{", "d", "}"}]}], "]"}], "[", "arg", "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
                StyleBox["CR",
                 FontSlant->"Italic"], "[", "\"\<MetricContractG: \>\"", 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"tmp", ",", "pos"}], "}"}]}], "]"}]}], "]"}], ";"}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Simple", " ", "metric", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "@", "uu"}], ",", 
        RowBox[{"g", "@", "dd"}], ",", 
        RowBox[{"g", "@", "ud"}], ",", 
        RowBox[{"g", "@", "du"}]}], ")"}], " ", "index", " ", "contraction", 
      " ", 
      RowBox[{"routine", ".", " ", 
       RowBox[{"g", "@", 
        RowBox[{"uu", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}], 
      RowBox[{"Addd", "[", 
       RowBox[{"c", ",", "a", ",", "d"}], "]"}]}], "->", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Adud", "[", 
        RowBox[{"c", ",", "b", ",", "d"}], "]"}], ".", " ", "Replaced"}], " ",
       "by", " ", 
      RowBox[{
       RowBox[{"MatricContract", "[", "g_", "]"}], "[", "exp_", "]"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricContractG", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "pos", ",", "i", ",", 
         
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"tmp", "=!=", "tmp1"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", "ContractG"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "c", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "d", "}"}], ",", 
                   RowBox[{"pos", "->", "Void"}]}], "]"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", "d___", "}"}], "f"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "c", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "Void"}]}], "]"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "d", "}"}], ",", 
                   RowBox[{"pos", "->", "a"}]}], "]"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"{", "c", "}"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "d", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{"Tensor", "[", 
                RowBox[{"T_", ",", 
                 RowBox[{"{", "c___", "}"}], ",", 
                 RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"T", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"{", "c", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                 RowBox[{"{", "d", "}"}]}], "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"for", " ", "tensors", " ", "with", " ", "arguements"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"uu", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", 
                    RowBox[{"pos", "->", "Void"}]}], "]"}]}], "]"}], "[", 
                "arg", "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"dd", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "Void"}]}], "]"}], ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", 
                    RowBox[{"pos", "->", "a"}]}], "]"}]}], "]"}], "[", "arg", 
                "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"{", "c", "}"}], ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "d", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}]}], "]"}], "[", "arg", "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"g", "@", 
                  RowBox[{"ud", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}]}], "|", 
                 RowBox[{"g", "@", 
                  RowBox[{"du", "[", 
                   RowBox[{"b_", ",", "a_"}], "]"}]}]}], ")"}], 
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T_", ",", 
                  RowBox[{"{", "c___", "}"}], ",", 
                  RowBox[{"{", "d___", "}"}]}], "]"}], "[", "arg___", "]"}]}],
               ":>", 
              RowBox[{
               RowBox[{
                RowBox[{"Tensor", "[", 
                 RowBox[{"T", ",", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"{", "c", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                     "a"}]}], "]"}], ",", 
                  RowBox[{"{", "d", "}"}]}], "]"}], "[", "arg", "]"}], "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
                StyleBox["CR",
                 FontSlant->"Italic"], "[", "\"\<MetricContractG: \>\"", 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"tmp", ",", "pos"}], "}"}]}], "]"}]}], "]"}], ";"}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Contracts", " ", "metric", " ", "tensor"}], ",", " ", "g_", ",",
      " ", 
     RowBox[{"in", " ", "exp_", " ", "where", " ", 
      RowBox[{"possible", ".", "  ", "DOES"}], " ", "NOT", " ", "RECOGNIZE", 
      " ", "g_."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Does", " ", "not", " ", "handle", " ", 
     RowBox[{"g", "[", 
      RowBox[{"i", ",", "j"}], "]"}], 
     RowBox[{"fn", "[", 
      RowBox[{
       RowBox[{"a", "[", "i", "]"}], "+", 
       RowBox[{"b", "[", "i", "]"}]}], "]"}], " ", "like", " ", "expressions",
      " ", "Replaced", " ", 
     RowBox[{"MatricContract", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MetricContractGexp", "[", "g_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"exp1", "=", "exp"}], ",", "tmp", ",", "tmp1", ",", "tmp2", 
         ",", "pos", ",", "ipos", ",", "tmpp", ",", "tmpp1", ",", "posg", ",",
          "iposg", ",", "indexg", ",", "post", ",", "ipost", ",", "gUsed"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "First", " ", "do", " ", "simple", " ", "g", " ", "contractions"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp1", "=", 
         RowBox[{
          RowBox[{"Expand", "[", "exp1", "]"}], "//", "MetricContractG"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "extract", " ", "g_", " ", "products", " ", "assuming", " ", 
          RowBox[{"g", "'"}], "s", " ", "are", " ", "not", " ", 
          RowBox[{"embedded", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp1", ",", 
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", "_", ",", "_"}], "]"}], ",", "b___"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ipos", "=", "1"}], ",", 
          RowBox[{"ipos", "\[LessEqual]", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"ipos", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpp1", "=", 
            RowBox[{"tmpp", "=", 
             RowBox[{"pos", "[", 
              RowBox[{"[", 
               RowBox[{"ipos", ",", "2"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"posg", "=", 
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{"tmpp", ",", 
              RowBox[{"Tensor", "[", 
               RowBox[{"g", ",", "_", ",", "_"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Go", " ", "through", " ", "and", " ", "contract", " ", "each", 
             " ", "g", " ", "Tensor", " ", "in", " ", "product", " ", 
             "tmpp"}], "  ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"iposg", "=", "1"}], ",", 
             RowBox[{"iposg", "\[LessEqual]", 
              RowBox[{"Length", "[", "posg", "]"}]}], ",", 
             RowBox[{"iposg", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "eliminate", " ", "one", " ", "g", " ", "and", " ", "test", " ",
                "for", " ", "possible", " ", "summing", " ", "Tensors", 
               RowBox[{"(", 
                RowBox[{"may", " ", "include", " ", "other", " ", 
                 RowBox[{"g", "'"}], "s"}], ")"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmpp1", "=", 
               RowBox[{"tmpp1", "/.", 
                RowBox[{
                 RowBox[{"Last", "[", " ", 
                  RowBox[{"posg", "[", 
                   RowBox[{"[", "iposg", "]"}], "]"}], " ", "]"}], "\[Rule]", 
                 "1"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Examine", " ", "remaining", " ", "Tensors", 
                RowBox[{"(", 
                 RowBox[{"possibly", " ", "imbedded"}], ")"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"post", "=", 
               RowBox[{"ExtractPositionPattern", "[", 
                RowBox[{"tmpp1", ",", 
                 RowBox[{"Tensor", "[", 
                  RowBox[{"_", ",", "_", ",", "_"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"List", "[", 
               RowBox[{"\"\<post:\>\"", ",", "post"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"gUsed", "=", "posg"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"ipost", "=", "1"}], ",", 
                RowBox[{"ipost", "\[LessEqual]", 
                 RowBox[{"Length", "[", "post", "]"}]}], ",", 
                RowBox[{"ipost", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"tmp", "=", 
                  RowBox[{
                   RowBox[{"post", "[", 
                    RowBox[{"[", 
                    RowBox[{"ipost", ",", "2"}], "]"}], "]"}], 
                   RowBox[{"posg", "[", 
                    RowBox[{"[", 
                    RowBox[{"iposg", ",", "2"}], "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tmp1", "=", 
                  RowBox[{"tmp", "//", "MetricContractG"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"tmp", "=!=", "tmp1"}], ",", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"If", " ", "contracted"}], ",", " ", 
                    RowBox[{
                    "store", " ", "new", " ", "and", " ", "do", " ", "not", 
                    " ", "use", " ", "g", " ", "again"}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"post", "[", 
                    RowBox[{"[", 
                    RowBox[{"ipost", ",", "2"}], "]"}], "]"}], "=", "tmp1"}], 
                    ";", 
                    RowBox[{
                    RowBox[{"gUsed", "[", 
                    RowBox[{"[", 
                    RowBox[{"iposg", ",", "2"}], "]"}], "]"}], "=", "1"}], 
                    ";", 
                    RowBox[{
                    RowBox[{"posg", "[", 
                    RowBox[{"[", 
                    RowBox[{"iposg", ",", "2"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"tmpp1", "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"tmpp1", ",", "post"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"Map", "[", 
               RowBox[{"Last", ",", "gUsed"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"ipos", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"tmp", " ", "tmpp1"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"exp1", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"exp1", ",", "pos"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Simple", " ", "metric", " ", "g_", " ", "index", " ", "contraction", 
      " ", 
      RowBox[{"routine", ".", "  ", "E", ".", "G", ".", " ", 
       RowBox[{"guu", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], 
      RowBox[{"Addd", "[", 
       RowBox[{"c", ",", "a", ",", "d"}], "]"}]}], "->", " ", 
     RowBox[{
      RowBox[{"Adud", "[", 
       RowBox[{"c", ",", "b", ",", "d"}], "]"}], " ", "25", 
      RowBox[{"Mar2012", ".", "\[IndentingNewLine]", "Avoids"}], " ", 
      "problem", " ", "with", " ", "xPartialD", " ", "when", " ", "using", 
      " ", 
      RowBox[{"MetricSimplify", "[", "g", "]"}]}]}], "   ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MetricContract", "[", "g_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "pos", ",", "i", ",", 
         
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"uds", "=", 
          RowBox[{"{", 
           RowBox[{
           "\"\<uu\>\"", ",", "\"\<ud\>\"", ",", "\"\<du\>\"", ",", 
            "\"\<dd\>\""}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"RaiseIndexTU", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "a"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"RaiseIndexTU", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "b"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceIndexTU", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "a"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceIndexTU", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "b"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceIndexTU", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "a"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceIndexTU", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "b"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"LowerIndexTU", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "a"}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"g", ",", 
              RowBox[{"uds", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], "rest_"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"LowerIndexTU", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "[", "rest", "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ParseTermIndices", "[", "rest", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "b"}], 
             "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Adds", " ", 
      RowBox[{"contraction", ":", " ", 
       RowBox[{
        RowBox[{"gud", "[", 
         RowBox[{"a_", ",", "a_"}], "]"}], " ", "|", " ", 
        RowBox[{"gdu", "[", 
         RowBox[{"a_", ",", "a_"}], "]"}]}]}]}], "->", " ", 
     RowBox[{"dimension", " ", "27", "Mar2012"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MetricContract", "[", 
       RowBox[{"g_", ",", "dimension_"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"MetricContract", "[", "g", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"g", ",", "\"\<ud\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"a_", ",", "a_"}], "}"}]}], "]"}], "->", 
             "dimension"}], ",", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"g", ",", "\"\<du\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"a_", ",", "a_"}], "}"}]}], "]"}], "->", 
             "dimension"}]}], "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Wick", " ", "rotation", " ", "of", " ", "Vector", " ", "contractions"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VectorContractWickSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"{", "\[Mu]_", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}], 
         RowBox[{"Tensor", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "\[Mu]_", "}"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tensor", "[", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
             RowBox[{"{", "Void", "}"}]}], "]"}]}], 
          RowBox[{"Tensor", "[", 
           RowBox[{"b", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"{", "\[Mu]_", "}"}], ",", 
            RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c_", "]"}], 
         RowBox[{"Tensor", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "\[Mu]_", "}"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
              RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c", "]"}]}], 
          RowBox[{"Tensor", "[", 
           RowBox[{"b", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"{", "\[Mu]_", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}], 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"b_", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", "\[Mu]_", "}"}]}], "]"}], "[", "c_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tensor", "[", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
             RowBox[{"{", "Void", "}"}]}], "]"}]}], 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"b", ",", 
             RowBox[{"{", "Void", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}], "[", "c", 
           "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"{", "\[Mu]_", "}"}], ",", 
            RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c_", "]"}], 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"b_", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", "\[Mu]_", "}"}]}], "]"}], "[", "d_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
              RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c", "]"}]}], 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"b", ",", 
             RowBox[{"{", "Void", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}], "[", "d", 
           "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}]}], "\[IndentingNewLine]",
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "ExpandSpaceTimeIndex", " ", "sums", " ", "indices", " ", "in", " ", 
      "index_List", " ", "of", " ", "exp_", " ", "over", " ", "time", " ", 
      "and", " ", "space", " ", "indices", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "such", " ", "that", " ", "the", " ", "result", " ", "is", " ", 
       RowBox[{"p", "[", "0", "]"}], 
       RowBox[{"p", "[", "0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], 
       RowBox[{"p", "[", "1", "]"}], " ", "where", " ", 
       RowBox[{
        RowBox[{"timespace", "@", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], ".", "  ", "This"}], " ", 
       "routine", " ", "is", " ", "to", " ", "facilitate", " ", "time", " ", 
       "and", " ", "spatial", " ", "vector", " ", 
       RowBox[{"notation", ".", "  ", "Note"}], " ", "the", " ", "index", " ",
        "arguement", " ", "does", " ", "not", " ", "need", " ", "timespace", 
       " ", 
       RowBox[{"flavor", ".", " ", 
        RowBox[{"BUG", ":", " ", 
         RowBox[{
         "does", " ", "not", " ", "accept", " ", "indices", " ", "in", " ", 
          "functional", " ", 
          RowBox[{"form", ".", " ", 
           RowBox[{"NOTE", ":", " ", 
            RowBox[{"Use", " ", 
             RowBox[{"EinsteinSum", "[", "]"}], " ", 
             RowBox[{"instead", "!!"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExpandSpaceTimeIndex", "[", "index_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "indexST", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<ExpandSpaceTimeIndex\>\""}]}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indexST", "=", 
         RowBox[{"timespace", "/@", "index"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"indexST", ",", "exp"}], "}"}], ",", 
          "\"\<{indexST,exp}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[Rule]", 
              RowBox[{"timespace", "@", "#"}]}], "&"}], ",", "index"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"timespace", "@", 
            RowBox[{"timespace", "@", "i_"}]}], "->", 
           RowBox[{"timespace", "@", "i"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tmp", "]"}], "===", "Rule"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{
              RowBox[{"SumExpansion", "[", "indexST", "]"}], "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"List", ",", "tmp"}], "]"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//", 
            RowBox[{"SumExpansion", "[", "indexST", "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"IndexChange", "->", "IndexChangeTU"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"In", " ", "case", " ", "IndexChange", " ", "fails"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp1}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"g", "->", "\[Eta]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Sums", " ", "over", " ", "indexRange"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], " ", "in", " ", "expression",
       " ", "exp_.", "  ", "Preprocesses", " ", "with", " ", "DotExpand", " ",
       "and", " ", 
      RowBox[{"Expand", ".", "  ", "Does"}], " ", "not", " ", "check", " ", 
      "proper", " ", "reference", " ", "to", " ", 
      RowBox[{"index", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SumIndex", "[", "indexRange_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"out", "=", "0"}], ",", 
         RowBox[{"index", "=", 
          RowBox[{"First", "[", "indexRange", "]"}]}], ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<SumIndex\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"exp", "//.", "DotExpand"}], "//", "Expand"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", "tmp", ",", 
            RowBox[{"Length", "[", "tmp", "]"}]}], "}"}], ",", 
          "\"\<index,tmp,Length[tmp]\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"$i", "=", "1"}], ",", 
          RowBox[{"$i", "<=", 
           RowBox[{"Length", "[", "tmp", "]"}]}], ",", 
          RowBox[{"$i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$t", "=", 
            RowBox[{"tmp", "[", 
             RowBox[{"[", "$i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"IfDEBUG", "[", 
            RowBox[{"mname", ",", 
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"index", ",", "$t"}], "}"}], ",", "\"\<index,t\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"$t", ",", "index"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$t", "=", 
               RowBox[{"Sum", "[", 
                RowBox[{"$t", ",", "indexRange"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"IfDEBUG", "[", 
               RowBox[{"mname", ",", 
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"{", 
                 RowBox[{"$i", ",", "$t"}], "}"}], ",", "\"\<$i,$t\>\""}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out", "+=", "$t"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rotates", " ", "indices", " ", "in", " ", "index_List", " ", "of", " ", 
      "exp_", " ", "n_", " ", 
      RowBox[{"times", ".", " ", "e", ".", "g", "."}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"RotateIndex", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", "2"}], "]"}], "[", 
       RowBox[{"A", "[", 
        RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "->", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"k", ",", "i", ",", "j"}], "]"}], ".", "  ", "n"}], ">", 
       RowBox[{"0", " ", "Rotates", " ", "left"}]}]}], ",", " ", 
     RowBox[{"n", "<", 
      RowBox[{"0", " ", "Rotates", " ", 
       RowBox[{"right", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RotateIndex", "[", 
       RowBox[{"index_List", ",", "n_Integer"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "cycle", ",", 
         RowBox[{"nindex", "=", "index"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{"Abs", "[", "n", "]"}]}], ",", "sub"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cycle", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "index", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">", "0"}], ",", 
          RowBox[{"cycle", "=", 
           RowBox[{"Reverse", "[", "cycle", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "  ", 
         RowBox[{
          RowBox[{"nindex", "=", 
           RowBox[{"Permute", "[", 
            RowBox[{"nindex", ",", 
             RowBox[{"Cycles", "[", 
              RowBox[{"{", "cycle", "}"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", "nn", "}"}]}], "  ", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", "nindex"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", "sub"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Prepends", " ", "index", " ", "val_", " ", "in", " ", "du_", " ", 
     "position", " ", "to", " ", "Tensor", " ", "t_.", "  ", "3", "Apr2012"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PrependIndex", "[", 
      RowBox[{"t_Tensor", ",", "du_", ",", "val_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"du", "===", "\"\<d\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "Void"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "val"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"du", "===", "\"\<u\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "val"}], " ", "]"}]}], 
           ";", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "Void"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"Tensor", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"AddUpIndex", "[", 
       RowBox[{"uploc_", ",", "upvalue_"}], "]"}], "[", "tensor_Tensor", 
      "]"}], " ", "add", " ", "up", " ", "index", " ", "in", " ", "tensor_", 
     " ", "at", " ", "location", " ", "uploc_", " ", "with", " ", "value", 
     " ", 
     RowBox[{"upvalue_", " ", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AddUpIndex", "[", 
       RowBox[{"uploc_", ",", "upvalue_"}], "]"}], "[", "tensor_Tensor", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"uplist", ",", "dnlist"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"uplist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"uplist", ",", "upvalue", ",", "uploc"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"dnlist", ",", "Void", ",", "uploc"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "uplist", ",", "dnlist"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"AddDnIndex", "[", 
       RowBox[{"dnloc_", ",", "dnvalue_"}], "]"}], "[", "tensor_Tensor", 
      "]"}], " ", "add", " ", "down", " ", "index", " ", "in", " ", "tensor_",
      " ", "at", " ", "location", " ", "dnloc_", " ", "with", " ", "value", 
     " ", 
     RowBox[{"dnvalue_", " ", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AddDnIndex", "[", 
      RowBox[{"dnloc_", ",", "dnvalue_"}], "]"}], "[", "tensor_Tensor", "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"uplist", ",", "dnlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"uplist", "=", 
        RowBox[{"tensor", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dnlist", "=", 
        RowBox[{"tensor", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"uplist", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"uplist", ",", "Void", ",", "dnloc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dnlist", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"dnlist", ",", "dnvalue", ",", "dnloc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", 
        RowBox[{
         RowBox[{"tensor", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "uplist", ",", "dnlist"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"AddUpDnDum", "[", "tensor_Tensor", "]"}], " ", "adds", " ", 
      "corresponding", " ", "up"}], ",", 
     RowBox[{"dn", " ", "a_", " ", "index", " ", "to", " ", 
      RowBox[{"dum", "[", "a_", "]"}], " ", "indices"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AddUpDnDum", "[", "tensor_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "tensor"}], ",", "tmpc"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpc", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"dum", "[", "_", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"AddDnIndex", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"tmpc", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "tmp", "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tmpc", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmpc", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"dum", "[", "_", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"AddUpIndex", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"tmpc", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "tmp", "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tmpc", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteIndex", "[", "loc_", "]"}], "[", "tensor_Tensor", "]"}], 
     " ", "deletes", " ", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"loc_", "[", "]"}], " ", "index", " ", "in", " ", "tensor"}], 
      " "}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DeleteIndex", "[", "loc_Integer", "]"}], "[", "tensor_Tensor", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"uplist", ",", "dnlist"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"uplist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"uplist", ",", "loc"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"dnlist", ",", "loc"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "uplist", ",", "dnlist"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DeleteIndex", "[", "ind_", "]"}], "[", "tensor_Tensor", "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "uplist", ",", "dnlist", ",", "uppos", ",", "dnpos", ",", "delete"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"uplist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", "ind"}], "]"}], ",", 
              RowBox[{"delete", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], 
           ",", "uplist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uppos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"uplist", ",", 
           RowBox[{"delete", "[", "_", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"uplist", ",", "uppos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"dnlist", ",", "uppos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", "ind"}], "]"}], ",", 
              RowBox[{"delete", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], 
           ",", "dnlist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnpos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"dnlist", ",", 
           RowBox[{"delete", "[", "_", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"uplist", ",", "dnpos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"dnlist", ",", "dnpos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "uplist", ",", "dnlist"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteIndexExcept", "[", "ind_", "]"}], "[", "tensor_Tensor", 
      "]"}], " ", "deletes", " ", "indices", " ", "of", " ", "tensor_", " ", 
     "that", " ", "match", " ", "ind_"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DeleteIndexExcept", "[", "ind_", "]"}], "[", "tensor_Tensor", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "uplist", ",", "dnlist", ",", "uppos", ",", "dnpos", ",", "delete"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"uplist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"tensor", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"uplist", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"{", "#", "}"}], ",", "ind"}], "]"}]}], "&&", 
                RowBox[{"#", "=!=", "Void"}]}], ",", 
               RowBox[{"delete", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], 
            ",", "uplist"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uppos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"uplist", ",", 
           RowBox[{"delete", "[", "_", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"uplist", ",", "uppos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"dnlist", ",", "uppos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", "#", "}"}], ",", "ind"}], "]"}]}], "&&", 
               RowBox[{"#", "=!=", "Void"}]}], ",", 
              RowBox[{"delete", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], 
           ",", "dnlist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dnpos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"dnlist", ",", 
           RowBox[{"delete", "[", "_", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uplist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"uplist", ",", "dnpos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dnlist", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"dnlist", ",", "dnpos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "uplist", ",", "dnlist"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"TensorIndex\[Delta]", 
      RowBox[{
       RowBox[{"{", "tensor_List", "}"}], "[", "exp_", "]"}], " ", "changes", 
      " ", "Tensors"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{"Auu", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", " ", 
     RowBox[{"in", " ", "tensor_List"}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"Auu", "[", 
       RowBox[{"i", ",", "l_", ",", "m_"}], "]"}], "}"}], ",", "  ", 
     RowBox[{"where", " ", "the", " ", "Patterns"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"l_", ",", "m_"}], "}"}], ",", " ", 
     RowBox[{"indicates", " ", "indices", " ", "to", " ", "act", " ", "on"}], 
     ",", " ", 
     RowBox[{"to", " ", "form", " ", 
      RowBox[{
       RowBox[{"Auu", "[", 
        RowBox[{"i", ",", 
         RowBox[{"dum", "[", "j", "]"}], ",", 
         RowBox[{"dum", "[", "k", "]"}]}], "]"}], " ", ".", " ", 
       RowBox[{"\[Delta]du", "[", 
        RowBox[{
         RowBox[{"dum", "[", "j", "]"}], ",", "j"}], "]"}], " ", ".", " ", 
       RowBox[{"\[Delta]du", "[", 
        RowBox[{
         RowBox[{"dum", "[", "k", "]"}], ",", "k"}], "]"}]}], " ", "where", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dum", "[", "j", "]"}], ",", 
        RowBox[{"dum", "[", "k", "]"}]}], "}"}], " ", "represent", " ", 
      "Einstein", " ", "summed", " ", 
      RowBox[{"indices", ".", "  ", "The"}], " ", "purpose", " ", "of", " ", 
      "this", " ", "function", " ", "is", " ", "to", " ", "transform", " ", 
      "exp_", " ", "to", " ", "a", " ", "form", " ", "that", " ", "allows", 
      " ", "EinsteinSum", " ", "expressions", " ", "to", " ", "be", " ", 
      "functionally", " ", "differentiated", " ", "by", " ", "Mathematica", 
      " ", "properly", " ", "in", " ", "Tensor", " ", 
      RowBox[{"expressions", ".", "  ", "The"}], " ", "action", " ", "of", 
      " ", "\[Delta]", " ", "will", " ", "yield", " ", "proper", " ", 
      RowBox[{"form", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Tensor\[Delta]Index", "[", "tensor_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", 
         RowBox[{"(*", 
          RowBox[{
          "apply", " ", "on", " ", "each", " ", "Times", " ", "term"}], 
          "*)"}], ",", "\[IndentingNewLine]", "sub", ",", "sub1", ",", "sub0",
          ",", "f1", ",", "dd"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tensor:\>\"", ",", "tensor"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"change", " ", "Tensor"}], "\[Rule]", " ", 
          RowBox[{"\[Delta]", ".", "Tensor"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
              
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"\[Delta]", ",", "b", 
                 StyleBox[",",
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True], 
                 StyleBox["c",
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True]}], 
                StyleBox["]",
                 ShowSpecialCharacters->False,
                 ShowStringCharacters->True,
                 NumberMarks->True]}], 
               StyleBox[".",
                ShowSpecialCharacters->False,
                ShowStringCharacters->True,
                NumberMarks->True], 
               RowBox[{"Tensor", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}]}], "&"}], ",", 
           "tensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{"Pattern", "\[Rule]", "xPattern"}]}], "/.", 
          RowBox[{
           RowBox[{"xPattern", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"Blank", "[", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{"dum", "[", "a", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Delta]", ",", "a_", ",", "b_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{
            RowBox[{"SwapUpDownIndices", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"dum", "[", "_", "]"}]}], "]"}], ",", 
                RowBox[{"Cases", "[", 
                 RowBox[{"b", ",", 
                  RowBox[{"dum", "[", "_", "]"}]}], "]"}]}], "}"}], "]"}], 
             "]"}], "[", 
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "a", ",", "b"}], "]"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Delta]", ",", "a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"DeleteIndexExcept", "[", 
             RowBox[{"dum", "[", "_", "]"}], "]"}], "[", 
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "a", ",", "b"}], "]"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"\[Delta]", ",", "a_", ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"AddUpDnDum", "[", 
            RowBox[{"Tensor", "[", 
             RowBox[{"\[Delta]", ",", "a", ",", "b"}], "]"}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"tensor", ",", "tmp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"exp", "/.", "sub"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Changes", " ", "all", " ", "indices", " ", "of", " ", "tensor_Tensor", 
     " ", "to", " ", 
     RowBox[{"Pattern", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorIndexPattern", "[", "tensor_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "up", ",", "dn"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"up", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "=!=", "Pattern"}], "&&", 
               RowBox[{"#", "=!=", "Void"}]}], ",", 
              RowBox[{"Pattern", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Blank", "[", "]"}]}], "]"}], ",", "#"}], "]"}], 
            "&"}], ",", 
           RowBox[{"tensor", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dn", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "=!=", "Pattern"}], "&&", 
               RowBox[{"#", "=!=", "Void"}]}], ",", 
              RowBox[{"Pattern", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Blank", "[", "]"}]}], "]"}], ",", "#"}], "]"}], 
            "&"}], ",", 
           RowBox[{"tensor", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "up", ",", "dn"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Converts", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"fn_", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "up", "]"}], ",", 
         RowBox[{"\[Nu]", "[", "dn", "]"}], ",", "..."}], "]"}], ",", 
       RowBox[{"\[Mu]", "[", "up", "]"}], ",", 
       RowBox[{"\[Nu]", "[", "dn", "]"}], ",", "..."}], "]"}], " ", "form", 
     " ", "\[IndentingNewLine]", "to", " ", 
     RowBox[{"xPartialD", "[", 
      RowBox[{
       RowBox[{"xPartialDu", "[", 
        RowBox[{"fn", ",", "\[Mu]"}], "]"}], ",", "\[Nu]"}], "]"}], " ", 
     RowBox[{"form", ".", "\[IndentingNewLine]", 
      RowBox[{"Usage", ":", " ", 
       RowBox[{
        RowBox[{"D2xPartialD", "[", "exp", "]"}], "\[IndentingNewLine]", "12",
         "Apr2012"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D2xPartialD", "[", "exp_", "]"}], ":=", 
    RowBox[{"exp", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Derivative", "\[Rule]", "xDerivative"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xDerivative", "[", "n__", "]"}], "[", "A_", "]"}], "[", 
         "i__", "]"}], ":>", 
        RowBox[{"D2xPartialD1", "[", 
         RowBox[{
          RowBox[{"{", "n", "}"}], ",", "A", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D2xPartialD1", "[", 
      RowBox[{"dslot_List", ",", "var_", ",", "updn_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "Ds"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"List", "[", 
           RowBox[{"dslot", ",", "updn"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ds", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"List", "[", 
            RowBox[{"0", ",", "_"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"no", " ", "derivative"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Fold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FreeQ", "[", 
               RowBox[{"#2", ",", "up"}], "]"}], ",", 
              RowBox[{"xPartialD", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"Head", "[", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"xPartialDu", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"Head", "[", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
            "&"}], ",", "var", ",", "Ds"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Eliminate", " ", "next", " ", "arguement", " ", "in", " ", "exp_", " ",
        "\[IndentingNewLine]", 
       RowBox[{"Usage", ":", " ", 
        RowBox[{
         RowBox[{"EliminateArguments", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "[", "a_", "]"}], ",", " ", 
            RowBox[{"B", "[", "a_", "]"}]}], "}"}], "]"}], "[", 
         RowBox[{"exp_", " ", "with", " ", 
          RowBox[{
           RowBox[{"A", "[", "a", "]"}], "[", "b", "]"}], " ", 
          RowBox[{
           RowBox[{"B", "[", "d", "]"}], "[", "e", "]"}]}], " ", "]"}]}]}], "->", 
      RowBox[{
       RowBox[{"A", "[", "a", "]"}], 
       RowBox[{"B", "[", "d", "]"}], "\[IndentingNewLine]", "Needs", " ", 
       "named", " ", "patterns"}]}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{"a_", "   ", "\[IndentingNewLine]", " ", "12", "Apr2012"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"EliminateArguments", "[", "var_List", "]"}], "[", "exp_", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sub", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"tmp", "=", "exp"}], ",", "XXX"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"sub", ",", 
               RowBox[{
                RowBox[{"#1", "[", "arg__", "]"}], "\[Rule]", 
                RowBox[{"XXX", "[", 
                 RowBox[{"#2", ",", 
                  RowBox[{"RemovePatterns", "[", "#1", "]"}]}], "]"}]}]}], 
              "]"}], "&"}], ",", "var"}], "]"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "//.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"XXX", "[", 
            RowBox[{"n_", ",", "A_"}], "]"}], "\[Rule]", "A"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Computes", " ", "Euler", " ", "equations", " ", "from", " ", 
      "Lagrangian_", " ", "in", " ", "Tensor", " ", "notation", " ", "for", 
      " ", "var_List", 
      RowBox[{"(", "indices", ")"}], " ", "and", " ", "field_List", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"implicit", " ", "functions", " ", "of", " ", "var_List"}], 
        ")"}], ".", " ", "E", ".", "G", "."}]}], ":", " ", 
     RowBox[{
      RowBox[{"EulerEquationsTensor", "[", 
       RowBox[{"tmpL", ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Auu", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ",", 
          RowBox[{"Aud", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}]}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", "12", "Apr2012", " ", "PROBLEM", " ", "with", 
      " ", "indices"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EulerEquationsTensor", "[", 
      RowBox[{"Lagrangian_", ",", "var_List", ",", "field_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"vars", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"fields", "=", 
          RowBox[{"{", "}"}]}], ",", "sub"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"vars", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", "up", "]"}], ",", 
               RowBox[{"#", "[", "dn", "]"}]}], "}"}]}], "]"}], "&"}], ",", 
          "var"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vars", "=", 
         RowBox[{"Flatten", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Apply", "[", 
                RowBox[{
                 RowBox[{"RemovePatterns", "[", "#", "]"}], ",", "vars"}], 
                "]"}]}], "}"}], "&"}], ",", "field"}], "]"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fields", "=", 
         RowBox[{"field", "/.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Lagrangian", "//", 
          RowBox[{"xPartialD2Dupdn", "[", 
           RowBox[{"var", ",", "field"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"EulerEquations", "[", 
          RowBox[{"tmp", ",", "fields", ",", "vars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "D2xPartialD"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"EliminateArguments", "[", "field", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LowerTensorIndexByG", "[", 
        RowBox[{"tensor_List", ",", "G_"}], "]"}], "[", "exp_", "]"}], " ", 
      "lower", " ", "indices", " ", "of", " ", "Tensor", " ", "variables", 
      " ", "in", " ", "exp_", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"by", " ", "assuming", " ", "the", " ", "metric"}], ",", " ", 
        "G_", ",", " ", 
        RowBox[{"lowers", " ", "indices"}]}], ")"}], " ", "specified", " ", 
      "in", " ", "tensor_List", " ", "of", " ", "only", " ", "the", " ", 
      "indices", " ", "specified", " ", "as", " ", 
      RowBox[{"patterns", ".", " ", "The"}], " ", "result", " ", "is", " ", 
      "the", " ", "tensor_List", " ", "variables", " ", "Dotted", " ", "with",
       " ", "the", " ", "metric"}], ",", " ", "G_", ",", " ", 
     RowBox[{"and", " ", "the", " ", "specified", " ", "indices", " ", 
      RowBox[{"lowered", ".", "  ", "The"}], " ", "summed", " ", "indices", 
      " ", "are", " ", "specified", " ", "by", " ", 
      RowBox[{"dum", "[", "]"}], " ", 
      RowBox[{"indices", ".", "  ", "The"}], " ", "purpose", " ", "of", " ", 
      "this", " ", "routine", " ", "is", " ", "allow", " ", "for", " ", "the",
       " ", "differential", " ", "of", " ", "expressions", " ", "that", " ", 
      "have", " ", "variables", " ", "that", " ", "differ", " ", "by", " ", 
      "a", " ", "metric", " ", "index", " ", 
      RowBox[{"change", ".", "  ", "eg", "."}]}], ",", " ", 
     RowBox[{
     "the", " ", "TEST", " ", "below", " ", "generates", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        InterpretationBox[
         SubsuperscriptBox["A", 
          RowBox[{
           StyleBox["a",
            StripOnInput->False,
            ShowContents->False], "\[Mu]_"}], 
          RowBox[{"a", 
           StyleBox["\[Mu]_",
            StripOnInput->False,
            ShowContents->False]}]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, {$CellContext`a, 
           TensorCalculus4V6`Tensorial`Void}, {
          TensorCalculus4V6`Tensorial`Void, 
           Pattern[$CellContext`\[Mu], 
            Blank[]]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False], ",", 
        InterpretationBox[
         SubsuperscriptBox["B", 
          StyleBox[
           RowBox[{"f", "g_", "h_"}],
           StripOnInput->False,
           ShowContents->False], 
          RowBox[{"f", "g_", "h_"}]],
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, {$CellContext`f, 
           Pattern[$CellContext`g, 
            Blank[]], 
           Pattern[$CellContext`h, 
            Blank[]]}, {
          TensorCalculus4V6`Tensorial`Void, TensorCalculus4V6`Tensorial`Void, 
           TensorCalculus4V6`Tensorial`Void}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "}"}], "\n", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\"\<\[PartialD]\>\"", "_"], "e"], "[", 
        InterpretationBox[
         RowBox[{
          TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"e"},
           "Superscript"], "[", 
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["A", 
             RowBox[{
              StyleBox["a",
               StripOnInput->False,
               ShowContents->False], "b"}], 
             RowBox[{"a", 
              StyleBox["b",
               StripOnInput->False,
               ShowContents->False]}]],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
             TensorCalculus4V6`Tensorial`Void, $CellContext`b}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["A", 
             StyleBox[
              RowBox[{"c", "d"}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"c", "d"}]],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`d}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], " ", 
           InterpretationBox[
            SubsuperscriptBox["B", 
             StyleBox[
              RowBox[{"f", "g", "h"}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"f", "g", "h"}]],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, \
{$CellContext`f, $CellContext`g, $CellContext`h}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], "]"}],
         $CellContext`xPartialDu[(
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, {$CellContext`a,
               TensorCalculus4V6`Tensorial`Void}, {
             TensorCalculus4V6`Tensorial`Void, $CellContext`b}] 
           TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`d}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}]) 
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, {$CellContext`f, \
$CellContext`g, $CellContext`h}, {
            TensorCalculus4V6`Tensorial`Void, 
             TensorCalculus4V6`Tensorial`Void, 
             TensorCalculus4V6`Tensorial`Void}], $CellContext`e],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialDu[(
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, {$CellContext`a, 
             TensorCalculus4V6`Tensorial`Void}, {
            TensorCalculus4V6`Tensorial`Void, $CellContext`b}] 
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, {$CellContext`c, \
$CellContext`d}, {
            TensorCalculus4V6`Tensorial`Void, 
             TensorCalculus4V6`Tensorial`Void}]) 
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, {$CellContext`f, \
$CellContext`g, $CellContext`h}, {
           TensorCalculus4V6`Tensorial`Void, TensorCalculus4V6`Tensorial`Void,
             TensorCalculus4V6`Tensorial`Void}], $CellContext`e], \
$CellContext`e],
       Editable->False,
       SyntaxForm->Automatic], "\n", 
      InterpretationBox[
       RowBox[{
        SubscriptBox[
         UnderscriptBox["\"\<\[PartialD]\>\"", "_"], "e"], "[", 
        InterpretationBox[
         RowBox[{
          TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"e"},
           "Superscript"], "[", 
          RowBox[{
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["g", 
              StyleBox[
               RowBox[{"a", 
                RowBox[{"dum", "[", "\[Mu]", "]"}]}],
               StripOnInput->False,
               ShowContents->False], 
              RowBox[{"a", 
               RowBox[{"dum", "[", "\[Mu]", "]"}]}]],
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, \
{$CellContext`a, 
               $CellContext`dum[$CellContext`\[Mu]]}, {
              TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ".", 
            InterpretationBox[
             SubsuperscriptBox["A", 
              RowBox[{
               StyleBox["a",
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"dum", "[", "\[Mu]", "]"}]}], 
              RowBox[{"a", 
               StyleBox[
                RowBox[{"dum", "[", "\[Mu]", "]"}],
                StripOnInput->False,
                ShowContents->False]}]],
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
              TensorCalculus4V6`Tensorial`Void, 
               $CellContext`dum[$CellContext`\[Mu]]}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], " ", 
           RowBox[{
            InterpretationBox[
             SubsuperscriptBox["g", 
              StyleBox[
               RowBox[{"f", 
                RowBox[{"dum", "[", "g", "]"}], 
                RowBox[{"dum", "[", "h", "]"}]}],
               StripOnInput->False,
               ShowContents->False], 
              RowBox[{"f", 
               RowBox[{"dum", "[", "g", "]"}], 
               RowBox[{"dum", "[", "h", "]"}]}]],
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, \
{$CellContext`f, 
               $CellContext`dum[$CellContext`g], 
               $CellContext`dum[$CellContext`h]}, {
              TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False], ".", 
            InterpretationBox[
             SubsuperscriptBox["B", 
              RowBox[{
               StyleBox["f",
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"dum", "[", "g", "]"}], 
               RowBox[{"dum", "[", "h", "]"}]}], 
              RowBox[{"f", 
               StyleBox[
                RowBox[{"dum", "[", "g", "]"}],
                StripOnInput->False,
                ShowContents->False], 
               StyleBox[
                RowBox[{"dum", "[", "h", "]"}],
                StripOnInput->False,
                ShowContents->False]}]],
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, \
{$CellContext`f, TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void}, {
              TensorCalculus4V6`Tensorial`Void, 
               $CellContext`dum[$CellContext`g], 
               $CellContext`dum[$CellContext`h]}],
             BaseStyle->{AutoMultiplicationSymbol -> False},
             Editable->False]}], " ", 
           InterpretationBox[
            SubsuperscriptBox["A", 
             StyleBox[
              RowBox[{"c", "d"}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"c", "d"}]],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`d}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], "]"}],
         $CellContext`xPartialDu[(Dot[
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, \
{$CellContext`a, 
               $CellContext`dum[$CellContext`\[Mu]]}, {
              TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void}], 
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
              TensorCalculus4V6`Tensorial`Void, 
               $CellContext`dum[$CellContext`\[Mu]]}]] Dot[
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, \
{$CellContext`f, 
               $CellContext`dum[$CellContext`g], 
               $CellContext`dum[$CellContext`h]}, {
              TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void}], 
             
             TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, \
{$CellContext`f, TensorCalculus4V6`Tensorial`Void, 
               TensorCalculus4V6`Tensorial`Void}, {
              TensorCalculus4V6`Tensorial`Void, 
               $CellContext`dum[$CellContext`g], 
               $CellContext`dum[$CellContext`h]}]]) 
          TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, {$CellContext`c, \
$CellContext`d}, {
            TensorCalculus4V6`Tensorial`Void, 
             TensorCalculus4V6`Tensorial`Void}], $CellContext`e],
         Editable->False,
         SyntaxForm->Automatic], "]"}],
       $CellContext`xPartialD[
        $CellContext`xPartialDu[(Dot[
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, \
{$CellContext`a, 
              $CellContext`dum[$CellContext`\[Mu]]}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}], 
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
             TensorCalculus4V6`Tensorial`Void, 
              $CellContext`dum[$CellContext`\[Mu]]}]] Dot[
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, \
{$CellContext`f, 
              $CellContext`dum[$CellContext`g], 
              $CellContext`dum[$CellContext`h]}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}], 
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`B, \
{$CellContext`f, TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}, {
             TensorCalculus4V6`Tensorial`Void, 
              $CellContext`dum[$CellContext`g], 
              $CellContext`dum[$CellContext`h]}]]) 
         TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, {$CellContext`c, \
$CellContext`d}, {
           TensorCalculus4V6`Tensorial`Void, 
            TensorCalculus4V6`Tensorial`Void}], $CellContext`e], \
$CellContext`e],
       Editable->False,
       SyntaxForm->Automatic]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LowerTensorIndexByG", "[", 
       RowBox[{"tensor_List", ",", "G_"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "\[IndentingNewLine]", "sub", ",", "sub1", ",", "sub0", 
         ",", "f1", ",", "dd"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tensor:\>\"", ",", "tensor"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"change", " ", "Tensor"}], "\[Rule]", " ", 
          RowBox[{"\[Delta]", ".", "Tensor"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
              
              RowBox[{
               RowBox[{"Tensor", "[", 
                RowBox[{"G", ",", "b", 
                 StyleBox[",",
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True], 
                 StyleBox["c",
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True]}], 
                StyleBox["]",
                 ShowSpecialCharacters->False,
                 ShowStringCharacters->True,
                 NumberMarks->True]}], 
               StyleBox[".",
                ShowSpecialCharacters->False,
                ShowStringCharacters->True,
                NumberMarks->True], 
               RowBox[{"Tensor", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}]}], "&"}], ",", 
           "tensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{"Pattern", "\[Rule]", "xPattern"}]}], "/.", 
          RowBox[{
           RowBox[{"xPattern", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"Blank", "[", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{"dum", "[", "a", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"G", ",", "a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"SwapUpDownIndices", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"dum", "[", "_", "]"}]}], "]"}], ",", 
                RowBox[{"Cases", "[", 
                 RowBox[{"b", ",", 
                  RowBox[{"dum", "[", "_", "]"}]}], "]"}]}], "}"}], "]"}], 
             "]"}], "[", 
            RowBox[{"Tensor", "[", 
             RowBox[{"G", ",", "a", ",", "b"}], "]"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"G", ",", "a_", ",", "b_"}], "]"}], ".", " ", 
            RowBox[{"Tensor", "[", 
             RowBox[{"A_", ",", "c_", ",", "d_"}], "]"}]}], "\[RuleDelayed]", 
           " ", 
           RowBox[{
            RowBox[{"SwapUpDownIndices", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"Cases", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"dum", "[", "_", "]"}]}], "]"}], "}"}], "]"}], "]"}],
             "[", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"G", ",", "a", ",", "b"}], "]"}], ".", 
             RowBox[{"Tensor", "[", 
              RowBox[{"A", ",", "c", ",", "d"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"tensor", ",", "tmp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"exp", "/.", "tmp"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"apply", " ", "on", " ", "each", " ", "Times", " ", "term"}], 
       "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"TEST", "\[IndentingNewLine]", "tmpf"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Aud", "[", 
          RowBox[{"a", ",", "\[Mu]_"}], "]"}], ",", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"B", ",", "\"\<uuu\>\""}], "]"}], "[", 
          RowBox[{"f", ",", " ", "g_", ",", "h_"}], "]"}]}], "}"}], 
       "\[IndentingNewLine]", "tmp"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{
          RowBox[{"xPartialDu", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Aud", "[", 
              RowBox[{"a", ",", "b"}], "]"}], " ", 
             RowBox[{"Auu", "[", 
              RowBox[{"c", ",", "d"}], "]"}], 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"B", ",", "\"\<uuu\>\""}], "]"}], "[", 
              RowBox[{"f", ",", " ", "g", ",", "h"}], "]"}]}], ",", "e"}], 
           "]"}], ",", "e"}], "]"}], "\[IndentingNewLine]", "tmp"}], "//", 
       RowBox[{"LowerTensorIndexByG", "[", 
        RowBox[{"tmpf", ",", "g"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4773475527375298`*^9, 3.4773475563534527`*^9}, {
   3.477347607736083*^9, 3.477347839895226*^9}, {3.477348592243739*^9, 
   3.477348600614975*^9}, {3.477448632110298*^9, 3.477448639124702*^9}, {
   3.4774918324627247`*^9, 3.47749193807034*^9}, {3.477493235651927*^9, 
   3.477493265446851*^9}, {3.477493313311185*^9, 3.477493338835821*^9}, {
   3.477493428011973*^9, 3.4774934420025454`*^9}, {3.477493474119735*^9, 
   3.477493541691545*^9}, {3.483021025987207*^9, 3.483021136253598*^9}, {
   3.48302457945413*^9, 3.483024764529106*^9}, {3.483024829133518*^9, 
   3.48302486654644*^9}, {3.483061592449636*^9, 3.483061592883586*^9}, {
   3.483062097089625*^9, 3.483062132179064*^9}, 3.483062175222599*^9, {
   3.4830622357506227`*^9, 3.483062243788485*^9}, {3.4830623044705133`*^9, 
   3.4830623319887238`*^9}, 3.4830623798722467`*^9, {3.483062503647481*^9, 
   3.483062516318101*^9}, {3.483062617673452*^9, 3.483062619317124*^9}, {
   3.483062667122568*^9, 3.483062683439186*^9}, {3.4830628111592703`*^9, 
   3.4830629145926323`*^9}, 3.4830629501845903`*^9, {3.483063017611247*^9, 
   3.4830630612373343`*^9}, {3.483063197916462*^9, 3.4830631988224173`*^9}, {
   3.483063284317224*^9, 3.483063301475482*^9}, {3.4830633904753647`*^9, 
   3.483063391164227*^9}, {3.48306346843407*^9, 3.483063498077379*^9}, 
   3.483098743936537*^9, {3.483099047833047*^9, 3.483099135932027*^9}, {
   3.4830992067438707`*^9, 3.483099210146801*^9}, 3.4831113098470573`*^9, {
   3.483450236992702*^9, 3.483450250499073*^9}, {3.4834569901232243`*^9, 
   3.4834569920798197`*^9}, {3.4834570321718807`*^9, 3.483457079331951*^9}, {
   3.4834650797414923`*^9, 3.483465179898631*^9}, {3.4834652099246387`*^9, 
   3.483465224123583*^9}, {3.483885935469056*^9, 3.483885946728286*^9}, {
   3.483885991611189*^9, 3.48388605282976*^9}, {3.483886099151863*^9, 
   3.483886128498919*^9}, {3.483886167753994*^9, 3.483886168807313*^9}, 
   3.484386650641533*^9, {3.485008276617268*^9, 3.485008276965513*^9}, {
   3.4850083613180723`*^9, 3.48500839771801*^9}, {3.485008498713109*^9, 
   3.485008506781095*^9}, {3.485009380579104*^9, 3.485009382901163*^9}, {
   3.485009466480328*^9, 3.4850094666379557`*^9}, {3.485009511232153*^9, 
   3.485009511826047*^9}, {3.485009660043062*^9, 3.485009929329794*^9}, {
   3.485009993036661*^9, 3.485010032552452*^9}, {3.485701876394525*^9, 
   3.485701928410376*^9}, {3.4857035249070883`*^9, 3.4857035579785643`*^9}, {
   3.486470050600711*^9, 3.486470065149267*^9}, {3.4892429819870253`*^9, 
   3.4892430159803677`*^9}, {3.4892430981717567`*^9, 3.489243113237883*^9}, 
   3.489243169139188*^9, {3.489243400507052*^9, 3.489243412222768*^9}, {
   3.489243467650465*^9, 3.4892434737074127`*^9}, {3.489243560129139*^9, 
   3.489243592187311*^9}, {3.48924366089962*^9, 3.4892436773773727`*^9}, {
   3.489243720696258*^9, 3.4892437448344707`*^9}, {3.489243908859886*^9, 
   3.489243914388681*^9}, {3.489243965805348*^9, 3.48924398761734*^9}, 
   3.489244035933426*^9, {3.489328776097574*^9, 3.489328776864964*^9}, 
   3.490196031174026*^9, {3.490207116087491*^9, 3.49020715504417*^9}, {
   3.490207799543187*^9, 3.4902079255811567`*^9}, {3.4902083033209763`*^9, 
   3.490208313840423*^9}, {3.490208391760701*^9, 3.490208399185895*^9}, {
   3.490208513515875*^9, 3.490208526831757*^9}, {3.4902854423114777`*^9, 
   3.49028546019949*^9}, {3.490285496451221*^9, 3.490285501205297*^9}, {
   3.490285549398183*^9, 3.4902856854256287`*^9}, {3.4913625328459387`*^9, 
   3.491362545352215*^9}, {3.491590726778767*^9, 3.49159072784554*^9}, {
   3.4915914132012873`*^9, 3.49159142221922*^9}, {3.493431308078826*^9, 
   3.4934313913183613`*^9}, {3.505768191844952*^9, 3.5057681926445208`*^9}, {
   3.506184054437717*^9, 3.5061840557781982`*^9}, {3.506185238128063*^9, 
   3.506185288282537*^9}, {3.5061853283816557`*^9, 3.506185380961844*^9}, {
   3.506185637076065*^9, 3.506185642478634*^9}, {3.5061856772691717`*^9, 
   3.5061857237740507`*^9}, {3.506185779450569*^9, 3.506185800344137*^9}, {
   3.506185841637734*^9, 3.5061858443699837`*^9}, {3.5061858988142*^9, 
   3.506185984251598*^9}, {3.506186017309053*^9, 3.506186038961521*^9}, {
   3.5061871713987503`*^9, 3.506187197854344*^9}, {3.5062076240463037`*^9, 
   3.506207629339205*^9}, 3.506207796001915*^9, {3.506207848455763*^9, 
   3.506208013603314*^9}, {3.50639707932187*^9, 3.50639714080936*^9}, {
   3.506397213985841*^9, 3.506397223633387*^9}, {3.506428840636155*^9, 
   3.506428883639*^9}, {3.509404606996077*^9, 3.509404609986002*^9}, {
   3.509404684864975*^9, 3.5094046855345373`*^9}, {3.509411950076603*^9, 
   3.509411977160742*^9}, 3.509412024213531*^9, {3.509421005899817*^9, 
   3.509421028213688*^9}, {3.511097525178762*^9, 3.511097525584671*^9}, {
   3.5110978087721567`*^9, 3.511097810315488*^9}, {3.5129122453353786`*^9, 
   3.512912353900557*^9}, {3.5129601254286137`*^9, 3.512960126584834*^9}, {
   3.512960282377557*^9, 3.51296030403082*^9}, {3.512996867067947*^9, 
   3.512996887797282*^9}, {3.518187279012389*^9, 3.518187402510453*^9}, {
   3.519308637732916*^9, 3.51930865812565*^9}, 3.519308805426991*^9, {
   3.519353056980612*^9, 3.519353219769009*^9}, {3.519358964643111*^9, 
   3.519359031724902*^9}, {3.51935906317253*^9, 3.519359170516951*^9}, {
   3.519359251585491*^9, 3.519359256221977*^9}, {3.521551778528284*^9, 
   3.521551783551043*^9}, {3.521551975879752*^9, 3.521552030956285*^9}, {
   3.521552078741207*^9, 3.521552080464204*^9}, {3.524614804522451*^9, 
   3.5246148075454073`*^9}, {3.541514349954072*^9, 3.541514364590913*^9}, {
   3.541521955867853*^9, 3.5415219751672297`*^9}, {3.5415247125096684`*^9, 
   3.54152478984624*^9}, 3.541525770262753*^9, 3.541525804627961*^9, {
   3.541525877390984*^9, 3.5415259211793747`*^9}, {3.541526563354025*^9, 
   3.5415265814952793`*^9}, {3.541526758522801*^9, 3.5415268281782093`*^9}, {
   3.5417736810176563`*^9, 3.541773702041376*^9}, {3.541773913673313*^9, 
   3.54177393221026*^9}, {3.541774061811198*^9, 3.541774095182458*^9}, {
   3.541774762355134*^9, 3.5417748684279013`*^9}, {3.5417749404478703`*^9, 
   3.541774977745161*^9}, {3.541780584677578*^9, 3.5417806414657288`*^9}, {
   3.541780675912524*^9, 3.54178072410386*^9}, {3.541780939855069*^9, 
   3.541780964596154*^9}, {3.5419380053927794`*^9, 3.541938010313105*^9}, 
   3.5419380677842293`*^9, {3.5419382666641073`*^9, 3.541938331126294*^9}, {
   3.541938366319418*^9, 3.541938402883648*^9}, {3.541938448613525*^9, 
   3.5419384776899233`*^9}, {3.541938516225391*^9, 3.541938517423751*^9}, {
   3.541938847816327*^9, 3.54193886052556*^9}, {3.5419391695455837`*^9, 
   3.541939353583143*^9}, 3.541939402440724*^9, {3.541939433288899*^9, 
   3.5419395366431217`*^9}, {3.541939814453328*^9, 3.5419398587619677`*^9}, {
   3.541939890896982*^9, 3.541939895589965*^9}, {3.541939939401165*^9, 
   3.5419399620945997`*^9}, {3.541940001143775*^9, 3.541940018864416*^9}, {
   3.542460098878603*^9, 3.542460105938076*^9}, {3.5424601661327953`*^9, 
   3.542460169873371*^9}, {3.54248631488757*^9, 3.542486378062258*^9}, 
   3.542742163980897*^9, {3.543257185502894*^9, 3.543257188717368*^9}, {
   3.543258649074502*^9, 3.5432588597768593`*^9}, {3.543258902743141*^9, 
   3.5432589137755547`*^9}, {3.543259439919633*^9, 3.5432594890191193`*^9}, {
   3.5432862635757933`*^9, 3.5432864686657877`*^9}, {3.5432866745904408`*^9, 
   3.543286682506959*^9}, {3.543845801386444*^9, 3.543845894820036*^9}, {
   3.543845934667591*^9, 3.543845972846985*^9}, {3.543846882875828*^9, 
   3.543846897226985*^9}, 3.5438477787107067`*^9, {3.543847810572941*^9, 
   3.5438478172201*^9}, 3.5438479998237753`*^9, {3.543856641116108*^9, 
   3.543856704385516*^9}, {3.543860406129293*^9, 3.543860412455711*^9}, {
   3.543860455307948*^9, 3.54386052023529*^9}, {3.543860692372998*^9, 
   3.543860699466415*^9}, 3.5438607595589457`*^9, {3.543860911816264*^9, 
   3.543860933636252*^9}, {3.543860971933166*^9, 3.543861031702873*^9}, {
   3.5438610752017117`*^9, 3.54386108080757*^9}, 3.543861119872243*^9, {
   3.5438611698552113`*^9, 3.543861253795089*^9}, {3.544203065437025*^9, 
   3.544203284890477*^9}, {3.544203320163192*^9, 3.544203464533681*^9}, {
   3.544203499049303*^9, 3.5442035973213787`*^9}, {3.5442037259800177`*^9, 
   3.544203886856305*^9}, {3.54420394033496*^9, 3.54420395351819*^9}, {
   3.544288971824896*^9, 3.544288992623136*^9}, {3.544326191309277*^9, 
   3.544326194727182*^9}, {3.544360510080388*^9, 3.544360513444187*^9}, {
   3.544360639616139*^9, 3.544360708663818*^9}, {3.5443607538086023`*^9, 
   3.5443607657504597`*^9}, {3.544360799929953*^9, 3.544360810685836*^9}, {
   3.5443611353775387`*^9, 3.544361155313676*^9}, {3.544361198115651*^9, 
   3.544361210285672*^9}, {3.544361629432232*^9, 3.5443617440760612`*^9}, {
   3.544361854739655*^9, 3.544361856000428*^9}, {3.544364612288782*^9, 
   3.544364640746969*^9}, {3.54436482173765*^9, 3.5443649674708967`*^9}, {
   3.544448377801079*^9, 3.544448382080002*^9}, {3.544448920307068*^9, 
   3.5444489838866587`*^9}, {3.544463301545121*^9, 3.54446333246749*^9}, {
   3.5444650868103333`*^9, 3.544465087752903*^9}, {3.5444659214255333`*^9, 
   3.54446592413341*^9}, 3.544476600627363*^9, {3.544526571350459*^9, 
   3.544526612980926*^9}, {3.544526766761381*^9, 3.5445269370327463`*^9}, {
   3.544526994073488*^9, 3.5445271434816103`*^9}, {3.544527177125853*^9, 
   3.544527322634919*^9}, {3.544527358770355*^9, 3.544527378002994*^9}, {
   3.5445274942401743`*^9, 3.544527497865752*^9}, {3.544527626354926*^9, 
   3.5445276425184927`*^9}, {3.544527746781517*^9, 3.544527917896962*^9}, {
   3.544527958067939*^9, 3.5445280587042093`*^9}, {3.544528118058004*^9, 
   3.544528221353538*^9}, {3.54452834827678*^9, 3.544528493314189*^9}, {
   3.544529475628793*^9, 3.544529485646245*^9}, {3.5445295192953176`*^9, 
   3.5445295220369787`*^9}, {3.544529567835415*^9, 3.544529626007925*^9}, {
   3.544529704147564*^9, 3.5445297228607492`*^9}, {3.54452976319534*^9, 
   3.5445297659173603`*^9}, {3.5447944183791103`*^9, 3.544794418762504*^9}, {
   3.5449139509234047`*^9, 3.5449139812598457`*^9}, {3.544914021746448*^9, 
   3.544914029854908*^9}, {3.544925747853654*^9, 3.544925786444316*^9}, {
   3.544925902787459*^9, 3.544925916392934*^9}, {3.5466098888269053`*^9, 
   3.546609911726308*^9}, {3.546610023369576*^9, 3.5466100242428427`*^9}, {
   3.546610096596222*^9, 3.546610134984069*^9}, {3.546781176086257*^9, 
   3.546781210375478*^9}, {3.546782010836919*^9, 3.546782117075982*^9}, {
   3.5467832481441927`*^9, 3.546783263184057*^9}, {3.54678334152181*^9, 
   3.546783348764505*^9}, {3.546783379209073*^9, 3.546783415752384*^9}, {
   3.546783802598967*^9, 3.546783820304635*^9}, {3.546784001829908*^9, 
   3.5467840092249613`*^9}, {3.54678490967599*^9, 3.5467849141664133`*^9}, {
   3.546785406966564*^9, 3.546785434193153*^9}, {3.546785491613348*^9, 
   3.54678549459608*^9}, {3.547869020035129*^9, 3.5478690844917707`*^9}, {
   3.547869129460802*^9, 3.547869175956581*^9}, {3.547869206369473*^9, 
   3.5478692670062933`*^9}, {3.548096150427466*^9, 3.5480961830087214`*^9}, {
   3.548096217535236*^9, 3.5480962516186533`*^9}, {3.548156352778963*^9, 
   3.5481564096644983`*^9}, {3.548162261625474*^9, 3.548162356469994*^9}, {
   3.548162398279325*^9, 3.548162452454236*^9}, {3.548162706539695*^9, 
   3.548162730467846*^9}, 3.54816298471115*^9, {3.548163045165983*^9, 
   3.548163054281245*^9}, {3.548163104036346*^9, 3.5481631498380127`*^9}, {
   3.548163214207891*^9, 3.548163250712479*^9}, {3.548163483189362*^9, 
   3.5481635158946753`*^9}, {3.548163579214087*^9, 3.5481635943548813`*^9}, 
   3.548166969519422*^9, {3.550406369372375*^9, 3.5504064639072113`*^9}, 
   3.550406919153273*^9, 3.550407606360365*^9, 3.55041145559824*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.551194717591329*^9}]
}, Open  ]],

Cell["Energy-Momentum tensors", "Text",
 CellChangeTimes->{{3.4774875997271137`*^9, 3.4774876451707582`*^9}, {
  3.4774877449202957`*^9, 3.477487751315998*^9}, {3.4774889083550587`*^9, 
  3.477488909767075*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Returns", " ", "Abelian", " ", "vector", " ", "boson", " ", "energy"}], 
     "-", 
     RowBox[{"momentum", " ", "tensor"}]}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Fdd", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ".", 
       RowBox[{"Fuu", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}], "/", "4"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"in", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F", ".", "F"}], ",", 
       RowBox[{"derivative", " ", "of", " ", "A", " ", "definition"}], ",", 
       " ", 
       RowBox[{"Fourier", " ", "transform", " ", "form"}]}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Fabelian", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tmp", ",", "subF", ",", "subFA", ",", "subA", ",", "F2", ",", "FA2", 
        ",", 
        RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{
        "i", ",", "k", ",", "a", ",", "b", ",", "c", ",", "\[Mu]", ",", 
         "\[Nu]"}], "]"}], ";", "\[IndentingNewLine]", "\"\<Abelian case\>\"",
        ";", "\[IndentingNewLine]", 
       RowBox[{"subF", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Fdd", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Ad", "[", "\[Nu]", "]"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Ad", "[", "\[Mu]", "]"}], ",", "\[Nu]"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Fuu", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"guu", "[", 
              RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}], 
             RowBox[{"xPartialD", "[", 
              RowBox[{
               RowBox[{"Au", "[", "\[Nu]", "]"}], ",", "\[Alpha]"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{
               RowBox[{"Au", "[", "\[Mu]", "]"}], ",", "\[Alpha]"}], "]"}], 
             RowBox[{"guu", "[", 
              RowBox[{"\[Alpha]", ",", "\[Nu]"}], "]"}]}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       "\"\< and Fourier transform \>\"", ";", "\[IndentingNewLine]", 
       RowBox[{"subA", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Ad", "[", "i_", "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", "k", "}"}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ad", "[", "i", "]"}], "[", "k", "]"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"k", ".", "x"}]}], "]"}]}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Au", "[", "i_", "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", "k", "}"}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"au", "[", "i", "]"}], "[", "k", "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", 
                RowBox[{"k", ".", "x"}]}], "]"}]}]}], "]"}]}]}], "}"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{"subF", "/.", "subA"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:subFA: \>\"", ",", "subFA"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{"subFA", "//", "ExchangexPartialDIntegralOp"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{
         RowBox[{"subFA", "/.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"a_", " ", 
              RowBox[{"Exp", "[", "b_", "]"}]}], ",", "c_"}], "]"}], "->", 
           RowBox[{"I", " ", 
            RowBox[{"kd", "[", "c", "]"}], " ", "a", " ", 
            RowBox[{"Exp", "[", "b", "]"}]}]}]}], "/.", "GatherIntOpSubs"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{"subFA", "//", "MetricContractG"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:subFA: \>\"", ",", "subFA"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], 
         RowBox[{
          RowBox[{"Fdd", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ".", 
          RowBox[{"Fuu", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Abelian", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"FA2", "=", 
        RowBox[{"F2", "/.", "subF"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:FA2: \>\"", ",", "FA2"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"F2", "/.", "subFA"}], "//", "ExpandAll"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:tmp: \>\"", ",", "tmp"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"a", "/.", 
              RowBox[{"k", "->", 
               RowBox[{"k", "[", "1", "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"kd", "[", "c_", "]"}], "->", 
              RowBox[{
               RowBox[{"kd", "[", "c", "]"}], "[", "1", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"b", "/.", 
              RowBox[{"k", "->", 
               RowBox[{"k", "[", "2", "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"kd", "[", "c_", "]"}], "->", 
              RowBox[{
               RowBox[{"kd", "[", "c", "]"}], "[", "2", "]"}]}]}]}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "/.", "IntDotInt2Int2"}], "/.", 
           RowBox[{"Dot", "->", "Times"}]}], "//.", "GatherIntOpSubs"}], "//",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:tmp: \>\"", ",", "tmp"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       "\"\<This integrated over x producing a delta function in k1-k2: (Done \
by hand.)\>\"", ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"k", "[", "2", "]"}], "->", 
           RowBox[{"k", "[", "1", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a_", ",", "b_"}], "}"}], ",", "c_"}], "]"}], "->", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"(", "c", ")"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], "->", "k"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a", ",", 
            RowBox[{"b", "//", "Expand"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a", ",", 
            RowBox[{"MapAt", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SwitchLabel", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], "&"}], ",",
               "b", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}]}], "]"}]}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ad", "[", "c_", "]"}], "->", 
            RowBox[{"Ad", "[", "c", "]"}]}], ",", 
           RowBox[{
            RowBox[{"au", "[", "c_", "]"}], "->", 
            RowBox[{"Au", "[", "c", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"F2", ",", "FA2", ",", "tmp"}], "}"}], "//.", 
        "simpleDot"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "uses", " ", "xPartialDu", " ", "instead", " ", "of", " ", "raising", " ",
      "and", " ", "lowering", " ", "indices", " ", "via", " ", 
     RowBox[{"metric", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Fabelian1", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tmp", ",", "subF", ",", "subFA", ",", "subA", ",", "F2", ",", "FA2", 
        ",", 
        RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{
        "i", ",", "k", ",", "a", ",", "b", ",", "c", ",", "\[Mu]", ",", 
         "\[Nu]"}], "]"}], ";", "\[IndentingNewLine]", "\"\<Abelian case\>\"",
        ";", "\[IndentingNewLine]", 
       RowBox[{"subF", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Fdd", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Ad", "[", "\[Nu]", "]"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Ad", "[", "\[Mu]", "]"}], ",", "\[Nu]"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Fuu", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"xPartialDu", "[", 
             RowBox[{
              RowBox[{"Au", "[", "\[Nu]", "]"}], ",", "\[Mu]"}], "]"}], "-", 
            RowBox[{"xPartialDu", "[", 
             RowBox[{
              RowBox[{"Au", "[", "\[Mu]", "]"}], ",", "\[Nu]"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       "\"\< and Fourier transform \>\"", ";", "\[IndentingNewLine]", 
       RowBox[{"subA", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Ad", "[", "i_", "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", "k", "}"}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ad", "[", "i", "]"}], "[", "k", "]"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"k", ".", "x"}]}], "]"}]}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Au", "[", "i_", "]"}], "->", 
           RowBox[{"IntegralOp", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", "k", "}"}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"au", "[", "i", "]"}], "[", "k", "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", 
                RowBox[{"k", ".", "x"}]}], "]"}]}]}], "]"}]}]}], "}"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{"subF", "/.", "subA"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "2"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:subFA 0: \>\"", ",", "subFA"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{"subFA", "//", "ExchangexPartialDIntegralOp"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subFA", "=", 
        RowBox[{
         RowBox[{"subFA", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{
               RowBox[{"a_", " ", 
                RowBox[{"Exp", "[", "b_", "]"}]}], ",", "c_"}], "]"}], "->", 
             RowBox[{"I", " ", 
              RowBox[{"kd", "[", "c", "]"}], " ", "a", " ", 
              RowBox[{"Exp", "[", "b", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"xPartialDu", "[", 
              RowBox[{
               RowBox[{"a_", " ", 
                RowBox[{"Exp", "[", "b_", "]"}]}], ",", "c_"}], "]"}], "->", 
             RowBox[{"I", " ", 
              RowBox[{"ku", "[", "c", "]"}], " ", "a", " ", 
              RowBox[{"Exp", "[", "b", "]"}]}]}]}], "}"}]}], "/.", 
         "GatherIntOpSubs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:subFA 1: \>\"", ",", "subFA"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"subFA", "=", 
          RowBox[{"subFA", "//", "MetricContractG"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DEBUG", ">", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Fabelian:subFA: \>\"", ",", "subFA"}], "]"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"F2", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], 
         RowBox[{
          RowBox[{"Fdd", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ".", 
          RowBox[{"Fuu", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Abelian", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"FA2", "=", 
        RowBox[{"F2", "/.", "subF"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:FA2: \>\"", ",", "FA2"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"F2", "/.", "subFA"}], "//", "ExpandAll"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:tmp 0: \>\"", ",", "tmp"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//", "ExchangexPartialDIntegralOp"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:tmp: \>\"", ",", "tmp"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"a", "/.", 
              RowBox[{"k", "->", 
               RowBox[{"k", "[", "1", "]"}]}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"kd", "[", "c_", "]"}], "->", 
                RowBox[{
                 RowBox[{"kd", "[", "c", "]"}], "[", "1", "]"}]}], ",", 
               RowBox[{
                RowBox[{"ku", "[", "c_", "]"}], "->", 
                RowBox[{
                 RowBox[{"ku", "[", "c", "]"}], "[", "1", "]"}]}]}], "}"}]}], 
            ",", 
            RowBox[{
             RowBox[{"b", "/.", 
              RowBox[{"k", "->", 
               RowBox[{"k", "[", "2", "]"}]}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"kd", "[", "c_", "]"}], "->", 
                RowBox[{
                 RowBox[{"kd", "[", "c", "]"}], "[", "2", "]"}]}], ",", 
               RowBox[{
                RowBox[{"ku", "[", "c_", "]"}], "->", 
                RowBox[{
                 RowBox[{"ku", "[", "c", "]"}], "[", "2", "]"}]}]}], 
              "}"}]}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:tmp 1: \>\"", ",", "tmp"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "/.", "IntDotInt2Int2"}], "/.", 
           RowBox[{"Dot", "->", "Times"}]}], "//.", "GatherIntOpSubs"}], "//",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Fabelian:tmp: \>\"", ",", "tmp"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       "\"\<This integrated over x producing a delta function in k1-k2: (Done \
by hand.)\>\"", ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"k", "[", "2", "]"}], "->", 
           RowBox[{"k", "[", "1", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a_", ",", "b_"}], "}"}], ",", "c_"}], "]"}], "->", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"(", "c", ")"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], "->", "k"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a", ",", 
            RowBox[{"b", "//", "Expand"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"a", ",", 
            RowBox[{"MapAt", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SwitchLabel", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], "&"}], ",",
               "b", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}]}], "]"}]}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ad", "[", "c_", "]"}], "->", 
            RowBox[{"Ad", "[", "c", "]"}]}], ",", 
           RowBox[{
            RowBox[{"au", "[", "c_", "]"}], "->", 
            RowBox[{"Au", "[", "c", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"F2", ",", "FA2", ",", "tmp"}], "}"}], "//.", 
        "simpleDot"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "Fabelian1", 
   RowBox[{"(*", "TEST", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"gaugeG", ",", "Blue"}], "}"}], "]"}], 
   RowBox[{"(*", "Placeholder", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AddBaseIndex", "[", 
    RowBox[{"{", 
     RowBox[{"gaugeG", ",", 
      RowBox[{"Range", "[", "8", "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"nonAbelianF", ",", "FFna"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Computes", " ", "non"}], "-", 
     RowBox[{
     "abelian", " ", "gauge", " ", "boson", " ", "energy", " ", "momentum", 
      " ", "tensor", " ", 
      RowBox[{"expressions", ".", " ", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"F", ".", "F"}], " ", "lagrangian", " ", "term"}], ",", " ",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"F", ".", "F"}], " ", "in", " ", "terms", " ", "of", " ", 
           RowBox[{"A", "'"}], 
           RowBox[{"s", ".", "\[IndentingNewLine]", "Resets"}], " ", 
           "BaseIndices", " ", "with", " ", 
           RowBox[{"Length", "[", " ", 
            RowBox[{"Flavor", "[", "gaugeG", "]"}], " ", "]"}]}], "->", 
          "groupN"}]}], "\[IndentingNewLine]"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nonAbelianF", "[", "gaugeN_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "subF", ",", "subFA", ",", "subA", ",", "sF2", ",", "FA2",
          ",", "NgaugeR", ",", "list", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mName", "=", "\"\<nonAbelianF\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DefineTensorShortcuts", "[", "  ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", "0"}], "}"}], ",", "   ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", "1"}], "}"}], ",", "   ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "A", "}"}], ",", "2"}], "}"}], ",", "   ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"F", ",", "f"}], "}"}], ",", "3"}], "}"}]}], "  ", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"CompleteBaseIndices", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"gaugeG", ",", "_"}], "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"gaugeG", ",", 
             RowBox[{"Range", "[", "gaugeN", "]"}]}], "}"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeclareBaseIndices", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "tmp"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"**", " ", "Define"}], " ", "gauge", " ", "field", " ", 
          "A"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Aud", "[", 
           RowBox[{
            RowBox[{"gaugeG", "@", "2"}], ",", "\[Mu]"}], "]"}], ",", 
          "\"\<Aud\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"**", " ", "Define"}], " ", "field", " ", "strength", " ", 
          "F"}], "  ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"subFA", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Fudd", "[", 
             RowBox[{
              RowBox[{"gaugeG", "@", "c_"}], ",", "\[Mu]_", ",", "\[Nu]_"}], 
             "]"}], "->", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{
               RowBox[{"Aud", "[", 
                RowBox[{
                 RowBox[{"gaugeG", "@", "c"}], ",", "\[Nu]"}], "]"}], ",", 
               "\[Mu]"}], "]"}], "-", 
             RowBox[{"xPartialD", "[", 
              RowBox[{
               RowBox[{"Aud", "[", 
                RowBox[{
                 RowBox[{"gaugeG", "@", "c"}], ",", "\[Mu]"}], "]"}], ",", 
               "\[Nu]"}], "]"}], "+", 
             RowBox[{"g", " ", 
              RowBox[{"fuuu", "[", 
               RowBox[{
                RowBox[{"gaugeG", "@", "a"}], ",", 
                RowBox[{"gaugeG", "@", "b"}], ",", 
                RowBox[{"gaugeG", "@", "c"}]}], "]"}], 
              RowBox[{"Aud", "[", 
               RowBox[{
                RowBox[{"gaugeG", "@", "a"}], ",", "\[Mu]"}], "]"}], 
              RowBox[{"Aud", "[", 
               RowBox[{
                RowBox[{"gaugeG", "@", "b"}], ",", "\[Nu]"}], "]"}]}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Fuuu", "[", 
             RowBox[{
              RowBox[{"gaugeG", "@", "c_"}], ",", "\[Mu]_", ",", "\[Nu]_"}], 
             "]"}], "->", 
            RowBox[{
             RowBox[{"xPartialDu", "[", 
              RowBox[{
               RowBox[{"Auu", "[", 
                RowBox[{
                 RowBox[{"gaugeG", "@", "c"}], ",", "\[Nu]"}], "]"}], ",", 
               "\[Mu]"}], "]"}], "-", 
             RowBox[{"xPartialDu", "[", 
              RowBox[{
               RowBox[{"Auu", "[", 
                RowBox[{
                 RowBox[{"gaugeG", "@", "c"}], ",", "\[Mu]"}], "]"}], ",", 
               "\[Nu]"}], "]"}], "+", 
             RowBox[{"g", " ", 
              RowBox[{"fuuu", "[", 
               RowBox[{
                RowBox[{"gaugeG", "@", "a"}], ",", 
                RowBox[{"gaugeG", "@", "b"}], ",", 
                RowBox[{"gaugeG", "@", "c"}]}], "]"}], 
              RowBox[{"Auu", "[", 
               RowBox[{
                RowBox[{"gaugeG", "@", "a"}], ",", "\[Mu]"}], "]"}], 
              RowBox[{"Auu", "[", 
               RowBox[{
                RowBox[{"gaugeG", "@", "b"}], ",", "\[Nu]"}], "]"}]}]}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "subFA", "}"}], ",", "\"\<subFA\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"**", " ", "Define"}], " ", "kinetic", " ", "term"}], "  ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sF2", "=", 
         RowBox[{
          RowBox[{"FFna", "[", 
           RowBox[{
            RowBox[{"gaugeG", "@", "a_"}], ",", "\[Mu]_", ",", "\[Nu]_"}], 
           "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "4"]}], 
           RowBox[{
            RowBox[{"Fudd", "[", 
             RowBox[{
              RowBox[{"gaugeG", "@", "a"}], ",", "\[Mu]", ",", "\[Nu]"}], 
             "]"}], ".", 
            RowBox[{"Fuuu", "[", 
             RowBox[{
              RowBox[{"gaugeG", "@", "a"}], ",", "\[Mu]", ",", "\[Nu]"}], 
             "]"}]}]}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "sF2", "}"}], ",", "\"\<sF2\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"FFna", "[", 
            RowBox[{
             RowBox[{"gaugeG", "@", "c"}], ",", "\[Mu]", ",", "\[Nu]"}], 
            "]"}], "/.", "sF2"}], "/.", 
          RowBox[{"subFA", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"subFA", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DotExpandMode", "[", "True", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", "simpleDot"}], "//", "Expand"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorSymmetry", "[", 
          RowBox[{"f", ",", "3"}], "]"}], "=", 
         RowBox[{"AntiSymmetric", "[", 
          RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Swaps", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", 
          RowBox[{"SymmetrizeSlots", "[", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Swaps", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "//", 
          RowBox[{"SymmetrizeSlots", "[", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "8", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Swaps", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "8", "]"}], "]"}], "]"}], "//", 
          RowBox[{"SymmetrizeSlots", "[", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "9", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Swaps", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}], "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "9", "]"}], "]"}], "]"}], "//", 
          RowBox[{"SymmetrizeSlots", "[", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"list", "/.", "simpleDot"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", "list"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"list", "=", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "list"}], "]"}], "/.", "commuteDot"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "//", 
          RowBox[{"SwapUpDownIndices", "[", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"A_", ",", "B_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"A", "/.", 
               RowBox[{
                RowBox[{"gaugeG", "@", "a_"}], "->", 
                RowBox[{"gaugeG", "@", 
                 RowBox[{"a", "[", "1", "]"}]}]}]}], ",", 
              RowBox[{"B", "/.", 
               RowBox[{
                RowBox[{"gaugeG", "@", "a_"}], "->", 
                RowBox[{"gaugeG", "@", 
                 RowBox[{"a", "[", "2", "]"}]}]}]}]}], "]"}]}]}], "/.", 
          RowBox[{
           RowBox[{"gaugeG", "@", 
            RowBox[{"c", "[", "_", "]"}]}], "->", 
           RowBox[{"gaugeG", "@", "c"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mName", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "list", "}"}], ",", "\"\<list\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", "list"}], "]"}], "/.", 
          RowBox[{"Dot", "\[Rule]", "Times"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DotExpandMode", "[", "False", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"sF2", ",", "subFA", ",", "list"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Column", "[", "\[IndentingNewLine]", 
     RowBox[{"sNAFF", "=", 
      RowBox[{"nonAbelianF", "[", "3", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.47748769590289*^9, 3.477488081976946*^9}, {
   3.477488467366118*^9, 3.47748856240867*^9}, {3.4774886173547*^9, 
   3.477488689887061*^9}, {3.477488783679697*^9, 3.477488891200232*^9}, {
   3.4774890260432034`*^9, 3.477489027043998*^9}, {3.4787002770801*^9, 
   3.478700304259726*^9}, {3.478700337742271*^9, 3.4787003558857403`*^9}, {
   3.4787004081321077`*^9, 3.478700409637163*^9}, {3.478700484471265*^9, 
   3.478700493147669*^9}, {3.4787005607021103`*^9, 3.478700578013245*^9}, {
   3.478700747998646*^9, 3.4787007718227797`*^9}, {3.478700835425137*^9, 
   3.4787008361641417`*^9}, {3.478700903527666*^9, 3.478700940649012*^9}, {
   3.478701045194685*^9, 3.478701149492828*^9}, {3.478704320157867*^9, 
   3.478704323769582*^9}, {3.478704490384317*^9, 3.478704500451713*^9}, {
   3.4787045522054253`*^9, 3.478704552739633*^9}, {3.478705233192141*^9, 
   3.4787054095950947`*^9}, {3.478705491843224*^9, 3.478705535399572*^9}, {
   3.478705722452095*^9, 3.4787058649332542`*^9}, {3.478706506806182*^9, 
   3.478706521800769*^9}, {3.4787066159488497`*^9, 3.478706646976132*^9}, 
   3.478706747037608*^9, {3.4787073783542967`*^9, 3.478707402018137*^9}, {
   3.4787075434663754`*^9, 3.478707570006216*^9}, {3.478707632749713*^9, 
   3.478707656331195*^9}, 3.478707823778586*^9, 3.47870786784011*^9, {
   3.478707999361418*^9, 3.478708003258916*^9}, {3.478708033893132*^9, 
   3.478708034647367*^9}, {3.478708089257148*^9, 3.47870808942437*^9}, {
   3.478708145207407*^9, 3.478708145823763*^9}, {3.478708230618517*^9, 
   3.478708245716*^9}, {3.478708286024069*^9, 3.478708295613978*^9}, {
   3.4787085435736837`*^9, 3.47870857039248*^9}, {3.478913665609343*^9, 
   3.478913774421372*^9}, {3.48306602512379*^9, 3.483066039251102*^9}, 
   3.483066073796667*^9, {3.483066108709731*^9, 3.48306612202439*^9}, 
   3.483066175485804*^9, {3.4831114606087*^9, 3.483111467270363*^9}, {
   3.48346652079375*^9, 3.483466537376966*^9}, {3.483466593532233*^9, 
   3.483466633720793*^9}, {3.4834666644502077`*^9, 3.483466669939042*^9}, {
   3.483705685236389*^9, 3.483705691093693*^9}, 3.483705815088426*^9, {
   3.48370705050918*^9, 3.483707058055099*^9}, 3.483711896803485*^9, {
   3.4837119910682077`*^9, 3.483711991750771*^9}, 3.483712050310136*^9, {
   3.483712107723477*^9, 3.48371215135907*^9}, {3.483712190864435*^9, 
   3.4837122026970778`*^9}, {3.4837122376063747`*^9, 3.483712239165442*^9}, {
   3.483712285122829*^9, 3.4837122993194017`*^9}, 3.483712435396253*^9, {
   3.4837127868105164`*^9, 3.483712788861042*^9}, {3.483712867100431*^9, 
   3.4837128759838552`*^9}, {3.483712932802442*^9, 3.483712949848173*^9}, {
   3.4837129879056473`*^9, 3.4837129883944387`*^9}, 3.4840503384043016`*^9, {
   3.485360172661951*^9, 3.485360192272628*^9}, {3.4864687552872066`*^9, 
   3.486468786089674*^9}, {3.486468934516407*^9, 3.4864689819919243`*^9}, {
   3.486469960265414*^9, 3.48646998756607*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    RowBox[{
     RowBox[{"Fdd", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ".", 
     RowBox[{"Fuu", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         RowBox[{
          SubscriptBox[
           UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Nu]"], "[", 
          RowBox[{"Ad", "[", "\[Mu]", "]"}], "]"}],
         $CellContext`xPartialD[
          $CellContext`Ad[$CellContext`\[Mu]], $CellContext`\[Nu]],
         Editable->False,
         SyntaxForm->Automatic]}], "+", 
       InterpretationBox[
        RowBox[{
         SubscriptBox[
          UnderscriptBox["\<\"\[PartialD]\"\>", "_"], "\[Mu]"], "[", 
         RowBox[{"Ad", "[", "\[Nu]", "]"}], "]"}],
        $CellContext`xPartialD[
         $CellContext`Ad[$CellContext`\[Nu]], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         RowBox[{
          TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"\[Nu]"},
           "Superscript"], "[", 
          RowBox[{"Au", "[", "\[Mu]", "]"}], "]"}],
         $CellContext`xPartialDu[
          $CellContext`Au[$CellContext`\[Mu]], $CellContext`\[Nu]],
         Editable->False,
         SyntaxForm->Automatic]}], "+", 
       InterpretationBox[
        RowBox[{
         TemplateBox[{UnderscriptBox["\"\[PartialD]\"", "_"],"\[Mu]"},
          "Superscript"], "[", 
         RowBox[{"Au", "[", "\[Nu]", "]"}], "]"}],
        $CellContext`xPartialDu[
         $CellContext`Au[$CellContext`\[Nu]], $CellContext`\[Mu]],
        Editable->False,
        SyntaxForm->Automatic]}], ")"}]}]}], ",", 
   InterpretationBox[
    RowBox[{
     SubscriptBox["\<\"\[Integral]\"\>", 
      TagBox[GridBox[{
         {
          RowBox[{"{", 
           RowBox[{"{", "k", "}"}], "}"}]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Column"]], "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{
        RowBox[{"Ad", "[", "\[Nu]", "]"}], "[", "k", "]"}], " ", 
       RowBox[{
        RowBox[{"Au", "[", "\[Mu]", "]"}], "[", "k", "]"}], " ", 
       RowBox[{
        RowBox[{"kd", "[", "\[Mu]", "]"}], "[", "1", "]"}], " ", 
       RowBox[{
        RowBox[{"ku", "[", "\[Nu]", "]"}], "[", "2", "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{
        RowBox[{"Ad", "[", "\[Mu]", "]"}], "[", "k", "]"}], " ", 
       RowBox[{
        RowBox[{"Au", "[", "\[Mu]", "]"}], "[", "k", "]"}], " ", 
       RowBox[{
        RowBox[{"kd", "[", "\[Nu]", "]"}], "[", "1", "]"}], " ", 
       RowBox[{
        RowBox[{"ku", "[", "\[Nu]", "]"}], "[", "2", "]"}]}]}], "]"}],
    $CellContext`IntegralOp[{{{$CellContext`k}}}, 
     Rational[-1, 
        2] $CellContext`Ad[$CellContext`\[Nu]][$CellContext`k] \
$CellContext`Au[$CellContext`\[Mu]][$CellContext`k] \
$CellContext`kd[$CellContext`\[Mu]][1] $CellContext`ku[$CellContext`\[Nu]][2] + 
     Rational[1, 
        2] $CellContext`Ad[$CellContext`\[Mu]][$CellContext`k] \
$CellContext`Au[$CellContext`\[Mu]][$CellContext`k] \
$CellContext`kd[$CellContext`\[Nu]][1] $CellContext`ku[$CellContext`\[Nu]][2]],
    Editable->False,
    SyntaxForm->Automatic]}], "}"}]], "Output",
 CellChangeTimes->{{3.547820376392174*^9, 3.5478203786689177`*^9}, 
   3.547825676624235*^9, 3.5478304441765213`*^9, 3.547866678497694*^9, 
   3.547913473724702*^9, 3.547913615409092*^9, 3.547914570604579*^9, 
   3.5479148962797813`*^9, 3.548096282361619*^9, 3.548731323189567*^9, 
   3.549375884246449*^9, 3.549636619645471*^9, 3.5509743574120398`*^9, 
   3.551112139872898*^9, 3.5511947177267513`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"field", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"feyn", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"space", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"timespace", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"groupR", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"gaugeG", ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
       "8"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.547820376392174*^9, 3.5478203786689177`*^9}, 
   3.547825676624235*^9, 3.5478304441765213`*^9, 3.547866678497694*^9, 
   3.547913473724702*^9, 3.547913615409092*^9, 3.547914570604579*^9, 
   3.5479148962797813`*^9, 3.548096282361619*^9, 3.548731323189567*^9, 
   3.549375884246449*^9, 3.549636619645471*^9, 3.5509743574120398`*^9, 
   3.551112139872898*^9, 3.551194717731447*^9}]
}, Open  ]],

Cell["xPartialD routines", "Text",
 CellChangeTimes->{{3.47855132833631*^9, 3.478551336207296*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Simplifies", " ", "xPartialD", " ", "in", " ", "exp_", " ", "based", 
      " ", "upon", " ", "list", " ", "of", " ", 
      RowBox[{"constants_", " ", ".", "  ", "Only"}], " ", "extracts", " ", 
      "multiplicative", " ", 
      RowBox[{"constants", ".", "\[IndentingNewLine]", "NOT"}], " ", 
      "FINISHED"}], " ", "->", " ", "use"}], " ", "/.", "PartialDExpand"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PartialDSimplify", "[", 
      RowBox[{"exp_", ",", "constants_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"tmp0", "=", "Null"}], ",", "pos", ",", "xpart", ",", "arg", 
         ",", "dx", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp0", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", 
             RowBox[{"xPartialDExpand", "[", "constants", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xPartialD", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
              RowBox[{"0", "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"constants", ",", "a"}], "]"}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xPartialDu", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
              RowBox[{"0", "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"constants", ",", "a"}], "]"}]}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rules", " ", "for", " ", "applying", " ", 
      RowBox[{"D", "[", ",", "]"}], " ", "instead", " ", "of", " ", 
      RowBox[{
       RowBox[{"xPartialD", "[", ",", "]"}], ".", "  ", 
       RowBox[{"Usage", ":", " ", "exp"}]}]}], "/.", 
     RowBox[{"xPartialD2D", "[", 
      RowBox[{"1", ",", "x"}], "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xPartialD2D", "[", 
      RowBox[{"mu_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"{", "  ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{"a_", ",", "mu"}], "]"}], ":>", 
        RowBox[{"D", "[", 
         RowBox[{"a", ",", "x"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xPartialDu", "[", 
         RowBox[{"a_", ",", "mu"}], "]"}], ":>", 
        RowBox[{"D", "[", 
         RowBox[{"a", ",", "x"}], "]"}]}]}], "  ", "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Rules", " ", "that", " ", "transform", " ", 
      RowBox[{"{", 
       RowBox[{"xPartialD", ",", "xPartialDu"}], "}"}], " ", "to", " ", 
      "Tensorial", " ", "\[PartialD]"}], ":", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "->", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"\"\<\[PartialD]\>\"", ",", "\"\<d\>\""}], "]"}], "[", 
           "b", "]"}], "[", "a", "]"}]}], ",", 
        RowBox[{
         RowBox[{"xPartialDu", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "->", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"\"\<\[PartialD]\>\"", ",", "\"\<u\>\""}], "]"}], "[", 
           "b", "]"}], "[", "a", "]"}]}]}], "}"}], "\[IndentingNewLine]", " ",
       "7", "Apr2012"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xPartialD2Dupdn", "[", 
          RowBox[{"var_List", ",", "field_List"}], "]"}], "[", "exp_", "]"}], 
        " ", "converts", " ", "Tensor", " ", "exp_", " ", "indices", " ", 
        "into", " ", 
        RowBox[{"var_", "[", 
         RowBox[{"up", "|", "dn"}], "]"}], " ", "where", " ", 
        RowBox[{"{", 
         RowBox[{"up", ",", "dn"}], "}"}], " ", "indicates", " ", "the", " ", 
        "position", " ", "of", " ", "the", " ", 
        RowBox[{"indices", ".", "  ", "The"}], " ", "field_List", " ", 
        "contains", " ", "the", " ", "fields", " ", "that", " ", "are", " ", 
        "all", " ", "functions", " ", "of", " ", 
        RowBox[{
         RowBox[{"var_List", " ", "[", 
          RowBox[{"up", "|", "dn"}], "]"}], ".", "  ", "The"}], " ", "fields",
         " ", "can", " ", "have", " ", "Patterns", " ", "as", " ", "indices", 
        " ", "to", " ", "encompass", " ", "a", " ", "more", " ", "general", 
        " ", "set", " ", "of", " ", 
        RowBox[{"fields", ".", "  ", "This"}], " ", "is", " ", "useful", " ", 
        "when", " ", "we", " ", "want", " ", "to", " ", "use", " ", "the", 
        " ", "D", " ", "operation", " ", "in", " ", "exp_", " ", "where", " ",
         "the", " ", "notation", " ", "is", " ", "in", " ", "xPartialD"}], 
       " ", "&"}], " ", "xPartialDu"}], ",", " ", 
     RowBox[{
      RowBox[{"Tensor", ".", " ", "One"}], " ", "use", " ", "compute", " ", 
      "EulerEquation", " ", "in", " ", "Tensor", " ", "notation"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"e", ".", "g", "."}], ",", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"xPartialD", "[", 
         RowBox[{
          RowBox[{"xPartialDu", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Aud", "[", 
              RowBox[{"a", ",", "b"}], "]"}], " ", 
             RowBox[{"Auu", "[", 
              RowBox[{"c", ",", "e"}], "]"}]}], ",", " ", "e"}], "]"}], ",", 
          "e"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xPartialD2Dupdn", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e", ",", "\[Nu]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Aud", "[", 
              RowBox[{"a", ",", "\[Mu]_"}], "]"}], ",", 
             RowBox[{"Auu", "[", 
              RowBox[{"\[Nu]_", ",", "a_"}], "]"}]}], "}"}]}], "]"}], "[", 
         " ", "tmp", " ", "]"}]}], "\[IndentingNewLine]", "=", 
       RowBox[{">", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["A", 
               StyleBox[
                RowBox[{"c", "e"}],
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"c", "e"}]],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`e}, {
               TensorCalculus4V6`Tensorial`Void, 
                TensorCalculus4V6`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"c", "[", "up", "]"}], ",", 
            RowBox[{"c", "[", "dn", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["A", 
               RowBox[{
                StyleBox["a",
                 StripOnInput->False,
                 ShowContents->False], "b"}], 
               RowBox[{"a", 
                StyleBox["b",
                 StripOnInput->False,
                 ShowContents->False]}]],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
               TensorCalculus4V6`Tensorial`Void, $CellContext`b}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "up", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "dn", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["A", 
               RowBox[{
                StyleBox["a",
                 StripOnInput->False,
                 ShowContents->False], "b"}], 
               RowBox[{"a", 
                StyleBox["b",
                 StripOnInput->False,
                 ShowContents->False]}]],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
               TensorCalculus4V6`Tensorial`Void, $CellContext`b}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "up", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "dn", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["A", 
               StyleBox[
                RowBox[{"c", "e"}],
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"c", "e"}]],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`e}, {
               TensorCalculus4V6`Tensorial`Void, 
                TensorCalculus4V6`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"c", "[", "up", "]"}], ",", 
            RowBox[{"c", "[", "dn", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["A", 
             StyleBox[
              RowBox[{"c", "e"}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"c", "e"}]],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`e}, {
             TensorCalculus4V6`Tensorial`Void, 
              TensorCalculus4V6`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"c", "[", "up", "]"}], ",", 
            RowBox[{"c", "[", "dn", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["A", 
               RowBox[{
                StyleBox["a",
                 StripOnInput->False,
                 ShowContents->False], "b"}], 
               RowBox[{"a", 
                StyleBox["b",
                 StripOnInput->False,
                 ShowContents->False]}]],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
               TensorCalculus4V6`Tensorial`Void, $CellContext`b}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "up", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "dn", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            SubsuperscriptBox["A", 
             RowBox[{
              StyleBox["a",
               StripOnInput->False,
               ShowContents->False], "b"}], 
             RowBox[{"a", 
              StyleBox["b",
               StripOnInput->False,
               ShowContents->False]}]],
            
            TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`a, TensorCalculus4V6`Tensorial`Void}, {
             TensorCalculus4V6`Tensorial`Void, $CellContext`b}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "up", "]"}], ",", 
            RowBox[{"\[Nu]", "[", "dn", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             InterpretationBox[
              SubsuperscriptBox["A", 
               StyleBox[
                RowBox[{"c", "e"}],
                StripOnInput->False,
                ShowContents->False], 
               RowBox[{"c", "e"}]],
              
              TensorCalculus4V6`Tensorial`Tensor[$CellContext`A, \
{$CellContext`c, $CellContext`e}, {
               TensorCalculus4V6`Tensorial`Void, 
                TensorCalculus4V6`Tensorial`Void}],
              BaseStyle->{AutoMultiplicationSymbol -> False},
              Editable->False], ")"}], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"e", "[", "up", "]"}], ",", 
            RowBox[{"e", "[", "dn", "]"}], ",", 
            RowBox[{"c", "[", "up", "]"}], ",", 
            RowBox[{"c", "[", "dn", "]"}]}], "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "12", "Apr2012"}]}]}]}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xPartialD2Dupdn", "[", 
       RowBox[{"var_List", ",", "field_List"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sub", ",", 
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"vars", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vars", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", "up", "]"}], ",", 
                 RowBox[{"#", "[", "dn", "]"}]}], "}"}]}], "]"}], "&"}], ",", 
            "var"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Apply", "[", 
                RowBox[{
                 RowBox[{"RemovePatterns", "[", "#", "]"}], ",", "vars"}], 
                "]"}]}], "}"}], "&"}], ",", "field"}], "]"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<sub:\>\"", ",", "sub"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<tmp:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"xD", "[", 
             RowBox[{"a", ",", 
              RowBox[{"b", "[", "dn", "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"xPartialDu", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"xD", "[", 
             RowBox[{"a", ",", 
              RowBox[{"b", "[", "up", "]"}]}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "//.", "sub"}], "//.", 
          RowBox[{"xD", "\[Rule]", "D"}]}]}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "CombineDeriv", " ", "Rules", " ", "for", " ", "combining", " ", "sum", 
     " ", "and", " ", "differences", " ", "of", " ", "Deriv", " ", "s"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CombineDeriv", ":=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"c_", ",", "b_"}], "]"}]}], "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{
              RowBox[{"a", "+", "c"}], ",", "b"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"c_", ",", "b_"}], "]"}]}], "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{
              RowBox[{"a", "-", "c"}], ",", "b"}], "]"}]}]}], "}"}], "&"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "xPartialD", ",", "xPartialDu", ",", "xCovariantD", ",", 
          "xCovariantDu"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478551389706888*^9, 3.4785515358116007`*^9}, {
   3.4785516345704823`*^9, 3.4785517669765177`*^9}, {3.478554043998272*^9, 
   3.478554339247868*^9}, {3.478554398304984*^9, 3.478554477654948*^9}, {
   3.478554542328661*^9, 3.478554545550701*^9}, {3.47855460428652*^9, 
   3.478554639236051*^9}, {3.478554689420269*^9, 3.4785548143426943`*^9}, {
   3.478555391167883*^9, 3.4785553956073217`*^9}, {3.478608930572361*^9, 
   3.47860896388291*^9}, {3.478609018852754*^9, 3.478609036893507*^9}, {
   3.478609133049045*^9, 3.478609222376202*^9}, {3.478613014580678*^9, 
   3.478613108342133*^9}, {3.478740282173703*^9, 3.478740285293358*^9}, {
   3.478740333303894*^9, 3.478740335044236*^9}, {3.4787405627042027`*^9, 
   3.4787405675456753`*^9}, {3.478740599319392*^9, 3.478740636785309*^9}, {
   3.478795756125477*^9, 3.478795757586532*^9}, {3.478795830521118*^9, 
   3.4787958332656183`*^9}, {3.478796072376257*^9, 3.478796216606846*^9}, {
   3.478796306170896*^9, 3.47879634649895*^9}, {3.478796720618372*^9, 
   3.478796721592349*^9}, {3.4787970036279078`*^9, 3.4787970649695044`*^9}, 
   3.478797481237751*^9, {3.478797620342938*^9, 3.47879764317006*^9}, {
   3.4787976877044287`*^9, 3.478797696291999*^9}, {3.478797928944718*^9, 
   3.478797954325674*^9}, {3.478798043935894*^9, 3.478798099631764*^9}, {
   3.4787982649822397`*^9, 3.478798343911577*^9}, {3.478865371139368*^9, 
   3.478865375551931*^9}, 3.4788656422976923`*^9, {3.4788656889429703`*^9, 
   3.478865696419318*^9}, {3.478866658479106*^9, 3.478866673281382*^9}, 
   3.479306077069529*^9, {3.482150330181652*^9, 3.482150392536244*^9}, {
   3.4821526207544518`*^9, 3.4821526212173*^9}, {3.482425615697535*^9, 
   3.482425652873488*^9}, {3.482425807694729*^9, 3.482425808162942*^9}, {
   3.483890105781703*^9, 3.483890106580196*^9}, {3.483890150448735*^9, 
   3.48389015092092*^9}, {3.483890399242186*^9, 3.483890408757266*^9}, {
   3.485801106492999*^9, 3.485801115164288*^9}, 3.485801876389031*^9, 
   3.485801935736408*^9, {3.4864330612027073`*^9, 3.486433070025606*^9}, {
   3.486434304046398*^9, 3.4864343061731358`*^9}, {3.54280868479506*^9, 
   3.54280881016145*^9}, {3.543267944238566*^9, 3.543268261808578*^9}, {
   3.543268291923558*^9, 3.5432683303121233`*^9}, {3.5432687456173067`*^9, 
   3.5432687808467283`*^9}, {3.5432851042613897`*^9, 3.543285105693192*^9}, {
   3.543285916484414*^9, 3.543285917651185*^9}, 3.543750479196534*^9, {
   3.54375052135118*^9, 3.543750671265151*^9}, {3.543750755334663*^9, 
   3.543750934656241*^9}, {3.543751025069448*^9, 3.5437510630758533`*^9}, {
   3.543751103421706*^9, 3.543751132127318*^9}, {3.543751168317618*^9, 
   3.543751171185442*^9}, {3.543751203530601*^9, 3.5437512133325033`*^9}, {
   3.543751587307334*^9, 3.543751590909317*^9}, {3.5437516548988323`*^9, 
   3.5437516844841223`*^9}, {3.543752739737816*^9, 3.543752755813175*^9}, {
   3.5437530364712667`*^9, 3.5437531557924833`*^9}, 3.543753192378345*^9, {
   3.543753300884533*^9, 3.543753325539263*^9}, {3.54375352019421*^9, 
   3.543753526139051*^9}, {3.544531032656431*^9, 3.544531262983433*^9}, {
   3.544532209263638*^9, 3.5445322483492804`*^9}}],

Cell["Prototypes", "Text",
 CellChangeTimes->{{3.478610215116564*^9, 3.478610225498597*^9}}],

Cell["Feynman parameterization technique", "Text",
 CellChangeTimes->{{3.479261010835832*^9, 3.479261017614574*^9}, {
  3.479297148863298*^9, 3.4792971589651423`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "generate", " ", "IntegralOp", " ", 
    "variables", " ", "for", " ", 
    RowBox[{"F", "[", "n_", "]"}], " ", "in", " ", 
    RowBox[{"e1410", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"xF", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"out", ",", "i"}], "}"}], ",", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "[", "1", "]"}], ",", "0", ",", "1"}], "}"}], 
             "}"}]}], ";", 
           RowBox[{"i", "=", "2"}]}], ",", 
          RowBox[{"i", "<=", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"out", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", "i", "]"}], ",", "0", ",", "1"}], "}"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fn", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"out", ",", "i", ",", "j"}], "}"}], ",", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "[", "1", "]"}], ",", "0", ",", "1"}], "}"}], 
             "}"}]}], ";", 
           RowBox[{"i", "=", "2"}]}], ",", 
          RowBox[{"i", "<=", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"out", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", "i", "]"}], ",", "0", ",", 
              RowBox[{"1", "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"j", "-", "1"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "i"}], "}"}]}], "]"}]}]}], 
             "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DefPrint", "[", 
    RowBox[{"\"\<e1410\>\"", ",", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"F", "[", "n_", "]"}], "}"}], "}"}], ",", "a__"}], "]"}], ":>", 
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"xF", "[", "n", "]"}], ",", 
        RowBox[{"a", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "!"}], " ", 
         RowBox[{"DiracDelta", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "-", "1"}], 
          "]"}]}]}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DefPrint", "[", 
    RowBox[{"\"\<e1427\>\"", ",", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "q", "}"}], "}"}], ",", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", " ", "\[Pi]"}], ")"}], "d"]], 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            SuperscriptBox["q", "2"], ")"}], "a"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["q", "2"], "+", "D"}], ")"}], "b"]]}]}], "]"}], "->", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"b", "-", "a", "-", 
           RowBox[{"d", "/", "2"}]}], "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"a", "+", 
           RowBox[{"d", "/", "2"}]}], "]"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"4", " ", "\[Pi]"}], ")"}], 
          RowBox[{"d", "/", "2"}]], 
         RowBox[{"Gamma", "[", "b", "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"d", "/", "2"}], "]"}]}]], 
       SuperscriptBox["D", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"b", "-", "a", "-", 
           RowBox[{"d", "/", "2"}]}], ")"}]}]]}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DefPrint", "[", 
    RowBox[{"\"\<e1427s\>\"", ",", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "q", "}"}], "}"}], ",", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           SuperscriptBox["q", "2"], ")"}], "a"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["q", "2"], "+", "D"}], ")"}], "b"]]}], "]"}], "->", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Pi]"}], ")"}], "d"], 
         RowBox[{"Gamma", "[", 
          RowBox[{"b", "-", "a", "-", 
           RowBox[{"d", "/", "2"}]}], "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"a", "+", 
           RowBox[{"d", "/", "2"}]}], "]"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"4", " ", "\[Pi]"}], ")"}], 
          RowBox[{"d", "/", "2"}]], 
         RowBox[{"Gamma", "[", "b", "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"d", "/", "2"}], "]"}]}]], 
       SuperscriptBox["D", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"b", "-", "a", "-", 
           RowBox[{"d", "/", "2"}]}], ")"}]}]]}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DefPrint", "[", 
    RowBox[{"\"\<e1427hitoshi\>\"", ",", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "q", "}"}], "}"}], ",", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           SuperscriptBox["q", "2"], ")"}], "a"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["q", "2"], "-", "D", "-", 
            RowBox[{"I", " ", "\[CurlyEpsilon]"}]}], ")"}], "b"]]}], "]"}], "->", 
      RowBox[{
       FractionBox[
        RowBox[{"I", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"b", "+", "a"}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Pi]"}], ")"}], "d"], 
         RowBox[{"Gamma", "[", 
          RowBox[{"b", "-", "a", "-", 
           RowBox[{"d", "/", "2"}]}], "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"a", "+", 
           RowBox[{"d", "/", "2"}]}], "]"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"4", " ", "\[Pi]"}], ")"}], 
          RowBox[{"d", "/", "2"}]], 
         RowBox[{"Gamma", "[", "b", "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"d", "/", "2"}], "]"}]}]], 
       SuperscriptBox["D", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"b", "-", "a", "-", 
           RowBox[{"d", "/", "2"}]}], ")"}]}]]}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DefPrint", "[", 
    RowBox[{"\"\<e1426\>\"", ",", 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{
        RowBox[{"-", "n"}], "+", "\[CurlyEpsilon]"}], "]"}], ":>", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "n"], 
        RowBox[{
         RowBox[{"(", "n", ")"}], "!"}]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "\[CurlyEpsilon]"], "-", "\[Gamma]", "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox["k", 
            RowBox[{"-", "1"}]], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ")"}]}]}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CompleteSquare1", "[", 
     RowBox[{"denomlist_", ",", "var_"}], "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Finds", " ", "square", " ", "of", " ", "quadradic", " ", 
       "polynomial"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"a", " ", "x", " ", "x"}], " ", "+", " ", 
        RowBox[{"b", " ", "x"}], " ", "+", " ", "c"}], " ", "->", " ", 
       RowBox[{
        RowBox[{"f", 
         SuperscriptBox[
          RowBox[{"(", " ", 
           RowBox[{"x", " ", "+", " ", "d"}], " ", ")"}], "2"]}], " ", "+", 
        " ", "e"}]}], ",", " ", 
      RowBox[{"with", " ", "var_", " ", "as", " ", "the", " ", 
       RowBox[{"x_variable", ".", "  ", "Returns"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Complete", " ", "quadratic"}], ",", " ", 
          RowBox[{"Shifted", " ", "quadratic", " ", "term"}], ",", " ", 
          "Offset", ",", " ", 
          RowBox[{"variable", " ", "shift", " ", "factor"}]}], "}"}], 
        "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "factor", ",", "coef", ",", "denom", ",", "n", ",", "tmp", ",", "tmp1",
         ",", "tmp2", ",", "tmp3", ",", "sub1", ",", "a", ",", "b", ",", "c", 
        ",", "f", ",", "d", ",", "e", ",", "x", ",", "sub", ",", "sube", ",", 
        "subfD2", ",", "subfD2e", ",", "subshift"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Generate substitution Rule[] for quadratic polynomial of \
form.\>\"", ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{"fD2", ",", "fD2e", ",", "fD2off", ",", "varshift"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"a", " ", "x", " ", "x"}], " ", "+", " ", 
         RowBox[{"b", " ", "x"}], " ", "+", " ", "c"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"General", " ", "quadratic", " ", "equation"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tmp1", "=", 
        RowBox[{
         RowBox[{"f", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "+", "d"}], ")"}], "^", "2"}]}], "+", "e"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Solution", " ", "form"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "-", "tmp1"}], "//", "Expand"}], "//", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{"#", ",", "x"}], "]"}], "&"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Difference", " ", "in", " ", 
         RowBox[{"form", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp1", "=", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], ",", "f"}], "]"}], "//",
          "First"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", "tmp1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp2", "=", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ",", "d"}], "]"}], "//",
          "First"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "/.", "tmp2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp3", "=", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", "e"}], "]"}], "//",
          "First"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sub1", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp1", ",", "tmp2", ",", "tmp3"}], "}"}], "//", 
         "Flatten"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"Solutions", " ", "for", " ", 
         RowBox[{"{", 
          RowBox[{"f", ",", "d", ",", "e"}], "}"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"subfD2", "=", 
        RowBox[{
         RowBox[{"fD2", "->", 
          RowBox[{"f", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "+", "d"}], ")"}], "^", "2"}]}]}], "/.", "sub1"}]}],
        ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"f", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", " ", "+", " ", "d"}], ")"}], "^", "2"}], " ", 
         "part"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sube", "=", 
        RowBox[{"fD2offset", "->", 
         RowBox[{"(", 
          RowBox[{"e", "/.", "sub1"}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"e", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"subfD2e", "=", 
        RowBox[{
         RowBox[{"fD2all", "->", 
          RowBox[{
           RowBox[{"f", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "+", "d"}], ")"}], "^", "2"}]}], "+", "e"}]}], "/.",
          "sub1"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"f", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "+", "d"}], ")"}], "^", "2"}]}], "+", "e"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"subshift", "=", 
        RowBox[{
         RowBox[{"varshift", "->", 
          RowBox[{"var", "->", 
           RowBox[{"var", "-", "d"}]}]}], "/.", "sub1"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"var", "-", 
          RowBox[{"d", " ", "so", " ", "that", " ", "x"}], "-", "d"}], "->", 
         "x"}], "  ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"factor", ",", "denom", ",", "n"}], "}"}], "=", 
        RowBox[{"denomlist", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coef", "=", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{"denom", ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sub", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "->", "#2"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", ",", "b", ",", "a"}], "}"}], ",", "coef"}], "}"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"subfD2e", ",", "subfD2", ",", "sube", ",", "subshift"}], 
          "}"}], "/.", "sub"}], "/.", 
        RowBox[{"x", "->", "var"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Factors", " ", "exp_", " ", "in", " ", "form", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "A1"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"1", "/", "A2"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"1", "/", "A3"}], ")"}]}]}], "..."}], " ", "into", " ", 
      "Feynman", " ", "form"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "1", "]"}], " ", "A1"}], "+"}], "..."}], "+", 
          RowBox[{
           RowBox[{"x", "[", "n", "]"}], " ", "An"}]}], ")"}], "n"], ".", 
       "  ", "Returns"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"coef", ",", " ", "denom", ",", " ", 
         RowBox[{"exponent", " ", "of", " ", "denom"}], ",", 
         RowBox[{"sum", " ", "of", " ", 
          RowBox[{"x", "[", "n", "]"}]}]}], "}"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FactorDotFeynman", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "n", ",", "square", ",", "tmp", ",", "xs", ",", "numer", 
         ",", "denom", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "exp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numer", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Numerator", ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"x", "[", 
           RowBox[{"Range", "[", "n", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numer", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Numerator", "[", "tmp", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#3", 
             RowBox[{"#1", "/", "#2"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"xs", ",", "tmp", ",", "numer"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{
         "\"\<FactorDotFeynman\>\"", ",", "DEBUG", ",", "tmp", ",", 
          "\"\<tmp\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"denom", "=", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", "tmp"}], "]"}], "/.", 
          RowBox[{"Dot", "->", "Times"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denom", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"denom", "//", "Expand"}], "//", "SimplifyTensorSum"}], "//",
            "UpDownAdjust"}], "//", "Simplify"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"denom", "=", 
         RowBox[{
          RowBox[{"denom", "/.", 
           RowBox[{
            RowBox[{"x", "[", "n", "]"}], "->", 
            RowBox[{"1", "-", 
             RowBox[{"Apply", "[", 
              RowBox[{"Plus", ",", 
               RowBox[{"Most", "[", "xs", "]"}]}], "]"}]}]}]}], "//", 
          "Expand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "numer"}], "]"}], "/", 
          SuperscriptBox["denom", "n"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "numer"}], "]"}], ",", "denom", ",", "n", 
          ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", "xs"}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], " "}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.479297170306069*^9, 3.4792971794940042`*^9}, {
   3.479305689940733*^9, 3.479305705554863*^9}, {3.479310324800173*^9, 
   3.479310432881599*^9}, {3.4793154166210527`*^9, 3.479315417670186*^9}, {
   3.47934473443865*^9, 3.4793447843669252`*^9}, {3.4793448566563177`*^9, 
   3.4793448643394613`*^9}, {3.4793461660266933`*^9, 3.479346172446604*^9}, {
   3.47934625491818*^9, 3.479346263826591*^9}, {3.4793464059336643`*^9, 
   3.4793464086175947`*^9}, 3.4793467741410522`*^9, {3.4794038845260763`*^9, 
   3.479403972780167*^9}, 3.479404005534459*^9, {3.4794040512527742`*^9, 
   3.4794040516990337`*^9}, {3.4797273979173517`*^9, 3.479727427661332*^9}, {
   3.479727466635909*^9, 3.479727475020212*^9}, {3.479727676073221*^9, 
   3.479727684342013*^9}, {3.47972775349432*^9, 3.479727757558448*^9}, {
   3.479727811720315*^9, 3.479727818684025*^9}, {3.479728047628635*^9, 
   3.479728048313567*^9}, {3.47974713983729*^9, 3.479747140536675*^9}, {
   3.479813871842847*^9, 3.479813983731187*^9}, {3.479820009732444*^9, 
   3.4798200226468697`*^9}, {3.479820182822812*^9, 3.479820214384513*^9}, {
   3.479838179892621*^9, 3.479838180334902*^9}, 3.548205829489676*^9, {
   3.5482059249363823`*^9, 3.548206008782058*^9}, {3.548206069164526*^9, 
   3.548206088248096*^9}, {3.548206288839216*^9, 3.548206317341303*^9}, 
   3.5482063672838707`*^9, {3.548206402819908*^9, 3.548206520632107*^9}, {
   3.54842390650207*^9, 3.548423983478595*^9}, {3.5484242502939377`*^9, 
   3.548424259508923*^9}, 3.548508847843162*^9, {3.548508948505664*^9, 
   3.5485089529270563`*^9}, {3.548509043427318*^9, 3.548509064490347*^9}}],

Cell["\<\
Dotted/Undotted indices for spinor/twistor/SUSY representation\
\>", "Text",
 CellChangeTimes->{{3.5206058604068623`*^9, 3.52060588746894*^9}, {
  3.526925800319191*^9, 3.526925802837124*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"define", " ", 
    RowBox[{"dotted", "/", "undotted"}], " ", "indices", " ", "for", " ", 
    RowBox[{"spinor", "/", "twistor"}], " ", "representations"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DefineDottedIndices", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DeclareIndexFlavor", "[", 
         RowBox[{"{", 
          RowBox[{"twistor", ",", "Orange"}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeclareBaseIndices", "[", 
         RowBox[{"{", 
          RowBox[{"twistor", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d0", "[", "a_", "]"}], ":=", 
         RowBox[{"twistor", "@", "a"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d1", "[", "a_", "]"}], ":=", 
         RowBox[{"twistor", "@", 
          OverscriptBox["a", "."]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"OverBar", " ", "Tensor", " ", "definitions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBu", "[", 
          RowBox[{"a_", ",", "\[Mu]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", "\[Mu]", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"OBd", "[", 
          RowBox[{"a_", ",", "\[Mu]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "\[Mu]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBuu", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBud", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "\[Nu]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBdd", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBuuu", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_"}], 
          "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void", ",", "Void"}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBduu", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_"}], 
          "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "\[Nu]", ",", "\[Alpha]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "Void", ",", "Void"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBudd", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_"}], 
          "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "Void", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "\[Nu]", ",", "\[Alpha]"}], "}"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBuud", "[", 
          RowBox[{"a_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_"}], 
          "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]", ",", "Void"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void", ",", "\[Alpha]"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBuuud", "[", 
          RowBox[{
          "a_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_", ",", 
           "\[Beta]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "Void"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void", ",", "Void", ",", "\[Beta]"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBuudu", "[", 
          RowBox[{
          "a_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_", ",", 
           "\[Beta]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"OverBar", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]", ",", "Void", ",", "\[Beta]"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Void", ",", "Void", ",", "\[Alpha]", ",", "Void"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Default", " ", "\[Sigma]", " ", "index", " ", "expansion"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "\[Mu]", "]"}], "->", 
         RowBox[{"\[Sigma]udd", "[", 
          RowBox[{"\[Mu]", ",", 
           RowBox[{"d0", "@", "\[Alpha]"}], ",", 
           RowBox[{"d1", "@", "\[Beta]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBu", "[", 
          RowBox[{"\[Sigma]", ",", "\[Mu]"}], "]"}], "->", 
         RowBox[{"OBuuu", "[", 
          RowBox[{"\[Sigma]", ",", "\[Mu]", ",", 
           RowBox[{"d1", "@", "\[Beta]"}], ",", 
           RowBox[{"d0", "@", "\[Alpha]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"subsigbar", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"OBu", "[", 
             RowBox[{"\[Sigma]", ",", "a_"}], "]"}], ":>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "=!=", "0"}], ",", 
              RowBox[{"-", 
               RowBox[{"\[Sigma]u", "[", "a", "]"}]}], ",", 
              RowBox[{"\[Sigma]u", "[", "a", "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"OBd", "[", 
             RowBox[{"\[Sigma]", ",", "a_"}], "]"}], ":>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "=!=", "0"}], ",", 
              RowBox[{"-", 
               RowBox[{"\[Sigma]d", "[", "a", "]"}]}], ",", 
              RowBox[{"\[Sigma]d", "[", "a", "]"}]}], "]"}]}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Default", " ", 
          RowBox[{"dotted", "/", "undotted"}], " ", "expansion", " ", 
          "function"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AddDotIndex\[Sigma]", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"OBu", "[", 
             RowBox[{"\[Sigma]", ",", "\[Mu]_"}], "]"}], ":>", 
            RowBox[{
             RowBox[{"OBuuu", "[", 
              RowBox[{"\[Sigma]", ",", "\[Mu]", ",", 
               RowBox[{"d1", "@", "a"}], ",", 
               RowBox[{"d0", "@", "b"}]}], "]"}], "/;", 
             RowBox[{"\[Mu]", "=!=", "0"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Sigma]u", "[", "\[Mu]_", "]"}], "->", 
            RowBox[{"\[Sigma]udd", "[", 
             RowBox[{"\[Mu]", ",", 
              RowBox[{"d0", "@", "b"}], ",", 
              RowBox[{"d1", "@", "a"}]}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AddDotIndex\[Sigma]\[Sigma]", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"OBu", "[", 
              RowBox[{"\[Sigma]", ",", "\[Mu]_"}], "]"}], ".", 
             RowBox[{"\[Sigma]u", "[", "\[Nu]_", "]"}]}], ":>", 
            RowBox[{
             RowBox[{"OBuuu", "[", 
              RowBox[{"\[Sigma]", ",", "\[Mu]", ",", 
               RowBox[{"d1", "@", "a"}], ",", 
               RowBox[{"d0", "@", "b"}]}], "]"}], ".", 
             RowBox[{"\[Sigma]udd", "[", 
              RowBox[{"\[Nu]", ",", 
               RowBox[{"d0", "@", "b"}], ",", 
               RowBox[{"d1", "@", "c"}]}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Sigma]u", "[", "\[Mu]_", "]"}], ".", 
             RowBox[{"OBu", "[", 
              RowBox[{"\[Sigma]", ",", "\[Nu]_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"\[Sigma]udd", "[", 
              RowBox[{"\[Mu]", ",", 
               RowBox[{"d0", "@", "a"}], ",", 
               RowBox[{"d1", "@", "b"}]}], "]"}], ".", 
             RowBox[{"OBuuu", "[", 
              RowBox[{"\[Sigma]", ",", "\[Nu]", ",", 
               RowBox[{"d1", "@", "b"}], ",", 
               RowBox[{"d0", "@", "c"}]}], "]"}]}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "additional", " ", "OverBar", " ", "and", " ", "Dotted", " ", 
          "routines"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OBCu", "[", 
          RowBox[{"a_", ",", "\[Mu]_"}], "]"}], ":=", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"OverBar", "[", "a", "]"}], "]"}], ",", 
           RowBox[{"{", "\[Mu]", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"AddOB", "[", "a_Tensor", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tmp", "=", "a"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"tmp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             OverscriptBox[
              RowBox[{"tmp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "_"]}], ";", "tmp"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "AddDotted", " ", "adds", " ", "proper", " ", "dotted", " ", 
          "indices", " ", "to", " ", 
          RowBox[{"\[Sigma]u", "[", "]"}], " ", "and", " ", 
          RowBox[{
           RowBox[{"\[Sigma]uu", "[", "]"}], "."}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AddDotted", "[", "a_Tensor", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tmp", "=", "a"}], ",", 
             RowBox[{"nindex", "=", 
              RowBox[{"Length", "[", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=!=", "\[Sigma]"}], "&&", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", "OverBar"}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", "Void", "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d0", "@", "$\[Alpha]"}], "}"}]}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=!=", 
                OverscriptBox["\[Sigma]", "_"]}], "&&", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "OverBar"}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d1", "@", "$\[Alpha]"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", "Void", "}"}]}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nindex", "===", "1"}], "&&", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "===", "\[Sigma]"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{"for", " ", 
                RowBox[{"\[Sigma]u", "[", "\[Mu]", "]"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Void", ",", "Void"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"d0", "@", "$\[Alpha]"}], ",", 
                    RowBox[{"d1", "@", "$\[Beta]"}]}], "}"}]}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nindex", "===", "1"}], "&&", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "===", 
                OverscriptBox["\[Sigma]", "_"]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Void", ",", "Void"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"d1", "@", "$\[Beta]"}], ",", 
                    RowBox[{"d0", "@", "$\[Alpha]"}]}], "}"}]}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nindex", "===", "2"}], "&&", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "===", "\[Sigma]"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{"for", " ", 
                RowBox[{"\[Sigma]uu", "[", 
                 RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Void", ",", 
                    RowBox[{"d0", "@", "$\[Beta]"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"d0", "@", "$\[Alpha]"}], ",", "Void"}], "}"}]}], 
                 "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nindex", "===", "2"}], "&&", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "===", 
                OverscriptBox["\[Sigma]", "_"]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"d1", "@", "$\[Alpha]"}], ",", "Void"}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Void", ",", 
                    RowBox[{"d1", "@", "$\[Beta]"}]}], "}"}]}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AddDottedRule", "=", 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
          RowBox[{"AddDotted", "[", 
           RowBox[{"Tensor", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "AddDotted1", " ", "adds", " ", "dotted", " ", "indices", " ", 
          "Tensors", " ", 
          RowBox[{"(", 
           RowBox[{"via", " ", "AddDotted"}], ")"}], " ", "and", " ", 
          "nonTensor", " ", 
          RowBox[{"variables", ".", " ", "Correct"}], " ", "indices", " ", 
          "in", " ", "following", " ", 
          RowBox[{"step", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AddDotted1", "[", "a_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tmp", "=", "a"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "tmp", "]"}], "===", "Tensor"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"tmp", "=", 
               RowBox[{"AddDotted", "[", "tmp", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"NumericQ", "[", "tmp", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "tmp", "]"}], "=!=", "OverBar"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"tmp", "=", 
                   RowBox[{"Tensor", "[", 
                    RowBox[{"tmp", ",", 
                    RowBox[{"{", "Void", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"d0", "@", "$a"}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"tmp", "=", 
                   RowBox[{"Tensor", "[", 
                    RowBox[{"tmp", ",", 
                    RowBox[{"{", 
                    RowBox[{"d1", "@", "$b"}], "}"}], ",", 
                    RowBox[{"{", "Void", "}"}]}], "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "RemoveDotted", " ", "remove", " ", "Dotted", " ", "indices", " ", 
          "from", " ", 
          RowBox[{"Tensor", ".", "  ", "Assumes"}], " ", "Dotted", " ", 
          "indices", " ", "are", " ", "at", " ", "the", " ", 
          RowBox[{"end", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RemoveDotted", "[", "a_Tensor", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"tmp", "=", "a"}], ",", "l2a", ",", "length0", ",", "l2",
              ",", "l3", ",", "remove", ",", "list2", ",", "list3"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"length0", "=", 
             RowBox[{"Length", "[", 
              RowBox[{"tmp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"list2", "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"d0", "@", "_"}], "|", 
                RowBox[{"d1", "@", "_"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"list3", "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"d0", "@", "_"}], "|", 
                RowBox[{"d1", "@", "_"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"remove", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"list2", ",", "list3"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tmp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "remove"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tmp", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "remove"}], "]"}]}], ";",
             "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RemoveDottedAll", "[", "exp_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"Tensor", "[", 
               RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
              RowBox[{"RemoveDotted", "[", 
               RowBox[{"Tensor", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RemoveDottedRule", "=", 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
          RowBox[{"RemoveDotted", "[", 
           RowBox[{"Tensor", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Some", " ", "SUSY", " ", "identities", " ", "with", " ", "Weyl", 
          " ", "spinors"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"subWeyl", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "\[Alpha]", "]"}], ".", "A", ".", 
            "\[Beta]"}], "->", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"Transpose", "[", "\[Beta]", "]"}], ".", 
             RowBox[{"Transpose", "[", "A", "]"}], ".", "\[Alpha]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"A_", ",", "up_List", ",", "down_List"}], "]"}], " ", 
     "Produces", " ", "any", " ", 
     RowBox[{
      RowBox[{"Tensor", "[", 
       RowBox[{"A_", ",", "up_List", ",", "down_list"}], "]"}], ".", " ", 
      "Checks"}], " ", "for", " ", "proper", " ", 
     RowBox[{"indices", ".", " ", "\[IndentingNewLine]", "A_"}], " ", "can", 
     " ", "be", " ", "functional", " ", 
     RowBox[{"labels", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"A_", ",", "up_List", ",", "down_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"u", "=", 
          RowBox[{"up", "/.", 
           RowBox[{"Null", "->", "Void"}]}]}], ",", 
         RowBox[{"d", "=", 
          RowBox[{"down", "/.", 
           RowBox[{"Null", "->", "Void"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{"u", "/.", 
          RowBox[{
           RowBox[{"{", "}"}], "->", 
           RowBox[{"{", "Void", "}"}]}]}]}], ";", " ", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", 
          RowBox[{
           RowBox[{"{", "}"}], "->", 
           RowBox[{"{", "Void", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"Inner", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "=!=", "Void"}], "&&", 
                  RowBox[{"#2", "=!=", "Void"}]}], "||", 
                 RowBox[{
                  RowBox[{"#1", "===", "Void"}], "&&", 
                  RowBox[{"#2", "===", "Void"}]}]}], "&"}], ",", "u", ",", 
               "d", ",", "Or"}], "]"}]}], ")"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "d", "]"}], "==", 
            RowBox[{"Length", "[", "u", "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Tensor", "[", 
           RowBox[{"A", ",", "u", ",", "d"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"A", ",", "u", ",", "d"}], "]"}], ",", 
            RowBox[{"FontColor", "->", "Red"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"Error", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"A_", ",", "uds_String", ",", "index_"}], "]"}], " ", 
      "Produces", " ", "any", " ", "Tensor", " ", "where", " ", "uds_String", 
      " ", "specifies", " ", 
      RowBox[{"up", "/", "down"}], " ", "position", " ", "of", " ", 
      "index_"}], ",", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"Symbol", ",", "\"\<udd\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "]"}], "->", 
      RowBox[{"(", 
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["Symbol", "i"], ")"}], "jk"], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"A_", ",", "uds_String", ",", "index_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"ud", "=", 
          RowBox[{"Characters", "[", "uds", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"ud", ",", 
             RowBox[{"Except", "[", 
              RowBox[{"\"\<u\>\"", "|", "\"\<d\>\""}], "]"}]}], "]"}], "===", 
           
           RowBox[{"{", "}"}]}], "&&", 
          RowBox[{"(*", 
           RowBox[{"only", " ", "u", " ", "and", " ", "d", " ", "allowed"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"tmp", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "index", "]"}], "===", "List"}], "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "ud", "]"}], "==", 
                 RowBox[{"Length", "[", "index", "]"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "check", " ", "list", " ", "parameter", " ", 
                 "compatibility"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"Tensor", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "\"\<u\>\""}], ",", "#2", ",", 
                    "Void"}], "]"}], ")"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ud", ",", "index"}], "}"}]}], "]"}], ",", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "\"\<d\>\""}], ",", "#2", ",", 
                    "Void"}], "]"}], ")"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ud", ",", "index"}], "}"}]}], "]"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ud", "===", 
                RowBox[{"{", "\"\<u\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tensor", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"{", "index", "}"}], ",", 
                 RowBox[{"{", "Void", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ud", "===", 
                RowBox[{"{", "\"\<d\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tensor", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"{", "Void", "}"}], ",", 
                 RowBox[{"{", "index", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"no", " ", "list", " ", "index"}], "*)"}], 
               "\[IndentingNewLine]", "True", ",", 
               RowBox[{"(*", "error", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"-", "1"}]}], "]"}]}], ")"}], "=!=", 
           RowBox[{"-", "1"}]}]}], ",", "tmp", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"A", ",", "uds", ",", "index"}], "]"}], ",", 
           RowBox[{"FontColor", "->", "Red"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OnlyudQ", "[", "string_", "]"}], ":=", 
     RowBox[{
      RowBox[{"StringCases", "[", 
       RowBox[{"string", ",", 
        RowBox[{"Except", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<d\>\"", ",", "\"\<u\>\""}], "}"}], "]"}]}], " ", "]"}],
       "\[Equal]", 
      RowBox[{"{", "}"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Alternate", " ", "format", " ", "for", " ", "T"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"symbol", ",", "\"\<UpDownString\>\""}], "]"}], "[", 
       "indices", "]"}], " ", "7", "Apr2012"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"A_", ",", "uds_String"}], "]"}], "[", "index0__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"ud", "=", 
          RowBox[{"Characters", "[", "uds", "]"}]}], ",", 
         RowBox[{"index", "=", 
          RowBox[{"{", "index0", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"ud", ",", 
             RowBox[{"Except", "[", 
              RowBox[{"\"\<u\>\"", "|", "\"\<d\>\""}], "]"}]}], "]"}], "===", 
           
           RowBox[{"{", "}"}]}], "&&", 
          RowBox[{"(*", 
           RowBox[{"only", " ", "u", " ", "and", " ", "d", " ", "allowed"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"tmp", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "index", "]"}], "===", "List"}], "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "ud", "]"}], "==", 
                 RowBox[{"Length", "[", "index", "]"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "check", " ", "list", " ", "parameter", " ", 
                 "compatibility"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"Tensor", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "\"\<u\>\""}], ",", "#2", ",", 
                    "Void"}], "]"}], ")"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ud", ",", "index"}], "}"}]}], "]"}], ",", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "\"\<d\>\""}], ",", "#2", ",", 
                    "Void"}], "]"}], ")"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ud", ",", "index"}], "}"}]}], "]"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"ud", "===", 
                RowBox[{"{", "\"\<u\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tensor", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"{", "index", "}"}], ",", 
                 RowBox[{"{", "Void", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ud", "===", 
                RowBox[{"{", "\"\<d\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tensor", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"{", "Void", "}"}], ",", 
                 RowBox[{"{", "index", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"no", " ", "list", " ", "index"}], "*)"}], 
               "\[IndentingNewLine]", "True", ",", 
               RowBox[{"(*", "error", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"-", "1"}]}], "]"}]}], ")"}], "=!=", 
           RowBox[{"-", "1"}]}]}], ",", "tmp", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"A", ",", "uds", ",", "index"}], "]"}], ",", 
           RowBox[{"FontColor", "->", "Red"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.520605892252281*^9, {3.520605965616035*^9, 3.5206059778487043`*^9}, {
   3.5246161897855*^9, 3.524616221712633*^9}, {3.52461758210124*^9, 
   3.5246176101621227`*^9}, {3.524621754894805*^9, 3.524621806113892*^9}, {
   3.524655632242281*^9, 3.524655692522332*^9}, {3.524672449476449*^9, 
   3.524672535752029*^9}, {3.524672577490987*^9, 3.524672647677272*^9}, {
   3.524673874776582*^9, 3.5246738755696077`*^9}, {3.52470423871179*^9, 
   3.524704294815878*^9}, {3.524708251775449*^9, 3.524708253374915*^9}, {
   3.524709448953209*^9, 3.5247094546399803`*^9}, {3.524743197891663*^9, 
   3.524743330350456*^9}, {3.524743378752625*^9, 3.524743438017548*^9}, {
   3.5247434936732616`*^9, 3.524743502519956*^9}, {3.5247438771976137`*^9, 
   3.52474390458594*^9}, {3.524884358808598*^9, 3.524884410440493*^9}, 
   3.5249285493450193`*^9, {3.526089507784247*^9, 3.526089706810973*^9}, {
   3.526089745962099*^9, 3.526089770671084*^9}, {3.526089860395155*^9, 
   3.526089933261153*^9}, {3.5260903715710278`*^9, 3.526090372364642*^9}, {
   3.526130299002017*^9, 3.5261303111851254`*^9}, {3.526250468315283*^9, 
   3.526250547045397*^9}, {3.526925641076002*^9, 3.526925719519319*^9}, {
   3.5269258354644213`*^9, 3.526925868285638*^9}, {3.5269259958136683`*^9, 
   3.526926112996401*^9}, {3.52733640943672*^9, 3.527336474994605*^9}, {
   3.527336536632595*^9, 3.52733655202465*^9}, {3.527336622104604*^9, 
   3.527336681218379*^9}, {3.527336744320376*^9, 3.5273367602419577`*^9}, {
   3.5273368012286167`*^9, 3.527336828448324*^9}, {3.527337169109803*^9, 
   3.5273372474556103`*^9}, {3.527337285871078*^9, 3.527337359249517*^9}, {
   3.527337408419754*^9, 3.527337409826665*^9}, {3.527337447687907*^9, 
   3.527337584863031*^9}, {3.527337665042701*^9, 3.527337780717963*^9}, 
   3.527337822656946*^9, {3.527337909695936*^9, 3.5273380635734797`*^9}, {
   3.527338128606709*^9, 3.527338137622954*^9}, {3.542807695464113*^9, 
   3.542807825902419*^9}, {3.542807869536427*^9, 3.542807870046032*^9}, 
   3.542807913362625*^9, {3.5436671197325087`*^9, 3.543667131874216*^9}, {
   3.543669777075658*^9, 3.543669832852623*^9}, {3.5436700327751923`*^9, 
   3.543670035086544*^9}, {3.5436702955328903`*^9, 3.543670315163862*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"subWeyl", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "\[Alpha]", "]"}], ".", "A", ".", 
        "\[Beta]"}], "->", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"Transpose", "[", "\[Beta]", "]"}], ".", 
         RowBox[{"Transpose", "[", "A", "]"}], ".", "\[Alpha]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Chi]", ".", "\[Lambda]"}], "->", 
       RowBox[{
        RowBox[{"Transpose", "[", "\[Chi]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"\[Sigma]u", "[", "2", "]"}]}], ")"}], ".", "\[Lambda]"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Chi]", "_"], ".", 
        OverscriptBox["\[Lambda]", "_"]}], "->", 
       RowBox[{
        SuperscriptBox["\[Chi]", "\[Dagger]"], ".", 
        RowBox[{"(", 
         RowBox[{"I", " ", 
          RowBox[{"\[Sigma]u", "[", "2", "]"}]}], ")"}], ".", 
        RowBox[{"Transpose", "[", 
         SuperscriptBox["\[Lambda]", "\[Dagger]"], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Chi]", ".", "\[Lambda]"}], "->", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]u", "[", 
          RowBox[{"d0", "@", "a"}], "]"}], ".", 
         RowBox[{"T", "[", 
          RowBox[{"\[Lambda]", ",", "\"\<d\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"d0", "@", "a"}], "}"}]}], "]"}]}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Chi]d", "[", 
           RowBox[{"d0", "@", "a"}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"T", "[", 
             RowBox[{"\[Sigma]", ",", "\"\<uuu\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"d0", "@", "a"}], ",", 
                RowBox[{"d0", "@", "b"}]}], "}"}]}], "]"}]}], ")"}], ".", 
          RowBox[{"T", "[", 
           RowBox[{"\[Lambda]", ",", "\"\<d\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"d0", "@", "a"}], "}"}]}], "]"}]}], "->", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Chi]d", "[", "2", "]"}], ".", 
           RowBox[{"\[Lambda]d", "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"\[Chi]d", "[", "1", "]"}], ".", 
           RowBox[{"\[Lambda]d", "[", "2", "]"}]}]}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        OverscriptBox["\[Chi]", "_"], ".", 
        RowBox[{"T", "[", 
         RowBox[{
          OverscriptBox["\[Sigma]", "_"], ",", "\"\<u\>\"", ",", 
          RowBox[{"{", "\[Mu]", "}"}]}], "]"}], ".", "\[Lambda]"}], "->", 
       RowBox[{"-", 
        RowBox[{"\[Lambda]", ".", 
         RowBox[{"\[Sigma]u", "[", "\[Mu]", "]"}], ".", 
         OverscriptBox["\[Chi]", "_"]}]}]}]}], "\[IndentingNewLine]", "}"}]}],
    "]"}], 
  RowBox[{"(*", 
   RowBox[{"ref", ":", "Labelle"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.526926138138111*^9, 3.526926216208303*^9}, {
  3.526926269065487*^9, 3.526926736821856*^9}, {3.5269273571500263`*^9, 
  3.526927472008397*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       InterpretationBox[
        TemplateBox[{"\[Alpha]","T"},
         "Superscript"],
        Transpose[$CellContext`\[Alpha]],
        Editable->False,
        SyntaxForm->Automatic], ".", "A", ".", "\[Beta]"}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        InterpretationBox[
         TemplateBox[{"\[Beta]","T"},
          "Superscript"],
         Transpose[$CellContext`\[Beta]],
         Editable->False,
         SyntaxForm->Automatic], ".", 
        InterpretationBox[
         TemplateBox[{"A","T"},
          "Superscript"],
         Transpose[$CellContext`A],
         Editable->False,
         SyntaxForm->Automatic], ".", "\[Alpha]"}]}]}]},
    {
     RowBox[{
      RowBox[{"\[Chi]", ".", "\[Lambda]"}], "\[Rule]", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{"\[Chi]","T"},
         "Superscript"],
        Transpose[$CellContext`\[Chi]],
        Editable->False,
        SyntaxForm->Automatic], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"\[Sigma]u", "[", "2", "]"}]}], ")"}], ".", 
       "\[Lambda]"}]}]},
    {
     RowBox[{
      RowBox[{
       OverscriptBox["\[Chi]", "_"], ".", 
       OverscriptBox["\[Lambda]", "_"]}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["\[Chi]", "\[Dagger]"], ".", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"\[Sigma]u", "[", "2", "]"}]}], ")"}], ".", 
       InterpretationBox[
        TemplateBox[{SuperscriptBox["\[Lambda]", "\[Dagger]"],"T"},
         "Superscript"],
        Transpose[
         SuperDagger[$CellContext`\[Lambda]]],
        Editable->False,
        SyntaxForm->Automatic]}]}]},
    {
     RowBox[{
      RowBox[{"\[Chi]", ".", "\[Lambda]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]u", "[", 
         RowBox[{"d0", "[", "a", "]"}], "]"}], ".", 
        InterpretationBox[
         SubsuperscriptBox["\[Lambda]", 
          RowBox[{"d0", "[", "a", "]"}], 
          StyleBox[
           RowBox[{"d0", "[", "a", "]"}],
           StripOnInput->False,
           ShowContents->False]],
         TensorCalculus5`Tensorial`Tensor[$CellContext`\[Lambda], {
          TensorCalculus5`Tensorial`Void}, {
           $CellContext`d0[$CellContext`a]}],
         BaseStyle->{AutoMultiplicationSymbol -> False},
         Editable->False]}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Chi]d", "[", 
          RowBox[{"d0", "[", "a", "]"}], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           InterpretationBox[
            SubsuperscriptBox["\[Sigma]", 
             StyleBox[
              RowBox[{"2", 
               RowBox[{"d0", "[", "a", "]"}], 
               RowBox[{"d0", "[", "b", "]"}]}],
              StripOnInput->False,
              ShowContents->False], 
             RowBox[{"2", 
              RowBox[{"d0", "[", "a", "]"}], 
              RowBox[{"d0", "[", "b", "]"}]}]],
            TensorCalculus5`Tensorial`Tensor[$CellContext`\[Sigma], {2, 
              $CellContext`d0[$CellContext`a], 
              $CellContext`d0[$CellContext`b]}, {
             TensorCalculus5`Tensorial`Void, TensorCalculus5`Tensorial`Void, 
              TensorCalculus5`Tensorial`Void}],
            BaseStyle->{AutoMultiplicationSymbol -> False},
            Editable->False]}], ")"}], ".", 
         InterpretationBox[
          SubsuperscriptBox["\[Lambda]", 
           RowBox[{"d0", "[", "a", "]"}], 
           StyleBox[
            RowBox[{"d0", "[", "a", "]"}],
            StripOnInput->False,
            ShowContents->False]],
          
          TensorCalculus5`Tensorial`Tensor[$CellContext`\[Lambda], {
           TensorCalculus5`Tensorial`Void}, {
            $CellContext`d0[$CellContext`a]}],
          BaseStyle->{AutoMultiplicationSymbol -> False},
          Editable->False]}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Chi]d", "[", "1", "]"}], ".", 
           RowBox[{"\[Lambda]d", "[", "2", "]"}]}]}], "+", 
         RowBox[{
          RowBox[{"\[Chi]d", "[", "2", "]"}], ".", 
          RowBox[{"\[Lambda]d", "[", "1", "]"}]}]}]}]}]}]},
    {
     RowBox[{
      RowBox[{
       OverscriptBox["\[Chi]", "_"], ".", 
       InterpretationBox[
        SubsuperscriptBox[
         OverscriptBox["\[Sigma]", "_"], 
         StyleBox["\[Mu]",
          StripOnInput->False,
          ShowContents->False], "\[Mu]"],
        TensorCalculus5`Tensorial`Tensor[
         OverBar[$CellContext`\[Sigma]], {$CellContext`\[Mu]}, {
         TensorCalculus5`Tensorial`Void}],
        BaseStyle->{AutoMultiplicationSymbol -> False},
        Editable->False], ".", "\[Lambda]"}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{"\[Lambda]", ".", 
        RowBox[{"\[Sigma]u", "[", "\[Mu]", "]"}], ".", 
        OverscriptBox["\[Chi]", "_"]}]}]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.547820379036484*^9, 3.5478256771307507`*^9}]
}, Open  ]],

Cell["Miscellaneous definitions", "Text",
 CellChangeTimes->{{3.485083480854147*^9, 3.485083490255464*^9}, {
  3.4850835217142973`*^9, 3.485083533034357*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MassUnits", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"length", "->", 
     FractionBox["1", "m"]}], ",", 
    RowBox[{
     SubscriptBox["m", "planck"], "->", 
     FractionBox["1", 
      SqrtBox["G"]]}], ",", 
    RowBox[{"Lagrangian", "->", 
     RowBox[{"m", "^", "4"}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4850835445078506`*^9, 3.485083585034176*^9}, {
   3.485083644744738*^9, 3.48508364782342*^9}, {3.4850855347249203`*^9, 
   3.485085550314015*^9}, {3.495645244961618*^9, 3.495645284949552*^9}, {
   3.5245112019172907`*^9, 3.5245112214587584`*^9}, 3.524511274282515*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"length", "\[Rule]", 
    FractionBox["1", "m"]}], ",", 
   RowBox[{
    SubscriptBox["m", "planck"], "\[Rule]", 
    FractionBox["1", 
     SqrtBox["G"]]}], ",", 
   RowBox[{"Lagrangian", "\[Rule]", 
    SuperscriptBox["m", "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.547820376514102*^9, 3.5478203791363697`*^9}, 
   3.547825677160561*^9, 3.547830444275092*^9, 3.547866678772499*^9, 
   3.547913473884317*^9, 3.547913615618163*^9, 3.547914570711624*^9, 
   3.547914896384184*^9, 3.5480962825560303`*^9, 3.548731323300321*^9, 
   3.549375884527907*^9, 3.5496366197878017`*^9, 3.5509743576110277`*^9, 
   3.551112140012458*^9, 3.5511947178428717`*^9}]
}, Open  ]],

Cell["Examples of Units and Conversion Factors Commonly Used", "Text",
 CellChangeTimes->{{3.49641882339751*^9, 3.4964188260087557`*^9}, {
  3.4964189487767067`*^9, 3.496418974241778*^9}, {3.4964190167969713`*^9, 
  3.496419068627851*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IncludeUnits", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"<<", "PhysicalConstants`"}], "\[IndentingNewLine]", 
        RowBox[{"<<", "Units`"}], "\[IndentingNewLine]", 
        RowBox[{"PR1X", "[", 
         RowBox[{
          RowBox[{"CG", "[", "\"\<eV units conversion:\>\"", "]"}], ",", "NL",
           ",", "\n", "\"\<Rule[Kilogram -> ElectronVolt]\>\"", ",", "NL", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Kg2eV", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Newton", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Kilogram", " ", 
                RowBox[{"Meter", "/", 
                 SuperscriptBox["Second", "2"]}]}], ")"}]}], ",", 
             RowBox[{"Kilogram", "->", 
              RowBox[{
               RowBox[{"Convert", "[", 
                RowBox[{"Kilogram", ",", 
                 RowBox[{"Joule", "/", 
                  RowBox[{"SpeedOfLight", "^", "2"}]}]}], "]"}], 
               RowBox[{"SpeedOfLight", "^", "2"}]}]}], ",", 
             RowBox[{"Joule", "\[Rule]", 
              RowBox[{"Convert", "[", 
               RowBox[{"Joule", ",", " ", "ElectronVolt"}], "]"}]}]}], 
            "}"}]}], ",", "NL", ",", "\[IndentingNewLine]", 
          "\"\<Example of the conversion of gravitational constant to Planck \
mass starting with \>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"tmpMpl2", "=", 
           RowBox[{"tmp", "=", 
            RowBox[{"HoldForm", "[", 
             RowBox[{
              SuperscriptBox[
               SubscriptBox["m", "pl"], "2"], "->", 
              RowBox[{"PlanckConstantReduced", " ", 
               RowBox[{
               "SpeedOfLight", " ", "/", "GravitationalConstant"}]}]}], 
             "]"}]}]}], ",", "yield", ",", "\[IndentingNewLine]", 
          RowBox[{"tmpMpl", "=", 
           RowBox[{"tmp", "=", 
            RowBox[{"ReleaseHold", "[", "tmp", "]"}]}]}], ",", "yield", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"(", 
            RowBox[{"tmpMpl", "//.", "Kg2eV"}], ")"}]}], ",", "yield", ",", 
          RowBox[{"tmp", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              SqrtBox[
               RowBox[{"#", " "}]], "&"}], ",", "tmp"}], "]"}]}], ",", 
          "yield", ",", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"MapAt", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", " ", "SpeedOfLight"}], "&"}], ",", "tmp", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "//", "PowerExpand"}]}], ",", 
          "NL", ",", "\[IndentingNewLine]", 
          RowBox[{"CG", "[", "\"\<Convert2eVRule\>\"", "]"}], ",", "NL", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Convert2eVRule", "=", "Kg2eV"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"sub", "=", 
            RowBox[{"HoldForm", "[", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"PlanckConstant", "==", "1"}], ",", 
                RowBox[{"{", "Second", "}"}]}], "]"}], "/.", "Kg2eV"}], 
             "]"}]}]}], ",", "yield", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Convert2eVRule", ",", 
            RowBox[{"ReleaseHold", "[", "sub", "]"}]}], "]"}], ",", "NL", ",",
           "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"HoldForm", "[", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{"SpeedOfLight", "==", "1"}], ",", 
              RowBox[{"{", "Meter", "}"}]}], "]"}], "]"}]}], ",", "yield", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Convert2eVRule", ",", 
            RowBox[{"ReleaseHold", "[", "tmp", "]"}]}], "]"}], ",", "NL", ",",
           "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Barn", "->", 
              RowBox[{"Convert", "[", 
               RowBox[{"Barn", ",", 
                RowBox[{"Meter", "^", "2"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"TeV", "->", 
              RowBox[{"Tera", " ", "ElectronVolt"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"GeV", "->", 
              RowBox[{"Giga", " ", "ElectronVolt"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MeV", "->", 
              RowBox[{"Mega", " ", "ElectronVolt"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"KeV", "->", 
              RowBox[{"Kilo", " ", "ElectronVolt"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Sec", "->", "Second"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Giga", "->", 
              RowBox[{"Convert", "[", 
               RowBox[{"Giga", ",", "1"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Mega", "->", 
              RowBox[{"Convert", "[", 
               RowBox[{"Mega", ",", "1"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Tera", "->", 
              RowBox[{"Convert", "[", 
               RowBox[{"Tera", ",", "1"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Kilo", "->", 
              RowBox[{"Convert", "[", 
               RowBox[{"Kilo", ",", "1"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Kelvin", "->", 
              RowBox[{"Kelvin", " ", "BoltzmannConstant"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "yield", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Convert2eVRule", ",", "tmp"}], "]"}], ",", "NL", ",", 
          "\[IndentingNewLine]", "Imply", ",", "\[IndentingNewLine]", 
          RowBox[{"Convert2eVRule", "=", 
           RowBox[{"Convert2eVRule", "//", "Flatten"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Function", " ", "definitions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Convert2eV", "[", "exp_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{
           RowBox[{"MKS", "[", "exp", "]"}], "//.", "Convert2eVRule"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Converts", " ", "exp_", " ", "in", " ", "ElectronVolt", " ", "to", 
         " ", "Meters", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"simple", " ", "case"}], ")"}], "."}]}], "  ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Convert2Meter", "[", "exp_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tmp", "=", 
            RowBox[{"Convert2eV", "[", "exp", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"a_", " ", "ElectronVolt"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ElectronVolt", "/", 
                 RowBox[{"(", 
                  RowBox[{"PlanckConstant", " ", "SpeedOfLight", " ", "a"}], 
                  ")"}]}], " ", "//", "MKS"}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"a_", " ", "/", "ElectronVolt"}], ")"}], "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"a", " ", "PlanckConstant", " ", "SpeedOfLight"}], 
                  ")"}], "/", "ElectronVolt"}], "//", "MKS"}], 
               ")"}]}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Approximate", " ", "conversion", " ", "from", " ", 
         RowBox[{"Exp", "[", "a_", "]"}], " ", "to", " ", 
         RowBox[{"Power", "[", 
          RowBox[{"10", ",", "b"}], "]"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"E2Base10Approximate", "=", 
        RowBox[{
         RowBox[{"E", "^", "b_"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"b", "/", 
                RowBox[{"Log", "[", "10", "]"}]}], "//", "N"}], "//", 
              "Expand"}], ")"}]}], "/.", 
           RowBox[{"a_Real", "\[RuleDelayed]", 
            RowBox[{"Round", "[", "a", "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Approximates", " ", "Times", " ", "exp", " ", "with", " ", 
         RowBox[{"Power", "[", 
          RowBox[{"10", ","}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ApproximateExp10", "[", "exp__", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{"Times", "->", "xTimes"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"tmp", "/.", 
                RowBox[{
                 RowBox[{"xTimes", "[", "a__", "]"}], ":>", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"PowerExpand", "[", 
                   RowBox[{"Log", "[", 
                    RowBox[{"Times", "[", "a", "]"}], "]"}], "]"}], "]"}]}]}],
                "/.", 
               RowBox[{"xTimes", "->", "Times"}]}], "//", "PowerExpand"}], "//",
              "ExpandAll"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "/.", "E2Base10Approximate"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IncludeUnitsExamples", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IncludeUnits", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PR1", "[", 
       RowBox[{
       "\"\<Sometimes difficult to use Units, e.g. Coulomb force between 2 \
charges in terms of Newtons: \>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", " ", 
         RowBox[{
          RowBox[{"qd", "[", "1", "]"}], 
          RowBox[{
           RowBox[{"qd", "[", "2", "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"4", "\[Pi]", " ", 
             RowBox[{"\[Epsilon]d", "[", "0", "]"}], 
             RowBox[{"r", "^", "2"}]}], ")"}]}]}]}], ",", "yield", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"qd", "[", "_", "]"}], "->", "ElectronCharge"}]}], "/.", 
          RowBox[{
           RowBox[{"\[Epsilon]d", "[", "0", "]"}], "->", 
           "VacuumPermittivity"}]}]}], ",", "NL", ",", "\[IndentingNewLine]", 
        "\"\<Using MKS does not change expression: \>\"", ",", "yield", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "MKS"}]}], ",", "NL", ",", 
        "\[IndentingNewLine]", "\"\<But must substitute for MKS units: \>\"", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ampere", " ", "->", 
            RowBox[{"Coulomb", "/", "Second"}]}], ",", 
           RowBox[{"Coulomb", "->", 
            RowBox[{"Newton", " ", 
             RowBox[{"Meter", "/", "Volt"}]}]}]}], "}"}]}], ",", "Imply", ",",
         "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}], ",", "NL", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Hold", "[", 
          RowBox[{"Convert2eV", "[", "Gram", "]"}], "]"}]}], ",", "yield", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ReleaseHold", "[", "tmp", "]"}], ",", "NL", ",", 
        "\[IndentingNewLine]", 
        "\"\<Example of approximately converting Power[E,b_]->Power[10,b]: \>\
\"", ",", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"17", "+", 
             FractionBox["58", 
              RowBox[{"2", "+", "n"}]]}]], " ", "ElectronVolt", " ", "Tera"}],
           "1000000000000"]}], ",", "yield", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"E", "^", "b_"}], ":>", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"b", "/", 
                RowBox[{"Log", "[", "10", "]"}]}], "//", "N"}], "//", 
              "Expand"}], ")"}]}]}]}], "/.", 
         RowBox[{"a_Real", "\[RuleDelayed]", 
          RowBox[{"Round", "[", "a", "]"}]}]}], ",", "yield", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "/.", "E2Base10Approximate"}], ",", "NL", ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\"\<Example of the conversion of gravitational constant to Planck \
mass starting with \>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"tmpMpl2", "=", 
         RowBox[{"tmp", "=", 
          RowBox[{"HoldForm", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Md", "[", "pl", "]"}], "2"], "->", 
            RowBox[{"PlanckConstantReduced", " ", 
             RowBox[{"SpeedOfLight", " ", "/", "GravitationalConstant"}]}]}], 
           "]"}]}]}], ",", "yield", ",", "\[IndentingNewLine]", 
        RowBox[{"subMpl", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             SqrtBox["#"], "&"}], ",", 
            RowBox[{
             RowBox[{"ReleaseHold", "[", "tmp", "]"}], "//", "Convert2eV"}]}],
            "]"}], "//", "PowerExpand"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.49641885424757*^9, 3.496418880043378*^9}, {
   3.4964189267534037`*^9, 3.49641894495467*^9}, {3.4964255268278522`*^9, 
   3.496425527737866*^9}, {3.4964260478286543`*^9, 3.496426073382682*^9}, {
   3.4964546814264317`*^9, 3.49645472995441*^9}, 3.496454801668837*^9, {
   3.53246484758603*^9, 3.5324651601415462`*^9}, {3.532465251608416*^9, 
   3.5324652924314423`*^9}, {3.5324654522147512`*^9, 3.532465456487493*^9}, {
   3.532465492407336*^9, 3.532465554104434*^9}, {3.532465665335581*^9, 
   3.532465684084487*^9}, 3.532465715728438*^9, {3.532465822952726*^9, 
   3.532465823111215*^9}, {3.532465927858513*^9, 3.532465928128749*^9}, {
   3.532466056684918*^9, 3.532466084847208*^9}, {3.532479629694721*^9, 
   3.53247991058084*^9}, {3.532479955770701*^9, 3.532479969587*^9}, {
   3.532481391551568*^9, 3.532481399865219*^9}, {3.5325640814499683`*^9, 
   3.532564085311593*^9}, {3.532707279627681*^9, 3.532707316227579*^9}, {
   3.532794012534647*^9, 3.5327940809645557`*^9}, {3.532798489520636*^9, 
   3.532798528590415*^9}, {3.53279866054675*^9, 3.5327986616818132`*^9}, {
   3.532798743956169*^9, 3.532798881466383*^9}, {3.532879938683115*^9, 
   3.532880030680118*^9}, {3.532880097008206*^9, 3.532880183917042*^9}, {
   3.532880467047205*^9, 3.532880522171361*^9}, {3.532880867651002*^9, 
   3.532880939334751*^9}, {3.532880983524947*^9, 3.5328809842868032`*^9}, {
   3.532961503718182*^9, 3.532961505005639*^9}, 3.532961583198737*^9, {
   3.5329616208989697`*^9, 3.532961627897665*^9}, {3.5329617655519133`*^9, 
   3.532961765927465*^9}, {3.5329618711999407`*^9, 3.5329619894600677`*^9}, {
   3.53296202941288*^9, 3.532962031712626*^9}, {3.532962066136867*^9, 
   3.532962238377112*^9}, {3.532962292056538*^9, 3.532962292991395*^9}, {
   3.532962398063451*^9, 3.532962404456727*^9}, {3.5329775189909773`*^9, 
   3.53297752519075*^9}, {3.532977565550764*^9, 3.532977614424314*^9}, {
   3.5329776694590054`*^9, 3.532977669738328*^9}, {3.532977705463848*^9, 
   3.532977789125319*^9}, {3.532977852422513*^9, 3.532977904612093*^9}, {
   3.5329779370920277`*^9, 3.5329779496906223`*^9}, {3.5329779965297747`*^9, 
   3.532978012039523*^9}, {3.532978120901944*^9, 3.532978144508636*^9}, {
   3.5329784195884*^9, 3.532978431996063*^9}, {3.532999112604166*^9, 
   3.532999164273934*^9}, {3.532999303248303*^9, 3.5329993384046793`*^9}, {
   3.5330416237723207`*^9, 3.533041629291442*^9}, {3.533041769957909*^9, 
   3.533041815166103*^9}, {3.5330419284386806`*^9, 3.53304194955867*^9}, {
   3.5330427680013237`*^9, 3.533042859803928*^9}, {3.533042986076407*^9, 
   3.533042997098851*^9}, {3.533043088230221*^9, 3.533043088925621*^9}, {
   3.533043179387241*^9, 3.533043236604085*^9}, {3.533043290565586*^9, 
   3.533043320068049*^9}, {3.533044287801096*^9, 3.5330443851822357`*^9}, {
   3.533044577254253*^9, 3.533044587839011*^9}, {3.533047316182055*^9, 
   3.533047442505707*^9}, {3.5330475411490307`*^9, 3.533047629325034*^9}, {
   3.533047684983759*^9, 3.533047778030324*^9}, {3.533131112854824*^9, 
   3.533131114521841*^9}, {3.533131185668027*^9, 3.533131190635213*^9}, {
   3.533131266972044*^9, 3.533131315331337*^9}, {3.5331313876281023`*^9, 
   3.533131464955112*^9}, {3.533131495890239*^9, 3.53313154206254*^9}, {
   3.53313157217636*^9, 3.533131578567235*^9}, {3.533131649410831*^9, 
   3.533131651273487*^9}, {3.533131689745051*^9, 3.5331317139782677`*^9}, {
   3.533131786479948*^9, 3.533131825069869*^9}, {3.533131857157214*^9, 
   3.533131900628828*^9}, {3.53313194233004*^9, 3.533132014643217*^9}, {
   3.533132082682787*^9, 3.5331320894161673`*^9}, {3.533132700691937*^9, 
   3.533132717923107*^9}, {3.533221492118588*^9, 3.533221505246995*^9}, {
   3.533303072144497*^9, 3.533303098303381*^9}, {3.533303150930786*^9, 
   3.533303163747801*^9}, {3.5333101300795603`*^9, 3.533310238140974*^9}, {
   3.533651675759809*^9, 3.533651675877152*^9}, {3.53394935383978*^9, 
   3.533949412172798*^9}, {3.533951215092396*^9, 3.53395123303251*^9}, {
   3.533951528570695*^9, 3.533951548760564*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IncludeUnitsExamples", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.49641885424757*^9, 3.496418880043378*^9}, {
   3.4964189267534037`*^9, 3.49641894495467*^9}, {3.4964255268278522`*^9, 
   3.496425527737866*^9}, {3.4964260478286543`*^9, 3.496426073382682*^9}, {
   3.4964546814264317`*^9, 3.49645472995441*^9}, 3.496454801668837*^9, {
   3.53246484758603*^9, 3.5324651601415462`*^9}, {3.532465251608416*^9, 
   3.5324652924314423`*^9}, {3.5324654522147512`*^9, 3.532465456487493*^9}, {
   3.532465492407336*^9, 3.532465554104434*^9}, {3.532465665335581*^9, 
   3.532465684084487*^9}, 3.532465715728438*^9, {3.532465822952726*^9, 
   3.532465823111215*^9}, {3.532465927858513*^9, 3.532465928128749*^9}, {
   3.532466056684918*^9, 3.532466084847208*^9}, {3.532479629694721*^9, 
   3.53247991058084*^9}, {3.532479955770701*^9, 3.532479969587*^9}, {
   3.532481391551568*^9, 3.532481399865219*^9}, {3.5325640814499683`*^9, 
   3.532564085311593*^9}, {3.532707279627681*^9, 3.532707316227579*^9}, {
   3.532794012534647*^9, 3.5327940809645557`*^9}, {3.532798489520636*^9, 
   3.532798528590415*^9}, {3.53279866054675*^9, 3.5327986616818132`*^9}, {
   3.532798743956169*^9, 3.532798881466383*^9}, {3.532879938683115*^9, 
   3.532880030680118*^9}, {3.532880097008206*^9, 3.532880183917042*^9}, {
   3.532880467047205*^9, 3.532880522171361*^9}, {3.532880867651002*^9, 
   3.532880939334751*^9}, {3.532880983524947*^9, 3.5328809842868032`*^9}, {
   3.532961503718182*^9, 3.532961505005639*^9}, 3.532961583198737*^9, {
   3.5329616208989697`*^9, 3.532961627897665*^9}, {3.5329617655519133`*^9, 
   3.532961765927465*^9}, {3.5329618711999407`*^9, 3.5329619894600677`*^9}, {
   3.53296202941288*^9, 3.532962031712626*^9}, {3.532962066136867*^9, 
   3.532962238377112*^9}, {3.532962292056538*^9, 3.532962292991395*^9}, {
   3.532962398063451*^9, 3.532962404456727*^9}, {3.5329775189909773`*^9, 
   3.53297752519075*^9}, {3.532977565550764*^9, 3.532977614424314*^9}, {
   3.5329776694590054`*^9, 3.532977669738328*^9}, {3.532977705463848*^9, 
   3.532977789125319*^9}, {3.532977852422513*^9, 3.532977904612093*^9}, {
   3.5329779370920277`*^9, 3.5329779496906223`*^9}, {3.5329779965297747`*^9, 
   3.532978012039523*^9}, {3.532978120901944*^9, 3.532978144508636*^9}, {
   3.5329784195884*^9, 3.532978431996063*^9}, {3.532999112604166*^9, 
   3.532999164273934*^9}, {3.532999303248303*^9, 3.5329993384046793`*^9}, {
   3.5330416237723207`*^9, 3.533041629291442*^9}, {3.533041769957909*^9, 
   3.533041843558215*^9}, {3.533042880343207*^9, 3.5330429292612257`*^9}, {
   3.53304301886476*^9, 3.533043028265432*^9}, {3.53304312235877*^9, 
   3.533043126254244*^9}, {3.533043262828045*^9, 3.533043268130294*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Sometimes difficult to use Units, e.g. Coulomb force between \
2 charges in terms of Newtons: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{"qd", "[", "1", "]"}], " ", 
     RowBox[{"qd", "[", "2", "]"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox["r", "2"], " ", 
     RowBox[{"\[Epsilon]d", "[", "0", "]"}]}]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"2.3070771277361617`*^-28", " ", 
     SuperscriptBox["Coulomb", "2"], " ", "Meter", " ", "Volt"}], 
    RowBox[{"Ampere", " ", 
     SuperscriptBox["r", "2"], " ", "Second"}]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Using MKS does not change expression: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"2.3070771277361617`*^-28", " ", 
     SuperscriptBox["Coulomb", "2"], " ", "Meter", " ", "Volt"}], 
    RowBox[{"Ampere", " ", 
     SuperscriptBox["r", "2"], " ", "Second"}]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"But must substitute for MKS units: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ampere", "\[Rule]", 
      FractionBox["Coulomb", "Second"]}], ",", 
     RowBox[{"Coulomb", "\[Rule]", 
      FractionBox[
       RowBox[{"Meter", " ", "Newton"}], "Volt"]}]}], "}"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\[DoubleRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"2.3070771277361617`*^-28", " ", 
     SuperscriptBox["Meter", "2"], " ", "Newton"}], 
    SuperscriptBox["r", "2"]], "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"Hold", "[", 
    RowBox[{"Convert2eV", "[", "Gram", "]"}], "]"}], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{"5.609589118485282`*^32", " ", "ElectronVolt"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Example of approximately converting \
Power[E,b_]->Power[10,b]: \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"17", "+", 
       FractionBox["58", 
        RowBox[{"2", "+", "n"}]]}]], " ", "ElectronVolt", " ", "Tera"}], 
    "1000000000000"], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{
      RowBox[{"-", "5"}], "+", 
      FractionBox["25", 
       RowBox[{"2", "+", "n"}]]}]], " ", "ElectronVolt", " ", "Tera"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{
      RowBox[{"-", "5"}], "+", 
      FractionBox["25", 
       RowBox[{"2", "+", "n"}]]}]], " ", "ElectronVolt", " ", "Tera"}], 
   "\[InvisibleSpace]", 
   StyleBox["\<\"\\n\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   StyleBox["\<\"Example of the conversion of gravitational constant to \
Planck mass starting with \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"Md", "[", "pl", "]"}], "2"], "\[Rule]", 
     FractionBox[
      RowBox[{"PlanckConstantReduced", " ", "SpeedOfLight"}], 
      "GravitationalConstant"]}],
    HoldForm], "\[InvisibleSpace]", 
   StyleBox["\<\" \[LongRightArrow] \"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontSize->Larger,
    FontColor->RGBColor[0, 0, 1]], "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"Md", "[", "pl", "]"}], "\[Rule]", 
    RowBox[{"1.220891960213565`*^28", " ", "ElectronVolt"}]}]}],
  SequenceForm[
   Style["Sometimes difficult to use Units, e.g. Coulomb force between 2 \
charges in terms of Newtons: ", 
    RGBColor[0, 0, 1], 
    Larger], (((Rational[1, 4]/Pi) $CellContext`r^(-2)) $CellContext`qd[
     1]) ($CellContext`qd[2]/$CellContext`\[Epsilon]d[0]), 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], (((((2.3070771277361617`*^-28/Units`Ampere) Units`Coulomb^2) 
      Units`Meter) $CellContext`r^(-2))/Units`Second) Units`Volt, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Using MKS does not change expression: ", 
    RGBColor[0, 0, 1], Larger], 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], 
    Larger], (((((2.3070771277361617`*^-28/Units`Ampere) Units`Coulomb^2) 
      Units`Meter) $CellContext`r^(-2))/Units`Second) Units`Volt, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["But must substitute for MKS units: ", 
    RGBColor[0, 0, 1], Larger], {
   Units`Ampere -> Units`Coulomb/Units`Second, Units`Coulomb -> 
    Units`Meter (Units`Newton/Units`Volt)}, 
   Style["\n\[DoubleRightArrow] ", 
    RGBColor[0, 0, 1], Larger], ((2.3070771277361617`*^-28 Units`Meter^2) 
    Units`Newton) $CellContext`r^(-2), 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Hold[
    $CellContext`Convert2eV[Units`Gram]], 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], 5.609589118485282*^32 Units`ElectronVolt, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Example of approximately converting Power[E,b_]->Power[10,b]: ", 
    RGBColor[0, 0, 1], 
    Larger], ((Rational[1, 1000000000000] E^(17 + 58/(2 + $CellContext`n))) 
    Units`ElectronVolt) Units`Tera, 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], (10^(-5 + 25/(2 + $CellContext`n)) 
    Units`ElectronVolt) Units`Tera, 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], (10^(-5 + 25/(2 + $CellContext`n)) 
    Units`ElectronVolt) Units`Tera, 
   Style["\n", 
    RGBColor[0, 0, 1], Larger], 
   Style["Example of the conversion of gravitational constant to Planck mass \
starting with ", 
    RGBColor[0, 0, 1], Larger], 
   HoldForm[$CellContext`Md[$CellContext`pl]^2 -> 
    PhysicalConstants`PlanckConstantReduced (PhysicalConstants`SpeedOfLight/
      PhysicalConstants`GravitationalConstant)], 
   Style[" \[LongRightArrow] ", 
    RGBColor[0, 0, 1], Larger], $CellContext`Md[$CellContext`pl] -> 
   1.220891960213565*^28 Units`ElectronVolt],
  Editable->False]], "Print",
 CellChangeTimes->{{3.54782037745172*^9, 3.5478203792081747`*^9}, 
   3.5478256774374523`*^9, 3.547830444341476*^9, 3.547866678945025*^9, 
   3.547913473959766*^9, 3.5479136162293987`*^9, 3.547914571157578*^9, 
   3.5479148970334883`*^9, 3.548096283224153*^9}]
}, Open  ]],

Cell["Gamma matrix technology", "Text",
 CellChangeTimes->{{3.475328083875739*^9, 3.4753280940834923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Gamma", " ", "matrix", " ", "identities"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"psa16", "=", 
     RowBox[{
      RowBox[{"ACommutator", "[", 
       RowBox[{
        RowBox[{"\[Gamma]u", "[", "\[Mu]_", "]"}], ",", 
        RowBox[{"\[Gamma]u", "[", "\[Nu]_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"guu", "[", 
         RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "\[Mu]"}],
          "]"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "\[Nu]"}],
          "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psa16a", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]u", "[", "\[Mu]_", "]"}], ".", 
       RowBox[{"\[Gamma]u", "[", "\[Nu]_", "]"}]}], ":>", 
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"guu", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "\[Nu]", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "\[Mu]", "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "\[Mu]"}],
          "]"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "\[Nu]"}],
          "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps368", "=", 
     RowBox[{
      RowBox[{"\[Gamma]u", "[", "5", "]"}], "->", 
      RowBox[{"I", " ", 
       RowBox[{
        RowBox[{"\[Gamma]u", "[", "0", "]"}], ".", 
        RowBox[{"\[Gamma]u", "[", "1", "]"}], ".", 
        RowBox[{"\[Gamma]u", "[", "2", "]"}], ".", 
        RowBox[{"\[Gamma]u", "[", "3", "]"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps369", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[Gamma]u", "[", "5", "]"}], "]"}], "->", 
        RowBox[{"\[Gamma]u", "[", "5", "]"}]}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "0", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "5", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "0", "]"}]}], "->", 
        RowBox[{"\[Gamma]u", "[", "5", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wiki1", "=", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"\[Gamma]u", "[", "i_", "]"}], "]"}], "->", 
      RowBox[{
       RowBox[{"\[Gamma]u", "[", "0", "]"}], ".", 
       RowBox[{"\[Gamma]u", "[", "i", "]"}], ".", 
       RowBox[{"\[Gamma]u", "[", "0", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps370", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]u", "[", "5", "]"}], ".", 
       RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "->", "1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps371", "=", 
     RowBox[{
      RowBox[{"ACommutator", "[", 
       RowBox[{
        RowBox[{"\[Gamma]u", "[", "\[Mu]", "]"}], ",", 
        RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps55a", "=", 
     RowBox[{
      RowBox[{"Tr", "[", "Id", "]"}], "->", "4"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps55b", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}]}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "5"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "d_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "e_", "]"}]}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}], ",",
            "5"}], "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps55c", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "\[Mu]_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "\[Nu]_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"guu", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], ",", "5"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "\[Mu]_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "\[Nu]_", "]"}]}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Mu]", "===", "5"}], "&&", 
            RowBox[{"\[Nu]", "=!=", "5"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Mu]", "=!=", "5"}], "&&", 
            RowBox[{"\[Nu]", "===", "5"}]}], ")"}]}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps55d", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "d_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"guu", "[", 
              RowBox[{"a", ",", "b"}], "]"}], 
             RowBox[{"guu", "[", 
              RowBox[{"c", ",", "d"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"guu", "[", 
              RowBox[{"a", ",", "c"}], "]"}], 
             RowBox[{"guu", "[", 
              RowBox[{"b", ",", "d"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"guu", "[", 
              RowBox[{"a", ",", "d"}], "]"}], 
             RowBox[{"guu", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}]}], ")"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", "5"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "d_", "]"}]}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", "5"}], 
           "]"}], "===", "1"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps55e", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"\[Gamma]u", "[", "5", "]"}], "]"}], "->", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}]}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], ",", "5"}], "]"}], "===", 
          "1"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}]}], "]"}], ":>", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "5"}], "]"}], "===",
           "1"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psA27g", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "d_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "I", " ", 
         RowBox[{"\[Epsilon]uuuu", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "5", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "d_", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "I", " ", 
         RowBox[{"\[Epsilon]uuuu", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psA29", "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"Einstein", " ", 
        RowBox[{"summed", ".", " ", "sLowerAllIndices"}], " ", "NEEDS", " ", 
        "to", " ", "be", " ", "handled", " ", 
        RowBox[{"seperately", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Gamma]d", "[", "a_", "]"}]}], "->", "4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
         RowBox[{"\[Gamma]d", "[", "a_", "]"}]}], "->", 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"\[Gamma]u", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
         RowBox[{"\[Gamma]d", "[", "a_", "]"}]}], "->", 
        RowBox[{"4", " ", 
         RowBox[{"guu", "[", 
          RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "d_", "]"}], ".", 
         RowBox[{"\[Gamma]d", "[", "a_", "]"}]}], "->", 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "d", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "c", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "b", "]"}]}]}]}]}], "\[IndentingNewLine]",
       "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Review", " ", "for", " ", "accuracy", " ", "and", " ", "consistency"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpleGammau", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "ps370", ",", "ps369", ",", "wiki1", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "i_", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "i_", "]"}]}], "->", 
         RowBox[{"guu", "[", 
          RowBox[{"i", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "ps55a", ",", "ps55b", ",", "ps55b", ",", "ps55c", ",", "ps55e", ",", 
        "ps55d", ",", "\[IndentingNewLine]", "psA27g", ",", "psA29"}], 
       "\[IndentingNewLine]", "}"}], "//", "DeleteDuplicates"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpleGamma", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"simpleGammau", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"simpleGammau", "//.", 
             RowBox[{"{", 
              RowBox[{"sLowerAllIndices", ",", 
               RowBox[{"guu", "->", "gdd"}]}], "}"}]}], ")"}], ",", 
           "simpleDot"}], "}"}]}], "]"}], "//", "Flatten"}], "//", 
      "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Pauli", " ", 
     RowBox[{"matrices", ".", " ", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{
       "substituting", " ", "into", " ", "function", " ", "arguement", " ", 
        "generates", " ", 
        RowBox[{"errors", "."}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sPauli", "=", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sigma]u", "[", 
         RowBox[{"1", "|", 
          RowBox[{"space", "@", "1"}]}], "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]u", "[", 
         RowBox[{"2", "|", 
          RowBox[{"space", "@", "2"}]}], "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "I"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]u", "[", 
         RowBox[{"3", "|", 
          RowBox[{"space", "@", "3"}]}], "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]d", "[", 
         RowBox[{"1", "|", 
          RowBox[{"space", "@", "1"}]}], "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]d", "[", 
         RowBox[{"2", "|", 
          RowBox[{"space", "@", "2"}]}], "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "I"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]d", "[", 
         RowBox[{"3", "|", 
          RowBox[{"space", "@", "3"}]}], "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]u", "[", "0", "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"this", " ", "may", " ", "cause", " ", "problems"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]d", "[", "0", "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Id", "[", "\[Sigma]", "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "[", "\[Sigma]", "]"}], "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]",
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "in", " ", "cases", " ", "where", " ", "exp_", " ", "contains", " ", 
     RowBox[{"\[Sigma]", "'"}], "s", " ", "as", " ", "submatrices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sPauliFlatten", "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{"exp", "//.", "sPauli"}], "//", "ArrayFlatten"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"SU", "[", "2", "]"}], " ", "\[Sigma]", " ", "commutation", " ", 
     "relationship"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"su2commutation", "[", 
     RowBox[{"lab_", ",", "a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MCommutator", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", 
         RowBox[{"lab", ",", 
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "Void", "}"}]}], "]"}], ",", 
        RowBox[{"Tensor", "[", 
         RowBox[{"lab", ",", 
          RowBox[{"{", "b", "}"}], ",", 
          RowBox[{"{", "Void", "}"}]}], "]"}]}], "]"}], "->", 
      RowBox[{"I", " ", 
       RowBox[{"\[Epsilon]uuu", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
       RowBox[{"Tensor", "[", 
        RowBox[{"lab", ",", 
         RowBox[{"{", "c", "}"}], ",", 
         RowBox[{"{", "Void", "}"}]}], "]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rule", " ", "that", " ", "simplifies", " ", 
     RowBox[{"Dot", "[", 
      RowBox[{"\[Sigma]u", "[", "n", "]"}], "]"}], " ", "expressions", " ", 
     "where", " ", "n", " ", "is", " ", "Numeric", " ", 
     RowBox[{"value", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplePauli", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"0", "[", "\[Sigma]", "]"}], " ", ".", "  ", "a_"}], "->", 
        RowBox[{"0", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a_", " ", ".", "  ", 
         RowBox[{"0", "[", "\[Sigma]", "]"}]}], "->", 
        RowBox[{"0", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "0", "]"}], "|", 
         RowBox[{"\[Sigma]d", "[", "0", "]"}]}], "->", 
        RowBox[{"Id", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Id", "[", "\[Sigma]", "]"}], ".", 
         RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "->", 
        RowBox[{"Id", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         OverscriptBox[
          RowBox[{"Id", "[", "\[Sigma]", "]"}], "_"], "|", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"Id", "[", "\[Sigma]", "]"}], "]"}], "|", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Id", "[", "\[Sigma]", "]"}], "]"}]}], "->", 
        RowBox[{"Id", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Id", "[", "\[Sigma]", "]"}], " ", ".", " ", "a_"}], "->", 
        "a"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a_", " ", ".", " ", 
         RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "->", "a"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Id", "[", "\[Sigma]", "]"}], ".", 
         RowBox[{"\[Sigma]d", "[", "a_", "]"}]}], "->", 
        RowBox[{"\[Sigma]d", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], ".", 
         RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "->", 
        RowBox[{"\[Sigma]d", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Id", "[", "\[Sigma]", "]"}], ".", 
         RowBox[{"\[Sigma]u", "[", "a_", "]"}]}], "->", 
        RowBox[{"\[Sigma]u", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], ".", 
         RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "->", 
        RowBox[{"\[Sigma]u", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a__", " ", 
         RowBox[{"0", "[", "\[Sigma]", "]"}]}], "->", 
        RowBox[{"0", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"0", "[", "\[Sigma]", "]"}], "+", "a__"}], "->", "a"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"b__", "+", 
         RowBox[{"0", "[", "\[Sigma]", "]"}]}], "->", "b"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{"a__", ",", 
          RowBox[{"0", "[", "\[Sigma]", "]"}]}], "]"}], "->", 
        RowBox[{"0", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{
          RowBox[{"0", "[", "\[Sigma]", "]"}], ",", "a__"}], "]"}], "->", 
        RowBox[{"0", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"a___", ",", 
          RowBox[{"0", "[", "\[Sigma]", "]"}], ",", "b___"}], "]"}], ":>", 
        RowBox[{"a", "+", "b"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "]"}], "->", 
        RowBox[{"\[Sigma]u", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "]"}], "->", 
        RowBox[{"\[Sigma]d", "[", "a", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"\[Sigma]d", "[", "a", "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "3", ",", 
              RowBox[{"space", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}]}]}], "}"}], "]"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "a", "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "3", ",", 
              RowBox[{"space", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}]}]}], "}"}], "]"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]d", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"space", "@", "2"}]}], "}"}], ",", "a"}], "]"}]}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]u", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"space", "@", "2"}]}], "}"}], ",", "a"}], "]"}]}]}], ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"\[Sigma]d", "[", "a", "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "3", ",", 
              RowBox[{"space", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}]}]}], "}"}], "]"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "a", "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "3", ",", 
              RowBox[{"space", "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}]}]}], "}"}], "]"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]d", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"space", "/@", "2"}]}], "}"}], "]"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]u", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"space", "/@", "2"}]}], "}"}], "]"}], ",", "a"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], ".", 
         RowBox[{"\[Sigma]d", "[", "b_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"a", ",", "b"}], "]"}], " ", 
             RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "+", 
            RowBox[{"I", "  ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b", ",", "i$"}], "]"}], "]"}], ".", 
                RowBox[{"\[Sigma]d", "[", "i$", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i$", ",", "3"}], "}"}]}], "]"}]}]}], "//.", 
           "simpleDot"}], ")"}], "/;", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", 
               RowBox[{"space", "/@", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "}"}], "]"}], 
            ",", "a"}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", 
               RowBox[{"space", "/@", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "}"}], "]"}], 
            ",", "b"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Sigma]u", "[", "b_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"a", ",", "b"}], "]"}], 
             RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "+", 
            RowBox[{"I", "  ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b", ",", "i$"}], "]"}], "]"}], ".", 
                RowBox[{"\[Sigma]u", "[", "i$", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i$", ",", "3"}], "}"}]}], "]"}]}]}], "//.", 
           "simpleDot"}], ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3", ",", 
                RowBox[{"space", "/@", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "}"}], "]"}], 
             ",", "a"}], "]"}], "&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3", ",", 
                RowBox[{"space", "/@", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "}"}], "]"}], 
             ",", "b"}], "]"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{
          RowBox[{"\[Sigma]u", "[", "a_", "]"}], ",", 
          RowBox[{"\[Sigma]u", "[", "b_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"a", ",", "b"}], "]"}], 
             RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "+", 
            RowBox[{"I", "  ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b", ",", "i$"}], "]"}], "]"}], ".", 
                RowBox[{"\[Sigma]u", "[", "i$", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i$", ",", "3"}], "}"}]}], "]"}]}]}], "//.", 
           "simpleDot"}], ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", 
               RowBox[{"space", "/@", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "}"}], "]"}], 
            ",", "a"}], "]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xDot", "[", 
         RowBox[{
          RowBox[{"\[Sigma]d", "[", "a_", "]"}], ",", 
          RowBox[{"\[Sigma]d", "[", "b_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"a", ",", "b"}], "]"}], 
             RowBox[{"Id", "[", "\[Sigma]", "]"}]}], "+", 
            RowBox[{"I", "  ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b", ",", "i$"}], "]"}], "]"}], ".", 
                RowBox[{"\[Sigma]d", "[", "i$", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i$", ",", "3"}], "}"}]}], "]"}]}]}], "//.", 
           "simpleDot"}], ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", 
               RowBox[{"space", "/@", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "}"}], "]"}], 
            ",", "a"}], "]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        OverscriptBox[
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "_"], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]d", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"space", "@", "2"}]}], "}"}], ",", "a"}], "]"}]}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        OverscriptBox[
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "_"], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]u", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"space", "@", "2"}]}], "}"}], ",", "a"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Applies", " ", "simplePauli", " ", "and", " ", "simpleDot", " ", 
     "repeatedly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simplePauli1", "[", 
      RowBox[{"exp_", ",", "scalar_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{"tmp", "//.", "simplePauli"}], "//.", 
             RowBox[{"simpleDot2", "[", "scalar", "]"}]}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"simplePauli1", "[", "scalar_List", "]"}], "[", "exp_", "]"}], ":=", 
    RowBox[{"simplePauli1", "[", 
     RowBox[{"exp", ",", "scalar"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Substitution", " ", "Rules", " ", "going", " ", "from", " ", "\[Gamma]", 
     " ", "to", " ", "\[Sigma]", " ", 
     RowBox[{"(", "pauli", ")"}], " ", 
     RowBox[{"matrices", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sub\[Gamma]Pauli", "=", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Gamma]u", "[", "5", "]"}], "->", 
        RowBox[{"I", " ", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "0", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "1", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "2", "]"}], ".", 
          RowBox[{"\[Gamma]u", "[", "3", "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Dot", "->", "xDot"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "prevent", " ", "commutative", " ", "multiply", " ", "in", " ", "Dot",
          " ", "operation"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]d", "[", "a_", "]"}], ":>", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "a"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"\[Gamma]u", "[", "a", "]"}]}], ",", 
          RowBox[{"\[Gamma]u", "[", "a", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]u", "[", "a_", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "[", "\[Sigma]", "]"}], ",", 
            RowBox[{"\[Sigma]u", "[", "a", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            OverscriptBox[
             RowBox[{"\[Sigma]u", "[", "a", "]"}], "_"], ",", 
            RowBox[{"0", "[", "\[Sigma]", "]"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        OverscriptBox[
         RowBox[{"\[Sigma]u", "[", "0", "]"}], "_"], "->", 
        RowBox[{"Id", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        OverscriptBox[
         RowBox[{"\[Sigma]d", "[", "0", "]"}], "_"], "->", 
        RowBox[{"Id", "[", "\[Sigma]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        OverscriptBox[
         RowBox[{"\[Sigma]u", "[", "a_", "]"}], "_"], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]u", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "a"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        OverscriptBox[
         RowBox[{"\[Sigma]d", "[", "a_", "]"}], "_"], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]d", "[", "a", "]"}]}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "a"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Sigma]u", "[", "0", "]"}], "|", 
         RowBox[{"\[Sigma]d", "[", "0", "]"}]}], "\[Rule]", 
        RowBox[{"Id", "[", "\[Sigma]", "]"}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"sub\[Gamma]Matrices", ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "->", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{
             RowBox[{"#", "//.", "sub\[Gamma]Pauli"}], "//.", "sPauli"}], 
            "]"}]}], "&"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "->", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{
             RowBox[{"#", "//.", "sub\[Gamma]Pauli"}], "//.", "sPauli"}], 
            "]"}]}], "&"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[Gamma]d", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Evaluates", " ", "xDot", " ", "expression", " ", "using", " ", "Dot", 
     " ", "for", " ", "actual", " ", "matrix", " ", "multiply", " ", "but", 
     " ", "maintaining", " ", "order", " ", "of", " ", "xDot", " ", 
     RowBox[{"terms", ".", "  ", "Used"}], " ", "in", " ", 
     "EvalVia\[Sigma]Matrices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AxDot2Dot", "[", "xDotexp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "a", ",", "A$"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"A$", "[", "#2", "]"}], ",", "#1", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "&"}], ",", "xDotexp", ",", 
           "1"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Mark", " ", "for", " ", "order"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"xDot", "\[Rule]", "Dot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Do", " ", 
          RowBox[{"Dot", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Off", "[", 
         RowBox[{"Dot", "::", "dotsh"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Times", "\[Rule]", "Dot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"fix", " ", 
          RowBox[{"ordering", ".", " ", "This"}], " ", "step", " ", "cause", 
          " ", "error", " ", 
          RowBox[{"messages", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"On", "[", 
         RowBox[{"Dot", "::", "dotsh"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"A$", "[", "_", "]"}], "[", "a_", "]"}], "\[Rule]", 
           "a"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"remove", " ", "ordering", " ", "parameter"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", "simpleDot"}]}], ";", 
        RowBox[{"(*", "simplify", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "//.", "sub\[Gamma]Pauli"}], "/.", 
          RowBox[{"xDot", "\[Rule]", "Dot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"simplify", " ", "\[Sigma]"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", "sPauli"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "expand", " ", "\[Sigma]", " ", "for", " ", "each", " ", "element", 
          " ", "in", " ", 
          RowBox[{"Dot", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ArrayFlatten", "[", "#", "]"}], "&"}], ",", "tmp"}], 
          "]"}]}]}]}], 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Evaluates", " ", "matrix", " ", "exp_", " ", "with", " ", "\[Gamma]", 
     " ", "matrices", " ", "to", " ", "pure", " ", "matrix", " ", 
     "expression", " ", "via", " ", "\[Sigma]", " ", "matrices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EvalVia\[Sigma]Matrices", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "a"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub\[Gamma]Pauli"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xDot", "[", "a___", "]"}], ":>", 
           RowBox[{"AxDot2Dot", "[", 
            RowBox[{"xDot", "[", "a", "]"}], "]"}]}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Evaluates", " ", "xDot", " ", "matrix", " ", "expression", " ", "using",
       " ", "Dot", " ", "for", " ", "actual", " ", "matrix", " ", "multiply", 
      " ", "but", " ", "maintaining", " ", "order", " ", "of", " ", "xDot", 
      " ", 
      RowBox[{"elements", ".", "  ", "The"}], " ", "matrix", " ", "inputs", 
      " ", "all", " ", "must", " ", "have", " ", "the", " ", "same", " ", 
      RowBox[{"size", ".", " ", "This"}], " ", "routine", " ", "is", " ", 
      "useful", " ", "when", " ", "matrix", " ", "elements", " ", "are", " ", 
      "matrices", " ", 
      RowBox[{"themselves", ".", " ", "e", ".", "g", "."}]}], ",", " ", 
     RowBox[{
      RowBox[{"xDot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "b1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c1", ",", "d1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a2", ",", "b2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c2", ",", "d2"}], "}"}]}], "}"}]}], "]"}], "->", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{
            RowBox[{"a1", ".", "a2"}], "+", 
            RowBox[{"b1", ".", "c2"}]}], 
           RowBox[{
            RowBox[{"a1", ".", "b2"}], "+", 
            RowBox[{"b1", ".", "d2"}]}]},
          {
           RowBox[{
            RowBox[{"c1", ".", "a2"}], "+", 
            RowBox[{"d1", ".", "c2"}]}], 
           RowBox[{
            RowBox[{"c1", ".", "b2"}], "+", 
            RowBox[{"d1", ".", "d2"}]}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderedxDotMultiply", "[", "exp_xDot", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "a", ",", "A$"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"A$", "[", "#2", "]"}], ",", "#1", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "&"}], ",", "exp", ",", "1"}],
           "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Label", " ", "input", " ", "ordering", " ", "lexiconically"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"xDot", "\[Rule]", "Dot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "rely", " ", "on", " ", "lexiconical", " ", "ordering", " ", "of", 
          " ", "Times"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Times", "\[Rule]", "xDot"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"fix", " ", "ordering", " ", "within", " ", 
          RowBox[{"elements", ".", " ", "CHANGED"}], " ", "from", " ", "Dot", 
          " ", "to", " ", "xDot", " ", "so", " ", "we", " ", "can", " ", 
          "see", " ", 
          RowBox[{"results", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"A$", "[", "_", "]"}], "[", "a_", "]"}], "\[Rule]", 
           "a"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"remove", " ", "ordering", " ", "parameter"}], "*)"}], 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"OrderedxDotMultiplySimpleDot", "[", "scalar_List", "]"}], "[", 
      "exp_xDot", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"OrderedxDotMultiply", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "//.", 
         RowBox[{"simpleDot2", "[", "scalar", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"OrderedxDotMultiplyAll", "[", "scalar_List", "]"}], "[", 
      "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{"tmp", "//.", 
         RowBox[{
          RowBox[{"xDot", "[", "a__", "]"}], ":>", 
          RowBox[{
           RowBox[{"OrderedxDotMultiplySimpleDot", "[", "scalar", "]"}], "[", 
           
           RowBox[{"xDot", "[", "a", "]"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Defines", " ", "SU3", " ", "representations"}], ",", " ", 
     RowBox[{"n", "->", 
      RowBox[{"1", ":", " ", 
       RowBox[{"PS", ".20", ".38"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DefSU3rep", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"n", ",", "1", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DefineTensorShortcuts", "[", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"D", ",", "\[Tau]", ",", "T", ",", "t"}], "}"}], ",", 
              "1"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"SU3rep", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tu", "[", "4", "]"}], "->", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "/", 
                "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tu", "[", "5", "]"}], "->", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "I"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"I", ",", "0", ",", "0"}], "}"}]}], "}"}], "/", 
                "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tu", "[", "6", "]"}], "->", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "/", 
                "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tu", "[", "7", "]"}], "->", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "I"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "I", ",", "0"}], "}"}]}], "}"}], "/", 
                "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tu", "[", "8", "]"}], "->", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "}"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", 
                  SqrtBox["3"]}], ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i$", "=", "1"}], ",", 
             RowBox[{"i$", "<=", "3"}], ",", 
             RowBox[{"i$", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmp", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Sigma]u", "[", "i$", "]"}], "/", "2"}], "/.", 
                "sPauli"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"tmp", "=", 
               RowBox[{"ArrayPad", "[", 
                RowBox[{"tmp", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"SU3rep", ",", 
                RowBox[{
                 RowBox[{"tu", "[", "i$", "]"}], "->", "tmp"}]}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SU3rep", "=", 
            RowBox[{"Sort", "[", "SU3rep", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", "\[IndentingNewLine]", "SU3rep", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Test", " ", "if", " ", "exp_", " ", "is", " ", "Listable", " ", "list", 
     " ", "of", " ", "raw", " ", 
     RowBox[{"\[Gamma]u", "[", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"allGammaQ", "[", "exp_", "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"And", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "#", "}"}], ",", 
            RowBox[{"\[Gamma]u", "[", "_", "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "exp"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Extracts", " ", "list", " ", "of", " ", "indices", " ", "from", " ", 
     "dot", " ", "product", " ", "of", " ", 
     RowBox[{"\[Gamma]u", "[", "]"}], 
     RowBox[{"s", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Extract\[Gamma]Indices", "[", "exp_", "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", "exp"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Tensor", "[", 
         RowBox[{"\[Gamma]", ",", "a_", ",", "b_"}], "]"}], "->", "a"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Rules", " ", "to", " ", "simplify", " ", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"\[Gamma]u", "[", "]"}], "s"}], "]"}], "."}]}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"subTraceGamma0", ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", "0", "]"}], "->", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", "Id", "]"}], "->", "4"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]u", "[", "_", "]"}], "|", 
          RowBox[{"\[Gamma]d", "[", "_", "]"}]}], ")"}], "]"}], "->", "0"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"guu", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}], "/;", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", "5"}], "]"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":>", 
       RowBox[{"0", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"allGammaQ", "[", 
           RowBox[{"a", ".", "b"}], "]"}], "&&", 
          RowBox[{"EvenQ", "[", 
           RowBox[{"Length", "[", 
            RowBox[{"a", ".", "b"}], "]"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"a", ".", "b"}], ",", 
             RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "==", "1"}]}], 
         ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":>", 
       RowBox[{"0", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"allGammaQ", "[", 
           RowBox[{"a", ".", "b"}], "]"}], "&&", 
          RowBox[{"OddQ", "[", 
           RowBox[{"Length", "[", 
            RowBox[{"a", ".", "b"}], "]"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"a", ".", "b"}], ",", 
             RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "==", "0"}]}], 
         ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":>", 
       RowBox[{"0", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"allGammaQ", "[", 
           RowBox[{"a", ".", "b"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"a", ".", "b"}], "]"}], "\[Equal]", "3"}], "&&", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"a", ".", "b"}], ",", 
             RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "\[Equal]", 
           "1"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":>", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "I", " ", 
         RowBox[{"\[Epsilon]uuuu", "[", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"Sequence", ",", 
            RowBox[{"Extract\[Gamma]Indices", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"a", ".", "b"}], ",", 
               RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "]"}]}], "]"}], 
          "]"}]}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"allGammaQ", "[", 
           RowBox[{"a", ".", "b"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"a", ".", "b"}], "]"}], "==", "5"}], "&&", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"a", ".", "b"}], ",", 
             RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "==", "1"}]}], 
         ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"\[Gamma]u", "[", "a_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "b_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "c_", "]"}], ".", 
         RowBox[{"\[Gamma]u", "[", "d_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"guu", "[", 
             RowBox[{"a", ",", "b"}], "]"}], 
            RowBox[{"guu", "[", " ", 
             RowBox[{"c", ",", "d"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"guu", "[", 
             RowBox[{"a", ",", "c"}], "]"}], 
            RowBox[{"guu", "[", " ", 
             RowBox[{"b", ",", "d"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"guu", "[", 
             RowBox[{"a", ",", "d"}], "]"}], 
            RowBox[{"guu", "[", 
             RowBox[{"b", ",", "c"}], "]"}]}]}], ")"}]}], "/;", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", "5"}], 
           "]"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a1_", ",", "b1_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a2_", ",", "b2_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a3_", ",", "b3_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a4_", ",", "b4_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"4", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"a1", ",", "a2"}], "}"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"b1", ",", "b2"}], "}"}], "]"}]}], "]"}], 
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"a3", ",", "a4"}], "}"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"b3", ",", "b4"}], "}"}], "]"}]}], "]"}]}], ")"}], 
           "\[IndentingNewLine]", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"a1", ",", "a3"}], "}"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"b1", ",", "b3"}], "}"}], "]"}]}], "]"}], 
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"a2", ",", "a4"}], "}"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"b2", ",", "b4"}], "}"}], "]"}]}], "]"}]}], ")"}], 
           "\[IndentingNewLine]", "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"a1", ",", "a4"}], "}"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"b1", ",", "b4"}], "}"}], "]"}]}], "]"}], 
             RowBox[{"Tensor", "[", 
              RowBox[{"g", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"a2", ",", "a3"}], "}"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"b2", ",", "b3"}], "}"}], "]"}]}], "]"}]}], ")"}]}], 
          "\[IndentingNewLine]", ")"}]}], "/;", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a1", ",", "a2", ",", "a3", ",", "a4", ",", "b1", ",", "b2", ",", 
             "b3", ",", "b4"}], "}"}], ",", "5"}], "]"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a1_", ",", "b1_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a2_", ",", "b2_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a3_", ",", "b3_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a4_", ",", "b4_"}], "]"}], ".", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Gamma]", ",", "a5_", ",", "b5_"}], "]"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "I", " ", 
         RowBox[{"Tensor", "[", 
          RowBox[{"\[Epsilon]", ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}], 
           ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"b1", ",", "b2", ",", "b3", ",", "b4"}], "}"}], "]"}]}], 
          "]"}]}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"a5", ",", "b5"}], "}"}], "]"}], ",", "5"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Test", " ", "of", " ", 
       RowBox[{"subTraceGamma0", ".", "\[IndentingNewLine]", "tmp"}]}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Tr", "[", "Id", "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{"\[Gamma]u", "[", "5", "]"}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{"\[Gamma]u", "[", "a", "]"}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "b", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "d", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "c", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "d", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "b", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "c", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "d", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "b", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "c", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "b", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "c", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "d", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "e", "]"}]}], "]"}], ",", 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"\[Gamma]u", "[", "a", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "b", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "c", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "d", "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}]}], "}"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"#", "/.", "subTraceGamma0"}]}], "}"}], "&"}], ",", 
          "tmp"}], "]"}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rule", " ", "generator", " ", "for", " ", "expanding", " ", 
      "spinorBar"}], ",", " ", 
     OverscriptBox["u", "_"], ",", " ", 
     RowBox[{"expressions", "->", 
      RowBox[{
       RowBox[{
        SuperscriptBox["u", "\[Dagger]"], ".", "\[Gamma]0"}], "->", 
       RowBox[{"\[Gamma]", " ", "0.", 
        RowBox[{"u", " ", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"spinorBarExpand", "[", "u_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sub", ",", 
         RowBox[{"tmpu", "=", "u"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub", "=", 
         RowBox[{
          OverscriptBox["u", "_"], "->", 
          RowBox[{
           RowBox[{"ConjugateTranspose", "[", 
            RowBox[{"RemovePatterns", "[", "u", "]"}], "]"}], ".", 
           RowBox[{"\[Gamma]u", "[", "0", "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ConjugateTranspose", "[", "#", "]"}], "&"}], ",", 
             "sub"}], "]"}], "/.", 
           RowBox[{"simpleHermitian", "[", 
            RowBox[{"{", 
             RowBox[{"\[Gamma]u", "[", "_", "]"}], "}"}], "]"}]}], ",", 
          "sub"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Example", " ", "of", " ", "how", " ", "to", " ", "form", " ", "Rules"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"spinorBarExpandRule", "[", "spinor_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"spinorBarExpand", "[", "#", "]"}], "&"}], ",", 
            "spinor"}], "]"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MapAt", "[", 
            RowBox[{"(*", 
             RowBox[{"Pattern", " ", "confuses", " ", 
              RowBox[{"match", "."}]}], "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{"RemovePatterns", "[", "#", "]"}], "&"}], ",", "#", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "&"}], ",", "tmp"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Rule", " ", "for", " ", "removing", " ", "Patterns"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemovePatterns", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "//.", 
           RowBox[{"Pattern", "\[Rule]", "xPattern"}]}], "//.", 
          RowBox[{
           RowBox[{"xPattern", "[", 
            RowBox[{"a_", ",", 
             RowBox[{
              RowBox[{"Blank", "[", "]"}], "|", 
              RowBox[{"BlankSequence", "[", "]"}]}]}], "]"}], ":>", "a"}]}], "/.", 
         RowBox[{"xPattern", "->", "Pattern"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RuleVarPattern", "[", "var_List", "]"}], "[", "rule_Rule", 
      "]"}], " ", "converts", " ", "var", " ", "in", " ", "rule", " ", "to", 
     " ", 
     RowBox[{"Pattern", "[", 
      RowBox[{"var", ",", 
       RowBox[{"Blank", "[", "]"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RuleVarPattern", "[", "var_List", "]"}], "[", "rule_Rule", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", 
         RowBox[{"rule", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "->", 
              RowBox[{"Pattern", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Blank", "[", "]"}]}], "]"}]}], "&"}], ",", "var"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "->", 
          RowBox[{"rule", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RulesVarPattern", "[", "var_List", "]"}], "[", "exp_", "]"}], 
     " ", "converts", " ", "var_List", " ", "in", " ", "exp_", " ", 
     "containing", " ", "Rule", " ", "to", " ", 
     RowBox[{"Pattern", "[", 
      RowBox[{"var", ",", 
       RowBox[{"Blank", "[", "]"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RulesVarPattern", "[", "var_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "rulepos", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rulepos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{
           RowBox[{"{", "exp", "}"}], ",", 
           RowBox[{"Rule", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rulepos", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"RuleVarPattern", "[", "var", "]"}], "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
           "rulepos"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"exp", ",", "rulepos"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.475328123998171*^9, 3.475328144256694*^9}, {
   3.475328304872456*^9, 3.4753283182617693`*^9}, {3.475328351015662*^9, 
   3.475328367009488*^9}, {3.475333524120799*^9, 3.475333628677216*^9}, {
   3.4753337470618677`*^9, 3.4753337530110397`*^9}, {3.475333868765501*^9, 
   3.475333886651235*^9}, {3.475334456651794*^9, 3.4753345339458838`*^9}, {
   3.475341693343952*^9, 3.475341697647821*^9}, 3.475341876350463*^9, {
   3.4753419530979548`*^9, 3.475342024964407*^9}, {3.475342353406999*^9, 
   3.4753424243893642`*^9}, {3.475342462248831*^9, 3.4753425386889257`*^9}, {
   3.475343559647657*^9, 3.4753437477150097`*^9}, {3.475343777804968*^9, 
   3.475343822030724*^9}, {3.475343909796315*^9, 3.47534392259345*^9}, {
   3.4753444450366583`*^9, 3.47534448099774*^9}, {3.4753446155859947`*^9, 
   3.475344631640381*^9}, {3.4753446909124002`*^9, 3.475344747802864*^9}, {
   3.4753448518920717`*^9, 3.475345038209539*^9}, {3.475345079795126*^9, 
   3.475345193773902*^9}, {3.475345238274949*^9, 3.4753452894704227`*^9}, {
   3.475345373246751*^9, 3.475345415460705*^9}, 3.475346528554399*^9, {
   3.475346713288813*^9, 3.475346799296137*^9}, {3.4753468641132097`*^9, 
   3.475346942541623*^9}, 3.475347135703167*^9, {3.4753471990020123`*^9, 
   3.4753472101392813`*^9}, {3.475347557581555*^9, 3.475347653794413*^9}, 
   3.475348054871016*^9, {3.4753525505906153`*^9, 3.475352564725621*^9}, {
   3.481724247809203*^9, 3.481724314769746*^9}, {3.4817243621510277`*^9, 
   3.4817243720012417`*^9}, {3.481724429033697*^9, 3.481724479491053*^9}, {
   3.481724513540463*^9, 3.481724514193734*^9}, {3.481724665987877*^9, 
   3.481724668797902*^9}, {3.487705712785967*^9, 3.487705742226283*^9}, {
   3.487706194970272*^9, 3.487706213699222*^9}, {3.487706265585017*^9, 
   3.487706281576811*^9}, {3.487706318236301*^9, 3.487706375115019*^9}, 
   3.487706620172276*^9, {3.487706663223996*^9, 3.487706686924864*^9}, {
   3.487706771245366*^9, 3.4877068279237413`*^9}, {3.4877072453356752`*^9, 
   3.487707318651052*^9}, {3.4877073916816072`*^9, 3.487707394176783*^9}, {
   3.487707463523397*^9, 3.487707475988884*^9}, {3.48770763124832*^9, 
   3.4877076369364033`*^9}, 3.487707692093889*^9, {3.487707929025633*^9, 
   3.487708016169683*^9}, {3.48770877433328*^9, 3.487708779271811*^9}, {
   3.4877790591220903`*^9, 3.487779311922257*^9}, {3.487779371984054*^9, 
   3.487779388037698*^9}, {3.487812620028296*^9, 3.487812725082752*^9}, {
   3.487812818745019*^9, 3.487812870232193*^9}, {3.487812943142901*^9, 
   3.487812945450954*^9}, {3.487813007178384*^9, 3.4878130086772614`*^9}, {
   3.487813609946493*^9, 3.487813624351432*^9}, {3.487813660959125*^9, 
   3.487813717601482*^9}, {3.487813752638932*^9, 3.487813779547028*^9}, {
   3.487815569895732*^9, 3.487815585851541*^9}, {3.48872473345861*^9, 
   3.488724763438963*^9}, {3.4892426035792713`*^9, 3.489242605919372*^9}, {
   3.489242653804775*^9, 3.489242653944703*^9}, {3.4900141515507793`*^9, 
   3.490014257628776*^9}, 3.490014296697084*^9, {3.490014348878265*^9, 
   3.490014402111279*^9}, 3.4900144540922422`*^9, {3.490014492105418*^9, 
   3.490014522892501*^9}, {3.490014723371307*^9, 3.490014776159576*^9}, {
   3.490015006307776*^9, 3.490015028567522*^9}, {3.490015083940827*^9, 
   3.490015084138937*^9}, 3.4900153169170218`*^9, {3.4900183056327543`*^9, 
   3.4900183803315268`*^9}, {3.490018573885417*^9, 3.490018577586823*^9}, 
   3.4900355572971153`*^9, {3.4900356371025753`*^9, 3.490035648935021*^9}, {
   3.490060075695898*^9, 3.4900601139162292`*^9}, {3.490060196662898*^9, 
   3.490060203037228*^9}, {3.4901905037702503`*^9, 3.490190524434208*^9}, {
   3.490190621342786*^9, 3.49019069998328*^9}, {3.490365830910213*^9, 
   3.490365894647029*^9}, {3.490708256794696*^9, 3.490708257489456*^9}, {
   3.490708854274746*^9, 3.490708898812036*^9}, {3.490708942719329*^9, 
   3.4907089885389423`*^9}, 3.490709408525117*^9, {3.4913404552564173`*^9, 
   3.4913404602073317`*^9}, 3.491343411690154*^9, {3.4913434965792017`*^9, 
   3.4913435579328833`*^9}, {3.491343876917362*^9, 3.491343951418373*^9}, {
   3.491343987430863*^9, 3.491344001492498*^9}, {3.491344705081806*^9, 
   3.491344778561191*^9}, {3.492689917082382*^9, 3.492689937546138*^9}, {
   3.492701922372221*^9, 3.4927019555009203`*^9}, {3.4927019989349747`*^9, 
   3.492702003069899*^9}, {3.49339781042805*^9, 3.493397810572646*^9}, {
   3.493398239783684*^9, 3.493398254671523*^9}, {3.4934374161264544`*^9, 
   3.493437446226315*^9}, {3.49343749040487*^9, 3.493437490751791*^9}, {
   3.493437665036249*^9, 3.4934376661459*^9}, {3.493437697629623*^9, 
   3.4934377248588*^9}, 3.4934377622790947`*^9, {3.493437831185381*^9, 
   3.493437836438717*^9}, 3.4934379231024*^9, {3.493437953145822*^9, 
   3.493437958203628*^9}, {3.493470510269672*^9, 3.493470556861578*^9}, 
   3.494094570540908*^9, {3.494094610921569*^9, 3.4940946904315233`*^9}, {
   3.497098206446824*^9, 3.4970982296361723`*^9}, {3.506205504876287*^9, 
   3.5062055092689447`*^9}, {3.5062056465573397`*^9, 3.506206033772442*^9}, {
   3.506206136487843*^9, 3.5062061507686787`*^9}, {3.50620633539077*^9, 
   3.5062063382848587`*^9}, {3.506206373669936*^9, 3.506206389654976*^9}, {
   3.506206617709961*^9, 3.506206646218466*^9}, {3.506261890679885*^9, 
   3.506261897901165*^9}, {3.506364178634058*^9, 3.506364184618281*^9}, 
   3.5063922538022833`*^9, {3.506393374937334*^9, 3.5063933769725657`*^9}, {
   3.506393412776149*^9, 3.506393451282604*^9}, {3.506393766414308*^9, 
   3.5063937737229*^9}, {3.506394328786034*^9, 3.506394330646834*^9}, {
   3.508792721823238*^9, 3.508792722571313*^9}, {3.508793153084243*^9, 
   3.508793189264172*^9}, {3.508796090245523*^9, 3.508796134655283*^9}, {
   3.509197589988235*^9, 3.509197599248603*^9}, {3.509198396509609*^9, 
   3.509198546891418*^9}, {3.509198734320533*^9, 3.5091987602574778`*^9}, {
   3.509198797794244*^9, 3.5091988003392773`*^9}, {3.509198835006805*^9, 
   3.509198858209819*^9}, {3.509399327515933*^9, 3.5093993497566223`*^9}, {
   3.50940070927345*^9, 3.509400836304667*^9}, {3.509401145291204*^9, 
   3.50940115337348*^9}, {3.5094014890028687`*^9, 3.509401584946743*^9}, {
   3.509401632782152*^9, 3.509401699936858*^9}, {3.509401812692294*^9, 
   3.5094018555080147`*^9}, {3.5094018996934423`*^9, 3.509401933979353*^9}, {
   3.509401987395418*^9, 3.509402037232629*^9}, {3.509402115315948*^9, 
   3.509402132336152*^9}, {3.5094021878415337`*^9, 3.509402188053073*^9}, {
   3.509402425599766*^9, 3.509402433194129*^9}, {3.50940247579313*^9, 
   3.509402490254243*^9}, 3.5094026157353487`*^9, {3.509402806357893*^9, 
   3.509402813841917*^9}, {3.509402940964469*^9, 3.509402961041963*^9}, {
   3.509403075990541*^9, 3.509403143734354*^9}, {3.509403200020081*^9, 
   3.509403287265943*^9}, {3.509403329190311*^9, 3.509403329817976*^9}, {
   3.509403471142651*^9, 3.509403515156438*^9}, {3.509403623843157*^9, 
   3.509403624417441*^9}, {3.5094037445637407`*^9, 3.509403758915851*^9}, 
   3.509403842213624*^9, {3.509625425523638*^9, 3.5096254810094767`*^9}, {
   3.509626546508664*^9, 3.5096265688341703`*^9}, {3.5096288989877768`*^9, 
   3.509628952331007*^9}, {3.509629140453455*^9, 3.509629179154586*^9}, {
   3.509629473563374*^9, 3.509629474904647*^9}, {3.509629578921917*^9, 
   3.509629591631598*^9}, {3.509629637463027*^9, 3.509629647712799*^9}, {
   3.50962974515234*^9, 3.50962974607803*^9}, {3.509802312640616*^9, 
   3.509802397395095*^9}, {3.50980710911132*^9, 3.509807217544896*^9}, 
   3.509808075160274*^9, {3.509808455607091*^9, 3.5098084669963627`*^9}, {
   3.509809346956168*^9, 3.5098093780490828`*^9}, {3.50980948527223*^9, 
   3.509809503725803*^9}, {3.509809573584711*^9, 3.5098096156822033`*^9}, {
   3.509809726352961*^9, 3.509809761597784*^9}, {3.5098101391891193`*^9, 
   3.5098101491471777`*^9}, {3.509849692746481*^9, 3.5098497431853313`*^9}, {
   3.5098497826297617`*^9, 3.509849785382955*^9}, {3.509887205869404*^9, 
   3.509887230221987*^9}, {3.509887770003544*^9, 3.509887771652203*^9}, {
   3.509887882726259*^9, 3.50988801972009*^9}, {3.509888167180912*^9, 
   3.50988820738585*^9}, {3.509888941329359*^9, 3.509888947950171*^9}, 
   3.509892939180502*^9, {3.509893005363188*^9, 3.509893017525523*^9}, {
   3.5098947754088593`*^9, 3.50989480287713*^9}, {3.509993548966296*^9, 
   3.5099936688423443`*^9}, {3.509994829252204*^9, 3.509994831369813*^9}, 
   3.5099957130086613`*^9, {3.509995747911996*^9, 3.50999574889797*^9}, {
   3.5099957868759127`*^9, 3.5099957891380873`*^9}, {3.509997262350204*^9, 
   3.509997281869556*^9}, {3.509997478213192*^9, 3.509997540602841*^9}, {
   3.510425946415751*^9, 3.5104259733421*^9}, {3.510426010389687*^9, 
   3.510426075869892*^9}, {3.510426118139127*^9, 3.5104261366470633`*^9}, {
   3.510927414055094*^9, 3.510927460241446*^9}, {3.5109276112212887`*^9, 
   3.5109277658892183`*^9}, {3.514561184138839*^9, 3.514561189320785*^9}, {
   3.515072644882496*^9, 3.515072682225024*^9}, {3.515072734954527*^9, 
   3.5150727603645678`*^9}, 3.5150729728756647`*^9, {3.515073917134914*^9, 
   3.515073929947475*^9}, {3.515074857537551*^9, 3.515074868417386*^9}, {
   3.5185240263669167`*^9, 3.5185240294977207`*^9}, {3.518525527132008*^9, 
   3.518525552286532*^9}, {3.519041704371387*^9, 3.519041859105596*^9}, {
   3.519041946165062*^9, 3.519041960255762*^9}, 3.51950263457301*^9, {
   3.519502684167368*^9, 3.519502714411707*^9}, {3.519567315092255*^9, 
   3.5195673301820927`*^9}, {3.519567895005218*^9, 3.5195679026083097`*^9}, {
   3.519568125502509*^9, 3.519568427563726*^9}, {3.519569224585948*^9, 
   3.519569224864602*^9}, {3.5195757599065247`*^9, 3.519575799840706*^9}, {
   3.519745616095749*^9, 3.519745630252226*^9}, {3.51974582858055*^9, 
   3.519745829740423*^9}, {3.5197458853720427`*^9, 3.51974588815501*^9}, {
   3.519746001904674*^9, 3.519746003049796*^9}, {3.519747012274577*^9, 
   3.519747061803197*^9}, {3.519747144312601*^9, 3.5197471762868423`*^9}, {
   3.519747228147708*^9, 3.5197472800401087`*^9}, {3.5197473124649467`*^9, 
   3.519747345422388*^9}, {3.519747400712719*^9, 3.519747420039579*^9}, {
   3.519747469015295*^9, 3.5197474712547493`*^9}, 3.519747534709786*^9, {
   3.51974837838233*^9, 3.5197484027115583`*^9}, 3.519748507321594*^9, {
   3.519748660423171*^9, 3.519748686040132*^9}, {3.519759425149289*^9, 
   3.5197594396454144`*^9}, {3.519759513336916*^9, 3.519759521821447*^9}, {
   3.519759590089869*^9, 3.519759646396968*^9}, {3.5197597833420973`*^9, 
   3.51975979422838*^9}, {3.519759915016663*^9, 3.519759990388905*^9}, {
   3.5197603366677237`*^9, 3.51976045506787*^9}, {3.519999488890355*^9, 
   3.5199995951026583`*^9}, {3.519999626589056*^9, 3.519999633051642*^9}, {
   3.519999678363205*^9, 3.5199997001478987`*^9}, {3.5199997398005333`*^9, 
   3.519999753001214*^9}, {3.520004923712969*^9, 3.520004931216284*^9}, {
   3.520089155563867*^9, 3.520089198558292*^9}, {3.520089323790042*^9, 
   3.520089330219534*^9}, {3.5200896825825853`*^9, 3.520089700942443*^9}, {
   3.520090570963269*^9, 3.520090603535788*^9}, {3.5201602201072617`*^9, 
   3.520160254822308*^9}, {3.5202586648361473`*^9, 3.5202586905911922`*^9}, {
   3.5202587939542227`*^9, 3.520258809081503*^9}, {3.520259452379546*^9, 
   3.520259489804469*^9}, {3.5203363516827593`*^9, 3.520336406460698*^9}, {
   3.521556729702318*^9, 3.521556830074217*^9}, {3.521557328458291*^9, 
   3.521557472308979*^9}, {3.5215575278363743`*^9, 3.521557528251974*^9}, {
   3.521557566529171*^9, 3.521557569970725*^9}, {3.523807331791524*^9, 
   3.5238073800307817`*^9}, {3.523807876530875*^9, 3.523807961347372*^9}, {
   3.5238080666482887`*^9, 3.523808159227231*^9}, {3.52380836712639*^9, 
   3.52380846685349*^9}, {3.523812111564426*^9, 3.523812166345319*^9}, {
   3.523824417259457*^9, 3.523824431792706*^9}, {3.523890796000742*^9, 
   3.5238908857885017`*^9}, {3.523909539705181*^9, 3.5239095906407547`*^9}, {
   3.523909864643282*^9, 3.5239098692775593`*^9}, 3.523909982094705*^9, {
   3.523910039130121*^9, 3.5239100517992277`*^9}, {3.523910277144878*^9, 
   3.5239102800791273`*^9}, {3.5239103699500628`*^9, 3.523910475010085*^9}, {
   3.523963892550045*^9, 3.523963926043647*^9}, {3.524320019893518*^9, 
   3.524320046753297*^9}, {3.5243201137551603`*^9, 3.524320135506382*^9}, {
   3.524619986382061*^9, 3.524620018152171*^9}, {3.524620059853795*^9, 
   3.524620066613675*^9}, {3.524620121914598*^9, 3.524620122539904*^9}, {
   3.524620758572171*^9, 3.5246207632856817`*^9}, {3.524620808314406*^9, 
   3.524620808523135*^9}, {3.52462084596142*^9, 3.524620862726181*^9}, {
   3.52462090892738*^9, 3.5246209295208187`*^9}, {3.53053844345358*^9, 
   3.53053859584103*^9}, {3.535983445023314*^9, 3.535983461190105*^9}, 
   3.5414376033510323`*^9, {3.546694294369194*^9, 3.546694503715664*^9}, {
   3.546695076520863*^9, 3.546695129364273*^9}, {3.5502451657105722`*^9, 
   3.550245215444263*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DotExpandMode", "[", "False", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "all", " ", "or", " ", "parts", " ", "of", " ", 
    "NotebookFileName", " ", "based", " ", "upon", " ", 
    RowBox[{"type_String", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NBname", "[", "type_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"name", "=", 
        RowBox[{"NotebookFileName", "[", "]"}]}], ",", 
       RowBox[{"dir", "=", 
        RowBox[{"FileNameDrop", "[", 
         RowBox[{
          RowBox[{"NotebookFileName", "[", "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", 
       RowBox[{"base", "=", 
        RowBox[{"FileBaseName", "[", 
         RowBox[{"NotebookFileName", "[", "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "type", ",", "\[IndentingNewLine]", "\"\<name\>\"", ",", "name", ",", 
       "\[IndentingNewLine]", "\"\<dir\>\"", ",", "dir", ",", 
       "\[IndentingNewLine]", "\"\<base\>\"", ",", "base", ",", 
       "\[IndentingNewLine]", "\"\<stub\>\"", ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "base"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.48379355660535*^9, 3.483793569543653*^9}, {
  3.495369752950612*^9, 3.4953697717785463`*^9}, {3.4953700630626097`*^9, 
  3.4953701206803207`*^9}, {3.495370328659198*^9, 3.4953703325157557`*^9}, {
  3.4953710402817287`*^9, 3.495371046707286*^9}, {3.495380045624301*^9, 
  3.495380098919797*^9}, {3.4953801687431793`*^9, 3.495380208646187*^9}, {
  3.495380360734543*^9, 3.4953803873129883`*^9}, {3.4953804622496357`*^9, 
  3.4953805085792522`*^9}, {3.4953805896547937`*^9, 3.495380601341927*^9}, {
  3.4953807165116568`*^9, 3.495380784795382*^9}, {3.495380823066704*^9, 
  3.495380832620648*^9}, {3.495380867910057*^9, 3.495380882077682*^9}}],

Cell["Graphics Definitions", "Text",
 CellChangeTimes->{{3.50006751109837*^9, 3.500067517499951*^9}, {
  3.500067637535242*^9, 3.5000676425462093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Example", " ", "of", " ", "simple", " ", "graphic", " ", "aids", " ", 
     "to", " ", "draw", " ", "figures", " ", "on", " ", "a", " ", 
     RowBox[{"rectangle", ".", "  ", "Define"}], " ", "vertices", " ", "and", 
     " ", "lines"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vx", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", "vx"}], "]"}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"line", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "9", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "12", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "12", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "13", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "12", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "15", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Thin", ",", "Black", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", "#", "]"}], "&"}], ",", "line"}], "]"}], ",", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"#2", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "]"}], 
          "&"}], ",", "line"}], "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"MidArrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], "]"}], " ", "draws", " ", 
    "arrow", " ", "with", " ", "symbol", " ", "in", " ", "middle"}], "  ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MidArrow", "[", "xy_List", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xy", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
         RowBox[{"xy", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Draws", " ", "text", " ", "at", " ", "mid", " ", 
     RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MidLineText", "[", 
     RowBox[{"text_", ",", "line_List", ",", "style_List"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"text", ",", "style"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"line", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"line", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "]"}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MidLineTextOffset", "[", 
     RowBox[{
     "text_", ",", "line_List", ",", "style_List", ",", "Offset_List"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"text", ",", "style"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"line", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "Offset"}], ")"}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"line", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "Offset"}], ")"}]}], ")"}], 
        "/", "2"}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TextOver", "[", 
      RowBox[{"text_", ",", "xy_List"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"xy", ",", "0.2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"text", ",", 
           RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}], ",", 
         "xy"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TextOver", "[", 
     RowBox[{"text_", ",", "xy_List", ",", "font_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"White", ",", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy", ",", "0.2"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"text", ",", 
          RowBox[{"FontSize", "\[Rule]", "font"}], ",", "Red"}], "]"}], ",", 
        "xy"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contruct", " ", "array", " ", "of", " ", "points", " ", "and", " ", 
     "lines", " ", "to", " ", "be", " ", "reference", " ", "by", " ", "array",
      " ", 
     RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GraphicPointLines", "[", "\[IndentingNewLine]", 
      RowBox[{"nx_", 
       RowBox[{"(*", 
        RowBox[{"Number", " ", "of", " ", "points", " ", "X"}], "*)"}], ",", 
       "\[IndentingNewLine]", "ny_", 
       RowBox[{"(*", 
        RowBox[{"Number", " ", "of", " ", "points", " ", "Y"}], "*)"}], ",", 
       "\[IndentingNewLine]", "linepoints_List"}], 
      RowBox[{"(*", 
       RowBox[{"indices", " ", "that", " ", "define", " ", "lines"}], "*)"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vx", ",", "line", ",", "vxline"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<General graphic definitions for array points and lines.\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vx", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Range", "[", "nx", "]"}], "-", "1"}], ",", 
            RowBox[{
             RowBox[{"Range", "[", "ny", "]"}], "-", "1"}]}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"line", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vx", "[", 
               RowBox[{"[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"vx", "[", 
               RowBox[{"[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}],
            ",", "linepoints"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0", ",", "1", ",", ".4"}], "]"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Line", "[", "#", "]"}], "&"}], ",", "line"}], "]"}], 
            ",", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"FontSize", "->", "20"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], 
                "]"}], "&"}], ",", "line"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RGBColor", "[", 
             RowBox[{".66", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"FontSize", "->", "16"}]}], " ", "]"}], ",", 
                 "#1"}], "]"}], "&"}], ",", "vx"}], "]"}]}], "}"}], "]"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"vx", ",", "line"}], "}"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
       "returns", " ", "point_List", " ", "and", " ", "line_List", " ", 
        "corresponding", " ", "to", " ", "graph", " ", "numbers"}], "*)"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Examples", " ", "of", " ", "H", " ", "and", " ", "X", " ", 
     RowBox[{"plot", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics2H2", "[", 
      RowBox[{"c1_", ",", "c2_", ",", "x_", ",", "c3_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", " ", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", " ", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", " ", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "Dotted", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", " ", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"1.5", ",", "0"}], " ", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c2", ",", 
           RowBox[{"{", 
            RowBox[{"3", " ", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c3", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c4", ",", 
           RowBox[{"{", 
            RowBox[{"3", " ", ",", "1"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"ImageSize", "->", "Small"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics2X2", "[", 
      RowBox[{"c1_", ",", "c2_", ",", "x_", ",", "c3_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], " ", ",", "3"}], "}"}]}], "}"}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", " ", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "Dotted", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", " ", ",", "2"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], " ", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c2", ",", 
           RowBox[{"{", 
            RowBox[{"1", " ", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c3", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c4", ",", 
           RowBox[{"{", " ", 
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", 
       RowBox[{"ImageSize", "->", "Small"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500067576689633*^9, 3.500067577123166*^9}, {
  3.50315534891154*^9, 3.503155375273777*^9}, {3.503155449939041*^9, 
  3.503155488016099*^9}, {3.503155523971875*^9, 3.503155554359187*^9}, {
  3.503155843974831*^9, 3.503155879835513*^9}, {3.5031678894774523`*^9, 
  3.5031678967669077`*^9}, {3.503168039120762*^9, 3.503168040380157*^9}, {
  3.5031697228481627`*^9, 3.503169759746653*^9}, {3.503172038424787*^9, 
  3.5031721005241423`*^9}, {3.524844831221139*^9, 3.5248448460177107`*^9}, {
  3.5264055101438293`*^9, 3.5264055141433153`*^9}, {3.526407551999062*^9, 
  3.526407647244039*^9}, {3.5264077151403418`*^9, 3.526407876635027*^9}, {
  3.526732257027318*^9, 3.526732302971693*^9}, {3.526733697141556*^9, 
  3.52673369956733*^9}, {3.5267511912391453`*^9, 3.526751258125946*^9}, {
  3.528574374959052*^9, 3.528574383057479*^9}, {3.528575531577264*^9, 
  3.5285755351842623`*^9}}],

Cell["Dimensional Analysis", "Text",
 CellChangeTimes->{{3.5268218463615103`*^9, 3.526821857016189*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SUSYdim", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dim", "[", "\[Theta]", "]"}], "->", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"spinor", " ", "variable"}], "*)"}], "\[IndentingNewLine]", 
       " ", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"\[Phi]", "[", "scalar", "]"}], "]"}], "->", "1"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"\[Chi]", "[", "fermion", "]"}], "]"}], "->", 
        RowBox[{"3", "/", "2"}]}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"dim", "[", "F", "]"}], "->", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"\[Zeta]", "[", "infinetessimal", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], " ", ",", 
       RowBox[{"(*", 
        RowBox[{"infinitessimal", " ", "spinor", " ", "parameter"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"Ad", "[", "\[Mu]", "]"}], "]"}], "->", "1"}], ",", 
       RowBox[{"(*", 
        RowBox[{"vector", " ", "field"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"xu", "[", "\[Mu]", "]"}], "]"}], "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"space", " ", "time", " ", "coordinate"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"for", " ", "gauge", " ", "field", " ", "\[CapitalLambda]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"\[Phi]d", "[", "\[CapitalLambda]", "]"}], "]"}], "->", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"\[Chi]d", "[", "\[CapitalLambda]", "]"}], "]"}], "->", 
        RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"Fd", "[", "\[CapitalLambda]", "]"}], "]"}], "->", "1"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "SUSYdim"}], "Input",
 CellChangeTimes->{{3.526821836979664*^9, 3.526822020670652*^9}, {
  3.526822074747839*^9, 3.526822164047768*^9}, {3.526822245606785*^9, 
  3.52682227605304*^9}, {3.526824269818923*^9, 3.526824313512545*^9}, {
  3.52682443084147*^9, 3.52682444082448*^9}, {3.526824543933147*^9, 
  3.5268245468344507`*^9}, {3.526825163154059*^9, 3.526825173199872*^9}, {
  3.526906129253027*^9, 3.526906225733513*^9}, {3.526907452642823*^9, 
  3.526907555545855*^9}, {3.5269076878661633`*^9, 3.526907741559679*^9}, {
  3.526908571301176*^9, 3.5269086046271763`*^9}, {3.5269891493867083`*^9, 
  3.5269891500030317`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"dim", "[", "\[Theta]", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox["1", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"\[Phi]", "[", "scalar", "]"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"\[Chi]", "[", "fermion", "]"}], "]"}], "\[Rule]", 
    FractionBox["3", "2"]}], ",", 
   RowBox[{
    RowBox[{"dim", "[", "F", "]"}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"\[Zeta]", "[", "infinetessimal", "]"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox["1", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"Ad", "[", "\[Mu]", "]"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"xu", "[", "\[Mu]", "]"}], "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"\[Phi]d", "[", "\[CapitalLambda]", "]"}], "]"}], "\[Rule]", 
    "0"}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"\[Chi]d", "[", "\[CapitalLambda]", "]"}], "]"}], "\[Rule]", 
    FractionBox["1", "2"]}], ",", 
   RowBox[{
    RowBox[{"dim", "[", 
     RowBox[{"Fd", "[", "\[CapitalLambda]", "]"}], "]"}], "\[Rule]", "1"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.5478203793174973`*^9, 3.5478256775417843`*^9}]
}, Open  ]],

Cell["Utility functions", "Text",
 CellChangeTimes->{{3.527879901906035*^9, 3.527879920295072*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "defining", " ", "file", " ", "name", " ", "for", " ", 
    "saving", " ", "variable", " ", "expressions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Put", "[", 
    RowBox[{"SaveFile", "=", 
     RowBox[{
      RowBox[{"NBname", "[", "\"\<stub\>\"", "]"}], "<>", "\"\<.out\>\""}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "for", " ", "retrieving", " ", "output", " ", "definitions", " ", "from", 
     " ", "file", " ", "in", " ", "current", " ", 
     RowBox[{"directory", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Get", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<LectureB2011.10.10.out\>\""}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.527879933930221*^9, 3.527880068966152*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.54782037941254*^9, 3.5478256775925303`*^9}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->{},
WindowSize->{868, 578},
WindowMargins->{{-628, Automatic}, {Automatic, -1104}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1124, 18, 119, "Text"],
Cell[CellGroupData[{
Cell[1694, 42, 77088, 1844, 4588, "Input",
 InitializationCell->True],
Cell[78785, 1888, 1077, 30, 40, "Output"]
}, Open  ]],
Cell[79877, 1921, 208, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[80110, 1928, 229679, 5507, 14268, "Input",
 InitializationCell->True],
Cell[309792, 7437, 849, 16, 24, "Output"]
}, Open  ]],
Cell[310656, 7456, 262, 5, 29, "Text"],
Cell[310921, 7463, 38708, 899, 2188, "Input",
 InitializationCell->True],
Cell[349632, 8364, 179, 2, 29, "Text"],
Cell[CellGroupData[{
Cell[349836, 8370, 13408, 304, 896, "Input",
 InitializationCell->True],
Cell[363247, 8676, 452, 6, 24, "Output"]
}, Open  ]],
Cell[363714, 8685, 59302, 1352, 3236, "Input",
 InitializationCell->True],
Cell[423019, 10039, 106, 1, 29, "Text"],
Cell[423128, 10042, 61768, 1503, 3945, "Input",
 InitializationCell->True],
Cell[484899, 11547, 156, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[485080, 11556, 213250, 5209, 11299, "Input",
 InitializationCell->True],
Cell[698333, 16767, 76, 1, 24, "Output"]
}, Open  ]],
Cell[698424, 16771, 211, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[698660, 16778, 37890, 944, 2171, "Input",
 InitializationCell->True],
Cell[736553, 17724, 4048, 107, 78, "Output"],
Cell[740604, 17833, 1384, 37, 40, "Output"]
}, Open  ]],
Cell[742003, 17873, 99, 1, 29, "Text"],
Cell[742105, 17876, 22393, 533, 882, "Input",
 InitializationCell->True],
Cell[764501, 18411, 92, 1, 29, "Text"],
Cell[764596, 18414, 167, 2, 29, "Text"],
Cell[764766, 18418, 20846, 558, 1075, "Input",
 InitializationCell->True],
Cell[785615, 18978, 202, 4, 29, "Text"],
Cell[785820, 18984, 41416, 988, 2134, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[827261, 19976, 3237, 87, 165, "Input"],
Cell[830501, 20065, 5196, 145, 114, "Output"]
}, Open  ]],
Cell[835712, 20213, 158, 2, 29, "Text"],
Cell[CellGroupData[{
Cell[835895, 20219, 644, 16, 63, "Input",
 InitializationCell->True],
Cell[836542, 20237, 707, 16, 47, "Output"]
}, Open  ]],
Cell[837264, 20256, 239, 3, 29, "Text"],
Cell[837506, 20261, 18750, 406, 1286, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[856281, 20671, 2775, 40, 56, "Input"],
Cell[859059, 20713, 10319, 267, 333, "Print"]
}, Open  ]],
Cell[869393, 20983, 107, 1, 29, "Text"],
Cell[869503, 20986, 89132, 2166, 4242, "Input",
 InitializationCell->True],
Cell[958638, 23154, 2147, 46, 206, "Input",
 InitializationCell->True],
Cell[960788, 23202, 152, 2, 29, "Text"],
Cell[960943, 23206, 19189, 512, 1061, "Input",
 InitializationCell->True],
Cell[980135, 23720, 104, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[980264, 23725, 2996, 70, 251, "Input"],
Cell[983263, 23797, 1366, 40, 78, "Output"]
}, Open  ]],
Cell[984644, 23840, 99, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[984768, 23845, 877, 23, 101, "Input"],
Cell[985648, 23870, 99, 1, 24, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
