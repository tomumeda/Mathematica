(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    165157,       4039]
NotebookOptionsPosition[    164411,       4011]
NotebookOutlinePosition[    164784,       4027]
CellTagsIndexPosition[    164741,       4024]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Graphics Definitions", "Text",
 CellChangeTimes->{{3.50006751109837*^9, 3.500067517499951*^9}, {
   3.500067637535242*^9, 3.5000676425462093`*^9}, {3.666498149443076*^9, 
   3.666498159000711*^9}, 3.666498306574155*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Example", " ", "of", " ", "simple", " ", "graphic", " ", "aids", " ", 
     "to", " ", "draw", " ", "figures", " ", "on", " ", "a", " ", 
     RowBox[{"rectangle", ".", "  ", "Define"}], " ", "vertices", " ", "and", 
     " ", "lines"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vx", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"#2", ",", "#1"}], "]"}], "&"}], ",", "vx"}], "]"}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"line", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "6", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "9", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "12", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "7", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "12", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "13", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"[", "12", "]"}], "]"}], ",", 
         RowBox[{"vx", "[", 
          RowBox[{"[", "15", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Thin", ",", "Black", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", "#", "]"}], "&"}], ",", "line"}], "]"}], ",", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"#2", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "]"}], 
          "&"}], ",", "line"}], "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"MidArrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], "]"}], " ", "draws", " ", 
    "arrow", " ", "with", " ", "symbol", " ", "in", " ", "middle"}], "  ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MidArrow", "[", "xy_List", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xy", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
         RowBox[{"xy", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Draws", " ", "text", " ", "at", " ", "mid", " ", 
     RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MidLineText", "[", 
     RowBox[{"text_", ",", "line_List", ",", "style_List"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"text", ",", "style"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"line", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"line", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "]"}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MidLineTextOffset", "[", 
     RowBox[{
     "text_", ",", "line_List", ",", "style_List", ",", "Offset_List"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"text", ",", "style"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"line", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "Offset"}], ")"}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"line", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", "Offset"}], ")"}]}], ")"}], 
        "/", "2"}]}], "]"}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TextOver", "[", 
      RowBox[{"text_", ",", "xy_List"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"xy", ",", "0.2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"text", ",", 
           RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}], ",", 
         "xy"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TextOver", "[", 
     RowBox[{"text_", ",", "xy_List", ",", "font_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"White", ",", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy", ",", "0.2"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"text", ",", 
          RowBox[{"FontSize", "\[Rule]", "font"}], ",", "Red"}], "]"}], ",", 
        "xy"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contruct", " ", "array", " ", "of", " ", "points", " ", "and", " ", 
     "lines", " ", "to", " ", "be", " ", "reference", " ", "by", " ", "array",
      " ", 
     RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GraphicPointLines", "[", "\[IndentingNewLine]", 
      RowBox[{"nx_", 
       RowBox[{"(*", 
        RowBox[{"Number", " ", "of", " ", "points", " ", "X"}], "*)"}], ",", 
       "\[IndentingNewLine]", "ny_", 
       RowBox[{"(*", 
        RowBox[{"Number", " ", "of", " ", "points", " ", "Y"}], "*)"}], ",", 
       "\[IndentingNewLine]", "linepoints_List", 
       RowBox[{"(*", 
        RowBox[{"indices", " ", "that", " ", "define", " ", "lines"}], "*)"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"displayTemplate_:", "True"}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vx", ",", "line", ",", "vxline"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vx", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Range", "[", "nx", "]"}], "-", "1"}], ",", 
            RowBox[{
             RowBox[{"Range", "[", "ny", "]"}], "-", "1"}]}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "linepoints", "]"}], "\[Equal]", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"line", "=", "linepoints"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"endpoints", " ", "specified", " ", "by", " ", "x"}], ",", 
            RowBox[{"y", " ", "offset", " ", "from", " ", "LowerLeft"}]}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"else", " ", "by", " ", "vx", " ", "index"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"line", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"vx", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"vx", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
              "&"}], ",", "linepoints"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"displayTemplate", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<General graphic definitions for array points and lines.\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"1", ",", "0", ",", "1", ",", ".7"}], "]"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Line", "[", "#", "]"}], "&"}], ",", "line"}], 
                "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "30"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], 
                   "]"}], "&"}], ",", "line"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"RGBColor", "[", 
                RowBox[{".66", ",", "0", ",", "0", ",", ".5"}], "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"FontSize", "->", "16"}]}], " ", "]"}], ",", 
                    "#1"}], "]"}], "&"}], ",", "vx"}], "]"}]}], "}"}], "]"}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"vx", ",", "line"}], "}"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
       "returns", " ", "point_List", " ", "and", " ", "line_List", " ", 
        "corresponding", " ", "to", " ", "graph", " ", "numbers"}], "*)"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Examples", " ", "of", " ", "H", " ", "and", " ", "X", " ", 
     RowBox[{"plot", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics2H2", "[", 
      RowBox[{"c1_", ",", "c2_", ",", "x_", ",", "c3_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", " ", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", " ", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", " ", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "Dotted", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", " ", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"1.5", ",", "0"}], " ", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c2", ",", 
           RowBox[{"{", 
            RowBox[{"3", " ", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c3", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c4", ",", 
           RowBox[{"{", 
            RowBox[{"3", " ", ",", "1"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"ImageSize", "->", "Small"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics2X2", "[", 
      RowBox[{"c1_", ",", "c2_", ",", "x_", ",", "c3_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], " ", ",", "3"}], "}"}]}], "}"}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"MidArrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", " ", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "Dotted", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", " ", ",", "2"}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], " ", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c2", ",", 
           RowBox[{"{", 
            RowBox[{"1", " ", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c3", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TextOver", "[", 
          RowBox[{"c4", ",", 
           RowBox[{"{", " ", 
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", 
       RowBox[{"ImageSize", "->", "Small"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.500067576689633*^9, 3.500067577123166*^9}, {
   3.50315534891154*^9, 3.503155375273777*^9}, {3.503155449939041*^9, 
   3.503155488016099*^9}, {3.503155523971875*^9, 3.503155554359187*^9}, {
   3.503155843974831*^9, 3.503155879835513*^9}, {3.5031678894774523`*^9, 
   3.5031678967669077`*^9}, {3.503168039120762*^9, 3.503168040380157*^9}, {
   3.5031697228481627`*^9, 3.503169759746653*^9}, {3.503172038424787*^9, 
   3.5031721005241423`*^9}, {3.524844831221139*^9, 3.5248448460177107`*^9}, {
   3.5264055101438293`*^9, 3.5264055141433153`*^9}, {3.526407551999062*^9, 
   3.526407647244039*^9}, {3.5264077151403418`*^9, 3.526407876635027*^9}, {
   3.526732257027318*^9, 3.526732302971693*^9}, {3.526733697141556*^9, 
   3.52673369956733*^9}, {3.5267511912391453`*^9, 3.526751258125946*^9}, {
   3.528574374959052*^9, 3.528574383057479*^9}, {3.528575531577264*^9, 
   3.5285755351842623`*^9}, 3.56147729567309*^9, 3.626702570102413*^9, 
   3.626705177295808*^9, 3.640816383796831*^9, 3.662691182864779*^9, 
   3.66282180736788*^9}],

Cell["\<\
Standard way of specifying SaveFile.  Code to be included in Notebook.\
\>", "Text",
 CellChangeTimes->{{3.527879901906035*^9, 3.527879920295072*^9}, {
  3.580211582780904*^9, 3.5802116572787323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Creates", " ", "file", " ", "with", " ", "filename", " ", "in", " ", 
     "SaveFile", " ", "for", " ", "saving", " ", "variable", " ", 
     "expressions", "\[IndentingNewLine]", "SaveFile"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\"\<$HomeDirectory<>\>\"", "/", "Mathematica"}], "/", 
       "PeskinSchroeder"}], "/", 
      RowBox[{
       RowBox[{"NBname", "[", "\"\<stub\>\"", "]"}], ".", "out"}]}], 
     "\"\<]\[IndentingNewLine]\>"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tuSaveFile", ":=", 
     RowBox[{"Put", "[", 
      RowBox[{"SaveFile", "=", 
       RowBox[{
        RowBox[{"NBname", "[", "\"\<stub\>\"", "]"}], "<>", 
        "\"\<.out\>\""}]}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"To", " ", "save", " ", 
      RowBox[{"variables", ":", "\[IndentingNewLine]", 
       RowBox[{"Put", "[", 
        RowBox[{"variable_List", ",", "SaveFile"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"or", " ", 
      RowBox[{"Save", "[", 
       RowBox[{"SaveFile", ",", "variable_List"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "To", " ", "retrieve", " ", "output", " ", "definitions", " ", "from", 
      " ", "file", " ", "in", " ", "current", " ", 
      RowBox[{"directory", ".", "\[IndentingNewLine]", "\t", 
       RowBox[{"Get", "[", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<LectureB2011.10.10.out\>\""}], "]"}]}], "\[IndentingNewLine]", 
      "or", "   ", 
      RowBox[{"Get", "[", 
       RowBox[{
       "$HomeDirectory", "<>", 
        "\"\</Mathematica/PeskinSchroeder/FinalProject1.out\>\""}], "]"}]}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuSaveAllVariables", "::", "usage"}], "=", 
     "\"\<tuSaveAllVariables[file_:toSaveFile] saves all Context[Global'] \
variables to file_ \>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuSaveAllVariables", "[", 
      RowBox[{"file_:", "SaveFile"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "$", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$", "=", 
         RowBox[{"Names", "[", "\"\<$*\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"$", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Context", "[", "#", "]"}], "\[Equal]", 
             "\"\<Global`\>\""}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Inactive", "[", "Save", "]"}], "[", 
          RowBox[{"file", ",", "$"}], " ", "]"}], "//", "Activate"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527879933930221*^9, 3.527880068966152*^9}, 
   3.555432637545333*^9, 3.5554327862608147`*^9, {3.555778199064436*^9, 
   3.555778200178644*^9}, {3.5557782330147963`*^9, 3.5557782677040253`*^9}, {
   3.56440458999321*^9, 3.564404592220203*^9}, 3.5644052361899147`*^9, {
   3.564405290952738*^9, 3.564405301267617*^9}, {3.564405368812229*^9, 
   3.5644054364898977`*^9}, {3.5644056110684757`*^9, 3.564405738816188*^9}, {
   3.5644063471465263`*^9, 3.564406375009626*^9}, 3.564413775437436*^9, {
   3.564841215338243*^9, 3.564841267301989*^9}, {3.5648412981148167`*^9, 
   3.564841302408098*^9}, {3.564841438400856*^9, 3.564841454162277*^9}, {
   3.5648426536876574`*^9, 3.56484266204705*^9}, 3.564844474848049*^9, {
   3.566825760129705*^9, 3.566825774453374*^9}, {3.5701054282640123`*^9, 
   3.570105511224777*^9}, {3.570202732481195*^9, 3.570202743935644*^9}, {
   3.5702029982641487`*^9, 3.5702030026177*^9}, {3.570204924170664*^9, 
   3.5702049338485527`*^9}, {3.5708421697737226`*^9, 3.570842185370248*^9}, {
   3.5708422324014683`*^9, 3.5708422443157473`*^9}, {3.570842287793892*^9, 
   3.570842350294593*^9}, {3.5708423959710903`*^9, 3.5708424294855747`*^9}, {
   3.570842479854141*^9, 3.570842487957382*^9}, {3.570842537170766*^9, 
   3.570842558091651*^9}, {3.5708425881073627`*^9, 3.5708426875465117`*^9}, {
   3.570842743911915*^9, 3.570842760098878*^9}, {3.5708428150620337`*^9, 
   3.57084283337428*^9}, {3.571232025341181*^9, 3.5712320602579823`*^9}, {
   3.571232217102319*^9, 3.571232287814302*^9}, {3.571423438946911*^9, 
   3.571423447071764*^9}, {3.571423784852826*^9, 3.57142390202459*^9}, {
   3.580211541277926*^9, 3.580211548090016*^9}, {3.5802116650011272`*^9, 
   3.580211670178278*^9}, {3.632830969929894*^9, 3.6328310352889357`*^9}, {
   3.632831069707035*^9, 3.632831165018404*^9}, {3.632831246403606*^9, 
   3.6328313040556297`*^9}, {3.633453343661016*^9, 3.633453398767769*^9}, {
   3.633453568329966*^9, 3.633453626364867*^9}, {3.634480487797556*^9, 
   3.634480515621223*^9}, {3.6464927785080338`*^9, 3.646492780074233*^9}, {
   3.6464941829672213`*^9, 3.6464943509243917`*^9}, {3.6464946503643503`*^9, 
   3.646494701592366*^9}, {3.646494764219145*^9, 3.646494764376679*^9}, {
   3.646833938720132*^9, 3.646833939570916*^9}}],

Cell["Rule rewriting routines", "Text",
 CellChangeTimes->{{3.5802116802194357`*^9, 3.5802116886681547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "variables", " ", "inbedded", " ", "in", " ", "any", " ", "one", " ", "of",
     " ", "tuRuleIndependentVarPattern", " ", "are", " ", "considered", " ", 
    "independent", " ", "from", " ", "the", " ", "variable", " ", "for", " ", 
    "the", " ", "purpose", " ", "of", " ", 
    RowBox[{"tuRule", "[", "]"}], 
    RowBox[{"s", "."}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"tuRuleIndependentVarPattern", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SubPlus", "[", "_", "]"}], ",", 
       RowBox[{"SubMinus", "[", "_", "]"}], ",", 
       RowBox[{"SuperPlus", "[", "_", "]"}], ",", 
       RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{"_", ",", "_"}], "]"}], ",", 
       RowBox[{"Superscript", "[", 
        RowBox[{"_", ",", "_"}], "]"}], ",", 
       RowBox[{"OverBar", "[", "_", "]"}], ",", 
       RowBox[{"UnderBar", "[", "_", "]"}], ",", 
       RowBox[{"OverTilde", "[", "_", "]"}], ",", 
       RowBox[{"OverHat", "[", "_", "]"}], ",", 
       RowBox[{"SuperStar", "[", "_", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRule", "::", "usage"}], "=", 
     "\"\<tuRule[rules_List] produces a List of valid Rule[]s from rules_List \
and forms a Flatten[]d list of Rules. Deletes imbedded comments and other \
non-Rule forms. Reforms Rule so -a\[Rule]b -> a\[Rule]-b . *7Aug2015*\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRule", "[", "rules_List", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "rules", "]"}], ",", 
           RowBox[{
            RowBox[{"CO", "[", "__", "]"}], "|", 
            RowBox[{"CG", "[", "__", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{"_", "\[Rule]", "_"}], "]"}], "|", 
          RowBox[{"HoldPattern", "[", 
           RowBox[{"_", ":>", "_"}], "]"}]}]}], "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{
            RowBox[{"-", "a_"}], "\[Rule]", "b_"}], "]"}], "\[Rule]", 
          RowBox[{"a", "\[Rule]", 
           RowBox[{"-", "b"}]}]}], ",", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{
            RowBox[{"-", "a_"}], ":>", "b_"}], "]"}], "\[Rule]", 
          RowBox[{"a", ":>", 
           RowBox[{"-", "b"}]}]}]}], "}"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "tuRuleSelect", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleSelect", "::", "usage"}], "=", 
     "\"\<tuRuleSelect[list_List][key_] selects all Rule[]s from list_List \
with the lhs equal to key_.  key_ may be a List of key_s. *5Sep2015*\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuRuleSelect", "[", "list_List", "]"}], "[", "key_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$keys", ",", "$rules"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$rules", "=", 
         RowBox[{
          RowBox[{"tuExtractPattern", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", "__", "]"}], 
           "]"}], "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"$keys", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", "key", "}"}], "/.", 
            RowBox[{
             RowBox[{"{", "}"}], "\[Rule]", "\[EmptySet]"}]}], "]"}], "/.", 
          RowBox[{"\[EmptySet]", "\[Rule]", 
           RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"$rules", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
              RowBox[{"#", ",", "_"}], "]"}]}], "]"}], "&"}], "/@", "$keys"}],
          "//", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleApply", "::", "usage"}], "=", 
     "\"\<tuRuleApply[rules_,nosubFn_List:{}][exp_] applies rules_ via \
ReplaceRepeated on exp_.  The optional protected_List protects these \
variables/Patterns from subcomponent replacements. i.e, \
\!\(\*SubscriptBox[\(A\), \(0\)]\)/.A->aa is not replaced if Subscript[_,_] \
is a member of nosubFn_List Default nosubFn_List:tuRuleIndependentVarPattern \
*21Jan2016*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuRuleApply", "[", 
       RowBox[{"rule_", ",", 
        RowBox[{"nosubFn_List:", "tuRuleIndependentVarPattern"}]}], "]"}], 
      "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$", "=", "exp"}], ",", "$p", ",", "$pvar", ",", "$rhead", 
         ",", "pvar1", ",", "$rule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$rule", "=", 
         RowBox[{"tuRule", "[", "rule", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"possible", " ", "protected", " ", "variables"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"$p", "=", 
         RowBox[{"$", "//", 
          RowBox[{"tuExtractPositionPattern", "[", "nosubFn", "]"}]}]}], ";", 
        
        RowBox[{"xPrint", "[", "$p", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"protected", " ", "variables", " ", "in", " ", "rule_List"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"$rhead", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "$rule"}]}], ";", 
        RowBox[{"xPrint", "[", "$rhead", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"$pvar", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "$p"}]}], ";", 
        RowBox[{"xPrint", "[", "$pvar", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"$pvar", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"$pvar", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"tuMemberQ", "[", 
              RowBox[{"#", ",", "$rhead"}], "]"}]}], "&"}]}], "]"}]}], ";", 
        RowBox[{"xPrint", "[", "$pvar", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "replace", " ", "protected", " ", "variables", " ", "in", " ", 
          "exp_"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"$pvar1", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "->", 
             RowBox[{"pvar", "[", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}], ",", "$pvar"}],
           "]"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"{", "$pvar1", "}"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"$p", "=", 
         RowBox[{"$p", "/.", "$pvar1"}]}], ";", 
        RowBox[{"xPrint", "[", "$p", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{"tuReplacePart", "[", 
          RowBox[{"$", ",", "$p"}], "]"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"$", ",", "\"\<<<\>\"", ",", "$rule"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{"$", "/.", "$rule"}]}], ";", 
        RowBox[{"xPrint", "[", "$", "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Repeated", "??"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"replacement", " ", "Rule", " ", "for", " ", "pvar"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"$pvar1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", "$pvar1", ")"}]}]}], ";", 
        RowBox[{"xPrint", "[", "$pvar1", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"$", "/.", "$pvar1"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"C", "[", "Rule", "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleSolve", "::", "usage"}], "=", 
     "\"\<tuRuleSolve[rules_,vars_,independentVars_List:\
tuRuleIndependentVarPattern] Solve[]s rules_ (singly or List[]) for vars_ \
(Singly or List[] of Pattern[]s) and returns Rules for vars_.  \
independentVars_Alternatives:{} can be set to indicate independent variables \
that are Mathematica functions such as OverBar[a]. *23May2014*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleSolve", "[", 
      RowBox[{"rules_", ",", "vars_", ",", 
       RowBox[{"independentVars_List:", "tuRuleIndependentVarPattern"}], ",", 
       
       RowBox[{"maxExtraCondition_:", "0"}]}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "XXXX", ",", "varlist", ",", "Xs", ",", "subX", ",", 
         "varPat", ",", "xrules", ",", 
         RowBox[{"xvars", "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "vars", "}"}], "]"}], "]"}]}], " ", ",", 
         "independentPos", ",", "independents", ",", "independentLab", ",", 
         "Is", ",", "IIII", ",", "subIIII", ",", "SolveArgs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"**", "**"}], "*****)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"varlist", ",", "xrules"}], "}"}], "=", 
         RowBox[{
          RowBox[{"ExtractPatternXpat", "[", "xvars", "]"}], "[", 
          RowBox[{"tuRule", "[", 
           RowBox[{"{", 
            RowBox[{"rules", "/.", 
             RowBox[{"Equal", "\[Rule]", "Rule"}]}], "}"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"varlist", "=", 
         RowBox[{"DeleteDuplicates", "[", "varlist", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"OK", "?"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"subX", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"varlist", ",", 
            RowBox[{"(", 
             RowBox[{"Xs", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"XXXX", ",", 
                RowBox[{"Length", "[", "varlist", "]"}]}], "]"}]}], ")"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Substitute", " ", "vars_", " ", "for", " ", "Solve", " ", 
          "variables"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"xrules", "//.", "subX"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<>\>\"", ",", "tmp"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"tuFreeQ", "[", 
              RowBox[{"#", ",", "Xs"}], "]"}]}], "&"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Remove", " ", "irrelevant", " ", "Rules"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"SolveArgs", "=", 
         RowBox[{"{", 
          RowBox[{"tmp", ",", "Xs"}], "}"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{
         "\"\<>\>\"", ",", "SolveArgs", ",", "\"\<:\>\"", ",", "tmp", ",", 
          "\"\<:\>\"", ",", "Xs"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "independentVars", " ", "need", " ", "dummy", " ", "labels", " ", 
          "incase", " ", "unclothed", " ", "independentVars", " ", "is", " ", 
          "in", " ", "vars_"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"independentPos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"SolveArgs", ",", "independentVars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"independents", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "independentPos"}], 
          "//", "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"independentLab", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "->", 
             RowBox[{"IIII", "[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}]}], "&"}], ",", 
           "independents"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"subIIII", "=", 
         RowBox[{"independentPos", "//.", "independentLab"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SolveArgs", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"SolveArgs", ",", "subIIII"}], "]"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"SolveArgs", ",", "\"\<:\>\"", ",", "subIIII"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SolveArgs", "=", 
         RowBox[{"SolveArgs", "/.", 
          RowBox[{"Rule", "->", "Equal"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"Sequence", ",", "SolveArgs"}], "]"}], ",", 
           RowBox[{"MaxExtraConditions", "\[Rule]", "maxExtraCondition"}]}], 
          "]"}]}], ";", 
        RowBox[{"(*", "TEST", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"SolveArgs", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"SolveArgs", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"SolveArgs", ",", "\"\<:\>\"", ",", "tmp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Replace", " ", "independentLab"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "RemovePatterns"}]}], ";", 
        RowBox[{"xPrint", "[", "tmp", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"Reverse", "/@", "independentLab"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "//.", 
           RowBox[{"Reverse", "/@", "subX"}]}], "//.", 
          RowBox[{
           RowBox[{"Xpat", "[", "a_", "]"}], "\[Rule]", "a"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "//", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xRuleX", "[", 
      RowBox[{"rules_", ",", "vars_", ",", 
       RowBox[{"independentVars_List:", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"_", ",", "_"}], "]"}], ",", 
          RowBox[{"Superscript", "[", 
           RowBox[{"_", ",", "_"}], "]"}], ",", 
          RowBox[{"OverBar", "[", "_", "]"}], ",", 
          RowBox[{"OverTilde", "[", "_", "]"}], ",", 
          RowBox[{"OverHat", "[", "_", "]"}], ",", 
          SuperscriptBox["_", "*"]}], "}"}]}]}], "]"}], ":=", 
     RowBox[{"tuRuleSolve", "[", 
      RowBox[{"rules", ",", "vars", ",", "independentVars"}], "]"}]}], ";"}], 
   
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InvertRules", "[", 
      RowBox[{"rules_List", ",", "vars_List"}], "]"}], ":=", 
     RowBox[{"tuRuleSolve", "[", 
      RowBox[{"rules", ",", "vars"}], "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "tuRuleEliminate", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleEliminate", "::", "usage"}], ":=", 
     "\"\<tuRuleEliminate[pattern_List][rules_List] composes rules from \
rules_List of form Map[Rule[tuRuleSolve[{rule_[#]},#],pattern_]. Works for \
Dot[] patterns.  WARNING: The order of rules_List determines the order in \
which patterns are substituted back into rules_.  *18Jun2015*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuRuleEliminate", "[", "pattern_List", "]"}], "[", "rules_", 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$r", "=", 
          RowBox[{"tuRule", "[", 
           RowBox[{"{", "rules", "}"}], "]"}]}], ",", 
         RowBox[{"$rp", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"$p", "=", "pattern"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"Apply", " ", "simple", " ", "pattern_", " ", "rules", " ", 
         RowBox[{"first", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<>\>\"", ",", "$r"}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"$rp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tuExtractPositionPattern", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "\[Rule]", "_"}], ",", 
                RowBox[{"_", "\[Rule]", "#"}]}], "}"}], "]"}], "[", "$r", 
             "]"}], "&"}], ",", "$p"}], "]"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<>\>\"", ",", "$rp"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"$rp", "!=", 
            RowBox[{"{", 
             RowBox[{"{", "}"}], "}"}]}], "&&", 
           RowBox[{"$rp", "!=", 
            RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$rp", "=", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "$rp"}], 
              "]"}], "//", "DeleteDuplicates"}]}], ";", 
           RowBox[{"xPrint", "[", 
            RowBox[{
            "\"\<>\>\"", ",", "$p", ",", "\"\< \>\"", ",", "$rp", ",", 
             "\"\< \>\"", ",", "$r", ",", "\"\<<\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"$rp", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"tuRuleSolve", "[", 
                RowBox[{
                 RowBox[{"$r", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "$p"}], "]"}], "&"}], 
              ",", "$rp"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"$rp", "=", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"$rp", ",", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{"Solve", "[", 
                 RowBox[{"_", ",", "_"}], "]"}], "]"}]}], "]"}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "$r", "]"}], ">", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"$r", "=", 
              RowBox[{"$r", "//.", "$rp"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"$r", "=", "$rp"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Inspect", " ", "each", " ", "rule", " ", "for", " ", "possible", 
          " ", "pattern", " ", 
          RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"$rp", "=", 
         RowBox[{
          RowBox[{"tuExtractPositionPattern", "[", "$p", "]"}], "[", "$r", 
          "]"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{
         "\"\<>\>\"", ",", "$p", ",", "\"\< \>\"", ",", "$rp", ",", 
          "\"\< \>\"", ",", "$r", ",", "\"\<<\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$rp", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "$rp"}], 
           "]"}], "//", "DeleteDuplicates"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"$p", ",", "\"\< \>\"", ",", "$rp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$rp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tuRuleSolve", "[", 
             RowBox[{
              RowBox[{"$r", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "$p"}], "]"}], "&"}], ",",
            "$rp"}], "]"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"$p", ",", "\"\< \>\"", ",", "$rp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$rp", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"$rp", ",", 
            RowBox[{"HoldPattern", "[", 
             RowBox[{"Solve", "[", 
              RowBox[{"_", ",", "_"}], "]"}], "]"}]}], "]"}], "//", 
          "Flatten"}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<>\>\"", ",", "$r", ",", "\"\< \>\"", ",", "$rp"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "$r", "]"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"$r", "=", 
           RowBox[{"$r", "//.", "$rp"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"$r", "=", "$rp"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$r", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"$r", ",", 
            RowBox[{"a_", "\[Rule]", "a_"}]}], "]"}], "//", "tuRule"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuEliminate", "::", "usage"}], "=", 
     "\"\<tuEliminate[rules_,vars_,independentVars_List:\
tuRuleIndependentVarPattern] applies Eliminate[] to a list of rules_ \
eliminating vars_. Recognizes negative powers of vars_.  Variables Matching \
independentVars_ are treated independent variables. *23May2014\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuEliminate", "[", 
      RowBox[{"rules_", ",", "vars_", ",", 
       RowBox[{"independentVars_List:", "tuRuleIndependentVarPattern"}]}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tmp", ",", "XXXX", ",", "varlist", ",", "Xs", ",", "subX", ",", 
         "varPat", ",", "xrules", ",", 
         RowBox[{"xvars", "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "vars", "}"}], "]"}], "]"}]}], " ", ",", 
         "independentPos", ",", "independents", ",", "independentLab", ",", 
         "Is", ",", "IIII", ",", "subIIII", ",", "SolveArgs", ",", "ivars", 
         ",", "xpower"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xpower", "[", "rule_Rule", "]"}], ":=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pow", ",", 
             RowBox[{"tmp", "=", "rule"}]}], "}"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "eliminate", " ", "negative", " ", "powers", " ", "in", " ", 
             "rule"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tmp", "=", 
             RowBox[{"tmp", "/.", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{"a", ",", "n_"}], "]"}], "\[RuleDelayed]", 
               RowBox[{
                RowBox[{"power", "[", 
                 RowBox[{"a", ",", "n"}], "]"}], "/;", 
                RowBox[{"n", "<", "0"}]}]}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pow", "=", 
             RowBox[{"tmp", "//", 
              RowBox[{"tuExtractPattern", "[", 
               RowBox[{"power", "[", 
                RowBox[{"a", ",", "_"}], "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tmp", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pow", "=!=", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"pow", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
                 RowBox[{"-", 
                  RowBox[{"pow", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
                RowBox[{"pow", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"pow", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "#"}], "&"}], "/@", 
                  "tmp"}]}], ";", 
                RowBox[{"pow", "/.", 
                 RowBox[{"power", "\[Rule]", "Power"}]}]}], ",", 
               "\[IndentingNewLine]", "tmp"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"**", "**"}], "*****)"}], "\[IndentingNewLine]", 
        RowBox[{"xrules", "=", 
         RowBox[{"tuRule", "[", 
          RowBox[{
           RowBox[{"{", "rules", "}"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Equal", "\[Rule]", "Rule"}], ",", 
             RowBox[{"And", "\[Rule]", "List"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Eliminate", " ", 
          RowBox[{"1", "/", 
           RowBox[{
            RowBox[{"(", "vars_", ")"}], "^", "n"}]}], " ", "from", " ", 
          "denominator", " ", "in", " ", "rules_"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "#"}], "&"}], "/@", "xvars"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xrules", "=", 
         RowBox[{"xpower", "/@", "xrules"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"varlist", ",", "xrules"}], "}"}], "=", 
         RowBox[{
          RowBox[{"ExtractPatternXpat", "[", "xvars", "]"}], "[", "xrules", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"\"\<VV\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"varlist", ",", "xrules"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"varlist", "=", 
         RowBox[{"DeleteDuplicates", "[", "varlist", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"OK", "?"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"subX", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"varlist", ",", 
            RowBox[{"(", 
             RowBox[{"Xs", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"XXXX", ",", 
                RowBox[{"Length", "[", "varlist", "]"}]}], "]"}]}], ")"}]}], 
           "]"}], "]"}]}], ";", 
        RowBox[{"xPrint", "[", "subX", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Substitute", " ", "vars_", " ", "for", " ", "Solve", " ", 
          "variables"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"xrules", "//.", "subX"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SolveArgs", "=", 
         RowBox[{"{", 
          RowBox[{"tmp", ",", "Xs"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "independentVars", " ", "need", " ", "dummy", " ", "labels", " ", 
          "incase", " ", "unclothed", " ", "independentVars", " ", "is", " ", 
          "in", " ", "vars_"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"independentPos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"SolveArgs", ",", "independentVars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"independents", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "independentPos"}], 
          "//", "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"independentLab", "=", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "->", 
             RowBox[{"IIII", "[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}]}], "&"}], ",", 
           "independents"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"subIIII", "=", 
         RowBox[{"independentPos", "//.", "independentLab"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SolveArgs", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"SolveArgs", ",", "subIIII"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SolveArgs", "=", 
         RowBox[{"SolveArgs", "/.", 
          RowBox[{"Rule", "->", "Equal"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Eliminate", "[", 
          RowBox[{"Apply", "[", 
           RowBox[{"Sequence", ",", "SolveArgs"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Replace", " ", "independentLab"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", "RemovePatterns"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"Reverse", "/@", "independentLab"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmp", "//.", 
           RowBox[{"Reverse", "/@", "subX"}]}], "//.", 
          RowBox[{
           RowBox[{"Xpat", "[", "a_", "]"}], "\[Rule]", "a"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "//", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xEliminate", "[", 
      RowBox[{"rules_", ",", "vars_", ",", 
       RowBox[{"independentVars_List:", "tuRuleIndependentVarPattern"}]}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"tuEliminate", "[", 
      RowBox[{"rules", ",", "vars", ",", "independentVars"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rewrites", " ", 
      RowBox[{"(", "simple", ")"}], " ", "rule_", " ", "in", " ", "form", "  ",
       "var_"}], "\[Rule]", " ", 
     RowBox[{
      RowBox[{"..", "  ", ".", "  ", "var_"}], " ", "may", " ", "be", " ", 
      "a", " ", "pattern", " ", "but", " ", "must", " ", "only", " ", "match",
       " ", "one", " ", "item", " ", "in", " ", 
      RowBox[{"rule", ".", "  ", "var_"}], " ", "needs", " ", "to", " ", "be",
       " ", "a", " ", "variable", " ", "that", " ", "can", " ", "be", " ", 
      "Solved", " ", "for", " ", "in", " ", "rule_.", "  ", 
      "\[IndentingNewLine]", "This", " ", "Module", " ", "does", " ", "not", 
      " ", "work", " ", "with", " ", "Power", " ", "or", " ", 
      RowBox[{
       SqrtBox[" "], " ", ".", "  ", "Only"}], " ", "uses", " ", "first", " ",
       "solution", " ", "of", " ", "Solve", "  ", "*", "13", "Dec2012"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX", "[", 
      RowBox[{"rule_Rule", ",", "var_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Equal", ",", "rule"}], "]"}]}], ",", "XXXXX", ",", 
         "list"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"First", "[", 
           RowBox[{
            RowBox[{"ExtractPatternXpat", "[", "var", "]"}], "[", "rule", 
            "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"list", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "//.", 
             RowBox[{"var", "\[Rule]", "XXXXX"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{"tmp", ",", "XXXXX"}], "]"}], "//", "First"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"tmp", "=", 
              RowBox[{"tmp", "//.", 
               RowBox[{"XXXXX", "\[Rule]", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"tmp", "=", 
              RowBox[{"tmp", "//.", 
               RowBox[{"XXXXX", "\[Rule]", "var"}]}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", 
              RowBox[{"Pattern", "->", "xPattern"}]}], "/.", 
             RowBox[{
              RowBox[{"xPattern", "[", 
               RowBox[{"x_", ",", "b_"}], "]"}], "->", "x"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Xpat", "[", "a_", "]"}], "->", "a"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Return", " ", 
            RowBox[{"{", "}"}], " ", "if", " ", "var_"}], " ", "\[Element]", 
           " ", "rule_Rule"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "As", " ", "RuleX", " ", "but", " ", "returns", " ", "all", " ", 
     "solutions", " ", "of", " ", 
     RowBox[{"Solve", "."}], " ", "*", "10", "Jan2013"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleXall", "[", 
      RowBox[{"rule_Rule", ",", "var_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Equal", ",", "rule"}], "]"}]}], ",", "XXXXX", ",", 
         "list"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"ExtractPattern", "[", 
           RowBox[{"rule", ",", "var"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"var", "\[Rule]", "XXXXX"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"tmp", ",", "XXXXX"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{"(*", 
           RowBox[{
           "In", " ", "general", " ", "only", " ", "one", " ", "var_"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{"XXXXX", "\[Rule]", 
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{"XXXXX", "\[Rule]", "var"}]}]}]}], 
         RowBox[{"(*", 
          RowBox[{
          "For", " ", "cases", " ", "where", " ", "there", " ", "may", " ", 
           "be", " ", "a", " ", 
           RowBox[{"choice", "."}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "//", "RemovePatterns"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Applies", " ", 
     RowBox[{"RuleX", "[", 
      RowBox[{"rule_", ",", "var_"}], "]"}], " ", "to", " ", "a", " ", "list",
      " ", "of", " ", "Rules", " ", "*", "13", "Dec2013"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX", "[", 
      RowBox[{"rules_List", ",", "var_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "sub", ",", 
         RowBox[{"tmp", "=", 
          RowBox[{"rules", " ", "//", "Flatten"}]}]}], " ", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Rule", "->", "Equal"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{"tmp", ",", "var"}], "]"}], "//", "Flatten"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Applies", " ", 
     RowBox[{"RuleX", "[", 
      RowBox[{"rule_", ",", "var_"}], "]"}], " ", "to", " ", "a", " ", "list",
      " ", "of", " ", "Rules", " ", "*", "13", "Dec2013"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX", "[", 
      RowBox[{"rules_List", ",", "var_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "sub", ",", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{"{", "rules", "}"}], " ", "//", "Flatten"}]}]}], " ", 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"RuleX", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "&"}], "/@", "tmp"}], "//", 
         "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX2", "[", 
      RowBox[{"rules_List", ",", "var_"}], "]"}], ":=", 
     RowBox[{"RuleX", "[", 
      RowBox[{"rules", ",", "var"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"Backward", " ", "compatibility"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rewrites", " ", 
      RowBox[{"(", "simple", ")"}], " ", "rule_", " ", "in", " ", "form", "  ",
       "var_"}], "\[Rule]", " ", 
     RowBox[{
     "..", "   ", "var_", " ", "may", " ", "be", " ", "a", " ", "pattern", 
      " ", "but", " ", "must", " ", "only", " ", "match", " ", "one", " ", 
      "item", " ", "in", " ", 
      RowBox[{"rule", ".", "  ", "Returns"}], " ", "all", " ", "possible", 
      " ", 
      RowBox[{"Solutions", "."}]}]}], " ", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX1", "[", 
      RowBox[{"rule_Rule", ",", "var_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Equal", ",", "rule"}], "]"}]}], ",", "XXXXX", ",", "list",
          ",", "tmpx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"ExtractPattern", "[", 
           RowBox[{"rule", ",", "var"}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"list", " ", "of", " ", "var"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmpx", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"var", "\[Rule]", "XXXXX"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmpx", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"tmpx", ",", "XXXXX"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "1"}], 
           RowBox[{"(*", 
            RowBox[{"one", " ", "var"}], "*)"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "tmpx", "]"}], ">", "0"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"\[Exists]", " ", 
             RowBox[{"some", " ", "solution"}]}], ",", " ", "replace"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpx", "=", 
            RowBox[{"tmpx", "/.", 
             RowBox[{"XXXXX", "\[Rule]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmpx", "=", 
            RowBox[{"{", 
             RowBox[{"Apply", "[", 
              RowBox[{"Rule", ",", "tmp"}], "]"}], "}"}]}], 
           RowBox[{"(*", 
            RowBox[{"no", " ", "solution"}], "*)"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"tmpx", "/.", 
           RowBox[{"Pattern", "->", "xPattern"}]}], "/.", 
          RowBox[{
           RowBox[{"xPattern", "[", 
            RowBox[{"x_", ",", "b_"}], "]"}], "->", "x"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "//", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\n", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Applies", " ", "RuleX", " ", "converting", " ", "patternvar_", " ", "on",
      " ", "LHS", " ", "to", " ", 
     RowBox[{"Pattern", "."}], " ", "*", "13", "Dec2012"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX", "[", 
      RowBox[{"rules_", ",", " ", "var_", ",", "patternvar_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RuleX2PatternVar", "[", "   ", 
         RowBox[{
          RowBox[{"RuleX", "[", 
           RowBox[{
            RowBox[{"{", "rules", "}"}], ",", "var"}], "]"}], ",", "  ", 
          "patternvar"}], "  ", "]"}], "//", "Flatten"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX1", "[", 
      RowBox[{"rules_", ",", " ", "var_", ",", "patternvar_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RuleX2PatternVar", "[", "   ", 
         RowBox[{
          RowBox[{"RuleX", "[", 
           RowBox[{
            RowBox[{"{", "rules", "}"}], ",", "var"}], "]"}], ",", "  ", 
          "patternvar"}], "  ", "]"}], "//", "Flatten"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Changes", " ", "straight", " ", "variables", " ", "in", " ", "left"}], 
     "-", 
     RowBox[{
     "hand", " ", "part", " ", "of", " ", "rules_", " ", "to", " ", "Pattern",
       " ", "as", " ", "specified", " ", "by", " ", "patternvars_"}]}], "  ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"tuAddPatternVariable", "::", "usage"}], "=", 
     "\"\<tuAddPatternVariable[variables_,Btype_:Blank][rules_] Converts \
variables_ on LHS of rules_ into Patterns (Btype_ option is available.). \
Syntax option: tuAddPatternVariable[rules_,variables_].  Rules/Variables may \
be a Lists. (*24Dec2014*)\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuAddPatternVariable", "[", " ", 
       RowBox[{"variables_", " ", ",", " ", 
        RowBox[{"Btype_", " ", ":", " ", "Blank"}]}], "  ", "]"}], " ", "[", 
      "rules_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "rules"}], ",", "pvar", ",", "sub"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pvar", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "variables", "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", 
             RowBox[{"Pattern", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Btype", "[", "]"}]}], "]"}]}], " ", "&"}], ",", 
           "pvar"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"xRule", "[", 
            RowBox[{
             RowBox[{"a", "/.", "sub"}], ",", "b"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"xRule", "->", "Rule"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RuleX2PatternVar", "[", 
      RowBox[{"rules_", ",", "variables_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"tuAddPatternVariable", "[", "variables", "]"}], "[", "rules", 
      "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Make", " ", 
      RowBox[{"Rule", "[", "]"}], "s", " ", "from", " ", "a", " ", "2"}], "-", 
     RowBox[{
     "D", " ", "table", " ", "where", " ", "the", " ", "first", " ", "row", 
      " ", "defines", " ", "column", " ", "parameter", " ", "labels", " ", 
      "and", " ", "the", " ", "first", " ", "column", " ", "defines", " ", 
      "variables", " ", "referenced", " ", "by", " ", "var_.", "  ", "The", 
      " ", "result", " ", "is", " ", "a", " ", "set", " ", "of", " ", 
      RowBox[{"Rule", "[", "]"}], "s", " ", "for", " ", "each", " ", "column",
       " ", "parameter", " ", "of", " ", "the", " ", "var_", " ", 
      RowBox[{"specified", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TableRules", "[", "table_", "]"}], "[", "var_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"head", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"tmp", "=", "table"}], ",", "pattern", ",", "row"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pattern", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"_", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "head", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pattern", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "var"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"tmp", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"row", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"tmp", ",", "pattern"}], "]"}], "//", "First"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"head", ",", "row"}], "]"}], "]"}], ",", "1"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleSubtract", "::", "usage"}], "=", 
     "\"\<tuRuleSubtract[rules_List] list of Rules and output a Rule which \
the first Rule minus the subsequent Rules for the right and left Rule terms. \
*21Jun2015*\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleSubtract", "[", "rules_List", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "head", ",", "first", ",", "rest"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"Head", "[", 
          RowBox[{"first", "=", 
           RowBox[{"First", "[", "rules", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rest", "=", 
         RowBox[{"Rest", "[", "rules", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"first", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "first"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rest", "=", 
         RowBox[{"-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rest"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "first", "}"}], ",", "rest"}], "}"}], ",", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"head", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubtractRules", "[", "rules_List", "]"}], ":=", 
     RowBox[{"tuRuleSubtract", "[", "rules", "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleAdd", "::", "usage"}], "=", 
     "\"\<tuRuleAdd[rules_List] returns a sum of Left Hand Side \[Rule] sum \
of Right Hand Side of rules_List *13Sep2015*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleAdd", "[", "rules_List", "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], "&"}], ",", "rules"}], "]"}]}], 
       "]"}], "\[Rule]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], "&"}], ",", "rules"}], "]"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AddRules", "[", "rules_List", "]"}], ":=", 
     RowBox[{"tuRuleAdd", "[", "rules", "]"}]}], ";"}], " ", 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "TimesRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", 
      "Rules", " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which",
       " ", "is", " ", "a", " ", "product", " ", "of", " ", "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "product", " ", "of", 
      " ", "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TimesRules", "[", "rules_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Times", ",", "tmp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleDivide", "::", "usage"}], "=", 
     "\"\<tuRuleDivide[rules_List] forms ratio of first two Rules in \
rules_List. \>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuRuleDivide", "[", "rules_List", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "/", "#2"}], "&"}], ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DivideRules", "[", "rules_List", "]"}], ":=", 
     RowBox[{"tuRuleDivide", "[", "rules", "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "OpRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", "Rules", 
      " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which", " ", 
      "is", " ", "a", " ", "Op", " ", "combination", " ", "of", " ", 
      "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "Op", " ", "combination",
       " ", "of", " ", "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", ".", " ", "Work"}], " ", "with", " ", "single", " ", 
      "item", " ", "Rule_List", " ", "*", "12", "Mar2014"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpRules", "[", 
      RowBox[{"rules_List", ",", "operator_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"operator", ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "OpRules", " ", "take", " ", "a", " ", "list", " ", "of", " ", "Rules", 
      " ", "and", " ", "output", " ", "a", " ", "Rule", " ", "which", " ", 
      "is", " ", "a", " ", "Op", " ", "combination", " ", "of", " ", 
      "right"}], "-", 
     RowBox[{
     "hand", " ", "terms", " ", "to", " ", "a", " ", "Op", " ", "combination",
       " ", "of", " ", "left"}], "-", 
     RowBox[{"hand", " ", 
      RowBox[{"terms", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OpRules", "[", 
      RowBox[{"operator_", ",", "rules_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "head"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"Head", "[", 
          RowBox[{"First", "[", "rules", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", "rules"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"operator", ",", "tmp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"head", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Solves", " ", "vars_", " ", "for", " ", "a", " ", "set", " ", "of", " ", 
     "rules_"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SolveRules", "[", 
      RowBox[{"rules_", ",", "vars_"}], "]"}], ":=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rules", "//.", 
         RowBox[{"Rule", "->", "Equal"}]}], ")"}], ",", "vars"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuPatternRemove", "::", "usage"}], "=", 
     "\"\<tuPatternRemove[exp_] removes \
Pattern[a_,Blank[]|BlankSequence[]]:>a in all of exp_ *24Nov2013*)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuPatternRemove", "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "xPattern"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "//.", 
           RowBox[{"Pattern", "\[Rule]", "xPattern"}]}], "//.", 
          RowBox[{
           RowBox[{"xPattern", "[", 
            RowBox[{"a_", ",", 
             RowBox[{
              RowBox[{"Blank", "[", "]"}], "|", 
              RowBox[{"BlankSequence", "[", "]"}]}]}], "]"}], ":>", "a"}]}], "/.", 
         RowBox[{"xPattern", "->", "Pattern"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemovePatterns", "[", "exp_", "]"}], ":=", 
     RowBox[{"tuPatternRemove", "[", "exp", "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RuleVarPattern", "[", "var_List", "]"}], "[", "rule_Rule", 
      "]"}], " ", "converts", " ", "var", " ", "in", " ", "Rule", " ", "to", 
     " ", 
     RowBox[{"Pattern", "[", 
      RowBox[{"var", ",", 
       RowBox[{"Blank", "[", "]"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RuleVarPattern", "[", "var_List", "]"}], "[", 
      RowBox[{"rule_Rule", "|", "rule_RuleDelayed"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", 
         RowBox[{"rule", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "->", 
              RowBox[{"Pattern", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Blank", "[", "]"}]}], "]"}]}], "&"}], ",", "var"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "->", 
          RowBox[{"rule", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RulesVarPatterns", "[", "var_List", "]"}], "[", "exp_", "]"}], 
     " ", "converts", " ", "var_List", " ", "in", " ", "exp_", " ", 
     "containing", " ", "Rule", " ", "to", " ", 
     RowBox[{"Pattern", "[", 
      RowBox[{"var", ",", 
       RowBox[{"Blank", "[", "]"}]}], "]"}], " ", "DOES", " ", "NOT", " ", 
     "RECOGNIZE", " ", "ALTERNATIVE", " ", "exp", " ", "ARGUEMENTS", " ", "*",
      "7", "Dec2014"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RulesVarPattern", "[", "var_List", "]"}], "[", 
      RowBox[{"exp_List", "|", "exp_Rule", "|", "exp_RuleDelayed"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rulepos", ",", 
         RowBox[{"tmp", "=", "exp"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "exp", "]"}], "===", "List"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rulepos", "=", 
            RowBox[{"ExtractPositionPattern", "[", 
             RowBox[{
              RowBox[{"{", "tmp", "}"}], ",", 
              RowBox[{"Rule", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rulepos", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"RuleVarPattern", "[", "var", "]"}], "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
              "rulepos"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{
               RowBox[{"{", "tmp", "}"}], ",", "rulepos"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"exp", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "->", 
                 RowBox[{"Pattern", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Blank", "[", "]"}]}], "]"}]}], "&"}], ",", 
               "var"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "->", 
             RowBox[{"exp", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RulePatternCondition", "[", 
      RowBox[{
       RowBox[{"rule_Rule", "|", "rule_RuleDelayed"}], ",", "pvars_List", ",",
        "condition_Hold"}], "]"}], " ", "converts", " ", "Rule", " ", "into", 
     " ", "RuleDelayed", " ", "with", " ", "condition_Hold", " ", "*", "24", 
     "Nov2014"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RulePatternCondition", "[", 
      RowBox[{
       RowBox[{"rule_Rule", "|", "rule_RuleDelayed"}], ",", "pvars_List", ",",
        "condition_Hold"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "rule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//", 
          RowBox[{"RuleX2PatternVar", "[", "pvars", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/;", "condition"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{"Rule", "\[Rule]", "RuleDelayed"}]}], "//", 
         "ReleaseHold"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"RuleAddCondtion", "[", "condition_", "]"}], "[", "rule_", 
      "]"}], " ", "adds", " ", "condition_", " ", "to", " ", "rule_.", "  ", 
     "*", "13", "Dec2013"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RuleAddCondtion", "[", "cond_", "]"}], "[", "rule_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "rule"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], "->", 
           RowBox[{"xRule", "[", 
            RowBox[{"a", ",", 
             RowBox[{"xCondition", "[", 
              RowBox[{"b", ",", "cond"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{"xCondition", "->", "Condition"}]}], "/.", 
          RowBox[{"xRule", "->", "RuleDelayed"}]}], "//", "ReleaseHold"}]}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuSimplifyRules", "::", "usage"}], "=", 
     "\"\<tuSimplifyRules[exp_] Simplify[]s Rules in exp_ *11Jan2015*\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuSimplifyRules", "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$", "=", 
         RowBox[{
          RowBox[{"$", "/.", 
           RowBox[{"Rule", "\[Rule]", "Equal"}]}], "//", "Simplify"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{"$", "/.", 
          RowBox[{"Equal", "\[Rule]", "Rule"}]}]}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527879933930221*^9, 3.527880068966152*^9}, 
   3.555432637545333*^9, 3.5554327862608147`*^9, {3.555778199064436*^9, 
   3.555778200178644*^9}, {3.5557782330147963`*^9, 3.5557782677040253`*^9}, {
   3.56440458999321*^9, 3.564404592220203*^9}, 3.5644052361899147`*^9, {
   3.564405290952738*^9, 3.564405301267617*^9}, {3.564405368812229*^9, 
   3.5644054364898977`*^9}, {3.5644056110684757`*^9, 3.564405738816188*^9}, {
   3.5644063471465263`*^9, 3.564406375009626*^9}, 3.564413775437436*^9, {
   3.564841215338243*^9, 3.564841267301989*^9}, {3.5648412981148167`*^9, 
   3.564841302408098*^9}, {3.564841438400856*^9, 3.564841454162277*^9}, {
   3.5648426536876574`*^9, 3.56484266204705*^9}, 3.564844474848049*^9, {
   3.566825760129705*^9, 3.566825774453374*^9}, {3.5701054282640123`*^9, 
   3.570105511224777*^9}, {3.570202732481195*^9, 3.570202743935644*^9}, {
   3.5702029982641487`*^9, 3.5702030026177*^9}, {3.570204924170664*^9, 
   3.5702049338485527`*^9}, {3.5708421697737226`*^9, 3.570842185370248*^9}, {
   3.5708422324014683`*^9, 3.5708422443157473`*^9}, {3.570842287793892*^9, 
   3.570842350294593*^9}, {3.5708423959710903`*^9, 3.5708424294855747`*^9}, {
   3.570842479854141*^9, 3.570842487957382*^9}, {3.570842537170766*^9, 
   3.570842558091651*^9}, {3.5708425881073627`*^9, 3.5708426875465117`*^9}, {
   3.570842743911915*^9, 3.570842760098878*^9}, {3.5708428150620337`*^9, 
   3.57084283337428*^9}, {3.571232025341181*^9, 3.5712320602579823`*^9}, {
   3.571232217102319*^9, 3.571232287814302*^9}, {3.571423438946911*^9, 
   3.571423447071764*^9}, {3.571423784852826*^9, 3.57142390202459*^9}, {
   3.580211541277926*^9, 3.580211548090016*^9}, {3.5802116650011272`*^9, 
   3.580211670178278*^9}, {3.580211715859536*^9, 3.580211717215892*^9}, {
   3.5802117834097967`*^9, 3.580211806362259*^9}, {3.58023014966059*^9, 
   3.580230242722711*^9}, {3.580230279767311*^9, 3.5802302906262407`*^9}, 
   3.580489258740979*^9, {3.5831145695360317`*^9, 3.583114813263413*^9}, {
   3.583152072355712*^9, 3.5831520884873*^9}, {3.58315212236434*^9, 
   3.583152126915297*^9}, 3.583152424640051*^9, 3.583854612191463*^9, {
   3.592057160441949*^9, 3.592057166671455*^9}, {3.592057210532275*^9, 
   3.592057218699329*^9}, {3.594307608847767*^9, 3.594307609455961*^9}, {
   3.594307655760858*^9, 3.594307788273045*^9}, {3.59430796498489*^9, 
   3.594308031038992*^9}, {3.5959517838399563`*^9, 3.5959519029729156`*^9}, {
   3.60338077944809*^9, 3.603380786755522*^9}, 3.603380826859798*^9, {
   3.6037625115643177`*^9, 3.603762570379992*^9}, 3.608645703121544*^9, 
   3.609765214736075*^9, 3.609765257815874*^9, {3.609813150119255*^9, 
   3.6098133081418257`*^9}, {3.6098474856986427`*^9, 3.609847489350973*^9}, {
   3.609847526433362*^9, 3.609847527584755*^9}, {3.609847561554915*^9, 
   3.609847569404668*^9}, 3.609850113620091*^9, {3.610018212855097*^9, 
   3.610018300463969*^9}, {3.6103272205124693`*^9, 3.6103272227669563`*^9}, {
   3.610801959985691*^9, 3.610801960565111*^9}, {3.610802585607461*^9, 
   3.6108026184172707`*^9}, {3.6108068721751738`*^9, 3.610806892504768*^9}, {
   3.611152628398123*^9, 3.6111526645812693`*^9}, {3.611152948282855*^9, 
   3.61115300403491*^9}, {3.6111530660029087`*^9, 3.611153082828594*^9}, {
   3.6211710489239597`*^9, 3.621171049990947*^9}, {3.621736323339964*^9, 
   3.62173632358702*^9}, {3.626798854724638*^9, 3.626798878690297*^9}, {
   3.626801230545158*^9, 3.626801257934883*^9}, {3.6268016579635363`*^9, 
   3.626801702722218*^9}, {3.628352178305107*^9, 3.628352298333612*^9}, {
   3.628352416764776*^9, 3.628352482756061*^9}, {3.628397295958426*^9, 
   3.628397312011092*^9}, {3.628438066975956*^9, 3.628438083116839*^9}, {
   3.6284381219087963`*^9, 3.628438160442315*^9}, {3.628438196099902*^9, 
   3.628438297793833*^9}, {3.628439558472233*^9, 3.6284395669371843`*^9}, {
   3.62843960627396*^9, 3.628439676639399*^9}, {3.628452709939974*^9, 
   3.628452824541327*^9}, 3.628452983708537*^9, {3.629903207605719*^9, 
   3.629903218482456*^9}, {3.629991832240962*^9, 3.6299918396623583`*^9}, {
   3.629992111644442*^9, 3.62999211179793*^9}, {3.630168266077641*^9, 
   3.63016848161866*^9}, {3.631452790648995*^9, 3.631452792810313*^9}, {
   3.632228667552055*^9, 3.6322286888058453`*^9}, 3.632229547203679*^9, 
   3.632230013218554*^9, {3.6322384697535143`*^9, 3.632238624123191*^9}, {
   3.640973353701745*^9, 3.6409734196213818`*^9}, 3.641044981508288*^9, {
   3.641049558337405*^9, 3.641049573279399*^9}, 3.641051017992815*^9, 
   3.6410531013259497`*^9, 3.641087847667879*^9, {3.643894497304768*^9, 
   3.643894544125115*^9}, {3.643894591174335*^9, 3.643894594116109*^9}, {
   3.643894696810533*^9, 3.643894698669454*^9}, {3.6438951966837063`*^9, 
   3.643895323073731*^9}, {3.644326017883458*^9, 3.644326097383793*^9}, {
   3.644326190381095*^9, 3.644326238821536*^9}, {3.644326732061511*^9, 
   3.644326750809289*^9}, 3.6449351877283993`*^9, {3.6454069814807177`*^9, 
   3.645406981989203*^9}, {3.645407075680522*^9, 3.64540708226475*^9}, 
   3.6454531690675*^9, {3.6454676478869467`*^9, 3.645467653113846*^9}, {
   3.645529883818831*^9, 3.64552989794005*^9}, {3.647948278793269*^9, 
   3.647948337234552*^9}, {3.64794865785443*^9, 3.6479488409026012`*^9}, {
   3.6479488712021627`*^9, 3.6479489811118603`*^9}, {3.647949078496838*^9, 
   3.647949079939344*^9}, {3.647949184418244*^9, 3.6479491866204147`*^9}, {
   3.64794923210362*^9, 3.647949237272542*^9}, {3.6479493108245783`*^9, 
   3.647949314593438*^9}, {3.647949439274605*^9, 3.647949456674122*^9}, {
   3.647950324649419*^9, 3.647950357402953*^9}, {3.647950403748186*^9, 
   3.647950405664795*^9}, {3.647950437497005*^9, 3.647950440311348*^9}, {
   3.647965889334614*^9, 3.647965894794099*^9}, {3.650457249996821*^9, 
   3.650457274702984*^9}, {3.6504573189726543`*^9, 3.650457391945971*^9}, 
   3.650631399375846*^9, {3.6506314419870977`*^9, 3.650631568062934*^9}, {
   3.650631612899755*^9, 3.6506316150426893`*^9}, {3.650633378269815*^9, 
   3.65063344350736*^9}, {3.6512452574297333`*^9, 3.651245271607172*^9}, {
   3.651245616428947*^9, 3.6512456538555593`*^9}, {3.6521191699540358`*^9, 
   3.6521191884067802`*^9}, {3.654952600818811*^9, 3.65495264312214*^9}, {
   3.6549527281053057`*^9, 3.654952816281432*^9}, {3.654952859604619*^9, 
   3.654952937402054*^9}, {3.655041845031551*^9, 3.655041861760152*^9}, {
   3.655041900376232*^9, 3.655041901440926*^9}, {3.65504205215097*^9, 
   3.65504209921743*^9}, {3.655042149521209*^9, 3.6550422009057302`*^9}, {
   3.655042237957081*^9, 3.655042267352784*^9}, {3.655042357827038*^9, 
   3.655042378379797*^9}, {3.656078097665401*^9, 3.656078120379258*^9}, {
   3.656078184447843*^9, 3.656078206689126*^9}, {3.657842773950674*^9, 
   3.657842776845438*^9}, 3.6578438862979527`*^9, 3.6603253803409843`*^9, {
   3.662734302234577*^9, 3.662734333522685*^9}, {3.6627343859993353`*^9, 
   3.6627345369030724`*^9}, 3.6627366935985823`*^9, {3.662772235730317*^9, 
   3.662772252507856*^9}, {3.6627723480443583`*^9, 3.662772356125592*^9}, 
   3.662822089956305*^9, 3.66282425221843*^9, {3.662824294792284*^9, 
   3.662824301920125*^9}, {3.6628245659689407`*^9, 3.66282456668716*^9}, {
   3.662824652628875*^9, 3.662824700029813*^9}, {3.662824740597875*^9, 
   3.662824890075129*^9}, 3.662825321056199*^9, {3.6628253558755083`*^9, 
   3.662825421048181*^9}}],

Cell["Miscellaneous routines", "Text",
 CellChangeTimes->{{3.5802118634092283`*^9, 3.5802118743990707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"moveOut", "[", "term_", "]"}], " ", "and", " ", 
    RowBox[{"moveIn", "[", "term_", "]"}], " ", "are", " ", "examples", " ", 
    "of", " ", "moving", " ", "term_", " ", "outside", " ", "and", " ", 
    "inside", " ", 
    RowBox[{"op", "[", 
     RowBox[{
      RowBox[{"_", " ", "term_"}], ",", "_"}], "]"}], " ", 
    RowBox[{"DOESN", "'"}], "T", " ", "match", " ", 
    RowBox[{
     RowBox[{"NumberQ", "[", "_", "]"}], "."}], "  ", "*", "14", "Mar2014"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"moveOut", "[", "term_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"op", ":", 
         RowBox[{"xProduct", "|", "xSum"}]}], ")"}], "[", 
       RowBox[{
        RowBox[{"a_", "  ", "b_"}], ",", "i_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"op", "[", 
         RowBox[{"b", ",", "i"}], "]"}]}], "/;", 
       RowBox[{"ListMemberQ", "[", 
        RowBox[{"a", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "#"}], "&"}], "/@", 
             RowBox[{"{", "term", "}"}]}]}], "}"}], "]"}]}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveIn", "[", "term_", "]"}], ":=", 
     RowBox[{
      RowBox[{"a_", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"op", ":", 
          RowBox[{"xProduct", "|", "xSum"}]}], ")"}], "[", 
        RowBox[{"b_", ",", "i_"}], "]"}]}], ":>", 
      RowBox[{
       RowBox[{"op", "[", 
        RowBox[{
         RowBox[{"a", " ", "b"}], ",", "i"}], "]"}], "/;", 
       RowBox[{"ListMemberQ", "[", 
        RowBox[{"a", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "#"}], "&"}], "/@", 
             RowBox[{"{", "term", "}"}]}]}], "}"}], "]"}]}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"independentOf", "[", "pattern_List", "]"}], "[", "exp_", "]"}],
      " ", "Removes", " ", "elements", " ", "dependent", " ", "of", " ", 
     "pattern_List", " ", "in", " ", "the", " ", "FreeQ", " ", 
     RowBox[{"sense", "."}], "*", "3", "Mar2013"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"independentOf", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<independentOf[pattern_List][exp_] removes elements dependent on \
pattern_List in the FreeQ sense. *3Mar2013*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"independentOf", "[", "pattern_List", "]"}], "[", "exp_", "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "tmp", ",", "TF"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"Head", "[", "exp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"head", " ", "=!=", " ", "Symbol"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "exp"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"#", ",", "pattern"}], "]"}], "&"}], ",", "tmp"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"TF", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], ",", 
                 RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "TF", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"TF", ",", "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"tmp", ",", "TF"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "TF", "]"}], ">", "0"}], ",", 
             RowBox[{"Apply", "[", 
              RowBox[{"head", ",", "TF"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"head", " ", "===", "Plus"}], ",", "0", ",", "1"}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListFreeQ", "[", 
             RowBox[{"exp", ",", "pattern"}], "]"}], ",", "exp", ",", "1"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dependentOn", "[", "pattern_List", "]"}], "[", "exp_", "]"}], 
     " ", "Removes", " ", "Level", " ", "0", " ", "terms", " ", "that", " ", 
     "are", " ", "independent", " ", 
     RowBox[{"(", 
      RowBox[{"in", " ", "the", " ", "FreeQ", " ", "sense"}], ")"}], " ", 
     "of", " ", "elements", " ", "in", " ", 
     RowBox[{"pattern_List", "."}], " ", "*", "3", "Mar2013"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dependentOn", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<dependentOn[pattern_List][exp_] removes elements independent of \
pattern_List in the FreeQ sense. *3Mar2013*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"dependentOn", "[", "pattern_List", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "tmp", ",", "TF"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"Head", "[", "exp", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"head", " ", "=!=", " ", "Symbol"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "exp"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ListFreeQ", "[", 
                RowBox[{"#", ",", "pattern"}], "]"}], "&"}], ",", "tmp"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"TF", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", 
                 RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "TF", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"TF", ",", "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"TF", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"tmp", ",", "TF"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "TF", "]"}], ">", "0"}], ",", 
             RowBox[{"Apply", "[", 
              RowBox[{"head", ",", "TF"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"head", " ", "===", "Plus"}], ",", "0", ",", "1"}], 
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListFreeQ", "[", 
             RowBox[{"exp", ",", "pattern"}], "]"}], ",", "1", ",", "exp"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuSumSimplify", "::", "usage"}], "=", 
     "\"\<tuSumSimplify[independent_List][exp_] move terms within xSum[] of \
exp_ independent of dependent_List to outside xSum[].  *20Oct2013*\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuSumSimplify", "[", 
       RowBox[{"independent_List:", 
        RowBox[{"{", "}"}]}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "//", "DistributeSum"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"a_", " ", "c___"}], ",", "b__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"a", "  ", 
             RowBox[{"xSum", "[", 
              RowBox[{
               RowBox[{"Times", "[", "c", "]"}], ",", "b"}], "]"}]}], "/;", 
            RowBox[{"NumericQ", "[", "a", "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xSum", "[", 
            RowBox[{"0", ",", "b__"}], "]"}], "->", "0"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xSum", "[", 
            RowBox[{"a_", ",", "b__"}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dependentOn", "[", "independent", "]"}], "[", "a", 
             "]"}], 
            RowBox[{"xSum", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"independentOf", "[", "independent", "]"}], "[", "a", 
               "]"}], ",", "b"}], "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"simpleSum", "[", "independent_List", "]"}], ":=", 
     RowBox[{"tuSumSimplify", "[", "independent", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Distribute", " ", "xSum", " ", "over", " ", 
     RowBox[{"ExpandAll", "[", "sumand", "]"}], " ", "of", " ", 
     RowBox[{
      RowBox[{"Sum", "[", "]"}], ".", "  ", "Returns"}], " ", 
     RowBox[{
      RowBox[{"xSum", "[", "]"}], ".", " ", "\[IndentingNewLine]", "3.1"}], 
     ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DistributeSum", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"tmp1", "=", "NULL"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"Sum", "->", "xSum"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<DistributeSum: \>\"", ",", "tmp"}], "]"}]}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "c__"}], "]"}], ":>", 
              RowBox[{"xSum", "[", 
               RowBox[{
                RowBox[{"ExpandAll", "[", "a", "]"}], ",", "c"}], "]"}]}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xSum", "[", 
                   RowBox[{"#", ",", "b"}], "]"}], "&"}], ",", "a"}], "]"}], "/;", 
               RowBox[{
                RowBox[{"Head", "[", "a", "]"}], "===", "Plus"}]}]}]}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuDistributeOp", "::", "usage"}], "=", 
     "\"\<tuDistributeOp[Op_,func_:Plus][exp_] applies \
Distribute[Op_[],func_] on every Pattern matched by Op_[__]. \
EG:DistributeOp[IntegralOp[_,_]][IntegralOp[{{x}},a+b]]->IntegralOp[{{x}},a]+\
IntegralOp[{{x}},b] *29Jan2014*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuDistributeOp", "[", 
       RowBox[{"Op_", ",", 
        RowBox[{"func_:", "Plus"}]}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "pos", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"tmp", ",", "Op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
           RowBox[{"Distribute", "[", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "func"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ReplacePartTU", "[", 
         RowBox[{"tmp", ",", "pos"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DistributeOp", "[", "Op_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{"tuDistributeOp", "[", "Op", "]"}], "[", "exp", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ThreadOp", "[", "Op_", "]"}], "[", "exp_", "]"}], " ", 
     "applies", " ", "Thread", " ", "on", " ", "pattern", " ", 
     RowBox[{"Op_", "[", "_", "]"}], " ", "in", " ", "exp_.", "  ", 
     "Accomodates", " ", "variation", " ", "for", " ", 
     RowBox[{"IntegralOp", ".", " ", "Must"}], " ", "indicate", " ", 
     "arguements", " ", "as", " ", 
     RowBox[{
      RowBox[{"Op_", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "."}], " ", "*", "5", "Sep2014"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ThreadOp", "[", "Op_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", 
          RowBox[{"{", "exp", "}"}]}], ",", "pos", ",", "i", ",", "xInt", ",",
          "xOp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"tmp", ",", "Op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xOp", "=", "Op"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "Op", "]"}], "===", "IntegralOp"}], ",", 
          RowBox[{
           RowBox[{"pos", "=", 
            RowBox[{"pos", "/.", 
             RowBox[{
              RowBox[{"IntegralOp", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"xInt", "[", "a", "]"}], "[", "b", "]"}]}]}]}], ";", 
           RowBox[{"xOp", "=", 
            RowBox[{
             RowBox[{"xInt", "[", "_", "]"}], "[", "_", "]"}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "pos", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "//.", 
             RowBox[{
              RowBox[{"ii", ":", "xOp"}], "\[RuleDelayed]", 
              RowBox[{"Thread", "[", "ii", "]"}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "Op", "]"}], "===", "IntegralOp"}], ",", 
          RowBox[{"pos", "=", 
           RowBox[{"pos", "/.", 
            RowBox[{
             RowBox[{
              RowBox[{"xInt", "[", "a_", "]"}], "[", "b_", "]"}], "->", 
             RowBox[{"IntegralOp", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ReplacePartTU", "[", 
          RowBox[{"tmp", ",", "pos"}], "]"}], "//", "First"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuArgSimplify", "::", "usage"}], "=", 
     "\"\<tuArgSimplify[OP_,constants_List][exp_] simplifies arg_ in \
OP_[arg_] functional expressions in exp_ by first DistributeOp[OP_][exp_] and \
removing constants_List and NumericQ[] elements in arg_ outside of OP_.  OP_ \
must be specified as fn[_].\[IndentingNewLine]Usage:  xOp[f+g,c+d \
e]//simpleOp[xOp[__],{d}] -> \[IndentingNewLine]{xOp[f,c]+d \
xOp[f,e]+xOp[g,c]+d xOp[g,e]}   *2Jul2014*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuArgSimplify", "[", 
       RowBox[{"OP_", ",", 
        RowBox[{"constants_List:", 
         RowBox[{"{", "}"}]}]}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"headOp", "=", 
          RowBox[{"Head", "[", "OP", "]"}]}], ",", "xop", ",", "sub", ",", 
         "one"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{"tuOpDistribute", "[", "OP", "]"}]}]}], ";", 
        RowBox[{"xPrint", "[", 
         RowBox[{"tmp", ",", "\"\<:\>\"", ",", "headOp"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"headOp", "->", "xop"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Op", " ", "with", " ", "multiple", " ", "arguements"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"xop", "[", 
           RowBox[{"b1___", ",", 
            RowBox[{
             SuperscriptBox["c_", 
              RowBox[{"n_:", "1"}]], "  ", "a_"}], ",", "b___"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"xop", "[", 
             RowBox[{"b1", ",", "a", ",", "b"}], "]"}]}], "/;", 
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"c", ",", "constants"}], "]"}], "||", 
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"c", ",", "constants"}], "]"}], "||", 
            RowBox[{"NumericQ", "[", "c", "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Op", " ", "with", " ", "multiple", " ", "arguements", " ", "but", 
          " ", "single", " ", "arguement", " ", "as", " ", "constant"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"xop", "[", 
           RowBox[{"b1___", ",", 
            SuperscriptBox["c_", 
             RowBox[{"n_:", "1"}]], " ", ",", "b___"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"xop", "[", 
             RowBox[{"b1", ",", "1", ",", "b"}], "]"}]}], "/;", 
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"c", ",", "constants"}], "]"}], "||", 
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"c", ",", "constants"}], "]"}], "||", 
            RowBox[{"NumericQ", "[", "c", "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Op", " ", "with", " ", "single", " ", "arguement"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{
          RowBox[{"xop", "[", 
           SuperscriptBox["c_", 
            RowBox[{"n_:", "1"}]], "]"}], "\[RuleDelayed]", 
          RowBox[{"c", "/;", 
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"c", ",", "constants"}], "]"}], "||", 
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"c", ",", "constants"}], "]"}], "||", 
            RowBox[{"NumericQ", "[", "c", "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", "sub"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"xop", "->", "headOp"}]}]}], ";", 
        RowBox[{"xPrint", "[", "tmp", "]"}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"simpleOp", "[", 
       RowBox[{"OP_", ",", 
        RowBox[{"constants_List:", 
         RowBox[{"{", "}"}]}]}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{"tuArgSimplify", "[", 
       RowBox[{"OP", ",", "constants"}], "]"}], "[", "exp", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuSimpleOp", "[", 
       RowBox[{"OP_", ",", 
        RowBox[{"constants_List:", 
         RowBox[{"{", "}"}]}]}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{"tuArgSimplify", "[", 
       RowBox[{"OP", ",", "constants"}], "]"}], "[", "exp", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Adds", " ", "columns", " ", "of", " ", "tablex_", " ", "to", " ", "the", 
     " ", "right", " ", "of", " ", 
     RowBox[{"table", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TableAddColumn", "[", "table_", "]"}], "[", "tablex_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"head", "=", 
          RowBox[{"table", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"tmp", "=", "table"}], ",", "pattern", ",", "row", ",", 
         RowBox[{"mname", "=", "\"\<TableAddColumn\>\""}], ",", 
         RowBox[{"DEBUG", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Join", ",", 
           RowBox[{"{", 
            RowBox[{"tmp", ",", "tablex"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuReplacePart", "::", "usage"}], "=", 
     "\"\<tuReplacePart[exp_,pos_List] like ReplacePart[] except replaces \
whole exp_ when pos contains {{}->replacement} in which case ReplacePart does \
nothing. *5Sep2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuReplacePart", "[", 
      RowBox[{"exp_", ",", "pos_List"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "$", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"(", 
            RowBox[{"$", "=", 
             RowBox[{
              RowBox[{"tuRuleSelect", "[", "pos", "]"}], "[", 
              RowBox[{"{", "}"}], "]"}]}], ")"}], "]"}], ">", "0"}], ",", 
         RowBox[{"$", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"ReplacePart", "[", 
          RowBox[{"exp", ",", "pos"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePartTU", "[", 
      RowBox[{"exp_", ",", "pos_List"}], "]"}], ":=", 
     RowBox[{"tuReplacePart", "[", 
      RowBox[{"exp", ",", "pos"}], "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuFreeQ", "::", "usage"}], "=", 
     "\"\<tuFreeQ[exp_,items_] tests exp_ as FreeQ of all items in \
items_List. *18Jun2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuFreeQ", "[", 
      RowBox[{"exp_", ",", "items_"}], "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"And", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"exp", ",", "#"}], "]"}], "&"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "items", "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListFreeQ", "[", 
      RowBox[{"exp_", ",", "items_List"}], "]"}], ":=", 
     RowBox[{"tuFreeQ", "[", 
      RowBox[{"exp", ",", "items"}], "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuHasAnyQ", "::", "usage"}], "=", 
     "\"\<tuHasAnyQ[exp_,items_List] returns True if exp_ has any item in \
items_List. *18Jul2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuHasAnyQ", "[", 
      RowBox[{"exp_", ",", "items_"}], "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"exp", ",", "#"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "items", "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuHasAllQ", "::", "usage"}], "=", 
     "\"\<tuHasAllQ[exp_,items_List] returns True if exp_ has all items in \
items_List. *18Jul2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuHasAllQ", "[", 
      RowBox[{"exp_", ",", "items_"}], "]"}], ":=", 
     RowBox[{"Apply", "[", 
      RowBox[{"And", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"exp", ",", "#"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "items", "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuHasNoneQ", "::", "usage"}], "=", 
     "\"\<tuHasNoneQ[exp_,items_List] returns True if exp_ has none of the \
items in items_List. *18Jul2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuHasNoneQ", "[", 
      RowBox[{"exp_", ",", "items_"}], "]"}], ":=", 
     RowBox[{"Not", "[", 
      RowBox[{"tuHasAnyQ", "[", 
       RowBox[{"exp", ",", "items"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuProductQ", "::", "usage"}], "=", 
     "\"\<tuProductQ[exp_] returns True if exp_ is a product(Times,xTimes) of \
simple variables. *8Aug2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuProductQ", "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tuHasNoneQ", "[", 
            RowBox[{"exp", ",", 
             RowBox[{"{", "Plus", "}"}]}], "]"}], ",", 
           RowBox[{"tuHasAnyQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "exp", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Times", ",", "xTimes"}], "}"}]}], "]"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"tuMemberQ", "::", "usage"}], "=", 
     "\"\<tuMemberQ[variable_,patterns_List] True if variable_ matches any in \
patterns_List. *16May2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuMemberQ", "[", 
      RowBox[{"variable_", ",", "patterns_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", "variable", "}"}], "]"}], ",", "#"}], "]"}], "&"}], 
         ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "patterns", "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListMemberQ", "[", 
      RowBox[{"variable_", ",", "patterns_List"}], "]"}], ":=", 
     RowBox[{"tuMemberQ", "[", 
      RowBox[{"variable", ",", "patterns"}], "]"}]}], ";"}], 
   RowBox[{"(*", "Compatibility", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allMemberQ", "[", 
      RowBox[{"variables_", ",", "patterns_List"}], "]"}], " ", "True", " ", 
     "if", " ", "all", " ", "variables_", " ", "match", " ", "any", " ", "in",
      " ", 
     RowBox[{"patterns_List", "."}], "  ", "*", "16", "Aug2013"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"allMemberQ", "[", 
      RowBox[{"variables_", ",", "patterns_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ListMemberQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Flatten", "[", "patterns", "]"}]}], "]"}], "&"}], ",", 
           
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "variables", "}"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", "tmp"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"allMemberQ", "::", "usage"}], "=", 
     "\"\<allMemberQ[variables_,patterns_List] True if all variables_  match \
any in patterns_List.\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"combineElements", "[", 
       RowBox[{"elements_List", ",", "to_"}], "]"}], "[", "exp_List", "]"}], 
     " ", "replaces", " ", "elements_List", " ", "items", " ", "of", " ", 
     "exp_List", " ", "and", " ", 
     RowBox[{"Append", "[", "]"}], "s", " ", "to_.", "  ", "*", "22", 
     "Nov2014"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"combineElements", "[", 
       RowBox[{"elements_List", ",", "to_"}], "]"}], "[", "exp_List", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"elements", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"tmp", ",", "to"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"gatherLog", "[", "exp_", "]"}], " ", "gathers", " ", "first", 
      " ", "level", " ", "sums", " ", "of", " ", "Logs"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "a"}], " ", 
        RowBox[{"Log", "[", "b", "]"}]}], "+", 
       RowBox[{"c", " ", 
        RowBox[{"Log", "[", "d", "]"}]}]}], "\[Rule]", 
      RowBox[{"Log", "[", 
       RowBox[{
        SuperscriptBox["b", "a"], 
        SuperscriptBox["d", "b"]}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"gatherLog", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<gatherLog:\>\"", ",", "tmp"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"a_", " ", 
            RowBox[{"Log", "[", "b_", "]"}]}], "->", 
           RowBox[{"Log", "[", 
            SuperscriptBox["b", "a"], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", "a_", "]"}], "+", 
            RowBox[{"Log", "[", "b_", "]"}]}], "->", 
           RowBox[{"Log", "[", 
            RowBox[{"a", " ", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gatherSqrt", "[", "exp_", "]"}], " ", "Gathers", " ", 
     "multiplied", " ", 
     RowBox[{
      SqrtBox["_"], "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gatherSqrt", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{
            SqrtBox["a_"], 
            SqrtBox["b_"]}], "->", 
           SqrtBox[
            RowBox[{"a", " ", "b"}]]}]}]}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuVarGather", "::", "usage"}], "=", 
     "\"\<tuVarGather[var_,op_:dotOps] Rules[] for gathering var_ at end of \
op_ terms distributed over Plus expressions. *9Feb2016*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuVarGather", "[", 
      RowBox[{"var_", ",", 
       RowBox[{"op_:", "dotOps"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"oo", ":", "op"}], ")"}], "[", 
          RowBox[{"b_", ",", "var"}], "]"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sign_:", "1"}], ")"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"oo", ":", "op"}], ")"}], "[", 
           RowBox[{"c_", ",", "var"}], "]"}]}]}], "\[Rule]", 
        RowBox[{"oo", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "+", 
            RowBox[{"sign", " ", "c"}]}], ")"}], ",", "var"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"oo", ":", "op"}], ")"}], "[", 
          RowBox[{"var", ",", "b_"}], "]"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sign_:", "1"}], ")"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"oo", ":", "op"}], ")"}], "[", 
           RowBox[{"var", ",", "  ", "c_"}], "]"}]}]}], "\[Rule]", 
        RowBox[{"oo", "[", 
         RowBox[{"var", ",", 
          RowBox[{"(", 
           RowBox[{"b", "+", 
            RowBox[{"sign", " ", "c"}]}], ")"}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuSeries", "::", "usage"}], "=", 
     "\"\<tuSeries[f_,var_List] generates symbolic Series expansion of f_ \
given var_ parameters of Series[] function *1Nov2015*\>\""}], ";", 
    RowBox[{
     RowBox[{"tuSeries", "[", 
      RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "dif"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"f", "/.", 
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{"var", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"dif", "=", 
         RowBox[{"tuDPartial", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"var", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"dif", "/.", 
                RowBox[{
                 RowBox[{"var", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "->", 
                 RowBox[{"var", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"var", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"var", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", 
                RowBox[{"(", "i", ")"}]}], "/", 
               RowBox[{"i", "!"}]}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dif", "=", 
            RowBox[{"tuDPartial", "[", 
             RowBox[{"dif", ",", 
              RowBox[{"var", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"var", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"xSeries", "[", 
       RowBox[{"f_", ",", "var_List"}], "]"}], " ", "produces", " ", "a", " ",
       "symbolic", " ", "Series", " ", "expansion", " ", "of", " ", "f_.", "  ",
       "var_List", " ", "is", " ", "the", " ", "variable", " ", "arguement", 
      " ", "as", " ", "in", " ", 
      RowBox[{"Series", ".", "\[IndentingNewLine]", 
       RowBox[{"EG", ":", " ", 
        RowBox[{"xSeries", "[", 
         RowBox[{
          RowBox[{"f", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}]}], " ", "->",
      " ", 
     RowBox[{
      RowBox[{"xLimit", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "x", "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\"\<\[PartialD]\>\"", "_"], "x"], "[", 
            RowBox[{"f", "[", "x", "]"}], "]"}],
           $CellContext`xPartialD[
            $CellContext`f[$CellContext`x], $CellContext`x],
           Editable->False,
           SyntaxForm->Automatic]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", 
          InterpretationBox[
           RowBox[{
            SubscriptBox[
             UnderscriptBox["\"\<\[PartialD]\>\"", "_"], "x"], "[", 
            InterpretationBox[
             RowBox[{
              SubscriptBox[
               UnderscriptBox["\"\<\[PartialD]\>\"", "_"], "x"], "[", 
              RowBox[{"f", "[", "x", "]"}], "]"}],
             $CellContext`xPartialD[
              $CellContext`f[$CellContext`x], $CellContext`x],
             Editable->False,
             SyntaxForm->Automatic], "]"}],
           $CellContext`xPartialD[
            $CellContext`xPartialD[
             $CellContext`f[$CellContext`x], $CellContext`x], $CellContext`x],
           
           Editable->False,
           SyntaxForm->Automatic]}]}], ",", 
        RowBox[{"x", "\[Rule]", "1"}]}], "]"}], "\[IndentingNewLine]", "*", 
      "28", "Jul2014"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xSeries", "[", 
      RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "dif"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", "f"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dif", "=", 
         RowBox[{"xPartialD", "[", 
          RowBox[{"tmp", ",", 
           RowBox[{"var", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "+", 
             RowBox[{"dif", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"var", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"var", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", 
                RowBox[{"(", "i", ")"}]}], "/", 
               RowBox[{"i", "!"}]}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dif", "=", 
            RowBox[{"xPartialD", "[", 
             RowBox[{"dif", ",", 
              RowBox[{"var", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"var", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xLimit", "[", 
         RowBox[{"tmp", ",", 
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{"var", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Generates", " ", "a", " ", "Series", " ", "to", " ", "order_", " ", "in",
      " ", "pattern_", " ", "from", " ", "exp_.", " ", "NOT", " ", 
     RowBox[{"USED", "?"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeriesByPattern", "[", 
      RowBox[{"exp_", ",", "pattern_", ",", "order_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "tmp", ",", "xpos", ",", "XXXX", ",", 
         RowBox[{"DEBUG", "=", "0"}], ",", 
         RowBox[{"mname", "=", "\"\<SeriesPattern\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"ExtractPositionPattern", "[", 
          RowBox[{"exp", ",", "pattern"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"exp", ",", "pattern", ",", "pos"}], "}"}], ",", 
          "\"\<{exp,pattern,pos}\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xpos", "=", 
         RowBox[{"pos", "/.", 
          RowBox[{"pattern", "\[Rule]", "XXXX"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"exp", ",", "xpos"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"xpos", ",", "tmp"}], "}"}], ",", "\"\<{xpos,tmp}\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"tmp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"XXXX", ",", "0", ",", "order"}], "}"}]}], "]"}], "//", 
          "Normal"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfDEBUG", "[", 
         RowBox[{"mname", ",", 
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"{", "tmp", "}"}], ",", "\"\<{tmp}\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"XXXX", "\[Rule]", 
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tuSeriesApproximation", "[", 
      RowBox[{"exp_", ",", "varOrder_List", ",", "pattern_List"}], "]"}], " ",
      "generates", " ", "a", " ", "Rule", " ", "that", " ", "is", " ", "a", 
     " ", 
     RowBox[{"Series", "[", "]"}], " ", "approximation", " ", "to", " ", 
     "exp_.", "  ", "varOrder_List", " ", "is", " ", "the", " ", "same", " ", 
     "as", " ", 
     RowBox[{"Series", "[", "]"}], " ", "variable", " ", "arguement", " ", 
     "and", " ", "pattern_List", " ", "specifies", " ", "labels", " ", "to", 
     " ", "turn", " ", "into", " ", "Patterns", " ", "on", " ", "the", " ", 
     RowBox[{"LHS", "."}], " ", "*", "19", "Dec2014"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tuSeriesApproximation", "[", 
     RowBox[{"exp_", ",", "varOrder_List", ",", "pattern_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"exp", "->", 
       RowBox[{"Series", "[", 
        RowBox[{"exp", ",", "varOrder"}], "]"}]}], "//", "Normal"}], "//", 
     RowBox[{"RulesVarPattern", "[", "pattern", "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "tuRepeat", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tuRepeat", "::", "usage"}], "=", 
    "\"\<tuRepeat[rules_List:{},operations_:{}][exp_] applies rules_List and \
operations_ (may be List) repeatedly until exp_ does not change. \
*22Feb2016*\>\""}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuRepeat", "[", 
       RowBox[{
        RowBox[{"rules_List:", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"operations_:", 
         RowBox[{"{", "}"}]}]}], "]"}], "[", "exp_", "]"}], ":=", " ", 
     RowBox[{"Block", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$IterationLimit", "=", "20"}], ",", "xrule", ",", "xop", 
         ",", 
         RowBox[{"tmp", "=", "exp"}], ",", "tmp0", ",", 
         RowBox[{"icnt", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xrule", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "rules", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xop", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "operations", "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xPrint", "[", 
         RowBox[{"xrule", ",", "xop", ",", "$IterationLimit"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp0", "=!=", "tmp"}], ",", 
          RowBox[{
           RowBox[{"tmp0", "=", "tmp"}], ";", 
           RowBox[{"xPrint", "[", 
            RowBox[{"icnt", ",", "tmp"}], "]"}], ";", 
           RowBox[{"icnt", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xop", "=!=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"tmp", "=", 
              RowBox[{"Fold", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#2", " ", "[", "#1", "]"}], "&"}], ",", "tmp", ",", 
                "xop"}], "]"}]}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xrule", "=!=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"tmp", "=", 
              RowBox[{"Fold", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ReplaceRepeated", "[", 
                  RowBox[{"#1", ",", "#2", ",", 
                   RowBox[{"MaxIterations", "\[Rule]", "100"}]}], "]"}], 
                 "&"}], ",", "tmp", ",", "xrule"}], "]"}]}]}], "]"}], ";", 
           RowBox[{"(*", 
            RowBox[{
            "Position", " ", "of", " ", "this", " ", "statement", " ", 
             "affects", " ", 
             RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"xPrint", "[", 
            RowBox[{"operation", "=!=", "Null"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"icnt", ">", "$IterationLimit"}], ",", 
             RowBox[{"Return", "[", "tmp", "]"}]}], "]"}], ";", 
           RowBox[{"xPrint", "[", "$IterationLimit", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "tuAppendUniq", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuAppendUniq", "::", "usage"}], "=", 
     "\"\<tuAppendUniq[item_][list_] combines item_ and list_, Flatten, and \
DeleteDuplicates\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuAppendUniq", "[", "item_", "]"}], "[", "list_", "]"}], ":=", 
     
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "$", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"{", "list", "}"}], ",", 
            RowBox[{"{", "item", "}"}]}], "]"}], "//", "Flatten"}], "//", 
         "DeleteDuplicates"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "tuProductExpand", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuProductExpand", "::", "usage"}], "=", 
     "\"\<tuProductExpand[op_:Times][exp_] expands Product|xProduct \
operations in exp_ with op_ as product operator. This routine needs Numerical \
range of productOp[_,{i,9}]. *30Oct2015*\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuProductExpand", "[", 
       RowBox[{"op_:", "Times"}], "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$", "=", "exp"}], ",", 
         RowBox[{"productOp", "=", 
          RowBox[{"Product", "|", "xProduct"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$", "=", 
        RowBox[{"$", "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pp", ":", "productOp"}], ")"}], "[", 
           RowBox[{"a_", ",", "b__"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"op", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tuTermSelect", "::", "usage"}], "=", 
     "\"\<tuTermSelect[patterns_][exp_] extracts terms which match all \
patterns_(List) in a Plus expression *7Mar2016*\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tuTermSelect", "[", "patterns_", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$", ",", "$s"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$", "=", 
         RowBox[{"Inactivate", "[", 
          RowBox[{
           RowBox[{"Expand", "[", "exp", "]"}], ",", "Plus"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"$", "//", 
            RowBox[{"tuExtractPattern", "[", 
             RowBox[{
              RowBox[{"Inactive", "[", "Plus", "]"}], "[", "__", "]"}], 
             "]"}]}], "//", "First"}], "//", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"Inactive", "[", "Plus", "]"}], "\[Rule]", "List"}]}], 
            "&"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"$", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"$", ",", 
           RowBox[{
            RowBox[{"tuHasAllQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "patterns", "}"}], "]"}]}], "]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "$"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527879933930221*^9, 3.527880068966152*^9}, 
   3.555432637545333*^9, 3.5554327862608147`*^9, {3.555778199064436*^9, 
   3.555778200178644*^9}, {3.5557782330147963`*^9, 3.5557782677040253`*^9}, {
   3.56440458999321*^9, 3.564404592220203*^9}, 3.5644052361899147`*^9, {
   3.564405290952738*^9, 3.564405301267617*^9}, {3.564405368812229*^9, 
   3.5644054364898977`*^9}, {3.5644056110684757`*^9, 3.564405738816188*^9}, {
   3.5644063471465263`*^9, 3.564406375009626*^9}, 3.564413775437436*^9, {
   3.564841215338243*^9, 3.564841267301989*^9}, {3.5648412981148167`*^9, 
   3.564841302408098*^9}, {3.564841438400856*^9, 3.564841454162277*^9}, {
   3.5648426536876574`*^9, 3.56484266204705*^9}, 3.564844474848049*^9, {
   3.566825760129705*^9, 3.566825774453374*^9}, {3.5701054282640123`*^9, 
   3.570105511224777*^9}, {3.570202732481195*^9, 3.570202743935644*^9}, {
   3.5702029982641487`*^9, 3.5702030026177*^9}, {3.570204924170664*^9, 
   3.5702049338485527`*^9}, {3.5708421697737226`*^9, 3.570842185370248*^9}, {
   3.5708422324014683`*^9, 3.5708422443157473`*^9}, {3.570842287793892*^9, 
   3.570842350294593*^9}, {3.5708423959710903`*^9, 3.5708424294855747`*^9}, {
   3.570842479854141*^9, 3.570842487957382*^9}, {3.570842537170766*^9, 
   3.570842558091651*^9}, {3.5708425881073627`*^9, 3.5708426875465117`*^9}, {
   3.570842743911915*^9, 3.570842760098878*^9}, {3.5708428150620337`*^9, 
   3.57084283337428*^9}, {3.571232025341181*^9, 3.5712320602579823`*^9}, {
   3.571232217102319*^9, 3.571232287814302*^9}, {3.571423438946911*^9, 
   3.571423447071764*^9}, {3.571423784852826*^9, 3.57142390202459*^9}, {
   3.580211541277926*^9, 3.580211548090016*^9}, {3.5802116650011272`*^9, 
   3.580211670178278*^9}, {3.580211715859536*^9, 3.580211717215892*^9}, {
   3.5802117834097967`*^9, 3.580211806362259*^9}, {3.5802118558881693`*^9, 
   3.58021189967804*^9}, {3.580211930414728*^9, 3.580212284412571*^9}, {
   3.5802135309174223`*^9, 3.580213534365768*^9}, {3.5802335866383533`*^9, 
   3.580233628489005*^9}, {3.5829807049019537`*^9, 3.5829807121385202`*^9}, {
   3.582981898748951*^9, 3.5829820384996347`*^9}, {3.58298206872677*^9, 
   3.582982185360135*^9}, {3.58565821277713*^9, 3.585658212977916*^9}, {
   3.585658251871573*^9, 3.585658279453375*^9}, {3.58565834533449*^9, 
   3.585658374721217*^9}, {3.58566055667787*^9, 3.585660653692313*^9}, {
   3.585661887045719*^9, 3.5856619525743723`*^9}, {3.585662044225088*^9, 
   3.585662102933323*^9}, {3.59120299997685*^9, 3.591203115708847*^9}, {
   3.591278590819491*^9, 3.591278670599165*^9}, {3.591279697703107*^9, 
   3.591279800984848*^9}, {3.591279858024741*^9, 3.591279878082447*^9}, {
   3.5912799489576063`*^9, 3.591280044124282*^9}, {3.593010582310853*^9, 
   3.593010601044311*^9}, 3.5931414043509817`*^9, {3.5950446038296843`*^9, 
   3.5950448226006308`*^9}, {3.600094550801159*^9, 3.6000946256273623`*^9}, {
   3.600096438474016*^9, 3.600096482229713*^9}, {3.602345199449703*^9, 
   3.602345223163172*^9}, {3.603817807285123*^9, 3.603817807480733*^9}, {
   3.603886403321327*^9, 3.603886417416297*^9}, {3.603886474800292*^9, 
   3.603886532434333*^9}, {3.60388764981877*^9, 3.6038876673243847`*^9}, {
   3.6096837393445873`*^9, 3.609683752030311*^9}, {3.609683804660714*^9, 
   3.609683947540859*^9}, 3.613307769332349*^9, {3.613307809994637*^9, 
   3.613307935261343*^9}, {3.613307967537713*^9, 3.6133080252685013`*^9}, {
   3.6155581341655893`*^9, 3.615558158073098*^9}, {3.615558211235733*^9, 
   3.615558257720517*^9}, {3.6155744368064623`*^9, 3.6155744380350313`*^9}, {
   3.615576258793644*^9, 3.615576270279748*^9}, {3.616085517140748*^9, 
   3.616085519322427*^9}, {3.6191438139875393`*^9, 3.6191438840274878`*^9}, {
   3.619144223085476*^9, 3.619144260133009*^9}, {3.6191448270362597`*^9, 
   3.619144827246003*^9}, {3.6191448609556923`*^9, 3.619144870237507*^9}, {
   3.619144935681817*^9, 3.619144937645482*^9}, {3.6255780507671347`*^9, 
   3.6255781840965843`*^9}, 3.625852095963048*^9, {3.6279123976449747`*^9, 
   3.6279123982317467`*^9}, {3.627912944255756*^9, 3.62791305394283*^9}, {
   3.6279998756746683`*^9, 3.628000043311988*^9}, {3.62800017526722*^9, 
   3.628000366776074*^9}, {3.629559915487645*^9, 3.62955992870536*^9}, {
   3.63110842818465*^9, 3.631108439295265*^9}, {3.632925121221159*^9, 
   3.632925141638592*^9}, 3.633439384850794*^9, {3.6334394235094767`*^9, 
   3.633439432415629*^9}, {3.633439466571362*^9, 3.633439639541924*^9}, {
   3.6372410381004963`*^9, 3.6372410733739843`*^9}, {3.637243799760573*^9, 
   3.637243802733708*^9}, {3.637436481512479*^9, 3.6374365258854427`*^9}, {
   3.637436632310753*^9, 3.637436657157812*^9}, {3.637436708296692*^9, 
   3.637436767613948*^9}, {3.638890791375991*^9, 3.638890844928903*^9}, {
   3.638890875831894*^9, 3.6388909261255713`*^9}, {3.640347630192172*^9, 
   3.640347634487526*^9}, {3.640430916892605*^9, 3.640431013792721*^9}, {
   3.640431676436893*^9, 3.6404317798077106`*^9}, {3.6407839041163673`*^9, 
   3.640784003028741*^9}, {3.6407840777988873`*^9, 3.640784081199806*^9}, {
   3.6407841561959667`*^9, 3.6407842104238787`*^9}, {3.640832429317177*^9, 
   3.640832438808951*^9}, {3.64087788976925*^9, 3.640878130564004*^9}, 
   3.640974800067192*^9, {3.641044091746071*^9, 3.641044092806292*^9}, {
   3.641044641990127*^9, 3.641044698644519*^9}, {3.6413000251113777`*^9, 
   3.641300026757949*^9}, 3.642603003372573*^9, 3.6435492945295267`*^9, {
   3.646570389878573*^9, 3.646570401744298*^9}, {3.647884023665497*^9, 
   3.647884084781734*^9}, {3.647958580574394*^9, 3.64795874119011*^9}, {
   3.6480484310278788`*^9, 3.648048459839655*^9}, {3.648048616960507*^9, 
   3.648048653843501*^9}, {3.648053943332271*^9, 3.648053987216301*^9}, {
   3.650457879880172*^9, 3.650457947168193*^9}, {3.6553409944586287`*^9, 
   3.6553409953786373`*^9}, {3.655389962037937*^9, 3.6553899647741213`*^9}, {
   3.659458618485629*^9, 3.659458621808147*^9}, 3.659458746526112*^9, 
   3.6635085773926897`*^9, 3.663509142925583*^9, {3.663509333721336*^9, 
   3.663509334661234*^9}, {3.664030808968391*^9, 3.66403084389316*^9}, {
   3.665245567398177*^9, 3.665245649430632*^9}, {3.665245700152726*^9, 
   3.665245727143971*^9}, {3.6652458741893787`*^9, 3.6652459763381977`*^9}, 
   3.665246136050848*^9, {3.66524619212749*^9, 3.665246217451016*^9}, {
   3.6652469863993397`*^9, 3.665246993372182*^9}, {3.6661012635492268`*^9, 
   3.666101268258107*^9}, {3.666101690258791*^9, 3.6661016907429667`*^9}, {
   3.666404719047171*^9, 3.666404753268009*^9}}],

Cell[BoxData["\<\"tuRepeat[rules_List:{},operation_:Null][exp_] applies \
rules_ and operation_ repeatedly until exp_ does not change. \
*5Apr2015*\"\>"], "Output",
 CellChangeTimes->{3.645453049319672*^9, 3.6464947144037943`*^9, 
  3.647949257728777*^9, 3.6479587661968193`*^9, 3.6506316434349337`*^9, 
  3.6628218200468693`*^9, 3.6628219264119453`*^9, 3.6628237543650837`*^9, 
  3.66282395792306*^9, 3.6628241661546392`*^9}]
}, Open  ]]
},
WindowSize->{808, 678},
WindowMargins->{{-559, Automatic}, {Automatic, -926}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 225, 3, 29, "Text"],
Cell[785, 25, 20300, 534, 1194, "Input",
 InitializationCell->True],
Cell[21088, 561, 211, 4, 29, "Text"],
Cell[21302, 567, 5288, 109, 346, "Input",
 InitializationCell->True],
Cell[26593, 678, 109, 1, 29, "Text"],
Cell[26705, 681, 74653, 1780, 5832, "Input",
 InitializationCell->True],
Cell[101361, 2463, 108, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[101494, 2468, 62472, 1532, 5037, "Input",
 InitializationCell->True],
Cell[163969, 4002, 426, 6, 42, "Output"]
}, Open  ]]
}
]
*)

