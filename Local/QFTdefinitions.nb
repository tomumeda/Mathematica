(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    125232,       3046]
NotebookOptionsPosition[    123873,       3002]
NotebookOutlinePosition[    124281,       3019]
CellTagsIndexPosition[    124238,       3016]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Past", " ", "definitions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Needs", "[", "\"\<TensorCalculus4V6`Tensorial`\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "Local`LocalFunctions`"}], "\[IndentingNewLine]", 
   "IntegrateSumFunctions", "\[IndentingNewLine]", "DotFunctions", 
   "\[IndentingNewLine]", "IntegralFunctions", "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Indices4D", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"field", ",", "Green"}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"space", ",", "Red"}], "}"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"DefineTensorShortcuts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "\[Psi]", ",", "m", ",", "k"}], "}"}], 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x", ",", "y", ",", "dx", ",", "\[Xi]", ",", "b", ",", "r", ",", 
         "zero", ",", "\[CurlyPhi]", ",", "\[Psi]", ",", "\[Psi]c", ",", "J", 
         ",", "K", ",", "P", ",", "a", ",", "k", ",", "e", ",", "p", ",", "q",
          ",", "dp", ",", "dq", ",", "j", ",", "A", ",", "\[Gamma]"}], "}"}], 
       ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x", ",", "k", ",", "g", ",", "\[Delta]", " ", ",", "\[Sigma]", ",", 
         "zero", ",", "\[Omega]", ",", "\[Omega]1", ",", "\[Omega]2", ",", 
         "\[Omega]s", ",", "\[Omega]a", ",", "\[Eta]", ",", 
         "\[CapitalLambda]", ",", "A", ",", "B", ",", "M", ",", 
         "\[Delta]\[Omega]", ",", "\[Delta]\[Alpha]", ",", "q", ",", "p", ",",
          "R", ",", "T", ",", "\[Theta]", ",", "S", ",", "F"}], "}"}], ",", 
       "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalGamma]", ",", "\[Epsilon]"}], "}"}], ",", "3"}], 
      "}"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"labels", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Delta]", ",", "g", ",", " ", "\[CapitalGamma]"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DeclareZeroTensor", "[", "zero", "]"}], "\[IndentingNewLine]", 
   RowBox[{"TensorLabelFormat", "[", 
    RowBox[{"zero", ",", "0"}], "]"}], "\n", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Delta]ud", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]ud", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]uu", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetTensorValues", "[", 
    RowBox[{
     RowBox[{"\[Eta]dd", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeclareBaseIndices", "[", 
     RowBox[{"Indices4D", ",", 
      RowBox[{"{", 
       RowBox[{"field", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"space", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CompleteBaseIndices", ";"}]}]}]], "Input",
 CellChangeTimes->{{3.474902202988223*^9, 3.474902218781245*^9}, {
   3.474902249452106*^9, 3.474902252358342*^9}, 3.4749022885666847`*^9, {
   3.474904002467537*^9, 3.474904015966226*^9}, {3.474904263840423*^9, 
   3.474904264616147*^9}, {3.4749045168750257`*^9, 3.474904522534278*^9}, 
   3.4749447322109528`*^9, 3.475063128375374*^9, {3.475063407814282*^9, 
   3.475063453165277*^9}, {3.475063912503304*^9, 3.475063945299889*^9}, {
   3.4753277125307302`*^9, 3.475327716729056*^9}}],

Cell[TextData[{
 "Revised definitions.  (The goal is streamline and generalize the \
definitions for most QFT problems.  Unfortunately, the metric tensor is \
defined differently between Srednicki\n(negative time) and Peskin-Schroeder \
(positive time).  We will use P-S convention here. )  We will use the \
Tensorial package for the primary notational basis.   The developmental Dot \
and IntegralOp functions are also incorporated.  The Dot[] function is used \
to maintain non-communicative relationship between products.  Most \
relationships will be maintained as Rule[] since ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " changes the position of terms in Equal[[] relationships."
}], "Text",
 CellChangeTimes->{{3.475327771927926*^9, 3.475327795604416*^9}, {
  3.4753278343184958`*^9, 3.475328036401976*^9}, {3.475328152556926*^9, 
  3.4753282968651867`*^9}, {3.4753284939034557`*^9, 3.475328512244706*^9}, {
  3.4753298929719687`*^9, 3.475329962196875*^9}, {3.475329997312049*^9, 
  3.475330030626697*^9}, {3.4753333336267138`*^9, 3.4753333941058693`*^9}, {
  3.475333638454989*^9, 3.4753337240466433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"External", " ", "packages"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Needs", "[", "\"\<TensorCalculus4V6`Tensorial`\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "Local`LocalFunctions`"}], "\[IndentingNewLine]", 
   "DotFunctions", "\[IndentingNewLine]", "IntegralFunctions", "\n", 
   "IntegrateSumFunctions", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Area", " ", "for", " ", "specific", " ", "assignments", " ", "of", " ", 
     "variables", " ", "for", " ", "all", " ", 
     RowBox[{"problems", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Indices4D", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"field", ",", "Green"}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DeclareIndexFlavor", "[", 
    RowBox[{"{", 
     RowBox[{"space", ",", "Red"}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"DefineTensorShortcuts", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "\[Psi]", ",", "m", ",", "k"}], "}"}], 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x", ",", "y", ",", "dx", ",", "\[Xi]", ",", "b", ",", "c", ",", "r", 
         ",", "zero", ",", "\[CurlyPhi]", ",", "\[Psi]", ",", "\[Psi]c", ",", 
         "J", ",", "K", ",", "P", ",", "a", ",", "k", ",", "e", ",", "p", ",",
          "q", ",", "dp", ",", "dq", ",", "j", ",", "A", ",", "B", ",", 
         "\[Gamma]"}], "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x", ",", "k", ",", "g", ",", "\[Delta]", " ", ",", "\[Sigma]", ",", 
         "zero", ",", "\[Omega]", ",", "\[Omega]1", ",", "\[Omega]2", ",", 
         "\[Omega]s", ",", "\[Omega]a", ",", "\[Eta]", ",", 
         "\[CapitalLambda]", ",", "A", ",", "B", ",", "M", ",", 
         "\[Delta]\[Omega]", ",", "\[Delta]\[Alpha]", ",", "q", ",", "p", ",",
          "R", ",", "T", ",", "\[Theta]", ",", "S", ",", "F"}], "}"}], ",", 
       "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalGamma]", ",", "\[Epsilon]"}], "}"}], ",", "3"}], 
      "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"labels", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Delta]", ",", "g", ",", " ", "\[CapitalGamma]"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Notation", " ", "in", " ", "QFT", " ", "has", " ", "too", " ", "many", 
     " ", "requirements", " ", "and", " ", "often", " ", "needs", " ", "to", 
     " ", "be", " ", "problem", " ", 
     RowBox[{"specific", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"GammaSlash", " ", "display", " ", 
      RowBox[{"definition", ".", "  ", "May"}], " ", "want", " ", "to", " ", 
      "redefine", " ", "it", " ", "as", " ", 
      RowBox[{"g", "[", "a_", "]"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"GammaSlash", "[", "a", "]"}], ".", "  ", "Perhaps"}], " ", 
      "the", " ", "Bold", " ", "is", " ", 
      RowBox[{"enough", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"GammaSlash", "[", "a_", "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     "\n", "    ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"a", ",", "Bold"}], "]"}], ",", "\"\</\>\""}], "]"}], 
        "]"}], ",", " ", 
       RowBox[{"GammaSlash", "[", "a", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"IntegralOp", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"IntegralOp", "[", 
       RowBox[{"v_", ",", "a_"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<\[Integral]\>\"", ",", 
           RowBox[{"Column", "[", "v", "]"}]}], "]"}], "[", "a", "]"}], "]"}],
        ",", " ", 
       RowBox[{"IntegralOp", "[", 
        RowBox[{"v", ",", "a"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Transpose", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "a_", "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{"Superscript", "[", 
         RowBox[{"a", ",", "T"}], "]"}], "]"}], ",", " ", 
       RowBox[{"Transpose", "[", "a", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Transpose", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "a_", "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{"Superscript", "[", 
         RowBox[{"a", ",", "\[Dagger]"}], "]"}], "]"}], ",", " ", 
       RowBox[{"ConjugateTranspose", "[", "a", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"xPartialD", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"xPartialD", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{
           UnderscriptBox["\"\<\[PartialD]\>\"", "_"], ",", "b"}], "]"}], "[",
          "a", "]"}], "]"}], ",", " ", 
       RowBox[{"xPartialD", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"xDiscreteDelta", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"xDiscreteDelta", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         UnderscriptBox["\"\<\[Delta]\>\"", "_"], "[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}], ",", " ", 
       RowBox[{"xDiscreteDelta", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"xSum", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"xSum", "[", 
       RowBox[{"a_", ",", "b__"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         RowBox[{"Underscript", "[", 
          RowBox[{
           UnderscriptBox[
            RowBox[{" ", "\"\<\[Sum]\>\""}], "_"], ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], "]"}], "[", "a", "]"}], "]"}], 
       ",", " ", 
       RowBox[{"xSum", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"xProduct", " ", "display", " ", 
     RowBox[{"definition", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"xProduct", "[", 
       RowBox[{"a_", ",", "b__"}], "]"}], ",", 
      RowBox[{"form", ":", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"InterpretationBox", "[", 
       RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
        RowBox[{"SyntaxForm", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Editable", "\[Rule]", "False"}]}], "]"}], "&"}], " ", "@@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToBoxes", "[", 
        RowBox[{
         RowBox[{"Underscript", "[", 
          RowBox[{
           UnderscriptBox[
            RowBox[{" ", "\"\<\[Product]\>\""}], "_"], ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], "]"}], "[", "a", "]"}], "]"}], 
       ",", " ", 
       RowBox[{"xProduct", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Commutation", " ", "and", " ", "Anti"}], "-", 
     RowBox[{"commutation", " ", 
      RowBox[{"definitions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MCommutator", "::", "usage"}], " ", "=", " ", 
     "\"\<MCommutator[A,B] calculates the commutator of matrices A and \
B\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MCommutator", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "-", 
      RowBox[{"B", ".", "A"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ACommutator", "::", "usage"}], " ", "=", " ", 
     "\"\<ACommutator[A,B] calculates the commutator of matrices A and \
B\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ACommutator", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "+", 
      RowBox[{"B", ".", "A"}]}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.474902202988223*^9, 3.474902218781245*^9}, {
   3.474902249452106*^9, 3.474902252358342*^9}, 3.4749022885666847`*^9, {
   3.474904002467537*^9, 3.474904015966226*^9}, {3.474904313637267*^9, 
   3.474904314548793*^9}, {3.4749048751484833`*^9, 3.474904921574607*^9}, {
   3.474904979979472*^9, 3.4749049974963837`*^9}, {3.474905066647118*^9, 
   3.4749050811369257`*^9}, {3.47490523544936*^9, 3.474905236168868*^9}, {
   3.474944627432186*^9, 3.474944639810153*^9}, {3.4749447417941303`*^9, 
   3.474944745533605*^9}, {3.47494480052849*^9, 3.474944888358387*^9}, {
   3.4749449236275597`*^9, 3.4749449266154633`*^9}, {3.4749449876399603`*^9, 
   3.4749450212062597`*^9}, {3.474945424838657*^9, 3.4749454345521097`*^9}, {
   3.474945466141786*^9, 3.474945538456306*^9}, {3.474945628035927*^9, 
   3.4749456296334476`*^9}, {3.474945732962715*^9, 3.474945737890752*^9}, {
   3.4749482603608637`*^9, 3.474948281093103*^9}, {3.4749483840846977`*^9, 
   3.4749483992388697`*^9}, {3.47494875051725*^9, 3.474948803611261*^9}, {
   3.474948884947719*^9, 3.474948931840364*^9}, {3.4749492406201077`*^9, 
   3.47494925331595*^9}, 3.4749494733800087`*^9, {3.4749495113089247`*^9, 
   3.474949513753845*^9}, 3.474949573354327*^9, 3.4749499896837673`*^9, 
   3.474950029369328*^9, {3.474950131732786*^9, 3.474950132368799*^9}, {
   3.474981806402833*^9, 3.474981899327038*^9}, {3.474981930863414*^9, 
   3.4749819526597548`*^9}, {3.474982139741414*^9, 3.474982219964347*^9}, 
   3.4749823960052423`*^9, {3.474982459470777*^9, 3.4749824720743837`*^9}, {
   3.474984800287813*^9, 3.4749848254758472`*^9}, {3.474985004182403*^9, 
   3.4749850117712927`*^9}, {3.474985086786294*^9, 3.474985134182914*^9}, {
   3.474985177061207*^9, 3.4749851963052073`*^9}, {3.4749852770738363`*^9, 
   3.474985279382162*^9}, {3.474985317981666*^9, 3.474985318796495*^9}, {
   3.474985397408358*^9, 3.4749854396534157`*^9}, {3.475036704893425*^9, 
   3.475036731196498*^9}, {3.4750389758328333`*^9, 3.475039012093803*^9}, {
   3.475039049487483*^9, 3.4750390689880657`*^9}, {3.475039105243697*^9, 
   3.475039159964554*^9}, {3.4750392870967073`*^9, 3.475039385368299*^9}, {
   3.475039458528109*^9, 3.475039503603745*^9}, {3.475063508482891*^9, 
   3.475063663796075*^9}, {3.475063695597624*^9, 3.475063763677724*^9}, 
   3.475063796432467*^9, {3.475063970321206*^9, 3.475064036031556*^9}, 
   3.475064099865511*^9, {3.4750641864351683`*^9, 3.475064298812497*^9}, {
   3.475064353035616*^9, 3.4750644186614227`*^9}, {3.475064520693749*^9, 
   3.475064524811913*^9}, {3.475064601896146*^9, 3.475064610046653*^9}, {
   3.475064688899332*^9, 3.4750647411643953`*^9}, {3.47506479413098*^9, 
   3.475064868797393*^9}, {3.475327441006032*^9, 3.475327452271845*^9}, {
   3.475327660591365*^9, 3.475327669398367*^9}, {3.475333293468802*^9, 
   3.47533329498803*^9}, {3.475333430884448*^9, 3.475333507277213*^9}, {
   3.475509439666131*^9, 3.475509440215962*^9}, {3.475808837281938*^9, 
   3.475808862101738*^9}, {3.475808893363825*^9, 3.4758090991040487`*^9}, {
   3.475809285434099*^9, 3.475809308024102*^9}, {3.475809566820257*^9, 
   3.4758095722907352`*^9}, {3.475898672757971*^9, 3.475898765258114*^9}, {
   3.475899848905645*^9, 3.4758998957129507`*^9}, {3.4763897180650787`*^9, 
   3.476389718908877*^9}, {3.476394465322373*^9, 3.476394470317672*^9}, {
   3.476394524776701*^9, 3.476394532918673*^9}, {3.476475121496636*^9, 
   3.476475148939528*^9}, {3.476475180297505*^9, 3.4764752046779013`*^9}, {
   3.476475244590598*^9, 3.4764754125132837`*^9}, {3.476824581316856*^9, 
   3.47682466249527*^9}, {3.476824721532248*^9, 3.476824789474885*^9}, {
   3.47682488084687*^9, 3.476824889776174*^9}, {3.476825118436091*^9, 
   3.476825133069786*^9}, {3.4768251972628813`*^9, 3.476825201005974*^9}, {
   3.476891015110813*^9, 3.4768911658439093`*^9}, {3.47689128459365*^9, 
   3.476891327240355*^9}, {3.4781225088749332`*^9, 3.478122510170926*^9}}],

Cell["Notational and Notebook display definitions.", "Text",
 CellChangeTimes->{{3.475328524687422*^9, 3.475328566517704*^9}, {
  3.4753286023383007`*^9, 3.4753286317238607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"\"\<PR[] annotations:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Imply", "=", "\"\<\\n\[DoubleRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imply", "=", "\"\< \[DoubleRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yield", "=", "\"\<\\n\[RightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yield", "=", "\"\< \[LongRightArrow] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"back", "=", "\"\< \[LongLeftArrow]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"and", "=", "\"\< and \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"CR", "[", "\"\<\[LongLeftArrow]CHECK\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"New", "=", "\"\<\\n\[FilledCircle] \>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.475328570655633*^9, 3.4753285774188538`*^9}, {
  3.4753300636904793`*^9, 3.475330135116205*^9}, {3.477233895742262*^9, 
  3.4772339399220247`*^9}}],

Cell[BoxData["\<\"PR[] annotations:\"\>"], "Output",
 CellChangeTimes->{3.4758987804051867`*^9, 3.476388328464306*^9, 
  3.476389722334065*^9, 3.476475418863253*^9, 3.476642921079228*^9, 
  3.47675436573561*^9, 3.477178401789303*^9, 3.477233943537554*^9, 
  3.47812251526831*^9}]
}, Open  ]],

Cell["Gamma matrix technology", "Text",
 CellChangeTimes->{{3.475328083875739*^9, 3.4753280940834923`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"psa16", "=", 
  RowBox[{
   RowBox[{"ACommutator", "[", 
    RowBox[{
     RowBox[{"\[Gamma]u", "[", "\[Mu]", "]"}], ",", 
     RowBox[{"\[Gamma]u", "[", "\[Nu]", "]"}]}], "]"}], "->", 
   RowBox[{"2", " ", 
    RowBox[{"guu", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psa16a", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "-", 
       RowBox[{"psa16", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}], ",", "psa16"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ps368", "=", 
   RowBox[{
    RowBox[{"\[Gamma]u", "[", "5", "]"}], "->", 
    RowBox[{"I", " ", 
     RowBox[{
      RowBox[{"\[Gamma]u", "[", "0", "]"}], ".", 
      RowBox[{"\[Gamma]u", "[", "1", "]"}], ".", 
      RowBox[{"\[Gamma]u", "[", "2", "]"}], ".", 
      RowBox[{"\[Gamma]u", "[", "3", "]"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ps370", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]u", "[", "5", "]"}], ".", 
    RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "->", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"ps371", "=", 
  RowBox[{
   RowBox[{"ACommutator", "[", 
    RowBox[{
     RowBox[{"\[Gamma]u", "[", "\[Mu]", "]"}], ",", 
     RowBox[{"\[Gamma]u", "[", "5", "]"}]}], "]"}], "->", 
   "0"}]}], "\[IndentingNewLine]", 
 RowBox[{"ps55a", "=", 
  RowBox[{
   RowBox[{"Tr", "[", "Id", "]"}], "->", "4"}]}], "\[IndentingNewLine]", 
 RowBox[{"ps55c", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"\[Gamma]u", "[", "\[Mu]", "]"}], ".", 
     RowBox[{"\[Gamma]u", "[", "\[Nu]", "]"}]}], "]"}], "->", 
   RowBox[{"4", " ", 
    RowBox[{"guu", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ps55e", "=", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"\[Gamma]u", "[", "5", "]"}], "]"}], "->", "0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", "a_", "]"}], ":=", 
   RowBox[{"GammaSlash", "[", "a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subTraceGamma", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"g", "[", "a_", "]"}], ".", 
        RowBox[{"g", "[", "b_", "]"}]}], "]"}], "->", 
      RowBox[{"4", " ", 
       RowBox[{"a", ".", "b"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"g", "[", "a_", "]"}], ".", 
        RowBox[{"g", "[", "b_", "]"}], ".", 
        RowBox[{"g", "[", "c_", "]"}], ".", 
        RowBox[{"g", "[", "d_", "]"}]}], "]"}], "->", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"a", ".", "b"}], " ", 
          RowBox[{"c", ".", "d"}]}], "-", 
         RowBox[{
          RowBox[{"a", ".", "c"}], " ", 
          RowBox[{"b", ".", "d"}]}], "+", 
         RowBox[{
          RowBox[{"a", ".", "d"}], " ", 
          RowBox[{"b", ".", "c"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"g", "[", "a_", "]"}], "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"g", "[", "a_", "]"}], ".", 
        RowBox[{"g", "[", "b_", "]"}], ".", 
        RowBox[{"g", "[", "c_", "]"}]}], "]"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"a_", " ", "b__"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Tr", "[", "b", "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Head", "[", "a", "]"}], "=!=", "GammaSlash"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tr", "[", "0", "]"}], "->", "0"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.475328123998171*^9, 3.475328144256694*^9}, {
   3.475328304872456*^9, 3.4753283182617693`*^9}, {3.475328351015662*^9, 
   3.475328367009488*^9}, {3.475333524120799*^9, 3.475333628677216*^9}, {
   3.4753337470618677`*^9, 3.4753337530110397`*^9}, {3.475333868765501*^9, 
   3.475333886651235*^9}, {3.475334456651794*^9, 3.4753345339458838`*^9}, {
   3.475341693343952*^9, 3.475341697647821*^9}, 3.475341876350463*^9, {
   3.4753419530979548`*^9, 3.475342024964407*^9}, {3.475342353406999*^9, 
   3.4753424243893642`*^9}, {3.475342462248831*^9, 3.4753425386889257`*^9}, {
   3.475343559647657*^9, 3.4753437477150097`*^9}, {3.475343777804968*^9, 
   3.475343822030724*^9}, {3.475343909796315*^9, 3.47534392259345*^9}, {
   3.4753444450366583`*^9, 3.47534448099774*^9}, {3.4753446155859947`*^9, 
   3.475344631640381*^9}, {3.4753446909124002`*^9, 3.475344747802864*^9}, {
   3.4753448518920717`*^9, 3.475345038209539*^9}, {3.475345079795126*^9, 
   3.475345193773902*^9}, {3.475345238274949*^9, 3.4753452894704227`*^9}, {
   3.475345373246751*^9, 3.475345415460705*^9}, 3.475346528554399*^9, {
   3.475346713288813*^9, 3.475346799296137*^9}, {3.4753468641132097`*^9, 
   3.475346942541623*^9}, 3.475347135703167*^9, {3.4753471990020123`*^9, 
   3.4753472101392813`*^9}, {3.475347557581555*^9, 3.475347653794413*^9}, 
   3.475348054871016*^9, {3.4753525505906153`*^9, 3.475352564725621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Mu]",
       StripOnInput->False,
       ShowContents->False], "\[Mu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Nu]",
       StripOnInput->False,
       ShowContents->False], "\[Nu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Nu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], "+", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Nu]",
       StripOnInput->False,
       ShowContents->False], "\[Nu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Nu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Mu]",
       StripOnInput->False,
       ShowContents->False], "\[Mu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}]}], "\[Rule]", 
  RowBox[{"2", " ", 
   InterpretationBox[
    SubsuperscriptBox["g", 
     StyleBox[
      RowBox[{"\[Mu]", "\[Nu]"}],
      StripOnInput->False,
      ShowContents->False], 
     RowBox[{"\[Mu]", "\[Nu]"}]],
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {
     TensorCalculus4V6`Tensorial`Void, TensorCalculus4V6`Tensorial`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False]}]}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.478122515364184*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\[Gamma]", 
     StyleBox["\[Nu]",
      StripOnInput->False,
      ShowContents->False], "\[Nu]"],
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Nu]}, {TensorCalculus4V6`Tensorial`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False], ".", 
   InterpretationBox[
    SubsuperscriptBox["\[Gamma]", 
     StyleBox["\[Mu]",
      StripOnInput->False,
      ShowContents->False], "\[Mu]"],
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False]}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     InterpretationBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox["\[Mu]",
        StripOnInput->False,
        ShowContents->False], "\[Mu]"],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], \
{$CellContext`\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False], ".", 
     InterpretationBox[
      SubsuperscriptBox["\[Gamma]", 
       StyleBox["\[Nu]",
        StripOnInput->False,
        ShowContents->False], "\[Nu]"],
      TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], \
{$CellContext`\[Nu]}, {TensorCalculus4V6`Tensorial`Void}],
      BaseStyle->{AutoMultiplicationSymbol -> False},
      Editable->False]}]}], "+", 
   RowBox[{"2", " ", 
    InterpretationBox[
     SubsuperscriptBox["g", 
      StyleBox[
       RowBox[{"\[Mu]", "\[Nu]"}],
       StripOnInput->False,
       ShowContents->False], 
      RowBox[{"\[Mu]", "\[Nu]"}]],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {
      TensorCalculus4V6`Tensorial`Void, TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}]}]}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.478122515367683*^9}],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   SubsuperscriptBox["\[Gamma]", 
    StyleBox["5",
     StripOnInput->False,
     ShowContents->False], "5"],
   TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {5}, {
    TensorCalculus4V6`Tensorial`Void}],
   BaseStyle->{AutoMultiplicationSymbol -> False},
   Editable->False], "\[Rule]", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["0",
       StripOnInput->False,
       ShowContents->False], "0"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {0}, {
      TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["1",
       StripOnInput->False,
       ShowContents->False], "1"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {1}, {
      TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["2",
       StripOnInput->False,
       ShowContents->False], "2"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {2}, {
      TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["3",
       StripOnInput->False,
       ShowContents->False], "3"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {3}, {
      TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}]}]}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.478122515369521*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    SubsuperscriptBox["\[Gamma]", 
     StyleBox["5",
      StripOnInput->False,
      ShowContents->False], "5"],
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {5}, {
     TensorCalculus4V6`Tensorial`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False], ".", 
   InterpretationBox[
    SubsuperscriptBox["\[Gamma]", 
     StyleBox["5",
      StripOnInput->False,
      ShowContents->False], "5"],
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {5}, {
     TensorCalculus4V6`Tensorial`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False]}], "\[Rule]", "1"}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.4781225153711433`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["5",
       StripOnInput->False,
       ShowContents->False], "5"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {5}, {
      TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Mu]",
       StripOnInput->False,
       ShowContents->False], "\[Mu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], "+", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Mu]",
       StripOnInput->False,
       ShowContents->False], "\[Mu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["5",
       StripOnInput->False,
       ShowContents->False], "5"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {5}, {
      TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}]}], "\[Rule]", "0"}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.478122515372835*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tr", "[", "Id", "]"}], "\[Rule]", "4"}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.4781225153742533`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Mu]",
       StripOnInput->False,
       ShowContents->False], "\[Mu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Mu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False], ".", 
    InterpretationBox[
     SubsuperscriptBox["\[Gamma]", 
      StyleBox["\[Nu]",
       StripOnInput->False,
       ShowContents->False], "\[Nu]"],
     TensorCalculus4V6`Tensorial`Tensor[$CellContext`\[Gamma], {$CellContext`\
\[Nu]}, {TensorCalculus4V6`Tensorial`Void}],
     BaseStyle->{AutoMultiplicationSymbol -> False},
     Editable->False]}], "]"}], "\[Rule]", 
  RowBox[{"4", " ", 
   InterpretationBox[
    SubsuperscriptBox["g", 
     StyleBox[
      RowBox[{"\[Mu]", "\[Nu]"}],
      StripOnInput->False,
      ShowContents->False], 
     RowBox[{"\[Mu]", "\[Nu]"}]],
    TensorCalculus4V6`Tensorial`Tensor[$CellContext`g, {$CellContext`\[Mu], \
$CellContext`\[Nu]}, {
     TensorCalculus4V6`Tensorial`Void, TensorCalculus4V6`Tensorial`Void}],
    BaseStyle->{AutoMultiplicationSymbol -> False},
    Editable->False]}]}]], "Output",
 CellChangeTimes->{3.4758987804480143`*^9, 3.476388328527824*^9, 
  3.476389722388234*^9, 3.476475418931262*^9, 3.476642921122878*^9, 
  3.476754366245422*^9, 3.477178401829805*^9, 3.478122515376217*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"\"\<e[] == unit vector.\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DotExpand", "=", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"a___", ",", 
       RowBox[{"d___", " ", 
        RowBox[{"Dot", "[", "b__", "]"}]}], ",", "c__"}], "]"}], ":>", 
     RowBox[{"d", " ", 
      RowBox[{"Dot", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}]}], ";"}], 
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Newer", " ", 
    RowBox[{"version", ".", " ", "2010.2"}], ".16"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DotKeep1", "[", 
     RowBox[{"clist_", ",", "seq_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Keeps", " ", "under", " ", "Dot", " ", "items", " ", "in", " ", 
       RowBox[{"clist", ".", " ", "Usage"}], "  ", "expression"}], "/.", 
      RowBox[{
       RowBox[{"Dot", "[", "a___", "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dotKeep", "[", 
           RowBox[{"{", " ", "keep_list", " ", "}"}], "]"}], "  ", "[", "a", 
          "]"}], ".", "  ", "Returns"}], "  ", "nokeep_list", " ", 
        RowBox[{"Dot", "[", " ", "keep_list", " ", "]"}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tmp", "=", "seq"}], ",", "i", ",", "j", ",", "member", ",", 
        RowBox[{"dot", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"times", "=", 
         RowBox[{"{", "1", "}"}]}], ",", "test", ",", 
        RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"tmp", "/.", 
          RowBox[{"Times", "->", "Dot"}]}], "/.", "simpleDot"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<DotKeep< \>\"", ",", "clist", ",", "\"\< : \>\"", ",", "tmp", 
           ",", "\"\< \>\"", ",", 
           RowBox[{"Length", "[", "tmp", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "tmp", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"test", "=", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "1"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<DotKeep: \>\"", ",", "test", ",", "\"\< : \>\"", ",", 
              "clist"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"member", "=", "False"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"clist", ",", "test"}], "]"}], ",", 
            RowBox[{"member", "=", "True"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "clist", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", " ", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"test", ",", 
                 RowBox[{"clist", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"member", "=", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", " ", 
           RowBox[{"member", ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", " ", 
             RowBox[{"dot", ",", "test"}], "]"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"AppendTo", "[", " ", 
             RowBox[{"times", ",", "test"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "1"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<DotKeep: \>\"", ",", "dot", ",", "times"}], "]"}]}],
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "times", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", "times"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dot", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"tmp", " ", 
           RowBox[{"Apply", "[", 
            RowBox[{"Dot", ",", "dot"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<DotKeep>> \>\"", ",", "tmp"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GammaRight", "[", 
     RowBox[{"exp_", ",", "gamma_"}], "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Moves", " ", "gamma_", " ", "in", " ", 
       RowBox[{"Dot", "[", "]"}], " ", "expression", " ", "to", " ", "the", 
       " ", "right", " ", "until", " ", "the", " ", "end", " ", "or", " ", 
       "the", " ", "term", " ", 
       RowBox[{"disappears", ".", "  ", 
        RowBox[{"Usage", ":", " ", "expression"}]}]}], "/.", 
      RowBox[{
       RowBox[{"Dot", "[", "a__", "]"}], ":>", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"GammaRight", "[", "a", "]"}], ".", "  ", "Returns"}], " ", 
        "replacement", " ", "for", " ", 
        RowBox[{
         RowBox[{"Dot", "[", "]"}], "."}]}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "out", ",", "gpos", 
        ",", "Ngpos", ",", "igpos", ",", 
        RowBox[{"indu", "=", "Null"}], ",", 
        RowBox[{"indd", "=", "Null"}], ",", "pair", ",", 
        RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<GammaRight: \>\"", ",", "tmp", ",", "\"\< : \>\"", ",", 
           "gamma"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"tmp1", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"indu", "=", 
           RowBox[{"gamma", "/.", 
            RowBox[{
             RowBox[{"\[Gamma]u", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indd", "=", 
           RowBox[{"gamma", "/.", 
            RowBox[{
             RowBox[{"\[Gamma]d", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a___", ",", "gamma", ",", "b_", ",", "c___"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a", ",", 
                RowBox[{"CommuteG", "[", 
                 RowBox[{"gamma", ",", "b"}], "]"}], ",", "c"}], "]"}], "/;", 
              
              RowBox[{"(", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "b", "}"}], ",", 
                 RowBox[{
                  RowBox[{"\[Gamma]u", "[", "_", "]"}], "||", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"{", "b", "}"}], ",", 
                    RowBox[{"\[Gamma]d", "[", "_", "]"}]}], "]"}]}]}], "]"}], 
               ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Expand", "[", "tmp", "]"}], "/.", "simpleDot"}], "//", 
            "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "0"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<GammaRight>  \>\"", ",", "tmp"}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"Dot", "->", "xDot"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"xDot", "[", "a__", "]"}], ":>", 
             RowBox[{"DotKeep1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Gamma]d", "[", "_", "]"}], ",", 
                 RowBox[{"\[Gamma]u", "[", "_", "]"}]}], "}"}], ",", 
               RowBox[{"{", "a", "}"}]}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"Expand", "[", "tmp", "]"}], "/.", "simpleDot"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"a___", ",", 
                 RowBox[{"\[Gamma]d", "[", "b_", "]"}], ",", 
                 RowBox[{"\[Gamma]u", "[", "b_", "]"}], ",", "c___"}], "]"}], 
               ":>", 
               RowBox[{
                RowBox[{"dim", "[", "x", "]"}], 
                RowBox[{"Dot", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"a___", ",", 
                 RowBox[{"\[Gamma]u", "[", "b_", "]"}], ",", 
                 RowBox[{"\[Gamma]d", "[", "b_", "]"}], ",", "c___"}], "]"}], 
               ":>", 
               RowBox[{
                RowBox[{"dim", "[", "x", "]"}], " ", 
                RowBox[{"Dot", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "0"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<GammaRight>> \>\"", ",", "tmp"}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GammaLeft", "[", 
     RowBox[{"exp_", ",", "gamma_"}], "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Moves", " ", "gamma_", " ", "in", " ", 
       RowBox[{"Dot", "[", "]"}], " ", "expression", " ", "to", " ", "the", 
       " ", "left", " ", "until", " ", "the", " ", "end", " ", "or", " ", 
       "the", " ", "term", " ", 
       RowBox[{"disappears", ".", "  ", 
        RowBox[{"Usage", ":", " ", "expression"}]}]}], "/.", 
      RowBox[{
       RowBox[{"Dot", "[", "a__", "]"}], ":>", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"GammaLeft", "[", "a", "]"}], ".", "  ", "Returns"}], " ", 
        "replacement", " ", "for", " ", 
        RowBox[{
         RowBox[{"Dot", "[", "]"}], "."}]}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", "out", ",", "gpos", 
        ",", "Ngpos", ",", "igpos", ",", 
        RowBox[{"indu", "=", "Null"}], ",", 
        RowBox[{"indd", "=", "Null"}], ",", "pair", ",", 
        RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DEBUG", ">", "0"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<GammaLeft: \>\"", ",", "tmp", ",", "\"\< : \>\"", ",", 
           "gamma"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"tmp1", "=!=", "tmp"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
          RowBox[{"indu", "=", 
           RowBox[{"gamma", "/.", 
            RowBox[{
             RowBox[{"\[Gamma]u", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indd", "=", 
           RowBox[{"gamma", "/.", 
            RowBox[{
             RowBox[{"\[Gamma]d", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a___", ",", "b_", ",", "gamma", ",", "c___"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"a", ",", 
                RowBox[{"CommuteG", "[", 
                 RowBox[{"b", ",", "gamma"}], "]"}], ",", "c"}], "]"}], "/;", 
              
              RowBox[{"(", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "b", "}"}], ",", 
                 RowBox[{
                  RowBox[{"\[Gamma]u", "[", "_", "]"}], "||", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"{", "b", "}"}], ",", 
                    RowBox[{"\[Gamma]d", "[", "_", "]"}]}], "]"}]}]}], "]"}], 
               ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Expand", "[", "tmp", "]"}], "/.", "simpleDot"}], "//", 
            "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "0"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<GammaLeft>  \>\"", ",", "tmp"}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"Dot", "->", "xDot"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"xDot", "[", "a__", "]"}], ":>", 
             RowBox[{"DotKeep1", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Gamma]d", "[", "_", "]"}], ",", 
                 RowBox[{"\[Gamma]u", "[", "_", "]"}]}], "}"}], ",", 
               RowBox[{"{", "a", "}"}]}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"Expand", "[", "tmp", "]"}], "/.", "simpleDot"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"a___", ",", 
                 RowBox[{"\[Gamma]d", "[", "b_", "]"}], ",", 
                 RowBox[{"\[Gamma]u", "[", "b_", "]"}], ",", "c___"}], "]"}], 
               ":>", 
               RowBox[{
                RowBox[{"dim", "[", "x", "]"}], 
                RowBox[{"Dot", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"a___", ",", 
                 RowBox[{"\[Gamma]u", "[", "b_", "]"}], ",", 
                 RowBox[{"\[Gamma]d", "[", "b_", "]"}], ",", "c___"}], "]"}], 
               ":>", 
               RowBox[{
                RowBox[{"dim", "[", "x", "]"}], " ", 
                RowBox[{"Dot", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DEBUG", ">", "0"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<GammaLeft>> \>\"", ",", "tmp"}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CommuteG", "[", 
    RowBox[{"g1_", ",", "g2_"}], "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{"Commute", " ", "\[Gamma]", " ", 
     RowBox[{"matrices", ".", " ", "\[Gamma]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", ",", 
       RowBox[{"ind1u", "=", "Null"}], ",", 
       RowBox[{"ind1d", "=", "Null"}], ",", 
       RowBox[{"ind2u", "=", "Null"}], ",", 
       RowBox[{"ind2d", "=", "Null"}], ",", 
       RowBox[{"gtmp", "=", "1"}], ",", "out", ",", 
       RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DEBUG", ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<CommuteG: \>\"", ",", "g1", ",", "\"\< : \>\"", ",", "g2"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "g1", "}"}], ",", 
             RowBox[{"\[Gamma]d", "[", "_", "]"}]}], " ", "]"}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "g1", "}"}], ",", 
             RowBox[{"\[Gamma]u", "[", "_", "]"}]}], " ", "]"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "g2", "}"}], ",", 
             RowBox[{"\[Gamma]d", "[", "_", "]"}]}], " ", "]"}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "g2", "}"}], ",", 
             RowBox[{"\[Gamma]u", "[", "_", "]"}]}], " ", "]"}]}], ")"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"g1", ".", "g2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ind1u", "=", 
          RowBox[{"g1", "/.", 
           RowBox[{
            RowBox[{"\[Gamma]u", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g1", "===", "ind1u"}], ",", 
           RowBox[{"ind1u", "=", "Null"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ind1d", "=", 
          RowBox[{"g1", "/.", 
           RowBox[{
            RowBox[{"\[Gamma]d", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g1", "===", "ind1d"}], ",", 
           RowBox[{"ind1d", "=", "Null"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ind2u", "=", 
          RowBox[{"g2", "/.", 
           RowBox[{
            RowBox[{"\[Gamma]u", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g2", "===", "ind2u"}], ",", 
           RowBox[{"ind2u", "=", "Null"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ind2d", "=", 
          RowBox[{"g2", "/.", 
           RowBox[{
            RowBox[{"\[Gamma]d", "[", "a_", "]"}], "->", "a"}]}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g2", "===", "ind2d"}], ",", 
           RowBox[{"ind2d", "=", "Null"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ind1u", "=!=", "Null"}], "&&", 
            RowBox[{"ind2u", "=!=", "Null"}]}], ",", 
           RowBox[{"gtmp", "=", 
            RowBox[{"guu", "[", 
             RowBox[{"ind1u", ",", "ind2u"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ind1d", "=!=", "Null"}], "&&", 
            RowBox[{"ind2d", "=!=", "Null"}]}], ",", 
           RowBox[{"gtmp", "=", 
            RowBox[{"gdd", "[", 
             RowBox[{"ind1d", ",", "ind2d"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ind1u", "=!=", "Null"}], "&&", 
            RowBox[{"ind2d", "=!=", "Null"}]}], ",", 
           RowBox[{"gtmp", "=", 
            RowBox[{"gud", "[", 
             RowBox[{"ind1u", ",", "ind2d"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ind1d", "=!=", "Null"}], "&&", 
            RowBox[{"ind2u", "=!=", "Null"}]}], ",", 
           RowBox[{"gtmp", "=", 
            RowBox[{"gdu", "[", 
             RowBox[{"ind1d", ",", "ind2u"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"g2", ".", "g1"}]}], "+", 
           RowBox[{"2", "gtmp"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DEBUG", ">", "0"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<CommuteG: \>\"", ",", "ind1u", ",", "\"\< \>\"", ",", 
             "ind1d", ",", "\"\< \>\"", ",", "ind2u", ",", "\"\< \>\"", ",", 
             "ind2d", ",", "\"\<>>\>\"", ",", "out"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4753465512080317`*^9, 3.475346554216423*^9}, {
   3.4753465856310472`*^9, 3.475346621892208*^9}, {3.475346668954856*^9, 
   3.475346669176675*^9}, 3.4753472519988728`*^9, {3.47534729491439*^9, 
   3.475347364623801*^9}, {3.475347396784602*^9, 3.475347433158287*^9}, {
   3.475347707841419*^9, 3.4753477082870207`*^9}, {3.475347742903981*^9, 
   3.47534782387926*^9}, {3.47534995783218*^9, 3.475350031994712*^9}, {
   3.4753500711048393`*^9, 3.475350144816533*^9}, {3.475350306389287*^9, 
   3.475350469087633*^9}, {3.475350555524749*^9, 3.475350592362454*^9}, {
   3.475350664898057*^9, 3.475350678053525*^9}, {3.475350903184366*^9, 
   3.475351003725884*^9}, {3.475351129605673*^9, 3.475351138071467*^9}, {
   3.475351175685073*^9, 3.4753511898701973`*^9}, {3.47535123151435*^9, 
   3.475351283995439*^9}, 3.4753515093495703`*^9, {3.475351800064806*^9, 
   3.47535202418405*^9}, {3.4753520668621473`*^9, 3.475352101918038*^9}, {
   3.475352334938896*^9, 3.475352518664269*^9}, {3.4753526273365793`*^9, 
   3.475352638287677*^9}, {3.4753526763962107`*^9, 3.4753527344462423`*^9}, {
   3.4753532423985577`*^9, 3.4753533212858763`*^9}, {3.475353406296814*^9, 
   3.4753534133791113`*^9}, {3.475353445171694*^9, 3.475353495856761*^9}, {
   3.475353531133277*^9, 3.475353603671583*^9}, {3.4753536352110443`*^9, 
   3.4753537615539017`*^9}, {3.475353889894141*^9, 3.475353892904949*^9}, {
   3.475353925167573*^9, 3.475354009927945*^9}, {3.475354100114399*^9, 
   3.4753541861843777`*^9}, {3.4753542428876057`*^9, 
   3.4753542749926147`*^9}, {3.4753543800384398`*^9, 
   3.4753544018476553`*^9}, {3.475354447158379*^9, 3.475354556825355*^9}, {
   3.475354634416751*^9, 3.475354813540646*^9}, {3.475354849353096*^9, 
   3.475354939979602*^9}, {3.4753559748272963`*^9, 3.475355982165483*^9}, {
   3.475356015326829*^9, 3.475356021349093*^9}, {3.475356149335154*^9, 
   3.475356149895138*^9}, {3.475356229732254*^9, 3.475356262661701*^9}, {
   3.4753563072548723`*^9, 3.4753563320771217`*^9}, {3.475356390458597*^9, 
   3.4753564309393578`*^9}, {3.475363035922538*^9, 3.475363213595894*^9}, {
   3.475363268345435*^9, 3.4753632972633677`*^9}, {3.4753633348269463`*^9, 
   3.475363348724815*^9}, {3.47536340700237*^9, 3.4753635806026793`*^9}, {
   3.475363612311414*^9, 3.475363873918358*^9}, {3.475363907884944*^9, 
   3.475363908841063*^9}, 3.47536397787424*^9, {3.475364009757326*^9, 
   3.4753640104061213`*^9}, {3.475364098991889*^9, 3.4753641452072897`*^9}, 
   3.475365260018832*^9, {3.475365658093651*^9, 3.475365949439968*^9}, {
   3.475366004856884*^9, 3.475366141720459*^9}, {3.475386134303418*^9, 
   3.475386209962783*^9}, {3.475386245836129*^9, 3.475386246680723*^9}, {
   3.4754150378389397`*^9, 3.475415096118135*^9}, {3.475415157576167*^9, 
   3.475415217406499*^9}, {3.475415313529755*^9, 3.475415329065259*^9}, {
   3.475415369736064*^9, 3.475415392087422*^9}, {3.475415428487733*^9, 
   3.475415455526229*^9}, {3.4754155177665157`*^9, 3.47541555046257*^9}, {
   3.475415638800124*^9, 3.475415752192183*^9}, {3.475415833030077*^9, 
   3.475415859154005*^9}, {3.475415895199882*^9, 3.4754159829568787`*^9}, {
   3.475416026886198*^9, 3.4754160720239162`*^9}, {3.4754161045871563`*^9, 
   3.4754161132979307`*^9}, {3.4754161650223627`*^9, 
   3.4754161757824707`*^9}, {3.475416231473404*^9, 3.475416278242137*^9}, {
   3.4754164023376427`*^9, 3.475416444314909*^9}, {3.475416561506901*^9, 
   3.4754165673771563`*^9}, {3.475416602785972*^9, 3.4754166290160933`*^9}, 
   3.4754166717953243`*^9, {3.475416705559785*^9, 3.475416747608629*^9}, {
   3.475416816396978*^9, 3.475416915215006*^9}, {3.475416984662531*^9, 
   3.475417003617631*^9}, {3.4754170402279987`*^9, 3.47541710720545*^9}, {
   3.475417142413661*^9, 3.475417158996089*^9}, {3.475417195402669*^9, 
   3.47541737468452*^9}, {3.4754467153526783`*^9, 3.4754468188230543`*^9}, {
   3.4754468546907167`*^9, 3.475446888727203*^9}, {3.475446941267878*^9, 
   3.475447008401469*^9}, {3.475447677175087*^9, 3.4754477446712933`*^9}, {
   3.475447988883189*^9, 3.475448026703464*^9}, {3.475448073077318*^9, 
   3.475448154432979*^9}, {3.475448221802416*^9, 3.4754483776065073`*^9}, {
   3.475448408722733*^9, 3.475448520042667*^9}, {3.475448952085341*^9, 
   3.475449087137871*^9}, {3.475449148314666*^9, 3.475449279585099*^9}, {
   3.475449324875442*^9, 3.475449457419395*^9}, {3.475449514698174*^9, 
   3.47544952148781*^9}, {3.475454675464456*^9, 3.475454773317904*^9}, {
   3.4754548897474947`*^9, 3.475454910894479*^9}, {3.475455008155828*^9, 
   3.475455015700056*^9}, {3.4754550631255693`*^9, 3.4754552253892717`*^9}, {
   3.475455274141914*^9, 3.4754553161379137`*^9}, {3.47545535425865*^9, 
   3.475455391838245*^9}, {3.475455433822481*^9, 3.475455443877643*^9}, {
   3.4754555096904287`*^9, 3.4754555271290817`*^9}, {3.475455696776729*^9, 
   3.4754557242910967`*^9}, {3.475455776970767*^9, 3.475455801624564*^9}, {
   3.475456198217016*^9, 3.475456202459544*^9}, {3.4754596079949102`*^9, 
   3.475459614311833*^9}, {3.475460047477614*^9, 3.4754600586481457`*^9}, {
   3.475461589826283*^9, 3.475461633882329*^9}, {3.475463374251835*^9, 
   3.4754633775024652`*^9}, {3.4754634954651003`*^9, 3.475463499979669*^9}, {
   3.475463914208621*^9, 3.475463914703012*^9}, {3.4754640703486233`*^9, 
   3.475464071152954*^9}, {3.475464596822629*^9, 3.475464598482012*^9}, {
   3.475467628195072*^9, 3.475467632883882*^9}, 3.475467808401226*^9, {
   3.475467854837569*^9, 3.475467858367579*^9}, {3.475467919966097*^9, 
   3.475467925229865*^9}, {3.4754680977570057`*^9, 3.475468104197669*^9}, {
   3.4754682504201508`*^9, 3.475468283668222*^9}, {3.4754683782786703`*^9, 
   3.4754683801489277`*^9}, {3.475468571023386*^9, 3.4754686213372593`*^9}, {
   3.475469546102528*^9, 3.475469546324548*^9}, {3.475469719124421*^9, 
   3.4754697193239326`*^9}, {3.475470307205607*^9, 3.4754703409426527`*^9}, {
   3.4754704009210978`*^9, 3.475470410527676*^9}, {3.4754704930047617`*^9, 
   3.47547051961092*^9}, {3.475470640915954*^9, 3.475470652022987*^9}, {
   3.475470779667163*^9, 3.475470809595195*^9}, {3.475470905598742*^9, 
   3.4754709172555323`*^9}, 3.4754710310452337`*^9, {3.4754710780841217`*^9, 
   3.475471078857292*^9}, {3.4754712077509108`*^9, 3.475471263098508*^9}, {
   3.475471294762836*^9, 3.475471295757835*^9}, 3.4754972971370487`*^9, {
   3.475497343571782*^9, 3.475497344874321*^9}, {3.4754974778517103`*^9, 
   3.4754975094158*^9}, {3.475497551224495*^9, 3.475497769366085*^9}, {
   3.4754978068464727`*^9, 3.475497839446032*^9}, 3.47549797887855*^9, 
   3.475498054452549*^9, {3.475498084682022*^9, 3.4754980893247747`*^9}, {
   3.4754982136296597`*^9, 3.4754982342978067`*^9}, {3.4754983037423697`*^9, 
   3.475498308983923*^9}, {3.4754984296141872`*^9, 3.475498440353137*^9}, {
   3.475498597400405*^9, 3.475498612116949*^9}, {3.47549870525282*^9, 
   3.475498706324493*^9}, {3.4754987397203608`*^9, 3.4754987411779337`*^9}, {
   3.475498900664324*^9, 3.475498905158126*^9}, {3.47550126640407*^9, 
   3.475501289509036*^9}, {3.475501386244501*^9, 3.475501422686417*^9}, {
   3.475501630329604*^9, 3.475501630925071*^9}, 3.475501701107646*^9, {
   3.4755027499069347`*^9, 3.475502922633955*^9}, {3.475502990083099*^9, 
   3.475503007384081*^9}, {3.4755030392540007`*^9, 3.4755031134276743`*^9}, {
   3.475503231196392*^9, 3.475503245004574*^9}, {3.475503280972286*^9, 
   3.475503282110127*^9}, {3.475503315021574*^9, 3.4755033351620502`*^9}, {
   3.475503410412566*^9, 3.475503423605751*^9}, {3.475503481841188*^9, 
   3.47550348527631*^9}, {3.4755036378160677`*^9, 3.475503645979293*^9}, {
   3.4755066129313498`*^9, 3.475506616377406*^9}, {3.475506662154272*^9, 
   3.475506692827354*^9}, {3.4755067232601843`*^9, 3.4755067470820427`*^9}, {
   3.475507691267541*^9, 3.4755076920022306`*^9}, {3.475507726178258*^9, 
   3.475507733766214*^9}, {3.475507787475226*^9, 3.4755077900377274`*^9}, {
   3.475507898099065*^9, 3.4755078989424667`*^9}, {3.475507965542246*^9, 
   3.4755079749700737`*^9}, {3.475508235497374*^9, 3.475508339879795*^9}, {
   3.475508417873733*^9, 3.4755084203725367`*^9}, {3.4755084999812613`*^9, 
   3.475508510309757*^9}, {3.475508543979864*^9, 3.475508663519725*^9}, {
   3.475508743636683*^9, 3.47550874729813*^9}, {3.4755089889734573`*^9, 
   3.475509004736499*^9}, {3.475509276776189*^9, 3.475509278491297*^9}, {
   3.475509349761141*^9, 3.475509426075082*^9}, {3.475509475983533*^9, 
   3.4755094775681067`*^9}, {3.475509590460648*^9, 3.475509594347418*^9}, {
   3.4755097835784197`*^9, 3.4755098221523542`*^9}, {3.475509897357624*^9, 
   3.4755099129388742`*^9}, {3.475509977557598*^9, 3.4755100565937757`*^9}, {
   3.475510089814702*^9, 3.4755101474737387`*^9}, {3.475510185736668*^9, 
   3.475510185914915*^9}, {3.4755102695572987`*^9, 3.475510277308406*^9}, {
   3.4755103404479303`*^9, 3.475510344444532*^9}, {3.47551056021583*^9, 
   3.4755106340488863`*^9}, {3.475510726204956*^9, 3.475510743836422*^9}, {
   3.475510792277956*^9, 3.475510792960672*^9}, {3.475510852256757*^9, 
   3.475510884828628*^9}, {3.475510917380827*^9, 3.475510923956871*^9}, {
   3.475510957325715*^9, 3.475510962290093*^9}, {3.4755346056140947`*^9, 
   3.475534652262253*^9}, {3.4755346863406277`*^9, 3.475534686642283*^9}, {
   3.4755383244743013`*^9, 3.4755383467610197`*^9}, {3.475538398332961*^9, 
   3.475538427636799*^9}, {3.47554307341286*^9, 3.475543106914772*^9}, {
   3.475543802211911*^9, 3.475543852873358*^9}, {3.475543918608522*^9, 
   3.475543921693429*^9}, {3.475543960247807*^9, 3.475543976558617*^9}, 
   3.4755497145716248`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Returns", " ", 
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"First", "[", "mn_", "]"}], "\[Rule]", "_"}], "]"}], " ", 
      "for", " ", "exp_"}], "\[Equal]", 
     RowBox[{"0", " ", "for", " ", "pair", " ", "mn_.", " ", 
      RowBox[{"e", ".", "g", "."}]}]}], ",", " ", 
    RowBox[{"ZeroNM", "[", 
     RowBox[{
      RowBox[{"I", " ", "2", " ", "\[Pi]", " ", "m", " ", 
       RowBox[{"t", "/", "\[Beta]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMN", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"exp", "==", "0"}], ",", 
           RowBox[{"First", "[", "mn", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"First", "[", "tmp", "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"First", "[", 
            RowBox[{"First", "[", "tmp", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{"exp", "==", "0"}], ",", 
              RowBox[{"Last", "[", "mn", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"First", "[", "tmp", "]"}], "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"tmp", "=", 
              RowBox[{"First", "[", 
               RowBox[{"First", "[", "tmp", "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmp", "=", "exp"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Returns", " ", 
     RowBox[{"xDiscreteDelta", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"mn_", ",", "_"}], "]"}], " ", "for", " ", "exp_"}], 
        "\[Equal]", " ", 
        RowBox[{"0", " ", "for", " ", "pair", " ", "mn_.", " ", 
         RowBox[{"e", ".", "g", "."}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"ZeroNM", "[", 
         RowBox[{
          RowBox[{"I", " ", "2", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"m", "-", "n"}], ")"}], " ", 
           RowBox[{"t", "/", "\[Beta]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}]}], "]"}], "->", 
        RowBox[{"xDiscreteDelta", "[", 
         RowBox[{"First", "[", 
          RowBox[{"m", ",", "n"}], "]"}], "  "}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMNDiscreteDelta", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ZeroMN", "[", 
          RowBox[{"exp", ",", "mn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ZeroMNDiscreteDelta: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"exp", ",", "mn", ",", "tmp", ",", 
              RowBox[{"Head", "[", "tmp", "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tmp", "]"}], "===", "Rule"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"Rule", "\[Rule]", "xDiscreteDelta"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", "exp"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Returns", " ", 
     RowBox[{"\[Delta]uu", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"mn_", ",", "_"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"DiscreteDelta", "[", "]"}], " ", "for", " ", "exp_"}], 
        "\[Equal]", " ", 
        RowBox[{"0", " ", "for", " ", "pair", " ", "mn_.", " ", 
         RowBox[{"e", ".", "g", "."}]}]}], ",", " ", 
       RowBox[{"ZeroNM", "[", 
        RowBox[{
         RowBox[{"I", " ", "2", " ", "\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{"m", "-", "n"}], ")"}], " ", 
          RowBox[{"t", "/", "\[Beta]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], " "}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroMN\[Delta]", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"ZeroMN", "[", 
          RowBox[{"exp", ",", "mn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ZeroMNDiscreteDelta: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"exp", ",", "mn", ",", "tmp", ",", 
              RowBox[{"Head", "[", "tmp", "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tmp", "]"}], "===", "Rule"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"tmp", "/.", 
            RowBox[{"Rule", "\[Rule]", "\[Delta]uu"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", "exp"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Consolidation", " ", 
      RowBox[{
       RowBox[{"Rule", "[", "]"}], "'"}], "s", " ", "for", " ", "Sum"}], "|", 
     "xSum"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GatherSumSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "->", "xSum"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xSum", "[", 
         RowBox[{
          RowBox[{"xSum", "[", 
           RowBox[{"a_", ",", "b__"}], "]"}], ",", "c__"}], "]"}], ":>", 
        RowBox[{"xSum", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d_", " ", 
         RowBox[{"xSum", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
        RowBox[{"xSum", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"d", " ", "a"}], "]"}], ",", "b"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xSum", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "+", 
         RowBox[{"xSum", "[", 
          RowBox[{"c_", ",", "b_"}], "]"}]}], "->", 
        RowBox[{"xSum", "[", 
         RowBox[{
          RowBox[{"a", "+", "c"}], ",", "b"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Consolidation", " ", 
     RowBox[{
      RowBox[{"Rule", "[", "]"}], "'"}], "s", " ", "for", " ", "IntegralOp"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GatherIntOpSubs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a_List", ",", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{"b_List", ",", "c_"}], "]"}]}], "]"}], ":>", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "b"}], "}"}], ",", "c"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"d_", " ", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a", ",", 
          RowBox[{"Expand", "[", 
           RowBox[{"d", " ", "b"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "+", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "->", 
        RowBox[{"IntegralOp", "[", 
         RowBox[{"a", ",", 
          RowBox[{"c", "+", "b"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Changes", " ", 
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], "\[Rule]", 
     RowBox[{"Sum", "[", 
      RowBox[{"a", ",", 
       RowBox[{"PartialD", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"2.28", ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExchangexPartialDSum", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "tmp1", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ExchangePartialDSum: \>\"", ",", "tmp"}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Partiald", " ", "does", " ", "not", " ", "substitute"}], 
          ",", " ", 
          RowBox[{"change", " ", "to", " ", "xPartialD"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", "distributePartialD"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{"a_", ",", "c__"}], "]"}], ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"xSum", "[", 
              RowBox[{"a_", ",", "c__"}], "]"}], ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"xSum", "[", 
            RowBox[{
             RowBox[{"xPartialD", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Distribute", " ", "xSum", " ", "over", " ", 
     RowBox[{"ExpandAll", "[", "sumand", "]"}], " ", "of", " ", 
     RowBox[{
      RowBox[{"Sum", "[", "]"}], ".", "  ", "Returns"}], " ", 
     RowBox[{
      RowBox[{"xSum", "[", "]"}], ".", " ", "\[IndentingNewLine]", "3.1"}], 
     ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DistributeSum", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"tmp1", "=", "NULL"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "/.", 
          RowBox[{"Sum", "->", "xSum"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<DistributeSum: \>\"", ",", "tmp"}], "]"}]}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "c__"}], "]"}], ":>", 
              RowBox[{"xSum", "[", 
               RowBox[{
                RowBox[{"ExpandAll", "[", "a", "]"}], ",", "c"}], "]"}]}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{"tmp", "/.", 
             RowBox[{
              RowBox[{"xSum", "[", 
               RowBox[{"a_", ",", "b__"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xSum", "[", 
                   RowBox[{"#", ",", "b"}], "]"}], "&"}], ",", "a"}], "]"}], "/;", 
               RowBox[{
                RowBox[{"Head", "[", "a", "]"}], "===", "Plus"}]}]}]}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "tmp"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Contracts", " ", 
     RowBox[{"xDiscreteDelta", "[", 
      RowBox[{"n_", ",", "m_"}], "]"}], " ", "in", " ", 
     RowBox[{"xSum", ".", "  ", "Eliminates"}], " ", "on", " ", 
     RowBox[{
      RowBox[{"xSum", "[", "]"}], ".", " ", "\[IndentingNewLine]", "3.1"}], 
     ".2010"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SumDiscreteDelta", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", 
         RowBox[{"tmp1", "=", "Null"}], ",", "pos", ",", "arg", ",", "index", 
         ",", "sumvar", ",", "xsum", ",", "xdelta", ",", "posd", ",", "n", 
         ",", "m", ",", 
         RowBox[{"repl", "=", 
          RowBox[{"{", "}"}]}], ",", "sub", ",", "i", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"exp", "//", "DistributeSum"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"tmp", "=!=", "tmp1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DEBUG", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<SumDiscreteDelta: \>\"", ",", "tmp"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmp1", "=", "tmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"tmp", ",", 
              RowBox[{"xSum", "[", "__", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", 
              RowBox[{"Length", "[", "pos", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xsum", "=", 
               RowBox[{"Extract", "[", 
                RowBox[{"tmp", ",", 
                 RowBox[{"pos", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"arg", ",", "index"}], "}"}], "=", 
               RowBox[{"Apply", "[", 
                RowBox[{"List", ",", "xsum"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "index", "]"}], "===", "List"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"sumvar", "=", 
                 RowBox[{"First", "[", "index", "]"}]}], ",", 
                RowBox[{"sumvar", "=", "index"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<SumDiscreteDelta{arg,index}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"arg", ",", "index"}], "}"}]}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"xdelta", "=", 
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"arg", ",", 
                  RowBox[{"posd", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{"arg", ",", 
                    RowBox[{"xDiscreteDelta", "[", "__", "]"}]}], "]"}]}]}], 
                 "]"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"sub", "=", "Null"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"xdelta", ",", "sumvar"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "xdelta", "]"}], "==", "2"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"sub", "=", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{"Apply", "[", 
                    RowBox[{"Equal", ",", "xdelta"}], "]"}], ",", "sumvar"}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "xdelta", "]"}], "==", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"sub", "=", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "xdelta", "]"}], "==", "0"}], ",", 
                    "sumvar"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<SumDiscreteDelta{Length[xdelta],xdelta,sub}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Length", "[", "xdelta", "]"}], ",", "xdelta", 
                    ",", "sub"}], "}"}]}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<SumDiscreteDelta{sub,arg}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"sub", ",", "arg"}], "}"}]}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sub", "=!=", "Null"}], ",", 
                RowBox[{
                 RowBox[{"arg", "=", 
                  RowBox[{
                   RowBox[{"arg", "/.", "sub"}], "/.", 
                   RowBox[{
                    RowBox[{"xDiscreteDelta", "[", "__", "]"}], "->", 
                    "1"}]}]}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"repl", ",", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "->", "arg"}]}], 
                  "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"DEBUG", ">", "0"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<SumDiscreteDelta{index,sub,repl}: \>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", "sub", ",", "repl"}], "}"}]}], 
                 "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tmp", ",", "repl"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applies", " ", 
     RowBox[{"Integrate", "[", "]"}], " ", "to", " ", "one", " ", 
     RowBox[{"IntegralOp", "[", " ", "integration_parameter", " ", "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrateOne", "[", 
      RowBox[{"parm_", ",", "exp_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{"IntegralOp", "->", "IntegralOp"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<IntegrateOne{parm,tmp}: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"parm", ",", "tmp"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<IntegrateOne{DeleteCases[a,parm]}: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"a", ",", "parm"}], "]"}], "}"}]}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"IntegralOp", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"IntegralOp", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{"a", ",", "parm"}], "]"}], ",", 
              RowBox[{"Integrate", "[", 
               RowBox[{"b", ",", "parm"}], "]"}]}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"a", ",", "parm"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generate", " ", "the", " ", "complement", " ", "t1_", " ", "t2_", " ", 
     "expression", " ", "relative", " ", "to", " ", "total", " ", 
     RowBox[{"differential", ".", "  ", "t1_"}], " ", "is", " ", "the", " ", 
     RowBox[{"xPartialD", "[", 
      RowBox[{"_", ",", "x"}], "]"}], " ", "term", " ", "which", " ", "has", 
     " ", "variable", " ", "used", " ", "for", " ", 
     RowBox[{"differentiating", ".", " ", "The"}], " ", "total", " ", 
     "differential", " ", "term", " ", "is", " ", "specified", " ", "by", " ", 
     RowBox[{
      RowBox[{"DD", "[", 
       RowBox[{"_", ",", "x"}], "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalDiffByParts", "[", 
      RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "var", ",", "f1", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f1", ",", "var"}], "}"}], "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<TotalDiffByParts: \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"f1", ",", "var"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"DD", "[", 
           RowBox[{
            RowBox[{"f1", " ", "t2"}], ",", "var"}], "]"}], "-", 
          RowBox[{"f1", " ", 
           RowBox[{"xPartialD", "[", 
            RowBox[{"t2", ",", "var"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.476642763862289*^9, 3.476642777525859*^9}, {
   3.476642811903961*^9, 3.476642911421946*^9}, 3.47664303789678*^9, 
   3.476643179165001*^9, {3.476643317075169*^9, 3.476643317936386*^9}, {
   3.476643402208899*^9, 3.4766434066830482`*^9}, {3.476643508211241*^9, 
   3.476643528519712*^9}, {3.476643562641294*^9, 3.4766436872674627`*^9}, {
   3.4766437628197317`*^9, 3.476643810538529*^9}, {3.476643938782834*^9, 
   3.476644005425108*^9}, {3.476644044434292*^9, 3.476644048809173*^9}, {
   3.476644120358526*^9, 3.476644167339213*^9}, {3.476644265665845*^9, 
   3.4766442958845*^9}, {3.476644328741139*^9, 3.476644404295808*^9}, {
   3.476644470998148*^9, 3.4766445398778048`*^9}, {3.476644750055437*^9, 
   3.476644861070799*^9}, 3.47664490044123*^9, {3.4766449535535727`*^9, 
   3.476644954367799*^9}, {3.476645016197184*^9, 3.476645033843459*^9}, {
   3.4766450969968243`*^9, 3.476645192595934*^9}, {3.4766699573515463`*^9, 
   3.4766700670649853`*^9}, {3.476672402720327*^9, 3.4766724049316196`*^9}, {
   3.4767542956697083`*^9, 3.4767543321489563`*^9}, {3.477178380157247*^9, 
   3.477178394343453*^9}, 3.477178518806591*^9}],

Cell["Index routines", "Text",
 CellChangeTimes->{{3.477347537208624*^9, 3.4773475425983887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SwitchLabel", "[", 
      RowBox[{"exp_", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "]"}], " ", "switches", " ", 
     "label", " ", "a"}], ",", 
    RowBox[{"b", " ", "in", " ", "exp_"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SwitchLabel", "[", 
      RowBox[{"exp_", ",", "mn_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "XXXX"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "/.", 
           RowBox[{
            RowBox[{"First", "[", "mn", "]"}], "->", "XXXX"}]}], "/.", 
          RowBox[{
           RowBox[{"Last", "[", "mn", "]"}], "->", 
           RowBox[{"First", "[", "mn", "]"}]}]}], "/.", 
         RowBox[{"XXXX", "->", 
          RowBox[{"Last", "[", "mn", "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Eliminates", " ", "index", " ", "m_", " ", "from", " ", "exp_", " ", 
      "containing", " ", 
      RowBox[{
       RowBox[{"\[Delta]uu", "[", 
        RowBox[{"m_", ",", "n"}], "]"}], ".", "  ", "Could"}], " ", "expand", 
      " ", "to", " ", "\[Delta]ud"}], ",", " ", "\[Delta]du", ",", " ", 
     RowBox[{
      RowBox[{"\[Delta]dd", ".", "  ", "A"}], " ", "strick", " ", "version", 
      " ", "would", " ", "track", " ", "up", " ", "and", " ", "down", " ", 
      RowBox[{"indices", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify\[Delta]uu", "[", 
      RowBox[{"exp_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", 
         RowBox[{"ind", "=", "m"}], ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{"a_", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Delta]uu", "[", 
               RowBox[{"m", ",", "b_"}], "]"}], "|", 
              RowBox[{"\[Delta]uu", "[", 
               RowBox[{"b_", ",", "m"}], "]"}]}], ")"}]}], ":>", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "/.", 
              RowBox[{"m", "->", "b"}]}], ")"}], "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"a", ",", "m"}], "]"}]}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"CR", "[", "\"\<Simplify\[Delta]uu: \>\"", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"exp", ",", "m", ",", "tmp"}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Simple", " ", "metric", " ", 
      RowBox[{"(", 
       RowBox[{"guu", ",", "gdd", ",", "gud", ",", "gdu"}], ")"}], " ", 
      "index", " ", "contraction", " ", 
      RowBox[{"routine", ".", " ", 
       RowBox[{"guu", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], 
      RowBox[{"Addd", "[", 
       RowBox[{"c", ",", "a", ",", "d"}], "]"}]}], "->", " ", 
     RowBox[{"Adud", "[", 
      RowBox[{"c", ",", "b", ",", "d"}], "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricContractG", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tmp", "=", "exp"}], ",", "pos", ",", 
         RowBox[{"DEBUG", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"guu", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "|", 
              RowBox[{"guu", "[", 
               RowBox[{"b_", ",", "a_"}], "]"}]}], ")"}], 
            RowBox[{"Tensor", "[", 
             RowBox[{"T_", ",", 
              RowBox[{"{", "c___", "}"}], ",", 
              RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"T", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"{", "c", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pos", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                  "a"}]}], "]"}], ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"{", "d", "}"}], ",", 
                RowBox[{"pos", "->", "Void"}]}], "]"}]}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"gdd", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "|", 
              RowBox[{"gdd", "[", 
               RowBox[{"b_", ",", "a_"}], "]"}]}], ")"}], 
            RowBox[{"Tensor", "[", 
             RowBox[{"T_", ",", 
              RowBox[{"{", "c___", "}"}], ",", 
              RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"T", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"{", "c", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pos", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                  "Void"}]}], "]"}], ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"{", "d", "}"}], ",", 
                RowBox[{"pos", "->", "a"}]}], "]"}]}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"gdu", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "|", 
              RowBox[{"gud", "[", 
               RowBox[{"b_", ",", "a_"}], "]"}]}], ")"}], 
            RowBox[{"Tensor", "[", 
             RowBox[{"T_", ",", 
              RowBox[{"{", "c___", "}"}], ",", 
              RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"T", ",", 
              RowBox[{"{", "c", "}"}], ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"{", "d", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pos", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                  "a"}]}], "]"}]}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", "d", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{"tmp", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"gud", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "|", 
              RowBox[{"gdu", "[", 
               RowBox[{"b_", ",", "a_"}], "]"}]}], ")"}], 
            RowBox[{"Tensor", "[", 
             RowBox[{"T_", ",", 
              RowBox[{"{", "c___", "}"}], ",", 
              RowBox[{"{", "d___", "}"}]}], "]"}]}], ":>", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"T", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"{", "c", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pos", "=", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}], ")"}], "->",
                  "a"}]}], "]"}], ",", 
              RowBox[{"{", "d", "}"}]}], "]"}], "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", "c", "}"}], ",", "b"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DEBUG", ">", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"CR", "[", "\"\<MetricContractG: \>\"", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"tmp", ",", "pos"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "tmp"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Wick", " ", "rotation", " ", "of", " ", "Vector", " ", "contractions"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VectorContractWickSub", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"{", "\[Mu]_", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}], 
         RowBox[{"Tensor", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "\[Mu]_", "}"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tensor", "[", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
             RowBox[{"{", "Void", "}"}]}], "]"}]}], 
          RowBox[{"Tensor", "[", 
           RowBox[{"b", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"{", "\[Mu]_", "}"}], ",", 
            RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c_", "]"}], 
         RowBox[{"Tensor", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"{", "Void", "}"}], ",", 
           RowBox[{"{", "\[Mu]_", "}"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
              RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c", "]"}]}], 
          RowBox[{"Tensor", "[", 
           RowBox[{"b", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"{", "\[Mu]_", "}"}], ",", 
           RowBox[{"{", "Void", "}"}]}], "]"}], 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"b_", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", "\[Mu]_", "}"}]}], "]"}], "[", "c_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Tensor", "[", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
             RowBox[{"{", "Void", "}"}]}], "]"}]}], 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"b", ",", 
             RowBox[{"{", "Void", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}], "[", "c", 
           "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"{", "\[Mu]_", "}"}], ",", 
            RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c_", "]"}], 
         RowBox[{
          RowBox[{"Tensor", "[", 
           RowBox[{"b_", ",", 
            RowBox[{"{", "Void", "}"}], ",", 
            RowBox[{"{", "\[Mu]_", "}"}]}], "]"}], "[", "d_", "]"}]}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Tensor", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"space", "@", "\[Mu]"}], "}"}], ",", 
              RowBox[{"{", "Void", "}"}]}], "]"}], "[", "c", "]"}]}], 
          RowBox[{
           RowBox[{"Tensor", "[", 
            RowBox[{"b", ",", 
             RowBox[{"{", "Void", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"space", "@", "\[Mu]"}], "}"}]}], "]"}], "[", "d", 
           "]"}]}], "/;", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"\[Mu]", ",", "space"}], "]"}]}]}]}], "\[IndentingNewLine]",
       "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.4773475527375298`*^9, 3.4773475563534527`*^9}, {
  3.477347607736083*^9, 3.477347839895226*^9}, {3.477348592243739*^9, 
  3.477348600614975*^9}, {3.477448632110298*^9, 3.477448639124702*^9}, {
  3.4774918324627247`*^9, 3.47749193807034*^9}, {3.477493235651927*^9, 
  3.477493265446851*^9}, {3.477493313311185*^9, 3.477493338835821*^9}, {
  3.477493428011973*^9, 3.4774934420025454`*^9}, {3.477493474119735*^9, 
  3.477493541691545*^9}}],

Cell["Energy-Momentum tensors", "Text",
 CellChangeTimes->{{3.4774875997271137`*^9, 3.4774876451707582`*^9}, {
  3.4774877449202957`*^9, 3.477487751315998*^9}, {3.4774889083550587`*^9, 
  3.477488909767075*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Returns", " ", "Abelian", " ", "vector", " ", "boson", " ", "energy"}], 
     "-", 
     RowBox[{"momentum", " ", "tensor"}]}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Fdd", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ".", 
       RowBox[{"Fuu", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}], "/", "4"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"in", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F", ".", "F"}], ",", 
       RowBox[{"derivative", " ", "of", " ", "A", " ", "definition"}], ",", 
       " ", 
       RowBox[{"Fourier", " ", "transform", " ", "form"}]}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Fabelian", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tmp", ",", "subF", ",", "subFA", ",", "subA", ",", "F2", ",", "FA2"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Abelian case\>\"", ";", "\[IndentingNewLine]", 
      RowBox[{"subF", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Fdd", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"Ad", "[", "\[Nu]", "]"}], ",", "\[Mu]"}], "]"}], "-", 
           RowBox[{"xPartialD", "[", 
            RowBox[{
             RowBox[{"Ad", "[", "\[Mu]", "]"}], ",", "\[Nu]"}], "]"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Fuu", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "->", 
          RowBox[{
           RowBox[{
            RowBox[{"guu", "[", 
             RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}], 
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Au", "[", "\[Nu]", "]"}], ",", "\[Alpha]"}], "]"}]}], 
           "-", 
           RowBox[{
            RowBox[{"xPartialD", "[", 
             RowBox[{
              RowBox[{"Au", "[", "\[Mu]", "]"}], ",", "\[Alpha]"}], "]"}], 
            RowBox[{"guu", "[", 
             RowBox[{"\[Alpha]", ",", "\[Nu]"}], "]"}]}]}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\"\< and Fourier transform \>\"", ";", "\[IndentingNewLine]", 
      RowBox[{"subA", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Ad", "[", "i_", "]"}], "->", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", "k", "}"}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ad", "[", "i", "]"}], "[", "k", "]"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"k", ".", "x"}]}], "]"}]}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Au", "[", "i_", "]"}], "->", 
          RowBox[{"IntegralOp", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", "k", "}"}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"au", "[", "i", "]"}], "[", "k", "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"k", ".", "x"}]}], "]"}]}]}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"subFA", "=", 
       RowBox[{"subF", "/.", "subA"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"subFA", "=", 
       RowBox[{"subFA", "//", "ExchangexPartialDIntegralOp"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subFA", "=", 
       RowBox[{
        RowBox[{"subFA", "/.", 
         RowBox[{
          RowBox[{"xPartialD", "[", 
           RowBox[{
            RowBox[{"a_", " ", 
             RowBox[{"Exp", "[", "b_", "]"}]}], ",", "c_"}], "]"}], "->", 
          RowBox[{"I", " ", 
           RowBox[{"kd", "[", "c", "]"}], " ", "a", " ", 
           RowBox[{"Exp", "[", "b", "]"}]}]}]}], "/.", "GatherIntOpSubs"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"subFA", "=", 
       RowBox[{"subFA", "//", "MetricContractG"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"F2", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], 
        RowBox[{
         RowBox[{"Fdd", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ".", 
         RowBox[{"Fuu", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Abelian", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FA2", "=", 
       RowBox[{"F2", "/.", "subF"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"F2", "/.", "subFA"}], "//", "ExpandAll"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "/.", 
             RowBox[{"k", "->", 
              RowBox[{"k", "[", "1", "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"kd", "[", "c_", "]"}], "->", 
             RowBox[{
              RowBox[{"kd", "[", "c", "]"}], "[", "1", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"b", "/.", 
             RowBox[{"k", "->", 
              RowBox[{"k", "[", "2", "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"kd", "[", "c_", "]"}], "->", 
             RowBox[{
              RowBox[{"kd", "[", "c", "]"}], "[", "2", "]"}]}]}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "/.", "IntDotInt2Int2"}], "/.", 
          RowBox[{"Dot", "->", "Times"}]}], "//.", "GatherIntOpSubs"}], "//", 
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
      "\"\<This integrated over x producing a delta function in k1-k2: (Done \
by hand.)\>\"", ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], "->", 
          RowBox[{"k", "[", "1", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"IntegralOp", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a_", ",", "b_"}], "}"}], ",", "c_"}], "]"}], "->", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", 
           RowBox[{"(", "c", ")"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"k", "[", "1", "]"}], "->", "k"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a", ",", 
           RowBox[{"b", "//", "Expand"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
         RowBox[{"IntegralOp", "[", 
          RowBox[{"a", ",", 
           RowBox[{"MapAt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SwitchLabel", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}]}], "]"}], "&"}], ",", 
             "b", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"F2", ",", "FA2", ",", "tmp"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.47748769590289*^9, 3.477488081976946*^9}, {
  3.477488467366118*^9, 3.47748856240867*^9}, {3.4774886173547*^9, 
  3.477488689887061*^9}, {3.477488783679697*^9, 3.477488891200232*^9}, {
  3.4774890260432034`*^9, 3.477489027043998*^9}}]
},
AutoGeneratedPackage->Automatic,
WindowSize->{640, 656},
WindowMargins->{{Automatic, -1274}, {Automatic, 15}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"TensorialStyleSave.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 4759, 116, 416, "Input"],
Cell[5307, 138, 1124, 18, 137, "Text"],
Cell[6434, 158, 17089, 389, 1476, "Input",
 InitializationCell->True],
Cell[23526, 549, 179, 2, 29, "Text"],
Cell[CellGroupData[{
Cell[23730, 555, 1067, 27, 161, "Input",
 InitializationCell->True],
Cell[24800, 584, 279, 4, 24, "Output"]
}, Open  ]],
Cell[25094, 591, 107, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[25226, 596, 5421, 140, 326, "Input",
 InitializationCell->True],
Cell[30650, 738, 2173, 56, 32, "Output"],
Cell[32826, 796, 2204, 57, 32, "Output"],
Cell[35033, 855, 1951, 51, 31, "Output"],
Cell[36987, 908, 919, 23, 31, "Output"],
Cell[37909, 933, 1675, 43, 32, "Output"],
Cell[39587, 978, 292, 5, 24, "Output"],
Cell[39882, 985, 1463, 37, 32, "Output"]
}, Open  ]],
Cell[41360, 1025, 32093, 690, 1691, "Input",
 InitializationCell->True],
Cell[73456, 1717, 27234, 667, 2203, "Input",
 InitializationCell->True],
Cell[100693, 2386, 98, 1, 29, "Text"],
Cell[100794, 2389, 14565, 384, 771, "Input"],
Cell[115362, 2775, 211, 3, 29, "Text"],
Cell[115576, 2780, 8293, 220, 595, "Input"]
}
]
*)

(* End of internal cache information *)
